{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 411c2ea0274938935199","webpack:///./node_modules/jitsi-meet-logger/lib/index.js","webpack:///./modules/browser/BrowserCapabilities.js","webpack:///./modules/browser/index.js","webpack:///./node_modules/strophe.js/strophe.js","webpack:///./modules/util/GlobalOnErrorHandler.js","webpack:///./service/RTC/MediaType.js","webpack:///./modules/statistics/statistics.js","webpack:///./service/statistics/AnalyticsEvents.js","webpack:///./JitsiConferenceEvents.js","webpack:///./service/xmpp/XMPPEvents.js","webpack:///./service/RTC/RTCEvents.js","webpack:///./modules/util/Listenable.js","webpack:///./node_modules/webrtc-adapter/src/js/utils.js","webpack:///./JitsiTrackError.js","webpack:///./service/RTC/VideoType.js","webpack:///./modules/xmpp/SDPUtil.js","webpack:///./node_modules/sdp-transform/lib/index.js","webpack:///./node_modules/events/events.js","webpack:///./JitsiTrackErrors.js","webpack:///./JitsiTrackEvents.js","webpack:///./modules/util/RandomUtil.js","webpack:///(webpack)/buildin/global.js","webpack:///./node_modules/precalltest/dist/utility/timestamps.js","webpack:///./modules/xmpp/ConnectionPlugin.js","webpack:///./modules/settings/Settings.js","webpack:///./node_modules/precalltest/dist/utility/stats/detectbrowser.js","webpack:///./node_modules/bluebird/js/browser/bluebird.js","webpack:///./JitsiConnectionEvents.js","webpack:///./modules/RTC/RTC.js","webpack:///./modules/RTC/RTCUtils.js","webpack:///./modules/xmpp/SdpTransformUtil.js","webpack:///./modules/videosipgw/VideoSIPGWConstants.js","webpack:///./service/connectivity/ConnectionQualityEvents.js","webpack:///./JitsiConferenceErrors.js","webpack:///./node_modules/react-native-callstats/swPlugin.js","webpack:///./node_modules/process/browser.js","webpack:///./service/RTC/Resolutions.js","webpack:///./modules/connectivity/ParticipantConnectionStatus.js","webpack:///./modules/RTC/adapter.screenshare.js","webpack:///./node_modules/jitsi-meet-logger/lib/Logger.js","webpack:///./modules/browser/browsers.js","webpack:///./node_modules/timers-browserify/main.js","webpack:///./node_modules/precalltest/dist/tests/turnTest.js","webpack:///./node_modules/precalltest/dist/utility/messageMaker.js","webpack:///./modules/statistics/LocalStatsCollector.js","webpack:///./service/statistics/Events.js","webpack:///./modules/util/ScriptUtil.js","webpack:///./modules/xmpp/xmpp.js","webpack:///./JitsiConnectionErrors.js","webpack:///./JitsiTranscriptionStatus.js","webpack:///./service/authentication/AuthenticationEvents.js","webpack:///./modules/xmpp/recording.js","webpack:///./JitsiRecorderErrors.js","webpack:///./modules/xmpp/JingleSessionState.js","webpack:///./modules/xmpp/SDP.js","webpack:///./service/RTC/SignalingEvents.js","webpack:///./modules/RTC/JitsiTrack.js","webpack:///./service/RTC/CameraFacingMode.js","webpack:///./node_modules/sdp-transform/lib/grammar.js","webpack:///./node_modules/sdp/sdp.js","webpack:///./modules/transcription/audioRecorder.js","webpack:///./JitsiMediaDevicesEvents.js","webpack:///./index.js","webpack:///./JitsiMeetJS.js","webpack:///./modules/util/AuthUtil.js","webpack:///./JitsiConnection.js","webpack:///./JitsiConference.js","webpack:///./modules/statistics/AvgRTPStatsReporter.js","webpack:///./node_modules/jitsi-meet-logger/lib/LogCollector.js","webpack:///./modules/browser/BrowserDetection.js","webpack:///./node_modules/bowser/src/bowser.js","webpack:///(webpack)/buildin/amd-define.js","webpack:///./modules/browser/capabilities.json","webpack:///./modules/statistics/AnalyticsAdapter.js","webpack:///./modules/util/UsernameGenerator.js","webpack:///./modules/statistics/CallStats.js","webpack:///./node_modules/react-native-callstats/callstats.js","webpack:///./node_modules/react-native-callstats/callstatsUtils.js","webpack:///./node_modules/react-native-callstats/statsReporter.js","webpack:///./node_modules/react-native-callstats/slidingWindow.js","webpack:///./node_modules/react-native-callstats/swItem.js","webpack:///./node_modules/react-native-callstats/swPercentileTracker.js","webpack:///./node_modules/react-native-callstats/swPercentileNotification.js","webpack:///./node_modules/react-native-callstats/binaryTree.js","webpack:///./node_modules/react-native-callstats/swAvg.js","webpack:///./node_modules/react-native-callstats/pcCallbackHandler.js","webpack:///./node_modules/precalltest/dist/main.js","webpack:///./node_modules/precalltest/dist/turnConnection.js","webpack:///./node_modules/precalltest/dist/utility/parsedIceCandidate.js","webpack:///./node_modules/precalltest/dist/utility/stats/getstatshandler.js","webpack:///./node_modules/precalltest/dist/utility/stats/statsadapter.js","webpack:///./node_modules/setimmediate/setImmediate.js","webpack:///./node_modules/precalltest/dist/tests/rttTest.js","webpack:///./node_modules/precalltest/dist/tests/throughputTest.js","webpack:///./node_modules/precalltest/dist/utility/resultsHandler.js","webpack:///./node_modules/precalltest/dist/utility/onlineCheck.js","webpack:///./modules/statistics/RTPStatsCollector.js","webpack:///./node_modules/current-executing-script/dist/currentExecutingScript.js","webpack:///./service/statistics/constants.js","webpack:///./modules/version/ComponentsVersions.js","webpack:///./modules/connectivity/ConnectionQuality.js","webpack:///./authenticateAndUpgradeRole.js","webpack:///./node_modules/strophejs-plugin-disco/lib/strophe.disco.js","webpack:///./modules/xmpp/strophe.emuc.js","webpack:///./modules/xmpp/ChatRoom.js","webpack:///./modules/xmpp/moderator.js","webpack:///./modules/xmpp/strophe.jingle.js","webpack:///./modules/xmpp/JingleSessionPC.js","webpack:///./node_modules/async/lib/async.js","webpack:///./modules/util/StringUtils.js","webpack:///./modules/xmpp/JingleSession.js","webpack:///./modules/xmpp/SDPDiffer.js","webpack:///./modules/xmpp/SignalingLayerImpl.js","webpack:///./service/RTC/SignalingLayer.js","webpack:///./modules/xmpp/strophe.util.js","webpack:///./modules/xmpp/strophe.ping.js","webpack:///./modules/xmpp/strophe.rayo.js","webpack:///./modules/xmpp/strophe.logger.js","webpack:///./modules/xmpp/Caps.js","webpack:///./JitsiConferenceEventManager.js","webpack:///./modules/util/EventEmitterForwarder.js","webpack:///./modules/DTMF/JitsiDTMFManager.js","webpack:///./JitsiParticipant.js","webpack:///./modules/event/Jvb121EventGenerator.js","webpack:///./modules/P2PDominantSpeakerDetection.js","webpack:///./modules/RTC/BridgeChannel.js","webpack:///./modules/RTC/JitsiLocalTrack.js","webpack:///./modules/RTC/ortc/RTCPeerConnection.js","webpack:///./node_modules/yaeti/index.js","webpack:///./node_modules/yaeti/lib/EventTarget.js","webpack:///./node_modules/yaeti/lib/Event.browser.js","webpack:///./modules/RTC/ortc/RTCSessionDescription.js","webpack:///./node_modules/sdp-transform/lib/parser.js","webpack:///./node_modules/sdp-transform/lib/writer.js","webpack:///./modules/RTC/ortc/utils.js","webpack:///./modules/RTC/ortc/errors.js","webpack:///./modules/RTC/ScreenObtainer.js","webpack:///./node_modules/webrtc-adapter/src/js/adapter_core.js","webpack:///./node_modules/webrtc-adapter/src/js/adapter_factory.js","webpack:///./node_modules/webrtc-adapter/src/js/chrome/chrome_shim.js","webpack:///./node_modules/webrtc-adapter/src/js/chrome/getusermedia.js","webpack:///./node_modules/webrtc-adapter/src/js/edge/edge_shim.js","webpack:///./node_modules/rtcpeerconnection-shim/rtcpeerconnection.js","webpack:///(webpack)/buildin/module.js","webpack:///./node_modules/webrtc-adapter/src/js/edge/getusermedia.js","webpack:///./node_modules/webrtc-adapter/src/js/firefox/firefox_shim.js","webpack:///./node_modules/webrtc-adapter/src/js/firefox/getusermedia.js","webpack:///./node_modules/webrtc-adapter/src/js/safari/safari_shim.js","webpack:///./node_modules/webrtc-adapter/src/js/common_shim.js","webpack:///./modules/util/MathUtil.js","webpack:///./modules/RTC/TraceablePeerConnection.js","webpack:///./modules/RTC/JitsiRemoteTrack.js","webpack:///./modules/RTC/LocalSdpMunger.js","webpack:///./modules/xmpp/RtxModifier.js","webpack:///./modules/xmpp/SdpConsistency.js","webpack:///./node_modules/sdp-interop/lib/index.js","webpack:///./node_modules/sdp-interop/lib/interop.js","webpack:///./node_modules/sdp-interop/lib/transform.js","webpack:///./node_modules/sdp-interop/lib/array-equals.js","webpack:///./node_modules/sdp-simulcast/lib/index.js","webpack:///./node_modules/sdp-simulcast/lib/transform-utils.js","webpack:///./modules/TalkMutedDetection.js","webpack:///./modules/transcription/transcriber.js","webpack:///./modules/transcription/recordingResult.js","webpack:///./modules/transcription/transcriptionServices/SphinxTranscriptionService.js","webpack:///./modules/transcription/transcriptionServices/AbstractTranscriptionService.js","webpack:///./modules/transcription/word.js","webpack:///./modules/videosipgw/VideoSIPGW.js","webpack:///./modules/videosipgw/JitsiVideoSIPGWSession.js","webpack:///./modules/statistics/SpeakerStatsCollector.js","webpack:///./modules/statistics/SpeakerStats.js","webpack:///./JitsiMediaDevices.js","webpack:///./modules/RTC/RTCUIHelper.js"],"names":["root","factory","exports","module","define","amd","JitsiMeetJS","self","this","e","__webpack_require__","moduleId","installedModules","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","default","object","property","prototype","hasOwnProperty","p","s","t","Logger","LogCollector","idLoggers","loggers","curLevel","levels","TRACE","addGlobalTransport","transport","removeGlobalTransport","getLogger","id","transports","format","logger","push","setLogLevelById","level","length","setLevel","setLogLevel","BrowserCapabilities","isUsingIFrame","arguments","browserInfo","TypeError","_this","__proto__","getPrototypeOf","browserCapabilities","capabilities_default","a","getName","capabilitiesByVersion","capabilities","_typeof","version","isVersionGreaterThan","_capabilities","_extends","iframeCapabilities","isSupported","BrowserDetection","key","value","isFirefox","isEdge","isSafariWithWebrtc","isSafari","isVersionLessThan","isIExplorer","isChrome","isElectron","audioIn","audioOut","screenSharing","isNWJS","isReactNative","videoIn","videoOut","usesUnifiedPlan","__webpack_exports__","b","browser_BrowserCapabilities","__WEBPACK_AMD_DEFINE_ARRAY__","__WEBPACK_AMD_DEFINE_RESULT__","__WEBPACK_AMD_DEFINE_FACTORY__","requirejs","require","undef","hasProp","obj","prop","hasOwn","normalize","baseName","nameParts","nameSegment","mapValue","foundMap","lastIndex","foundI","foundStarMap","starI","j","part","baseParts","split","map","config","starMap","nodeIdCompat","jsSuffixRegExp","test","replace","charAt","slice","concat","splice","join","makeRequire","relName","forceSync","args","aps","req","apply","makeLoad","depName","defined","callDep","waiting","defining","main","Error","splitPrefix","prefix","index","indexOf","substring","makeRelParts","makeMap","handlers","relParts","plugin","parts","relResourceName","f","pr","uri","deps","callback","cjsModule","ret","usingExports","callbackType","load","alt","setTimeout","cfg","_defined","jQuery","Function","bind","func","_slice","Array","_concat","_args","isArray","arg","toString","elt","len","from","Number","Math","ceil","floor","forEach","thisArg","T","k","O","kValue","keyStr","btoa","input","chr1","chr2","chr3","enc1","enc2","enc3","enc4","output","charCodeAt","isNaN","atob","String","fromCharCode","core_sha1","x","olda","oldb","oldc","oldd","olde","w","rol","safe_add","sha1_ft","core_hmac_sha1","data","bkey","str2binb","ipad","opad","hash","y","lsw","num","cnt","str","bin","binb2str","binb2b64","binarray","triplet","b64_hmac_sha1","b64_sha1","str_hmac_sha1","str_sha1","SHA1","str2binl","md5_cmn","q","md5_ff","md5_gg","md5_hh","md5_ii","core_md5","hexdigest","hex_tab","MD5","utf16to8","out","addCookies","cookies","cookieName","cookieObj","isObj","cookieValue","expires","domain","path","escape","unescape","document","cookie","stropheUtils","Strophe","$build","$iq","$msg","$pres","utils","attrs","Builder","VERSION","NS","HTTPBIND","BOSH","CLIENT","AUTH","ROSTER","PROFILE","DISCO_INFO","DISCO_ITEMS","MUC","SASL","STREAM","FRAMING","BIND","SESSION","STANZAS","XHTML_IM","XHTML","tags","attributes","blockquote","br","cite","em","img","li","ol","span","strong","ul","body","css","validTag","tag","validAttribute","attribute","validCSS","style","Status","ERROR","CONNECTING","CONNFAIL","AUTHENTICATING","AUTHFAIL","CONNECTED","DISCONNECTED","DISCONNECTING","ATTACHED","REDIRECT","CONNTIMEOUT","ErrorCondition","BAD_FORMAT","CONFLICT","MISSING_JID_NODE","NO_AUTH_MECH","UNKNOWN_REASON","LogLevel","DEBUG","INFO","WARN","FATAL","ElementType","NORMAL","TEXT","CDATA","FRAGMENT","TIMEOUT","SECONDARY_TIMEOUT","addNamespace","forEachChild","elem","elemName","childNode","childNodes","nodeType","isTagEqual","el","tagName","_xmlGenerator","_makeGenerator","doc","implementation","createDocument","documentMode","_getIEXmlDom","appendChild","createElement","xmlGenerator","docStrings","ActiveXObject","xmlElement","node","xmlTextNode","sort","attr","setAttribute","xmlescape","text","xmlunescape","createTextNode","xmlHtmlNode","html","DOMParser","parseFromString","async","loadXML","getText","nodeValue","copyElement","nodeName","createHtml","cssAttrs","cssName","cssValue","toLowerCase","getAttribute","cssText","createDocumentFragment","escapeNode","unescapeNode","getNodeFromJid","jid","getDomainFromJid","bare","getBareJidFromJid","getResourceFromJid","_handleError","stack","fatal","sourceURL","handler","line","message","fileName","lineNumber","log","msg","debug","info","warn","error","serialize","result","tree","child","_requestId","_connectionPlugins","addConnectionPlugin","ptype","xmlns","nodeTree","up","parentNode","moreattrs","removeAttribute","cnode","impNode","xmlGen","importNode","newElem","h","fragment","innerHTML","xhtml","Handler","ns","type","options","matchBareFromJid","ignoreNamespaceFragment","matchBare","user","getNamespace","elNamespace","namespaceMatch","nsMatch","that","isMatch","elem_type","run","TimedHandler","period","lastCalled","Date","getTime","reset","Connection","service","proto","protocol","_proto","Websocket","Bosh","features","_sasl_data","do_session","do_bind","timedHandlers","removeTimeds","removeHandlers","addTimeds","addHandlers","protocolErrorHandlers","HTTP","websocket","_idleTimeout","_disconnectTimeout","authenticated","connected","disconnecting","do_authentication","paused","restored","_data","_uniqueId","_sasl_success_handler","_sasl_failure_handler","_sasl_challenge_handler","maxRetries","_onIdle","registerSASLMechanisms","mechanisms","F","init","_reset","_requests","pause","resume","getUniqueId","suffix","uuid","r","random","addProtocolErrorHandler","status_code","connect","pass","wait","hold","route","authcid","authzid","servtype","connect_callback","_changeConnectStatus","_connect","attach","sid","rid","wind","_attach","restore","_sessionCachingSupported","_restore","JSON","sessionStorage","setItem","removeItem","xmlInput","xmlOutput","rawInput","rawOutput","nextValidRid","send","_queueData","_send","flush","clearTimeout","sendPresence","errback","timeout","timeoutHandler","addHandler","stanza","deleteTimedHandler","addTimedHandler","deleteHandler","sendIQ","iqtype","element","_sendRestart","thand","handRef","hand","SASLAnonymous","SASLExternal","SASLMD5","SASLOAuthBearer","SASLXOAuth2","SASLPlain","SASLSHA1","registerSASLMechanism","mechanism","disconnect","reason","pres","_addSysTimedHandler","_onDisconnectTimeout","_disconnect","_abortAllRequests","_doDisconnect","status","condition","statusChanged","err","_dataRecv","raw","_reqToData","strip","pop","_emptyQueue","cond","conflict","getElementsByTagName","UNKOWN_REASON","newList","_no_auth_received","_callback","_connect_cb","bodyWrap","getElementsByTagNameNS","mech","matched","authenticate","sortMechanismsByPriority","higher","swap","priority","_attemptSASLAuth","mechanism_found","_addSysHandler","_sasl_success_cb","_sasl_failure_cb","_sasl_challenge_cb","_sasl_mechanism","onStart","request_auth_exchange","isClientFirst","response","onChallenge","_attemptLegacyAuth","_auth1_cb","to","challenge","iq","_auth2_cb","serverSignature","matches","match","onSuccess","streamfeature_handlers","wrapper","_sasl_auth1_cb","_sasl_bind_cb","resource","jidNode","_sasl_session_cb","onFailure","now","SASLMechanism","connection","_connection","auth_str","test_cnonce","cnonce","nonce","salt","iter","Hi","U","U_old","clientKey","serverKey","clientSignature","responseText","authMessage","attribMatch","substr","_quote","realm","host","digest_uri","cred","A1","A2","core","Request","sends","xmlData","origFunc","date","NaN","abort","dead","age","timeDead","xhr","_newXHR","getResponse","responseXML","documentElement","window","XMLHttpRequest","overrideMimeType","onreadystatechange","_conn","errors","inactivity","lastResponseHeaders","_buildBody","keepalive","_cacheSession","xml:lang","content","ver","xmpp:version","xmlns:xmpp","_onRequestStateChange","_throttledRequestHandler","session","parse","getItem","stringify","typ","parseInt","_sendTerminate","_callProtocolErrorHandlers","err_callback","reqStatus","_getRequestStatus","_hitError","xmpp:restart","time_elapsed","def","readyState","getAllResponseHeaders","valid_request","too_many_retries","_removeRequest","reqIs0","_restartRequest","_processRequest","primaryTimeout","secondaryTimeout","requestCompletedWithServerError","contentType","open","sync","setRequestHeader","withCredentials","e2","sendFunc","customHeaders","headers","header","backoff","min","pow","abs","new_service","location","pathname","_buildStream","_check_streamerror","connectstatus","textContent","errorString","_closeSocket","socket","WebSocket","onopen","_onOpen","onerror","_onError","onclose","_onClose","onmessage","_connect_cb_wrapper","_handleStreamStart","streamStart","see_uri","string","_streamWrap","_onMessage","CLOSED","close","closeString","code","rawStanza","search","firstChild","start","startString","oldOnErrorHandler","oldOnUnhandledRejection","onunhandledrejection","_len","_key","event","GlobalOnErrorHandler","callErrorHandler","errHandler","callUnhandledRejectionHandler","VIDEO","AUDIO","_initCallStatsBackend","__WEBPACK_IMPORTED_MODULE_3__CallStats__","isBackendInitialized","userName","__WEBPACK_IMPORTED_MODULE_7__settings_Settings__","callStatsUserName","initBackend","callStatsID","callStatsSecret","swapUserNameAndAlias","callStatsAliasName","aliasName","applicationName","getWiFiStatsMethod","Statistics","xmpp","rtpStatsMap","Map","eventEmitter","__WEBPACK_IMPORTED_MODULE_0_events___default","callStatsIntegrationEnabled","disableThirdPartyRequests","__WEBPACK_IMPORTED_MODULE_6__browser__","isCallstatsLoaded","__WEBPACK_IMPORTED_MODULE_8__util_ScriptUtil___default","loadScript","customScriptUrl","callStatsConfIDNamespace","callsStatsInstances","instances","add","_","u","v","Symbol","iterator","constructor","__filename","_instances","audioLevelsEnabled","disableAudioLevels","audioLevelsInterval","analytics","__WEBPACK_IMPORTED_MODULE_2__AnalyticsAdapter__","Set","startRemoteStats","peerconnection","stopRemoteStats","rtpStats","__WEBPACK_IMPORTED_MODULE_5__RTPStatsCollector__","set","localStats","startLocalStats","stream","__WEBPACK_IMPORTED_MODULE_4__LocalStatsCollector__","addAudioLevelListener","listener","on","__WEBPACK_IMPORTED_MODULE_10__service_statistics_Events__","removeAudioLevelListener","removeListener","addBeforeDisposedListener","removeBeforeDisposedListener","addConnectionStatsListener","removeConnectionStatsListener","addByteSentStatsListener","removeByteSentStatsListener","dispose","size","emit","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","values","next","done","callStats","stopCallStats","tpc","return","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","keys","tpcId","_stopRemoteStats","removeAllListeners","delete","stopLocalStats","stop","startCallStats","remoteUserID","has","newInstance","confID","_getCallStatsConfID","_getAllCallStatsInstances","csInstances","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","statistics","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","cs","roomName","callStatsInstance","sendTerminateEvent","isCallstatsEnabled","sendConnectionResumeOrHoldEvent","isResume","instance","sendResumeOrHoldEvent","sendIceConnectionFailedEvent","sendMuteEvent","muted","sendScreenSharingEvent","ssrc","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_step5","_iterator5","sendDominantSpeakerEvent","_iteratorNormalCompletion6","_didIteratorError6","_iteratorError6","_step6","_iterator6","sendActiveDeviceListEvent","devicesData","globalSet","_iteratorNormalCompletion7","_didIteratorError7","_iteratorError7","_step7","_iterator7","associateStreamWithVideoTag","isLocal","userId","usageLabel","containerId","sendGetUserMediaFailed","__WEBPACK_IMPORTED_MODULE_9__JitsiTrackError__","gum","constraintName","constraints","_iteratorNormalCompletion8","_didIteratorError8","_iteratorError8","_step8","_iterator8","sendCreateOfferFailed","sendCreateAnswerFailed","sendSetLocalDescFailed","sendSetRemoteDescFailed","sendAddIceCandidateFailed","sendLog","globalSubSet","_iteratorNormalCompletion9","_didIteratorError9","_iteratorError9","_step9","_iterator9","stats","_iteratorNormalCompletion10","_didIteratorError10","_iteratorError10","_step10","_iterator10","csPerStats","sendApplicationLog","sendFeedback","overall","comment","sendEvent","__WEBPACK_IMPORTED_MODULE_1__service_statistics_AnalyticsEvents__","rating","LOCAL_JID","reportGlobalError","sendAnalyticsAndLog","properties","eventToLog","sendAnalytics","eventName","TYPE_OPERATIONAL","TYPE_PAGE","TYPE_TRACK","TYPE_UI","ACTION_JINGLE_RESTART","ACTION_JINGLE_SA_TIMEOUT","ACTION_JINGLE_SI_RECEIVED","ACTION_JINGLE_TERMINATE","ACTION_JINGLE_TR_RECEIVED","ACTION_JINGLE_TR_SUCCESS","ACTION_P2P_ESTABLISHED","ACTION_P2P_FAILED","ACTION_P2P_SWITCH_TO_JVB","AVAILABLE_DEVICE","CONNECTION_DISCONNECTED","FEEDBACK","ICE_DURATION","ICE_ESTABLISHMENT_DURATION_DIFF","ICE_STATE_CHANGED","TRACK_UNMUTED","createBridgeDownEvent","bridgeDown","action","actionSubject","createConnectionFailedEvent","errorType","errorMessage","details","error_type","error_message","createConnectionStageReachedEvent","stage","source","createFocusLeftEvent","createGetUserMediaEvent","createJingleEvent","createNoDataFromSourceEvent","mediaType","media_type","createP2PEvent","createRemotelyMutedEvent","createRtpStatsEvent","createTtfmEvent","USER_STATUS_CHANGED","AUTH_STATUS_CHANGED","AVAILABLE_DEVICES_CHANGED","AVATAR_CHANGED","BEFORE_STATISTICS_DISPOSED","CONFERENCE_ERROR","CONFERENCE_FAILED","CONFERENCE_JOINED","CONFERENCE_LEFT","CONNECTION_INTERRUPTED","CONNECTION_RESTORED","DATA_CHANNEL_OPENED","DISPLAY_NAME_CHANGED","DOMINANT_SPEAKER_CHANGED","DTMF_SUPPORT_CHANGED","ENDPOINT_MESSAGE_RECEIVED","JVB121_STATUS","KICKED","LAST_N_ENDPOINTS_CHANGED","LOCK_STATE_CHANGED","MESSAGE_RECEIVED","PRIVATE_MESSAGE_RECEIVED","PARTICIPANT_CONN_STATUS_CHANGED","PARTCIPANT_FEATURES_CHANGED","PARTICIPANT_PROPERTY_CHANGED","P2P_STATUS","PHONE_NUMBER_CHANGED","RECORDER_STATE_CHANGED","VIDEO_SIP_GW_AVAILABILITY_CHANGED","VIDEO_SIP_GW_SESSION_STATE_CHANGED","START_MUTED_POLICY_CHANGED","STARTED_MUTED","SUBJECT_CHANGED","SUSPEND_DETECTED","TALK_WHILE_MUTED","TRACK_ADDED","TRACK_AUDIO_LEVEL_CHANGED","TRACK_MUTE_CHANGED","TRACK_REMOVED","TRANSCRIPTION_STATUS_CHANGED","USER_JOINED","USER_LEFT","USER_ROLE_CHANGED","ADD_ICE_CANDIDATE_FAILED","AUDIO_MUTED_BY_FOCUS","AUTHENTICATION_REQUIRED","BRIDGE_DOWN","CALL_ACCEPTED","CALL_INCOMING","CALL_ENDED","CHAT_ERROR_RECEIVED","CONFERENCE_SETUP_FAILED","CONNECTION_ESTABLISHED","CONNECTION_FAILED","CONNECTION_ICE_FAILED","EMUC_ROOM_ADDED","EMUC_ROOM_REMOVED","ETHERPAD","FOCUS_DISCONNECTED","FOCUS_LEFT","GRACEFUL_SHUTDOWN","ICE_RESTARTING","JINGLE_ERROR","JINGLE_FATAL_ERROR","LOCAL_ROLE_CHANGED","MUC_DESTROYED","MUC_JOINED","MUC_MEMBER_JOINED","MUC_MEMBER_LEFT","MUC_LEFT","MUC_ROLE_CHANGED","MUC_LOCK_CHANGED","PARTICIPANT_AUDIO_MUTED","PARTICIPANT_VIDEO_MUTED","PARTICIPANT_VIDEO_TYPE_CHANGED","PASSWORD_REQUIRED","PEERCONNECTION_READY","PRESENCE_STATUS","PROMPT_FOR_LOGIN","READY_TO_JOIN","REMOTE_STATS","RESERVATION_ERROR","ROOM_CONNECT_ERROR","ROOM_CONNECT_NOT_ALLOWED_ERROR","ROOM_JOIN_ERROR","ROOM_MAX_USERS_ERROR","SENDING_CHAT_MESSAGE","SENDING_PRIVATE_CHAT_MESSAGE","SESSION_ACCEPT_TIMEOUT","START_MUTED_FROM_FOCUS","TRANSPORT_INFO","ICE_CONNECTION_STATE_CHANGED","JSON_MESSAGE_RECEIVED","CREATE_ANSWER_FAILED","CREATE_OFFER_FAILED","RTC_READY","DATA_CHANNEL_OPEN","ENDPOINT_CONN_STATUS_CHANGED","LASTN_ENDPOINT_CHANGED","LASTN_VALUE_CHANGED","LOCAL_TRACK_SSRC_UPDATED","TRACK_ATTACHED","REMOTE_TRACK_ADDED","REMOTE_TRACK_MUTE","REMOTE_TRACK_REMOVED","REMOTE_TRACK_UNMUTE","SET_LOCAL_DESCRIPTION_FAILED","SET_REMOTE_DESCRIPTION_FAILED","AUDIO_OUTPUT_DEVICE_CHANGED","DEVICE_LIST_CHANGED","DEVICE_LIST_AVAILABLE","LOCAL_UFRAG_CHANGED","REMOTE_UFRAG_CHANGED","writable","Listenable","addEventListener","addListener","removeEventListener","off","logDisabled_","deprecationWarnings_","disableLog","bool","disableWarnings","console","deprecated","oldMethod","newMethod","extractVersion","uastring","expr","pos","detectBrowser","navigator","browser","mozGetUserMedia","userAgent","webkitGetUserMedia","webkitRTCPeerConnection","mediaDevices","shimCreateObjectURL","JitsiTrackError","devices","__WEBPACK_IMPORTED_MODULE_0__JitsiTrackErrors__","PERMISSION_DENIED","TRACK_ERROR_TO_MESSAGE_MAP","NOT_FOUND","constraint","video","UNSUPPORTED_RESOLUTION","failedConstraintName","mandatory","minWidth","minHeight","CONSTRAINT_FAILED","GENERAL","FIREFOX_EXTENSION_NEEDED","CHROME_EXTENSION_INSTALLATION_ERROR","CHROME_EXTENSION_USER_GESTURE_REQUIRED","CHROME_EXTENSION_USER_CANCELED","CHROME_EXTENSION_GENERIC_ERROR","ELECTRON_DESKTOP_PICKER_ERROR","ELECTRON_DESKTOP_PICKER_NOT_FOUND","TRACK_IS_DISPOSED","TRACK_NO_STREAM_FOUND","NO_DATA_FROM_SOURCE","create","CAMERA","DESKTOP","__WEBPACK_IMPORTED_MODULE_0_jitsi_meet_logger__","SDPUtil","filterSpecialChars","iceparams","mediadesc","sessiondesc","ufrag","pwd","findLine","parseICEUfrag","parseICEPwd","buildICEUfrag","frag","buildICEPwd","parseMID","parseMLine","media","shift","port","fmt","buildMLine","mline","parseRTPMap","clockrate","channels","parseSCTPMap","buildRTPMap","parseCrypto","parseFingerprint","fingerprint","parseFmtp","parseICECandidate","candidate","elems","foundation","component","ip","generation","tcptype","network","buildICECandidate","cand","hasOwnAttribute","parseSSRC","desc","lines","parseRTCPFB","pt","params","parseExtmap","direction","haystack","needle","sessionpart","findLines","needles","candidateToJingle","candidateFromJingle","__WEBPACK_IMPORTED_MODULE_2__browser__","parsePrimaryVideoSsrc","videoMLine","numSsrcs","ssrcs","ssrcInfo","filter","array","numGroups","ssrcGroups","primarySsrc","fidGroup","find","group","semantics","simGroup","generateSsrc","__WEBPACK_IMPORTED_MODULE_1__util_RandomUtil___default","randomInt","getSsrcAttribute","mLine","attributeName","ssrcLine","parseGroupSsrcs","ssrcGroup","ssrcStr","getMedia","sdp","getUfrag","ufragLines","startsWith","preferVideoCodec","codecName","payloadType","rtp","codec","payload","payloadTypes","payloads","payloadIndex","unshift","stripVideoCodec","removePts","rtxApts","item","rtxPts","fmtp","keepPts","rtcpFb","parser","writer","write","parseFmtpConfig","parseParams","parsePayloads","parseRemoteCandidates","parseImageAttributes","parseSimulcastStreamList","EventEmitter","_events","_maxListeners","isFunction","isObject","isUndefined","defaultMaxListeners","setMaxListeners","er","listeners","context","newListener","warned","trace","once","g","fired","list","position","listenerCount","evlistener","emitter","LOCAL_TRACK_STOPPED","TRACK_AUDIO_OUTPUT_CHANGED","TRACK_VIDEOTYPE_CHANGED","max","randomElement","arr","RandomUtil","randomHexDigit","randomHexString","randomAlphanumStr","eval","getCurrent","performance","timing","navigationStart","getConnectionPluginDefinition","base","_class","_classCallCheck","_base","_class2","_ref","setPrototypeOf","_createClass","ConnectionPluginListenable","__WEBPACK_IMPORTED_MODULE_0__util_Listenable__","getLocalStorage","storage","localStorage","_p8","_callStatsUserName","_machineId","username","__WEBPACK_IMPORTED_MODULE_1__util_UsernameGenerator___default","generateUsername","machineId","jitsiMeetId","sessionId","detect","Constants","browserName","chrome","codeBaseType","csioReactNative","csioGetOsName","csioGetOsVer","codeBase","os","osVersion","appVersion","parseFloat","opera","msie","edge","safari","firefox","exec","osName","windows","mac","android","ios","browserVersion","_dereq_","1","Promise","any","promises","SomePromiseArray","promise","setHowMany","setUnwrap","_SomePromiseArray","2","Async","_customScheduler","_isTickUsed","_lateQueue","Queue","_normalQueue","_haveDrainedQueues","_trampolineEnabled","drainQueues","_drainQueues","_schedule","schedule","AsyncInvokeLater","fn","receiver","_queueTick","AsyncInvoke","AsyncSettlePromises","_pushOne","firstLineError","util","setScheduler","prev","hasCustomScheduler","enableTrampoline","disableTrampolineIfNecessary","hasDevTools","haveItemsQueued","fatalError","isNode","process","stderr","exit","throwLater","invokeLater","invoke","settlePromises","_settlePromises","_drainQueue","queue","./queue","./schedule","./util","3","INTERNAL","tryConvertToPromise","calledBind","rejectThis","_reject","targetRejected","promiseRejectionQueued","bindingPromise","_then","bindingResolved","_bitField","_resolveCallback","target","bindingRejected","_propagateFrom","propagateFromFunction","_boundValue","boundValueFunction","maybePromise","_target","_setBoundTo","_setOnCancel","_boundTo","_isBound","resolve","4","old","bluebird","noConflict","./promise","5","cr","callerCache","getterCache","ensureMethod","methodName","classString","caller","namedGetter","indexedGetter","getGetter","canEvaluate","isIdentifier","undefined","propertyName","maybeGetter","6","PromiseArray","apiRejection","tryCatch","errorObj","_async","break","cancel","cancellation","_warn","_isCancellable","_cancelBy","_isFollowing","_followee","_cancelBranched","parent","_cancellationParent","_setWillBeCancelled","_branchHasCancelled","_branchesRemainingToCancel","_enoughBranchesHaveCancelled","canceller","_invokeOnCancel","_cancel","_setCancelled","_cancelPromises","_length","_unsetOnCancel","_onCancelField","isPending","_isCancelled","isCancellable","isCancelled","_doInvokeOnCancel","onCancelCallback","internalOnly","_attachExtraTrace","_resultCancelled","_onCancel","_invokeInternalOnCancel","7","NEXT_FILTER","getKeys","cb","boundTo","predicateLoop","matchesPredicate","./es5","8","Context","_trace","CapturedTrace","peekContext","contextStack","longStackTraces","_promiseCreated","_pushContext","_popContext","_peekContext","deactivateLongStackTraces","activateLongStackTraces","Promise_pushContext","Promise_popContext","Promise_PeekContext","Promise_peekContext","Promise_promiseCreated","ctx","9","generatePromiseLifecycleEventObject","defaultFireEvent","cancellationExecute","executor","reject","onCancel","_attachCancellationCallback","cancellationAttachCancellationCallback","previousOnCancel","cancellationOnCancel","cancellationSetOnCancel","cancellationClearCancellationData","cancellationPropagateFrom","flags","branchesRemainingToCancel","isFulfilled","longStackTracesCaptureStackTrace","longStackTracesAttachExtraTrace","ignoreSelf","canAttachTrace","_parent","attachExtraTrace","__stackCleaned__","parsed","parseStackAndMessage","notEnumerableProp","shouldUseOwnTrace","warnings","warning","Warning","activeFireEvent","formatAndLogError","cleanStack","isTraceLine","stackFramePattern","isInternalFrame","shouldIgnore","indentStackFrames","title","isSoft","formatStack","printWarning","fireRejectionEvent","localHandler","localEventFired","formatNonError","maxChars","longStackTracesIsSupported","captureStackTrace","parseLineInfo","parseLineInfoRegex","_promisesCreated","uncycle","unhandledRejectionHandled","possiblyUnhandledRejection","getDomain","_getDomain","bluebirdFramePattern","nodeFramePattern","parseLinePattern","debugging","env","wForgottenReturn","suppressUnhandledRejections","_ensurePossibleRejectionHandled","_setRejectionIsUnhandled","_notifyUnhandledRejection","_notifyUnhandledRejectionIsHandled","_setReturnedNonUndefined","_returnedNonUndefined","_isRejectionUnhandled","_settledValue","_setUnhandledRejectionIsNotified","_unsetUnhandledRejectionIsNotified","_isUnhandledRejectionNotified","_unsetRejectionIsUnhandled","onPossiblyUnhandledRejection","domainBind","onUnhandledRejectionHandled","disableLongStackTraces","Promise_captureStackTrace","_captureStackTrace","Promise_attachExtraTrace","hasLongStackTraces","fireDomEvent","CustomEvent","global","dispatchEvent","domEvent","detail","cancelable","Event","createEvent","initCustomEvent","fireGlobalEvent","method","eventToObjectGenerator","promiseCreated","promiseFulfilled","promiseRejected","promiseResolved","promiseCancelled","promiseChained","unhandledRejection","rejectionHandled","globalEventFired","domEventFired","opts","warningsOption","_clearCancellationData","_execute","monitoring","_fireEvent","inherits","nodes","stackToIndex","cycleEdgeNode","currentChildLength","stacks","current","currentLastIndex","currentLastLine","commonRootMeetPoint","v8stackFramePattern","v8stackFormatter","stackTraceLimit","ignoreUntil","hasStackAfterThrow","isTTY","color","checkForgottenReturns","returnValue","handlerLine","creatorLine","traceLines","lineMatches","firstUserLine","setBounds","lastLineError","firstFileName","lastFileName","firstStackLines","lastStackLines","firstIndex","replacement","./errors","10","returner","thrower","thenReturn","throw","thenThrow","catchThrow","_reason","caught","catchReturn","_value","11","promiseAllThis","PromiseAll","PromiseReduce","reduce","all","each","mapSeries","12","subError","nameProperty","defaultMessage","SubError","OperationalError","cause","isOperational","_TypeError","_RangeError","es5","Objectfreeze","freeze","CancellationError","TimeoutError","AggregateError","RangeError","methods","indent","errorTypes","__BluebirdErrorTypes__","RejectionError","13","isES5","getDescriptor","getOwnPropertyDescriptor","names","getOwnPropertyNames","propertyIsWritable","descriptor","ObjectKeys","14","PromiseMap","15","PassThroughHandlerContext","called","cancelPromise","FinallyHandlerCancelReaction","finallyHandler","checkCancel","succeed","fail","reasonOrValue","isFinallyHandler","isRejected","catchFilter","_passThrough","success","then","lastly","finally","tap","tapCatch","handlerOrPredicate","catchInstances","./catch_filter","16","Proxyable","PromiseSpawn","generatorFunction","yieldHandler","internal","_finallyPromise","_promise","_stack","_generatorFunction","_receiver","_generator","_yieldHandlers","yieldHandlers","_yieldedPromise","_cancellationPhase","_isResolved","_cleanup","_fulfill","_promiseCancelled","coroutine","returnSentinel","_continue","_promiseFulfilled","_promiseRejected","_run","_rejectCallback","traceParent","bitField","_proxy","PromiseSpawn$","generator","spawn","addYieldHandler","17","last","spread","18","MappingPromiseArray","limit","_filter","constructor$","_preservedValues","_limit","_inFlight","_queue","_asyncInit","concurrency","isFinite","_init$","_init","_values","preservedValues","_totalResolved","_resolve","booleans","19","_resolveFromSyncValue","attempt","try","20","wrapAsOperationalError","rErrorKey","markAsOriginatingFromRejection","maybeWrapAsError","multiArgs","wrapped","21","spreadAdapter","val","nodeback","successAdapter","errorAdapter","newReason","asCallback","nodeify","adapter","22","_fulfillmentHandler0","_rejectionHandler0","_promise0","_receiver0","_resolveFromExecutor","deferResolve","deferReject","fillTypes","makeSelfResolutionError","reflectHandler","PromiseInspection","UNDEFINED_BINDING","APPLY","createContext","nodebackForPromise","catch","reflect","didFulfill","didReject","_setIsFinal","toJSON","fulfillmentValue","rejectionReason","originatesFromRejection","getNewLibraryCopy","is","fromNode","fromCallback","_isFateSealed","_setAsyncGuaranteed","cast","_setFulfilled","fulfilled","rejected","internalData","haveInternalData","settler","_settlePromiseCtx","_settlePromiseLateCancellationObserver","_addCallbacks","_setLength","_setRejected","_setFollowing","_isFinal","_unsetCancelled","_receiverAt","_promiseAt","_fulfillmentHandlerAt","_rejectionHandlerAt","_migrateCallback0","follower","fulfill","_migrateCallbackAt","proxyable","shouldBind","_setFollowee","synchronous","ignoreNonErrorWarnings","ensureErrorObject","hasStack","_settlePromiseFromHandler","_settlePromise","isPromise","asyncGuaranteed","_settlePromise0","_clearCallbackDataAtIndex","_fulfillPromises","_rejectPromises","defer","pending","toFastProperties","./any.js","./async","./bind","./call_get.js","./cancel","./context","./debuggability","./direct_resolve","./each.js","./filter.js","./finally","./generators.js","./join","./map.js","./method","./nodeback","./nodeify.js","./promise_array","./promisify.js","./props.js","./race.js","./reduce.js","./settle.js","./some.js","./synchronous_inspection","./thenables","./timers.js","./using.js","23","resolveValueIfEmpty","asArray","_iterate","_resolveEmptyArray","getActualLength","shouldCopyValues","isResolved","24","propsFilter","noCopyPropsPattern","isPromisified","__isPromisified__","promisifiableMethods","suffixRegexp","inheritedDataKeys","passesDefaultFilter","defaultFilter","getDataPropertyOrDefault","defaultPromisified","keyWithoutAsyncSuffix","promisifyAll","promisifier","RegExp","escapeIdentRegex","promisifiedKey","makeNodePromisified","THIS","promisified","withAppended","makeNodePromisifiedEval","__","defaultThis","promisify","copyDescriptors","isClass","25","PropertiesPromiseArray","entries","isMap","Es6Map","mapToEntries","_isMap","props","castValue","extractEntry","keyOffset","26","capacity","_capacity","_front","_willBeOverCapacity","_checkCapacity","wrapMask","front","_resizeTo","oldCapacity","src","srcIndex","dst","dstIndex","27","race","raceLater","28","ReductionPromiseArray","initialValue","_each","_fn","_initialValue","_currentCancellable","_eachValues","completed","valueOrReason","gotAccum","accum","_gotAccum","gotValue","_eachComplete","sender","_resultCancelled$","29","NativePromise","getNativePromise","MutationObserver","GlobalSetImmediate","setImmediate","ProcessNextTick","nextTick","isRecentNode","nativePromise","standalone","cordova","div","toggleScheduled","div2","classList","toggle","observe","30","SettledPromiseArray","_promiseResolved","inspection","_settledValueField","settle","31","_howMany","_unwrap","_initialized","some","howMany","CANCELLATION","isArrayResolved","_canPossiblyFulfill","_getRangeError","count","_addFulfilled","_fulfilled","_addRejected","_checkOutcome","_rejected","32","__isCancelled","33","34","HandleWrapper","handle","successClear","failureClear","afterValue","delay","ms","handleWrapper","35","resources","thenable","_isDisposable","_getDisposer","_setDisposable","tryDispose","Disposer","_context","FunctionDisposer","maybeUnwrapDisposer","isDisposer","ResourceList","NULL","doDispose","_unsetDisposable","using","spreadArgs","disposer","reflectedResources","resultPromise","inspections","_disposer","36","tryCatcher","tryCatchTarget","isPrimitive","maybeError","safeToString","appendee","defaultValue","hasMethods","hasMethodsOtherThanConstructor","hasThisAssignmentAndStaticMethods","thisAssignmentPattern","FakeConstructor","rident","filledRange","isError","ignore","hasEnvVariables","globalObject","Child","Parent","excludedPrototypes","isExcludedProto","visitedKeys","enumeration","ArrayFrom","itResult","it","loadTimes","versions","P","WRONG_STATE","S","C","assign","peerConnectionIdCounter","rtcTrackIdCounter","RTC","conference","peerConnections","localTracks","_channel","_channelOpen","_lastN","_lastNEndpoints","_pinnedEndpoint","_selectedEndpoint","_lastNChangeListener","_onLastNChanged","__WEBPACK_IMPORTED_MODULE_12__RTCUtils__","isDeviceChangeAvailable","__WEBPACK_IMPORTED_MODULE_11__service_RTC_RTCEvents___default","deviceId","_updateAudioOutputForAudioTracks","getAudioOutputDevice","__WEBPACK_IMPORTED_MODULE_7__util_Listenable__","wsUrl","_this2","__WEBPACK_IMPORTED_MODULE_1__BridgeChannel__","_channelOpenListener","sendPinnedEndpointMessage","sendSelectedEndpointMessage","__WEBPACK_IMPORTED_MODULE_2__util_GlobalOnErrorHandler___default","sendSetLastNMessage","leavingLastNEndpoints","enteringLastNEndpoints","_this3","lastNEndpoints","oldLastNEndpoints","isInLastN","__WEBPACK_IMPORTED_MODULE_3__JitsiConferenceEvents__","mode","maxFrameHeight","sendReceiverVideoConstraintMessage","signaling","iceConfig","isP2P","pcConstraints","getPCConstraints","abtestSuspendVideo","setSuspendVideo","__WEBPACK_IMPORTED_MODULE_13__statistics_statistics__","addPermanentProperties","__WEBPACK_IMPORTED_MODULE_8__util_MathUtil__","newConnection","__WEBPACK_IMPORTED_MODULE_14__TraceablePeerConnection__","traceablePeerConnection","track","localVideo","getLocalTracks","__WEBPACK_IMPORTED_MODULE_9__service_RTC_MediaType__","localAudio","tracks","getType","remoteTracks","pcRemoteTracks","getRemoteTracks","mutePromises","audioTrack","mute","unmute","owner","removedTracks","pcRemovedTracks","removeRemoteTracks","audioLevel","getTrackBySSRC","isAudioTrack","setAudioLevel","sendMessage","remoteAudioTracks","setAudioOutput","usesNewGumFlow","__WEBPACK_IMPORTED_MODULE_10__browser__","newObtainAudioAndVideoPermissions","obtainAudioAndVideoPermissions","tracksInfo","newTracks","metaData","sourceId","sourceType","videoType","_track$getSettings","getSettings","facingMode","__WEBPACK_IMPORTED_MODULE_4__JitsiLocalTrack__","kind","rtcId","trackInfo","micDeviceId","__WEBPACK_IMPORTED_MODULE_15__service_RTC_VideoType___default","cameraDeviceId","localTrack","_isReceivingData","__WEBPACK_IMPORTED_MODULE_5__JitsiTrackError__","__WEBPACK_IMPORTED_MODULE_6__JitsiTrackErrors__","eventType","isRTCReady","getDeviceAvailability","p2pPcConstraints","elSelector","attachMediaStream","getStreamID","getTrackID","isDeviceListAvailable","deviceType","getCurrentlyAvailableMediaDevices","device","getEventDataForActiveDevice","setAudioOutputDevice","isUserStreamById","streamId","enumerateDevices","mediaStream","stopMediaStream","isDesktopSharingEnabled","getConstraints","um","isNewStyleConstraintsSupported","resolution","audio","__WEBPACK_IMPORTED_MODULE_9__browser__","isTemasysPluginUsed","optional","__WEBPACK_IMPORTED_MODULE_1__service_RTC_CameraFacingMode___default","USER","minFps","maxFps","fps","minFrameRate","maxFrameRate","__WEBPACK_IMPORTED_MODULE_8__service_RTC_Resolutions___default","width","ideal","height","maxWidth","maxHeight","echoCancellation","disableAEC","disableAP","googEchoCancellation","googAutoGainControl","disableAGC","googNoiseSuppression","disableNS","googHighpassFilter","disableHPF","googNoiseSuppression2","googEchoCancellation2","googAutoGainControl2","chromeMediaSource","screen","AdapterJS","WebRTCPlugin","screensharingKey","mozMediaSource","mediaSource","errmsg","__WEBPACK_IMPORTED_MODULE_4__util_GlobalOnErrorHandler___default","chromeMediaSourceId","desktopStream","bandwidth","firefox_fake_device","fake","setAvailableDevices","audioTracksReceived","getAudioTracks","videoTracksReceived","getVideoTracks","__WEBPACK_IMPORTED_MODULE_10__service_RTC_RTCEvents___default","pollForAvailableMediaDevices","rawEnumerateDevicesWithCallback","ds","currentlyAvailableMediaDevices","newDevices","mediaDeviceInfoToJSON","groupId","label","facing","onMediaDevicesListChanged","AVAILABLE_DEVICES_POLL_INTERVAL_TIME","sendDeviceListToAnalytics","deviceList","audioInputDeviceCount","audioOutputDeviceCount","videoInputDeviceCount","videoOutputDeviceCount","audio_input_device_count","audio_output_device_count","video_input_device_count","video_output_device_count","device_id","device_group_id","device_kind","device_label","__WEBPACK_IMPORTED_MODULE_14__statistics_statistics__","__WEBPACK_IMPORTED_MODULE_0__service_statistics_AnalyticsEvents__","devicesReceived","videoInputDevices","audioInputDevices","videoInputDevicesWithEmptyLabels","audioInputDevicesWithEmptyLabels","maybeApply","wrapGetUserMedia","getUserMedia","successCallback","errorCallback","enumerateDevicesThroughMediaStreamTrack","MediaStreamTrack","getSources","sources","convertMediaStreamTrackSource","defaultSetVideoSrc","srcObjectPropertyName","jitsiObjectURL","URL","webkitURL","createObjectURL","onReady","GUM","rtcReady","__WEBPACK_IMPORTED_MODULE_12__ScreenObtainer__","rtcUtils","isDeviceChangeEventSupported","wrapAttachMediaStream","origAttachMediaStream","res","audioOutputChanged","setSinkId","ex","__WEBPACK_IMPORTED_MODULE_3_jitsi_meet_logger__","__WEBPACK_IMPORTED_MODULE_2_events___default","audioOutputDeviceId","featureDetectionAudioEl","isAudioOutputDeviceChangeAvailable","DEFAULT_CONSTRAINTS","aspectRatio","RTCUtils","__WEBPACK_IMPORTED_MODULE_6__util_Listenable__","R","RTCPeerConnectionType","RTCPeerConnection","foundDevices","srcObject","isOpera","__WEBPACK_IMPORTED_MODULE_13__xmpp_SDPUtil__","webkitMediaStream","videoTracks","audioTracks","__WEBPACK_IMPORTED_MODULE_11__ortc_RTCPeerConnection__","jitsiRemoteId","webRTCReadyPromise","webRTCReady","isPluginInstalled","pluginInfo","plugName","containerSel","$","show","getUserMediaWithConstraints","_initPCConstraints","googHighStartBitrate","googPayloadPadding","googScreencastMinBitrate","googCpuOveruseDetection","googCpuOveruseEncodeUsage","googCpuUnderuseThreshold","googCpuOveruseThreshold","useIPv6","googIPv6","disableSuspendVideo","googSuspendBelowMinBitrate","failureCallback","umDevices","desktopSharingExtensionExternalInstallation","desktopSharingSources","supportsVideo","desktopSharingOptions","obtainStream","_this4","dsOptions","streams","audioStream","videoStream","audioVideo","NativeMediaStream","MediaStream","addTrack","desktop","_desktopStream","__WEBPACK_IMPORTED_MODULE_7__service_RTC_MediaType__","deviceGUM","obtainDevices","hasDesktop","audioDeviceRequested","videoDeviceRequested","mediaStreamsMetaData","maybeRequestDesktopDevice","_newGetDesktopMedia","maybeRequestCaptureDevices","requestedCaptureDevices","_newGetUserMediaWithConstraints","avStream","Boolean","onRTCReady","_isDeviceListAvailable","getTracks","release","url","revokeObjectURL","deviceData","enable","re","parsePrimarySSRC","parseSecondarySSRC","_getSSRCCount","MLineWrap","ssrcNumber","attrName","ssrcObj","ssrcNum","primarySSRC","msid","findGroup","fecGroup","findGroupByPrimarySSRC","videoSSRCs","getSSRCs","ssrcGroupInfo","secondarySsrc","groupInfo","oldSSRC","newSSRC","SdpTransformWrap","rawSDP","parsedSDP","__WEBPACK_IMPORTED_MODULE_0_sdp_transform__","selectedMLine","ERROR_SESSION_EXISTS","STATUS_AVAILABLE","STATUS_UNDEFINED","STATUS_BUSY","STATE_ON","STATE_OFF","STATE_PENDING","STATE_RETRYING","STATE_FAILED","ERROR_NO_CONNECTION","REMOTE_STATS_UPDATED","LOCAL_STATS_UPDATED","VIDEOBRIDGE_NOT_AVAILABLE","CHAT_ERROR","CONFERENCE_DESTROYED","CONFERENCE_MAX_USERS","CONNECTION_ERROR","NOT_ALLOWED_ERROR","INCOMPATIBLE_SERVER_VERSIONS","PASSWORD_NOT_SUPPORTED","SETUP_FAILED","SWPlugin","attaches","signalListeners","mapFnc","remove","notify","addMapFnc","mapping","addSignalListener","signalName","signalize","defaultSetTimout","defaultClearTimeout","runTimeout","fun","cachedSetTimeout","cleanUpNextTick","draining","currentQueue","queueIndex","drainQueue","marker","cachedClearTimeout","Item","noop","argv","prependListener","prependOnceListener","binding","cwd","chdir","dir","umask","1080","order","fullhd","720","hd","960","360","640","vga","180","320","DEFAULT_NOT_IN_LAST_N_TIMEOUT","DEFAULT_RTC_MUTE_TIMEOUT","ParticipantConnectionStatus","ACTIVE","INACTIVE","INTERRUPTED","RESTORING","ParticipantConnectionStatusHandler","rtc","trackTimers","connStatusFromJvb","outOfLastNTimeout","rtcMuteTimeout","rtcMutedTimestamp","enteredLastNTimestamp","restoringTimers","isConnectionActiveByJvb","isRestoringTimedout","isVideoMuted","isVideoTrackFrozen","__WEBPACK_IMPORTED_MODULE_4__browser__","supportsVideoMuteOnConnInterrupted","_onEndpointConnStatusChanged","onEndpointConnStatusChanged","__WEBPACK_IMPORTED_MODULE_5__service_RTC_RTCEvents___default","_onP2PStatus","refreshConnectionStatusForAll","__WEBPACK_IMPORTED_MODULE_1__JitsiConferenceEvents__","_onTrackRtcMuted","onTrackRtcMuted","_onTrackRtcUnmuted","onTrackRtcUnmuted","_onRemoteTrackAdded","onRemoteTrackAdded","_onRemoteTrackRemoved","onRemoteTrackRemoved","_onSignallingMuteChanged","onSignallingMuteChanged","_onLastNValueChanged","participantIds","participantId","clearRtcMutedTimestamp","endpointId","isActive","myUserId","figureOutConnectionStatus","participant","newStatus","getConnectionStatus","getId","_setConnectionStatus","__WEBPACK_IMPORTED_MODULE_6__statistics_statistics__","remoteTrack","__WEBPACK_IMPORTED_MODULE_3__service_RTC_MediaType__","getParticipantId","__WEBPACK_IMPORTED_MODULE_2__JitsiTrackEvents__","hasAnyVideoRTCMuted","hasAnyVideoTrackWebRTCMuted","_getVideoFrozenTimeout","participants","getParticipants","getParticipantById","inP2PMode","isP2PActive","isRestoringTimedOut","_isRestoringTimedout","audioOnlyMode","getLastN","isConnActiveByJvb","newState","_getNewStateForP2PMode","_getNewStateForJvbMode","_clearRestoringTimer","_changeConnectionStatus","leavingLastN","enteringLastN","rTimer","isMuted","onwebrtcready","isUsingPlugin","_onwebrtcreadies","onwebrtcreadyDone","pluginId","onload","portalLink","downloadLink","companyName","downloadLinks","win","platform","TAGS","NONE","pageId","defineWebRTCInterface","pluginInjectionInterval","injectPlugin","PLUGIN_STATES","INITIALIZING","INJECTING","INJECTED","READY","pluginState","PLUGIN_LOG_LEVELS","WARNING","VERBOSE","SENSITIVE","WaitForPluginReady","callWhenPluginReady","__TemWebRTCReady0","maybeThroughWebRTCReady","timer","setInterval","clearInterval","PLUGIN","REQUIRE_INSTALLATION","NOT_SUPPORTED","BUTTON","REFRESH","REQUIRE_REFRESH","_iceConnectionStates","starting","checking","disconnected","failed","closed","_iceConnectionFiredStates","isDefined","parseWebrtcDetectedBrowser","hasMatch","opr","addons","webrtcDetectedBrowser","webrtcDetectedVersion","webrtcMinimumVersion","webrtcDetectedType","webrtcDetectedDCSupport","chromiumVersion","StyleMedia","InstallTrigger","webstore","isMobile","addEvent","evnt","attachEvent","renderNotificationBar","buttonText","buttonLink","openNewTab","displayRefreshBar","top","left","right","backgroundColor","border","borderBottom","zIndex","webkitTransition","transition","contentWindow","contentDocument","getElementById","EXTENSION","preventDefault","cancelBubble","pluginInstallInterval","isIE","plugins","refresh","removeChild","webkitTransform","transform","checkMediaDataChannelSettings","peerBrowserAgent","peerBrowserVersion","beOfferer","isLocalFirefox","isLocalFirefoxInterop","isPeerFirefox","MozDontOfferDataChannel","checkIceConnectionState","peerId","iceConnectionState","createIceServer","createIceServers","RTCSessionDescription","RTCIceCandidate","reattachMediaStream","exception","time","timeEnd","groupCollapsed","groupEnd","checkPluginReadyState","logLevel","getAllCams","comName","plugType","installedCb","notInstalledCb","pluginArray","mimeTypes","variable","password","iceServer","urlParts","hasCredentials","credential","urls","iceServers","ConstructSessionDescription","servers","invalidConstraits","PEER_CONNECTION_VERSION","PeerConnection","GetSources","constraintsToPlugin","cc","exact","oldname","toUpperCase","oc","mix","advanced","requestUserMedia","kinds","enableSoundTracks","elementId","temp","classHTML","className","class","clientWidth","clientHeight","insertBefore","children","setStreamId","newElement","forwardEventHandlers","getStreamWithId","destElem","srcElem","propName","subPrototype","sdpMid","ConstructIceCandidate","sdpMLineIndex","pluginNeededButNotInstalledCb","pluginNeededButNotInstalledCbPriv","hidePluginInstallPrompt","popupString","SDPUtils","localCName","generateIdentifier","splitLines","blob","trim","splitSections","matchPrefix","parseCandidate","relatedAddress","relatedPort","tcpType","writeCandidate","parseRtpMap","clockRate","numChannels","writeRtpMap","preferredPayloadType","writeExtmap","headerExtension","preferredId","kv","writeFmtp","parameters","param","parseRtcpFb","parameter","writeRtcpFb","rtcpFeedback","fb","parseSsrcMedia","sp","colon","getDtlsParameters","mediaSection","fpLine","role","fingerprints","algorithm","writeDtlsParameters","setupType","fp","getIceParameters","usernameFragment","writeIceParameters","parseRtpParameters","description","codecs","headerExtensions","fecMechanisms","rtcp","rtpmapline","fmtps","writeRtpDescription","caps","parseRtpEncodingParameters","encodingParameters","hasRed","hasUlpfec","flows","apt","encParam","codecPayloadType","rtx","fec","maxBitrate","writeSessionBoilerplate","writeMediaSection","transceiver","iceGatherer","getLocalParameters","dtlsTransport","mid","rtpSender","rtpReceiver","sendEncodingParameters","getDirection","logging","browserDetails","chromeShim","edgeShim","firefoxShim","safariShim","shimPeerConnection","browserShim","shimGetUserMedia","shimMediaStream","shimSourceObject","shimOnTrack","./chrome/chrome_shim","./edge/edge_shim","./firefox/firefox_shim","./safari/safari_shim","./utils","_ontrack","_ontrackpoly","te","HTMLMediaElement","_srcObject","pcConfig","iceTransportPolicy","iceTransports","pc","origGetStats","getStats","selector","fixChromeStats_","standardReport","report","standardStats","timestamp","stat","makeMapStats","legacyStats","generateCertificate","nativeMethod","nativeAddIceCandidate","addIceCandidate","../utils.js","./getusermedia","constraintsToChrome_","oldname_","shimConstraints_","face","getSupportedConstraints","back","shimError_","PermissionDeniedError","ConstraintNotSatisfiedError","onError","getUserMediaPromise_","origGetUserMedia","RTCIceGatherer","_eventTarget","onicecandidate","onaddstream","ontrack","onremovestream","onsignalingstatechange","oniceconnectionstatechange","onnegotiationneeded","ondatachannel","localStreams","remoteStreams","getLocalStreams","getRemoteStreams","localDescription","remoteDescription","signalingState","iceGatheringState","iceOptions","gatherPolicy","usingBundle","bundlePolicy","server","transceivers","_localIceCandidatesBuffer","_emitBufferedCandidates","sections","every","state","addStream","clone","_maybeFireNegotiationNeeded","removeStream","idx","getSenders","getReceivers","_getCommonCapabilities","localCapabilities","remoteCapabilities","commonCapabilities","lCodec","rCodec","lHeaderExtension","rHeaderExtension","_createIceAndDtlsTransports","iceTransport","RTCIceTransport","onlocalcandidate","evt","end","complete","onicestatechange","_updateConnectionState","RTCDtlsTransport","ondtlsstatechange","_transceive","recv","encodings","cname","recvEncodingParameters","receive","setLocalDescription","_pendingOffer","isIceLite","isDatachannel","remoteIceParameters","cands","setRemoteCandidates","remoteDtlsParameters","_updateSignalingState","hasCallback","setRemoteDescription","receiverList","remoteSsrc","isComplete","RTCRtpReceiver","getCapabilities","RTCRtpSender","trackEvent","states","new","connecting","createOffer","offerOptions","numAudioTracks","numVideoTracks","offerToReceiveAudio","offerToReceiveVideo","wantReceive","createAnswer","addRemoteCandidate","mLineIndex","results","../utils","mozSrcObject","mozRTCPeerConnection","newIceServers","newServer","mozRTCSessionDescription","mozRTCIceCandidate","nativeGetStats","onSucc","onErr","SecurityError","The operation is insecure.","getUserMedia_","constraintsToFF37_","orgEnumerateDevices","successCb","turnUrlParts","attachMediaStream_base","reattachMediaStream_base","baseGetUserMedia","REQUIRE_INSTALLATION_FF","REQUIRE_INSTALLATION_CHROME","BUTTON_FF","BUTTON_CHROME","copy","failureCb","updatedConstraints","checkIfReady","chromeCallback","onIFrameCallback","chromeExtensionStatus","postFrameMessage","captureSourceId","HasScreensharingFeature","isScreensharingAvailable","iframe","isLoaded","display","postMessage","callerInfo","fileLocation","column","globalTransports","consoleTransport","transportIdx","LOG","REACT_NATIVE","CHROME","OPERA","FIREFOX","INTERNET_EXPLORER","EDGE","SAFARI","NWJS","ELECTRON","Timeout","clearFn","_id","_clearFn","unref","ref","enroll","msecs","_idleTimeoutId","unenroll","_unrefActive","active","_onTimeout","clearImmediate","TurnTest","resolveCb","rejectCb","setMessageCallback","handleMessage","setErrorCallback","handleError","forceStopped","initiate","finished","randomAsciiString","MessageMaker","Timestamps","sentBytes","padding","LocalStatsCollector","interval","intervalId","intervalMilis","__WEBPACK_IMPORTED_MODULE_0__browser__","AudioContext","webkitAudioContext","suspend","isLocalStatsSupported","analyser","createAnalyser","smoothingTimeConstant","fftSize","createMediaStreamSource","Uint8Array","frequencyBinCount","getByteTimeDomainData","newLevel","lastLevel","diff","samples","maxVolume","toFixed","CONNECTION_STATS","AUDIO_LEVEL","BEFORE_DISPOSED","BYTE_SENT_STATS","currentExecutingScript","ScriptUtil","prepend","relativeURL","loadCallback","script","referenceNode","scriptEl","scriptSrc","baseScriptSrc","lastIndexOf","XMPP","token","disconnectInProgress","connectionTimes","authenticatedUser","_initStrophePlugins","bosh","conn","__WEBPACK_IMPORTED_MODULE_1_strophe_js__","__WEBPACK_IMPORTED_MODULE_14__Caps__","clientNode","initFeaturesList","__WEBPACK_IMPORTED_MODULE_13__util_Listenable__","addFeature","disableRtx","supportsRtx","enableLipSync","rayo","credentials","statusStr","getStatusString","useStunTurn","p2p","jingle","getStunAndTurnCredentials","pingJid","ping","hasPingSupport","hasPing","startInterval","__WEBPACK_IMPORTED_MODULE_5__JitsiConnectionEvents__","anonymousConnectionFailed","connectionFailed","lastErrorMsg","__WEBPACK_IMPORTED_MODULE_4__JitsiConnectionErrors__","OTHER_ERROR","stopInterval","wasIntentionalDisconnect","errMsg","_getConnectionFailedReasonDetails","lastErrorStatus","getLastErrorStatus","SERVER_ERROR","CONNECTION_DROPPED_ERROR","connectionHandler","attaching","_options$hosts","hosts","anonymousdomain","configDomain","hostname","mucNickname","roomjid","muc","cfgNickname","useNicks","nick","__WEBPACK_IMPORTED_MODULE_3__util_RandomUtil___default","emuc","createRoom","getLog","_connection$rayo","dial","moderate","setMute","eject","sessions","ev","evType","jvb","p2pStunServers","stunServers","__WEBPACK_IMPORTED_MODULE_7__strophe_emuc__","__WEBPACK_IMPORTED_MODULE_8__strophe_jingle__","__WEBPACK_IMPORTED_MODULE_9__strophe_util__","__WEBPACK_IMPORTED_MODULE_10__strophe_ping__","__WEBPACK_IMPORTED_MODULE_11__strophe_rayo__","__WEBPACK_IMPORTED_MODULE_12__strophe_logger__","deploymentInfo","shard","shard_changed","suspend_time","getPingSuspendTime","OFF","ON","IDENTITY_UPDATED","getJibriErrorDetails","errorIqNode","querySelector","errorText","errorChild","Recording","focusMucJid","jirecon","_isSupported","types","JIRECON","JIBRI","JIBRI_FILE","COLIBRI","jireconRid","XMPPEvents","JitsiRecorderErrors","AVAILABLE","UNAVAILABLE","PENDING","RETRYING","BUSY","FAILED","START","STOP","handleJibriPresence","jibri","errorDetails","setRecordingJibri","errCallback","INVALID_STATE","recording_mode","streamid","setRecordingJirecon","mucjid","stateStr","setRecordingColibri","setRecording","toggleRecording","statusChangeHandler","oldState","RECORDER_UNAVAILABLE","RECORDER_BUSY","NO_TOKEN","getState","getURL","STATE_CHANGE_FAILED","ENDED","SDP","mediaI","failICE","removeTcpCandidates","removeUdpCandidates","getMediaSsrcMap","mediaSSRCs","tmp","mediaindex","__WEBPACK_IMPORTED_MODULE_0__SDPUtil__","linessrc","containsSSRC","medias","mangle","newdesc","rtpmap","removeSessionLines","removeMediaLines","toJingle","thecreator","assrcline","creator","amidline","afmtpline","rtcpFbToJingle","crypto","required","ssrcMap","_ref2","_slicedToArray","availableSsrc","ssrcParameters","ssrcSdpLine","ridLines","rids","ridLine","ridInfo","senders","transportToJingle","sctpmap","sctpAttrs","number","setup","payloadtype","subtype","rtcpFbFromJingle","fromJingle","groups","contents","jingle2media","sctp","streamCount","PEER_VIDEO_TYPE_CHANGED","PEER_MUTED_CHANGED","addMediaStreamInactiveHandler","onended","oninactive","__WEBPACK_IMPORTED_MODULE_1_jitsi_meet_logger__","trackHandler2Prop","track_mute","track_unmute","track_ended","JitsiTrack","streamInactiveHandler","trackMediaType","containers","disposed","_streamInactiveHandler","_setStream","_setHandler","container","_onTrackAttach","__WEBPACK_IMPORTED_MODULE_4__RTCUtils__","_maybeFireTrackAttached","_attachTTFMTracker","getStreamId","trackId","getTrackId","isVideoTrack","ENVIRONMENT","grammar","reg","z","encoding","rate","address","sessionConfig","raddr","maxMessageSize","dir2","parseIceOptions","getMid","maxptime","extension","parseRtcpParameters","rtcpParameters","rsize","reducedSize","compound","mux","parseMsid","spec","planB","generateSessionId","sessId","sessVer","getKind","startRecorder","trackRecorder","recorder","startTime","stopRecorder","determineCorrectFileType","MediaRecorder","isTypeSupported","AUDIO_WEBM","AUDIO_OGG","AudioRecorder","jitsiConference","recorders","fileType","isRecording","RecordingResult","instantiateTrackRecorder","updateNames","originalStream","getOriginalStream","mimeType","ondataavailable","dataEvent","removeTrack","recorderToRemove","newName","getDisplayName","download","Blob","href","click","getRecordingResults","getFileType","PERMISSION_PROMPT_IS_SHOWN","getAnalyticsAttributesFromOptions","audio_requested","includes","video_requested","screen_sharing_requested","__WEBPACK_IMPORTED_MODULE_27__modules_videosipgw_VideoSIPGWConstants__","__WEBPACK_IMPORTED_MODULE_18_jitsi_meet_logger___default","JitsiConnection","__WEBPACK_IMPORTED_MODULE_6__JitsiConnection__","constants","participantConnectionStatus","__WEBPACK_IMPORTED_MODULE_21__modules_connectivity_ParticipantConnectionStatus__","recordingStatus","__WEBPACK_IMPORTED_MODULE_17__modules_xmpp_recording__","recordingTypes","sipVideoGW","transcriptionStatus","__WEBPACK_IMPORTED_MODULE_15__JitsiTranscriptionStatus__","events","__WEBPACK_IMPORTED_MODULE_5__JitsiConferenceEvents__","__WEBPACK_IMPORTED_MODULE_8__JitsiConnectionEvents__","__WEBPACK_IMPORTED_MODULE_14__JitsiTrackEvents__","__WEBPACK_IMPORTED_MODULE_10__JitsiMediaDevicesEvents__","connectionQuality","__WEBPACK_IMPORTED_MODULE_2__service_connectivity_ConnectionQualityEvents__","__WEBPACK_IMPORTED_MODULE_4__JitsiConferenceErrors__","__WEBPACK_IMPORTED_MODULE_7__JitsiConnectionErrors__","__WEBPACK_IMPORTED_MODULE_11__JitsiRecorderErrors___default","__WEBPACK_IMPORTED_MODULE_13__JitsiTrackErrors__","__WEBPACK_IMPORTED_MODULE_12__JitsiTrackError__","logLevels","__WEBPACK_IMPORTED_MODULE_9__JitsiMediaDevices__","__WEBPACK_IMPORTED_MODULE_26__modules_statistics_statistics__","enableAnalyticsLogging","enableWindowOnErrorHandler","__WEBPACK_IMPORTED_MODULE_3__modules_util_GlobalOnErrorHandler___default","getGlobalOnErrorHandler","aprops","logObject","__WEBPACK_IMPORTED_MODULE_22__modules_RTC_RTC__","addGlobalLogTransport","globalTransport","removeGlobalLogTransport","createLocalTracks","emitEvent","__WEBPACK_IMPORTED_MODULE_23__modules_browser__","mStream","__WEBPACK_IMPORTED_MODULE_19__service_RTC_MediaType__","_setRealDeviceIdFromDeviceList","oldResolution","newResolution","__WEBPACK_IMPORTED_MODULE_20__service_RTC_Resolutions___default","resName","old_resolution","new_resolution","isMultipleAudioInputSupported","isCollectingLocalStats","__WEBPACK_IMPORTED_MODULE_16__modules_statistics_LocalStatsCollector__","lineno","colno","AuthUtil","__WEBPACK_IMPORTED_MODULE_1__modules_util_AuthUtil___default","RTCUIHelper","__WEBPACK_IMPORTED_MODULE_24__modules_RTC_RTCUIHelper__","__WEBPACK_IMPORTED_MODULE_25__modules_util_ScriptUtil___default","getTokenAuthUrl","urlPattern","roleUpgrade","appID","__WEBPACK_IMPORTED_MODULE_4__modules_xmpp_xmpp__","__WEBPACK_IMPORTED_MODULE_2__JitsiConnectionEvents__","errType","__WEBPACK_IMPORTED_MODULE_3__modules_statistics_statistics__","_xmpp","setToken","initJitsiConference","__WEBPACK_IMPORTED_MODULE_1__JitsiConference__","getConnectionTimes","feature","submit","removeFeature","JitsiConference","__WEBPACK_IMPORTED_MODULE_7_events___default","eventManager","__WEBPACK_IMPORTED_MODULE_10__JitsiConferenceEventManager__","componentsVersions","__WEBPACK_IMPORTED_MODULE_3__modules_version_ComponentsVersions__","jvbJingleSession","lastDominantSpeaker","dtmfManager","somebodySupportsDTMF","authEnabled","startAudioMuted","startVideoMuted","startMutedPolicy","availableDevices","isMutedByFocus","wasStopped","__WEBPACK_IMPORTED_MODULE_4__modules_connectivity_ConnectionQuality__","avgRtpStatsReporter","__WEBPACK_IMPORTED_MODULE_2__modules_statistics_AvgRTPStatsReporter__","avgRtpStatsN","isJvbConnectionInterrupted","speakerStatsCollector","__WEBPACK_IMPORTED_MODULE_31__modules_statistics_SpeakerStatsCollector__","deferredStartP2PTask","backToP2PDelay","isP2PConnectionInterrupted","p2pJingleSession","videoSIPGWHandler","__WEBPACK_IMPORTED_MODULE_28__modules_videosipgw_VideoSIPGW__","room","__WEBPACK_IMPORTED_MODULE_5_jitsi_meet_logger__","setupXMPPListeners","_onIceConnectionInterrupted","__WEBPACK_IMPORTED_MODULE_30__service_xmpp_XMPPEvents__","_onIceConnectionRestored","_onIceConnectionEstablished","updateDeviceAvailability","__WEBPACK_IMPORTED_MODULE_21__modules_RTC_RTC__","setupRTCListeners","__WEBPACK_IMPORTED_MODULE_19__modules_connectivity_ParticipantConnectionStatus__","_peerConnStatusRtcMuteTimeout","_peerConnStatusOutOfLastNTimeout","windowLocation","enableDisplayNameInStats","displayName","__WEBPACK_IMPORTED_MODULE_24__modules_statistics_statistics__","callStatsCustomScriptUrl","enableStatsID","setupChatRoomListeners","setupStatisticsListeners","enableTalkWhileMuted","__WEBPACK_IMPORTED_MODULE_25__modules_TalkMutedDetection__","__WEBPACK_IMPORTED_MODULE_11__JitsiConferenceEvents__","setLastN","channelLastN","jvb121Status","__WEBPACK_IMPORTED_MODULE_17__modules_event_Jvb121EventGenerator__","p2pDominantSpeakerDetection","__WEBPACK_IMPORTED_MODULE_20__modules_P2PDominantSpeakerDetection__","authenticateAndUpgradeRole","__WEBPACK_IMPORTED_MODULE_8__authenticateAndUpgradeRole__","isJoined","joined","isP2PEnabled","enabled","isP2PTestModeEnabled","testing","p2pTestMode","leave","onLocalTrackRemoved","closeBridgeChannel","onMemberLeft","getJid","isAuthEnabled","isLoggedIn","authIdentity","getAuthLogin","isExternalAuthEnabled","moderator","getExternalAuthUrl","urlForPopup","getPopupLoginUrl","getLoginUrl","getLocalAudioTrack","getLocalVideoTrack","eventId","addCommandListener","command","addPresenceListener","removeCommandListener","removePresenceListener","sendTextMessage","sendPrivateTextMessage","sendPrivateMessage","sendCommand","addToPresence","sendCommandOnce","removeCommand","removeFromPresence","setDisplayName","setSubject","subject","isModerator","getTranscriber","transcriber","__WEBPACK_IMPORTED_MODULE_26__modules_transcription_transcriber___default","localAudioTracks","__WEBPACK_IMPORTED_MODULE_18__service_RTC_MediaType__","getTranscriptionStatus","localVideoTrack","replaceTrack","_fireAudioLevelChangeEvent","activeTpc","getActivePeerConnection","_fireMuteChangeEvent","muteParticipant","myroomjid","_setConference","removeLocalTrack","__WEBPACK_IMPORTED_MODULE_16__JitsiTrackEvents__","muteHandler","audioLevelHandler","__WEBPACK_IMPORTED_MODULE_27__service_RTC_VideoType___default","oldTrack","newTrack","__WEBPACK_IMPORTED_MODULE_14__JitsiTrackError__","__WEBPACK_IMPORTED_MODULE_15__JitsiTrackErrors__","_doReplaceTrack","_setupNewTrack","replaceTrackPromises","getTrack","addLocalTrack","setAudioMute","setVideoMute","_addLocalTrackAsUnmute","addAsUnmutePromises","addTrackAsUnmute","_removeLocalTrackAsMute","removeAsMutePromises","removeTrackAsMute","getRole","lock","_this5","lockRoom","__WEBPACK_IMPORTED_MODULE_9__JitsiConferenceErrors__","unlock","selectParticipant","selectEndpoint","pinParticipant","pinEndpoint","lastN","isInteger","isVideoActive","setMediaTransferActive","getParticipantCount","countHidden","isHidden","kickParticipant","kick","onMemberJoined","statsID","_this6","__WEBPACK_IMPORTED_MODULE_0_strophe_js__","__WEBPACK_IMPORTED_MODULE_13__JitsiParticipant__","_role","getFeatures","_supportsDTMF","updateDTMFSupport","_maybeStartOrStopP2P","_this7","onLocalRoleChanged","onUserRoleChanged","onDisplayNameChanged","_displayName","_this8","_tracks","onCallAccepted","answer","setAnswer","onTransportInfo","transportInfo","addIceCandidates","removedTrack","_this9","_onIncomingCallP2P","jingleSession","jingleOffer","rejectReason","getMemberRole","remoteJid","reasonDescription","errorMsg","__WEBPACK_IMPORTED_MODULE_22__modules_browser__","supportsP2P","_rejectIncomingCall","_acceptP2PIncomingCall","onIncomingCall","isFocus","_acceptJvbIncomingCall","_this10","initialize","__WEBPACK_IMPORTED_MODULE_6__modules_util_GlobalOnErrorHandler___default","_setBridgeChannel","acceptOffer","_suspendMediaTransferForJvbConnection","offerIq","webSocket","first","bridgeChannelType","openBridgeChannel","supportsDataChannels","initializeBridgeChannel","terminate","sendSessionTerminate","onCallEnded","reasonCondition","reasonText","forceJvb121","p2pFailed","_stopP2PSession","onSuspendDetected","supportsDTMF","isDTMFSupported","sendTones","tones","duration","peerConnection","__WEBPACK_IMPORTED_MODULE_12__modules_DTMF_JitsiDTMFManager___default","isRecordingSupported","getRecordingState","getRecordingURL","_this11","isSIPCallingSupported","hangup","startTranscriber","stopTranscriber","getPhoneNumber","getPhonePin","getConnectionState","setStartMutedPolicy","policy","getStartMutedPolicy","isStartAudioMuted","isStartVideoMuted","getLogs","getJingleLog","metadata","ua","getXmppLog","setLocalParticipantProperty","overallFeedback","detailedFeedback","remoteUserId","getLocalSSRC","getSSRC","getUsageLabel","_isFocus","mucJid","_fireIncompatibleVersionsEvent","sendEndpointMessage","sendChannelMessage","broadcastEndpointMessage","isConnectionInterrupted","_onIceConnectionFailed","B","initiator","isInitiator","remoteID","getStatsID","_addRemoteJVBTracks","_addRemoteTracks","_addRemoteP2PTracks","logName","__WEBPACK_IMPORTED_MODULE_23__service_RTC_RTCEvents__","p2pEstablishmentDuration","establishmentDuration","jvbEstablishmentDuration","forceJVB121Ratio","establishmentDurationDiff","_setP2PStatus","_removeRemoteJVBTracks","_maybeClearDeferredStartP2P","_removeRemoteTracks","_removeRemoteP2PTracks","sessionNickname","_resumeMediaTransferForJvbConnection","_startP2PSession","newP2PJingleSession","invite","userLeftEvent","peers","peerCount","shouldBeInP2P","peer","myId","peersId","wasP2PEstablished","getP2PConnectionState","startP2PSession","peerJid","stopP2PSession","getSpeakerStats","setReceiverVideoConstraint","createVideoSIPGWSession","sipAddress","__WEBPACK_IMPORTED_MODULE_29__modules_videosipgw_VideoSIPGWConstants__","AverageStatReport","sum","nextValue","calculate","ConnectionAvgStats","_n","_sampleIdx","_avgRTT","_avgRemoteRTTMap","_avgRtpStatsReporter","_avgEnd2EndRTT","_onConnectionStats","_calculateAvgStats","_conference","_onUserLeft","_onRemoteStatsUpdated","_processRemoteStats","__WEBPACK_IMPORTED_MODULE_5__browser__","supportsRTTStatistics","addNext","rtt","batchReport","conference_size","local_candidate_type","localCandidateType","remote_candidate_type","remoteCandidateType","transport_type","appendReport","jvbEnd2EndRTT","jvbStatsMonitor","rtt_diff","avgRemoteRTT","_calculateAvgRemoteRTT","avgLocalRTT","end2end_rtt_avg","__WEBPACK_IMPORTED_MODULE_6__statistics__","D","_resetAvgStats","remoteAvg","avg","validData","jvbRTT","rttAvg","clear","AvgRTPStatsReporter","_avgAudioBitrateUp","_avgAudioBitrateDown","_avgVideoBitrateUp","_avgVideoBitrateDown","_avgBandwidthUp","_avgBandwidthDown","_avgPacketLossTotal","_avgPacketLossUp","_avgPacketLossDown","_avgRemoteFPS","_avgRemoteScreenFPS","_avgLocalFPS","_avgLocalScreenFPS","_avgRemoteCameraPixels","_avgRemoteScreenPixels","_avgLocalCameraPixels","_avgLocalScreenPixels","_avgCQ","_onLocalStatsUpdated","_onP2PStatusChanged","p2pStatsMonitor","_onJvb121StatusChanged","oldStatus","_resetAvgJvbStats","confSize","bitrate","packetLoss","frameRate","framerate","upload","supportsBandwidthStatistics","total","_calculateAvgVideoFps","__WEBPACK_IMPORTED_MODULE_7__service_RTC_VideoType__","_calculateAvgVideoPixels","peerResolutions","peerPixelsSum","myID","peerID","videosResolution","peerAvgPixels","_calculatePeerAvgVideoPixels","videos","getTracksByMediaType","__WEBPACK_IMPORTED_MODULE_4__service_RTC_MediaType__","peerSsrcCount","peerSsrcPixels","peerFpsSum","videosFps","peerAvgFPS","_calculatePeerAvgVideoFps","peerSsrcFps","logStorage","stringifyObjects","storeInterval","maxEntryLength","_log","storeLogsIntervalID","totalLen","outputCache","someObject","formatLogMessage","prevMessage","_flush","_reschedulePublishInterval","force","reschedule","isReady","cachedQueue","storeLogs","_detectElectron","__WEBPACK_IMPORTED_MODULE_2__browsers__","_detectNWJS","_detectReactNative","product","bowserNameToJitsiName","Chrome","Chromium","Opera","Firefox","Internet Explorer","Microsoft Edge","Safari","detectors","__WEBPACK_IMPORTED_MODULE_0_bowser___default","_detect","_name","_version","compareVersions","compareVersion","definition","getFirstMatch","regex","getSecondMatch","iosdevice","nexusMobile","nexusTablet","chromeos","silk","sailfish","tizen","webos","windowsphone","linux","edgeVersion","versionIdentifier","tablet","mobile","xbox","samsungBrowser","coast","yandexbrowser","ucbrowser","maxthon","epiphany","puffin","sleipnir","kMeleon","osname","msedge","chromeBook","vivaldi","seamonkey","firefoxos","phantom","slimer","blackberry","touchpad","bada","qupzilla","chromium","googlebot","blink","webkit","gecko","osversion","osMajorVersion","getVersionPrecision","precision","chunks","delta","chunk","reverse","isUnsupportedBrowser","minVersions","strictMode","_bowser","bowser","browserList","browserItem","check","nwjs","electron","react-native","AnalyticsAdapter","analyticsHandlers","cache","permanentProperties","conferenceName","callstats_name","__WEBPACK_IMPORTED_MODULE_3__settings_Settings__","user_agent","browser_name","setAnalyticsHandlers","_sendEvent","conference_name","_verifyRequiredFields","objectType","containerType","objectId","_maybeCacheEvent","_appendPermanentProperties","wrtcFuncNames","DEFAULT_REMOTE_USER","reportType","_fabrics","CallStats","hasFabric","fabrics","backendInitialized","_addNewFabric","_emptyReportQueue","backend","atLeastOneFabric","defaultInstance","csInstance","defaultConfID","defaultPC","reportsQueue","errorData","_reportError","eventData","sendFabricEvent","associateMstWithUserID","callStatsId","_error","reportError","theBackend","originalMethod","_len2","theArguments","_key2","__WEBPACK_IMPORTED_MODULE_1__util_GlobalOnErrorHandler___default","_len3","_key3","originalReportError","CallStatsBackend","callstats","_traceAndCatchBackendCalls","userID","configParams","applicationVersion","_initCallback","attachWifiStatsHandler","addresses","_reportEvent","conferenceID","sendUserFeedback","fabricAttributes","remoteEndpointType","endpointType","addNewFabric","fabricUsage","multiplex","_addNewFabricCallback","streamEndpointId","fabricEvent","fabricTerminated","bb","currentOffset","$a","rtc_rtp_parameters","Sb","above","ccDriven","sumMaxBitrateDiff","sumThroughputDiff","prevCsioAvgBRKbps","_a","streamType","ub","outbound","csioAvgBRKbps","csioSCSValidationSampleCount","csioAvgMaxBitrateDiff","csioAvgDeltaThroughput","csioMaxBitrateAboveRatio","csioCCDrivenRatio","oncanplay","ab","ucID","jc","kc","Xb","jb","mediaPlaybackStartEvent","highResTs","onsuspend","mediaSuspendedEvent","Aa","codebase","Fb","hb","lastStatsSent","Transport","latestEventSent","bytesReceived","bytesSent","csioReceivedBwKbps","csioSentBwKbps","csioIntBytesReceived","csioIntBytesSent","packetsSent","csioSentPacketRate","csioIntPacketsSent","packetsReceived","csioReceivedPacketRate","csioIntPacketsReceived","lastRawStatsSentInterval","statsPollingStart","rawstatsTS","lastProcessedStatsSentInterval","Fa","da","ma","encodeURIComponent","apiTS","timeShift","fabricState","pcState","pcID","pcHash","Ua","authToken","localID","deviceID","pa","A","G","H","L","K","M","N","nc","E","googActiveConnection","activeConnectionIndex","selected","localCandidate","remoteCandidate","bwe","trackStats","candidatePair","Ub","localStartTime","Wb","Q","associatedVideoTag","usage","typePreference","selectedCandidatePairId","googLocalAddress","googRemoteAddress","googLocalCandidateType","googRemoteCandidateType","googTransportType","localAddr","remoteAddr","localAddrType","remoteAddrType","transportType","iceCandidates","transportData","ipv6","relayType","cd","fabricTransportSwitch","xb","disrupted","mozRtt","googRtt","roundTripTime","gd","Vb","Za","kb","senderConfiguration","V","W","X","ja","fire","OnPolling","OnOneWayAudioDisruptionsRequest","disruptionType","oneWayMedia","OnSendingThroughputObservationsRequest","sendingThroughputObservations","OnStatsRequest","googCodecName","codecImplementationName","Y","Ma","Z","inbound","vb","noInboundAudioOnlyFabric","connectionState","onLine","processedStatsTupleArray","Da","aa","od","getConferenceURL","conferenceURL","fractionLoss","csioIntFL","csioIntBRKbps","quality","csioMark","csioMediaType","jitter","googJitterReceived","audioOutputLevel","audioInputLevel","averageRTT","csioAvgRtt","averageJitter","csioAvgJitter","packetLossPercentage","csioPktLossPercentage","statsType","batteryStatus","batteryLevel","Xa","isBatteryCharging","charging","wifiStats","ka","mark","wb","bad","fair","processedStatistics","ba","Ra","msgStat","getStat","processedStats","lastFabricState","clockUnsynced","Oa","cacheEvent","channel","isRemote","J","syncHandler","Ob","na","offsetResults","ld","_isTokenValid","Hb","ia","pd","nb","sendAuthenticationRequest","ob","authOngoing","eb","userJoinedSent","iceCandidatesNumber","authStatus","tokenData","clockSync","stateMachine","pageURL","wsStatus","getWSConnectionState","ca","ea","ga","ha","Reporter","csioChromeLegacyGetStats","la","oa","qa","ra","va","wa","xa","ya","PreCallTest","za","Wa","Ba","Ca","defaultConfig","recommendedConfig","preCallTest","Ga","La","eventCache","updateRemoteUserID","sendCachedEvents","gb","userJoined","decodeURIComponent","sendCachedUserJoinedEvents","ib","fabricSetupFailed","statsSubmissionInterval","updateConferenceId","sendCachedFeedback","Jb","userFeedback","Kb","size_max","size_ewma","statNum_max","statNum_ewma","msg_num","maxInterval","minInterval","avgInterval","stdInterval","lastTime","samplesCount","memorySizeOf","Sa","authInProgress","tokenGenerator","subtle","cryptotype","subtlecrypto","webkitSubtle","msCrypto","sign","alg","csiosign","ArrayBuffer","byteLength","oncomplete","decode","importKey","kty","extractable","ext","use","setAuthType","expiry","setupAuthToken","Ib","submissionInterval","setSubmissionInterval","setReportingMode","adaptiveInterval","collectSDP","tokenGenerationError","jd","client_id","grant_type","auth","token_type","access_token","expires_in","gc","crashDisconnect","hc","_isChannelReady","_setupWebSocketConnection","Qb","RETRY","GET_NEW_TOKEN","REPORT_ERROR","errorCode","authError","appSecretTokenGenerator","keyID","Va","detectBrowserInfo","measureAppLoadingPerformance","loading","Ya","syncStartTime","syncAttempts","maxAllowedLatency","db","fabricHold","fabricResume","audioMute","audioUnmute","videoPause","videoResume","fabricUsageEvent","screenShareStart","screenShareStop","dominantSpeaker","userIDChangedEvent","activeDeviceList","applicationErrorLog","autoFabricSetup","userLeft","refreshPresence","fabricStateChange","iceDisruptionStart","iceDisruptionEnd","iceConnectionDisruptionStart","iceConnectionDisruptionEnd","iceAborted","iceTerminated","iceFailed","iceRestarted","fabricDropped","connectedDevices","iceCompleted","iceCandidateFound","sdpSubmission","callStatsEvent","lb","mb","failure","httpError","wsChannelFailure","csProtoError","appConnectivityError","ok","pb","qb","sendonly","receiveonly","sendrecv","inactive","rb","unbundled","local","remote","noAudioInMultiplexFabric","noOutboundAudioOnlyFabric","excellent","established","initializing","checkingDisrupted","yb","iceConnectionFailure","signalingError","applicationError","applicationLog","zb","mediaConfigError","negotiationFailure","sdpError","iceFailure","transportFailure","Ab","gThreshold","rThreshold","Bb","Cb","Db","Eb","Mb","encodeURI","ontimeout","Nb","filename","col","jsVersion","Pb","invalidWebRTCFunctionName","Rb","Tb","syncedStartTime","simulcastGroup","localSDP","remoteSDP","Zb","Yb","ids","sdpPayload","$b","sc","localCandidates","remoteCandidates","iceCandidatePairs","activeIceCandidatePair","Nc","currPair","_b","ac","endpoint","magicKey","bc","ec","sent","remoteofferSinceCreate","senderConfig","errorSinceCreate","Authorization","adaptiveStats","qmodelThresholdsAPI","confidence","recommended","callstatsID","lc","fabric","qc","rc","tc","activeDevicelist","pcCallback","statsInterval","conferenceFinished","onHold","Qc","uc","wc","yc","buffer","zc","DataView","getUint8","Ac","digest","Ic","Pc","changedState","prevState","sentSenderConfigRequest","senderExists","app_id","local_id","getParameters","callFinished","callStarts","ad","Rc","Yc","numNegotiationNeededCalls","Zc","prevIceConnectionState","currIceConnectionState","gatheringIceCandidatesDelay","disruptionDelay","disruptedTS","prevPair","connectivityIceStatusDelay","bd","failureDelay","prevIceConnectionStateTs","iceConnectionStateTS","_c","fabricSetupSent","setupDelay","iceGatheringDelay","iceConnectivityDelay","fabricTransmissionDirection","clockSyncOffset","switchDelay","dd","ed","fd","codecId","isGreaterBetter","upperThreshold","lowerThreshold","kd","md","_wsConnectionState","conferenceCreationTS","conferenceDuration","getBattery","csioproxy","initializeSinceCreate","disableBeforeUnloadHandler","appVer","disablePrecalltest","addnewfabricSinceCreate","localUserIDObject","intervalAdaptionPhase","currentActivePhaseIndex","userQoe","csError","qualityRating","good","poor","webRTCFunctions","DOMException","domError","function","reportUserIDChange","idType","userIDType","setProxyConfig","collectorURL","authServiceURL","csioInternalAPIURL","wsURL","callStatsAPIReturnStatus","setIdentifiers","transmissionDirection","callstatsUtils","MAX_VALUE","support","loadEventEnd","getEntriesByType","PusherPlug","invoker","Notifier","SenderGate","lastResponsed","onDataSent","Measurement","frameRateReceived","frameWidth","droppedFramesNum","packetLosts","packetsDiscarded","NumberComparator","MeasurementRTTComparator","MeasurementFrameHeightComparator","frameHeight","MeasurementFrameWidthComparator","MeasurementJitterComparator","MeasurementFrameRateReceivedComparator","MeasurementMerger","Assembler","unknown","SWValueTracker","extractorFnc","actual","Signals","SWValueHolder","FractionLost","intervalPacketsRecv","intervalLoss","FractionLostComparator","getValue","FractionLostMerger","getIntervalLoss","getIntervalPacketsRecv","Monitor","measurements","SlidingWindow","maxItemsNum","timeoutInMs","packetLostTracker","addPlugin","packetsDiscardedTracker","resolutionTracker","jitter95PercentileTracker","SWPercentileTracker","addFilter","rtt95PercentileTracker","frameHeight50PercentileTracker","frameHeight95PercentileTracker","frameRate50PercentileTracker","frameRate95PercentileTracker","frameWidth50PercentileTracker","frameWidth95PercentileTracker","rttAvgRTTracker","SWAvg","frameRateMeanTracker","frameHeightMeanTracker","frameWidthMeanTracker","jitterAvgTracker","intervalFractionLosts","FLPercentileTracker","lastSent","firstAdded","lastAdded","doSending","lastTraffic","InboundMonitor","bytesReceivedTracker","packetsReceivedTracker","csioIntBRKbpsCount","csioIntPRCount","InbAudioMonitor","eModel","Direction","MediaTypes","InbVideoMonitor","frameRateReceivedTracker","frameRatePercTracker","setFrameRateReceived10","frameRateReceived10","OutboundMonitor","bytesSentTracker","packetsSentTracker","OutbVideoMonitor","started","maxTs","stable","stableTs","ready","maxVerified","stableVerified","OutbAudioMonitor","Monitors","monitors","assembler","sendable","inbOneWayAudioDisruption","hasTrafficTs","outbOneWayAudioDisruption","Analyzer","lastForwarded","lastInterval","sentCounter","nextInterval","Idle","Run","OnStop","OnStart","analyzer","senderGate","sendingThroughputObservationsSent","currentState","disruptions","adaptiveSending","minMeasurementsNum","SendingTimeTresholds","regular","minDeltaTimeInMs","requestStats","RTT","do","getMediaType","getResolution","getFrameRate","getFrameWidth","getFrameHeight","getLatencyData","getDroppedFramesNum","getPacketLosts","getJitter","getBytesReceived","getPacketsReceived","getPacketsDiscarded","getBytesSent","getPacketsSent","rawdats","setupCodeBase","checkForNan","checkForNegativeValue","discardedPackets","packetsLost","droppedFrames","googFrameRateOutput","googFrameRateDecoded","googFrameRateReceived","googFrameRateSent","framerateMean","googFrameHeightReceived","googFrameHeightSent","googFrameWidthReceived","googFrameWidthSent","validateRTT","getActual","getFirst","getDelta","getPrevious","VideoThroughputThresholds","green","red","AudioThroughputThresholds","FrameRateRatioTresholds","VideoRTTThresholds","VideoFractionLostTreshdolds","AudioFractionLostTresholds","AudioEModelTresholds","avQualityRating","avQualityRatingString","doStart","getStartTime","hasTraffic","getLastMeasurement","getTotalTimeInMs","getDeltaTimeInMs","getLast","setSSRC","requestSending","setIntBRAndPR","csioIntPR","requestSendingIf","getAvgRTT","getResult","percentileTrackerExtractor","getRTT95","getJitter95","getFrameRateMean","getFrameWidth50Percentile","getFrameWidth95Percentile","getFrameHeight50Percentile","getFrameHeight95Percentile","getFrameRate50Percentile","getFrameRate95Percentile","getFrameHeightMean","getFrameWidthMean","getAvgJitter","getQualityEvaluation","getQualityReverseEvaluation","hasData","getItemsNum","csioIntMs","csioPercentileFl","csioIntPktLoss","csioPercentileJitter","csioSig2Latency","csioTimeElapseMs","csioeM","csiores","csioFrameWidth95Percentile","csioFrameWidth50Percentile","csioFrameHeight95Percentile","csioFrameHeight50Percentile","csioFrameRate95Percentile","csioFrameRate50Percentile","csioFrameWidthMean","csioFrameHeightMean","csioFrameRateMean","addIntervalFractionLost","getLastFractionLost","getIntervalFractionLost95","isValid","doSend","setRTT95","csioIntPktRcv","csioAvgPacketSize","getQuality","setFrameRatioQuality","verificationElapsedThreshold","initialElapsedThreshold","minStableKBpsSlack","getSendingKBitrateObservations","maxsendingKBitrate","timeToMaxSendingKBitrate","stablesendingKBitrate","timeToStableSendingKBitrate","checkSendingKBitrateObservations","setEModelQuality","setThroughputQuality","OneWayAudioDisruptionTimeout","DisruptionsMediaType","DisruptionsType","getMonitor","isSendable","checkDistortions","getInbOneWayAudioDisruption","getOutbOneWayAudioDisruption","getSendingThroughputObservations","items","minItemsNum","SWItem","setMaxItemsNum","setTimeoutInMs","setMinItemsNum","getElapsed","foreach","created","comparator","percentile","meanCalcer","ratio","maxtree","BinaryTree","mintree","maxcounter","mincounter","SWPercentileNotification","doFilter","insert","getTopValue","balancing","ReferenceError","insertByTop","deleteBottomValue","insertByBottom","deleteTopValue","getBottomValue","tracked","estimated","BinaryTreeNode","bottom","node_counter","duplicate_counter","getTop","getBottom","getDuplicatedCounter","getNodeCounter","getSize","logTree","inserting","getRightist","getLeftist","extractor","calc","pcCallbackHandler","onIceCandidateCallback","onIceConnectionStateChangeCallback","onPcSignalingStateChangeCallback","onPcNegotiationNeededCallback","iceCandidateCallback","iceConnectionStateChangeCallback","pcSignalingStateChangeCallback","pcNegotiationNeededCallback","_turnConnection","_rttTest","_throughputTest","_resultsHandler","_onlineCheck","_detectbrowser","TEST_NAMES","THROUGHPUT","turnConnection","TurnConnection","onlineCheck","OnlineCheck","callsInProgress","turnTests","resultsHandler","turnTestCounter","ResultsHandler","buildName","buildVersion","_start","startTurnTests","getFailureNumber","activeTurnTest","forceStop","getIceResults","sendResults","getResults","RttTest","ThroughputTest","handleTestResults","median","_parsedIceCandidate","_getstatshandler","statshandler","GetStatsHandler","pctpc1","pctpc2","sendChannel","messageCallback","parsedIceResults","raiseSendError","rejectDisconnect","connectionTimer","createDataChannel","ordered","maxRetransmits","binaryType","assignEvent","onIceCandidate","onIceStateChange","onCreateOfferSuccess","onCreateOfferError","iceTimer","onSetLocalSuccess","onSetSessionDescriptionError","onSetRemoteSuccess","onSetRemoteSessionDescriptionError","onCreateAnswerSuccess","onCreateAnswerError","ParsedIceCandidate","isRelay","isTypeTransportUdp","relayUdpGathered","isTypeTransportTcp","relayTcpGathered","isTypeTransportTls","relayTlsGathered","isServerReflexive","srflxGathered","getOtherPc","onAddIceCandidateSuccess","onAddIceCandidateError","turnIpAddress","turnIpVersion","turnTransport","ipv6Supported","ipv4Supported","relayTlsSuccess","relayTcpSuccess","relayUdpSuccess","srflxSuccess","getIceCandidates","ipAddress","localCandidateId","mozLocalTransport","candidateType","I","iceCandidateStr","typeTransport","extractTypeTransport","_statsadapter","StatsAdapter","isPromiseBased","csioGetStats","iceCandidatesHandler","getStatsFirefox","getStatsSafari","getStatsChrome","getStatsEdge","extractRawStats","processRawStatsForIceInfo","getParsedStats","statsClassifier","transportStats","formatRelayType","tasksByHandle","runIfPresent","currentlyRunningATask","task","registerImmediate","messagePrefix","onGlobalMessage","nextHandle","attachTo","importScripts","postMessageIsAsynchronous","oldOnMessage","MessageChannel","port1","port2","_turnTest","sendTimer","countSent","rtts","startTimestamp","sendPing","calculateRtt","calculateMetrics","fillResults","sentMessages","unAckedMessages","maxMessages","variance","endTimestamp","_messageMaker","receivedBytes","secondHalfBytes","secondHalfStart","bufferEmpty","chunkSize","messageMaker","lastMessage","intervals","intervalStart","intervalLength","intervalBytes","startSend","averageThroughput","average","bufferListener","fillBuffer","bufferedAmount","bufferFullThreshold","usePolling","make","bufferedAmountLowThreshold","maxDuration","bytesPrepared","fractionLostBytes","_typeof2","trunc","failures","tests","addEntry","online","calculatePacketLoss","lostPackets","totalPackets","round","SsrcStats","loss","StatsCollector","_browserType","KEYS_BY_BROWSER_TYPE","_getStatValue","_defineGetStatValueMethod","baselineAudioLevelsReport","currentAudioLevelsReport","currentStatsReport","previousStatsReport","audioLevelsIntervalId","conferenceStats","audioLevelsIntervalMilis","statsIntervalId","statsIntervalMilis","ssrc2stats","browserSupported","receiveBandwidth","sendBandwidth","remoteAddress","localAddress","activeConnection","currentRoundTripTime","IEXPLORER","setLoss","setResolution","addBitrate","resetBitrate","setFramerate","startAudioLevelStats","processAudioLevelReport","processStatsReport","itemStatByKey","pair","getNonNegativeStat","getStatValue","byteSentStats","localip","conferenceStatsTransport","remoteCandidateId","portNumber","msType","before","ssrcIds","remoteSource","ssrcStats","isDownloadStream","packetsNow","packetsBefore","packetsDiff","packetsLostNow","packetsLostBefore","packetsLostDiff","packetsTotal","bytesReceivedNow","bytesReceivedBefore","nowBytesTransmitted","timeMs","bitrateReceivedKbps","bitrateSentKbps","bitrateDownload","bitrateUpload","resolutions","framerates","audioBitrateDownload","audioBitrateUpload","videoBitrateDownload","videoBitrateUpload","userResolutions","userFramerates","__WEBPACK_IMPORTED_MODULE_1__service_statistics_Events__","_nearestExecutingScript","scripts","eligibleScripts","skipStackDepth","isNotOpera","supportsScriptReadyState","scriptReadyRegex","hasStackBeforeThrowing","hasStackAfterThrowing","getScriptUrlFromStack","ignoreMessage","pageUrl","hasAttribute","hasNativeCurrentScriptAccessor","currentScript","fullPageUrl","Infinity","thrownErr","near","far","origin","ComponentsVersions","processPresence","FOCUS_COMPONENT","VIDEOBRIDGE_COMPONENT","XMPP_SERVER_COMPONENT","mucResource","componentName","__WEBPACK_IMPORTED_MODULE_0__statistics_statistics__","getComponentVersion","getTarget","simulcast","millisSinceStart","simulcastFormat","kSimulcastFormats","targetHeight","pixels","MAX_SAFE_INTEGER","startBitrate","VideoType","Resolutions","__WEBPACK_IMPORTED_MODULE_2_jitsi_meet_logger__","STATS_MESSAGE_TYPE","layers","ConnectionQuality","_localStats","_lastConnectionQualityUpdate","_remoteStats","_timeIceConnected","_timeVideoUnmuted","_updateLocalConnectionQuality","__WEBPACK_IMPORTED_MODULE_0__service_connectivity_ConnectionQualityEvents__","_broadcastLocalStats","_updateRemoteStats","_updateLocalStats","_maybeUpdateUnmuteTime","resolutionName","isSimulcastOn","activeTPC","prevConnectionQuality","diffSeconds","lastUpdate","updateLocalConnectionQuality","_calculateConnectionQuality","onLoginSuccessful","roomPassword","canceled","rejectPromise","__WEBPACK_IMPORTED_MODULE_1__modules_xmpp_xmpp__","__WEBPACK_IMPORTED_MODULE_0__JitsiConnectionEvents__","authenticationError","connectionError","strophe_js","_identities","_features","_items","_onDiscoInfo","_onDiscoItems","addIdentity","category","lang","var_name","addItem","call_back","_buildIQResult","query_attrs","iqresult","var","MucConnectionPlugin","rooms","__WEBPACK_IMPORTED_MODULE_3__ConnectionPlugin__","onPresence","onPresenceUnavailable","onPresenceError","onMessage","onMute","roomJid","__WEBPACK_IMPORTED_MODULE_2__ChatRoom__","__WEBPACK_IMPORTED_MODULE_4__service_xmpp_XMPPEvents___default","createNonAnonymousRoom","filterNodeFromPresenceJSON","packet2JSON","packet","json2packet","VALID_FIELD_NAMES","ChatRoom","members","presMap","presHandlers","noBridgeAvailable","__WEBPACK_IMPORTED_MODULE_8__moderator__","initPresenceMap","lastPresences","phoneNumber","phonePin","participantPropertyListener","locked","__WEBPACK_IMPORTED_MODULE_3__JitsiTranscriptionStatus__","__WEBPACK_IMPORTED_MODULE_4__util_Listenable__","xns","__WEBPACK_IMPORTED_MODULE_5__settings_Settings__","addVideoInfoToPresence","userRegion","allocateConferenceFocus","fromJoin","getInfo","__WEBPACK_IMPORTED_MODULE_7__service_xmpp_XMPPEvents___default","getForm","form","formSubmit","member","$statusNode","hasStatusUpdate","mucUserItem","affiliation","getFocusUserJid","isHiddenDomain","hiddenDomain","newRole","_initFocus","memberOfThis","displayJids","att","phone","pin","processNode","lastJibri","recording","__WEBPACK_IMPORTED_MODULE_9__recording__","recordingType","tagHandlers","nickname","skipEvents","onMucMemberLeft","reasonSelect","doLeave","isSelfPresence","isKick","membersKeys","onParticipantLeft","txt","subjectText","stamp","dateParts","discoRoomInfo","json","jsonString","topic","kickIQ","onNotSupported","formsubmit","handlerIdx","sendVideoInfoPresence","sendAudioInfoPresence","addAudioInfoToPresence","mutedNode","__WEBPACK_IMPORTED_MODULE_6__service_RTC_MediaType__","videoTypeNode","isSipGatewayEnabled","iqToFocus","onMucLeft","doReject","createExpBackoffTimer","step","Moderator","__WEBPACK_IMPORTED_MODULE_2__settings_Settings__","xmppService","getNextTimeout","getNextErrorTimeout","externalAuthEnabled","sipGatewayEnabled","call_control","AuthenticationEvents","setFocusUserJid","focusJid","focusUserJid","getFocusComponent","focusComponent","focus","createConferenceIq","machineUID","machine-uid","session-id","enforcedBridge","audioPacketDelay","minBitrate","openSctp","__WEBPACK_IMPORTED_MODULE_1__browser__","stereo","useRoomAsSharedDocumentName","parseSessionId","resultIq","parseConfigOptions","authenticationEnabled","_allocateConferenceFocusSuccess","_allocateConferenceFocusError","invalidSession","reservationErr","errorTextNode","waitMs","retrySec","errorIq","urlCallback","_getLoginUrl","popup","urlCb","logout","logoutUrl","__WEBPACK_IMPORTED_MODULE_2_strophe_js__","JingleConnectionPlugin","jvbIceConfig","p2pIceConfig","mediaConstraints","OfferToReceiveAudio","OfferToReceiveVideo","__WEBPACK_IMPORTED_MODULE_8__ConnectionPlugin__","onJingle","fromJid","ack","sess","startMuted","audioMuted","videoMuted","__WEBPACK_IMPORTED_MODULE_3__service_xmpp_XMPPEvents___default","__WEBPACK_IMPORTED_MODULE_7__JingleSessionPC__","modifyContents","replaceTransport","successTime","sendTransportReject","addRemoteStream","removeRemoteStream","me","__WEBPACK_IMPORTED_MODULE_5__util_RandomUtil___default","onTerminated","iceservers","dict","updateLog","JingleSessionPC","localJid","_iceCheckingStartedTimestamp","_gatheringStartedTimestamp","_localVideoActive","_remoteVideoActive","_gatheringReported","lasticecandidate","signalingLayer","__WEBPACK_IMPORTED_MODULE_10__SignalingLayerImpl__","webrtcIceUdpDisable","webrtcIceTcpDisable","modificationQueue","__WEBPACK_IMPORTED_MODULE_1_async___default","_processQueueTasks","wasConnected","__WEBPACK_IMPORTED_MODULE_5__JingleSession__","jingleContents","videoContents","actionName","__WEBPACK_IMPORTED_MODULE_6__JingleSessionState__","isReconnect","wasstable","pcOptions","disableSimulcast","disableH264","preferH264","_abtestSuspendVideoEnabled","enableFirefoxSimulcast","createPeerConnection","__WEBPACK_IMPORTED_MODULE_11__statistics_statistics__","phase","sendIceCandidate","__WEBPACK_IMPORTED_MODULE_12__service_xmpp_XMPPEvents___default","_assertNotEnded","signaling_state","reconnect","iceStarted","setChatRoom","__WEBPACK_IMPORTED_MODULE_7__SDP__","ice","__WEBPACK_IMPORTED_MODULE_9__SDPUtil__","jcand","errorMesssage","__WEBPACK_IMPORTED_MODULE_13__util_GlobalOnErrorHandler___default","usedrip","dripContainer","sendIceCandidates","candidates","__WEBPACK_IMPORTED_MODULE_3_strophe_js__","fingerprintLine","newJingleErrorHandler","rtcCandidate","finishedCallback","iceCandidate","outerHTML","ssrcElement","setSSRCOwner","i3","ssrcInfoElement","generateRecvonlySsrc","setOfferAnswerCycle","sendSessionAccept","offerSdp","sendSessionInitiate","jingleAnswer","jingleOfferAnswerIq","newRemoteSdp","_processNewJingleOfferIq","oldLocalSdp","_renegotiate","sendContentModify","newLocalSdp","notifyMySSRCUpdate","onJingleFatalError","jingleOfferElem","originalOffer","sendTransportAccept","accept","responder","videoTransferActive","newSendersValue","sessionModify","_this12","transportAccept","medialines","transportReject","sessionTerminate","sourceAddElem","currentRemoteSdp","addSsrcInfo","i1","i2","_addOrRemoveRemoteStream","isAdd","_this13","logPrefix","readSsrcInfo","addOrRemoveSsrcInfo","_parseSsrcInfoFromSourceAdd","_parseSsrcInfoFromSourceRemove","_processRemoteAddSource","_processRemoteRemoveSource","remoteSdp","removeSsrcInfo","optionalRemoteSdp","_this14","_initiatorRenegotiate","_responderRenegotiate","_this15","_this16","offer","_this17","clearRecvonlySsrc","newLocalSDP","sourceRemoveElem","ssrcLines","operationName","oldSDP","currentLocalSDP","sdpDiff","__WEBPACK_IMPORTED_MODULE_8__SDPDiffer__","addedMedia","getNewMedia","removedMedia","_addRemoveTrackAsMuteUnmute","isMute","_this18","workFunction","oldLocalSDP","removeTrackMute","addTrackUnmute","_verifyNoSSRCChanged","audioActive","videoActive","_this19","logAudioStr","logVideoStr","isSessionActive","audioActiveChanged","setAudioTransferActive","pcVideoActiveChanged","setVideoTransferActive","_this20","newVideoSenders","parseVideoSenders","_modifyRemoteVideoActive","remoteVideoSenders","isRemoteVideoActive","newSDP","sdpDiffer","request","_this21","errResponse","errorElSel","errorReasonSel","errorMsgSel","abTesting","enableSuspendVideoTest","_getInitiatorJid","__WEBPACK_IMPORTED_MODULE_4__util_StringUtils__","integerHash","only_once","previous_async","_toString","_isArray","_map","_keys","eachSeries","iterate","forEachSeries","eachLimit","_eachLimit","forEachLimit","running","replenish","doParallel","doSeries","_asyncMap","eachfn","mapLimit","_mapLimit","memo","inject","foldl","reduceRight","reversed","foldr","filterSeries","select","selectSeries","rejectSeries","main_callback","detectSeries","sortBy","criteria","auto","tasks","remainingTasks","taskComplete","theCallback","taskCallback","safeResults","rkey","requires","retry","times","attempts","wrappedTask","wrappedCallback","wrappedResults","finalAttempt","seriesCallback","series","waterfall","wrapIterator","_parallel","parallel","parallelLimit","makeCallback","concatSeries","whilst","doWhilst","until","doUntil","worker","_insert","drain","saturated","workers","empty","kill","idle","priorityQueue","_compareTasks","sequence","compare","beg","cargo","working","drained","ts","_console_fn","memoize","hasher","queues","memoized","unmemoized","unmemoize","counter","timesSeries","seq","fns","newargs","nextargs","compose","_applyEach","go","applyEach","applyEachSeries","forever","JingleSession","__WEBPACK_IMPORTED_MODULE_1__JingleSessionState__","doInitialize","arrayEquals","array1","array2","equals","SDPDiffer","mySDP","otherSDP","myMedias","othersMedias","newMedia","othersMediaIdx","myMedia","othersMedia","otherSsrcGroup","mySsrcGroup","modify","sdpMediaSsrcs","modified","mediaSsrc","nv","SignalingLayerImpl","ssrcOwners","chatRoom","__WEBPACK_IMPORTED_MODULE_3__service_RTC_SignalingLayer__","oldChatRoom","_audioMuteHandler","_videoMuteHandler","_videoTypeHandler","__WEBPACK_IMPORTED_MODULE_2__service_RTC_SignalingEvents__","__WEBPACK_IMPORTED_MODULE_1__service_RTC_MediaType__","getMediaPresenceInfo","SignalingLayer","__WEBPACK_IMPORTED_MODULE_0__modules_util_Listenable__","__WEBPACK_IMPORTED_MODULE_2__util_GlobalOnErrorHandler__","resetLastErrorStatusRegExpr","lastErrorStatusRegExpr","errStatusCapture","PING_TIMESTAMPS_TO_KEEP","PingConnectionPlugin","failedPings","pingExecIntervals","_addPingExecutionTimestamp","PING","pingIntervals","previousTS","currentInterval","RAYO_XMLNS","RayoConnectionPlugin","__WEBPACK_IMPORTED_MODULE_2__ConnectionPlugin__","onRayo","roomPass","callResource","StropheLogger","__WEBPACK_IMPORTED_MODULE_1__ConnectionPlugin__","logIncoming","logOutgoing","compareIdentities","IDENTITY_PROPERTIES_FOR_COMPARE","IDENTITY_PROPERTIES","Caps","disco","versionToCapabilities","jidToVersion","__WEBPACK_IMPORTED_MODULE_1__service_xmpp_XMPPEvents___default","_addChatRoom","_removeChatRoom","CAPS","_handleCaps","_onMucMemberLeft","_removeJidToVersionEntry","__WEBPACK_IMPORTED_MODULE_2__util_Listenable__","_generateVersion","_fixChatRoomPresenceMap","identities","accumulatedValue","identity","_notifyVersionChanged","oldVersion","JitsiConferenceEventManager","__WEBPACK_IMPORTED_MODULE_6__JitsiConferenceEvents__","__WEBPACK_IMPORTED_MODULE_11__service_xmpp_XMPPEvents__","__WEBPACK_IMPORTED_MODULE_11__service_xmpp_XMPPEvents___default","__WEBPACK_IMPORTED_MODULE_4_jitsi_meet_logger__","chatRoomForwarder","__WEBPACK_IMPORTED_MODULE_3__modules_util_EventEmitterForwarder___default","__WEBPACK_IMPORTED_MODULE_10__modules_statistics_statistics__","forward","__WEBPACK_IMPORTED_MODULE_5__JitsiConferenceErrors__","setParticipantPropertyListener","setProperty","__WEBPACK_IMPORTED_MODULE_2__service_authentication_AuthenticationEvents___default","myJid","_status","updated","isAudioAvailable","isVideoAvailable","_availableDevices","__WEBPACK_IMPORTED_MODULE_8__service_RTC_RTCEvents___default","__WEBPACK_IMPORTED_MODULE_9__service_RTC_VideoType___default","ignoreStartMuted","_onByteSentStatsReceived","EventEmitterForwarder","dest","srcEvent","JitsiParticipant","hidden","_jid","_hidden","_statsID","_connectionStatus","__WEBPACK_IMPORTED_MODULE_2__modules_connectivity_ParticipantConnectionStatus__","_properties","jitsiTrack","isWebRTCTrackMuted","oldValue","_isMediaTypeMuted","Jvb121EventGenerator","_jvb121","evaluateStatus","P2PDominantSpeakerDetection","__WEBPACK_IMPORTED_MODULE_0__JitsiConferenceEvents__","_audioLevel","myUserID","BridgeChannel","_eventEmitter","_mode","datachannel","_handleChannel","ws","OPEN","colibriClass","msgPayload","jsonObject","pinnedEndpoint","selectedEndpoint","maxFrameHeightPixels","__WEBPACK_IMPORTED_MODULE_1__service_RTC_RTCEvents___default","dominantSpeakerEndpoint","isOpen","JitsiLocalTrack","__WEBPACK_IMPORTED_MODULE_4__JitsiTrackEvents__","_constraints","_prevSetMuted","_facingMode","_trackEnded","_hasSentData","_testDataSent","_realDeviceId","_noDataFromSourceTimeout","_onDeviceListChanged","__WEBPACK_IMPORTED_MODULE_6__RTCUtils__","_onAudioOutputDeviceChanged","__WEBPACK_IMPORTED_MODULE_9__service_RTC_RTCEvents___default","_initNoDataFromSourceHandlers","__WEBPACK_IMPORTED_MODULE_1__JitsiTrack__","__WEBPACK_IMPORTED_MODULE_10__service_RTC_VideoType___default","_onNoDataFromSourceError","_checkForCameraIssues","_clearNoDataFromSourceMuteResources","__WEBPACK_IMPORTED_MODULE_12__statistics_statistics__","__WEBPACK_IMPORTED_MODULE_11__service_statistics_AnalyticsEvents__","track_type","_fireNoDataFromSourceEvent","isReceivingData","_get","storedMSID","getMSID","_queueSetMuted","setMuted","_setMuted","__WEBPACK_IMPORTED_MODULE_2__JitsiTrackError__","__WEBPACK_IMPORTED_MODULE_3__JitsiTrackErrors__","logMuteInfo","doesVideoMuteByStreamRemove","_removeStreamFromConferenceAsMute","_unregisterHandlers","_stopStream","streamOptions","getDeviceId","__WEBPACK_IMPORTED_MODULE_8__service_RTC_MediaType__","getCameraFacingMode","streamsInfo","streamInfo","cont","_addStreamToConferenceAsUnmute","_sendMuteStatus","detach","_bytesSent","trackSettings","__WEBPACK_IMPORTED_MODULE_7__service_RTC_CameraFacingMode___default","_stopStreamInProgress","_switchCamera","RTCSignalingState","haveLocalOffer","haveRemoteOffer","RTCIceGatheringState","gathering","CNAME","ortcRTCPeerConnection","_bufferedIceCandidates","_closed","_dtlsTransport","_iceGatherer","_iceGatheringState","_iceTransport","_localCapabilities","_localDescription","_localTrackInfos","_mids","_remoteDescription","_remoteStreams","_remoteTrackInfos","_sdpGlobalFields","__WEBPACK_IMPORTED_MODULE_6__xmpp_SDPUtil__","_signalingState","_setIceGatherer","_setIceTransport","_setDtlsTransport","__WEBPACK_IMPORTED_MODULE_1_yaeti___default","EventTarget","usePromise","_addIceCandidate","_addStream","_updateAndEmitSignalingStateChange","_createAnswer","_createOffer","_getStats","_removeStream","_setLocalDescription","_setRemoteDescription","__WEBPACK_IMPORTED_MODULE_4__errors__","getTrackById","_emitNegotiationNeeded","_createLocalDescription","addMediaSection","mediaObject","iceUfrag","localIceParameters","icePwd","localIceCandidates","candidateObject","endOfCandidates","rtpObject","paramFmtp","_iteratorNormalCompletion11","_didIteratorError11","_iteratorError11","_step11","_iterator11","_iteratorNormalCompletion12","_didIteratorError12","_iteratorError12","_step12","_iterator12","localTrackInfos","enableRtx","hasVideoRtx","rtxSsrc","rtcpMux","rtcpRsize","sdpObject","getLocalCandidates","localDtlsParameters","getRemoteParameters","ipVer","netType","sessionVersion","msidSemantic","semantic","mids","_ref3","_ref4","__WEBPACK_IMPORTED_MODULE_2__RTCSessionDescription__","_sdpObject","_iteratorNormalCompletion13","_didIteratorError13","_iteratorError13","_step13","_iterator13","sdpCandidate","sdpMIndex","sdpAttribute","degradationPreference","muxId","_iteratorNormalCompletion14","_didIteratorError14","_iteratorError14","_step14","_iterator14","codecCapability","ptime","_iteratorNormalCompletion15","_didIteratorError15","_iteratorError15","_step15","_iterator15","_iteratorNormalCompletion16","_didIteratorError16","_iteratorError16","_step16","_iterator16","encrypt","preferredEncrypt","_iteratorNormalCompletion17","_didIteratorError17","_iteratorError17","_step17","_iterator17","_iteratorNormalCompletion18","_didIteratorError18","_iteratorError18","_step18","_iterator18","_iteratorNormalCompletion19","_didIteratorError19","_iteratorError19","_step19","_iterator19","rtpSenders","rtpReceivers","_iteratorNormalCompletion20","_didIteratorError20","_iteratorError20","_step20","_iterator20","sending","_iteratorNormalCompletion21","_didIteratorError21","_iteratorError21","_step21","_iterator21","msGetStats","_iteratorNormalCompletion22","_didIteratorError22","_iteratorError22","_step22","_iterator22","isAudio","_iteratorNormalCompletion26","_didIteratorError26","_iteratorError26","_step26","_iterator26","_iteratorNormalCompletion23","_didIteratorError23","_iteratorError23","_step23","_iterator23","_iteratorNormalCompletion27","_didIteratorError27","_iteratorError27","_step27","_iterator27","datas","_iteratorNormalCompletion24","_didIteratorError24","_iteratorError24","_step24","_iterator24","_iteratorNormalCompletion25","_didIteratorError25","_iteratorError25","_step25","_iterator25","__WEBPACK_IMPORTED_MODULE_3__utils__","_startIceAndDtls","currentRemoteSsrcs","newRemoteTrackInfos","addedRemoteStreams","addedRemoteTracks","removedRemoteTracks","_iteratorNormalCompletion28","_didIteratorError28","_iteratorError28","_step28","_iterator28","_ref5","_ref6","streamRemoteId","trackRemoteId","_getParametersForRtpReceiver","_iteratorNormalCompletion29","_didIteratorError29","_iteratorError29","_step29","_iterator29","_iteratorNormalCompletion30","_didIteratorError30","_iteratorError30","_step30","_iterator30","_ref7","_ref8","_iteratorNormalCompletion31","_didIteratorError31","_iteratorError31","_step31","_iterator31","_ref9","_ref10","_iteratorNormalCompletion32","_didIteratorError32","_iteratorError32","_step32","_iterator32","_emitAddStream","_iteratorNormalCompletion33","_didIteratorError33","_iteratorError33","_step33","_iterator33","_ref11","_ref12","_emitRemoveStream","_iteratorNormalCompletion34","_didIteratorError34","_iteratorError34","_step34","_iterator34","_iteratorNormalCompletion35","_didIteratorError35","_iteratorError35","_step35","_iterator35","_getParametersForRtpSender","onstatechange","_emitConnectionStateChange","iceGatherOptions","_updateAndEmitIceGatheringStateChange","_emitIceCandidate","gather","_emitIceConnectionStateChange","getNominatedCandidatePair","oncandidatepairchange","isLocalInitialAnswer","_handleLocalInitialAnswer","_handleLocalReAnswer","_emitBufferedIceCandidates","_sendMedia","_receiveMedia","isRemoteInitialOffer","_handleRemoteInitialOffer","_handleRemoteReOffer","remoteIceCandidates","_iteratorNormalCompletion36","_didIteratorError36","_iteratorError36","_step36","_iterator36","yaetiEventTarget","_listeners","defineProperties","listenersType","oldListener","dummyListener","stopImmediatePropagation","_yaeti","defaultPrevented","_sdp","_type","__WEBPACK_IMPORTED_MODULE_0_sdp_transform___default","toIntIfInt","parseReg","needsBlank","keyLocation","rawName","validLine","paramReducer","acc","scid","formatRegExp","makeLine","formatStr","defaultOuterOrder","defaultInnerOrder","outerOrder","innerOrder","getFirstActiveMediaSection","codecsMap","savedHeaderExtension","icelite","midToKind","infos","rtxMap","rtxSet","ssrcObject","filterWithCapabilities","localFullCapabilities","remoteRtxMap","remoteCodec","remoteCodecName","localCodec","remoteParamName","remoteParamValue","localParamName","localParamValue","remoteFb","localFb","rtxCodec","remoteExtension","localExtension","remoteFecMechanism","localFecMechanism","InvalidStateError","klass","obtainWebRTCScreen","streamCallback","failCallback","gumFunction","getWebStoreInstallUrl","desktopSharingChromeExtId","checkChromeExtInstalled","runtime","getVersion","lastError","extVersion","updateRequired","minVersion","s1","s2","n1","n2","desktopSharingChromeMinExtVersion","doGetStreamFromExtension","getStream","desktopSharingChromeSources","onGetStreamResponse","__WEBPACK_IMPORTED_MODULE_0__JitsiTrackError__","__WEBPACK_IMPORTED_MODULE_1__JitsiTrackErrors__","waitForExtensionAfterInstall","waitInterval","retries","currentRetries","installed","initFirefoxExtensionDetection","desktopSharingFirefoxDisabled","firefoxExtInstalled","desktopSharingFirefoxExtId","chromeExtInstalled","chromeExtUpdateRequired","reDetectFirefoxExtension","ScreenObtainer","intChromeExtPromise","disableDesktopSharing","desktopSharingChromeDisabled","_createObtainStreamMethod","JitsiMeetNW","obtainDesktopStream","jitsiError","obtainScreenOnElectron","desktopSharingChromeMethod","append","obtainScreenFromExtension","obtainScreenOnFirefox","extensionRequired","maxVersion","desktopSharingFirefoxMaxVersionExtRequired","JitsiMeetScreenObtainer","openDesktopPicker","_options","gumOptions","alert","handleExternalInstall","install","handleExtensionInstallationError","webStoreInstallUrl","checkForChromeExtensionOnInterval","checkAgain","adapterFactory","dependencies","shimChrome","shimFirefox","shimEdge","shimSafari","commonShim","shimAddTrackRemoveTrack","shimGetSendersWithDtmf","shimRTCIceCandidate","shimReplaceTrack","shimRTCIceServerUrls","shimCallbacksAPI","shimLocalStreamsAPI","shimRemoteStreamsAPI","shimTrackEventTransceiver","shimCreateOfferLegacy","origSetRemoteDescription","shimSenderWithDtmf","dtmf","_dtmf","createDTMFSender","_pc","_senders","origAddTrack","origRemoveTrack","origAddStream","origRemoveStream","origGetSenders","replaceInternalStreamId","_reverseStreams","internalId","externalStream","internalStream","_streams","origGetLocalStreams","nativeStreams","newStream","oldStream","origSetLocalDescription","origLocalDescription","OrigPeerConnection","localcandidate","remotecandidate","remap","getSupportedFacingModeLies","dev","DevicesNotFoundError","TrackStartError","MediaDeviceFailedDueToShutdown","MediaDeviceKillSwitchOn","shimRTCPeerConnection","origMSTEnabled","RTCDtmfSender","setTrack","dtlsRole","getCommonCapabilities","findCodecByPayloadType","lRtx","rRtx","lCodecs","rCodecs","isActionAllowedInSignalingState","maybeAddCandidate","alreadyAdded","getRemoteCandidates","makeError","addTrackToStreamAndFireEvent","MediaStreamTrackEvent","fireAddTrack","_dispatchEvent","hasTurn","canTrickleIceCandidates","needNegotiation","rtcpMuxPolicy","isString","_iceGatherers","iceCandidatePoolSize","_config","_sdpSessionId","_sdpSessionVersion","_dtlsRole","_isClosed","onicegatheringstatechange","_emitGatheringStateChange","getConfiguration","_createTransceiver","hasBundleTransport","associatedRemoteMediaStreams","clonedStream","clonedTrack","_createIceGatherer","bufferedCandidateEvents","bufferCandidates","_gather","serializedCandidate","_disposeIceAndDtlsTransports","remoteMsid","setTransport","isNewTrack","nativeTrack","mediaSectionsInOffer","candidateString","inboundrtp","outboundrtp","candidatepair","webpackPolyfill","deprecate","paths","RTCTrackEvent","modernStatsTypes","InternalError","NotSupportedError","nativeGetUserMedia","nativeGetSettings","applyConstraints","nativeApplyConstraints","_localStreams","getStreamById","_addTrack","_onaddstream","_onaddstreampoly","withCallback","errcb","RTCTransceiver","origCreateOffer","audioTransceiver","getTransceivers","setDirection","addTransceiver","videoTransceiver","NativeRTCIceCandidate","nativeCandidate","parsedCandidate","augmentedCandidate","eventNameToWrap","nativeAddEventListener","nativeEventName","_eventMap","nativeRemoveEventListener","unwrappedCb","nativeCreateObjectURL","nativeRevokeObjectURL","newId","dsc","nativeSetAttribute","TraceablePeerConnection","audioTransferActive","_addedStreams","localSSRCs","localUfrag","remoteUfrag","_peerVideoTypeChanged","__WEBPACK_IMPORTED_MODULE_15__service_RTC_SignalingEvents__","_peerMutedChanged","__WEBPACK_IMPORTED_MODULE_7__RTCUtils__","statsinterval","maxstats","Interop","interop","Simulcast","numOfLayers","SIMULCAST_LAYERS","explodeRemoteSimulcast","sdpConsistency","__WEBPACK_IMPORTED_MODULE_12__xmpp_SdpConsistency__","localSdpMunger","__WEBPACK_IMPORTED_MODULE_5__LocalSdpMunger__","rtxModifier","__WEBPACK_IMPORTED_MODULE_10__xmpp_RtxModifier__","what","__WEBPACK_IMPORTED_MODULE_8__browser__","_remoteStreamAdded","_remoteStreamRemoved","endTime","extractPrimarySSRC","SIM_LAYER_RIDS","dumpSDP","_getDesiredMediaDirection","mediaTransferActive","hasAnyTracksOfType","supportsSimulcast","videoTrack","_setVideoType","endpoints","endpointTrackMap","mediaTrack","__WEBPACK_IMPORTED_MODULE_6__RTC__","onaddtrack","_remoteTrackAdded","onremovetrack","_remoteTrackRemoved","streamAudioTracks","streamVideoTracks","mediaLines","__WEBPACK_IMPORTED_MODULE_11__xmpp_SDP__","mls","__WEBPACK_IMPORTED_MODULE_14__xmpp_SDPUtil__","trackSsrc","ownerEndpointId","getSSRCOwner","peerMediaInfo","getPeerMediaInfo","_createRemoteTrack","__WEBPACK_IMPORTED_MODULE_3__JitsiRemoteTrack__","remoteTracksMap","isUserStream","_removeRemoteTrackById","_getRemoteTrackById","removedAudioTrack","removedVideoTrack","_removeRemoteTrack","toBeRemoved","_getSSRC","_injectSsrcGroupForUnifiedSimulcast","__WEBPACK_IMPORTED_MODULE_1_sdp_transform___default","simulcast_03","getters","toPlanB","maybeAddMutedLocalVideoTracksToSDP","transformer","__WEBPACK_IMPORTED_MODULE_13__xmpp_SdpTransformUtil__","audioMedia","selectMedia","changed","videoMedia","toRawSDP","transformStreamIdentifiers","webrtcStream","generateNewStreamSSRCInfo","setPrimarySsrc","setSsrcCache","fidGroups","rtxSsrcMapping","_assertTrackBelongs","webRtcStream","_handleFirefoxRemoveStream","doesBelong","isMediaStreamInPc","_ensureSimulcastGroupIsLast","localSdp","sdpStr","videoStartIndex","simStartIndex","otherStartIndex","simEndIndex","simStr","otherEndIndex","_adjustLocalMediaDirection","modifiedDirection","desiredAudioDirection","desiredVideoDirection","parsedSdp","toUnifiedPlan","_insertUnifiedPlanSimulcastReceive","mungeRemoteDescription","stripRtx","firstSsrcs","newSsrcLines","resStr","_injectH264IfNotPresent","payloadsArray","dummyPayloadType","clearVideoSsrcCache","peerTracks","_removePeerConnection","supportsRtpSender","simParams","scaleResolutionDownBy","setParameters","_createOfferOrAnswer","isOffer","_successCallback","resultSdp","hasPrimarySsrcCached","makeVideoPrimarySsrcsConsistent","mungeLocalDescription","modifyRtxSsrcs","groupsMap","groupSSRCs","_processLocalSSRCsMap","_errorCallback","trackMSID","newSSRCNum","oldSSRCNum","currNumSsrcs","RTCEvents","ttfmTrackerAudioAttached","ttfmTrackerVideoAttached","JitsiRemoteTrack","hasBeenMuted","_bindMuteHandlers","_onTrackMute","_onTrackUnmute","gumStart","gumEnd","gumDuration","ttfm","__WEBPACK_IMPORTED_MODULE_4__statistics_statistics__","__WEBPACK_IMPORTED_MODULE_3__browser__","_playCallback","LocalSdpMunger","localVideos","isInPeerConnection","shouldFakeSdp","requiredSSRCs","ssrcCache","cachedPrimarySsrc","primaryCname","removeSSRC","addSSRCAttribute","addSSRCGroup","modifyRtxSsrcs2","pcId","streamAndTrackIDs","__WEBPACK_IMPORTED_MODULE_2__xmpp_SdpTransformUtil__","_addMutedLocalVideoTracksToSDP","sessionDesc","audioMLine","_transformMediaIdentifiers","updateAssociatedRtxStream","primarySsrcInfo","primarySsrcMsid","primarySsrcCname","previousRtxSSRC","getRtxSSRC","dumpSSRCGroups","removeGroupsWithSSRC","RtxModifier","correspondingRtxSsrcs","ssrcMapping","sdpTransformer","__WEBPACK_IMPORTED_MODULE_1__SdpTransformUtil__","getSSRCCount","primaryVideoSsrcs","getPrimaryVideoSSRCs","getSSRCAttrValue","correspondingRtxSsrc","previousAssociatedRtxStream","__WEBPACK_IMPORTED_MODULE_2__SDPUtil__","containsAnySSRCGroups","findGroups","removeGroupsBySemantics","SdpConsistency","injectRecvOnly","newPrimarySsrc","getPrimaryVideoSsrc","replaceSSRC","mlB2UMap","mlU2BMap","candidateToUnifiedPlan","candidateToPlanB","getFirstSendingIndexFromAnswer","rewrite","type2bl","uLine","bundleOnly","cached","hasBundle","recvonlySsrcs","mid2ul","bIdx","uIdx","bLine","ssrc2group","ssrc2ml","related","DEFAULT_NUM_OF_LAYERS","processVideo","validateDescription","transformUtils","parseSsrcs","writeSsrcs","clearSsrcCache","_parseSimLayers","_buildNewToOldSsrcMap","newSsrcList","oldSsrcList","newSsrc","oldSsrc","_fillInSourceDataFromCache","newSimSsrcs","newMsid","newCname","ssrcsToReplace","ssrcsToAdd","_generateSourceData","simSsrcs","simSsrc","_restoreSimulcast","simulcastSsrcs","relatedGroup","relatedSsrcs","relatedSSRC","nuke","invalid","TalkMutedDetection","_eventFired","_trackMuteChanged","_trackAdded","_isLocalAudioTrack","Transcriber","audioRecorder","transcriptionService","SphinxService","transcription","BEFORE_STATE","lineLength","hasPopulatedArrays","twoDimensionalArray","RECORDING_STATE","TRANSCRIBING_STATE","FINISHED_STATE","callBack","wordArray","offset","getUTCMilliseconds","wordObject","begin","word","maybeMerge","recordingResult","merge","arrays","potentialWords","lowestWordArray","wordToAdd","updateTranscription","foundSmaller","wordToCompare","getTranscription","TranscriptionService","Word","sphinxURL","toReturn","sendRequest","audioFileBlob","DONE","formatResponse","objects","filler","verify","audioBlob","getWord","getBeginTime","getEndTime","VideoSIPGW","sessionStateChangeListener","sessionStateChanged","handleJibriSIPStatus","handleJibriSIPState","__WEBPACK_IMPORTED_MODULE_2__VideoSIPGWConstants__","sipaddress","setState","__WEBPACK_IMPORTED_MODULE_1__JitsiVideoSIPGWSession__","addStateListener","removeStateListener","STATE_CHANGED","JitsiVideoSIPGWSession","__WEBPACK_IMPORTED_MODULE_3__VideoSIPGWConstants__","_sendJibriIQ","displayname","SpeakerStatsCollector","users","dominantSpeakerId","__WEBPACK_IMPORTED_MODULE_1__SpeakerStats___default","_onDominantSpeaker","_onUserJoin","_onUserLeave","_onDisplayNameChange","oldDominantSpeaker","newDominantSpaker","setIsDominantSpeaker","savedUser","markAsHasLeft","SpeakerStats","isLocalStats","_userId","_isLocalStats","totalDominantSpeakerTime","_dominantSpeakerStart","_hasLeft","_isDominantSpeaker","isNowDominantSpeaker","timeElapsed","logOutputDevice","__WEBPACK_IMPORTED_MODULE_5__modules_statistics_statistics__","__WEBPACK_IMPORTED_MODULE_3__modules_RTC_RTC__","JitsiMediaDevices","isDevicePermissionGranted","permissions","__WEBPACK_IMPORTED_MODULE_2__modules_browser__","__WEBPACK_IMPORTED_MODULE_4__service_RTC_RTCEvents___default","__WEBPACK_IMPORTED_MODULE_6__JitsiMediaDevicesEvents__","getVideoElementName","findVideoElement","containerElement","videoElemName","matching","isResizeEventSupported","setVolume","streamElement","volume","setAutoPlay","autoPlay","autoplay"],"mappings":"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","file":"lib-jitsi-meet.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"JitsiMeetJS\"] = factory();\n\telse\n\t\troot[\"JitsiMeetJS\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 61);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 411c2ea0274938935199","/* Copyright @ 2015 Atlassian Pty Ltd\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nvar Logger = require(\"./Logger\");\r\nvar LogCollector = require(\"./LogCollector\");\r\n\r\n/**\r\n * Definition of the log method\r\n * @name log_method\r\n * @function\r\n * @param {...*} log_args the arguments to be logged\r\n */\r\n/**\r\n * The logger's transport type definition.\r\n *\r\n * @typedef {object} LoggerTransport\r\n *\r\n * @property {log_method} trace method called to log on {@link Logger.levels.TRACE} logging level\r\n * @property {log_method} debug method called to log on {@link Logger.levels.DEBUG} logging level\r\n * @property {log_method} info method called to log on {@link Logger.levels.INFO} logging level\r\n * @property {log_method} log method called to log on {@link Logger.levels.LOG} logging level\r\n * @property {log_method} warn method called to log on {@link Logger.levels.WARN} logging level\r\n * @property {log_method} error method called to log on {@link Logger.levels.ERROR} logging level\r\n */\r\n\r\n/**\r\n * Map with the created loggers with ID.\r\n */\r\nvar idLoggers = {};\r\n\r\n/**\r\n * Array with the loggers without id.\r\n */\r\nvar loggers = [];\r\n\r\n/**\r\n * Log level for the lbrary.\r\n */\r\nvar curLevel = Logger.levels.TRACE;\r\n\r\n\r\nmodule.exports = {\r\n    /**\r\n     * Adds given {@link LoggerTransport} instance to the list of global\r\n     * transports which means that it'll be used by all {@link Logger}s\r\n     * @param {LoggerTransport} transport\r\n     */\r\n    addGlobalTransport: function(transport) {\r\n        Logger.addGlobalTransport(transport);\r\n    },\r\n    /**\r\n     * Removes given {@link LoggerTransport} instance from the list of global\r\n     * transports\r\n     * @param {LoggerTransport} transport\r\n     */\r\n    removeGlobalTransport: function(transport) {\r\n        Logger.removeGlobalTransport(transport);\r\n    },\r\n    /**\r\n     * Creates new logger.\r\n     * @arguments the same as Logger constructor\r\n     */\r\n    getLogger: function(id, transports, format) {\r\n        var logger = new Logger(curLevel, id, transports, format);\r\n        if(id) {\r\n            idLoggers[id] = idLoggers[id] || [];\r\n            idLoggers[id].push(logger);\r\n        } else {\r\n            loggers.push(logger);\r\n        }\r\n        return logger;\r\n    },\r\n    /**\r\n     * Changes the log level for the existing loggers by id.\r\n     * @param level the new log level.\r\n     * @param id if specified the level will be changed only for loggers with the\r\n     * same id. Otherwise the operation will affect all loggers that don't\r\n     * have id.\r\n     */\r\n    setLogLevelById: function(level, id) {\r\n        var l = id? (idLoggers[id] || []) : loggers;\r\n        for(var i = 0; i < l.length; i++) {\r\n            l[i].setLevel(level);\r\n        }\r\n    },\r\n    /**\r\n     * Changes the log level for all existing loggers.\r\n     * @param level the new log level.\r\n     */\r\n    setLogLevel: function (level) {\r\n        curLevel = level;\r\n        var i = 0;\r\n        for(; i < loggers.length; i++) {\r\n            loggers[i].setLevel(level);\r\n        }\r\n\r\n        for(var id in idLoggers) {\r\n            var l = idLoggers[id] || [];\r\n            for(i = 0; i < l.length; i++) {\r\n                l[i].setLevel(level);\r\n            }\r\n        }\r\n    },\r\n    /**\r\n     * The supported log levels.\r\n     */\r\n    levels: Logger.levels,\r\n    /**\r\n     * Exports the <tt>LogCollector</tt>.\r\n     */\r\n    LogCollector: LogCollector\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/jitsi-meet-logger/lib/index.js","import BrowserDetection from './BrowserDetection';\r\nimport capabilitiesDB from './capabilities.json';\r\n\r\n// TODO: All methods should use capabilities.json when possible.\r\n\r\n// NOTE: Now we are extending BrowserDetection in order to preserve\r\n// RTCBrowserType interface but maybe it worth exporting BrowserCapabilities\r\n// and BrowserDetection as separate objects in future.\r\n\r\n/**\r\n * Implements browser capabilities for lib-jitsi-meet.\r\n */\r\nexport default class BrowserCapabilities extends BrowserDetection {\r\n    /**\r\n     * Creates new BrowserCapabilities instance.\r\n     *\r\n     * @param {boolean} [isUsingIFrame] - True if Jitsi Meet is loaded in iframe\r\n     * and false otherwise.\r\n     * @param {Object} [browserInfo] - Information about the browser.\r\n     * @param {string} browserInfo.name - The name of the browser.\r\n     * @param {string} browserInfo.version - The version of the browser.\r\n     */\r\n    constructor(isUsingIFrame = false, browserInfo) {\r\n        super(browserInfo);\r\n\r\n        const browserCapabilities = capabilitiesDB[this.getName()] || [];\r\n        let capabilitiesByVersion;\r\n\r\n        for (let i = 0; i < browserCapabilities.length; i++) {\r\n            const capabilities = browserCapabilities[i];\r\n\r\n            if (typeof capabilities !== 'object') {\r\n                // eslint-disable-next-line no-continue\r\n                continue;\r\n            }\r\n\r\n            const version = capabilities.version;\r\n\r\n            if (!version || !this.isVersionGreaterThan(version)) {\r\n                capabilitiesByVersion = capabilities;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (!capabilitiesByVersion || !capabilitiesByVersion.capabilities) {\r\n            this._capabilities = { isSupported: false };\r\n        } else if (isUsingIFrame) {\r\n            this._capabilities = {\r\n                ...capabilitiesByVersion.capabilities,\r\n                ...capabilitiesByVersion.iframeCapabilities\r\n            };\r\n        } else {\r\n            this._capabilities = capabilitiesByVersion.capabilities;\r\n        }\r\n\r\n        if (typeof this._capabilities.isSupported === 'undefined') {\r\n            // we have some capabilities but isSupported property is not filled.\r\n            this._capabilities.isSupported = true;\r\n        } else if (this._capabilities.isSupported === false) {\r\n            this._capabilities = { isSupported: false };\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Tells whether or not the <tt>MediaStream/tt> is removed from\r\n     * the <tt>PeerConnection</tt> and disposed on video mute (in order to turn\r\n     * off the camera device).\r\n     * @return {boolean} <tt>true</tt> if the current browser supports this\r\n     * strategy or <tt>false</tt> otherwise.\r\n     */\r\n    doesVideoMuteByStreamRemove() {\r\n        return !(\r\n            this.isFirefox()\r\n            || this.isEdge()\r\n            || this.isSafariWithWebrtc()\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Check whether or not the current browser support peer to peer connections\r\n     * @return {boolean} <tt>true</tt> if p2p is supported or <tt>false</tt>\r\n     * otherwise.\r\n     */\r\n    supportsP2P() {\r\n        return !this.isEdge();\r\n    }\r\n\r\n    /**\r\n     * Checks if current browser is a Safari and a version of Safari that\r\n     * supports native webrtc.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    isSafariWithWebrtc() {\r\n        return this.isSafari()\r\n            && !this.isVersionLessThan('11');\r\n    }\r\n\r\n    /**\r\n     * Checks whether the browser is supported by Jitsi Meet.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    isSupported() {\r\n        return this._capabilities.isSupported;\r\n    }\r\n\r\n    /**\r\n     * Checks if Temasys RTC plugin is used.\r\n     * @returns {boolean}\r\n     */\r\n    isTemasysPluginUsed() {\r\n        // Temasys do not support Microsoft Edge:\r\n        // http://support.temasys.com.sg/support/solutions/articles/\r\n        // 5000654345-can-the-temasys-webrtc-plugin-be-used-with-microsoft-edge-\r\n        return (\r\n            (this.isSafari()\r\n                && !this.isSafariWithWebrtc())\r\n            || (this.isIExplorer()\r\n                && this.isVersionLessThan('12'))\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Checks if the current browser triggers 'onmute'/'onunmute' events when\r\n     * user's connection is interrupted and the video stops playback.\r\n     * @returns {*|boolean} 'true' if the event is supported or 'false'\r\n     * otherwise.\r\n     */\r\n    supportsVideoMuteOnConnInterrupted() {\r\n        return this.isChrome() || this.isElectron();\r\n    }\r\n\r\n\r\n    /**\r\n     * Checks whether the browser supports incoming audio.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    supportsAudioIn() {\r\n        return this._capabilities.audioIn || false;\r\n    }\r\n\r\n    /**\r\n     * Checks whether the browser supports outgoing audio.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    supportsAudioOut() {\r\n        return this._capabilities.audioOut || false;\r\n    }\r\n\r\n    /**\r\n     * Checks if the current browser reports upload and download bandwidth\r\n     * statistics.\r\n     * @return {boolean}\r\n     */\r\n    supportsBandwidthStatistics() {\r\n        // FIXME bandwidth stats are currently not implemented for FF on our\r\n        // side, but not sure if not possible ?\r\n        return !this.isFirefox() && !this.isEdge();\r\n    }\r\n\r\n    /**\r\n     * Checks if the current browser supports WebRTC datachannels.\r\n     * @return {boolean}\r\n     */\r\n    supportsDataChannels() {\r\n        // NOTE: Edge does not yet implement DataChannel.\r\n        return !this.isEdge();\r\n    }\r\n\r\n    /**\r\n     * Checks if the current browser reports round trip time statistics for\r\n     * the ICE candidate pair.\r\n     * @return {boolean}\r\n     */\r\n    supportsRTTStatistics() {\r\n        // Firefox does not seem to report RTT for ICE candidate pair:\r\n        // eslint-disable-next-line max-len\r\n        // https://www.w3.org/TR/webrtc-stats/#dom-rtcicecandidatepairstats-currentroundtriptime\r\n        // It does report mozRTT for RTP streams, but at the time of this\r\n        // writing it's value does not make sense most of the time\r\n        // (is reported as 1):\r\n        // https://bugzilla.mozilla.org/show_bug.cgi?id=1241066\r\n        // For Chrome and others we rely on 'googRtt'.\r\n        return !this.isFirefox() && !this.isEdge();\r\n    }\r\n\r\n    /**\r\n     * Checks whether the browser supports RTPSender.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    supportsRtpSender() {\r\n        return this.isFirefox();\r\n    }\r\n\r\n    /**\r\n     * Checks whether the browser supports RTX.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    supportsRtx() {\r\n        return !this.isFirefox();\r\n    }\r\n\r\n    /**\r\n     * Checks whether the browser supports screen sharing.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    supportsScreenSharing() {\r\n        return this._capabilities.screenSharing || false;\r\n    }\r\n\r\n    /**\r\n     * Whether jitsi-meet supports simulcast on the current browser.\r\n     * @returns {boolean}\r\n     */\r\n    supportsSimulcast() {\r\n        return this.isChrome()\r\n            || this.isFirefox()\r\n            || this.isElectron()\r\n            || this.isNWJS()\r\n            || this.isReactNative();\r\n    }\r\n\r\n    /**\r\n     * Returns whether or not the current browser can support capturing video,\r\n     * be it camera or desktop, and displaying received video.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    supportsVideo() {\r\n        // FIXME: Check if we can use supportsVideoOut and supportsVideoIn. I\r\n        // leave the old implementation here in order not to brake something.\r\n\r\n        // Currently Safari using webrtc/adapter does not support video due in\r\n        // part to Safari only supporting H264 and the bridge sending VP8.\r\n        return !this.isSafariWithWebrtc();\r\n    }\r\n\r\n    /**\r\n     * Checks whether the browser supports incomming video.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    supportsVideoIn() {\r\n        return this._capabilities.videoIn || false;\r\n    }\r\n\r\n    /**\r\n     * Checks whether the browser supports incomming video.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    supportsVideoOut() {\r\n        return this._capabilities.videoOut || false;\r\n    }\r\n\r\n    /**\r\n     * Checks if the browser uses plan B.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    usesPlanB() {\r\n        return !this.usesUnifiedPlan();\r\n    }\r\n\r\n    /**\r\n     * Checks if the browser uses unified plan.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    usesUnifiedPlan() {\r\n        return this.isFirefox();\r\n    }\r\n\r\n    /**\r\n     * Returns whether or not the current browser should be using the new\r\n     * getUserMedia flow, which utilizes the adapter shim. This method should\r\n     * be temporary and used while migrating all browsers to use adapter and\r\n     * the new getUserMedia.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    usesNewGumFlow() {\r\n        return (this.isChrome()\r\n                && !this.isVersionLessThan('61'))\r\n            || this.isFirefox()\r\n            || this.isSafariWithWebrtc();\r\n\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/browser/BrowserCapabilities.js","import BrowserCapabilities from './BrowserCapabilities';\r\n\r\nexport * as browsers from './browsers';\r\nexport default new BrowserCapabilities();\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/browser/index.js","/** File: strophe.js\r\n *  A JavaScript library for writing XMPP clients.\r\n *\r\n *  This library uses either Bidirectional-streams Over Synchronous HTTP (BOSH)\r\n *  to emulate a persistent, stateful, two-way connection to an XMPP server or\r\n *  alternatively WebSockets.\r\n *\r\n *  More information on BOSH can be found in XEP 124.\r\n *  For more information on XMPP-over WebSocket see this RFC:\r\n *  http://tools.ietf.org/html/rfc7395\r\n */\r\n\r\n/* All of the Strophe globals are defined in this special function below so\r\n * that references to the globals become closures.  This will ensure that\r\n * on page reload, these references will still be available to callbacks\r\n * that are still executing.\r\n */\r\n\r\n/* jshint ignore:start */\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        //Allow using this built library as an AMD module\r\n        //in another project. That other project will only\r\n        //see this AMD call, not the internal modules in\r\n        //the closure below.\r\n        define([], factory);\r\n    } else {\r\n        //Browser globals case.\r\n        var wrapper = factory();\r\n        root.Strophe        = wrapper.Strophe;\r\n        root.$build         = wrapper.$build;\r\n        root.$iq            = wrapper.$iq;\r\n        root.$msg           = wrapper.$msg;\r\n        root.$pres          = wrapper.$pres;\r\n        root.SHA1           = wrapper.SHA1;\r\n        root.MD5            = wrapper.MD5;\r\n        root.b64_hmac_sha1  = wrapper.b64_hmac_sha1;\r\n        root.b64_sha1       = wrapper.b64_sha1;\r\n        root.str_hmac_sha1  = wrapper.str_hmac_sha1;\r\n        root.str_sha1       = wrapper.str_sha1;\r\n    }\r\n}(this, function () {\r\n    //almond, and your modules will be inlined here\r\n/* jshint ignore:end */\r\n/**\r\n * @license almond 0.3.3 Copyright jQuery Foundation and other contributors.\r\n * Released under MIT license, http://github.com/requirejs/almond/LICENSE\r\n */\r\n//Going sloppy to avoid 'use strict' string cost, but strict practices should\r\n//be followed.\r\n/*global setTimeout: false */\r\n\r\nvar requirejs, require, define;\r\n(function (undef) {\r\n    var main, req, makeMap, handlers,\r\n        defined = {},\r\n        waiting = {},\r\n        config = {},\r\n        defining = {},\r\n        hasOwn = Object.prototype.hasOwnProperty,\r\n        aps = [].slice,\r\n        jsSuffixRegExp = /\\.js$/;\r\n\r\n    function hasProp(obj, prop) {\r\n        return hasOwn.call(obj, prop);\r\n    }\r\n\r\n    /**\r\n     * Given a relative module name, like ./something, normalize it to\r\n     * a real name that can be mapped to a path.\r\n     * @param {String} name the relative name\r\n     * @param {String} baseName a real name that the name arg is relative\r\n     * to.\r\n     * @returns {String} normalized name\r\n     */\r\n    function normalize(name, baseName) {\r\n        var nameParts, nameSegment, mapValue, foundMap, lastIndex,\r\n            foundI, foundStarMap, starI, i, j, part, normalizedBaseParts,\r\n            baseParts = baseName && baseName.split(\"/\"),\r\n            map = config.map,\r\n            starMap = (map && map['*']) || {};\r\n\r\n        //Adjust any relative paths.\r\n        if (name) {\r\n            name = name.split('/');\r\n            lastIndex = name.length - 1;\r\n\r\n            // If wanting node ID compatibility, strip .js from end\r\n            // of IDs. Have to do this here, and not in nameToUrl\r\n            // because node allows either .js or non .js to map\r\n            // to same file.\r\n            if (config.nodeIdCompat && jsSuffixRegExp.test(name[lastIndex])) {\r\n                name[lastIndex] = name[lastIndex].replace(jsSuffixRegExp, '');\r\n            }\r\n\r\n            // Starts with a '.' so need the baseName\r\n            if (name[0].charAt(0) === '.' && baseParts) {\r\n                //Convert baseName to array, and lop off the last part,\r\n                //so that . matches that 'directory' and not name of the baseName's\r\n                //module. For instance, baseName of 'one/two/three', maps to\r\n                //'one/two/three.js', but we want the directory, 'one/two' for\r\n                //this normalization.\r\n                normalizedBaseParts = baseParts.slice(0, baseParts.length - 1);\r\n                name = normalizedBaseParts.concat(name);\r\n            }\r\n\r\n            //start trimDots\r\n            for (i = 0; i < name.length; i++) {\r\n                part = name[i];\r\n                if (part === '.') {\r\n                    name.splice(i, 1);\r\n                    i -= 1;\r\n                } else if (part === '..') {\r\n                    // If at the start, or previous value is still ..,\r\n                    // keep them so that when converted to a path it may\r\n                    // still work when converted to a path, even though\r\n                    // as an ID it is less than ideal. In larger point\r\n                    // releases, may be better to just kick out an error.\r\n                    if (i === 0 || (i === 1 && name[2] === '..') || name[i - 1] === '..') {\r\n                        continue;\r\n                    } else if (i > 0) {\r\n                        name.splice(i - 1, 2);\r\n                        i -= 2;\r\n                    }\r\n                }\r\n            }\r\n            //end trimDots\r\n\r\n            name = name.join('/');\r\n        }\r\n\r\n        //Apply map config if available.\r\n        if ((baseParts || starMap) && map) {\r\n            nameParts = name.split('/');\r\n\r\n            for (i = nameParts.length; i > 0; i -= 1) {\r\n                nameSegment = nameParts.slice(0, i).join(\"/\");\r\n\r\n                if (baseParts) {\r\n                    //Find the longest baseName segment match in the config.\r\n                    //So, do joins on the biggest to smallest lengths of baseParts.\r\n                    for (j = baseParts.length; j > 0; j -= 1) {\r\n                        mapValue = map[baseParts.slice(0, j).join('/')];\r\n\r\n                        //baseName segment has  config, find if it has one for\r\n                        //this name.\r\n                        if (mapValue) {\r\n                            mapValue = mapValue[nameSegment];\r\n                            if (mapValue) {\r\n                                //Match, update name to the new value.\r\n                                foundMap = mapValue;\r\n                                foundI = i;\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if (foundMap) {\r\n                    break;\r\n                }\r\n\r\n                //Check for a star map match, but just hold on to it,\r\n                //if there is a shorter segment match later in a matching\r\n                //config, then favor over this star map.\r\n                if (!foundStarMap && starMap && starMap[nameSegment]) {\r\n                    foundStarMap = starMap[nameSegment];\r\n                    starI = i;\r\n                }\r\n            }\r\n\r\n            if (!foundMap && foundStarMap) {\r\n                foundMap = foundStarMap;\r\n                foundI = starI;\r\n            }\r\n\r\n            if (foundMap) {\r\n                nameParts.splice(0, foundI, foundMap);\r\n                name = nameParts.join('/');\r\n            }\r\n        }\r\n\r\n        return name;\r\n    }\r\n\r\n    function makeRequire(relName, forceSync) {\r\n        return function () {\r\n            //A version of a require function that passes a moduleName\r\n            //value for items that may need to\r\n            //look up paths relative to the moduleName\r\n            var args = aps.call(arguments, 0);\r\n\r\n            //If first arg is not require('string'), and there is only\r\n            //one arg, it is the array form without a callback. Insert\r\n            //a null so that the following concat is correct.\r\n            if (typeof args[0] !== 'string' && args.length === 1) {\r\n                args.push(null);\r\n            }\r\n            return req.apply(undef, args.concat([relName, forceSync]));\r\n        };\r\n    }\r\n\r\n    function makeNormalize(relName) {\r\n        return function (name) {\r\n            return normalize(name, relName);\r\n        };\r\n    }\r\n\r\n    function makeLoad(depName) {\r\n        return function (value) {\r\n            defined[depName] = value;\r\n        };\r\n    }\r\n\r\n    function callDep(name) {\r\n        if (hasProp(waiting, name)) {\r\n            var args = waiting[name];\r\n            delete waiting[name];\r\n            defining[name] = true;\r\n            main.apply(undef, args);\r\n        }\r\n\r\n        if (!hasProp(defined, name) && !hasProp(defining, name)) {\r\n            throw new Error('No ' + name);\r\n        }\r\n        return defined[name];\r\n    }\r\n\r\n    //Turns a plugin!resource to [plugin, resource]\r\n    //with the plugin being undefined if the name\r\n    //did not have a plugin prefix.\r\n    function splitPrefix(name) {\r\n        var prefix,\r\n            index = name ? name.indexOf('!') : -1;\r\n        if (index > -1) {\r\n            prefix = name.substring(0, index);\r\n            name = name.substring(index + 1, name.length);\r\n        }\r\n        return [prefix, name];\r\n    }\r\n\r\n    //Creates a parts array for a relName where first part is plugin ID,\r\n    //second part is resource ID. Assumes relName has already been normalized.\r\n    function makeRelParts(relName) {\r\n        return relName ? splitPrefix(relName) : [];\r\n    }\r\n\r\n    /**\r\n     * Makes a name map, normalizing the name, and using a plugin\r\n     * for normalization if necessary. Grabs a ref to plugin\r\n     * too, as an optimization.\r\n     */\r\n    makeMap = function (name, relParts) {\r\n        var plugin,\r\n            parts = splitPrefix(name),\r\n            prefix = parts[0],\r\n            relResourceName = relParts[1];\r\n\r\n        name = parts[1];\r\n\r\n        if (prefix) {\r\n            prefix = normalize(prefix, relResourceName);\r\n            plugin = callDep(prefix);\r\n        }\r\n\r\n        //Normalize according\r\n        if (prefix) {\r\n            if (plugin && plugin.normalize) {\r\n                name = plugin.normalize(name, makeNormalize(relResourceName));\r\n            } else {\r\n                name = normalize(name, relResourceName);\r\n            }\r\n        } else {\r\n            name = normalize(name, relResourceName);\r\n            parts = splitPrefix(name);\r\n            prefix = parts[0];\r\n            name = parts[1];\r\n            if (prefix) {\r\n                plugin = callDep(prefix);\r\n            }\r\n        }\r\n\r\n        //Using ridiculous property names for space reasons\r\n        return {\r\n            f: prefix ? prefix + '!' + name : name, //fullName\r\n            n: name,\r\n            pr: prefix,\r\n            p: plugin\r\n        };\r\n    };\r\n\r\n    function makeConfig(name) {\r\n        return function () {\r\n            return (config && config.config && config.config[name]) || {};\r\n        };\r\n    }\r\n\r\n    handlers = {\r\n        require: function (name) {\r\n            return makeRequire(name);\r\n        },\r\n        exports: function (name) {\r\n            var e = defined[name];\r\n            if (typeof e !== 'undefined') {\r\n                return e;\r\n            } else {\r\n                return (defined[name] = {});\r\n            }\r\n        },\r\n        module: function (name) {\r\n            return {\r\n                id: name,\r\n                uri: '',\r\n                exports: defined[name],\r\n                config: makeConfig(name)\r\n            };\r\n        }\r\n    };\r\n\r\n    main = function (name, deps, callback, relName) {\r\n        var cjsModule, depName, ret, map, i, relParts,\r\n            args = [],\r\n            callbackType = typeof callback,\r\n            usingExports;\r\n\r\n        //Use name if no relName\r\n        relName = relName || name;\r\n        relParts = makeRelParts(relName);\r\n\r\n        //Call the callback to define the module, if necessary.\r\n        if (callbackType === 'undefined' || callbackType === 'function') {\r\n            //Pull out the defined dependencies and pass the ordered\r\n            //values to the callback.\r\n            //Default to [require, exports, module] if no deps\r\n            deps = !deps.length && callback.length ? ['require', 'exports', 'module'] : deps;\r\n            for (i = 0; i < deps.length; i += 1) {\r\n                map = makeMap(deps[i], relParts);\r\n                depName = map.f;\r\n\r\n                //Fast path CommonJS standard dependencies.\r\n                if (depName === \"require\") {\r\n                    args[i] = handlers.require(name);\r\n                } else if (depName === \"exports\") {\r\n                    //CommonJS module spec 1.1\r\n                    args[i] = handlers.exports(name);\r\n                    usingExports = true;\r\n                } else if (depName === \"module\") {\r\n                    //CommonJS module spec 1.1\r\n                    cjsModule = args[i] = handlers.module(name);\r\n                } else if (hasProp(defined, depName) ||\r\n                           hasProp(waiting, depName) ||\r\n                           hasProp(defining, depName)) {\r\n                    args[i] = callDep(depName);\r\n                } else if (map.p) {\r\n                    map.p.load(map.n, makeRequire(relName, true), makeLoad(depName), {});\r\n                    args[i] = defined[depName];\r\n                } else {\r\n                    throw new Error(name + ' missing ' + depName);\r\n                }\r\n            }\r\n\r\n            ret = callback ? callback.apply(defined[name], args) : undefined;\r\n\r\n            if (name) {\r\n                //If setting exports via \"module\" is in play,\r\n                //favor that over return value and exports. After that,\r\n                //favor a non-undefined return value over exports use.\r\n                if (cjsModule && cjsModule.exports !== undef &&\r\n                        cjsModule.exports !== defined[name]) {\r\n                    defined[name] = cjsModule.exports;\r\n                } else if (ret !== undef || !usingExports) {\r\n                    //Use the return value from the function.\r\n                    defined[name] = ret;\r\n                }\r\n            }\r\n        } else if (name) {\r\n            //May just be an object definition for the module. Only\r\n            //worry about defining if have a module name.\r\n            defined[name] = callback;\r\n        }\r\n    };\r\n\r\n    requirejs = require = req = function (deps, callback, relName, forceSync, alt) {\r\n        if (typeof deps === \"string\") {\r\n            if (handlers[deps]) {\r\n                //callback in this case is really relName\r\n                return handlers[deps](callback);\r\n            }\r\n            //Just return the module wanted. In this scenario, the\r\n            //deps arg is the module name, and second arg (if passed)\r\n            //is just the relName.\r\n            //Normalize module name, if it contains . or ..\r\n            return callDep(makeMap(deps, makeRelParts(callback)).f);\r\n        } else if (!deps.splice) {\r\n            //deps is a config object, not an array.\r\n            config = deps;\r\n            if (config.deps) {\r\n                req(config.deps, config.callback);\r\n            }\r\n            if (!callback) {\r\n                return;\r\n            }\r\n\r\n            if (callback.splice) {\r\n                //callback is an array, which means it is a dependency list.\r\n                //Adjust args if there are dependencies\r\n                deps = callback;\r\n                callback = relName;\r\n                relName = null;\r\n            } else {\r\n                deps = undef;\r\n            }\r\n        }\r\n\r\n        //Support require(['a'])\r\n        callback = callback || function () {};\r\n\r\n        //If relName is a function, it is an errback handler,\r\n        //so remove it.\r\n        if (typeof relName === 'function') {\r\n            relName = forceSync;\r\n            forceSync = alt;\r\n        }\r\n\r\n        //Simulate async callback;\r\n        if (forceSync) {\r\n            main(undef, deps, callback, relName);\r\n        } else {\r\n            //Using a non-zero value because of concern for what old browsers\r\n            //do, and latest browsers \"upgrade\" to 4 if lower value is used:\r\n            //http://www.whatwg.org/specs/web-apps/current-work/multipage/timers.html#dom-windowtimers-settimeout:\r\n            //If want a value immediately, use require('id') instead -- something\r\n            //that works in almond on the global level, but not guaranteed and\r\n            //unlikely to work in other AMD implementations.\r\n            setTimeout(function () {\r\n                main(undef, deps, callback, relName);\r\n            }, 4);\r\n        }\r\n\r\n        return req;\r\n    };\r\n\r\n    /**\r\n     * Just drops the config on the floor, but returns req in case\r\n     * the config return value is used.\r\n     */\r\n    req.config = function (cfg) {\r\n        return req(cfg);\r\n    };\r\n\r\n    /**\r\n     * Expose module registry for debugging and tooling\r\n     */\r\n    requirejs._defined = defined;\r\n\r\n    define = function (name, deps, callback) {\r\n        if (typeof name !== 'string') {\r\n            throw new Error('See almond README: incorrect module build, no module name');\r\n        }\r\n\r\n        //This module may not have dependencies\r\n        if (!deps.splice) {\r\n            //deps is not an array, so probably means\r\n            //an object literal or factory function for\r\n            //the value. Adjust args.\r\n            callback = deps;\r\n            deps = [];\r\n        }\r\n\r\n        if (!hasProp(defined, name) && !hasProp(waiting, name)) {\r\n            waiting[name] = [name, deps, callback];\r\n        }\r\n    };\r\n\r\n    define.amd = {\r\n        jQuery: true\r\n    };\r\n}());\r\n\r\ndefine(\"node_modules/almond/almond.js\", function(){});\r\n\r\n/*\r\n    This program is distributed under the terms of the MIT license.\r\n    Please see the LICENSE file for details.\r\n\r\n    Copyright 2006-2008, OGG, LLC\r\n*/\r\n/* jshint undef: true, unused: true:, noarg: true, latedef: true */\r\n/* global define */\r\n\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('strophe-polyfill',[], function () {\r\n            return factory(root);\r\n        });\r\n    } else {\r\n        // Browser globals\r\n        return factory(root);\r\n    }\r\n}(this, function (root) {\r\n\r\n/** Function: Function.prototype.bind\r\n *  Bind a function to an instance.\r\n *\r\n *  This Function object extension method creates a bound method similar\r\n *  to those in Python.  This means that the 'this' object will point\r\n *  to the instance you want.  See <MDC's bind() documentation at https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/bind>\r\n *  and <Bound Functions and Function Imports in JavaScript at http://benjamin.smedbergs.us/blog/2007-01-03/bound-functions-and-function-imports-in-javascript/>\r\n *  for a complete explanation.\r\n *\r\n *  This extension already exists in some browsers (namely, Firefox 3), but\r\n *  we provide it to support those that don't.\r\n *\r\n *  Parameters:\r\n *    (Object) obj - The object that will become 'this' in the bound function.\r\n *    (Object) argN - An option argument that will be prepended to the\r\n *      arguments given for the function call\r\n *\r\n *  Returns:\r\n *    The bound function.\r\n */\r\nif (!Function.prototype.bind) {\r\n    Function.prototype.bind = function (obj /*, arg1, arg2, ... */) {\r\n        var func = this;\r\n        var _slice = Array.prototype.slice;\r\n        var _concat = Array.prototype.concat;\r\n        var _args = _slice.call(arguments, 1);\r\n        return function () {\r\n            return func.apply(obj ? obj : this, _concat.call(_args, _slice.call(arguments, 0)));\r\n        };\r\n    };\r\n}\r\n\r\n/** Function: Array.isArray\r\n *  This is a polyfill for the ES5 Array.isArray method.\r\n */\r\nif (!Array.isArray) {\r\n    Array.isArray = function(arg) {\r\n        return Object.prototype.toString.call(arg) === '[object Array]';\r\n    };\r\n}\r\n\r\n/** Function: Array.prototype.indexOf\r\n *  Return the index of an object in an array.\r\n *\r\n *  This function is not supplied by some JavaScript implementations, so\r\n *  we provide it if it is missing.  This code is from:\r\n *  http://developer.mozilla.org/En/Core_JavaScript_1.5_Reference:Objects:Array:indexOf\r\n *\r\n *  Parameters:\r\n *    (Object) elt - The object to look for.\r\n *    (Integer) from - The index from which to start looking. (optional).\r\n *\r\n *  Returns:\r\n *    The index of elt in the array or -1 if not found.\r\n */\r\nif (!Array.prototype.indexOf) {\r\n    Array.prototype.indexOf = function(elt /*, from*/) {\r\n        var len = this.length;\r\n        var from = Number(arguments[1]) || 0;\r\n        from = (from < 0) ? Math.ceil(from) : Math.floor(from);\r\n        if (from < 0) {\r\n            from += len;\r\n        }\r\n\r\n        for (; from < len; from++) {\r\n            if (from in this && this[from] === elt) {\r\n                return from;\r\n            }\r\n        }\r\n        return -1;\r\n    };\r\n}\r\n\r\n/** Function: Array.prototype.forEach\r\n *\r\n *  This function is not available in IE < 9\r\n *\r\n *  See <forEach on developer.mozilla.org at https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach>\r\n */\r\nif (!Array.prototype.forEach) {\r\n    Array.prototype.forEach = function(callback, thisArg) {\r\n        var T, k;\r\n        if (this === null) {\r\n            throw new TypeError(' this is null or not defined');\r\n        }\r\n        // 1. Let O be the result of calling toObject() passing the\r\n        // |this| value as the argument.\r\n        var O = Object(this);\r\n        // 2. Let lenValue be the result of calling the Get() internal\r\n        // method of O with the argument \"length\".\r\n        // 3. Let len be toUint32(lenValue).\r\n        var len = O.length >>> 0;\r\n        // 4. If isCallable(callback) is false, throw a TypeError exception.\r\n        // See: http://es5.github.com/#x9.11\r\n        if (typeof callback !== \"function\") {\r\n            throw new TypeError(callback + ' is not a function');\r\n        }\r\n        // 5. If thisArg was supplied, let T be thisArg; else let\r\n        // T be undefined.\r\n        if (arguments.length > 1) {\r\n            T = thisArg;\r\n        }\r\n        // 6. Let k be 0\r\n        k = 0;\r\n        // 7. Repeat, while k < len\r\n        while (k < len) {\r\n            var kValue;\r\n            // a. Let Pk be ToString(k).\r\n            //        This is implicit for LHS operands of the in operator\r\n            // b. Let kPresent be the result of calling the HasProperty\r\n            //        internal method of O with argument Pk.\r\n            //        This step can be combined with c\r\n            // c. If kPresent is true, then\r\n            if (k in O) {\r\n                // i. Let kValue be the result of calling the Get internal\r\n                // method of O with argument Pk.\r\n                kValue = O[k];\r\n                // ii. Call the Call internal method of callback with T as\r\n                // the this value and argument list containing kValue, k, and O.\r\n                callback.call(T, kValue, k, O);\r\n            }\r\n            // d. Increase k by 1.\r\n            k++;\r\n        }\r\n        // 8. return undefined\r\n    };\r\n}\r\n\r\n// This code was written by Tyler Akins and has been placed in the\r\n// public domain.  It would be nice if you left this header intact.\r\n// Base64 code from Tyler Akins -- http://rumkin.com\r\nvar keyStr = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\r\nif (!root.btoa) {\r\n    root.btoa = function (input) {\r\n        /**\r\n         * Encodes a string in base64\r\n         * @param {String} input The string to encode in base64.\r\n         */\r\n        var output = \"\";\r\n        var chr1, chr2, chr3;\r\n        var enc1, enc2, enc3, enc4;\r\n        var i = 0;\r\n        do {\r\n            chr1 = input.charCodeAt(i++);\r\n            chr2 = input.charCodeAt(i++);\r\n            chr3 = input.charCodeAt(i++);\r\n\r\n            enc1 = chr1 >> 2;\r\n            enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);\r\n            enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);\r\n            enc4 = chr3 & 63;\r\n\r\n            if (isNaN(chr2)) {\r\n                enc2 = ((chr1 & 3) << 4);\r\n                enc3 = enc4 = 64;\r\n            } else if (isNaN(chr3)) {\r\n                enc4 = 64;\r\n            }\r\n            output = output + keyStr.charAt(enc1) + keyStr.charAt(enc2) +\r\n                keyStr.charAt(enc3) + keyStr.charAt(enc4);\r\n        } while (i < input.length);\r\n        return output;\r\n    };\r\n}\r\n\r\nif (!root.atob) {\r\n    root.atob = function (input) {\r\n        /**\r\n         * Decodes a base64 string.\r\n         * @param {String} input The string to decode.\r\n         */\r\n        var output = \"\";\r\n        var chr1, chr2, chr3;\r\n        var enc1, enc2, enc3, enc4;\r\n        var i = 0;\r\n        // remove all characters that are not A-Z, a-z, 0-9, +, /, or =\r\n        input = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\");\r\n        do {\r\n            enc1 = keyStr.indexOf(input.charAt(i++));\r\n            enc2 = keyStr.indexOf(input.charAt(i++));\r\n            enc3 = keyStr.indexOf(input.charAt(i++));\r\n            enc4 = keyStr.indexOf(input.charAt(i++));\r\n\r\n            chr1 = (enc1 << 2) | (enc2 >> 4);\r\n            chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);\r\n            chr3 = ((enc3 & 3) << 6) | enc4;\r\n\r\n            output = output + String.fromCharCode(chr1);\r\n\r\n            if (enc3 !== 64) {\r\n                output = output + String.fromCharCode(chr2);\r\n            }\r\n            if (enc4 !== 64) {\r\n                output = output + String.fromCharCode(chr3);\r\n            }\r\n        } while (i < input.length);\r\n        return output;\r\n    };\r\n}\r\n}));\r\n\r\n/*\r\n * A JavaScript implementation of the Secure Hash Algorithm, SHA-1, as defined\r\n * in FIPS PUB 180-1\r\n * Version 2.1a Copyright Paul Johnston 2000 - 2002.\r\n * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet\r\n * Distributed under the BSD License\r\n * See http://pajhome.org.uk/crypt/md5 for details.\r\n */\r\n\r\n/* jshint undef: true, unused: true:, noarg: true, latedef: false */\r\n/* global define */\r\n\r\n/* Some functions and variables have been stripped for use with Strophe */\r\n\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('strophe-sha1', [],function () {\r\n            return factory();\r\n        });\r\n    } else if (typeof exports === 'object') {\r\n        module.exports = factory();\r\n    } else {\r\n        // Browser globals\r\n        root.SHA1 = factory();\r\n    }\r\n}(this, function () {\r\n\r\n/*\r\n * Calculate the SHA-1 of an array of big-endian words, and a bit length\r\n */\r\nfunction core_sha1(x, len)\r\n{\r\n  /* append padding */\r\n  x[len >> 5] |= 0x80 << (24 - len % 32);\r\n  x[((len + 64 >> 9) << 4) + 15] = len;\r\n\r\n  var w = new Array(80);\r\n  var a =  1732584193;\r\n  var b = -271733879;\r\n  var c = -1732584194;\r\n  var d =  271733878;\r\n  var e = -1009589776;\r\n\r\n  var i, j, t, olda, oldb, oldc, oldd, olde;\r\n  for (i = 0; i < x.length; i += 16)\r\n  {\r\n    olda = a;\r\n    oldb = b;\r\n    oldc = c;\r\n    oldd = d;\r\n    olde = e;\r\n\r\n    for (j = 0; j < 80; j++)\r\n    {\r\n      if (j < 16) { w[j] = x[i + j]; }\r\n      else { w[j] = rol(w[j-3] ^ w[j-8] ^ w[j-14] ^ w[j-16], 1); }\r\n      t = safe_add(safe_add(rol(a, 5), sha1_ft(j, b, c, d)),\r\n                       safe_add(safe_add(e, w[j]), sha1_kt(j)));\r\n      e = d;\r\n      d = c;\r\n      c = rol(b, 30);\r\n      b = a;\r\n      a = t;\r\n    }\r\n\r\n    a = safe_add(a, olda);\r\n    b = safe_add(b, oldb);\r\n    c = safe_add(c, oldc);\r\n    d = safe_add(d, oldd);\r\n    e = safe_add(e, olde);\r\n  }\r\n  return [a, b, c, d, e];\r\n}\r\n\r\n/*\r\n * Perform the appropriate triplet combination function for the current\r\n * iteration\r\n */\r\nfunction sha1_ft(t, b, c, d)\r\n{\r\n  if (t < 20) { return (b & c) | ((~b) & d); }\r\n  if (t < 40) { return b ^ c ^ d; }\r\n  if (t < 60) { return (b & c) | (b & d) | (c & d); }\r\n  return b ^ c ^ d;\r\n}\r\n\r\n/*\r\n * Determine the appropriate additive constant for the current iteration\r\n */\r\nfunction sha1_kt(t)\r\n{\r\n  return (t < 20) ?  1518500249 : (t < 40) ?  1859775393 :\r\n         (t < 60) ? -1894007588 : -899497514;\r\n}\r\n\r\n/*\r\n * Calculate the HMAC-SHA1 of a key and some data\r\n */\r\nfunction core_hmac_sha1(key, data)\r\n{\r\n  var bkey = str2binb(key);\r\n  if (bkey.length > 16) { bkey = core_sha1(bkey, key.length * 8); }\r\n\r\n  var ipad = new Array(16), opad = new Array(16);\r\n  for (var i = 0; i < 16; i++)\r\n  {\r\n    ipad[i] = bkey[i] ^ 0x36363636;\r\n    opad[i] = bkey[i] ^ 0x5C5C5C5C;\r\n  }\r\n\r\n  var hash = core_sha1(ipad.concat(str2binb(data)), 512 + data.length * 8);\r\n  return core_sha1(opad.concat(hash), 512 + 160);\r\n}\r\n\r\n/*\r\n * Add integers, wrapping at 2^32. This uses 16-bit operations internally\r\n * to work around bugs in some JS interpreters.\r\n */\r\nfunction safe_add(x, y)\r\n{\r\n  var lsw = (x & 0xFFFF) + (y & 0xFFFF);\r\n  var msw = (x >> 16) + (y >> 16) + (lsw >> 16);\r\n  return (msw << 16) | (lsw & 0xFFFF);\r\n}\r\n\r\n/*\r\n * Bitwise rotate a 32-bit number to the left.\r\n */\r\nfunction rol(num, cnt)\r\n{\r\n  return (num << cnt) | (num >>> (32 - cnt));\r\n}\r\n\r\n/*\r\n * Convert an 8-bit or 16-bit string to an array of big-endian words\r\n * In 8-bit function, characters >255 have their hi-byte silently ignored.\r\n */\r\nfunction str2binb(str)\r\n{\r\n  var bin = [];\r\n  var mask = 255;\r\n  for (var i = 0; i < str.length * 8; i += 8)\r\n  {\r\n    bin[i>>5] |= (str.charCodeAt(i / 8) & mask) << (24 - i%32);\r\n  }\r\n  return bin;\r\n}\r\n\r\n/*\r\n * Convert an array of big-endian words to a string\r\n */\r\nfunction binb2str(bin)\r\n{\r\n  var str = \"\";\r\n  var mask = 255;\r\n  for (var i = 0; i < bin.length * 32; i += 8)\r\n  {\r\n    str += String.fromCharCode((bin[i>>5] >>> (24 - i%32)) & mask);\r\n  }\r\n  return str;\r\n}\r\n\r\n/*\r\n * Convert an array of big-endian words to a base-64 string\r\n */\r\nfunction binb2b64(binarray)\r\n{\r\n  var tab = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\r\n  var str = \"\";\r\n  var triplet, j;\r\n  for (var i = 0; i < binarray.length * 4; i += 3)\r\n  {\r\n    triplet = (((binarray[i   >> 2] >> 8 * (3 -  i   %4)) & 0xFF) << 16) |\r\n              (((binarray[i+1 >> 2] >> 8 * (3 - (i+1)%4)) & 0xFF) << 8 ) |\r\n               ((binarray[i+2 >> 2] >> 8 * (3 - (i+2)%4)) & 0xFF);\r\n    for (j = 0; j < 4; j++)\r\n    {\r\n      if (i * 8 + j * 6 > binarray.length * 32) { str += \"=\"; }\r\n      else { str += tab.charAt((triplet >> 6*(3-j)) & 0x3F); }\r\n    }\r\n  }\r\n  return str;\r\n}\r\n\r\n/*\r\n * These are the functions you'll usually want to call\r\n * They take string arguments and return either hex or base-64 encoded strings\r\n */\r\nreturn {\r\n    b64_hmac_sha1:  function (key, data){ return binb2b64(core_hmac_sha1(key, data)); },\r\n    b64_sha1:       function (s) { return binb2b64(core_sha1(str2binb(s),s.length * 8)); },\r\n    binb2str:       binb2str,\r\n    core_hmac_sha1: core_hmac_sha1,\r\n    str_hmac_sha1:  function (key, data){ return binb2str(core_hmac_sha1(key, data)); },\r\n    str_sha1:       function (s) { return binb2str(core_sha1(str2binb(s),s.length * 8)); },\r\n};\r\n}));\r\n\r\n/*\r\n * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message\r\n * Digest Algorithm, as defined in RFC 1321.\r\n * Version 2.1 Copyright (C) Paul Johnston 1999 - 2002.\r\n * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet\r\n * Distributed under the BSD License\r\n * See http://pajhome.org.uk/crypt/md5 for more info.\r\n */\r\n/*\r\n * Everything that isn't used by Strophe has been stripped here!\r\n */\r\n\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('strophe-md5',[], function () {\r\n            return factory();\r\n        });\r\n    } else if (typeof exports === 'object') {\r\n        module.exports = factory();\r\n    } else {\r\n        // Browser globals\r\n        root.MD5 = factory();\r\n    }\r\n}(this, function () {\r\n    /*\r\n     * Add integers, wrapping at 2^32. This uses 16-bit operations internally\r\n     * to work around bugs in some JS interpreters.\r\n     */\r\n    var safe_add = function (x, y) {\r\n        var lsw = (x & 0xFFFF) + (y & 0xFFFF);\r\n        var msw = (x >> 16) + (y >> 16) + (lsw >> 16);\r\n        return (msw << 16) | (lsw & 0xFFFF);\r\n    };\r\n\r\n    /*\r\n     * Bitwise rotate a 32-bit number to the left.\r\n     */\r\n    var bit_rol = function (num, cnt) {\r\n        return (num << cnt) | (num >>> (32 - cnt));\r\n    };\r\n\r\n    /*\r\n     * Convert a string to an array of little-endian words\r\n     */\r\n    var str2binl = function (str) {\r\n        var bin = [];\r\n        for(var i = 0; i < str.length * 8; i += 8)\r\n        {\r\n            bin[i>>5] |= (str.charCodeAt(i / 8) & 255) << (i%32);\r\n        }\r\n        return bin;\r\n    };\r\n\r\n    /*\r\n     * Convert an array of little-endian words to a string\r\n     */\r\n    var binl2str = function (bin) {\r\n        var str = \"\";\r\n        for(var i = 0; i < bin.length * 32; i += 8)\r\n        {\r\n            str += String.fromCharCode((bin[i>>5] >>> (i % 32)) & 255);\r\n        }\r\n        return str;\r\n    };\r\n\r\n    /*\r\n     * Convert an array of little-endian words to a hex string.\r\n     */\r\n    var binl2hex = function (binarray) {\r\n        var hex_tab = \"0123456789abcdef\";\r\n        var str = \"\";\r\n        for(var i = 0; i < binarray.length * 4; i++)\r\n        {\r\n            str += hex_tab.charAt((binarray[i>>2] >> ((i%4)*8+4)) & 0xF) +\r\n                hex_tab.charAt((binarray[i>>2] >> ((i%4)*8  )) & 0xF);\r\n        }\r\n        return str;\r\n    };\r\n\r\n    /*\r\n     * These functions implement the four basic operations the algorithm uses.\r\n     */\r\n    var md5_cmn = function (q, a, b, x, s, t) {\r\n        return safe_add(bit_rol(safe_add(safe_add(a, q),safe_add(x, t)), s),b);\r\n    };\r\n\r\n    var md5_ff = function (a, b, c, d, x, s, t) {\r\n        return md5_cmn((b & c) | ((~b) & d), a, b, x, s, t);\r\n    };\r\n\r\n    var md5_gg = function (a, b, c, d, x, s, t) {\r\n        return md5_cmn((b & d) | (c & (~d)), a, b, x, s, t);\r\n    };\r\n\r\n    var md5_hh = function (a, b, c, d, x, s, t) {\r\n        return md5_cmn(b ^ c ^ d, a, b, x, s, t);\r\n    };\r\n\r\n    var md5_ii = function (a, b, c, d, x, s, t) {\r\n        return md5_cmn(c ^ (b | (~d)), a, b, x, s, t);\r\n    };\r\n\r\n    /*\r\n     * Calculate the MD5 of an array of little-endian words, and a bit length\r\n     */\r\n    var core_md5 = function (x, len) {\r\n        /* append padding */\r\n        x[len >> 5] |= 0x80 << ((len) % 32);\r\n        x[(((len + 64) >>> 9) << 4) + 14] = len;\r\n\r\n        var a =  1732584193;\r\n        var b = -271733879;\r\n        var c = -1732584194;\r\n        var d =  271733878;\r\n\r\n        var olda, oldb, oldc, oldd;\r\n        for (var i = 0; i < x.length; i += 16)\r\n        {\r\n            olda = a;\r\n            oldb = b;\r\n            oldc = c;\r\n            oldd = d;\r\n\r\n            a = md5_ff(a, b, c, d, x[i+ 0], 7 , -680876936);\r\n            d = md5_ff(d, a, b, c, x[i+ 1], 12, -389564586);\r\n            c = md5_ff(c, d, a, b, x[i+ 2], 17,  606105819);\r\n            b = md5_ff(b, c, d, a, x[i+ 3], 22, -1044525330);\r\n            a = md5_ff(a, b, c, d, x[i+ 4], 7 , -176418897);\r\n            d = md5_ff(d, a, b, c, x[i+ 5], 12,  1200080426);\r\n            c = md5_ff(c, d, a, b, x[i+ 6], 17, -1473231341);\r\n            b = md5_ff(b, c, d, a, x[i+ 7], 22, -45705983);\r\n            a = md5_ff(a, b, c, d, x[i+ 8], 7 ,  1770035416);\r\n            d = md5_ff(d, a, b, c, x[i+ 9], 12, -1958414417);\r\n            c = md5_ff(c, d, a, b, x[i+10], 17, -42063);\r\n            b = md5_ff(b, c, d, a, x[i+11], 22, -1990404162);\r\n            a = md5_ff(a, b, c, d, x[i+12], 7 ,  1804603682);\r\n            d = md5_ff(d, a, b, c, x[i+13], 12, -40341101);\r\n            c = md5_ff(c, d, a, b, x[i+14], 17, -1502002290);\r\n            b = md5_ff(b, c, d, a, x[i+15], 22,  1236535329);\r\n\r\n            a = md5_gg(a, b, c, d, x[i+ 1], 5 , -165796510);\r\n            d = md5_gg(d, a, b, c, x[i+ 6], 9 , -1069501632);\r\n            c = md5_gg(c, d, a, b, x[i+11], 14,  643717713);\r\n            b = md5_gg(b, c, d, a, x[i+ 0], 20, -373897302);\r\n            a = md5_gg(a, b, c, d, x[i+ 5], 5 , -701558691);\r\n            d = md5_gg(d, a, b, c, x[i+10], 9 ,  38016083);\r\n            c = md5_gg(c, d, a, b, x[i+15], 14, -660478335);\r\n            b = md5_gg(b, c, d, a, x[i+ 4], 20, -405537848);\r\n            a = md5_gg(a, b, c, d, x[i+ 9], 5 ,  568446438);\r\n            d = md5_gg(d, a, b, c, x[i+14], 9 , -1019803690);\r\n            c = md5_gg(c, d, a, b, x[i+ 3], 14, -187363961);\r\n            b = md5_gg(b, c, d, a, x[i+ 8], 20,  1163531501);\r\n            a = md5_gg(a, b, c, d, x[i+13], 5 , -1444681467);\r\n            d = md5_gg(d, a, b, c, x[i+ 2], 9 , -51403784);\r\n            c = md5_gg(c, d, a, b, x[i+ 7], 14,  1735328473);\r\n            b = md5_gg(b, c, d, a, x[i+12], 20, -1926607734);\r\n\r\n            a = md5_hh(a, b, c, d, x[i+ 5], 4 , -378558);\r\n            d = md5_hh(d, a, b, c, x[i+ 8], 11, -2022574463);\r\n            c = md5_hh(c, d, a, b, x[i+11], 16,  1839030562);\r\n            b = md5_hh(b, c, d, a, x[i+14], 23, -35309556);\r\n            a = md5_hh(a, b, c, d, x[i+ 1], 4 , -1530992060);\r\n            d = md5_hh(d, a, b, c, x[i+ 4], 11,  1272893353);\r\n            c = md5_hh(c, d, a, b, x[i+ 7], 16, -155497632);\r\n            b = md5_hh(b, c, d, a, x[i+10], 23, -1094730640);\r\n            a = md5_hh(a, b, c, d, x[i+13], 4 ,  681279174);\r\n            d = md5_hh(d, a, b, c, x[i+ 0], 11, -358537222);\r\n            c = md5_hh(c, d, a, b, x[i+ 3], 16, -722521979);\r\n            b = md5_hh(b, c, d, a, x[i+ 6], 23,  76029189);\r\n            a = md5_hh(a, b, c, d, x[i+ 9], 4 , -640364487);\r\n            d = md5_hh(d, a, b, c, x[i+12], 11, -421815835);\r\n            c = md5_hh(c, d, a, b, x[i+15], 16,  530742520);\r\n            b = md5_hh(b, c, d, a, x[i+ 2], 23, -995338651);\r\n\r\n            a = md5_ii(a, b, c, d, x[i+ 0], 6 , -198630844);\r\n            d = md5_ii(d, a, b, c, x[i+ 7], 10,  1126891415);\r\n            c = md5_ii(c, d, a, b, x[i+14], 15, -1416354905);\r\n            b = md5_ii(b, c, d, a, x[i+ 5], 21, -57434055);\r\n            a = md5_ii(a, b, c, d, x[i+12], 6 ,  1700485571);\r\n            d = md5_ii(d, a, b, c, x[i+ 3], 10, -1894986606);\r\n            c = md5_ii(c, d, a, b, x[i+10], 15, -1051523);\r\n            b = md5_ii(b, c, d, a, x[i+ 1], 21, -2054922799);\r\n            a = md5_ii(a, b, c, d, x[i+ 8], 6 ,  1873313359);\r\n            d = md5_ii(d, a, b, c, x[i+15], 10, -30611744);\r\n            c = md5_ii(c, d, a, b, x[i+ 6], 15, -1560198380);\r\n            b = md5_ii(b, c, d, a, x[i+13], 21,  1309151649);\r\n            a = md5_ii(a, b, c, d, x[i+ 4], 6 , -145523070);\r\n            d = md5_ii(d, a, b, c, x[i+11], 10, -1120210379);\r\n            c = md5_ii(c, d, a, b, x[i+ 2], 15,  718787259);\r\n            b = md5_ii(b, c, d, a, x[i+ 9], 21, -343485551);\r\n\r\n            a = safe_add(a, olda);\r\n            b = safe_add(b, oldb);\r\n            c = safe_add(c, oldc);\r\n            d = safe_add(d, oldd);\r\n        }\r\n        return [a, b, c, d];\r\n    };\r\n\r\n    var obj = {\r\n        /*\r\n         * These are the functions you'll usually want to call.\r\n         * They take string arguments and return either hex or base-64 encoded\r\n         * strings.\r\n         */\r\n        hexdigest: function (s) {\r\n            return binl2hex(core_md5(str2binl(s), s.length * 8));\r\n        },\r\n\r\n        hash: function (s) {\r\n            return binl2str(core_md5(str2binl(s), s.length * 8));\r\n        }\r\n    };\r\n    return obj;\r\n}));\r\n\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('strophe-utils',[], function () {\r\n            return factory();\r\n        });\r\n    } else if (typeof exports === 'object') {\r\n        module.exports = factory();\r\n    } else {\r\n        // Browser globals\r\n        root.stropheUtils = factory();\r\n    }\r\n}(this, function () {\r\n\r\n    var utils = {\r\n\r\n        utf16to8: function (str) {\r\n            var i, c;\r\n            var out = \"\";\r\n            var len = str.length;\r\n            for (i = 0; i < len; i++) {\r\n                c = str.charCodeAt(i);\r\n                if ((c >= 0x0000) && (c <= 0x007F)) {\r\n                    out += str.charAt(i);\r\n                } else if (c > 0x07FF) {\r\n                    out += String.fromCharCode(0xE0 | ((c >> 12) & 0x0F));\r\n                    out += String.fromCharCode(0x80 | ((c >>  6) & 0x3F));\r\n                    out += String.fromCharCode(0x80 | ((c >>  0) & 0x3F));\r\n                } else {\r\n                    out += String.fromCharCode(0xC0 | ((c >>  6) & 0x1F));\r\n                    out += String.fromCharCode(0x80 | ((c >>  0) & 0x3F));\r\n                }\r\n            }\r\n            return out;\r\n        },\r\n\r\n        addCookies: function (cookies) {\r\n            /* Parameters:\r\n             *  (Object) cookies - either a map of cookie names\r\n             *    to string values or to maps of cookie values.\r\n             *\r\n             * For example:\r\n             * { \"myCookie\": \"1234\" }\r\n             *\r\n             * or:\r\n             * { \"myCookie\": {\r\n             *      \"value\": \"1234\",\r\n             *      \"domain\": \".example.org\",\r\n             *      \"path\": \"/\",\r\n             *      \"expires\": expirationDate\r\n             *      }\r\n             *  }\r\n             *\r\n             *  These values get passed to Strophe.Connection via\r\n             *   options.cookies\r\n             */\r\n            var cookieName, cookieObj, isObj, cookieValue, expires, domain, path;\r\n            for (cookieName in (cookies || {})) {\r\n                expires = '';\r\n                domain = '';\r\n                path = '';\r\n                cookieObj = cookies[cookieName];\r\n                isObj = typeof cookieObj === \"object\";\r\n                cookieValue = escape(unescape(isObj ? cookieObj.value : cookieObj));\r\n                if (isObj) {\r\n                    expires = cookieObj.expires ? \";expires=\"+cookieObj.expires : '';\r\n                    domain = cookieObj.domain ? \";domain=\"+cookieObj.domain : '';\r\n                    path = cookieObj.path ? \";path=\"+cookieObj.path : '';\r\n                }\r\n                document.cookie =\r\n                    cookieName+'='+cookieValue + expires + domain + path;\r\n            }\r\n        }\r\n    };\r\n    return utils;\r\n}));\r\n\r\n/*\r\n    This program is distributed under the terms of the MIT license.\r\n    Please see the LICENSE file for details.\r\n\r\n    Copyright 2006-2008, OGG, LLC\r\n*/\r\n\r\n/* jshint undef: true, unused: true:, noarg: true, latedef: true */\r\n/*global define, document, sessionStorage, setTimeout, clearTimeout, ActiveXObject, DOMParser, btoa, atob */\r\n\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('strophe-core',[\r\n            'strophe-sha1',\r\n            'strophe-md5',\r\n            'strophe-utils'\r\n        ], function () {\r\n            return factory.apply(this, arguments);\r\n        });\r\n    }  else if (typeof exports === 'object') {\r\n        module.exports = factory(\r\n            require('./sha1'),\r\n            require('./md5'),\r\n            require('./utils')\r\n        );\r\n    } else {\r\n        // Browser globals\r\n        var o = factory(root.SHA1, root.MD5, root.stropheUtils);\r\n        root.Strophe =        o.Strophe;\r\n        root.$build =         o.$build;\r\n        root.$iq =            o.$iq;\r\n        root.$msg =           o.$msg;\r\n        root.$pres =          o.$pres;\r\n        root.SHA1 =           o.SHA1;\r\n        root.MD5 =            o.MD5;\r\n        root.b64_hmac_sha1 =  o.SHA1.b64_hmac_sha1;\r\n        root.b64_sha1 =       o.SHA1.b64_sha1;\r\n        root.str_hmac_sha1 =  o.SHA1.str_hmac_sha1;\r\n        root.str_sha1 =       o.SHA1.str_sha1;\r\n    }\r\n}(this, function (SHA1, MD5, utils) {\r\n\r\nvar Strophe;\r\n\r\n/** Function: $build\r\n *  Create a Strophe.Builder.\r\n *  This is an alias for 'new Strophe.Builder(name, attrs)'.\r\n *\r\n *  Parameters:\r\n *    (String) name - The root element name.\r\n *    (Object) attrs - The attributes for the root element in object notation.\r\n *\r\n *  Returns:\r\n *    A new Strophe.Builder object.\r\n */\r\nfunction $build(name, attrs) { return new Strophe.Builder(name, attrs); }\r\n\r\n/** Function: $msg\r\n *  Create a Strophe.Builder with a <message/> element as the root.\r\n *\r\n *  Parameters:\r\n *    (Object) attrs - The <message/> element attributes in object notation.\r\n *\r\n *  Returns:\r\n *    A new Strophe.Builder object.\r\n */\r\nfunction $msg(attrs) { return new Strophe.Builder(\"message\", attrs); }\r\n\r\n/** Function: $iq\r\n *  Create a Strophe.Builder with an <iq/> element as the root.\r\n *\r\n *  Parameters:\r\n *    (Object) attrs - The <iq/> element attributes in object notation.\r\n *\r\n *  Returns:\r\n *    A new Strophe.Builder object.\r\n */\r\nfunction $iq(attrs) { return new Strophe.Builder(\"iq\", attrs); }\r\n\r\n/** Function: $pres\r\n *  Create a Strophe.Builder with a <presence/> element as the root.\r\n *\r\n *  Parameters:\r\n *    (Object) attrs - The <presence/> element attributes in object notation.\r\n *\r\n *  Returns:\r\n *    A new Strophe.Builder object.\r\n */\r\nfunction $pres(attrs) { return new Strophe.Builder(\"presence\", attrs); }\r\n\r\n/** Class: Strophe\r\n *  An object container for all Strophe library functions.\r\n *\r\n *  This class is just a container for all the objects and constants\r\n *  used in the library.  It is not meant to be instantiated, but to\r\n *  provide a namespace for library objects, constants, and functions.\r\n */\r\nStrophe = {\r\n    /** Constant: VERSION */\r\n    VERSION: \"1.2.14-1\",\r\n\r\n    /** Constants: XMPP Namespace Constants\r\n     *  Common namespace constants from the XMPP RFCs and XEPs.\r\n     *\r\n     *  NS.HTTPBIND - HTTP BIND namespace from XEP 124.\r\n     *  NS.BOSH - BOSH namespace from XEP 206.\r\n     *  NS.CLIENT - Main XMPP client namespace.\r\n     *  NS.AUTH - Legacy authentication namespace.\r\n     *  NS.ROSTER - Roster operations namespace.\r\n     *  NS.PROFILE - Profile namespace.\r\n     *  NS.DISCO_INFO - Service discovery info namespace from XEP 30.\r\n     *  NS.DISCO_ITEMS - Service discovery items namespace from XEP 30.\r\n     *  NS.MUC - Multi-User Chat namespace from XEP 45.\r\n     *  NS.SASL - XMPP SASL namespace from RFC 3920.\r\n     *  NS.STREAM - XMPP Streams namespace from RFC 3920.\r\n     *  NS.BIND - XMPP Binding namespace from RFC 3920.\r\n     *  NS.SESSION - XMPP Session namespace from RFC 3920.\r\n     *  NS.XHTML_IM - XHTML-IM namespace from XEP 71.\r\n     *  NS.XHTML - XHTML body namespace from XEP 71.\r\n     */\r\n    NS: {\r\n        HTTPBIND: \"http://jabber.org/protocol/httpbind\",\r\n        BOSH: \"urn:xmpp:xbosh\",\r\n        CLIENT: \"jabber:client\",\r\n        AUTH: \"jabber:iq:auth\",\r\n        ROSTER: \"jabber:iq:roster\",\r\n        PROFILE: \"jabber:iq:profile\",\r\n        DISCO_INFO: \"http://jabber.org/protocol/disco#info\",\r\n        DISCO_ITEMS: \"http://jabber.org/protocol/disco#items\",\r\n        MUC: \"http://jabber.org/protocol/muc\",\r\n        SASL: \"urn:ietf:params:xml:ns:xmpp-sasl\",\r\n        STREAM: \"http://etherx.jabber.org/streams\",\r\n        FRAMING: \"urn:ietf:params:xml:ns:xmpp-framing\",\r\n        BIND: \"urn:ietf:params:xml:ns:xmpp-bind\",\r\n        SESSION: \"urn:ietf:params:xml:ns:xmpp-session\",\r\n        VERSION: \"jabber:iq:version\",\r\n        STANZAS: \"urn:ietf:params:xml:ns:xmpp-stanzas\",\r\n        XHTML_IM: \"http://jabber.org/protocol/xhtml-im\",\r\n        XHTML: \"http://www.w3.org/1999/xhtml\"\r\n    },\r\n\r\n    /** Constants: XHTML_IM Namespace\r\n     *  contains allowed tags, tag attributes, and css properties.\r\n     *  Used in the createHtml function to filter incoming html into the allowed XHTML-IM subset.\r\n     *  See http://xmpp.org/extensions/xep-0071.html#profile-summary for the list of recommended\r\n     *  allowed tags and their attributes.\r\n     */\r\n    XHTML: {\r\n        tags: ['a','blockquote','br','cite','em','img','li','ol','p','span','strong','ul','body'],\r\n        attributes: {\r\n            'a':          ['href'],\r\n            'blockquote': ['style'],\r\n            'br':         [],\r\n            'cite':       ['style'],\r\n            'em':         [],\r\n            'img':        ['src', 'alt', 'style', 'height', 'width'],\r\n            'li':         ['style'],\r\n            'ol':         ['style'],\r\n            'p':          ['style'],\r\n            'span':       ['style'],\r\n            'strong':     [],\r\n            'ul':         ['style'],\r\n            'body':       []\r\n        },\r\n        css: ['background-color','color','font-family','font-size','font-style','font-weight','margin-left','margin-right','text-align','text-decoration'],\r\n        /** Function: XHTML.validTag\r\n         *\r\n         * Utility method to determine whether a tag is allowed\r\n         * in the XHTML_IM namespace.\r\n         *\r\n         * XHTML tag names are case sensitive and must be lower case.\r\n         */\r\n        validTag: function(tag) {\r\n            for (var i = 0; i < Strophe.XHTML.tags.length; i++) {\r\n                if (tag === Strophe.XHTML.tags[i]) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        },\r\n        /** Function: XHTML.validAttribute\r\n         *\r\n         * Utility method to determine whether an attribute is allowed\r\n         * as recommended per XEP-0071\r\n         *\r\n         * XHTML attribute names are case sensitive and must be lower case.\r\n         */\r\n        validAttribute: function(tag, attribute) {\r\n            if (typeof Strophe.XHTML.attributes[tag] !== 'undefined' && Strophe.XHTML.attributes[tag].length > 0) {\r\n                for (var i = 0; i < Strophe.XHTML.attributes[tag].length; i++) {\r\n                    if (attribute === Strophe.XHTML.attributes[tag][i]) {\r\n                        return true;\r\n                    }\r\n                }\r\n            }\r\n        return false;\r\n        },\r\n        validCSS: function(style) {\r\n            for (var i = 0; i < Strophe.XHTML.css.length; i++) {\r\n                if (style === Strophe.XHTML.css[i]) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        }\r\n    },\r\n\r\n    /** Constants: Connection Status Constants\r\n     *  Connection status constants for use by the connection handler\r\n     *  callback.\r\n     *\r\n     *  Status.ERROR - An error has occurred\r\n     *  Status.CONNECTING - The connection is currently being made\r\n     *  Status.CONNFAIL - The connection attempt failed\r\n     *  Status.AUTHENTICATING - The connection is authenticating\r\n     *  Status.AUTHFAIL - The authentication attempt failed\r\n     *  Status.CONNECTED - The connection has succeeded\r\n     *  Status.DISCONNECTED - The connection has been terminated\r\n     *  Status.DISCONNECTING - The connection is currently being terminated\r\n     *  Status.ATTACHED - The connection has been attached\r\n     *  Status.REDIRECT - The connection has been redirected\r\n     *  Status.CONNTIMEOUT - The connection has timed out\r\n     */\r\n    Status: {\r\n        ERROR: 0,\r\n        CONNECTING: 1,\r\n        CONNFAIL: 2,\r\n        AUTHENTICATING: 3,\r\n        AUTHFAIL: 4,\r\n        CONNECTED: 5,\r\n        DISCONNECTED: 6,\r\n        DISCONNECTING: 7,\r\n        ATTACHED: 8,\r\n        REDIRECT: 9,\r\n        CONNTIMEOUT: 10\r\n    },\r\n\r\n    ErrorCondition: {\r\n        BAD_FORMAT: \"bad-format\",\r\n        CONFLICT: \"conflict\",\r\n        MISSING_JID_NODE: \"x-strophe-bad-non-anon-jid\",\r\n        NO_AUTH_MECH: \"no-auth-mech\",\r\n        UNKNOWN_REASON: \"unknown\",\r\n    },\r\n\r\n    /** Constants: Log Level Constants\r\n     *  Logging level indicators.\r\n     *\r\n     *  LogLevel.DEBUG - Debug output\r\n     *  LogLevel.INFO - Informational output\r\n     *  LogLevel.WARN - Warnings\r\n     *  LogLevel.ERROR - Errors\r\n     *  LogLevel.FATAL - Fatal errors\r\n     */\r\n    LogLevel: {\r\n        DEBUG: 0,\r\n        INFO: 1,\r\n        WARN: 2,\r\n        ERROR: 3,\r\n        FATAL: 4\r\n    },\r\n\r\n    /** PrivateConstants: DOM Element Type Constants\r\n     *  DOM element types.\r\n     *\r\n     *  ElementType.NORMAL - Normal element.\r\n     *  ElementType.TEXT - Text data element.\r\n     *  ElementType.FRAGMENT - XHTML fragment element.\r\n     */\r\n    ElementType: {\r\n        NORMAL: 1,\r\n        TEXT: 3,\r\n        CDATA: 4,\r\n        FRAGMENT: 11\r\n    },\r\n\r\n    /** PrivateConstants: Timeout Values\r\n     *  Timeout values for error states.  These values are in seconds.\r\n     *  These should not be changed unless you know exactly what you are\r\n     *  doing.\r\n     *\r\n     *  TIMEOUT - Timeout multiplier. A waiting request will be considered\r\n     *      failed after Math.floor(TIMEOUT * wait) seconds have elapsed.\r\n     *      This defaults to 1.1, and with default wait, 66 seconds.\r\n     *  SECONDARY_TIMEOUT - Secondary timeout multiplier. In cases where\r\n     *      Strophe can detect early failure, it will consider the request\r\n     *      failed if it doesn't return after\r\n     *      Math.floor(SECONDARY_TIMEOUT * wait) seconds have elapsed.\r\n     *      This defaults to 0.1, and with default wait, 6 seconds.\r\n     */\r\n    TIMEOUT: 1.1,\r\n    SECONDARY_TIMEOUT: 0.1,\r\n\r\n    /** Function: addNamespace\r\n     *  This function is used to extend the current namespaces in\r\n     *  Strophe.NS.  It takes a key and a value with the key being the\r\n     *  name of the new namespace, with its actual value.\r\n     *  For example:\r\n     *  Strophe.addNamespace('PUBSUB', \"http://jabber.org/protocol/pubsub\");\r\n     *\r\n     *  Parameters:\r\n     *    (String) name - The name under which the namespace will be\r\n     *      referenced under Strophe.NS\r\n     *    (String) value - The actual namespace.\r\n     */\r\n    addNamespace: function (name, value) {\r\n        Strophe.NS[name] = value;\r\n    },\r\n\r\n    /** Function: forEachChild\r\n     *  Map a function over some or all child elements of a given element.\r\n     *\r\n     *  This is a small convenience function for mapping a function over\r\n     *  some or all of the children of an element.  If elemName is null, all\r\n     *  children will be passed to the function, otherwise only children\r\n     *  whose tag names match elemName will be passed.\r\n     *\r\n     *  Parameters:\r\n     *    (XMLElement) elem - The element to operate on.\r\n     *    (String) elemName - The child element tag name filter.\r\n     *    (Function) func - The function to apply to each child.  This\r\n     *      function should take a single argument, a DOM element.\r\n     */\r\n    forEachChild: function (elem, elemName, func) {\r\n        var i, childNode;\r\n        for (i = 0; i < elem.childNodes.length; i++) {\r\n            childNode = elem.childNodes[i];\r\n            if (childNode.nodeType === Strophe.ElementType.NORMAL &&\r\n                (!elemName || this.isTagEqual(childNode, elemName))) {\r\n                func(childNode);\r\n            }\r\n        }\r\n    },\r\n\r\n    /** Function: isTagEqual\r\n     *  Compare an element's tag name with a string.\r\n     *\r\n     *  This function is case sensitive.\r\n     *\r\n     *  Parameters:\r\n     *    (XMLElement) el - A DOM element.\r\n     *    (String) name - The element name.\r\n     *\r\n     *  Returns:\r\n     *    true if the element's tag name matches _el_, and false\r\n     *    otherwise.\r\n     */\r\n    isTagEqual: function (el, name) {\r\n        return el.tagName === name;\r\n    },\r\n\r\n    /** PrivateVariable: _xmlGenerator\r\n     *  _Private_ variable that caches a DOM document to\r\n     *  generate elements.\r\n     */\r\n    _xmlGenerator: null,\r\n\r\n    /** PrivateFunction: _makeGenerator\r\n     *  _Private_ function that creates a dummy XML DOM document to serve as\r\n     *  an element and text node generator.\r\n     */\r\n    _makeGenerator: function () {\r\n        var doc;\r\n        // IE9 does implement createDocument(); however, using it will cause the browser to leak memory on page unload.\r\n        // Here, we test for presence of createDocument() plus IE's proprietary documentMode attribute, which would be\r\n                // less than 10 in the case of IE9 and below.\r\n        if (document.implementation.createDocument === undefined ||\r\n                        document.implementation.createDocument && document.documentMode && document.documentMode < 10) {\r\n            doc = this._getIEXmlDom();\r\n            doc.appendChild(doc.createElement('strophe'));\r\n        } else {\r\n            doc = document.implementation\r\n                .createDocument('jabber:client', 'strophe', null);\r\n        }\r\n        return doc;\r\n    },\r\n\r\n    /** Function: xmlGenerator\r\n     *  Get the DOM document to generate elements.\r\n     *\r\n     *  Returns:\r\n     *    The currently used DOM document.\r\n     */\r\n    xmlGenerator: function () {\r\n        if (!Strophe._xmlGenerator) {\r\n            Strophe._xmlGenerator = Strophe._makeGenerator();\r\n        }\r\n        return Strophe._xmlGenerator;\r\n    },\r\n\r\n    /** PrivateFunction: _getIEXmlDom\r\n     *  Gets IE xml doc object\r\n     *\r\n     *  Returns:\r\n     *    A Microsoft XML DOM Object\r\n     *  See Also:\r\n     *    http://msdn.microsoft.com/en-us/library/ms757837%28VS.85%29.aspx\r\n     */\r\n    _getIEXmlDom : function() {\r\n        var doc = null;\r\n        var docStrings = [\r\n            \"Msxml2.DOMDocument.6.0\",\r\n            \"Msxml2.DOMDocument.5.0\",\r\n            \"Msxml2.DOMDocument.4.0\",\r\n            \"MSXML2.DOMDocument.3.0\",\r\n            \"MSXML2.DOMDocument\",\r\n            \"MSXML.DOMDocument\",\r\n            \"Microsoft.XMLDOM\"\r\n        ];\r\n\r\n        for (var d = 0; d < docStrings.length; d++) {\r\n            if (doc === null) {\r\n                try {\r\n                    doc = new ActiveXObject(docStrings[d]);\r\n                } catch (e) {\r\n                    doc = null;\r\n                }\r\n            } else {\r\n                break;\r\n            }\r\n        }\r\n        return doc;\r\n    },\r\n\r\n    /** Function: xmlElement\r\n     *  Create an XML DOM element.\r\n     *\r\n     *  This function creates an XML DOM element correctly across all\r\n     *  implementations. Note that these are not HTML DOM elements, which\r\n     *  aren't appropriate for XMPP stanzas.\r\n     *\r\n     *  Parameters:\r\n     *    (String) name - The name for the element.\r\n     *    (Array|Object) attrs - An optional array or object containing\r\n     *      key/value pairs to use as element attributes. The object should\r\n     *      be in the format {'key': 'value'} or {key: 'value'}. The array\r\n     *      should have the format [['key1', 'value1'], ['key2', 'value2']].\r\n     *    (String) text - The text child data for the element.\r\n     *\r\n     *  Returns:\r\n     *    A new XML DOM element.\r\n     */\r\n    xmlElement: function (name) {\r\n        if (!name) { return null; }\r\n\r\n        var node = Strophe.xmlGenerator().createElement(name);\r\n        // FIXME: this should throw errors if args are the wrong type or\r\n        // there are more than two optional args\r\n        var a, i, k;\r\n        for (a = 1; a < arguments.length; a++) {\r\n            var arg = arguments[a];\r\n            if (!arg) { continue; }\r\n            if (typeof(arg) === \"string\" ||\r\n                typeof(arg) === \"number\") {\r\n                node.appendChild(Strophe.xmlTextNode(arg));\r\n            } else if (typeof(arg) === \"object\" &&\r\n                       typeof(arg.sort) === \"function\") {\r\n                for (i = 0; i < arg.length; i++) {\r\n                    var attr = arg[i];\r\n                    if (typeof(attr) === \"object\" &&\r\n                        typeof(attr.sort) === \"function\" &&\r\n                        attr[1] !== undefined &&\r\n                        attr[1] !== null) {\r\n                        node.setAttribute(attr[0], attr[1]);\r\n                    }\r\n                }\r\n            } else if (typeof(arg) === \"object\") {\r\n                for (k in arg) {\r\n                    if (arg.hasOwnProperty(k)) {\r\n                        if (arg[k] !== undefined &&\r\n                            arg[k] !== null) {\r\n                            node.setAttribute(k, arg[k]);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return node;\r\n    },\r\n\r\n    /*  Function: xmlescape\r\n     *  Excapes invalid xml characters.\r\n     *\r\n     *  Parameters:\r\n     *     (String) text - text to escape.\r\n     *\r\n     *  Returns:\r\n     *      Escaped text.\r\n     */\r\n    xmlescape: function(text) {\r\n        text = text.replace(/\\&/g, \"&amp;\");\r\n        text = text.replace(/</g,  \"&lt;\");\r\n        text = text.replace(/>/g,  \"&gt;\");\r\n        text = text.replace(/'/g,  \"&apos;\");\r\n        text = text.replace(/\"/g,  \"&quot;\");\r\n        return text;\r\n    },\r\n\r\n    /*  Function: xmlunescape\r\n    *  Unexcapes invalid xml characters.\r\n    *\r\n    *  Parameters:\r\n    *     (String) text - text to unescape.\r\n    *\r\n    *  Returns:\r\n    *      Unescaped text.\r\n    */\r\n    xmlunescape: function(text) {\r\n        text = text.replace(/\\&amp;/g, \"&\");\r\n        text = text.replace(/&lt;/g,  \"<\");\r\n        text = text.replace(/&gt;/g,  \">\");\r\n        text = text.replace(/&apos;/g,  \"'\");\r\n        text = text.replace(/&quot;/g,  \"\\\"\");\r\n        return text;\r\n    },\r\n\r\n    /** Function: xmlTextNode\r\n     *  Creates an XML DOM text node.\r\n     *\r\n     *  Provides a cross implementation version of document.createTextNode.\r\n     *\r\n     *  Parameters:\r\n     *    (String) text - The content of the text node.\r\n     *\r\n     *  Returns:\r\n     *    A new XML DOM text node.\r\n     */\r\n    xmlTextNode: function (text) {\r\n        return Strophe.xmlGenerator().createTextNode(text);\r\n    },\r\n\r\n    /** Function: xmlHtmlNode\r\n     *  Creates an XML DOM html node.\r\n     *\r\n     *  Parameters:\r\n     *    (String) html - The content of the html node.\r\n     *\r\n     *  Returns:\r\n     *    A new XML DOM text node.\r\n     */\r\n    xmlHtmlNode: function (html) {\r\n        var node;\r\n        //ensure text is escaped\r\n        if (DOMParser) {\r\n            var parser = new DOMParser();\r\n            node = parser.parseFromString(html, \"text/xml\");\r\n        } else {\r\n            node = new ActiveXObject(\"Microsoft.XMLDOM\");\r\n            node.async=\"false\";\r\n            node.loadXML(html);\r\n        }\r\n        return node;\r\n    },\r\n\r\n    /** Function: getText\r\n     *  Get the concatenation of all text children of an element.\r\n     *\r\n     *  Parameters:\r\n     *    (XMLElement) elem - A DOM element.\r\n     *\r\n     *  Returns:\r\n     *    A String with the concatenated text of all text element children.\r\n     */\r\n    getText: function (elem) {\r\n        if (!elem) { return null; }\r\n\r\n        var str = \"\";\r\n        if (elem.childNodes.length === 0 && elem.nodeType === Strophe.ElementType.TEXT) {\r\n            str += elem.nodeValue;\r\n        }\r\n\r\n        for (var i = 0; i < elem.childNodes.length; i++) {\r\n            if (elem.childNodes[i].nodeType === Strophe.ElementType.TEXT) {\r\n                str += elem.childNodes[i].nodeValue;\r\n            }\r\n        }\r\n\r\n        return Strophe.xmlescape(str);\r\n    },\r\n\r\n    /** Function: copyElement\r\n     *  Copy an XML DOM element.\r\n     *\r\n     *  This function copies a DOM element and all its descendants and returns\r\n     *  the new copy.\r\n     *\r\n     *  Parameters:\r\n     *    (XMLElement) elem - A DOM element.\r\n     *\r\n     *  Returns:\r\n     *    A new, copied DOM element tree.\r\n     */\r\n    copyElement: function (elem) {\r\n        var i, el;\r\n        if (elem.nodeType === Strophe.ElementType.NORMAL) {\r\n            el = Strophe.xmlElement(elem.tagName);\r\n\r\n            for (i = 0; i < elem.attributes.length; i++) {\r\n                el.setAttribute(elem.attributes[i].nodeName,\r\n                                elem.attributes[i].value);\r\n            }\r\n\r\n            for (i = 0; i < elem.childNodes.length; i++) {\r\n                el.appendChild(Strophe.copyElement(elem.childNodes[i]));\r\n            }\r\n        } else if (elem.nodeType === Strophe.ElementType.TEXT) {\r\n            el = Strophe.xmlGenerator().createTextNode(elem.nodeValue);\r\n        }\r\n        return el;\r\n    },\r\n\r\n\r\n    /** Function: createHtml\r\n     *  Copy an HTML DOM element into an XML DOM.\r\n     *\r\n     *  This function copies a DOM element and all its descendants and returns\r\n     *  the new copy.\r\n     *\r\n     *  Parameters:\r\n     *    (HTMLElement) elem - A DOM element.\r\n     *\r\n     *  Returns:\r\n     *    A new, copied DOM element tree.\r\n     */\r\n    createHtml: function (elem) {\r\n        var i, el, j, tag, attribute, value, css, cssAttrs, attr, cssName, cssValue;\r\n        if (elem.nodeType === Strophe.ElementType.NORMAL) {\r\n            tag = elem.nodeName.toLowerCase(); // XHTML tags must be lower case.\r\n            if(Strophe.XHTML.validTag(tag)) {\r\n                try {\r\n                    el = Strophe.xmlElement(tag);\r\n                    for(i = 0; i < Strophe.XHTML.attributes[tag].length; i++) {\r\n                        attribute = Strophe.XHTML.attributes[tag][i];\r\n                        value = elem.getAttribute(attribute);\r\n                        if(typeof value === 'undefined' || value === null || value === '' || value === false || value === 0) {\r\n                            continue;\r\n                        }\r\n                        if(attribute === 'style' && typeof value === 'object') {\r\n                            if(typeof value.cssText !== 'undefined') {\r\n                                value = value.cssText; // we're dealing with IE, need to get CSS out\r\n                            }\r\n                        }\r\n                        // filter out invalid css styles\r\n                        if(attribute === 'style') {\r\n                            css = [];\r\n                            cssAttrs = value.split(';');\r\n                            for(j = 0; j < cssAttrs.length; j++) {\r\n                                attr = cssAttrs[j].split(':');\r\n                                cssName = attr[0].replace(/^\\s*/, \"\").replace(/\\s*$/, \"\").toLowerCase();\r\n                                if(Strophe.XHTML.validCSS(cssName)) {\r\n                                    cssValue = attr[1].replace(/^\\s*/, \"\").replace(/\\s*$/, \"\");\r\n                                    css.push(cssName + ': ' + cssValue);\r\n                                }\r\n                            }\r\n                            if(css.length > 0) {\r\n                                value = css.join('; ');\r\n                                el.setAttribute(attribute, value);\r\n                            }\r\n                        } else {\r\n                            el.setAttribute(attribute, value);\r\n                        }\r\n                    }\r\n\r\n                    for (i = 0; i < elem.childNodes.length; i++) {\r\n                        el.appendChild(Strophe.createHtml(elem.childNodes[i]));\r\n                    }\r\n                } catch(e) { // invalid elements\r\n                  el = Strophe.xmlTextNode('');\r\n                }\r\n            } else {\r\n                el = Strophe.xmlGenerator().createDocumentFragment();\r\n                for (i = 0; i < elem.childNodes.length; i++) {\r\n                    el.appendChild(Strophe.createHtml(elem.childNodes[i]));\r\n                }\r\n            }\r\n        } else if (elem.nodeType === Strophe.ElementType.FRAGMENT) {\r\n            el = Strophe.xmlGenerator().createDocumentFragment();\r\n            for (i = 0; i < elem.childNodes.length; i++) {\r\n                el.appendChild(Strophe.createHtml(elem.childNodes[i]));\r\n            }\r\n        } else if (elem.nodeType === Strophe.ElementType.TEXT) {\r\n            el = Strophe.xmlTextNode(elem.nodeValue);\r\n        }\r\n        return el;\r\n    },\r\n\r\n    /** Function: escapeNode\r\n     *  Escape the node part (also called local part) of a JID.\r\n     *\r\n     *  Parameters:\r\n     *    (String) node - A node (or local part).\r\n     *\r\n     *  Returns:\r\n     *    An escaped node (or local part).\r\n     */\r\n    escapeNode: function (node) {\r\n        if (typeof node !== \"string\") { return node; }\r\n        return node.replace(/^\\s+|\\s+$/g, '')\r\n            .replace(/\\\\/g,  \"\\\\5c\")\r\n            .replace(/ /g,   \"\\\\20\")\r\n            .replace(/\\\"/g,  \"\\\\22\")\r\n            .replace(/\\&/g,  \"\\\\26\")\r\n            .replace(/\\'/g,  \"\\\\27\")\r\n            .replace(/\\//g,  \"\\\\2f\")\r\n            .replace(/:/g,   \"\\\\3a\")\r\n            .replace(/</g,   \"\\\\3c\")\r\n            .replace(/>/g,   \"\\\\3e\")\r\n            .replace(/@/g,   \"\\\\40\");\r\n    },\r\n\r\n    /** Function: unescapeNode\r\n     *  Unescape a node part (also called local part) of a JID.\r\n     *\r\n     *  Parameters:\r\n     *    (String) node - A node (or local part).\r\n     *\r\n     *  Returns:\r\n     *    An unescaped node (or local part).\r\n     */\r\n    unescapeNode: function (node) {\r\n        if (typeof node !== \"string\") { return node; }\r\n        return node.replace(/\\\\20/g, \" \")\r\n            .replace(/\\\\22/g, '\"')\r\n            .replace(/\\\\26/g, \"&\")\r\n            .replace(/\\\\27/g, \"'\")\r\n            .replace(/\\\\2f/g, \"/\")\r\n            .replace(/\\\\3a/g, \":\")\r\n            .replace(/\\\\3c/g, \"<\")\r\n            .replace(/\\\\3e/g, \">\")\r\n            .replace(/\\\\40/g, \"@\")\r\n            .replace(/\\\\5c/g, \"\\\\\");\r\n    },\r\n\r\n    /** Function: getNodeFromJid\r\n     *  Get the node portion of a JID String.\r\n     *\r\n     *  Parameters:\r\n     *    (String) jid - A JID.\r\n     *\r\n     *  Returns:\r\n     *    A String containing the node.\r\n     */\r\n    getNodeFromJid: function (jid) {\r\n        if (jid.indexOf(\"@\") < 0) { return null; }\r\n        return jid.split(\"@\")[0];\r\n    },\r\n\r\n    /** Function: getDomainFromJid\r\n     *  Get the domain portion of a JID String.\r\n     *\r\n     *  Parameters:\r\n     *    (String) jid - A JID.\r\n     *\r\n     *  Returns:\r\n     *    A String containing the domain.\r\n     */\r\n    getDomainFromJid: function (jid) {\r\n        var bare = Strophe.getBareJidFromJid(jid);\r\n        if (bare.indexOf(\"@\") < 0) {\r\n            return bare;\r\n        } else {\r\n            var parts = bare.split(\"@\");\r\n            parts.splice(0, 1);\r\n            return parts.join('@');\r\n        }\r\n    },\r\n\r\n    /** Function: getResourceFromJid\r\n     *  Get the resource portion of a JID String.\r\n     *\r\n     *  Parameters:\r\n     *    (String) jid - A JID.\r\n     *\r\n     *  Returns:\r\n     *    A String containing the resource.\r\n     */\r\n    getResourceFromJid: function (jid) {\r\n        var s = jid.split(\"/\");\r\n        if (s.length < 2) { return null; }\r\n        s.splice(0, 1);\r\n        return s.join('/');\r\n    },\r\n\r\n    /** Function: getBareJidFromJid\r\n     *  Get the bare JID from a JID String.\r\n     *\r\n     *  Parameters:\r\n     *    (String) jid - A JID.\r\n     *\r\n     *  Returns:\r\n     *    A String containing the bare JID.\r\n     */\r\n    getBareJidFromJid: function (jid) {\r\n        return jid ? jid.split(\"/\")[0] : null;\r\n    },\r\n\r\n    /** PrivateFunction: _handleError\r\n     *  _Private_ function that properly logs an error to the console\r\n     */\r\n    _handleError: function (e) {\r\n        if (typeof e.stack !== \"undefined\") {\r\n            Strophe.fatal(e.stack);\r\n        }\r\n        if (e.sourceURL) {\r\n            Strophe.fatal(\"error: \" + this.handler + \" \" + e.sourceURL + \":\" +\r\n                          e.line + \" - \" + e.name + \": \" + e.message);\r\n        } else if (e.fileName) {\r\n            Strophe.fatal(\"error: \" + this.handler + \" \" +\r\n                          e.fileName + \":\" + e.lineNumber + \" - \" +\r\n                          e.name + \": \" + e.message);\r\n        } else {\r\n            Strophe.fatal(\"error: \" + e.message);\r\n        }\r\n    },\r\n\r\n    /** Function: log\r\n     *  User overrideable logging function.\r\n     *\r\n     *  This function is called whenever the Strophe library calls any\r\n     *  of the logging functions.  The default implementation of this\r\n     *  function does nothing.  If client code wishes to handle the logging\r\n     *  messages, it should override this with\r\n     *  > Strophe.log = function (level, msg) {\r\n     *  >   (user code here)\r\n     *  > };\r\n     *\r\n     *  Please note that data sent and received over the wire is logged\r\n     *  via Strophe.Connection.rawInput() and Strophe.Connection.rawOutput().\r\n     *\r\n     *  The different levels and their meanings are\r\n     *\r\n     *    DEBUG - Messages useful for debugging purposes.\r\n     *    INFO - Informational messages.  This is mostly information like\r\n     *      'disconnect was called' or 'SASL auth succeeded'.\r\n     *    WARN - Warnings about potential problems.  This is mostly used\r\n     *      to report transient connection errors like request timeouts.\r\n     *    ERROR - Some error occurred.\r\n     *    FATAL - A non-recoverable fatal error occurred.\r\n     *\r\n     *  Parameters:\r\n     *    (Integer) level - The log level of the log message.  This will\r\n     *      be one of the values in Strophe.LogLevel.\r\n     *    (String) msg - The log message.\r\n     */\r\n    /* jshint ignore:start */\r\n    log: function (level, msg) {\r\n        return;\r\n    },\r\n    /* jshint ignore:end */\r\n\r\n    /** Function: debug\r\n     *  Log a message at the Strophe.LogLevel.DEBUG level.\r\n     *\r\n     *  Parameters:\r\n     *    (String) msg - The log message.\r\n     */\r\n    debug: function(msg) {\r\n        this.log(this.LogLevel.DEBUG, msg);\r\n    },\r\n\r\n    /** Function: info\r\n     *  Log a message at the Strophe.LogLevel.INFO level.\r\n     *\r\n     *  Parameters:\r\n     *    (String) msg - The log message.\r\n     */\r\n    info: function (msg) {\r\n        this.log(this.LogLevel.INFO, msg);\r\n    },\r\n\r\n    /** Function: warn\r\n     *  Log a message at the Strophe.LogLevel.WARN level.\r\n     *\r\n     *  Parameters:\r\n     *    (String) msg - The log message.\r\n     */\r\n    warn: function (msg) {\r\n        this.log(this.LogLevel.WARN, msg);\r\n    },\r\n\r\n    /** Function: error\r\n     *  Log a message at the Strophe.LogLevel.ERROR level.\r\n     *\r\n     *  Parameters:\r\n     *    (String) msg - The log message.\r\n     */\r\n    error: function (msg) {\r\n        this.log(this.LogLevel.ERROR, msg);\r\n    },\r\n\r\n    /** Function: fatal\r\n     *  Log a message at the Strophe.LogLevel.FATAL level.\r\n     *\r\n     *  Parameters:\r\n     *    (String) msg - The log message.\r\n     */\r\n    fatal: function (msg) {\r\n        this.log(this.LogLevel.FATAL, msg);\r\n    },\r\n\r\n    /** Function: serialize\r\n     *  Render a DOM element and all descendants to a String.\r\n     *\r\n     *  Parameters:\r\n     *    (XMLElement) elem - A DOM element.\r\n     *\r\n     *  Returns:\r\n     *    The serialized element tree as a String.\r\n     */\r\n    serialize: function (elem) {\r\n        var result;\r\n\r\n        if (!elem) { return null; }\r\n\r\n        if (typeof(elem.tree) === \"function\") {\r\n            elem = elem.tree();\r\n        }\r\n\r\n        var nodeName = elem.nodeName;\r\n        var i, child;\r\n\r\n        if (elem.getAttribute(\"_realname\")) {\r\n            nodeName = elem.getAttribute(\"_realname\");\r\n        }\r\n\r\n        result = \"<\" + nodeName;\r\n        for (i = 0; i < elem.attributes.length; i++) {\r\n             if(elem.attributes[i].nodeName !== \"_realname\") {\r\n               result += \" \" + elem.attributes[i].nodeName +\r\n                   \"='\" + Strophe.xmlescape(elem.attributes[i].value) + \"'\";\r\n             }\r\n        }\r\n\r\n        if (elem.childNodes.length > 0) {\r\n            result += \">\";\r\n            for (i = 0; i < elem.childNodes.length; i++) {\r\n                child = elem.childNodes[i];\r\n                switch( child.nodeType ){\r\n                  case Strophe.ElementType.NORMAL:\r\n                    // normal element, so recurse\r\n                    result += Strophe.serialize(child);\r\n                    break;\r\n                  case Strophe.ElementType.TEXT:\r\n                    // text element to escape values\r\n                    result += Strophe.xmlescape(child.nodeValue);\r\n                    break;\r\n                  case Strophe.ElementType.CDATA:\r\n                    // cdata section so don't escape values\r\n                    result += \"<![CDATA[\"+child.nodeValue+\"]]>\";\r\n                }\r\n            }\r\n            result += \"</\" + nodeName + \">\";\r\n        } else {\r\n            result += \"/>\";\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /** PrivateVariable: _requestId\r\n     *  _Private_ variable that keeps track of the request ids for\r\n     *  connections.\r\n     */\r\n    _requestId: 0,\r\n\r\n    /** PrivateVariable: Strophe.connectionPlugins\r\n     *  _Private_ variable Used to store plugin names that need\r\n     *  initialization on Strophe.Connection construction.\r\n     */\r\n    _connectionPlugins: {},\r\n\r\n    /** Function: addConnectionPlugin\r\n     *  Extends the Strophe.Connection object with the given plugin.\r\n     *\r\n     *  Parameters:\r\n     *    (String) name - The name of the extension.\r\n     *    (Object) ptype - The plugin's prototype.\r\n     */\r\n    addConnectionPlugin: function (name, ptype) {\r\n        Strophe._connectionPlugins[name] = ptype;\r\n    }\r\n};\r\n\r\n/** Class: Strophe.Builder\r\n *  XML DOM builder.\r\n *\r\n *  This object provides an interface similar to JQuery but for building\r\n *  DOM elements easily and rapidly.  All the functions except for toString()\r\n *  and tree() return the object, so calls can be chained.  Here's an\r\n *  example using the $iq() builder helper.\r\n *  > $iq({to: 'you', from: 'me', type: 'get', id: '1'})\r\n *  >     .c('query', {xmlns: 'strophe:example'})\r\n *  >     .c('example')\r\n *  >     .toString()\r\n *\r\n *  The above generates this XML fragment\r\n *  > <iq to='you' from='me' type='get' id='1'>\r\n *  >   <query xmlns='strophe:example'>\r\n *  >     <example/>\r\n *  >   </query>\r\n *  > </iq>\r\n *  The corresponding DOM manipulations to get a similar fragment would be\r\n *  a lot more tedious and probably involve several helper variables.\r\n *\r\n *  Since adding children makes new operations operate on the child, up()\r\n *  is provided to traverse up the tree.  To add two children, do\r\n *  > builder.c('child1', ...).up().c('child2', ...)\r\n *  The next operation on the Builder will be relative to the second child.\r\n */\r\n\r\n/** Constructor: Strophe.Builder\r\n *  Create a Strophe.Builder object.\r\n *\r\n *  The attributes should be passed in object notation.  For example\r\n *  > var b = new Builder('message', {to: 'you', from: 'me'});\r\n *  or\r\n *  > var b = new Builder('messsage', {'xml:lang': 'en'});\r\n *\r\n *  Parameters:\r\n *    (String) name - The name of the root element.\r\n *    (Object) attrs - The attributes for the root element in object notation.\r\n *\r\n *  Returns:\r\n *    A new Strophe.Builder.\r\n */\r\nStrophe.Builder = function (name, attrs) {\r\n    // Set correct namespace for jabber:client elements\r\n    if (name === \"presence\" || name === \"message\" || name === \"iq\") {\r\n        if (attrs && !attrs.xmlns) {\r\n            attrs.xmlns = Strophe.NS.CLIENT;\r\n        } else if (!attrs) {\r\n            attrs = {xmlns: Strophe.NS.CLIENT};\r\n        }\r\n    }\r\n\r\n    // Holds the tree being built.\r\n    this.nodeTree = Strophe.xmlElement(name, attrs);\r\n\r\n    // Points to the current operation node.\r\n    this.node = this.nodeTree;\r\n};\r\n\r\nStrophe.Builder.prototype = {\r\n    /** Function: tree\r\n     *  Return the DOM tree.\r\n     *\r\n     *  This function returns the current DOM tree as an element object.  This\r\n     *  is suitable for passing to functions like Strophe.Connection.send().\r\n     *\r\n     *  Returns:\r\n     *    The DOM tree as a element object.\r\n     */\r\n    tree: function () {\r\n        return this.nodeTree;\r\n    },\r\n\r\n    /** Function: toString\r\n     *  Serialize the DOM tree to a String.\r\n     *\r\n     *  This function returns a string serialization of the current DOM\r\n     *  tree.  It is often used internally to pass data to a\r\n     *  Strophe.Request object.\r\n     *\r\n     *  Returns:\r\n     *    The serialized DOM tree in a String.\r\n     */\r\n    toString: function () {\r\n        return Strophe.serialize(this.nodeTree);\r\n    },\r\n\r\n    /** Function: up\r\n     *  Make the current parent element the new current element.\r\n     *\r\n     *  This function is often used after c() to traverse back up the tree.\r\n     *  For example, to add two children to the same element\r\n     *  > builder.c('child1', {}).up().c('child2', {});\r\n     *\r\n     *  Returns:\r\n     *    The Stophe.Builder object.\r\n     */\r\n    up: function () {\r\n        this.node = this.node.parentNode;\r\n        return this;\r\n    },\r\n\r\n    /** Function: root\r\n     *  Make the root element the new current element.\r\n     *\r\n     *  When at a deeply nested element in the tree, this function can be used\r\n     *  to jump back to the root of the tree, instead of having to repeatedly\r\n     *  call up().\r\n     *\r\n     *  Returns:\r\n     *    The Stophe.Builder object.\r\n     */\r\n    root: function () {\r\n        this.node = this.nodeTree;\r\n        return this;\r\n    },\r\n\r\n    /** Function: attrs\r\n     *  Add or modify attributes of the current element.\r\n     *\r\n     *  The attributes should be passed in object notation.  This function\r\n     *  does not move the current element pointer.\r\n     *\r\n     *  Parameters:\r\n     *    (Object) moreattrs - The attributes to add/modify in object notation.\r\n     *\r\n     *  Returns:\r\n     *    The Strophe.Builder object.\r\n     */\r\n    attrs: function (moreattrs) {\r\n        for (var k in moreattrs) {\r\n            if (moreattrs.hasOwnProperty(k)) {\r\n                if (moreattrs[k] === undefined) {\r\n                    this.node.removeAttribute(k);\r\n                } else {\r\n                    this.node.setAttribute(k, moreattrs[k]);\r\n                }\r\n            }\r\n        }\r\n        return this;\r\n    },\r\n\r\n    /** Function: c\r\n     *  Add a child to the current element and make it the new current\r\n     *  element.\r\n     *\r\n     *  This function moves the current element pointer to the child,\r\n     *  unless text is provided.  If you need to add another child, it\r\n     *  is necessary to use up() to go back to the parent in the tree.\r\n     *\r\n     *  Parameters:\r\n     *    (String) name - The name of the child.\r\n     *    (Object) attrs - The attributes of the child in object notation.\r\n     *    (String) text - The text to add to the child.\r\n     *\r\n     *  Returns:\r\n     *    The Strophe.Builder object.\r\n     */\r\n    c: function (name, attrs, text) {\r\n        var child = Strophe.xmlElement(name, attrs, text);\r\n        this.node.appendChild(child);\r\n        if (typeof text !== \"string\" && typeof text !==\"number\") {\r\n            this.node = child;\r\n        }\r\n        return this;\r\n    },\r\n\r\n    /** Function: cnode\r\n     *  Add a child to the current element and make it the new current\r\n     *  element.\r\n     *\r\n     *  This function is the same as c() except that instead of using a\r\n     *  name and an attributes object to create the child it uses an\r\n     *  existing DOM element object.\r\n     *\r\n     *  Parameters:\r\n     *    (XMLElement) elem - A DOM element.\r\n     *\r\n     *  Returns:\r\n     *    The Strophe.Builder object.\r\n     */\r\n    cnode: function (elem) {\r\n        var impNode;\r\n        var xmlGen = Strophe.xmlGenerator();\r\n        try {\r\n            impNode = (xmlGen.importNode !== undefined);\r\n        } catch (e) {\r\n            impNode = false;\r\n        }\r\n        var newElem = impNode ?\r\n                      xmlGen.importNode(elem, true) :\r\n                      Strophe.copyElement(elem);\r\n        this.node.appendChild(newElem);\r\n        this.node = newElem;\r\n        return this;\r\n    },\r\n\r\n    /** Function: t\r\n     *  Add a child text element.\r\n     *\r\n     *  This *does not* make the child the new current element since there\r\n     *  are no children of text elements.\r\n     *\r\n     *  Parameters:\r\n     *    (String) text - The text data to append to the current element.\r\n     *\r\n     *  Returns:\r\n     *    The Strophe.Builder object.\r\n     */\r\n    t: function (text) {\r\n        var child = Strophe.xmlTextNode(text);\r\n        this.node.appendChild(child);\r\n        return this;\r\n    },\r\n\r\n    /** Function: h\r\n     *  Replace current element contents with the HTML passed in.\r\n     *\r\n     *  This *does not* make the child the new current element\r\n     *\r\n     *  Parameters:\r\n     *    (String) html - The html to insert as contents of current element.\r\n     *\r\n     *  Returns:\r\n     *    The Strophe.Builder object.\r\n     */\r\n    h: function (html) {\r\n        var fragment = document.createElement('body');\r\n\r\n        // force the browser to try and fix any invalid HTML tags\r\n        fragment.innerHTML = html;\r\n\r\n        // copy cleaned html into an xml dom\r\n        var xhtml = Strophe.createHtml(fragment);\r\n\r\n        while(xhtml.childNodes.length > 0) {\r\n            this.node.appendChild(xhtml.childNodes[0]);\r\n        }\r\n        return this;\r\n    }\r\n};\r\n\r\n/** PrivateClass: Strophe.Handler\r\n *  _Private_ helper class for managing stanza handlers.\r\n *\r\n *  A Strophe.Handler encapsulates a user provided callback function to be\r\n *  executed when matching stanzas are received by the connection.\r\n *  Handlers can be either one-off or persistant depending on their\r\n *  return value. Returning true will cause a Handler to remain active, and\r\n *  returning false will remove the Handler.\r\n *\r\n *  Users will not use Strophe.Handler objects directly, but instead they\r\n *  will use Strophe.Connection.addHandler() and\r\n *  Strophe.Connection.deleteHandler().\r\n */\r\n\r\n/** PrivateConstructor: Strophe.Handler\r\n *  Create and initialize a new Strophe.Handler.\r\n *\r\n *  Parameters:\r\n *    (Function) handler - A function to be executed when the handler is run.\r\n *    (String) ns - The namespace to match.\r\n *    (String) name - The element name to match.\r\n *    (String) type - The element type to match.\r\n *    (String) id - The element id attribute to match.\r\n *    (String) from - The element from attribute to match.\r\n *    (Object) options - Handler options\r\n *\r\n *  Returns:\r\n *    A new Strophe.Handler object.\r\n */\r\nStrophe.Handler = function (handler, ns, name, type, id, from, options) {\r\n    this.handler = handler;\r\n    this.ns = ns;\r\n    this.name = name;\r\n    this.type = type;\r\n    this.id = id;\r\n    this.options = options || {'matchBareFromJid': false, 'ignoreNamespaceFragment': false};\r\n    // BBB: Maintain backward compatibility with old `matchBare` option\r\n    if (this.options.matchBare) {\r\n        Strophe.warn('The \"matchBare\" option is deprecated, use \"matchBareFromJid\" instead.');\r\n        this.options.matchBareFromJid = this.options.matchBare;\r\n        delete this.options.matchBare;\r\n    }\r\n\r\n    if (this.options.matchBareFromJid) {\r\n        this.from = from ? Strophe.getBareJidFromJid(from) : null;\r\n    } else {\r\n        this.from = from;\r\n    }\r\n    // whether the handler is a user handler or a system handler\r\n    this.user = true;\r\n};\r\n\r\nStrophe.Handler.prototype = {\r\n    /** PrivateFunction: getNamespace\r\n     *  Returns the XML namespace attribute on an element.\r\n     *  If `ignoreNamespaceFragment` was passed in for this handler, then the\r\n     *  URL fragment will be stripped.\r\n     *\r\n     *  Parameters:\r\n     *    (XMLElement) elem - The XML element with the namespace.\r\n     *\r\n     *  Returns:\r\n     *    The namespace, with optionally the fragment stripped.\r\n     */\r\n    getNamespace: function (elem) {\r\n        var elNamespace = elem.getAttribute(\"xmlns\");\r\n        if (elNamespace && this.options.ignoreNamespaceFragment) {\r\n            elNamespace = elNamespace.split('#')[0];\r\n        }\r\n        return elNamespace;\r\n    },\r\n\r\n    /** PrivateFunction: namespaceMatch\r\n     *  Tests if a stanza matches the namespace set for this Strophe.Handler.\r\n     *\r\n     *  Parameters:\r\n     *    (XMLElement) elem - The XML element to test.\r\n     *\r\n     *  Returns:\r\n     *    true if the stanza matches and false otherwise.\r\n     */\r\n    namespaceMatch: function (elem) {\r\n        var nsMatch = false;\r\n        if (!this.ns) {\r\n            return true;\r\n        } else {\r\n            var that = this;\r\n            Strophe.forEachChild(elem, null, function (elem) {\r\n                if (that.getNamespace(elem) === that.ns) {\r\n                    nsMatch = true;\r\n                }\r\n            });\r\n            nsMatch = nsMatch || this.getNamespace(elem) === this.ns;\r\n        }\r\n        return nsMatch;\r\n    },\r\n\r\n    /** PrivateFunction: isMatch\r\n     *  Tests if a stanza matches the Strophe.Handler.\r\n     *\r\n     *  Parameters:\r\n     *    (XMLElement) elem - The XML element to test.\r\n     *\r\n     *  Returns:\r\n     *    true if the stanza matches and false otherwise.\r\n     */\r\n    isMatch: function (elem) {\r\n        var from = elem.getAttribute('from');\r\n        if (this.options.matchBareFromJid) {\r\n            from = Strophe.getBareJidFromJid(from);\r\n        }\r\n        var elem_type = elem.getAttribute(\"type\");\r\n        if (this.namespaceMatch(elem) &&\r\n            (!this.name || Strophe.isTagEqual(elem, this.name)) &&\r\n            (!this.type || (Array.isArray(this.type) ? this.type.indexOf(elem_type) !== -1 : elem_type === this.type)) &&\r\n            (!this.id || elem.getAttribute(\"id\") === this.id) &&\r\n            (!this.from || from === this.from)) {\r\n                return true;\r\n        }\r\n        return false;\r\n    },\r\n\r\n    /** PrivateFunction: run\r\n     *  Run the callback on a matching stanza.\r\n     *\r\n     *  Parameters:\r\n     *    (XMLElement) elem - The DOM element that triggered the\r\n     *      Strophe.Handler.\r\n     *\r\n     *  Returns:\r\n     *    A boolean indicating if the handler should remain active.\r\n     */\r\n    run: function (elem) {\r\n        var result = null;\r\n        try {\r\n            result = this.handler(elem);\r\n        } catch (e) {\r\n            Strophe._handleError(e);\r\n            throw e;\r\n        }\r\n        return result;\r\n    },\r\n\r\n    /** PrivateFunction: toString\r\n     *  Get a String representation of the Strophe.Handler object.\r\n     *\r\n     *  Returns:\r\n     *    A String.\r\n     */\r\n    toString: function () {\r\n        return \"{Handler: \" + this.handler + \"(\" + this.name + \",\" +\r\n            this.id + \",\" + this.ns + \")}\";\r\n    }\r\n};\r\n\r\n/** PrivateClass: Strophe.TimedHandler\r\n *  _Private_ helper class for managing timed handlers.\r\n *\r\n *  A Strophe.TimedHandler encapsulates a user provided callback that\r\n *  should be called after a certain period of time or at regular\r\n *  intervals.  The return value of the callback determines whether the\r\n *  Strophe.TimedHandler will continue to fire.\r\n *\r\n *  Users will not use Strophe.TimedHandler objects directly, but instead\r\n *  they will use Strophe.Connection.addTimedHandler() and\r\n *  Strophe.Connection.deleteTimedHandler().\r\n */\r\n\r\n/** PrivateConstructor: Strophe.TimedHandler\r\n *  Create and initialize a new Strophe.TimedHandler object.\r\n *\r\n *  Parameters:\r\n *    (Integer) period - The number of milliseconds to wait before the\r\n *      handler is called.\r\n *    (Function) handler - The callback to run when the handler fires.  This\r\n *      function should take no arguments.\r\n *\r\n *  Returns:\r\n *    A new Strophe.TimedHandler object.\r\n */\r\nStrophe.TimedHandler = function (period, handler) {\r\n    this.period = period;\r\n    this.handler = handler;\r\n    this.lastCalled = new Date().getTime();\r\n    this.user = true;\r\n};\r\n\r\nStrophe.TimedHandler.prototype = {\r\n    /** PrivateFunction: run\r\n     *  Run the callback for the Strophe.TimedHandler.\r\n     *\r\n     *  Returns:\r\n     *    true if the Strophe.TimedHandler should be called again, and false\r\n     *      otherwise.\r\n     */\r\n    run: function () {\r\n        this.lastCalled = new Date().getTime();\r\n        return this.handler();\r\n    },\r\n\r\n    /** PrivateFunction: reset\r\n     *  Reset the last called time for the Strophe.TimedHandler.\r\n     */\r\n    reset: function () {\r\n        this.lastCalled = new Date().getTime();\r\n    },\r\n\r\n    /** PrivateFunction: toString\r\n     *  Get a string representation of the Strophe.TimedHandler object.\r\n     *\r\n     *  Returns:\r\n     *    The string representation.\r\n     */\r\n    toString: function () {\r\n        return \"{TimedHandler: \" + this.handler + \"(\" + this.period +\")}\";\r\n    }\r\n};\r\n\r\n/** Class: Strophe.Connection\r\n *  XMPP Connection manager.\r\n *\r\n *  This class is the main part of Strophe.  It manages a BOSH or websocket\r\n *  connection to an XMPP server and dispatches events to the user callbacks\r\n *  as data arrives. It supports SASL PLAIN, SASL DIGEST-MD5, SASL SCRAM-SHA1\r\n *  and legacy authentication.\r\n *\r\n *  After creating a Strophe.Connection object, the user will typically\r\n *  call connect() with a user supplied callback to handle connection level\r\n *  events like authentication failure, disconnection, or connection\r\n *  complete.\r\n *\r\n *  The user will also have several event handlers defined by using\r\n *  addHandler() and addTimedHandler().  These will allow the user code to\r\n *  respond to interesting stanzas or do something periodically with the\r\n *  connection. These handlers will be active once authentication is\r\n *  finished.\r\n *\r\n *  To send data to the connection, use send().\r\n */\r\n\r\n/** Constructor: Strophe.Connection\r\n *  Create and initialize a Strophe.Connection object.\r\n *\r\n *  The transport-protocol for this connection will be chosen automatically\r\n *  based on the given service parameter. URLs starting with \"ws://\" or\r\n *  \"wss://\" will use WebSockets, URLs starting with \"http://\", \"https://\"\r\n *  or without a protocol will use BOSH.\r\n *\r\n *  To make Strophe connect to the current host you can leave out the protocol\r\n *  and host part and just pass the path, e.g.\r\n *\r\n *  > var conn = new Strophe.Connection(\"/http-bind/\");\r\n *\r\n *  Options common to both Websocket and BOSH:\r\n *  ------------------------------------------\r\n *\r\n *  cookies:\r\n *\r\n *  The *cookies* option allows you to pass in cookies to be added to the\r\n *  document. These cookies will then be included in the BOSH XMLHttpRequest\r\n *  or in the websocket connection.\r\n *\r\n *  The passed in value must be a map of cookie names and string values.\r\n *\r\n *  > { \"myCookie\": {\r\n *  >     \"value\": \"1234\",\r\n *  >     \"domain\": \".example.org\",\r\n *  >     \"path\": \"/\",\r\n *  >     \"expires\": expirationDate\r\n *  >     }\r\n *  > }\r\n *\r\n *  Note that cookies can't be set in this way for other domains (i.e. cross-domain).\r\n *  Those cookies need to be set under those domains, for example they can be\r\n *  set server-side by making a XHR call to that domain to ask it to set any\r\n *  necessary cookies.\r\n *\r\n *  mechanisms:\r\n *\r\n *  The *mechanisms* option allows you to specify the SASL mechanisms that this\r\n *  instance of Strophe.Connection (and therefore your XMPP client) will\r\n *  support.\r\n *\r\n *  The value must be an array of objects with Strophe.SASLMechanism\r\n *  prototypes.\r\n *\r\n *  If nothing is specified, then the following mechanisms (and their\r\n *  priorities) are registered:\r\n *\r\n *      OAUTHBEARER - 60\r\n *      SCRAM-SHA1 - 50\r\n *      DIGEST-MD5 - 40\r\n *      PLAIN - 30\r\n *      ANONYMOUS - 20\r\n *      EXTERNAL - 10\r\n *\r\n *  WebSocket options:\r\n *  ------------------\r\n *\r\n *  If you want to connect to the current host with a WebSocket connection you\r\n *  can tell Strophe to use WebSockets through a \"protocol\" attribute in the\r\n *  optional options parameter. Valid values are \"ws\" for WebSocket and \"wss\"\r\n *  for Secure WebSocket.\r\n *  So to connect to \"wss://CURRENT_HOSTNAME/xmpp-websocket\" you would call\r\n *\r\n *  > var conn = new Strophe.Connection(\"/xmpp-websocket/\", {protocol: \"wss\"});\r\n *\r\n *  Note that relative URLs _NOT_ starting with a \"/\" will also include the path\r\n *  of the current site.\r\n *\r\n *  Also because downgrading security is not permitted by browsers, when using\r\n *  relative URLs both BOSH and WebSocket connections will use their secure\r\n *  variants if the current connection to the site is also secure (https).\r\n *\r\n *  BOSH options:\r\n *  -------------\r\n *\r\n *  By adding \"sync\" to the options, you can control if requests will\r\n *  be made synchronously or not. The default behaviour is asynchronous.\r\n *  If you want to make requests synchronous, make \"sync\" evaluate to true.\r\n *  > var conn = new Strophe.Connection(\"/http-bind/\", {sync: true});\r\n *\r\n *  You can also toggle this on an already established connection.\r\n *  > conn.options.sync = true;\r\n *\r\n *  The *customHeaders* option can be used to provide custom HTTP headers to be\r\n *  included in the XMLHttpRequests made.\r\n *\r\n *  The *keepalive* option can be used to instruct Strophe to maintain the\r\n *  current BOSH session across interruptions such as webpage reloads.\r\n *\r\n *  It will do this by caching the sessions tokens in sessionStorage, and when\r\n *  \"restore\" is called it will check whether there are cached tokens with\r\n *  which it can resume an existing session.\r\n *\r\n *  The *withCredentials* option should receive a Boolean value and is used to\r\n *  indicate wether cookies should be included in ajax requests (by default\r\n *  they're not).\r\n *  Set this value to true if you are connecting to a BOSH service\r\n *  and for some reason need to send cookies to it.\r\n *  In order for this to work cross-domain, the server must also enable\r\n *  credentials by setting the Access-Control-Allow-Credentials response header\r\n *  to \"true\". For most usecases however this setting should be false (which\r\n *  is the default).\r\n *  Additionally, when using Access-Control-Allow-Credentials, the\r\n *  Access-Control-Allow-Origin header can't be set to the wildcard \"*\", but\r\n *  instead must be restricted to actual domains.\r\n *\r\n *  The *contentType* option can be set to change the default Content-Type\r\n *  of \"text/xml; charset=utf-8\", which can be useful to reduce the amount of\r\n *  CORS preflight requests that are sent to the server.\r\n *\r\n *  Parameters:\r\n *    (String) service - The BOSH or WebSocket service URL.\r\n *    (Object) options - A hash of configuration options\r\n *\r\n *  Returns:\r\n *    A new Strophe.Connection object.\r\n */\r\nStrophe.Connection = function (service, options) {\r\n    // The service URL\r\n    this.service = service;\r\n    // Configuration options\r\n    this.options = options || {};\r\n    var proto = this.options.protocol || \"\";\r\n\r\n    // Select protocal based on service or options\r\n    if (service.indexOf(\"ws:\") === 0 || service.indexOf(\"wss:\") === 0 ||\r\n            proto.indexOf(\"ws\") === 0) {\r\n        this._proto = new Strophe.Websocket(this);\r\n    } else {\r\n        this._proto = new Strophe.Bosh(this);\r\n    }\r\n\r\n    /* The connected JID. */\r\n    this.jid = \"\";\r\n    /* the JIDs domain */\r\n    this.domain = null;\r\n    /* stream:features */\r\n    this.features = null;\r\n\r\n    // SASL\r\n    this._sasl_data = {};\r\n    this.do_session = false;\r\n    this.do_bind = false;\r\n\r\n    // handler lists\r\n    this.timedHandlers = [];\r\n    this.handlers = [];\r\n    this.removeTimeds = [];\r\n    this.removeHandlers = [];\r\n    this.addTimeds = [];\r\n    this.addHandlers = [];\r\n    this.protocolErrorHandlers = {\r\n        'HTTP': {},\r\n        'websocket': {}\r\n    };\r\n\r\n    this._idleTimeout = null;\r\n    this._disconnectTimeout = null;\r\n\r\n    this.authenticated = false;\r\n    this.connected = false;\r\n    this.disconnecting = false;\r\n    this.do_authentication = true;\r\n    this.paused = false;\r\n    this.restored = false;\r\n\r\n    this._data = [];\r\n    this._uniqueId = 0;\r\n\r\n    this._sasl_success_handler = null;\r\n    this._sasl_failure_handler = null;\r\n    this._sasl_challenge_handler = null;\r\n\r\n    // Max retries before disconnecting\r\n    this.maxRetries = 5;\r\n\r\n    // Call onIdle callback every 1/10th of a second\r\n    // XXX: setTimeout should be called only with function expressions (23974bc1)\r\n    this._idleTimeout = setTimeout(function() {\r\n        this._onIdle();\r\n    }.bind(this), 100);\r\n\r\n    utils.addCookies(this.options.cookies);\r\n    this.registerSASLMechanisms(this.options.mechanisms);\r\n\r\n    // initialize plugins\r\n    for (var k in Strophe._connectionPlugins) {\r\n        if (Strophe._connectionPlugins.hasOwnProperty(k)) {\r\n            var ptype = Strophe._connectionPlugins[k];\r\n            // jslint complaints about the below line, but this is fine\r\n            var F = function () {}; // jshint ignore:line\r\n            F.prototype = ptype;\r\n            this[k] = new F();\r\n            this[k].init(this);\r\n        }\r\n    }\r\n};\r\n\r\nStrophe.Connection.prototype = {\r\n    /** Function: reset\r\n     *  Reset the connection.\r\n     *\r\n     *  This function should be called after a connection is disconnected\r\n     *  before that connection is reused.\r\n     */\r\n    reset: function () {\r\n        this._proto._reset();\r\n\r\n        // SASL\r\n        this.do_session = false;\r\n        this.do_bind = false;\r\n\r\n        // handler lists\r\n        this.timedHandlers = [];\r\n        this.handlers = [];\r\n        this.removeTimeds = [];\r\n        this.removeHandlers = [];\r\n        this.addTimeds = [];\r\n        this.addHandlers = [];\r\n\r\n        this.authenticated = false;\r\n        this.connected = false;\r\n        this.disconnecting = false;\r\n        this.restored = false;\r\n\r\n        this._data = [];\r\n        this._requests = [];\r\n        this._uniqueId = 0;\r\n    },\r\n\r\n    /** Function: pause\r\n     *  Pause the request manager.\r\n     *\r\n     *  This will prevent Strophe from sending any more requests to the\r\n     *  server.  This is very useful for temporarily pausing\r\n     *  BOSH-Connections while a lot of send() calls are happening quickly.\r\n     *  This causes Strophe to send the data in a single request, saving\r\n     *  many request trips.\r\n     */\r\n    pause: function () {\r\n        this.paused = true;\r\n    },\r\n\r\n    /** Function: resume\r\n     *  Resume the request manager.\r\n     *\r\n     *  This resumes after pause() has been called.\r\n     */\r\n    resume: function () {\r\n        this.paused = false;\r\n    },\r\n\r\n    /** Function: getUniqueId\r\n     *  Generate a unique ID for use in <iq/> elements.\r\n     *\r\n     *  All <iq/> stanzas are required to have unique id attributes.  This\r\n     *  function makes creating these easy.  Each connection instance has\r\n     *  a counter which starts from zero, and the value of this counter\r\n     *  plus a colon followed by the suffix becomes the unique id. If no\r\n     *  suffix is supplied, the counter is used as the unique id.\r\n     *\r\n     *  Suffixes are used to make debugging easier when reading the stream\r\n     *  data, and their use is recommended.  The counter resets to 0 for\r\n     *  every new connection for the same reason.  For connections to the\r\n     *  same server that authenticate the same way, all the ids should be\r\n     *  the same, which makes it easy to see changes.  This is useful for\r\n     *  automated testing as well.\r\n     *\r\n     *  Parameters:\r\n     *    (String) suffix - A optional suffix to append to the id.\r\n     *\r\n     *  Returns:\r\n     *    A unique string to be used for the id attribute.\r\n     */\r\n    getUniqueId: function(suffix) {\r\n        var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\r\n            var r = Math.random() * 16 | 0,\r\n                v = c === 'x' ? r : r & 0x3 | 0x8;\r\n            return v.toString(16);\r\n        });\r\n        if (typeof(suffix) === \"string\" || typeof(suffix) === \"number\") {\r\n            return uuid + \":\" + suffix;\r\n        } else {\r\n            return uuid + \"\";\r\n        }\r\n    },\r\n\r\n    /** Function: addProtocolErrorHandler\r\n     *  Register a handler function for when a protocol (websocker or HTTP)\r\n     *  error occurs.\r\n     *\r\n     *  NOTE: Currently only HTTP errors for BOSH requests are handled.\r\n     *  Patches that handle websocket errors would be very welcome.\r\n     *\r\n     *  Parameters:\r\n     *    (String) protocol - 'HTTP' or 'websocket'\r\n     *    (Integer) status_code - Error status code (e.g 500, 400 or 404)\r\n     *    (Function) callback - Function that will fire on Http error\r\n     *\r\n     *  Example:\r\n     *  function onError(err_code){\r\n     *    //do stuff\r\n     *  }\r\n     *\r\n     *  var conn = Strophe.connect('http://example.com/http-bind');\r\n     *  conn.addProtocolErrorHandler('HTTP', 500, onError);\r\n     *  // Triggers HTTP 500 error and onError handler will be called\r\n     *  conn.connect('user_jid@incorrect_jabber_host', 'secret', onConnect);\r\n     */\r\n    addProtocolErrorHandler: function(protocol, status_code, callback){\r\n        this.protocolErrorHandlers[protocol][status_code] = callback;\r\n    },\r\n\r\n\r\n    /** Function: connect\r\n     *  Starts the connection process.\r\n     *\r\n     *  As the connection process proceeds, the user supplied callback will\r\n     *  be triggered multiple times with status updates.  The callback\r\n     *  should take two arguments - the status code and the error condition.\r\n     *\r\n     *  The status code will be one of the values in the Strophe.Status\r\n     *  constants.  The error condition will be one of the conditions\r\n     *  defined in RFC 3920 or the condition 'strophe-parsererror'.\r\n     *\r\n     *  The Parameters _wait_, _hold_ and _route_ are optional and only relevant\r\n     *  for BOSH connections. Please see XEP 124 for a more detailed explanation\r\n     *  of the optional parameters.\r\n     *\r\n     *  Parameters:\r\n     *    (String) jid - The user's JID.  This may be a bare JID,\r\n     *      or a full JID.  If a node is not supplied, SASL OAUTHBEARER or\r\n     *      SASL ANONYMOUS authentication will be attempted (OAUTHBEARER will\r\n     *      process the provided password value as an access token).\r\n     *    (String) pass - The user's password.\r\n     *    (Function) callback - The connect callback function.\r\n     *    (Integer) wait - The optional HTTPBIND wait value.  This is the\r\n     *      time the server will wait before returning an empty result for\r\n     *      a request.  The default setting of 60 seconds is recommended.\r\n     *    (Integer) hold - The optional HTTPBIND hold value.  This is the\r\n     *      number of connections the server will hold at one time.  This\r\n     *      should almost always be set to 1 (the default).\r\n     *    (String) route - The optional route value.\r\n     *    (String) authcid - The optional alternative authentication identity\r\n     *      (username) if intending to impersonate another user.\r\n     *      When using the SASL-EXTERNAL authentication mechanism, for example\r\n     *      with client certificates, then the authcid value is used to\r\n     *      determine whether an authorization JID (authzid) should be sent to\r\n     *      the server. The authzid should not be sent to the server if the\r\n     *      authzid and authcid are the same. So to prevent it from being sent\r\n     *      (for example when the JID is already contained in the client\r\n     *      certificate), set authcid to that same JID. See XEP-178 for more\r\n     *      details.\r\n     */\r\n    connect: function (jid, pass, callback, wait, hold, route, authcid) {\r\n        this.jid = jid;\r\n        /** Variable: authzid\r\n         *  Authorization identity.\r\n         */\r\n        this.authzid = Strophe.getBareJidFromJid(this.jid);\r\n\r\n        /** Variable: authcid\r\n         *  Authentication identity (User name).\r\n         */\r\n        this.authcid = authcid || Strophe.getNodeFromJid(this.jid);\r\n\r\n        /** Variable: pass\r\n         *  Authentication identity (User password).\r\n         */\r\n        this.pass = pass;\r\n\r\n        /** Variable: servtype\r\n         *  Digest MD5 compatibility.\r\n         */\r\n        this.servtype = \"xmpp\";\r\n\r\n        this.connect_callback = callback;\r\n        this.disconnecting = false;\r\n        this.connected = false;\r\n        this.authenticated = false;\r\n        this.restored = false;\r\n\r\n        // parse jid for domain\r\n        this.domain = Strophe.getDomainFromJid(this.jid);\r\n\r\n        this._changeConnectStatus(Strophe.Status.CONNECTING, null);\r\n\r\n        this._proto._connect(wait, hold, route);\r\n    },\r\n\r\n    /** Function: attach\r\n     *  Attach to an already created and authenticated BOSH session.\r\n     *\r\n     *  This function is provided to allow Strophe to attach to BOSH\r\n     *  sessions which have been created externally, perhaps by a Web\r\n     *  application.  This is often used to support auto-login type features\r\n     *  without putting user credentials into the page.\r\n     *\r\n     *  Parameters:\r\n     *    (String) jid - The full JID that is bound by the session.\r\n     *    (String) sid - The SID of the BOSH session.\r\n     *    (String) rid - The current RID of the BOSH session.  This RID\r\n     *      will be used by the next request.\r\n     *    (Function) callback The connect callback function.\r\n     *    (Integer) wait - The optional HTTPBIND wait value.  This is the\r\n     *      time the server will wait before returning an empty result for\r\n     *      a request.  The default setting of 60 seconds is recommended.\r\n     *      Other settings will require tweaks to the Strophe.TIMEOUT value.\r\n     *    (Integer) hold - The optional HTTPBIND hold value.  This is the\r\n     *      number of connections the server will hold at one time.  This\r\n     *      should almost always be set to 1 (the default).\r\n     *    (Integer) wind - The optional HTTBIND window value.  This is the\r\n     *      allowed range of request ids that are valid.  The default is 5.\r\n     */\r\n    attach: function (jid, sid, rid, callback, wait, hold, wind) {\r\n        if (this._proto instanceof Strophe.Bosh) {\r\n            this._proto._attach(jid, sid, rid, callback, wait, hold, wind);\r\n        } else {\r\n            throw {\r\n                name: 'StropheSessionError',\r\n                message: 'The \"attach\" method can only be used with a BOSH connection.'\r\n            };\r\n        }\r\n    },\r\n\r\n    /** Function: restore\r\n     *  Attempt to restore a cached BOSH session.\r\n     *\r\n     *  This function is only useful in conjunction with providing the\r\n     *  \"keepalive\":true option when instantiating a new Strophe.Connection.\r\n     *\r\n     *  When \"keepalive\" is set to true, Strophe will cache the BOSH tokens\r\n     *  RID (Request ID) and SID (Session ID) and then when this function is\r\n     *  called, it will attempt to restore the session from those cached\r\n     *  tokens.\r\n     *\r\n     *  This function must therefore be called instead of connect or attach.\r\n     *\r\n     *  For an example on how to use it, please see examples/restore.js\r\n     *\r\n     *  Parameters:\r\n     *    (String) jid - The user's JID.  This may be a bare JID or a full JID.\r\n     *    (Function) callback - The connect callback function.\r\n     *    (Integer) wait - The optional HTTPBIND wait value.  This is the\r\n     *      time the server will wait before returning an empty result for\r\n     *      a request.  The default setting of 60 seconds is recommended.\r\n     *    (Integer) hold - The optional HTTPBIND hold value.  This is the\r\n     *      number of connections the server will hold at one time.  This\r\n     *      should almost always be set to 1 (the default).\r\n     *    (Integer) wind - The optional HTTBIND window value.  This is the\r\n     *      allowed range of request ids that are valid.  The default is 5.\r\n     */\r\n    restore: function (jid, callback, wait, hold, wind) {\r\n        if (this._sessionCachingSupported()) {\r\n            this._proto._restore(jid, callback, wait, hold, wind);\r\n        } else {\r\n            throw {\r\n                name: 'StropheSessionError',\r\n                message: 'The \"restore\" method can only be used with a BOSH connection.'\r\n            };\r\n        }\r\n    },\r\n\r\n    /** PrivateFunction: _sessionCachingSupported\r\n     * Checks whether sessionStorage and JSON are supported and whether we're\r\n     * using BOSH.\r\n     */\r\n    _sessionCachingSupported: function () {\r\n        if (this._proto instanceof Strophe.Bosh) {\r\n            if (!JSON) { return false; }\r\n            try {\r\n                sessionStorage.setItem('_strophe_', '_strophe_');\r\n                sessionStorage.removeItem('_strophe_');\r\n            } catch (e) {\r\n                return false;\r\n            }\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n\r\n    /** Function: xmlInput\r\n     *  User overrideable function that receives XML data coming into the\r\n     *  connection.\r\n     *\r\n     *  The default function does nothing.  User code can override this with\r\n     *  > Strophe.Connection.xmlInput = function (elem) {\r\n     *  >   (user code)\r\n     *  > };\r\n     *\r\n     *  Due to limitations of current Browsers' XML-Parsers the opening and closing\r\n     *  <stream> tag for WebSocket-Connoctions will be passed as selfclosing here.\r\n     *\r\n     *  BOSH-Connections will have all stanzas wrapped in a <body> tag. See\r\n     *  <Strophe.Bosh.strip> if you want to strip this tag.\r\n     *\r\n     *  Parameters:\r\n     *    (XMLElement) elem - The XML data received by the connection.\r\n     */\r\n    /* jshint unused:false */\r\n    xmlInput: function (elem) {\r\n        return;\r\n    },\r\n    /* jshint unused:true */\r\n\r\n    /** Function: xmlOutput\r\n     *  User overrideable function that receives XML data sent to the\r\n     *  connection.\r\n     *\r\n     *  The default function does nothing.  User code can override this with\r\n     *  > Strophe.Connection.xmlOutput = function (elem) {\r\n     *  >   (user code)\r\n     *  > };\r\n     *\r\n     *  Due to limitations of current Browsers' XML-Parsers the opening and closing\r\n     *  <stream> tag for WebSocket-Connoctions will be passed as selfclosing here.\r\n     *\r\n     *  BOSH-Connections will have all stanzas wrapped in a <body> tag. See\r\n     *  <Strophe.Bosh.strip> if you want to strip this tag.\r\n     *\r\n     *  Parameters:\r\n     *    (XMLElement) elem - The XMLdata sent by the connection.\r\n     */\r\n    /* jshint unused:false */\r\n    xmlOutput: function (elem) {\r\n        return;\r\n    },\r\n    /* jshint unused:true */\r\n\r\n    /** Function: rawInput\r\n     *  User overrideable function that receives raw data coming into the\r\n     *  connection.\r\n     *\r\n     *  The default function does nothing.  User code can override this with\r\n     *  > Strophe.Connection.rawInput = function (data) {\r\n     *  >   (user code)\r\n     *  > };\r\n     *\r\n     *  Parameters:\r\n     *    (String) data - The data received by the connection.\r\n     */\r\n    /* jshint unused:false */\r\n    rawInput: function (data) {\r\n        return;\r\n    },\r\n    /* jshint unused:true */\r\n\r\n    /** Function: rawOutput\r\n     *  User overrideable function that receives raw data sent to the\r\n     *  connection.\r\n     *\r\n     *  The default function does nothing.  User code can override this with\r\n     *  > Strophe.Connection.rawOutput = function (data) {\r\n     *  >   (user code)\r\n     *  > };\r\n     *\r\n     *  Parameters:\r\n     *    (String) data - The data sent by the connection.\r\n     */\r\n    /* jshint unused:false */\r\n    rawOutput: function (data) {\r\n        return;\r\n    },\r\n    /* jshint unused:true */\r\n\r\n    /** Function: nextValidRid\r\n     *  User overrideable function that receives the new valid rid.\r\n     *\r\n     *  The default function does nothing. User code can override this with\r\n     *  > Strophe.Connection.nextValidRid = function (rid) {\r\n     *  >    (user code)\r\n     *  > };\r\n     *\r\n     *  Parameters:\r\n     *    (Number) rid - The next valid rid\r\n     */\r\n    /* jshint unused:false */\r\n    nextValidRid: function (rid) {\r\n        return;\r\n    },\r\n    /* jshint unused:true */\r\n\r\n    /** Function: send\r\n     *  Send a stanza.\r\n     *\r\n     *  This function is called to push data onto the send queue to\r\n     *  go out over the wire.  Whenever a request is sent to the BOSH\r\n     *  server, all pending data is sent and the queue is flushed.\r\n     *\r\n     *  Parameters:\r\n     *    (XMLElement |\r\n     *     [XMLElement] |\r\n     *     Strophe.Builder) elem - The stanza to send.\r\n     */\r\n    send: function (elem) {\r\n        if (elem === null) { return ; }\r\n        if (typeof(elem.sort) === \"function\") {\r\n            for (var i = 0; i < elem.length; i++) {\r\n                this._queueData(elem[i]);\r\n            }\r\n        } else if (typeof(elem.tree) === \"function\") {\r\n            this._queueData(elem.tree());\r\n        } else {\r\n            this._queueData(elem);\r\n        }\r\n\r\n        this._proto._send();\r\n    },\r\n\r\n    /** Function: flush\r\n     *  Immediately send any pending outgoing data.\r\n     *\r\n     *  Normally send() queues outgoing data until the next idle period\r\n     *  (100ms), which optimizes network use in the common cases when\r\n     *  several send()s are called in succession. flush() can be used to\r\n     *  immediately send all pending data.\r\n     */\r\n    flush: function () {\r\n        // cancel the pending idle period and run the idle function\r\n        // immediately\r\n        clearTimeout(this._idleTimeout);\r\n        this._onIdle();\r\n    },\r\n\r\n    /** Function: sendPresence\r\n     *  Helper function to send presence stanzas. The main benefit is for\r\n     *  sending presence stanzas for which you expect a responding presence\r\n     *  stanza with the same id (for example when leaving a chat room).\r\n     *\r\n     *  Parameters:\r\n     *    (XMLElement) elem - The stanza to send.\r\n     *    (Function) callback - The callback function for a successful request.\r\n     *    (Function) errback - The callback function for a failed or timed\r\n     *      out request.  On timeout, the stanza will be null.\r\n     *    (Integer) timeout - The time specified in milliseconds for a\r\n     *      timeout to occur.\r\n     *\r\n     *  Returns:\r\n     *    The id used to send the presence.\r\n     */\r\n    sendPresence: function(elem, callback, errback, timeout) {\r\n        var timeoutHandler = null;\r\n        var that = this;\r\n        if (typeof(elem.tree) === \"function\") {\r\n            elem = elem.tree();\r\n        }\r\n        var id = elem.getAttribute('id');\r\n        if (!id) { // inject id if not found\r\n            id = this.getUniqueId(\"sendPresence\");\r\n            elem.setAttribute(\"id\", id);\r\n        }\r\n\r\n        if (typeof callback === \"function\" || typeof errback === \"function\") {\r\n            var handler = this.addHandler(function (stanza) {\r\n                // remove timeout handler if there is one\r\n                if (timeoutHandler) {\r\n                    that.deleteTimedHandler(timeoutHandler);\r\n                }\r\n                var type = stanza.getAttribute('type');\r\n                if (type === 'error') {\r\n                    if (errback) {\r\n                        errback(stanza);\r\n                    }\r\n                } else if (callback) {\r\n                    callback(stanza);\r\n                }\r\n            }, null, 'presence', null, id);\r\n\r\n            // if timeout specified, set up a timeout handler.\r\n            if (timeout) {\r\n                timeoutHandler = this.addTimedHandler(timeout, function () {\r\n                    // get rid of normal handler\r\n                    that.deleteHandler(handler);\r\n                    // call errback on timeout with null stanza\r\n                    if (errback) {\r\n                        errback(null);\r\n                    }\r\n                    return false;\r\n                });\r\n            }\r\n        }\r\n        this.send(elem);\r\n        return id;\r\n    },\r\n\r\n    /** Function: sendIQ\r\n     *  Helper function to send IQ stanzas.\r\n     *\r\n     *  Parameters:\r\n     *    (XMLElement) elem - The stanza to send.\r\n     *    (Function) callback - The callback function for a successful request.\r\n     *    (Function) errback - The callback function for a failed or timed\r\n     *      out request.  On timeout, the stanza will be null.\r\n     *    (Integer) timeout - The time specified in milliseconds for a\r\n     *      timeout to occur.\r\n     *\r\n     *  Returns:\r\n     *    The id used to send the IQ.\r\n    */\r\n    sendIQ: function(elem, callback, errback, timeout) {\r\n        var timeoutHandler = null;\r\n        var that = this;\r\n        if (typeof(elem.tree) === \"function\") {\r\n            elem = elem.tree();\r\n        }\r\n        var id = elem.getAttribute('id');\r\n        if (!id) { // inject id if not found\r\n            id = this.getUniqueId(\"sendIQ\");\r\n            elem.setAttribute(\"id\", id);\r\n        }\r\n\r\n        if (typeof callback === \"function\" || typeof errback === \"function\") {\r\n            var handler = this.addHandler(function (stanza) {\r\n                // remove timeout handler if there is one\r\n                if (timeoutHandler) {\r\n                    that.deleteTimedHandler(timeoutHandler);\r\n                }\r\n                var iqtype = stanza.getAttribute('type');\r\n                if (iqtype === 'result') {\r\n                    if (callback) {\r\n                        callback(stanza);\r\n                    }\r\n                } else if (iqtype === 'error') {\r\n                    if (errback) {\r\n                        errback(stanza);\r\n                    }\r\n                } else {\r\n                    throw {\r\n                        name: \"StropheError\",\r\n                        message: \"Got bad IQ type of \" + iqtype\r\n                    };\r\n                }\r\n            }, null, 'iq', ['error', 'result'], id);\r\n\r\n            // if timeout specified, set up a timeout handler.\r\n            if (timeout) {\r\n                timeoutHandler = this.addTimedHandler(timeout, function () {\r\n                    // get rid of normal handler\r\n                    that.deleteHandler(handler);\r\n                    // call errback on timeout with null stanza\r\n                    if (errback) {\r\n                        errback(null);\r\n                    }\r\n                    return false;\r\n                });\r\n            }\r\n        }\r\n        this.send(elem);\r\n        return id;\r\n    },\r\n\r\n    /** PrivateFunction: _queueData\r\n     *  Queue outgoing data for later sending.  Also ensures that the data\r\n     *  is a DOMElement.\r\n     */\r\n    _queueData: function (element) {\r\n        if (element === null ||\r\n            !element.tagName ||\r\n            !element.childNodes) {\r\n            throw {\r\n                name: \"StropheError\",\r\n                message: \"Cannot queue non-DOMElement.\"\r\n            };\r\n        }\r\n        this._data.push(element);\r\n    },\r\n\r\n    /** PrivateFunction: _sendRestart\r\n     *  Send an xmpp:restart stanza.\r\n     */\r\n    _sendRestart: function () {\r\n        this._data.push(\"restart\");\r\n        this._proto._sendRestart();\r\n        // XXX: setTimeout should be called only with function expressions (23974bc1)\r\n        this._idleTimeout = setTimeout(function() {\r\n            this._onIdle();\r\n        }.bind(this), 100);\r\n    },\r\n\r\n    /** Function: addTimedHandler\r\n     *  Add a timed handler to the connection.\r\n     *\r\n     *  This function adds a timed handler.  The provided handler will\r\n     *  be called every period milliseconds until it returns false,\r\n     *  the connection is terminated, or the handler is removed.  Handlers\r\n     *  that wish to continue being invoked should return true.\r\n     *\r\n     *  Because of method binding it is necessary to save the result of\r\n     *  this function if you wish to remove a handler with\r\n     *  deleteTimedHandler().\r\n     *\r\n     *  Note that user handlers are not active until authentication is\r\n     *  successful.\r\n     *\r\n     *  Parameters:\r\n     *    (Integer) period - The period of the handler.\r\n     *    (Function) handler - The callback function.\r\n     *\r\n     *  Returns:\r\n     *    A reference to the handler that can be used to remove it.\r\n     */\r\n    addTimedHandler: function (period, handler) {\r\n        var thand = new Strophe.TimedHandler(period, handler);\r\n        this.addTimeds.push(thand);\r\n        return thand;\r\n    },\r\n\r\n    /** Function: deleteTimedHandler\r\n     *  Delete a timed handler for a connection.\r\n     *\r\n     *  This function removes a timed handler from the connection.  The\r\n     *  handRef parameter is *not* the function passed to addTimedHandler(),\r\n     *  but is the reference returned from addTimedHandler().\r\n     *\r\n     *  Parameters:\r\n     *    (Strophe.TimedHandler) handRef - The handler reference.\r\n     */\r\n    deleteTimedHandler: function (handRef) {\r\n        // this must be done in the Idle loop so that we don't change\r\n        // the handlers during iteration\r\n        this.removeTimeds.push(handRef);\r\n    },\r\n\r\n    /** Function: addHandler\r\n     *  Add a stanza handler for the connection.\r\n     *\r\n     *  This function adds a stanza handler to the connection.  The\r\n     *  handler callback will be called for any stanza that matches\r\n     *  the parameters.  Note that if multiple parameters are supplied,\r\n     *  they must all match for the handler to be invoked.\r\n     *\r\n     *  The handler will receive the stanza that triggered it as its argument.\r\n     *  *The handler should return true if it is to be invoked again;\r\n     *  returning false will remove the handler after it returns.*\r\n     *\r\n     *  As a convenience, the ns parameters applies to the top level element\r\n     *  and also any of its immediate children.  This is primarily to make\r\n     *  matching /iq/query elements easy.\r\n     *\r\n     *  Options\r\n     *  ~~~~~~~\r\n     *  With the options argument, you can specify boolean flags that affect how\r\n     *  matches are being done.\r\n     *\r\n     *  Currently two flags exist:\r\n     *\r\n     *  - matchBareFromJid:\r\n     *      When set to true, the from parameter and the\r\n     *      from attribute on the stanza will be matched as bare JIDs instead\r\n     *      of full JIDs. To use this, pass {matchBareFromJid: true} as the\r\n     *      value of options. The default value for matchBareFromJid is false.\r\n     *\r\n     *  - ignoreNamespaceFragment:\r\n     *      When set to true, a fragment specified on the stanza's namespace\r\n     *      URL will be ignored when it's matched with the one configured for\r\n     *      the handler.\r\n     *\r\n     *      This means that if you register like this:\r\n     *      >   connection.addHandler(\r\n     *      >       handler,\r\n     *      >       'http://jabber.org/protocol/muc',\r\n     *      >       null, null, null, null,\r\n     *      >       {'ignoreNamespaceFragment': true}\r\n     *      >   );\r\n     *\r\n     *      Then a stanza with XML namespace of\r\n     *      'http://jabber.org/protocol/muc#user' will also be matched. If\r\n     *      'ignoreNamespaceFragment' is false, then only stanzas with\r\n     *      'http://jabber.org/protocol/muc' will be matched.\r\n     *\r\n     *  Deleting the handler\r\n     *  ~~~~~~~~~~~~~~~~~~~~\r\n     *  The return value should be saved if you wish to remove the handler\r\n     *  with deleteHandler().\r\n     *\r\n     *  Parameters:\r\n     *    (Function) handler - The user callback.\r\n     *    (String) ns - The namespace to match.\r\n     *    (String) name - The stanza name to match.\r\n     *    (String|Array) type - The stanza type (or types if an array) to match.\r\n     *    (String) id - The stanza id attribute to match.\r\n     *    (String) from - The stanza from attribute to match.\r\n     *    (String) options - The handler options\r\n     *\r\n     *  Returns:\r\n     *    A reference to the handler that can be used to remove it.\r\n     */\r\n    addHandler: function (handler, ns, name, type, id, from, options) {\r\n        var hand = new Strophe.Handler(handler, ns, name, type, id, from, options);\r\n        this.addHandlers.push(hand);\r\n        return hand;\r\n    },\r\n\r\n    /** Function: deleteHandler\r\n     *  Delete a stanza handler for a connection.\r\n     *\r\n     *  This function removes a stanza handler from the connection.  The\r\n     *  handRef parameter is *not* the function passed to addHandler(),\r\n     *  but is the reference returned from addHandler().\r\n     *\r\n     *  Parameters:\r\n     *    (Strophe.Handler) handRef - The handler reference.\r\n     */\r\n    deleteHandler: function (handRef) {\r\n        // this must be done in the Idle loop so that we don't change\r\n        // the handlers during iteration\r\n        this.removeHandlers.push(handRef);\r\n        // If a handler is being deleted while it is being added,\r\n        // prevent it from getting added\r\n        var i = this.addHandlers.indexOf(handRef);\r\n        if (i >= 0) {\r\n            this.addHandlers.splice(i, 1);\r\n        }\r\n    },\r\n\r\n    /** Function: registerSASLMechanisms\r\n     *\r\n     * Register the SASL mechanisms which will be supported by this instance of\r\n     * Strophe.Connection (i.e. which this XMPP client will support).\r\n     *\r\n     *  Parameters:\r\n     *    (Array) mechanisms - Array of objects with Strophe.SASLMechanism prototypes\r\n     *\r\n     */\r\n    registerSASLMechanisms: function (mechanisms) {\r\n        this.mechanisms = {};\r\n        mechanisms = mechanisms || [\r\n            Strophe.SASLAnonymous,\r\n            Strophe.SASLExternal,\r\n            Strophe.SASLMD5,\r\n            Strophe.SASLOAuthBearer,\r\n            Strophe.SASLXOAuth2,\r\n            Strophe.SASLPlain,\r\n            Strophe.SASLSHA1\r\n        ];\r\n        mechanisms.forEach(this.registerSASLMechanism.bind(this));\r\n    },\r\n\r\n    /** Function: registerSASLMechanism\r\n     *\r\n     * Register a single SASL mechanism, to be supported by this client.\r\n     *\r\n     *  Parameters:\r\n     *    (Object) mechanism - Object with a Strophe.SASLMechanism prototype\r\n     *\r\n     */\r\n    registerSASLMechanism: function (mechanism) {\r\n        this.mechanisms[mechanism.prototype.name] = mechanism;\r\n    },\r\n\r\n    /** Function: disconnect\r\n     *  Start the graceful disconnection process.\r\n     *\r\n     *  This function starts the disconnection process.  This process starts\r\n     *  by sending unavailable presence and sending BOSH body of type\r\n     *  terminate.  A timeout handler makes sure that disconnection happens\r\n     *  even if the BOSH server does not respond.\r\n     *  If the Connection object isn't connected, at least tries to abort all pending requests\r\n     *  so the connection object won't generate successful requests (which were already opened).\r\n     *\r\n     *  The user supplied connection callback will be notified of the\r\n     *  progress as this process happens.\r\n     *\r\n     *  Parameters:\r\n     *    (String) reason - The reason the disconnect is occuring.\r\n     */\r\n    disconnect: function (reason) {\r\n        this._changeConnectStatus(Strophe.Status.DISCONNECTING, reason);\r\n\r\n        Strophe.info(\"Disconnect was called because: \" + reason);\r\n        if (this.connected) {\r\n            var pres = false;\r\n            this.disconnecting = true;\r\n            if (this.authenticated) {\r\n                pres = $pres({\r\n                    xmlns: Strophe.NS.CLIENT,\r\n                    type: 'unavailable'\r\n                });\r\n            }\r\n            // setup timeout handler\r\n            this._disconnectTimeout = this._addSysTimedHandler(\r\n                3000, this._onDisconnectTimeout.bind(this));\r\n            this._proto._disconnect(pres);\r\n        } else {\r\n            Strophe.info(\"Disconnect was called before Strophe connected to the server\");\r\n            this._proto._abortAllRequests();\r\n            this._doDisconnect();\r\n        }\r\n    },\r\n\r\n    /** PrivateFunction: _changeConnectStatus\r\n     *  _Private_ helper function that makes sure plugins and the user's\r\n     *  callback are notified of connection status changes.\r\n     *\r\n     *  Parameters:\r\n     *    (Integer) status - the new connection status, one of the values\r\n     *      in Strophe.Status\r\n     *    (String) condition - the error condition or null\r\n     *    (XMLElement) elem - The triggering stanza.\r\n     */\r\n    _changeConnectStatus: function (status, condition, elem) {\r\n        // notify all plugins listening for status changes\r\n        for (var k in Strophe._connectionPlugins) {\r\n            if (Strophe._connectionPlugins.hasOwnProperty(k)) {\r\n                var plugin = this[k];\r\n                if (plugin.statusChanged) {\r\n                    try {\r\n                        plugin.statusChanged(status, condition);\r\n                    } catch (err) {\r\n                        Strophe.error(\"\" + k + \" plugin caused an exception \" +\r\n                                      \"changing status: \" + err);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // notify the user's callback\r\n        if (this.connect_callback) {\r\n            try {\r\n                this.connect_callback(status, condition, elem);\r\n            } catch (e) {\r\n                Strophe._handleError(e);\r\n                Strophe.error(\r\n                    \"User connection callback caused an \"+\"exception: \"+e);\r\n            }\r\n        }\r\n    },\r\n\r\n    /** PrivateFunction: _doDisconnect\r\n     *  _Private_ function to disconnect.\r\n     *\r\n     *  This is the last piece of the disconnection logic.  This resets the\r\n     *  connection and alerts the user's connection callback.\r\n     */\r\n    _doDisconnect: function (condition) {\r\n        if (typeof this._idleTimeout === \"number\") {\r\n            clearTimeout(this._idleTimeout);\r\n        }\r\n\r\n        // Cancel Disconnect Timeout\r\n        if (this._disconnectTimeout !== null) {\r\n            this.deleteTimedHandler(this._disconnectTimeout);\r\n            this._disconnectTimeout = null;\r\n        }\r\n\r\n        Strophe.info(\"_doDisconnect was called\");\r\n        this._proto._doDisconnect();\r\n\r\n        this.authenticated = false;\r\n        this.disconnecting = false;\r\n        this.restored = false;\r\n\r\n        // delete handlers\r\n        this.handlers = [];\r\n        this.timedHandlers = [];\r\n        this.removeTimeds = [];\r\n        this.removeHandlers = [];\r\n        this.addTimeds = [];\r\n        this.addHandlers = [];\r\n\r\n        // tell the parent we disconnected\r\n        this._changeConnectStatus(Strophe.Status.DISCONNECTED, condition);\r\n        this.connected = false;\r\n    },\r\n\r\n    /** PrivateFunction: _dataRecv\r\n     *  _Private_ handler to processes incoming data from the the connection.\r\n     *\r\n     *  Except for _connect_cb handling the initial connection request,\r\n     *  this function handles the incoming data for all requests.  This\r\n     *  function also fires stanza handlers that match each incoming\r\n     *  stanza.\r\n     *\r\n     *  Parameters:\r\n     *    (Strophe.Request) req - The request that has data ready.\r\n     *    (string) req - The stanza a raw string (optiona).\r\n     */\r\n    _dataRecv: function (req, raw) {\r\n        Strophe.info(\"_dataRecv called\");\r\n        var elem = this._proto._reqToData(req);\r\n        if (elem === null) { return; }\r\n\r\n        if (this.xmlInput !== Strophe.Connection.prototype.xmlInput) {\r\n            if (elem.nodeName === this._proto.strip && elem.childNodes.length) {\r\n                this.xmlInput(elem.childNodes[0]);\r\n            } else {\r\n                this.xmlInput(elem);\r\n            }\r\n        }\r\n        if (this.rawInput !== Strophe.Connection.prototype.rawInput) {\r\n            if (raw) {\r\n                this.rawInput(raw);\r\n            } else {\r\n                this.rawInput(Strophe.serialize(elem));\r\n            }\r\n        }\r\n\r\n        // remove handlers scheduled for deletion\r\n        var i, hand;\r\n        while (this.removeHandlers.length > 0) {\r\n            hand = this.removeHandlers.pop();\r\n            i = this.handlers.indexOf(hand);\r\n            if (i >= 0) {\r\n                this.handlers.splice(i, 1);\r\n            }\r\n        }\r\n\r\n        // add handlers scheduled for addition\r\n        while (this.addHandlers.length > 0) {\r\n            this.handlers.push(this.addHandlers.pop());\r\n        }\r\n\r\n        // handle graceful disconnect\r\n        if (this.disconnecting && this._proto._emptyQueue()) {\r\n            this._doDisconnect();\r\n            return;\r\n        }\r\n\r\n        var type = elem.getAttribute(\"type\");\r\n        var cond, conflict;\r\n        if (type !== null && type === \"terminate\") {\r\n            // Don't process stanzas that come in after disconnect\r\n            if (this.disconnecting) {\r\n                return;\r\n            }\r\n\r\n            // an error occurred\r\n            cond = elem.getAttribute(\"condition\");\r\n            conflict = elem.getElementsByTagName(\"conflict\");\r\n            if (cond !== null) {\r\n                if (cond === \"remote-stream-error\" && conflict.length > 0) {\r\n                    cond = \"conflict\";\r\n                }\r\n                this._changeConnectStatus(Strophe.Status.CONNFAIL, cond);\r\n            } else {\r\n                this._changeConnectStatus(\r\n                    Strophe.Status.CONNFAIL,\r\n                    Strophe.ErrorCondition.UNKOWN_REASON\r\n                );\r\n            }\r\n            this._doDisconnect(cond);\r\n            return;\r\n        }\r\n\r\n        // send each incoming stanza through the handler chain\r\n        var that = this;\r\n        Strophe.forEachChild(elem, null, function (child) {\r\n            var i, newList;\r\n            // process handlers\r\n            newList = that.handlers;\r\n            that.handlers = [];\r\n            for (i = 0; i < newList.length; i++) {\r\n                var hand = newList[i];\r\n                // encapsulate 'handler.run' not to lose the whole handler list if\r\n                // one of the handlers throws an exception\r\n                try {\r\n                    if (hand.isMatch(child) &&\r\n                        (that.authenticated || !hand.user)) {\r\n                        if (hand.run(child)) {\r\n                            that.handlers.push(hand);\r\n                        }\r\n                    } else {\r\n                        that.handlers.push(hand);\r\n                    }\r\n                } catch(e) {\r\n                    // if the handler throws an exception, we consider it as false\r\n                    Strophe.warn('Removing Strophe handlers due to uncaught exception: '+e.message);\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n\r\n    /** Attribute: mechanisms\r\n     *  SASL Mechanisms available for Connection.\r\n     */\r\n    mechanisms: {},\r\n\r\n    /** PrivateFunction: _no_auth_received\r\n     *\r\n     * Called on stream start/restart when no stream:features\r\n     * has been received or when no viable authentication mechanism is offered.\r\n     *\r\n     * Sends a blank poll request.\r\n     */\r\n    _no_auth_received: function (_callback) {\r\n        var error_msg =  \"Server did not offer a supported authentication mechanism\";\r\n        Strophe.error(error_msg);\r\n        this._changeConnectStatus(\r\n            Strophe.Status.CONNFAIL,\r\n            Strophe.ErrorCondition.NO_AUTH_MECH\r\n        );\r\n        if (_callback) {\r\n            _callback.call(this);\r\n        }\r\n        this._doDisconnect();\r\n    },\r\n\r\n    /** PrivateFunction: _connect_cb\r\n     *  _Private_ handler for initial connection request.\r\n     *\r\n     *  This handler is used to process the initial connection request\r\n     *  response from the BOSH server. It is used to set up authentication\r\n     *  handlers and start the authentication process.\r\n     *\r\n     *  SASL authentication will be attempted if available, otherwise\r\n     *  the code will fall back to legacy authentication.\r\n     *\r\n     *  Parameters:\r\n     *    (Strophe.Request) req - The current request.\r\n     *    (Function) _callback - low level (xmpp) connect callback function.\r\n     *      Useful for plugins with their own xmpp connect callback (when they\r\n     *      want to do something special).\r\n     */\r\n    _connect_cb: function (req, _callback, raw) {\r\n        Strophe.info(\"_connect_cb was called\");\r\n        this.connected = true;\r\n\r\n        var bodyWrap;\r\n        try {\r\n            bodyWrap = this._proto._reqToData(req);\r\n        } catch (e) {\r\n            if (e !== \"badformat\") { throw e; }\r\n            this._changeConnectStatus(\r\n                Strophe.Status.CONNFAIL,\r\n                Strophe.ErrorCondition.BAD_FORMAT\r\n            );\r\n            this._doDisconnect(Strophe.ErrorCondition.BAD_FORMAT);\r\n        }\r\n        if (!bodyWrap) { return; }\r\n\r\n        if (this.xmlInput !== Strophe.Connection.prototype.xmlInput) {\r\n            if (bodyWrap.nodeName === this._proto.strip && bodyWrap.childNodes.length) {\r\n                this.xmlInput(bodyWrap.childNodes[0]);\r\n            } else {\r\n                this.xmlInput(bodyWrap);\r\n            }\r\n        }\r\n        if (this.rawInput !== Strophe.Connection.prototype.rawInput) {\r\n            if (raw) {\r\n                this.rawInput(raw);\r\n            } else {\r\n                this.rawInput(Strophe.serialize(bodyWrap));\r\n            }\r\n        }\r\n\r\n        var conncheck = this._proto._connect_cb(bodyWrap);\r\n        if (conncheck === Strophe.Status.CONNFAIL) {\r\n            return;\r\n        }\r\n\r\n        // Check for the stream:features tag\r\n        var hasFeatures;\r\n        if (bodyWrap.getElementsByTagNameNS) {\r\n            hasFeatures = bodyWrap.getElementsByTagNameNS(Strophe.NS.STREAM, \"features\").length > 0;\r\n        } else {\r\n            hasFeatures = bodyWrap.getElementsByTagName(\"stream:features\").length > 0 ||\r\n                            bodyWrap.getElementsByTagName(\"features\").length > 0;\r\n        }\r\n        if (!hasFeatures) {\r\n            this._no_auth_received(_callback);\r\n            return;\r\n        }\r\n\r\n        var matched = [], i, mech;\r\n        var mechanisms = bodyWrap.getElementsByTagName(\"mechanism\");\r\n        if (mechanisms.length > 0) {\r\n            for (i = 0; i < mechanisms.length; i++) {\r\n                mech = Strophe.getText(mechanisms[i]);\r\n                if (this.mechanisms[mech]) matched.push(this.mechanisms[mech]);\r\n            }\r\n        }\r\n        if (matched.length === 0) {\r\n            if (bodyWrap.getElementsByTagName(\"auth\").length === 0) {\r\n                // There are no matching SASL mechanisms and also no legacy\r\n                // auth available.\r\n                this._no_auth_received(_callback);\r\n                return;\r\n            }\r\n        }\r\n        if (this.do_authentication !== false) {\r\n            this.authenticate(matched);\r\n        }\r\n    },\r\n\r\n    /** Function: sortMechanismsByPriority\r\n     *\r\n     *  Sorts an array of objects with prototype SASLMechanism according to\r\n     *  their priorities.\r\n     *\r\n     *  Parameters:\r\n     *    (Array) mechanisms - Array of SASL mechanisms.\r\n     *\r\n     */\r\n    sortMechanismsByPriority: function (mechanisms) {\r\n        // Sorting mechanisms according to priority.\r\n        var i, j, higher, swap;\r\n        for (i = 0; i < mechanisms.length - 1; ++i) {\r\n            higher = i;\r\n            for (j = i + 1; j < mechanisms.length; ++j) {\r\n                if (mechanisms[j].prototype.priority > mechanisms[higher].prototype.priority) {\r\n                    higher = j;\r\n                }\r\n            }\r\n            if (higher !== i) {\r\n                swap = mechanisms[i];\r\n                mechanisms[i] = mechanisms[higher];\r\n                mechanisms[higher] = swap;\r\n            }\r\n        }\r\n        return mechanisms;\r\n    },\r\n\r\n    /** PrivateFunction: _attemptSASLAuth\r\n     *\r\n     *  Iterate through an array of SASL mechanisms and attempt authentication\r\n     *  with the highest priority (enabled) mechanism.\r\n     *\r\n     *  Parameters:\r\n     *    (Array) mechanisms - Array of SASL mechanisms.\r\n     *\r\n     *  Returns:\r\n     *    (Boolean) mechanism_found - true or false, depending on whether a\r\n     *          valid SASL mechanism was found with which authentication could be\r\n     *          started.\r\n     */\r\n    _attemptSASLAuth: function (mechanisms) {\r\n        mechanisms = this.sortMechanismsByPriority(mechanisms || []);\r\n        var i = 0, mechanism_found = false;\r\n        for (i = 0; i < mechanisms.length; ++i) {\r\n            if (!mechanisms[i].prototype.test(this)) {\r\n                continue;\r\n            }\r\n            this._sasl_success_handler = this._addSysHandler(\r\n                this._sasl_success_cb.bind(this), null,\r\n                \"success\", null, null);\r\n            this._sasl_failure_handler = this._addSysHandler(\r\n                this._sasl_failure_cb.bind(this), null,\r\n                \"failure\", null, null);\r\n            this._sasl_challenge_handler = this._addSysHandler(\r\n                this._sasl_challenge_cb.bind(this), null,\r\n                \"challenge\", null, null);\r\n\r\n            this._sasl_mechanism = new mechanisms[i]();\r\n            this._sasl_mechanism.onStart(this);\r\n\r\n            var request_auth_exchange = $build(\"auth\", {\r\n                xmlns: Strophe.NS.SASL,\r\n                mechanism: this._sasl_mechanism.name\r\n            });\r\n            if (this._sasl_mechanism.isClientFirst) {\r\n                var response = this._sasl_mechanism.onChallenge(this, null);\r\n                request_auth_exchange.t(btoa(response));\r\n            }\r\n            this.send(request_auth_exchange.tree());\r\n            mechanism_found = true;\r\n            break;\r\n        }\r\n        return mechanism_found;\r\n    },\r\n\r\n    /** PrivateFunction: _attemptLegacyAuth\r\n     *\r\n     *  Attempt legacy (i.e. non-SASL) authentication.\r\n     *\r\n     */\r\n    _attemptLegacyAuth: function () {\r\n        if (Strophe.getNodeFromJid(this.jid) === null) {\r\n            // we don't have a node, which is required for non-anonymous\r\n            // client connections\r\n            this._changeConnectStatus(\r\n                Strophe.Status.CONNFAIL,\r\n                Strophe.ErrorCondition.MISSING_JID_NODE\r\n            );\r\n            this.disconnect(Strophe.ErrorCondition.MISSING_JID_NODE);\r\n        } else {\r\n            // Fall back to legacy authentication\r\n            this._changeConnectStatus(Strophe.Status.AUTHENTICATING, null);\r\n            this._addSysHandler(\r\n                this._auth1_cb.bind(this),\r\n                null, null, null, \"_auth_1\"\r\n            );\r\n            this.send($iq({\r\n                    'type': \"get\",\r\n                    'to': this.domain,\r\n                    'id': \"_auth_1\"\r\n                }).c(\"query\", {xmlns: Strophe.NS.AUTH})\r\n                .c(\"username\", {}).t(Strophe.getNodeFromJid(this.jid))\r\n                .tree());\r\n        }\r\n    },\r\n\r\n    /** Function: authenticate\r\n     * Set up authentication\r\n     *\r\n     *  Continues the initial connection request by setting up authentication\r\n     *  handlers and starting the authentication process.\r\n     *\r\n     *  SASL authentication will be attempted if available, otherwise\r\n     *  the code will fall back to legacy authentication.\r\n     *\r\n     *  Parameters:\r\n     *    (Array) matched - Array of SASL mechanisms supported.\r\n     *\r\n     */\r\n    authenticate: function (matched) {\r\n        if (!this._attemptSASLAuth(matched)) {\r\n            this._attemptLegacyAuth();\r\n        }\r\n    },\r\n\r\n    /** PrivateFunction: _sasl_challenge_cb\r\n     *  _Private_ handler for the SASL challenge\r\n     *\r\n     */\r\n    _sasl_challenge_cb: function(elem) {\r\n      var challenge = atob(Strophe.getText(elem));\r\n      var response = this._sasl_mechanism.onChallenge(this, challenge);\r\n      var stanza = $build('response', {\r\n          'xmlns': Strophe.NS.SASL\r\n      });\r\n      if (response !== \"\") {\r\n        stanza.t(btoa(response));\r\n      }\r\n      this.send(stanza.tree());\r\n      return true;\r\n    },\r\n\r\n    /** PrivateFunction: _auth1_cb\r\n     *  _Private_ handler for legacy authentication.\r\n     *\r\n     *  This handler is called in response to the initial <iq type='get'/>\r\n     *  for legacy authentication.  It builds an authentication <iq/> and\r\n     *  sends it, creating a handler (calling back to _auth2_cb()) to\r\n     *  handle the result\r\n     *\r\n     *  Parameters:\r\n     *    (XMLElement) elem - The stanza that triggered the callback.\r\n     *\r\n     *  Returns:\r\n     *    false to remove the handler.\r\n     */\r\n    /* jshint unused:false */\r\n    _auth1_cb: function (elem) {\r\n        // build plaintext auth iq\r\n        var iq = $iq({type: \"set\", id: \"_auth_2\"})\r\n            .c('query', {xmlns: Strophe.NS.AUTH})\r\n            .c('username', {}).t(Strophe.getNodeFromJid(this.jid))\r\n            .up()\r\n            .c('password').t(this.pass);\r\n\r\n        if (!Strophe.getResourceFromJid(this.jid)) {\r\n            // since the user has not supplied a resource, we pick\r\n            // a default one here.  unlike other auth methods, the server\r\n            // cannot do this for us.\r\n            this.jid = Strophe.getBareJidFromJid(this.jid) + '/strophe';\r\n        }\r\n        iq.up().c('resource', {}).t(Strophe.getResourceFromJid(this.jid));\r\n\r\n        this._addSysHandler(this._auth2_cb.bind(this), null,\r\n                            null, null, \"_auth_2\");\r\n        this.send(iq.tree());\r\n        return false;\r\n    },\r\n    /* jshint unused:true */\r\n\r\n    /** PrivateFunction: _sasl_success_cb\r\n     *  _Private_ handler for succesful SASL authentication.\r\n     *\r\n     *  Parameters:\r\n     *    (XMLElement) elem - The matching stanza.\r\n     *\r\n     *  Returns:\r\n     *    false to remove the handler.\r\n     */\r\n    _sasl_success_cb: function (elem) {\r\n        if (this._sasl_data[\"server-signature\"]) {\r\n            var serverSignature;\r\n            var success = atob(Strophe.getText(elem));\r\n            var attribMatch = /([a-z]+)=([^,]+)(,|$)/;\r\n            var matches = success.match(attribMatch);\r\n            if (matches[1] === \"v\") {\r\n                serverSignature = matches[2];\r\n            }\r\n\r\n            if (serverSignature !== this._sasl_data[\"server-signature\"]) {\r\n              // remove old handlers\r\n              this.deleteHandler(this._sasl_failure_handler);\r\n              this._sasl_failure_handler = null;\r\n              if (this._sasl_challenge_handler) {\r\n                this.deleteHandler(this._sasl_challenge_handler);\r\n                this._sasl_challenge_handler = null;\r\n              }\r\n\r\n              this._sasl_data = {};\r\n              return this._sasl_failure_cb(null);\r\n            }\r\n        }\r\n        Strophe.info(\"SASL authentication succeeded.\");\r\n\r\n        if (this._sasl_mechanism) {\r\n          this._sasl_mechanism.onSuccess();\r\n        }\r\n\r\n        // remove old handlers\r\n        this.deleteHandler(this._sasl_failure_handler);\r\n        this._sasl_failure_handler = null;\r\n        if (this._sasl_challenge_handler) {\r\n            this.deleteHandler(this._sasl_challenge_handler);\r\n            this._sasl_challenge_handler = null;\r\n        }\r\n\r\n        var streamfeature_handlers = [];\r\n        var wrapper = function(handlers, elem) {\r\n            while (handlers.length) {\r\n                this.deleteHandler(handlers.pop());\r\n            }\r\n            this._sasl_auth1_cb.bind(this)(elem);\r\n            return false;\r\n        };\r\n        streamfeature_handlers.push(this._addSysHandler(function(elem) {\r\n            wrapper.bind(this)(streamfeature_handlers, elem);\r\n        }.bind(this), null, \"stream:features\", null, null));\r\n        streamfeature_handlers.push(this._addSysHandler(function(elem) {\r\n            wrapper.bind(this)(streamfeature_handlers, elem);\r\n        }.bind(this), Strophe.NS.STREAM, \"features\", null, null));\r\n\r\n        // we must send an xmpp:restart now\r\n        this._sendRestart();\r\n\r\n        return false;\r\n    },\r\n\r\n    /** PrivateFunction: _sasl_auth1_cb\r\n     *  _Private_ handler to start stream binding.\r\n     *\r\n     *  Parameters:\r\n     *    (XMLElement) elem - The matching stanza.\r\n     *\r\n     *  Returns:\r\n     *    false to remove the handler.\r\n     */\r\n    _sasl_auth1_cb: function (elem) {\r\n        // save stream:features for future usage\r\n        this.features = elem;\r\n        var i, child;\r\n        for (i = 0; i < elem.childNodes.length; i++) {\r\n            child = elem.childNodes[i];\r\n            if (child.nodeName === 'bind') {\r\n                this.do_bind = true;\r\n            }\r\n\r\n            if (child.nodeName === 'session') {\r\n                this.do_session = true;\r\n            }\r\n        }\r\n\r\n        if (!this.do_bind) {\r\n            this._changeConnectStatus(Strophe.Status.AUTHFAIL, null);\r\n            return false;\r\n        } else {\r\n            this._addSysHandler(this._sasl_bind_cb.bind(this), null, null,\r\n                                null, \"_bind_auth_2\");\r\n\r\n            var resource = Strophe.getResourceFromJid(this.jid);\r\n            if (resource) {\r\n                this.send($iq({type: \"set\", id: \"_bind_auth_2\"})\r\n                          .c('bind', {xmlns: Strophe.NS.BIND})\r\n                          .c('resource', {}).t(resource).tree());\r\n            } else {\r\n                this.send($iq({type: \"set\", id: \"_bind_auth_2\"})\r\n                          .c('bind', {xmlns: Strophe.NS.BIND})\r\n                          .tree());\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n\r\n    /** PrivateFunction: _sasl_bind_cb\r\n     *  _Private_ handler for binding result and session start.\r\n     *\r\n     *  Parameters:\r\n     *    (XMLElement) elem - The matching stanza.\r\n     *\r\n     *  Returns:\r\n     *    false to remove the handler.\r\n     */\r\n    _sasl_bind_cb: function (elem) {\r\n        if (elem.getAttribute(\"type\") === \"error\") {\r\n            Strophe.info(\"SASL binding failed.\");\r\n            var conflict = elem.getElementsByTagName(\"conflict\"), condition;\r\n            if (conflict.length > 0) {\r\n                condition = Strophe.ErrorCondition.CONFLICT;\r\n            }\r\n            this._changeConnectStatus(Strophe.Status.AUTHFAIL, condition, elem);\r\n            return false;\r\n        }\r\n\r\n        // TODO - need to grab errors\r\n        var bind = elem.getElementsByTagName(\"bind\");\r\n        var jidNode;\r\n        if (bind.length > 0) {\r\n            // Grab jid\r\n            jidNode = bind[0].getElementsByTagName(\"jid\");\r\n            if (jidNode.length > 0) {\r\n                this.jid = Strophe.getText(jidNode[0]);\r\n\r\n                if (this.do_session) {\r\n                    this._addSysHandler(this._sasl_session_cb.bind(this),\r\n                                        null, null, null, \"_session_auth_2\");\r\n\r\n                    this.send($iq({type: \"set\", id: \"_session_auth_2\"})\r\n                                  .c('session', {xmlns: Strophe.NS.SESSION})\r\n                                  .tree());\r\n                } else {\r\n                    this.authenticated = true;\r\n                    this._changeConnectStatus(Strophe.Status.CONNECTED, null);\r\n                }\r\n            }\r\n        } else {\r\n            Strophe.info(\"SASL binding failed.\");\r\n            this._changeConnectStatus(Strophe.Status.AUTHFAIL, null, elem);\r\n            return false;\r\n        }\r\n    },\r\n\r\n    /** PrivateFunction: _sasl_session_cb\r\n     *  _Private_ handler to finish successful SASL connection.\r\n     *\r\n     *  This sets Connection.authenticated to true on success, which\r\n     *  starts the processing of user handlers.\r\n     *\r\n     *  Parameters:\r\n     *    (XMLElement) elem - The matching stanza.\r\n     *\r\n     *  Returns:\r\n     *    false to remove the handler.\r\n     */\r\n    _sasl_session_cb: function (elem) {\r\n        if (elem.getAttribute(\"type\") === \"result\") {\r\n            this.authenticated = true;\r\n            this._changeConnectStatus(Strophe.Status.CONNECTED, null);\r\n        } else if (elem.getAttribute(\"type\") === \"error\") {\r\n            Strophe.info(\"Session creation failed.\");\r\n            this._changeConnectStatus(Strophe.Status.AUTHFAIL, null, elem);\r\n            return false;\r\n        }\r\n        return false;\r\n    },\r\n\r\n    /** PrivateFunction: _sasl_failure_cb\r\n     *  _Private_ handler for SASL authentication failure.\r\n     *\r\n     *  Parameters:\r\n     *    (XMLElement) elem - The matching stanza.\r\n     *\r\n     *  Returns:\r\n     *    false to remove the handler.\r\n     */\r\n    /* jshint unused:false */\r\n    _sasl_failure_cb: function (elem) {\r\n        // delete unneeded handlers\r\n        if (this._sasl_success_handler) {\r\n            this.deleteHandler(this._sasl_success_handler);\r\n            this._sasl_success_handler = null;\r\n        }\r\n        if (this._sasl_challenge_handler) {\r\n            this.deleteHandler(this._sasl_challenge_handler);\r\n            this._sasl_challenge_handler = null;\r\n        }\r\n\r\n        if(this._sasl_mechanism)\r\n          this._sasl_mechanism.onFailure();\r\n        this._changeConnectStatus(Strophe.Status.AUTHFAIL, null, elem);\r\n        return false;\r\n    },\r\n    /* jshint unused:true */\r\n\r\n    /** PrivateFunction: _auth2_cb\r\n     *  _Private_ handler to finish legacy authentication.\r\n     *\r\n     *  This handler is called when the result from the jabber:iq:auth\r\n     *  <iq/> stanza is returned.\r\n     *\r\n     *  Parameters:\r\n     *    (XMLElement) elem - The stanza that triggered the callback.\r\n     *\r\n     *  Returns:\r\n     *    false to remove the handler.\r\n     */\r\n    _auth2_cb: function (elem) {\r\n        if (elem.getAttribute(\"type\") === \"result\") {\r\n            this.authenticated = true;\r\n            this._changeConnectStatus(Strophe.Status.CONNECTED, null);\r\n        } else if (elem.getAttribute(\"type\") === \"error\") {\r\n            this._changeConnectStatus(Strophe.Status.AUTHFAIL, null, elem);\r\n            this.disconnect('authentication failed');\r\n        }\r\n        return false;\r\n    },\r\n\r\n    /** PrivateFunction: _addSysTimedHandler\r\n     *  _Private_ function to add a system level timed handler.\r\n     *\r\n     *  This function is used to add a Strophe.TimedHandler for the\r\n     *  library code.  System timed handlers are allowed to run before\r\n     *  authentication is complete.\r\n     *\r\n     *  Parameters:\r\n     *    (Integer) period - The period of the handler.\r\n     *    (Function) handler - The callback function.\r\n     */\r\n    _addSysTimedHandler: function (period, handler) {\r\n        var thand = new Strophe.TimedHandler(period, handler);\r\n        thand.user = false;\r\n        this.addTimeds.push(thand);\r\n        return thand;\r\n    },\r\n\r\n    /** PrivateFunction: _addSysHandler\r\n     *  _Private_ function to add a system level stanza handler.\r\n     *\r\n     *  This function is used to add a Strophe.Handler for the\r\n     *  library code.  System stanza handlers are allowed to run before\r\n     *  authentication is complete.\r\n     *\r\n     *  Parameters:\r\n     *    (Function) handler - The callback function.\r\n     *    (String) ns - The namespace to match.\r\n     *    (String) name - The stanza name to match.\r\n     *    (String) type - The stanza type attribute to match.\r\n     *    (String) id - The stanza id attribute to match.\r\n     */\r\n    _addSysHandler: function (handler, ns, name, type, id) {\r\n        var hand = new Strophe.Handler(handler, ns, name, type, id);\r\n        hand.user = false;\r\n        this.addHandlers.push(hand);\r\n        return hand;\r\n    },\r\n\r\n    /** PrivateFunction: _onDisconnectTimeout\r\n     *  _Private_ timeout handler for handling non-graceful disconnection.\r\n     *\r\n     *  If the graceful disconnect process does not complete within the\r\n     *  time allotted, this handler finishes the disconnect anyway.\r\n     *\r\n     *  Returns:\r\n     *    false to remove the handler.\r\n     */\r\n    _onDisconnectTimeout: function () {\r\n        Strophe.info(\"_onDisconnectTimeout was called\");\r\n        this._changeConnectStatus(Strophe.Status.CONNTIMEOUT, null);\r\n        this._proto._onDisconnectTimeout();\r\n        // actually disconnect\r\n        this._doDisconnect();\r\n        return false;\r\n    },\r\n\r\n    /** PrivateFunction: _onIdle\r\n     *  _Private_ handler to process events during idle cycle.\r\n     *\r\n     *  This handler is called every 100ms to fire timed handlers that\r\n     *  are ready and keep poll requests going.\r\n     */\r\n    _onIdle: function () {\r\n        var i, thand, since, newList;\r\n\r\n        // add timed handlers scheduled for addition\r\n        // NOTE: we add before remove in the case a timed handler is\r\n        // added and then deleted before the next _onIdle() call.\r\n        while (this.addTimeds.length > 0) {\r\n            this.timedHandlers.push(this.addTimeds.pop());\r\n        }\r\n\r\n        // remove timed handlers that have been scheduled for deletion\r\n        while (this.removeTimeds.length > 0) {\r\n            thand = this.removeTimeds.pop();\r\n            i = this.timedHandlers.indexOf(thand);\r\n            if (i >= 0) {\r\n                this.timedHandlers.splice(i, 1);\r\n            }\r\n        }\r\n\r\n        // call ready timed handlers\r\n        var now = new Date().getTime();\r\n        newList = [];\r\n        for (i = 0; i < this.timedHandlers.length; i++) {\r\n            thand = this.timedHandlers[i];\r\n            if (this.authenticated || !thand.user) {\r\n                since = thand.lastCalled + thand.period;\r\n                if (since - now <= 0) {\r\n                    if (thand.run()) {\r\n                        newList.push(thand);\r\n                    }\r\n                } else {\r\n                    newList.push(thand);\r\n                }\r\n            }\r\n        }\r\n        this.timedHandlers = newList;\r\n\r\n        clearTimeout(this._idleTimeout);\r\n\r\n        this._proto._onIdle();\r\n\r\n        // reactivate the timer only if connected\r\n        if (this.connected) {\r\n            // XXX: setTimeout should be called only with function expressions (23974bc1)\r\n            this._idleTimeout = setTimeout(function() {\r\n                this._onIdle();\r\n            }.bind(this), 100);\r\n        }\r\n    }\r\n};\r\n\r\n/** Class: Strophe.SASLMechanism\r\n *\r\n *  encapsulates SASL authentication mechanisms.\r\n *\r\n *  User code may override the priority for each mechanism or disable it completely.\r\n *  See <priority> for information about changing priority and <test> for informatian on\r\n *  how to disable a mechanism.\r\n *\r\n *  By default, all mechanisms are enabled and the priorities are\r\n *\r\n *      OAUTHBEARER - 60\r\n *      SCRAM-SHA1 - 50\r\n *      DIGEST-MD5 - 40\r\n *      PLAIN - 30\r\n *      ANONYMOUS - 20\r\n *      EXTERNAL - 10\r\n *\r\n *  See: Strophe.Connection.addSupportedSASLMechanisms\r\n */\r\n\r\n/**\r\n * PrivateConstructor: Strophe.SASLMechanism\r\n * SASL auth mechanism abstraction.\r\n *\r\n *  Parameters:\r\n *    (String) name - SASL Mechanism name.\r\n *    (Boolean) isClientFirst - If client should send response first without challenge.\r\n *    (Number) priority - Priority.\r\n *\r\n *  Returns:\r\n *    A new Strophe.SASLMechanism object.\r\n */\r\nStrophe.SASLMechanism = function(name, isClientFirst, priority) {\r\n  /** PrivateVariable: name\r\n   *  Mechanism name.\r\n   */\r\n  this.name = name;\r\n  /** PrivateVariable: isClientFirst\r\n   *  If client sends response without initial server challenge.\r\n   */\r\n  this.isClientFirst = isClientFirst;\r\n  /** Variable: priority\r\n   *  Determines which <SASLMechanism> is chosen for authentication (Higher is better).\r\n   *  Users may override this to prioritize mechanisms differently.\r\n   *\r\n   *  In the default configuration the priorities are\r\n   *\r\n   *  SCRAM-SHA1 - 40\r\n   *  DIGEST-MD5 - 30\r\n   *  Plain - 20\r\n   *\r\n   *  Example: (This will cause Strophe to choose the mechanism that the server sent first)\r\n   *\r\n   *  > Strophe.SASLMD5.priority = Strophe.SASLSHA1.priority;\r\n   *\r\n   *  See <SASL mechanisms> for a list of available mechanisms.\r\n   *\r\n   */\r\n  this.priority = priority;\r\n};\r\n\r\nStrophe.SASLMechanism.prototype = {\r\n  /**\r\n   *  Function: test\r\n   *  Checks if mechanism able to run.\r\n   *  To disable a mechanism, make this return false;\r\n   *\r\n   *  To disable plain authentication run\r\n   *  > Strophe.SASLPlain.test = function() {\r\n   *  >   return false;\r\n   *  > }\r\n   *\r\n   *  See <SASL mechanisms> for a list of available mechanisms.\r\n   *\r\n   *  Parameters:\r\n   *    (Strophe.Connection) connection - Target Connection.\r\n   *\r\n   *  Returns:\r\n   *    (Boolean) If mechanism was able to run.\r\n   */\r\n  /* jshint unused:false */\r\n  test: function(connection) {\r\n    return true;\r\n  },\r\n  /* jshint unused:true */\r\n\r\n  /** PrivateFunction: onStart\r\n   *  Called before starting mechanism on some connection.\r\n   *\r\n   *  Parameters:\r\n   *    (Strophe.Connection) connection - Target Connection.\r\n   */\r\n  onStart: function(connection) {\r\n    this._connection = connection;\r\n  },\r\n\r\n  /** PrivateFunction: onChallenge\r\n   *  Called by protocol implementation on incoming challenge. If client is\r\n   *  first (isClientFirst === true) challenge will be null on the first call.\r\n   *\r\n   *  Parameters:\r\n   *    (Strophe.Connection) connection - Target Connection.\r\n   *    (String) challenge - current challenge to handle.\r\n   *\r\n   *  Returns:\r\n   *    (String) Mechanism response.\r\n   */\r\n  /* jshint unused:false */\r\n  onChallenge: function(connection, challenge) {\r\n    throw new Error(\"You should implement challenge handling!\");\r\n  },\r\n  /* jshint unused:true */\r\n\r\n  /** PrivateFunction: onFailure\r\n   *  Protocol informs mechanism implementation about SASL failure.\r\n   */\r\n  onFailure: function() {\r\n    this._connection = null;\r\n  },\r\n\r\n  /** PrivateFunction: onSuccess\r\n   *  Protocol informs mechanism implementation about SASL success.\r\n   */\r\n  onSuccess: function() {\r\n    this._connection = null;\r\n  }\r\n};\r\n\r\n  /** Constants: SASL mechanisms\r\n   *  Available authentication mechanisms\r\n   *\r\n   *  Strophe.SASLAnonymous - SASL ANONYMOUS authentication.\r\n   *  Strophe.SASLPlain - SASL PLAIN authentication.\r\n   *  Strophe.SASLMD5 - SASL DIGEST-MD5 authentication\r\n   *  Strophe.SASLSHA1 - SASL SCRAM-SHA1 authentication\r\n   *  Strophe.SASLOAuthBearer - SASL OAuth Bearer authentication\r\n   *  Strophe.SASLExternal - SASL EXTERNAL authentication\r\n   *  Strophe.SASLXOAuth2 - SASL X-OAuth2 authentication\r\n   */\r\n\r\n// Building SASL callbacks\r\n\r\n/** PrivateConstructor: SASLAnonymous\r\n *  SASL ANONYMOUS authentication.\r\n */\r\nStrophe.SASLAnonymous = function() {};\r\nStrophe.SASLAnonymous.prototype = new Strophe.SASLMechanism(\"ANONYMOUS\", false, 20);\r\n\r\nStrophe.SASLAnonymous.prototype.test = function(connection) {\r\n    return connection.authcid === null;\r\n};\r\n\r\n\r\n/** PrivateConstructor: SASLPlain\r\n *  SASL PLAIN authentication.\r\n */\r\nStrophe.SASLPlain = function() {};\r\nStrophe.SASLPlain.prototype = new Strophe.SASLMechanism(\"PLAIN\", true, 30);\r\n\r\nStrophe.SASLPlain.prototype.test = function(connection) {\r\n    return connection.authcid !== null;\r\n};\r\n\r\nStrophe.SASLPlain.prototype.onChallenge = function(connection) {\r\n    var auth_str = connection.authzid;\r\n    auth_str = auth_str + \"\\u0000\";\r\n    auth_str = auth_str + connection.authcid;\r\n    auth_str = auth_str + \"\\u0000\";\r\n    auth_str = auth_str + connection.pass;\r\n    return utils.utf16to8(auth_str);\r\n};\r\n\r\n\r\n/** PrivateConstructor: SASLSHA1\r\n *  SASL SCRAM SHA 1 authentication.\r\n */\r\nStrophe.SASLSHA1 = function() {};\r\nStrophe.SASLSHA1.prototype = new Strophe.SASLMechanism(\"SCRAM-SHA-1\", true, 50);\r\n\r\nStrophe.SASLSHA1.prototype.test = function(connection) {\r\n    return connection.authcid !== null;\r\n};\r\n\r\nStrophe.SASLSHA1.prototype.onChallenge = function(connection, challenge, test_cnonce) {\r\n  var cnonce = test_cnonce || MD5.hexdigest(Math.random() * 1234567890);\r\n  var auth_str = \"n=\" + utils.utf16to8(connection.authcid);\r\n  auth_str += \",r=\";\r\n  auth_str += cnonce;\r\n  connection._sasl_data.cnonce = cnonce;\r\n  connection._sasl_data[\"client-first-message-bare\"] = auth_str;\r\n\r\n  auth_str = \"n,,\" + auth_str;\r\n\r\n  this.onChallenge = function (connection, challenge) {\r\n    var nonce, salt, iter, Hi, U, U_old, i, k, pass;\r\n    var clientKey, serverKey, clientSignature;\r\n    var responseText = \"c=biws,\";\r\n    var authMessage = connection._sasl_data[\"client-first-message-bare\"] + \",\" +\r\n      challenge + \",\";\r\n    var cnonce = connection._sasl_data.cnonce;\r\n    var attribMatch = /([a-z]+)=([^,]+)(,|$)/;\r\n\r\n    while (challenge.match(attribMatch)) {\r\n      var matches = challenge.match(attribMatch);\r\n      challenge = challenge.replace(matches[0], \"\");\r\n      switch (matches[1]) {\r\n      case \"r\":\r\n        nonce = matches[2];\r\n        break;\r\n      case \"s\":\r\n        salt = matches[2];\r\n        break;\r\n      case \"i\":\r\n        iter = matches[2];\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (nonce.substr(0, cnonce.length) !== cnonce) {\r\n      connection._sasl_data = {};\r\n      return connection._sasl_failure_cb();\r\n    }\r\n\r\n    responseText += \"r=\" + nonce;\r\n    authMessage += responseText;\r\n\r\n    salt = atob(salt);\r\n    salt += \"\\x00\\x00\\x00\\x01\";\r\n\r\n    pass = utils.utf16to8(connection.pass);\r\n    Hi = U_old = SHA1.core_hmac_sha1(pass, salt);\r\n    for (i = 1; i < iter; i++) {\r\n      U = SHA1.core_hmac_sha1(pass, SHA1.binb2str(U_old));\r\n      for (k = 0; k < 5; k++) {\r\n        Hi[k] ^= U[k];\r\n      }\r\n      U_old = U;\r\n    }\r\n    Hi = SHA1.binb2str(Hi);\r\n\r\n    clientKey = SHA1.core_hmac_sha1(Hi, \"Client Key\");\r\n    serverKey = SHA1.str_hmac_sha1(Hi, \"Server Key\");\r\n    clientSignature = SHA1.core_hmac_sha1(SHA1.str_sha1(SHA1.binb2str(clientKey)), authMessage);\r\n    connection._sasl_data[\"server-signature\"] = SHA1.b64_hmac_sha1(serverKey, authMessage);\r\n\r\n    for (k = 0; k < 5; k++) {\r\n      clientKey[k] ^= clientSignature[k];\r\n    }\r\n\r\n    responseText += \",p=\" + btoa(SHA1.binb2str(clientKey));\r\n    return responseText;\r\n  }.bind(this);\r\n\r\n  return auth_str;\r\n};\r\n\r\n\r\n/** PrivateConstructor: SASLMD5\r\n *  SASL DIGEST MD5 authentication.\r\n */\r\nStrophe.SASLMD5 = function() {};\r\nStrophe.SASLMD5.prototype = new Strophe.SASLMechanism(\"DIGEST-MD5\", false, 40);\r\n\r\nStrophe.SASLMD5.prototype.test = function(connection) {\r\n    return connection.authcid !== null;\r\n};\r\n\r\n/** PrivateFunction: _quote\r\n *  _Private_ utility function to backslash escape and quote strings.\r\n *\r\n *  Parameters:\r\n *    (String) str - The string to be quoted.\r\n *\r\n *  Returns:\r\n *    quoted string\r\n */\r\nStrophe.SASLMD5.prototype._quote = function (str) {\r\n    return '\"' + str.replace(/\\\\/g, \"\\\\\\\\\").replace(/\"/g, '\\\\\"') + '\"';\r\n    //\" end string workaround for emacs\r\n};\r\n\r\nStrophe.SASLMD5.prototype.onChallenge = function(connection, challenge, test_cnonce) {\r\n  var attribMatch = /([a-z]+)=(\"[^\"]+\"|[^,\"]+)(?:,|$)/;\r\n  var cnonce = test_cnonce || MD5.hexdigest(\"\" + (Math.random() * 1234567890));\r\n  var realm = \"\";\r\n  var host = null;\r\n  var nonce = \"\";\r\n  var qop = \"\";\r\n  var matches;\r\n\r\n  while (challenge.match(attribMatch)) {\r\n    matches = challenge.match(attribMatch);\r\n    challenge = challenge.replace(matches[0], \"\");\r\n    matches[2] = matches[2].replace(/^\"(.+)\"$/, \"$1\");\r\n    switch (matches[1]) {\r\n    case \"realm\":\r\n      realm = matches[2];\r\n      break;\r\n    case \"nonce\":\r\n      nonce = matches[2];\r\n      break;\r\n    case \"qop\":\r\n      qop = matches[2];\r\n      break;\r\n    case \"host\":\r\n      host = matches[2];\r\n      break;\r\n    }\r\n  }\r\n\r\n  var digest_uri = connection.servtype + \"/\" + connection.domain;\r\n  if (host !== null) {\r\n    digest_uri = digest_uri + \"/\" + host;\r\n  }\r\n\r\n  var cred = utils.utf16to8(connection.authcid + \":\" + realm + \":\" + this._connection.pass);\r\n  var A1 = MD5.hash(cred) + \":\" + nonce + \":\" + cnonce;\r\n  var A2 = 'AUTHENTICATE:' + digest_uri;\r\n\r\n  var responseText = \"\";\r\n  responseText += 'charset=utf-8,';\r\n  responseText += 'username=' + this._quote(utils.utf16to8(connection.authcid)) + ',';\r\n  responseText += 'realm=' + this._quote(realm) + ',';\r\n  responseText += 'nonce=' + this._quote(nonce) + ',';\r\n  responseText += 'nc=00000001,';\r\n  responseText += 'cnonce=' + this._quote(cnonce) + ',';\r\n  responseText += 'digest-uri=' + this._quote(digest_uri) + ',';\r\n  responseText += 'response=' + MD5.hexdigest(MD5.hexdigest(A1) + \":\" +\r\n                                              nonce + \":00000001:\" +\r\n                                              cnonce + \":auth:\" +\r\n                                              MD5.hexdigest(A2)) + \",\";\r\n  responseText += 'qop=auth';\r\n\r\n  this.onChallenge = function () {\r\n      return \"\";\r\n  };\r\n  return responseText;\r\n};\r\n\r\n\r\n/** PrivateConstructor: SASLOAuthBearer\r\n *  SASL OAuth Bearer authentication.\r\n */\r\nStrophe.SASLOAuthBearer = function() {};\r\nStrophe.SASLOAuthBearer.prototype = new Strophe.SASLMechanism(\"OAUTHBEARER\", true, 60);\r\n\r\nStrophe.SASLOAuthBearer.prototype.test = function(connection) {\r\n    return connection.pass !== null;\r\n};\r\n\r\nStrophe.SASLOAuthBearer.prototype.onChallenge = function(connection) {\r\n    var auth_str = 'n,';\r\n    if (connection.authcid !== null) {\r\n      auth_str = auth_str + 'a=' + connection.authzid;\r\n    }\r\n    auth_str = auth_str + ',';\r\n    auth_str = auth_str + \"\\u0001\";\r\n    auth_str = auth_str + 'auth=Bearer ';\r\n    auth_str = auth_str + connection.pass;\r\n    auth_str = auth_str + \"\\u0001\";\r\n    auth_str = auth_str + \"\\u0001\";\r\n\r\n    return utils.utf16to8(auth_str);\r\n};\r\n\r\n\r\n/** PrivateConstructor: SASLExternal\r\n *  SASL EXTERNAL authentication.\r\n *\r\n *  The EXTERNAL mechanism allows a client to request the server to use\r\n *  credentials established by means external to the mechanism to\r\n *  authenticate the client. The external means may be, for instance,\r\n *  TLS services.\r\n */\r\nStrophe.SASLExternal = function() {};\r\nStrophe.SASLExternal.prototype = new Strophe.SASLMechanism(\"EXTERNAL\", true, 10);\r\n\r\nStrophe.SASLExternal.prototype.onChallenge = function(connection) {\r\n    /** According to XEP-178, an authzid SHOULD NOT be presented when the\r\n     * authcid contained or implied in the client certificate is the JID (i.e.\r\n     * authzid) with which the user wants to log in as.\r\n     *\r\n     * To NOT send the authzid, the user should therefore set the authcid equal\r\n     * to the JID when instantiating a new Strophe.Connection object.\r\n     */\r\n    return connection.authcid === connection.authzid ? '' : connection.authzid;\r\n};\r\n\r\n\r\n/** PrivateConstructor: SASLXOAuth2\r\n *  SASL X-OAuth2 authentication.\r\n */\r\nStrophe.SASLXOAuth2 = function () { };\r\nStrophe.SASLXOAuth2.prototype = new Strophe.SASLMechanism(\"X-OAUTH2\", true, 70);\r\n\r\nStrophe.SASLXOAuth2.prototype.test = function (connection) {\r\n    return connection.pass !== null;\r\n};\r\n\r\nStrophe.SASLXOAuth2.prototype.onChallenge = function (connection) {\r\n    var auth_str = '\\u0000';\r\n    if (connection.authcid !== null) {\r\n        auth_str = auth_str + connection.authzid;\r\n    }\r\n    auth_str = auth_str + \"\\u0000\";\r\n    auth_str = auth_str + connection.pass;\r\n\r\n    return utils.utf16to8(auth_str);\r\n};\r\n\r\n\r\nreturn {\r\n    'Strophe':         Strophe,\r\n    '$build':          $build,\r\n    '$iq':             $iq,\r\n    '$msg':            $msg,\r\n    '$pres':           $pres,\r\n    'SHA1':            SHA1,\r\n    'MD5':             MD5,\r\n    'b64_hmac_sha1':   SHA1.b64_hmac_sha1,\r\n    'b64_sha1':        SHA1.b64_sha1,\r\n    'str_hmac_sha1':   SHA1.str_hmac_sha1,\r\n    'str_sha1':        SHA1.str_sha1\r\n};\r\n}));\r\n\r\n/*\r\n    This program is distributed under the terms of the MIT license.\r\n    Please see the LICENSE file for details.\r\n\r\n    Copyright 2006-2008, OGG, LLC\r\n*/\r\n\r\n/* jshint undef: true, unused: true:, noarg: true, latedef: true */\r\n/* global define, window, setTimeout, clearTimeout, XMLHttpRequest, ActiveXObject, Strophe, $build */\r\n\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('strophe-bosh',['strophe-core'], function (core) {\r\n            return factory(\r\n                core.Strophe,\r\n                core.$build\r\n            );\r\n        });\r\n    } else if (typeof exports === 'object') {\r\n        var core = require('./core');\r\n\r\n        module.exports = factory(core.Strophe, core.$build);\r\n    } else {\r\n        // Browser globals\r\n        return factory(Strophe, $build);\r\n    }\r\n}(this, function (Strophe, $build) {\r\n\r\n/** PrivateClass: Strophe.Request\r\n *  _Private_ helper class that provides a cross implementation abstraction\r\n *  for a BOSH related XMLHttpRequest.\r\n *\r\n *  The Strophe.Request class is used internally to encapsulate BOSH request\r\n *  information.  It is not meant to be used from user's code.\r\n */\r\n\r\n/** PrivateConstructor: Strophe.Request\r\n *  Create and initialize a new Strophe.Request object.\r\n *\r\n *  Parameters:\r\n *    (XMLElement) elem - The XML data to be sent in the request.\r\n *    (Function) func - The function that will be called when the\r\n *      XMLHttpRequest readyState changes.\r\n *    (Integer) rid - The BOSH rid attribute associated with this request.\r\n *    (Integer) sends - The number of times this same request has been sent.\r\n */\r\nStrophe.Request = function (elem, func, rid, sends) {\r\n    this.id = ++Strophe._requestId;\r\n    this.xmlData = elem;\r\n    this.data = Strophe.serialize(elem);\r\n    // save original function in case we need to make a new request\r\n    // from this one.\r\n    this.origFunc = func;\r\n    this.func = func;\r\n    this.rid = rid;\r\n    this.date = NaN;\r\n    this.sends = sends || 0;\r\n    this.abort = false;\r\n    this.dead = null;\r\n\r\n    this.age = function () {\r\n        if (!this.date) { return 0; }\r\n        var now = new Date();\r\n        return (now - this.date) / 1000;\r\n    };\r\n    this.timeDead = function () {\r\n        if (!this.dead) { return 0; }\r\n        var now = new Date();\r\n        return (now - this.dead) / 1000;\r\n    };\r\n    this.xhr = this._newXHR();\r\n};\r\n\r\nStrophe.Request.prototype = {\r\n    /** PrivateFunction: getResponse\r\n     *  Get a response from the underlying XMLHttpRequest.\r\n     *\r\n     *  This function attempts to get a response from the request and checks\r\n     *  for errors.\r\n     *\r\n     *  Throws:\r\n     *    \"parsererror\" - A parser error occured.\r\n     *    \"badformat\" - The entity has sent XML that cannot be processed.\r\n     *\r\n     *  Returns:\r\n     *    The DOM element tree of the response.\r\n     */\r\n    getResponse: function () {\r\n        var node = null;\r\n        if (this.xhr.responseXML && this.xhr.responseXML.documentElement) {\r\n            node = this.xhr.responseXML.documentElement;\r\n            if (node.tagName === \"parsererror\") {\r\n                Strophe.error(\"invalid response received\");\r\n                Strophe.error(\"responseText: \" + this.xhr.responseText);\r\n                Strophe.error(\"responseXML: \" +\r\n                              Strophe.serialize(this.xhr.responseXML));\r\n                throw \"parsererror\";\r\n            }\r\n        } else if (this.xhr.responseText) {\r\n            Strophe.error(\"invalid response received\");\r\n            Strophe.error(\"responseText: \" + this.xhr.responseText);\r\n            throw \"badformat\";\r\n        }\r\n\r\n        return node;\r\n    },\r\n\r\n    /** PrivateFunction: _newXHR\r\n     *  _Private_ helper function to create XMLHttpRequests.\r\n     *\r\n     *  This function creates XMLHttpRequests across all implementations.\r\n     *\r\n     *  Returns:\r\n     *    A new XMLHttpRequest.\r\n     */\r\n    _newXHR: function () {\r\n        var xhr = null;\r\n        if (window.XMLHttpRequest) {\r\n            xhr = new XMLHttpRequest();\r\n            if (xhr.overrideMimeType) {\r\n                xhr.overrideMimeType(\"text/xml; charset=utf-8\");\r\n            }\r\n        } else if (window.ActiveXObject) {\r\n            xhr = new ActiveXObject(\"Microsoft.XMLHTTP\");\r\n        }\r\n        // use Function.bind() to prepend ourselves as an argument\r\n        xhr.onreadystatechange = this.func.bind(null, this);\r\n        return xhr;\r\n    }\r\n};\r\n\r\n/** Class: Strophe.Bosh\r\n *  _Private_ helper class that handles BOSH Connections\r\n *\r\n *  The Strophe.Bosh class is used internally by Strophe.Connection\r\n *  to encapsulate BOSH sessions. It is not meant to be used from user's code.\r\n */\r\n\r\n/** File: bosh.js\r\n *  A JavaScript library to enable BOSH in Strophejs.\r\n *\r\n *  this library uses Bidirectional-streams Over Synchronous HTTP (BOSH)\r\n *  to emulate a persistent, stateful, two-way connection to an XMPP server.\r\n *  More information on BOSH can be found in XEP 124.\r\n */\r\n\r\n/** PrivateConstructor: Strophe.Bosh\r\n *  Create and initialize a Strophe.Bosh object.\r\n *\r\n *  Parameters:\r\n *    (Strophe.Connection) connection - The Strophe.Connection that will use BOSH.\r\n *\r\n *  Returns:\r\n *    A new Strophe.Bosh object.\r\n */\r\nStrophe.Bosh = function(connection) {\r\n    this._conn = connection;\r\n    /* request id for body tags */\r\n    this.rid = Math.floor(Math.random() * 4294967295);\r\n    /* The current session ID. */\r\n    this.sid = null;\r\n\r\n    // default BOSH values\r\n    this.hold = 1;\r\n    this.wait = 60;\r\n    this.window = 5;\r\n    this.errors = 0;\r\n    this.inactivity = null;\r\n\r\n    this.lastResponseHeaders = null;\r\n\r\n    this._requests = [];\r\n};\r\n\r\nStrophe.Bosh.prototype = {\r\n    /** Variable: strip\r\n     *\r\n     *  BOSH-Connections will have all stanzas wrapped in a <body> tag when\r\n     *  passed to <Strophe.Connection.xmlInput> or <Strophe.Connection.xmlOutput>.\r\n     *  To strip this tag, User code can set <Strophe.Bosh.strip> to \"body\":\r\n     *\r\n     *  > Strophe.Bosh.prototype.strip = \"body\";\r\n     *\r\n     *  This will enable stripping of the body tag in both\r\n     *  <Strophe.Connection.xmlInput> and <Strophe.Connection.xmlOutput>.\r\n     */\r\n    strip: null,\r\n\r\n    /** PrivateFunction: _buildBody\r\n     *  _Private_ helper function to generate the <body/> wrapper for BOSH.\r\n     *\r\n     *  Returns:\r\n     *    A Strophe.Builder with a <body/> element.\r\n     */\r\n    _buildBody: function () {\r\n        var bodyWrap = $build('body', {\r\n            rid: this.rid++,\r\n            xmlns: Strophe.NS.HTTPBIND\r\n        });\r\n        if (this.sid !== null) {\r\n            bodyWrap.attrs({sid: this.sid});\r\n        }\r\n        if (this._conn.options.keepalive && this._conn._sessionCachingSupported()) {\r\n            this._cacheSession();\r\n        }\r\n        return bodyWrap;\r\n    },\r\n\r\n    /** PrivateFunction: _reset\r\n     *  Reset the connection.\r\n     *\r\n     *  This function is called by the reset function of the Strophe Connection\r\n     */\r\n    _reset: function () {\r\n        this.rid = Math.floor(Math.random() * 4294967295);\r\n        this.sid = null;\r\n        this.errors = 0;\r\n        if (this._conn._sessionCachingSupported()) {\r\n            window.sessionStorage.removeItem('strophe-bosh-session');\r\n        }\r\n\r\n        this._conn.nextValidRid(this.rid);\r\n    },\r\n\r\n    /** PrivateFunction: _connect\r\n     *  _Private_ function that initializes the BOSH connection.\r\n     *\r\n     *  Creates and sends the Request that initializes the BOSH connection.\r\n     */\r\n    _connect: function (wait, hold, route) {\r\n        this.wait = wait || this.wait;\r\n        this.hold = hold || this.hold;\r\n        this.errors = 0;\r\n\r\n        // build the body tag\r\n        var body = this._buildBody().attrs({\r\n            to: this._conn.domain,\r\n            \"xml:lang\": \"en\",\r\n            wait: this.wait,\r\n            hold: this.hold,\r\n            content: \"text/xml; charset=utf-8\",\r\n            ver: \"1.6\",\r\n            \"xmpp:version\": \"1.0\",\r\n            \"xmlns:xmpp\": Strophe.NS.BOSH\r\n        });\r\n\r\n        if(route){\r\n            body.attrs({\r\n                route: route\r\n            });\r\n        }\r\n\r\n        var _connect_cb = this._conn._connect_cb;\r\n\r\n        this._requests.push(\r\n            new Strophe.Request(body.tree(),\r\n                                this._onRequestStateChange.bind(\r\n                                    this, _connect_cb.bind(this._conn)),\r\n                                body.tree().getAttribute(\"rid\")));\r\n        this._throttledRequestHandler();\r\n    },\r\n\r\n    /** PrivateFunction: _attach\r\n     *  Attach to an already created and authenticated BOSH session.\r\n     *\r\n     *  This function is provided to allow Strophe to attach to BOSH\r\n     *  sessions which have been created externally, perhaps by a Web\r\n     *  application.  This is often used to support auto-login type features\r\n     *  without putting user credentials into the page.\r\n     *\r\n     *  Parameters:\r\n     *    (String) jid - The full JID that is bound by the session.\r\n     *    (String) sid - The SID of the BOSH session.\r\n     *    (String) rid - The current RID of the BOSH session.  This RID\r\n     *      will be used by the next request.\r\n     *    (Function) callback The connect callback function.\r\n     *    (Integer) wait - The optional HTTPBIND wait value.  This is the\r\n     *      time the server will wait before returning an empty result for\r\n     *      a request.  The default setting of 60 seconds is recommended.\r\n     *      Other settings will require tweaks to the Strophe.TIMEOUT value.\r\n     *    (Integer) hold - The optional HTTPBIND hold value.  This is the\r\n     *      number of connections the server will hold at one time.  This\r\n     *      should almost always be set to 1 (the default).\r\n     *    (Integer) wind - The optional HTTBIND window value.  This is the\r\n     *      allowed range of request ids that are valid.  The default is 5.\r\n     */\r\n    _attach: function (jid, sid, rid, callback, wait, hold, wind) {\r\n        this._conn.jid = jid;\r\n        this.sid = sid;\r\n        this.rid = rid;\r\n\r\n        this._conn.connect_callback = callback;\r\n\r\n        this._conn.domain = Strophe.getDomainFromJid(this._conn.jid);\r\n\r\n        this._conn.authenticated = true;\r\n        this._conn.connected = true;\r\n\r\n        this.wait = wait || this.wait;\r\n        this.hold = hold || this.hold;\r\n        this.window = wind || this.window;\r\n\r\n        this._conn._changeConnectStatus(Strophe.Status.ATTACHED, null);\r\n    },\r\n\r\n    /** PrivateFunction: _restore\r\n     *  Attempt to restore a cached BOSH session\r\n     *\r\n     *  Parameters:\r\n     *    (String) jid - The full JID that is bound by the session.\r\n     *      This parameter is optional but recommended, specifically in cases\r\n     *      where prebinded BOSH sessions are used where it's important to know\r\n     *      that the right session is being restored.\r\n     *    (Function) callback The connect callback function.\r\n     *    (Integer) wait - The optional HTTPBIND wait value.  This is the\r\n     *      time the server will wait before returning an empty result for\r\n     *      a request.  The default setting of 60 seconds is recommended.\r\n     *      Other settings will require tweaks to the Strophe.TIMEOUT value.\r\n     *    (Integer) hold - The optional HTTPBIND hold value.  This is the\r\n     *      number of connections the server will hold at one time.  This\r\n     *      should almost always be set to 1 (the default).\r\n     *    (Integer) wind - The optional HTTBIND window value.  This is the\r\n     *      allowed range of request ids that are valid.  The default is 5.\r\n     */\r\n    _restore: function (jid, callback, wait, hold, wind) {\r\n        var session = JSON.parse(window.sessionStorage.getItem('strophe-bosh-session'));\r\n        if (typeof session !== \"undefined\" &&\r\n                   session !== null &&\r\n                   session.rid &&\r\n                   session.sid &&\r\n                   session.jid &&\r\n                   (    typeof jid === \"undefined\" ||\r\n                        jid === null ||\r\n                        Strophe.getBareJidFromJid(session.jid) === Strophe.getBareJidFromJid(jid) ||\r\n                        // If authcid is null, then it's an anonymous login, so\r\n                        // we compare only the domains:\r\n                        ((Strophe.getNodeFromJid(jid) === null) && (Strophe.getDomainFromJid(session.jid) === jid))\r\n                    )\r\n        ) {\r\n            this._conn.restored = true;\r\n            this._attach(session.jid, session.sid, session.rid, callback, wait, hold, wind);\r\n        } else {\r\n            throw { name: \"StropheSessionError\", message: \"_restore: no restoreable session.\" };\r\n        }\r\n    },\r\n\r\n    /** PrivateFunction: _cacheSession\r\n     *  _Private_ handler for the beforeunload event.\r\n     *\r\n     *  This handler is used to process the Bosh-part of the initial request.\r\n     *  Parameters:\r\n     *    (Strophe.Request) bodyWrap - The received stanza.\r\n     */\r\n    _cacheSession: function () {\r\n        if (this._conn.authenticated) {\r\n            if (this._conn.jid && this.rid && this.sid) {\r\n                window.sessionStorage.setItem('strophe-bosh-session', JSON.stringify({\r\n                    'jid': this._conn.jid,\r\n                    'rid': this.rid,\r\n                    'sid': this.sid\r\n                }));\r\n            }\r\n        } else {\r\n            window.sessionStorage.removeItem('strophe-bosh-session');\r\n        }\r\n    },\r\n\r\n    /** PrivateFunction: _connect_cb\r\n     *  _Private_ handler for initial connection request.\r\n     *\r\n     *  This handler is used to process the Bosh-part of the initial request.\r\n     *  Parameters:\r\n     *    (Strophe.Request) bodyWrap - The received stanza.\r\n     */\r\n    _connect_cb: function (bodyWrap) {\r\n        var typ = bodyWrap.getAttribute(\"type\");\r\n        var cond, conflict;\r\n        if (typ !== null && typ === \"terminate\") {\r\n            // an error occurred\r\n            cond = bodyWrap.getAttribute(\"condition\");\r\n            Strophe.error(\"BOSH-Connection failed: \" + cond);\r\n            conflict = bodyWrap.getElementsByTagName(\"conflict\");\r\n            if (cond !== null) {\r\n                if (cond === \"remote-stream-error\" && conflict.length > 0) {\r\n                    cond = \"conflict\";\r\n                }\r\n                this._conn._changeConnectStatus(Strophe.Status.CONNFAIL, cond);\r\n            } else {\r\n                this._conn._changeConnectStatus(Strophe.Status.CONNFAIL, \"unknown\");\r\n            }\r\n            this._conn._doDisconnect(cond);\r\n            return Strophe.Status.CONNFAIL;\r\n        }\r\n\r\n        // check to make sure we don't overwrite these if _connect_cb is\r\n        // called multiple times in the case of missing stream:features\r\n        if (!this.sid) {\r\n            this.sid = bodyWrap.getAttribute(\"sid\");\r\n        }\r\n        var wind = bodyWrap.getAttribute('requests');\r\n        if (wind) { this.window = parseInt(wind, 10); }\r\n        var hold = bodyWrap.getAttribute('hold');\r\n        if (hold) { this.hold = parseInt(hold, 10); }\r\n        var wait = bodyWrap.getAttribute('wait');\r\n        if (wait) { this.wait = parseInt(wait, 10); }\r\n        var inactivity = bodyWrap.getAttribute('inactivity');\r\n        if (inactivity) { this.inactivity = parseInt(inactivity, 10); }\r\n    },\r\n\r\n    /** PrivateFunction: _disconnect\r\n     *  _Private_ part of Connection.disconnect for Bosh\r\n     *\r\n     *  Parameters:\r\n     *    (Request) pres - This stanza will be sent before disconnecting.\r\n     */\r\n    _disconnect: function (pres) {\r\n        this._sendTerminate(pres);\r\n    },\r\n\r\n    /** PrivateFunction: _doDisconnect\r\n     *  _Private_ function to disconnect.\r\n     *\r\n     *  Resets the SID and RID.\r\n     */\r\n    _doDisconnect: function () {\r\n        this.sid = null;\r\n        this.rid = Math.floor(Math.random() * 4294967295);\r\n        if (this._conn._sessionCachingSupported()) {\r\n            window.sessionStorage.removeItem('strophe-bosh-session');\r\n        }\r\n\r\n        this._conn.nextValidRid(this.rid);\r\n    },\r\n\r\n    /** PrivateFunction: _emptyQueue\r\n     * _Private_ function to check if the Request queue is empty.\r\n     *\r\n     *  Returns:\r\n     *    True, if there are no Requests queued, False otherwise.\r\n     */\r\n    _emptyQueue: function () {\r\n        return this._requests.length === 0;\r\n    },\r\n\r\n    /** PrivateFunction: _callProtocolErrorHandlers\r\n     *  _Private_ function to call error handlers registered for HTTP errors.\r\n     *\r\n     *  Parameters:\r\n     *    (Strophe.Request) req - The request that is changing readyState.\r\n     */\r\n    _callProtocolErrorHandlers: function (req) {\r\n        var reqStatus = this._getRequestStatus(req),\r\n            err_callback;\r\n        err_callback = this._conn.protocolErrorHandlers.HTTP[reqStatus];\r\n        if (err_callback) {\r\n            err_callback.call(this, reqStatus);\r\n        }\r\n    },\r\n\r\n    /** PrivateFunction: _hitError\r\n     *  _Private_ function to handle the error count.\r\n     *\r\n     *  Requests are resent automatically until their error count reaches\r\n     *  5.  Each time an error is encountered, this function is called to\r\n     *  increment the count and disconnect if the count is too high.\r\n     *\r\n     *  Parameters:\r\n     *    (Integer) reqStatus - The request status.\r\n     */\r\n    _hitError: function (reqStatus) {\r\n        this.errors++;\r\n        Strophe.warn(\"request errored, status: \" + reqStatus +\r\n                     \", number of errors: \" + this.errors);\r\n        if (this.errors > 4) {\r\n            this._conn._onDisconnectTimeout();\r\n        }\r\n    },\r\n\r\n    /** PrivateFunction: _onDisconnectTimeout\r\n     *  _Private_ timeout handler for handling non-graceful disconnection.\r\n     *\r\n     *  Cancels all remaining Requests and clears the queue.\r\n     */\r\n    _onDisconnectTimeout: function () {\r\n        this._abortAllRequests();\r\n    },\r\n\r\n    /** PrivateFunction: _abortAllRequests\r\n     *  _Private_ helper function that makes sure all pending requests are aborted.\r\n     */\r\n    _abortAllRequests: function _abortAllRequests() {\r\n        var req;\r\n        while (this._requests.length > 0) {\r\n            req = this._requests.pop();\r\n            req.abort = true;\r\n            req.xhr.abort();\r\n            // jslint complains, but this is fine. setting to empty func\r\n            // is necessary for IE6\r\n            req.xhr.onreadystatechange = function () {}; // jshint ignore:line\r\n        }\r\n    },\r\n\r\n    /** PrivateFunction: _onIdle\r\n     *  _Private_ handler called by Strophe.Connection._onIdle\r\n     *\r\n     *  Sends all queued Requests or polls with empty Request if there are none.\r\n     */\r\n    _onIdle: function () {\r\n        var data = this._conn._data;\r\n        // if no requests are in progress, poll\r\n        if (this._conn.authenticated && this._requests.length === 0 &&\r\n            data.length === 0 && !this._conn.disconnecting) {\r\n            Strophe.info(\"no requests during idle cycle, sending \" +\r\n                         \"blank request\");\r\n            data.push(null);\r\n        }\r\n\r\n        if (this._conn.paused) {\r\n            return;\r\n        }\r\n\r\n        if (this._requests.length < 2 && data.length > 0) {\r\n            var body = this._buildBody();\r\n            for (var i = 0; i < data.length; i++) {\r\n                if (data[i] !== null) {\r\n                    if (data[i] === \"restart\") {\r\n                        body.attrs({\r\n                            to: this._conn.domain,\r\n                            \"xml:lang\": \"en\",\r\n                            \"xmpp:restart\": \"true\",\r\n                            \"xmlns:xmpp\": Strophe.NS.BOSH\r\n                        });\r\n                    } else {\r\n                        body.cnode(data[i]).up();\r\n                    }\r\n                }\r\n            }\r\n            delete this._conn._data;\r\n            this._conn._data = [];\r\n            this._requests.push(\r\n                new Strophe.Request(body.tree(),\r\n                                    this._onRequestStateChange.bind(\r\n                                        this, this._conn._dataRecv.bind(this._conn)),\r\n                                    body.tree().getAttribute(\"rid\")));\r\n            this._throttledRequestHandler();\r\n        }\r\n\r\n        if (this._requests.length > 0) {\r\n            var time_elapsed = this._requests[0].age();\r\n            if (this._requests[0].dead !== null) {\r\n                if (this._requests[0].timeDead() >\r\n                    Math.floor(Strophe.SECONDARY_TIMEOUT * this.wait)) {\r\n                    this._throttledRequestHandler();\r\n                }\r\n            }\r\n\r\n            if (time_elapsed > Math.floor(Strophe.TIMEOUT * this.wait)) {\r\n                Strophe.warn(\"Request \" +\r\n                             this._requests[0].id +\r\n                             \" timed out, over \" + Math.floor(Strophe.TIMEOUT * this.wait) +\r\n                             \" seconds since last activity\");\r\n                this._throttledRequestHandler();\r\n            }\r\n        }\r\n    },\r\n\r\n    /** PrivateFunction: _getRequestStatus\r\n     *\r\n     *  Returns the HTTP status code from a Strophe.Request\r\n     *\r\n     *  Parameters:\r\n     *    (Strophe.Request) req - The Strophe.Request instance.\r\n     *    (Integer) def - The default value that should be returned if no\r\n     *          status value was found.\r\n     */\r\n    _getRequestStatus: function (req, def) {\r\n        var reqStatus;\r\n        if (req.xhr.readyState === 4) {\r\n            try {\r\n                reqStatus = req.xhr.status;\r\n            } catch (e) {\r\n                // ignore errors from undefined status attribute. Works\r\n                // around a browser bug\r\n                Strophe.error(\r\n                    \"Caught an error while retrieving a request's status, \" +\r\n                    \"reqStatus: \" + reqStatus);\r\n            }\r\n        }\r\n        if (typeof(reqStatus) === \"undefined\") {\r\n            reqStatus = typeof def === 'number' ? def : 0;\r\n        }\r\n        return reqStatus;\r\n    },\r\n\r\n    /** PrivateFunction: _onRequestStateChange\r\n     *  _Private_ handler for Strophe.Request state changes.\r\n     *\r\n     *  This function is called when the XMLHttpRequest readyState changes.\r\n     *  It contains a lot of error handling logic for the many ways that\r\n     *  requests can fail, and calls the request callback when requests\r\n     *  succeed.\r\n     *\r\n     *  Parameters:\r\n     *    (Function) func - The handler for the request.\r\n     *    (Strophe.Request) req - The request that is changing readyState.\r\n     */\r\n    _onRequestStateChange: function (func, req) {\r\n        Strophe.debug(\"request id \"+req.id+\".\"+req.sends+\r\n                      \" state changed to \"+req.xhr.readyState);\r\n        if (req.abort) {\r\n            req.abort = false;\r\n            return;\r\n        }\r\n        if (req.xhr.readyState !== 4) {\r\n            // The request is not yet complete\r\n            return;\r\n        }\r\n        var reqStatus = this._getRequestStatus(req);\r\n        this.lastResponseHeaders = req.xhr.getAllResponseHeaders();\r\n        if (this.disconnecting && reqStatus >= 400) {\r\n            this._hitError(reqStatus);\r\n            this._callProtocolErrorHandlers(req);\r\n            return;\r\n        }\r\n\r\n        var valid_request = reqStatus > 0 && reqStatus < 500;\r\n        var too_many_retries = req.sends > this._conn.maxRetries;\r\n        if (valid_request || too_many_retries) {\r\n            // remove from internal queue\r\n            this._removeRequest(req);\r\n            Strophe.debug(\"request id \"+req.id+\" should now be removed\");\r\n        }\r\n\r\n        if (reqStatus === 200) {\r\n            // request succeeded\r\n            var reqIs0 = (this._requests[0] === req);\r\n            var reqIs1 = (this._requests[1] === req);\r\n            // if request 1 finished, or request 0 finished and request\r\n            // 1 is over Strophe.SECONDARY_TIMEOUT seconds old, we need to\r\n            // restart the other - both will be in the first spot, as the\r\n            // completed request has been removed from the queue already\r\n            if (reqIs1 ||\r\n                (reqIs0 && this._requests.length > 0 &&\r\n                    this._requests[0].age() > Math.floor(Strophe.SECONDARY_TIMEOUT * this.wait))) {\r\n                this._restartRequest(0);\r\n            }\r\n            this._conn.nextValidRid(Number(req.rid) + 1);\r\n            Strophe.debug(\"request id \"+req.id+\".\"+req.sends+\" got 200\");\r\n            func(req); // call handler\r\n            this.errors = 0;\r\n        } else if (reqStatus === 0 ||\r\n                   (reqStatus >= 400 && reqStatus < 600) ||\r\n                   reqStatus >= 12000) {\r\n            // request failed\r\n            Strophe.error(\"request id \"+req.id+\".\"+req.sends+\" error \"+reqStatus+\" happened\");\r\n            this._hitError(reqStatus);\r\n            this._callProtocolErrorHandlers(req);\r\n            if (reqStatus >= 400 && reqStatus < 500) {\r\n                this._conn._changeConnectStatus(Strophe.Status.DISCONNECTING, null);\r\n                this._conn._doDisconnect();\r\n            }\r\n        } else {\r\n            Strophe.error(\"request id \"+req.id+\".\"+req.sends+\" error \"+reqStatus+\" happened\");\r\n        }\r\n\r\n        if (!valid_request && !too_many_retries) {\r\n            this._throttledRequestHandler();\r\n        } else if (too_many_retries && !this._conn.connected) {\r\n            this._conn._changeConnectStatus(Strophe.Status.CONNFAIL, \"giving-up\");\r\n        }\r\n    },\r\n\r\n    /** PrivateFunction: _processRequest\r\n     *  _Private_ function to process a request in the queue.\r\n     *\r\n     *  This function takes requests off the queue and sends them and\r\n     *  restarts dead requests.\r\n     *\r\n     *  Parameters:\r\n     *    (Integer) i - The index of the request in the queue.\r\n     */\r\n    _processRequest: function (i) {\r\n        var self = this;\r\n        var req = this._requests[i];\r\n        var reqStatus = this._getRequestStatus(req, -1);\r\n\r\n        // make sure we limit the number of retries\r\n        if (req.sends > this._conn.maxRetries) {\r\n            this._conn._onDisconnectTimeout();\r\n            return;\r\n        }\r\n\r\n        var time_elapsed = req.age();\r\n        var primaryTimeout = (!isNaN(time_elapsed) &&\r\n                              time_elapsed > Math.floor(Strophe.TIMEOUT * this.wait));\r\n        var secondaryTimeout = (req.dead !== null &&\r\n                                req.timeDead() > Math.floor(Strophe.SECONDARY_TIMEOUT * this.wait));\r\n        var requestCompletedWithServerError = (req.xhr.readyState === 4 &&\r\n                                               (reqStatus < 1 || reqStatus >= 500));\r\n        if (primaryTimeout || secondaryTimeout ||\r\n            requestCompletedWithServerError) {\r\n            if (secondaryTimeout) {\r\n                Strophe.error(\"Request \" + this._requests[i].id +\r\n                              \" timed out (secondary), restarting\");\r\n            }\r\n            req.abort = true;\r\n            req.xhr.abort();\r\n            // setting to null fails on IE6, so set to empty function\r\n            req.xhr.onreadystatechange = function () {};\r\n            this._requests[i] = new Strophe.Request(req.xmlData,\r\n                                                    req.origFunc,\r\n                                                    req.rid,\r\n                                                    req.sends);\r\n            req = this._requests[i];\r\n        }\r\n\r\n        if (req.xhr.readyState === 0) {\r\n            Strophe.debug(\"request id \"+req.id+\".\"+req.sends+\" posting\");\r\n\r\n            try {\r\n                var contentType = this._conn.options.contentType || \"text/xml; charset=utf-8\";\r\n                req.xhr.open(\"POST\", this._conn.service, this._conn.options.sync ? false : true);\r\n                if (typeof req.xhr.setRequestHeader !== 'undefined') {\r\n                    // IE9 doesn't have setRequestHeader\r\n                    req.xhr.setRequestHeader(\"Content-Type\", contentType);\r\n                }\r\n                if (this._conn.options.withCredentials) {\r\n                    req.xhr.withCredentials = true;\r\n                }\r\n            } catch (e2) {\r\n                Strophe.error(\"XHR open failed: \" + e2.toString());\r\n                if (!this._conn.connected) {\r\n                    this._conn._changeConnectStatus(\r\n                            Strophe.Status.CONNFAIL, \"bad-service\");\r\n                }\r\n                this._conn.disconnect();\r\n                return;\r\n            }\r\n\r\n            // Fires the XHR request -- may be invoked immediately\r\n            // or on a gradually expanding retry window for reconnects\r\n            var sendFunc = function () {\r\n                req.date = new Date();\r\n                if (self._conn.options.customHeaders){\r\n                    var headers = self._conn.options.customHeaders;\r\n                    for (var header in headers) {\r\n                        if (headers.hasOwnProperty(header)) {\r\n                            req.xhr.setRequestHeader(header, headers[header]);\r\n                        }\r\n                    }\r\n                }\r\n                req.xhr.send(req.data);\r\n            };\r\n\r\n            // Implement progressive backoff for reconnects --\r\n            // First retry (send === 1) should also be instantaneous\r\n            if (req.sends > 1) {\r\n                // Using a cube of the retry number creates a nicely\r\n                // expanding retry window\r\n                var backoff = Math.min(Math.floor(Strophe.TIMEOUT * this.wait),\r\n                                       Math.pow(req.sends, 3)) * 1000;\r\n                setTimeout(function() {\r\n                    // XXX: setTimeout should be called only with function expressions (23974bc1)\r\n                    sendFunc();\r\n                }, backoff);\r\n            } else {\r\n                sendFunc();\r\n            }\r\n\r\n            req.sends++;\r\n\r\n            if (this._conn.xmlOutput !== Strophe.Connection.prototype.xmlOutput) {\r\n                if (req.xmlData.nodeName === this.strip && req.xmlData.childNodes.length) {\r\n                    this._conn.xmlOutput(req.xmlData.childNodes[0]);\r\n                } else {\r\n                    this._conn.xmlOutput(req.xmlData);\r\n                }\r\n            }\r\n            if (this._conn.rawOutput !== Strophe.Connection.prototype.rawOutput) {\r\n                this._conn.rawOutput(req.data);\r\n            }\r\n        } else {\r\n            Strophe.debug(\"_processRequest: \" +\r\n                          (i === 0 ? \"first\" : \"second\") +\r\n                          \" request has readyState of \" +\r\n                          req.xhr.readyState);\r\n        }\r\n    },\r\n\r\n    /** PrivateFunction: _removeRequest\r\n     *  _Private_ function to remove a request from the queue.\r\n     *\r\n     *  Parameters:\r\n     *    (Strophe.Request) req - The request to remove.\r\n     */\r\n    _removeRequest: function (req) {\r\n        Strophe.debug(\"removing request\");\r\n        var i;\r\n        for (i = this._requests.length - 1; i >= 0; i--) {\r\n            if (req === this._requests[i]) {\r\n                this._requests.splice(i, 1);\r\n            }\r\n        }\r\n        // IE6 fails on setting to null, so set to empty function\r\n        req.xhr.onreadystatechange = function () {};\r\n        this._throttledRequestHandler();\r\n    },\r\n\r\n    /** PrivateFunction: _restartRequest\r\n     *  _Private_ function to restart a request that is presumed dead.\r\n     *\r\n     *  Parameters:\r\n     *    (Integer) i - The index of the request in the queue.\r\n     */\r\n    _restartRequest: function (i) {\r\n        var req = this._requests[i];\r\n        if (req.dead === null) {\r\n            req.dead = new Date();\r\n        }\r\n\r\n        this._processRequest(i);\r\n    },\r\n\r\n    /** PrivateFunction: _reqToData\r\n     * _Private_ function to get a stanza out of a request.\r\n     *\r\n     * Tries to extract a stanza out of a Request Object.\r\n     * When this fails the current connection will be disconnected.\r\n     *\r\n     *  Parameters:\r\n     *    (Object) req - The Request.\r\n     *\r\n     *  Returns:\r\n     *    The stanza that was passed.\r\n     */\r\n    _reqToData: function (req) {\r\n        try {\r\n            return req.getResponse();\r\n        } catch (e) {\r\n            if (e !== \"parsererror\") { throw e; }\r\n            this._conn.disconnect(\"strophe-parsererror\");\r\n        }\r\n    },\r\n\r\n    /** PrivateFunction: _sendTerminate\r\n     *  _Private_ function to send initial disconnect sequence.\r\n     *\r\n     *  This is the first step in a graceful disconnect.  It sends\r\n     *  the BOSH server a terminate body and includes an unavailable\r\n     *  presence if authentication has completed.\r\n     */\r\n    _sendTerminate: function (pres) {\r\n        Strophe.info(\"_sendTerminate was called\");\r\n        var body = this._buildBody().attrs({type: \"terminate\"});\r\n        if (pres) {\r\n            body.cnode(pres.tree());\r\n        }\r\n        var req = new Strophe.Request(\r\n            body.tree(),\r\n            this._onRequestStateChange.bind(\r\n            this, this._conn._dataRecv.bind(this._conn)),\r\n            body.tree().getAttribute(\"rid\")\r\n        );\r\n        this._requests.push(req);\r\n        this._throttledRequestHandler();\r\n    },\r\n\r\n    /** PrivateFunction: _send\r\n     *  _Private_ part of the Connection.send function for BOSH\r\n     *\r\n     * Just triggers the RequestHandler to send the messages that are in the queue\r\n     */\r\n    _send: function () {\r\n        clearTimeout(this._conn._idleTimeout);\r\n        this._throttledRequestHandler();\r\n\r\n        // XXX: setTimeout should be called only with function expressions (23974bc1)\r\n        this._conn._idleTimeout = setTimeout(function() {\r\n            this._onIdle();\r\n        }.bind(this._conn), 100);\r\n    },\r\n\r\n    /** PrivateFunction: _sendRestart\r\n     *\r\n     *  Send an xmpp:restart stanza.\r\n     */\r\n    _sendRestart: function () {\r\n        this._throttledRequestHandler();\r\n        clearTimeout(this._conn._idleTimeout);\r\n    },\r\n\r\n    /** PrivateFunction: _throttledRequestHandler\r\n     *  _Private_ function to throttle requests to the connection window.\r\n     *\r\n     *  This function makes sure we don't send requests so fast that the\r\n     *  request ids overflow the connection window in the case that one\r\n     *  request died.\r\n     */\r\n    _throttledRequestHandler: function () {\r\n        if (!this._requests) {\r\n            Strophe.debug(\"_throttledRequestHandler called with \" +\r\n                          \"undefined requests\");\r\n        } else {\r\n            Strophe.debug(\"_throttledRequestHandler called with \" +\r\n                          this._requests.length + \" requests\");\r\n        }\r\n\r\n        if (!this._requests || this._requests.length === 0) {\r\n            return;\r\n        }\r\n\r\n        if (this._requests.length > 0) {\r\n            this._processRequest(0);\r\n        }\r\n\r\n        if (this._requests.length > 1 &&\r\n            Math.abs(this._requests[0].rid -\r\n                     this._requests[1].rid) < this.window) {\r\n            this._processRequest(1);\r\n        }\r\n    }\r\n};\r\nreturn Strophe;\r\n}));\r\n\r\n/*\r\n    This program is distributed under the terms of the MIT license.\r\n    Please see the LICENSE file for details.\r\n\r\n    Copyright 2006-2008, OGG, LLC\r\n*/\r\n\r\n/* jshint undef: true, unused: true:, noarg: true, latedef: true */\r\n/* global define, window, clearTimeout, WebSocket, DOMParser, Strophe, $build */\r\n\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('strophe-websocket',['strophe-core'], function (core) {\r\n            return factory(\r\n                core.Strophe,\r\n                core.$build\r\n            );\r\n        });\r\n    } else if (typeof exports === 'object') {\r\n        var core = require('./core');\r\n\r\n        module.exports = factory(core.Strophe, core.$build);\r\n    } else {\r\n        // Browser globals\r\n        return factory(Strophe, $build);\r\n    }\r\n}(this, function (Strophe, $build) {\r\n\r\n/** Class: Strophe.WebSocket\r\n *  _Private_ helper class that handles WebSocket Connections\r\n *\r\n *  The Strophe.WebSocket class is used internally by Strophe.Connection\r\n *  to encapsulate WebSocket sessions. It is not meant to be used from user's code.\r\n */\r\n\r\n/** File: websocket.js\r\n *  A JavaScript library to enable XMPP over Websocket in Strophejs.\r\n *\r\n *  This file implements XMPP over WebSockets for Strophejs.\r\n *  If a Connection is established with a Websocket url (ws://...)\r\n *  Strophe will use WebSockets.\r\n *  For more information on XMPP-over-WebSocket see RFC 7395:\r\n *  http://tools.ietf.org/html/rfc7395\r\n *\r\n *  WebSocket support implemented by Andreas Guth (andreas.guth@rwth-aachen.de)\r\n */\r\n\r\n/** PrivateConstructor: Strophe.Websocket\r\n *  Create and initialize a Strophe.WebSocket object.\r\n *  Currently only sets the connection Object.\r\n *\r\n *  Parameters:\r\n *    (Strophe.Connection) connection - The Strophe.Connection that will use WebSockets.\r\n *\r\n *  Returns:\r\n *    A new Strophe.WebSocket object.\r\n */\r\nStrophe.Websocket = function(connection) {\r\n    this._conn = connection;\r\n    this.strip = \"wrapper\";\r\n\r\n    var service = connection.service;\r\n    if (service.indexOf(\"ws:\") !== 0 && service.indexOf(\"wss:\") !== 0) {\r\n        // If the service is not an absolute URL, assume it is a path and put the absolute\r\n        // URL together from options, current URL and the path.\r\n        var new_service = \"\";\r\n\r\n        if (connection.options.protocol === \"ws\" && window.location.protocol !== \"https:\") {\r\n            new_service += \"ws\";\r\n        } else {\r\n            new_service += \"wss\";\r\n        }\r\n\r\n        new_service += \"://\" + window.location.host;\r\n\r\n        if (service.indexOf(\"/\") !== 0) {\r\n            new_service += window.location.pathname + service;\r\n        } else {\r\n            new_service += service;\r\n        }\r\n\r\n        connection.service = new_service;\r\n    }\r\n};\r\n\r\nStrophe.Websocket.prototype = {\r\n    /** PrivateFunction: _buildStream\r\n     *  _Private_ helper function to generate the <stream> start tag for WebSockets\r\n     *\r\n     *  Returns:\r\n     *    A Strophe.Builder with a <stream> element.\r\n     */\r\n    _buildStream: function () {\r\n        return $build(\"open\", {\r\n            \"xmlns\": Strophe.NS.FRAMING,\r\n            \"to\": this._conn.domain,\r\n            \"version\": '1.0'\r\n        });\r\n    },\r\n\r\n    /** PrivateFunction: _check_streamerror\r\n     * _Private_ checks a message for stream:error\r\n     *\r\n     *  Parameters:\r\n     *    (Strophe.Request) bodyWrap - The received stanza.\r\n     *    connectstatus - The ConnectStatus that will be set on error.\r\n     *  Returns:\r\n     *     true if there was a streamerror, false otherwise.\r\n     */\r\n    _check_streamerror: function (bodyWrap, connectstatus) {\r\n        var errors;\r\n        if (bodyWrap.getElementsByTagNameNS) {\r\n            errors = bodyWrap.getElementsByTagNameNS(Strophe.NS.STREAM, \"error\");\r\n        } else {\r\n            errors = bodyWrap.getElementsByTagName(\"stream:error\");\r\n        }\r\n        if (errors.length === 0) {\r\n            return false;\r\n        }\r\n        var error = errors[0];\r\n\r\n        var condition = \"\";\r\n        var text = \"\";\r\n\r\n        var ns = \"urn:ietf:params:xml:ns:xmpp-streams\";\r\n        for (var i = 0; i < error.childNodes.length; i++) {\r\n            var e = error.childNodes[i];\r\n            if (e.getAttribute(\"xmlns\") !== ns) {\r\n                break;\r\n            } if (e.nodeName === \"text\") {\r\n                text = e.textContent;\r\n            } else {\r\n                condition = e.nodeName;\r\n            }\r\n        }\r\n\r\n        var errorString = \"WebSocket stream error: \";\r\n\r\n        if (condition) {\r\n            errorString += condition;\r\n        } else {\r\n            errorString += \"unknown\";\r\n        }\r\n\r\n        if (text) {\r\n            errorString += \" - \" + text;\r\n        }\r\n\r\n        Strophe.error(errorString);\r\n\r\n        // close the connection on stream_error\r\n        this._conn._changeConnectStatus(connectstatus, condition);\r\n        this._conn._doDisconnect();\r\n        return true;\r\n    },\r\n\r\n    /** PrivateFunction: _reset\r\n     *  Reset the connection.\r\n     *\r\n     *  This function is called by the reset function of the Strophe Connection.\r\n     *  Is not needed by WebSockets.\r\n     */\r\n    _reset: function () {\r\n        return;\r\n    },\r\n\r\n    /** PrivateFunction: _connect\r\n     *  _Private_ function called by Strophe.Connection.connect\r\n     *\r\n     *  Creates a WebSocket for a connection and assigns Callbacks to it.\r\n     *  Does nothing if there already is a WebSocket.\r\n     */\r\n    _connect: function () {\r\n        // Ensure that there is no open WebSocket from a previous Connection.\r\n        this._closeSocket();\r\n\r\n        // Create the new WobSocket\r\n        this.socket = new WebSocket(this._conn.service, \"xmpp\");\r\n        this.socket.onopen = this._onOpen.bind(this);\r\n        this.socket.onerror = this._onError.bind(this);\r\n        this.socket.onclose = this._onClose.bind(this);\r\n        this.socket.onmessage = this._connect_cb_wrapper.bind(this);\r\n    },\r\n\r\n    /** PrivateFunction: _connect_cb\r\n     *  _Private_ function called by Strophe.Connection._connect_cb\r\n     *\r\n     * checks for stream:error\r\n     *\r\n     *  Parameters:\r\n     *    (Strophe.Request) bodyWrap - The received stanza.\r\n     */\r\n    _connect_cb: function(bodyWrap) {\r\n        var error = this._check_streamerror(bodyWrap, Strophe.Status.CONNFAIL);\r\n        if (error) {\r\n            return Strophe.Status.CONNFAIL;\r\n        }\r\n    },\r\n\r\n    /** PrivateFunction: _handleStreamStart\r\n     * _Private_ function that checks the opening <open /> tag for errors.\r\n     *\r\n     * Disconnects if there is an error and returns false, true otherwise.\r\n     *\r\n     *  Parameters:\r\n     *    (Node) message - Stanza containing the <open /> tag.\r\n     */\r\n    _handleStreamStart: function(message) {\r\n        var error = false;\r\n\r\n        // Check for errors in the <open /> tag\r\n        var ns = message.getAttribute(\"xmlns\");\r\n        if (typeof ns !== \"string\") {\r\n            error = \"Missing xmlns in <open />\";\r\n        } else if (ns !== Strophe.NS.FRAMING) {\r\n            error = \"Wrong xmlns in <open />: \" + ns;\r\n        }\r\n\r\n        var ver = message.getAttribute(\"version\");\r\n        if (typeof ver !== \"string\") {\r\n            error = \"Missing version in <open />\";\r\n        } else if (ver !== \"1.0\") {\r\n            error = \"Wrong version in <open />: \" + ver;\r\n        }\r\n\r\n        if (error) {\r\n            this._conn._changeConnectStatus(Strophe.Status.CONNFAIL, error);\r\n            this._conn._doDisconnect();\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    /** PrivateFunction: _connect_cb_wrapper\r\n     * _Private_ function that handles the first connection messages.\r\n     *\r\n     * On receiving an opening stream tag this callback replaces itself with the real\r\n     * message handler. On receiving a stream error the connection is terminated.\r\n     */\r\n    _connect_cb_wrapper: function(message) {\r\n        if (message.data.indexOf(\"<open \") === 0 || message.data.indexOf(\"<?xml\") === 0) {\r\n            // Strip the XML Declaration, if there is one\r\n            var data = message.data.replace(/^(<\\?.*?\\?>\\s*)*/, \"\");\r\n            if (data === '') return;\r\n\r\n            var streamStart = new DOMParser().parseFromString(data, \"text/xml\").documentElement;\r\n            this._conn.xmlInput(streamStart);\r\n            this._conn.rawInput(message.data);\r\n\r\n            //_handleStreamSteart will check for XML errors and disconnect on error\r\n            if (this._handleStreamStart(streamStart)) {\r\n                //_connect_cb will check for stream:error and disconnect on error\r\n                this._connect_cb(streamStart);\r\n            }\r\n        } else if (message.data.indexOf(\"<close \") === 0) { // <close xmlns=\"urn:ietf:params:xml:ns:xmpp-framing />\r\n            this._conn.rawInput(message.data);\r\n            this._conn.xmlInput(message);\r\n            var see_uri = message.getAttribute(\"see-other-uri\");\r\n            if (see_uri) {\r\n                this._conn._changeConnectStatus(\r\n                    Strophe.Status.REDIRECT,\r\n                    \"Received see-other-uri, resetting connection\"\r\n                );\r\n                this._conn.reset();\r\n                this._conn.service = see_uri;\r\n                this._connect();\r\n            } else {\r\n                this._conn._changeConnectStatus(\r\n                    Strophe.Status.CONNFAIL,\r\n                    \"Received closing stream\"\r\n                );\r\n                this._conn._doDisconnect();\r\n            }\r\n        } else {\r\n            var string = this._streamWrap(message.data);\r\n            var elem = new DOMParser().parseFromString(string, \"text/xml\").documentElement;\r\n            this.socket.onmessage = this._onMessage.bind(this);\r\n            this._conn._connect_cb(elem, null, message.data);\r\n        }\r\n    },\r\n\r\n    /** PrivateFunction: _disconnect\r\n     *  _Private_ function called by Strophe.Connection.disconnect\r\n     *\r\n     *  Disconnects and sends a last stanza if one is given\r\n     *\r\n     *  Parameters:\r\n     *    (Request) pres - This stanza will be sent before disconnecting.\r\n     */\r\n    _disconnect: function (pres) {\r\n        if (this.socket && this.socket.readyState !== WebSocket.CLOSED) {\r\n            if (pres) {\r\n                this._conn.send(pres);\r\n            }\r\n            var close = $build(\"close\", { \"xmlns\": Strophe.NS.FRAMING });\r\n            this._conn.xmlOutput(close.tree());\r\n            var closeString = Strophe.serialize(close);\r\n            this._conn.rawOutput(closeString);\r\n            try {\r\n                this.socket.send(closeString);\r\n            } catch (e) {\r\n                Strophe.info(\"Couldn't send <close /> tag.\");\r\n            }\r\n        }\r\n        this._conn._doDisconnect();\r\n    },\r\n\r\n    /** PrivateFunction: _doDisconnect\r\n     *  _Private_ function to disconnect.\r\n     *\r\n     *  Just closes the Socket for WebSockets\r\n     */\r\n    _doDisconnect: function () {\r\n        Strophe.info(\"WebSockets _doDisconnect was called\");\r\n        this._closeSocket();\r\n    },\r\n\r\n    /** PrivateFunction _streamWrap\r\n     *  _Private_ helper function to wrap a stanza in a <stream> tag.\r\n     *  This is used so Strophe can process stanzas from WebSockets like BOSH\r\n     */\r\n    _streamWrap: function (stanza) {\r\n        return \"<wrapper>\" + stanza + '</wrapper>';\r\n    },\r\n\r\n\r\n    /** PrivateFunction: _closeSocket\r\n     *  _Private_ function to close the WebSocket.\r\n     *\r\n     *  Closes the socket if it is still open and deletes it\r\n     */\r\n    _closeSocket: function () {\r\n        if (this.socket) { try {\r\n            this.socket.onerror = null;\r\n            this.socket.close();\r\n        } catch (e) {} }\r\n        this.socket = null;\r\n    },\r\n\r\n    /** PrivateFunction: _emptyQueue\r\n     * _Private_ function to check if the message queue is empty.\r\n     *\r\n     *  Returns:\r\n     *    True, because WebSocket messages are send immediately after queueing.\r\n     */\r\n    _emptyQueue: function () {\r\n        return true;\r\n    },\r\n\r\n    /** PrivateFunction: _onClose\r\n     * _Private_ function to handle websockets closing.\r\n     *\r\n     * Nothing to do here for WebSockets\r\n     */\r\n    _onClose: function(e) {\r\n        if(this._conn.connected && !this._conn.disconnecting) {\r\n            Strophe.error(\"Websocket closed unexpectedly\");\r\n            this._conn._doDisconnect();\r\n        } else if (e && e.code === 1006 && !this._conn.connected && this.socket) {\r\n            // in case the onError callback was not called (Safari 10 does not\r\n            // call onerror when the initial connection fails) we need to\r\n            // dispatch a CONNFAIL status update to be consistent with the\r\n            // behavior on other browsers.\r\n            Strophe.error(\"Websocket closed unexcectedly\");\r\n            this._conn._changeConnectStatus(\r\n                Strophe.Status.CONNFAIL,\r\n                \"The WebSocket connection could not be established or was disconnected.\"\r\n            );\r\n            this._conn._doDisconnect();\r\n        } else {\r\n            Strophe.info(\"Websocket closed\");\r\n        }\r\n    },\r\n\r\n    /** PrivateFunction: _onDisconnectTimeout\r\n     *  _Private_ timeout handler for handling non-graceful disconnection.\r\n     *\r\n     *  This does nothing for WebSockets\r\n     */\r\n    _onDisconnectTimeout: function () {},\r\n\r\n    /** PrivateFunction: _abortAllRequests\r\n     *  _Private_ helper function that makes sure all pending requests are aborted.\r\n     */\r\n    _abortAllRequests: function () {},\r\n\r\n    /** PrivateFunction: _onError\r\n     * _Private_ function to handle websockets errors.\r\n     *\r\n     * Parameters:\r\n     * (Object) error - The websocket error.\r\n     */\r\n    _onError: function(error) {\r\n        Strophe.error(\"Websocket error \" + error);\r\n        this._conn._changeConnectStatus(\r\n            Strophe.Status.CONNFAIL,\r\n            \"The WebSocket connection could not be established or was disconnected.\"\r\n        );\r\n        this._disconnect();\r\n    },\r\n\r\n    /** PrivateFunction: _onIdle\r\n     *  _Private_ function called by Strophe.Connection._onIdle\r\n     *\r\n     *  sends all queued stanzas\r\n     */\r\n    _onIdle: function () {\r\n        var data = this._conn._data;\r\n        if (data.length > 0 && !this._conn.paused) {\r\n            for (var i = 0; i < data.length; i++) {\r\n                if (data[i] !== null) {\r\n                    var stanza, rawStanza;\r\n                    if (data[i] === \"restart\") {\r\n                        stanza = this._buildStream().tree();\r\n                    } else {\r\n                        stanza = data[i];\r\n                    }\r\n                    rawStanza = Strophe.serialize(stanza);\r\n                    this._conn.xmlOutput(stanza);\r\n                    this._conn.rawOutput(rawStanza);\r\n                    this.socket.send(rawStanza);\r\n                }\r\n            }\r\n            this._conn._data = [];\r\n        }\r\n    },\r\n\r\n    /** PrivateFunction: _onMessage\r\n     * _Private_ function to handle websockets messages.\r\n     *\r\n     * This function parses each of the messages as if they are full documents.\r\n     * [TODO : We may actually want to use a SAX Push parser].\r\n     *\r\n     * Since all XMPP traffic starts with\r\n     *  <stream:stream version='1.0'\r\n     *                 xml:lang='en'\r\n     *                 xmlns='jabber:client'\r\n     *                 xmlns:stream='http://etherx.jabber.org/streams'\r\n     *                 id='3697395463'\r\n     *                 from='SERVER'>\r\n     *\r\n     * The first stanza will always fail to be parsed.\r\n     *\r\n     * Additionally, the seconds stanza will always be <stream:features> with\r\n     * the stream NS defined in the previous stanza, so we need to 'force'\r\n     * the inclusion of the NS in this stanza.\r\n     *\r\n     * Parameters:\r\n     * (string) message - The websocket message.\r\n     */\r\n    _onMessage: function(message) {\r\n        var elem, data;\r\n        // check for closing stream\r\n        var close = '<close xmlns=\"urn:ietf:params:xml:ns:xmpp-framing\" />';\r\n        if (message.data === close) {\r\n            this._conn.rawInput(close);\r\n            this._conn.xmlInput(message);\r\n            if (!this._conn.disconnecting) {\r\n                this._conn._doDisconnect();\r\n            }\r\n            return;\r\n        } else if (message.data.search(\"<open \") === 0) {\r\n            // This handles stream restarts\r\n            elem = new DOMParser().parseFromString(message.data, \"text/xml\").documentElement;\r\n            if (!this._handleStreamStart(elem)) {\r\n                return;\r\n            }\r\n        } else {\r\n            data = this._streamWrap(message.data);\r\n            elem = new DOMParser().parseFromString(data, \"text/xml\").documentElement;\r\n        }\r\n\r\n        if (this._check_streamerror(elem, Strophe.Status.ERROR)) {\r\n            return;\r\n        }\r\n\r\n        //handle unavailable presence stanza before disconnecting\r\n        if (this._conn.disconnecting &&\r\n                elem.firstChild.nodeName === \"presence\" &&\r\n                elem.firstChild.getAttribute(\"type\") === \"unavailable\") {\r\n            this._conn.xmlInput(elem);\r\n            this._conn.rawInput(Strophe.serialize(elem));\r\n            // if we are already disconnecting we will ignore the unavailable stanza and\r\n            // wait for the </stream:stream> tag before we close the connection\r\n            return;\r\n        }\r\n        this._conn._dataRecv(elem, message.data);\r\n    },\r\n\r\n    /** PrivateFunction: _onOpen\r\n     * _Private_ function to handle websockets connection setup.\r\n     *\r\n     * The opening stream tag is sent here.\r\n     */\r\n    _onOpen: function() {\r\n        Strophe.info(\"Websocket open\");\r\n        var start = this._buildStream();\r\n        this._conn.xmlOutput(start.tree());\r\n\r\n        var startString = Strophe.serialize(start);\r\n        this._conn.rawOutput(startString);\r\n        this.socket.send(startString);\r\n    },\r\n\r\n    /** PrivateFunction: _reqToData\r\n     * _Private_ function to get a stanza out of a request.\r\n     *\r\n     * WebSockets don't use requests, so the passed argument is just returned.\r\n     *\r\n     *  Parameters:\r\n     *    (Object) stanza - The stanza.\r\n     *\r\n     *  Returns:\r\n     *    The stanza that was passed.\r\n     */\r\n    _reqToData: function (stanza) {\r\n        return stanza;\r\n    },\r\n\r\n    /** PrivateFunction: _send\r\n     *  _Private_ part of the Connection.send function for WebSocket\r\n     *\r\n     * Just flushes the messages that are in the queue\r\n     */\r\n    _send: function () {\r\n        this._conn.flush();\r\n    },\r\n\r\n    /** PrivateFunction: _sendRestart\r\n     *\r\n     *  Send an xmpp:restart stanza.\r\n     */\r\n    _sendRestart: function () {\r\n        clearTimeout(this._conn._idleTimeout);\r\n        this._conn._onIdle.bind(this._conn)();\r\n    }\r\n};\r\nreturn Strophe;\r\n}));\r\n\r\n(function(root){\r\n    if(typeof define === 'function' && define.amd){\r\n        define('strophe',[\r\n            \"strophe-core\",\r\n            \"strophe-bosh\",\r\n            \"strophe-websocket\"\r\n        ], function (wrapper) {\r\n            return wrapper;\r\n        });\r\n    } else if (typeof exports === 'object') {\r\n        var core = require('./core');\r\n        require('./bosh');\r\n        require('./websocket');\r\n        module.exports = core;\r\n    }\r\n})(this);\r\n\r\n\r\nrequire([\"strophe-polyfill\"]);\r\n/* jshint ignore:start */\r\n    //The modules for your project will be inlined above\r\n    //this snippet. Ask almond to synchronously require the\r\n    //module value for 'main' here and return it as the\r\n    //value to use for the public API for the built file.\r\n    return require('strophe');\r\n}));\r\n/* jshint ignore:end */\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/strophe.js/strophe.js","/**\r\n * This utility class defines custom onerror and onunhandledrejection functions.\r\n * The custom error handlers respect the previously-defined error handlers.\r\n * GlobalOnErrorHandler class provides utilities to add many custom error\r\n * handlers and to execute the error handlers directly.\r\n */\r\n\r\n\r\n/**\r\n * List with global error handlers that will be executed.\r\n */\r\nconst handlers = [];\r\n\r\n// If an old handler exists, also fire its events.\r\nconst oldOnErrorHandler = window.onerror;\r\n\r\n/**\r\n * Custom error handler that calls the old global error handler and executes\r\n * all handlers that were previously added.\r\n */\r\nfunction JitsiGlobalErrorHandler(...args) {\r\n    handlers.forEach(handler => handler(...args));\r\n    oldOnErrorHandler && oldOnErrorHandler(...args);\r\n}\r\n\r\n// If an old handler exists, also fire its events.\r\nconst oldOnUnhandledRejection = window.onunhandledrejection;\r\n\r\n/**\r\n * Custom handler that calls the old global handler and executes all handlers\r\n * that were previously added. This handler handles rejected Promises.\r\n */\r\nfunction JitsiGlobalUnhandledRejection(event) {\r\n    handlers.forEach(handler => handler(null, null, null, null, event.reason));\r\n    oldOnUnhandledRejection && oldOnUnhandledRejection(event);\r\n}\r\n\r\n// Setting the custom error handlers.\r\nwindow.onerror = JitsiGlobalErrorHandler;\r\nwindow.onunhandledrejection = JitsiGlobalUnhandledRejection;\r\n\r\nconst GlobalOnErrorHandler = {\r\n    /**\r\n     * Adds new error handlers.\r\n     * @param handler the new handler.\r\n     */\r\n    addHandler(handler) {\r\n        handlers.push(handler);\r\n    },\r\n\r\n    /**\r\n     * Calls the global error handler if there is one.\r\n     * @param error the error to pass to the error handler\r\n     */\r\n    callErrorHandler(error) {\r\n        const errHandler = window.onerror;\r\n\r\n        if (!errHandler) {\r\n            return;\r\n        }\r\n        errHandler(null, null, null, null, error);\r\n    },\r\n\r\n    /**\r\n     * Calls the global rejection handler if there is one.\r\n     * @param error the error to pass to the rejection handler.\r\n     */\r\n    callUnhandledRejectionHandler(error) {\r\n        const errHandler = window.onunhandledrejection;\r\n\r\n        if (!errHandler) {\r\n            return;\r\n        }\r\n        errHandler(error);\r\n    }\r\n};\r\n\r\n\r\nmodule.exports = GlobalOnErrorHandler;\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/util/GlobalOnErrorHandler.js","/**\r\n * The audio type.\r\n */\r\nexport const AUDIO = 'audio';\r\n\r\n/**\r\n * The video type.\r\n */\r\nexport const VIDEO = 'video';\r\n\n\n\n// WEBPACK FOOTER //\n// ./service/RTC/MediaType.js","import EventEmitter from 'events';\r\n\r\nimport { FEEDBACK } from '../../service/statistics/AnalyticsEvents';\r\nimport analytics from './AnalyticsAdapter';\r\nimport CallStats from './CallStats';\r\nimport LocalStats from './LocalStatsCollector';\r\nimport RTPStats from './RTPStatsCollector';\r\n\r\nimport browser from '../browser';\r\nimport Settings from '../settings/Settings';\r\nimport ScriptUtil from '../util/ScriptUtil';\r\nimport JitsiTrackError from '../../JitsiTrackError';\r\nimport * as StatisticsEvents from '../../service/statistics/Events';\r\n\r\nconst logger = require('jitsi-meet-logger').getLogger(__filename);\r\n\r\n/**\r\n * Stores all active {@link Statistics} instances.\r\n * @type {Set<Statistics>}\r\n */\r\nlet _instances;\r\n\r\n/**\r\n * True if callstats API is loaded\r\n */\r\nlet isCallstatsLoaded = false;\r\n\r\n/**\r\n * Since callstats.io is a third party, we cannot guarantee the quality of their\r\n * service. More specifically, their server may take noticeably long time to\r\n * respond. Consequently, it is in our best interest (in the sense that the\r\n * intergration of callstats.io is pretty important to us but not enough to\r\n * allow it to prevent people from joining a conference) to (1) start\r\n * downloading their API as soon as possible and (2) do the downloading\r\n * asynchronously.\r\n *\r\n * @param {StatisticsOptions} options - Options to use for downloading and\r\n * initializing callstats backend.\r\n */\r\nfunction loadCallStatsAPI(options) {\r\n    if (!isCallstatsLoaded) {\r\n        ScriptUtil.loadScript(\r\n            options.customScriptUrl\r\n                || 'https://api.callstats.io/static/callstats-ws.min.js',\r\n            /* async */ true,\r\n            /* prepend */ true,\r\n            /* relativeURL */ undefined,\r\n            /* loadCallback */ () => _initCallStatsBackend(options)\r\n        );\r\n        isCallstatsLoaded = true;\r\n    }\r\n}\r\n\r\n/**\r\n * Initializes Callstats backend.\r\n *\r\n * @param {StatisticsOptions} options - The options to use for initializing\r\n * callstats backend.\r\n * @private\r\n */\r\nfunction _initCallStatsBackend(options) {\r\n    if (CallStats.isBackendInitialized()) {\r\n        return;\r\n    }\r\n\r\n    const userName = Settings.callStatsUserName;\r\n\r\n    if (!CallStats.initBackend({\r\n        callStatsID: options.callStatsID,\r\n        callStatsSecret: options.callStatsSecret,\r\n        userName: options.swapUserNameAndAlias\r\n            ? options.callStatsAliasName : userName,\r\n        aliasName: options.swapUserNameAndAlias\r\n            ? userName : options.callStatsAliasName,\r\n        applicationName: options.applicationName,\r\n        getWiFiStatsMethod: options.getWiFiStatsMethod\r\n    })) {\r\n        logger.error('CallStats Backend initialization failed bad');\r\n    }\r\n}\r\n\r\n/**\r\n * callstats strips any additional fields from Error except for \"name\", \"stack\",\r\n * \"message\" and \"constraintName\". So we need to bundle additional information\r\n * from JitsiTrackError into error passed to callstats to preserve valuable\r\n * information about error.\r\n * @param {JitsiTrackError} error\r\n */\r\nfunction formatJitsiTrackErrorForCallStats(error) {\r\n    const err = new Error();\r\n\r\n    // Just copy original stack from error\r\n    err.stack = error.stack;\r\n\r\n    // Combine name from error's name plus (possibly) name of original GUM error\r\n    err.name = (error.name || 'Unknown error') + (error.gum && error.gum.error\r\n        && error.gum.error.name ? ` - ${error.gum.error.name}` : '');\r\n\r\n    // Put all constraints into this field. For constraint failed errors we will\r\n    // still know which exactly constraint failed as it will be a part of\r\n    // message.\r\n    err.constraintName = error.gum && error.gum.constraints\r\n        ? JSON.stringify(error.gum.constraints) : '';\r\n\r\n    // Just copy error's message.\r\n    err.message = error.message;\r\n\r\n    return err;\r\n}\r\n\r\n/**\r\n * Init statistic options\r\n * @param options\r\n */\r\nStatistics.init = function(options) {\r\n    Statistics.audioLevelsEnabled = !options.disableAudioLevels;\r\n\r\n    if (typeof options.audioLevelsInterval === 'number') {\r\n        Statistics.audioLevelsInterval = options.audioLevelsInterval;\r\n    }\r\n\r\n    Statistics.disableThirdPartyRequests = options.disableThirdPartyRequests;\r\n};\r\n\r\n/**\r\n * The options to configure Statistics.\r\n * @typedef {Object} StatisticsOptions\r\n * @property {string} applicationName - The application name to pass to\r\n * callstats.\r\n * @property {string} callStatsAliasName - The alias name to use when\r\n * initializing callstats.\r\n * @property {string} callStatsConfIDNamespace - A namespace to prepend the\r\n * callstats conference ID with.\r\n * @property {string} callStatsID - Callstats credentials - the id.\r\n * @property {string} callStatsSecret - Callstats credentials - the secret.\r\n * @property {string} customScriptUrl - A custom lib url to use when downloading\r\n * callstats library.\r\n * @property {string} roomName - The room name we are currently in.\r\n * @property {boolean} swapUserNameAndAlias - Whether to swap the places of\r\n * username and alias when initiating callstats.\r\n */\r\n/**\r\n *\r\n * @param xmpp\r\n * @param {StatisticsOptions} options - The options to use creating the\r\n * Statistics.\r\n */\r\nexport default function Statistics(xmpp, options) {\r\n    /**\r\n     * {@link RTPStats} mapped by {@link TraceablePeerConnection.id} which\r\n     * collect RTP statistics for each peerconnection.\r\n     * @type {Map<string, RTPStats}\r\n     */\r\n    this.rtpStatsMap = new Map();\r\n    this.eventEmitter = new EventEmitter();\r\n    this.xmpp = xmpp;\r\n    this.options = options || {};\r\n\r\n    this.callStatsIntegrationEnabled\r\n        = this.options.callStatsID && this.options.callStatsSecret\r\n\r\n            // Even though AppID and AppSecret may be specified, the integration\r\n            // of callstats.io may be disabled because of globally-disallowed\r\n            // requests to any third parties.\r\n            && (Statistics.disableThirdPartyRequests !== true);\r\n    if (this.callStatsIntegrationEnabled) {\r\n        if (browser.isReactNative()) {\r\n            _initCallStatsBackend(this.options);\r\n        } else {\r\n            loadCallStatsAPI(this.options);\r\n        }\r\n\r\n        if (!this.options.callStatsConfIDNamespace) {\r\n            logger.warn('\"callStatsConfIDNamespace\" is not defined');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Stores {@link CallStats} instances for each\r\n     * {@link TraceablePeerConnection} (one {@link CallStats} instance serves\r\n     * one TPC). The instances are mapped by {@link TraceablePeerConnection.id}.\r\n     * @type {Map<number, CallStats>}\r\n     */\r\n    this.callsStatsInstances = new Map();\r\n\r\n    Statistics.instances.add(this);\r\n}\r\nStatistics.audioLevelsEnabled = false;\r\nStatistics.audioLevelsInterval = 200;\r\nStatistics.disableThirdPartyRequests = false;\r\nStatistics.analytics = analytics;\r\n\r\nObject.defineProperty(Statistics, 'instances', {\r\n    /**\r\n     * Returns the Set holding all active {@link Statistics} instances. Lazily\r\n     * initializes the Set to allow any Set polyfills to be applied.\r\n     * @type {Set<Statistics>}\r\n     */\r\n    get() {\r\n        if (!_instances) {\r\n            _instances = new Set();\r\n        }\r\n\r\n        return _instances;\r\n    }\r\n});\r\n\r\n/**\r\n * Starts collecting RTP stats for given peerconnection.\r\n * @param {TraceablePeerConnection} peerconnection\r\n */\r\nStatistics.prototype.startRemoteStats = function(peerconnection) {\r\n    this.stopRemoteStats(peerconnection);\r\n\r\n    try {\r\n        const rtpStats\r\n            = new RTPStats(\r\n                peerconnection,\r\n                Statistics.audioLevelsInterval,\r\n                2000,\r\n                this.eventEmitter);\r\n\r\n        rtpStats.start(Statistics.audioLevelsEnabled);\r\n        this.rtpStatsMap.set(peerconnection.id, rtpStats);\r\n    } catch (e) {\r\n        logger.error(`Failed to start collecting remote statistics: ${e}`);\r\n    }\r\n};\r\n\r\nStatistics.localStats = [];\r\n\r\nStatistics.startLocalStats = function(stream, callback) {\r\n    if (!Statistics.audioLevelsEnabled) {\r\n        return;\r\n    }\r\n    const localStats = new LocalStats(stream, Statistics.audioLevelsInterval,\r\n        callback);\r\n\r\n    this.localStats.push(localStats);\r\n    localStats.start();\r\n};\r\n\r\nStatistics.prototype.addAudioLevelListener = function(listener) {\r\n    if (!Statistics.audioLevelsEnabled) {\r\n        return;\r\n    }\r\n    this.eventEmitter.on(StatisticsEvents.AUDIO_LEVEL, listener);\r\n};\r\n\r\nStatistics.prototype.removeAudioLevelListener = function(listener) {\r\n    if (!Statistics.audioLevelsEnabled) {\r\n        return;\r\n    }\r\n    this.eventEmitter.removeListener(StatisticsEvents.AUDIO_LEVEL, listener);\r\n};\r\n\r\nStatistics.prototype.addBeforeDisposedListener = function(listener) {\r\n    this.eventEmitter.on(StatisticsEvents.BEFORE_DISPOSED, listener);\r\n};\r\n\r\nStatistics.prototype.removeBeforeDisposedListener = function(listener) {\r\n    this.eventEmitter.removeListener(\r\n        StatisticsEvents.BEFORE_DISPOSED, listener);\r\n};\r\n\r\nStatistics.prototype.addConnectionStatsListener = function(listener) {\r\n    this.eventEmitter.on(StatisticsEvents.CONNECTION_STATS, listener);\r\n};\r\n\r\nStatistics.prototype.removeConnectionStatsListener = function(listener) {\r\n    this.eventEmitter.removeListener(\r\n        StatisticsEvents.CONNECTION_STATS,\r\n        listener);\r\n};\r\n\r\nStatistics.prototype.addByteSentStatsListener = function(listener) {\r\n    this.eventEmitter.on(StatisticsEvents.BYTE_SENT_STATS, listener);\r\n};\r\n\r\nStatistics.prototype.removeByteSentStatsListener = function(listener) {\r\n    this.eventEmitter.removeListener(StatisticsEvents.BYTE_SENT_STATS,\r\n        listener);\r\n};\r\n\r\nStatistics.prototype.dispose = function() {\r\n    try {\r\n        // NOTE Before reading this please see the comment in stopCallStats...\r\n        //\r\n        // Here we prevent from emitting the event twice in case it will be\r\n        // triggered from stopCallStats.\r\n        // If the event is triggered from here it means that the logs will not\r\n        // be submitted anyway (because there is no CallStats instance), but\r\n        // we're doing that for the sake of some kind of consistency.\r\n        if (!this.callsStatsInstances.size) {\r\n            this.eventEmitter.emit(StatisticsEvents.BEFORE_DISPOSED);\r\n        }\r\n        for (const callStats of this.callsStatsInstances.values()) {\r\n            this.stopCallStats(callStats.tpc);\r\n        }\r\n        for (const tpcId of this.rtpStatsMap.keys()) {\r\n            this._stopRemoteStats(tpcId);\r\n        }\r\n        if (this.eventEmitter) {\r\n            this.eventEmitter.removeAllListeners();\r\n        }\r\n    } finally {\r\n        Statistics.instances.delete(this);\r\n    }\r\n};\r\n\r\nStatistics.stopLocalStats = function(stream) {\r\n    if (!Statistics.audioLevelsEnabled) {\r\n        return;\r\n    }\r\n\r\n    for (let i = 0; i < Statistics.localStats.length; i++) {\r\n        if (Statistics.localStats[i].stream === stream) {\r\n            const localStats = Statistics.localStats.splice(i, 1);\r\n\r\n            localStats[0].stop();\r\n            break;\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * Stops remote RTP stats for given peerconnection ID.\r\n * @param {string} tpcId {@link TraceablePeerConnection.id}\r\n * @private\r\n */\r\nStatistics.prototype._stopRemoteStats = function(tpcId) {\r\n    const rtpStats = this.rtpStatsMap.get(tpcId);\r\n\r\n    if (rtpStats) {\r\n        rtpStats.stop();\r\n        this.rtpStatsMap.delete(tpcId);\r\n    }\r\n};\r\n\r\n/**\r\n * Stops collecting RTP stats for given peerconnection\r\n * @param {TraceablePeerConnection} tpc\r\n */\r\nStatistics.prototype.stopRemoteStats = function(tpc) {\r\n    this._stopRemoteStats(tpc.id);\r\n};\r\n\r\n// CALSTATS METHODS\r\n\r\n/**\r\n * Initializes the callstats.io API.\r\n * @param {TraceablePeerConnection} tpc the {@link TraceablePeerConnection}\r\n * instance for which CalStats will be started.\r\n * @param {string} remoteUserID\r\n */\r\nStatistics.prototype.startCallStats = function(tpc, remoteUserID) {\r\n    if (!this.callStatsIntegrationEnabled) {\r\n        return;\r\n    } else if (this.callsStatsInstances.has(tpc.id)) {\r\n        logger.error('CallStats instance for ${tpc} exists already');\r\n\r\n        return;\r\n    }\r\n\r\n    logger.info(`Starting CallStats for ${tpc}...`);\r\n\r\n    const newInstance\r\n        = new CallStats(\r\n            tpc,\r\n            {\r\n                confID: this._getCallStatsConfID(),\r\n                remoteUserID\r\n            });\r\n\r\n    this.callsStatsInstances.set(tpc.id, newInstance);\r\n};\r\n\r\n/**\r\n * Obtains the list of *all* {@link CallStats} instances collected from every\r\n * valid {@link Statistics} instance.\r\n * @return {Set<CallStats>}\r\n * @private\r\n */\r\nStatistics._getAllCallStatsInstances = function() {\r\n    const csInstances = new Set();\r\n\r\n    for (const statistics of Statistics.instances) {\r\n        for (const cs of statistics.callsStatsInstances.values()) {\r\n            csInstances.add(cs);\r\n        }\r\n    }\r\n\r\n    return csInstances;\r\n};\r\n\r\n/**\r\n * Constructs the CallStats conference ID based on the options currently\r\n * configured in this instance.\r\n * @return {string}\r\n * @private\r\n */\r\nStatistics.prototype._getCallStatsConfID = function() {\r\n    // The conference ID is case sensitive!!!\r\n    return this.options.callStatsConfIDNamespace\r\n        ? `${this.options.callStatsConfIDNamespace}/${this.options.roomName}`\r\n        : this.options.roomName;\r\n};\r\n\r\n/**\r\n * Removes the callstats.io instances.\r\n */\r\nStatistics.prototype.stopCallStats = function(tpc) {\r\n    const callStatsInstance = this.callsStatsInstances.get(tpc.id);\r\n\r\n    if (callStatsInstance) {\r\n        // FIXME the original purpose of adding BEFORE_DISPOSED event was to be\r\n        // able to submit the last log batch from jitsi-meet to CallStats. After\r\n        // recent changes we dispose the CallStats earlier\r\n        // (before Statistics.dispose), so we need to emit this event here to\r\n        // give this last chance for final log batch submission.\r\n        //\r\n        // Eventually there should be a separate module called \"log storage\"\r\n        // which should emit proper events when it's underlying\r\n        // CallStats instance is going away.\r\n        if (this.callsStatsInstances.size === 1) {\r\n            this.eventEmitter.emit(StatisticsEvents.BEFORE_DISPOSED);\r\n        }\r\n        this.callsStatsInstances.delete(tpc.id);\r\n\r\n        // The fabric needs to be terminated when being stopped\r\n        callStatsInstance.sendTerminateEvent();\r\n    }\r\n};\r\n\r\n/**\r\n * Returns true if the callstats integration is enabled, otherwise returns\r\n * false.\r\n *\r\n * @returns true if the callstats integration is enabled, otherwise returns\r\n * false.\r\n */\r\nStatistics.prototype.isCallstatsEnabled = function() {\r\n    return this.callStatsIntegrationEnabled;\r\n};\r\n\r\n/**\r\n * Logs either resume or hold event for the given peer connection.\r\n * @param {TraceablePeerConnection} tpc the connection for which event will be\r\n * reported\r\n * @param {boolean} isResume true for resume or false for hold\r\n */\r\nStatistics.prototype.sendConnectionResumeOrHoldEvent = function(tpc, isResume) {\r\n    const instance = this.callsStatsInstances.get(tpc.id);\r\n\r\n    if (instance) {\r\n        instance.sendResumeOrHoldEvent(isResume);\r\n    }\r\n};\r\n\r\n/**\r\n * Notifies CallStats and analytics (if present) for ice connection failed\r\n * @param {TraceablePeerConnection} tpc connection on which failure occurred.\r\n */\r\nStatistics.prototype.sendIceConnectionFailedEvent = function(tpc) {\r\n    const instance = this.callsStatsInstances.get(tpc.id);\r\n\r\n    if (instance) {\r\n        instance.sendIceConnectionFailedEvent();\r\n    }\r\n};\r\n\r\n/**\r\n * Notifies CallStats for mute events\r\n * @param {TraceablePeerConnection} tpc connection on which failure occurred.\r\n * @param {boolean} muted true for muted and false for not muted\r\n * @param {String} type \"audio\"/\"video\"\r\n */\r\nStatistics.prototype.sendMuteEvent = function(tpc, muted, type) {\r\n    const instance = tpc && this.callsStatsInstances.get(tpc.id);\r\n\r\n    CallStats.sendMuteEvent(muted, type, instance);\r\n};\r\n\r\n/**\r\n * Notifies CallStats for screen sharing events\r\n * @param start {boolean} true for starting screen sharing and\r\n * false for not stopping\r\n * @param {string|null} ssrc - optional ssrc value, used only when\r\n * starting screen sharing.\r\n */\r\nStatistics.prototype.sendScreenSharingEvent\r\n    = function(start, ssrc) {\r\n        for (const cs of this.callsStatsInstances.values()) {\r\n            cs.sendScreenSharingEvent(start, ssrc);\r\n        }\r\n    };\r\n\r\n/**\r\n * Notifies the statistics module that we are now the dominant speaker of the\r\n * conference.\r\n */\r\nStatistics.prototype.sendDominantSpeakerEvent = function() {\r\n    for (const cs of this.callsStatsInstances.values()) {\r\n        cs.sendDominantSpeakerEvent();\r\n    }\r\n};\r\n\r\n/**\r\n * Notifies about active device.\r\n * @param {{deviceList: {String:String}}} devicesData - list of devices with\r\n *      their data\r\n */\r\nStatistics.sendActiveDeviceListEvent = function(devicesData) {\r\n    const globalSet = Statistics._getAllCallStatsInstances();\r\n\r\n    if (globalSet.size) {\r\n        for (const cs of globalSet) {\r\n            CallStats.sendActiveDeviceListEvent(devicesData, cs);\r\n        }\r\n    } else {\r\n        CallStats.sendActiveDeviceListEvent(devicesData, null);\r\n    }\r\n};\r\n\r\n/* eslint-disable max-params */\r\n\r\n/**\r\n * Lets the underlying statistics module know where is given SSRC rendered by\r\n * providing renderer tag ID.\r\n * @param {TraceablePeerConnection} tpc the connection to which the stream\r\n * belongs to\r\n * @param {number} ssrc the SSRC of the stream\r\n * @param {boolean} isLocal\r\n * @param {string} userId\r\n * @param {string} usageLabel  meaningful usage label of this stream like\r\n *        'microphone', 'camera' or 'screen'.\r\n * @param {string} containerId the id of media 'audio' or 'video' tag which\r\n *        renders the stream.\r\n */\r\nStatistics.prototype.associateStreamWithVideoTag = function(\r\n        tpc,\r\n        ssrc,\r\n        isLocal,\r\n        userId,\r\n        usageLabel,\r\n        containerId) {\r\n    const instance = this.callsStatsInstances.get(tpc.id);\r\n\r\n    if (instance) {\r\n        instance.associateStreamWithVideoTag(\r\n            ssrc,\r\n            isLocal,\r\n            userId,\r\n            usageLabel,\r\n            containerId);\r\n    }\r\n};\r\n\r\n/* eslint-enable max-params */\r\n\r\n/**\r\n * Notifies CallStats that getUserMedia failed.\r\n *\r\n * @param {Error} e error to send\r\n */\r\nStatistics.sendGetUserMediaFailed = function(e) {\r\n    const error\r\n        = e instanceof JitsiTrackError\r\n            ? formatJitsiTrackErrorForCallStats(e) : e;\r\n    const globalSet = Statistics._getAllCallStatsInstances();\r\n\r\n    if (globalSet.size) {\r\n        for (const cs of globalSet) {\r\n            CallStats.sendGetUserMediaFailed(error, cs);\r\n        }\r\n    } else {\r\n        CallStats.sendGetUserMediaFailed(error, null);\r\n    }\r\n};\r\n\r\n/**\r\n * Notifies CallStats that peer connection failed to create offer.\r\n *\r\n * @param {Error} e error to send\r\n * @param {TraceablePeerConnection} tpc connection on which failure occurred.\r\n */\r\nStatistics.prototype.sendCreateOfferFailed = function(e, tpc) {\r\n    const instance = this.callsStatsInstances.get(tpc.id);\r\n\r\n    if (instance) {\r\n        instance.sendCreateOfferFailed(e);\r\n    }\r\n};\r\n\r\n/**\r\n * Notifies CallStats that peer connection failed to create answer.\r\n *\r\n * @param {Error} e error to send\r\n * @param {TraceablePeerConnection} tpc connection on which failure occured.\r\n */\r\nStatistics.prototype.sendCreateAnswerFailed = function(e, tpc) {\r\n    const instance = this.callsStatsInstances.get(tpc.id);\r\n\r\n    if (instance) {\r\n        instance.sendCreateAnswerFailed(e);\r\n    }\r\n};\r\n\r\n/**\r\n * Notifies CallStats that peer connection failed to set local description.\r\n *\r\n * @param {Error} e error to send\r\n * @param {TraceablePeerConnection} tpc connection on which failure occurred.\r\n */\r\nStatistics.prototype.sendSetLocalDescFailed = function(e, tpc) {\r\n    const instance = this.callsStatsInstances.get(tpc.id);\r\n\r\n    if (instance) {\r\n        instance.sendSetLocalDescFailed(e);\r\n    }\r\n};\r\n\r\n/**\r\n * Notifies CallStats that peer connection failed to set remote description.\r\n *\r\n * @param {Error} e error to send\r\n * @param {TraceablePeerConnection} tpc connection on which failure occurred.\r\n */\r\nStatistics.prototype.sendSetRemoteDescFailed = function(e, tpc) {\r\n    const instance = this.callsStatsInstances.get(tpc.id);\r\n\r\n    if (instance) {\r\n        instance.sendSetRemoteDescFailed(e);\r\n    }\r\n};\r\n\r\n/**\r\n * Notifies CallStats that peer connection failed to add ICE candidate.\r\n *\r\n * @param {Error} e error to send\r\n * @param {TraceablePeerConnection} tpc connection on which failure occurred.\r\n */\r\nStatistics.prototype.sendAddIceCandidateFailed = function(e, tpc) {\r\n    const instance = this.callsStatsInstances.get(tpc.id);\r\n\r\n    if (instance) {\r\n        instance.sendAddIceCandidateFailed(e);\r\n    }\r\n};\r\n\r\n/**\r\n * Adds to CallStats an application log.\r\n *\r\n * @param {String} m a log message to send or an {Error} object to be reported\r\n */\r\nStatistics.sendLog = function(m) {\r\n    const globalSubSet = new Set();\r\n\r\n    // FIXME we don't want to duplicate logs over P2P instance, but\r\n    // here we should go over instances and call this method for each\r\n    // unique conference ID rather than selecting the first one.\r\n    // We don't have such use case though, so leaving as is for now.\r\n    for (const stats of Statistics.instances) {\r\n        if (stats.callsStatsInstances.size) {\r\n            globalSubSet.add(stats.callsStatsInstances.values().next().value);\r\n        }\r\n    }\r\n\r\n    if (globalSubSet.size) {\r\n        for (const csPerStats of globalSubSet) {\r\n            CallStats.sendApplicationLog(m, csPerStats);\r\n        }\r\n    } else {\r\n        CallStats.sendApplicationLog(m, null);\r\n    }\r\n};\r\n\r\n/**\r\n * Sends the given feedback through CallStats.\r\n *\r\n * @param overall an integer between 1 and 5 indicating the user's rating.\r\n * @param comment the comment from the user.\r\n */\r\nStatistics.prototype.sendFeedback = function(overall, comment) {\r\n    CallStats.sendFeedback(this._getCallStatsConfID(), overall, comment);\r\n    Statistics.analytics.sendEvent(\r\n        FEEDBACK,\r\n        {\r\n            rating: overall,\r\n            comment\r\n        });\r\n};\r\n\r\nStatistics.LOCAL_JID = require('../../service/statistics/constants').LOCAL_JID;\r\n\r\n/**\r\n * Reports global error to CallStats.\r\n *\r\n * @param {Error} error\r\n */\r\nStatistics.reportGlobalError = function(error) {\r\n    if (error instanceof JitsiTrackError && error.gum) {\r\n        Statistics.sendGetUserMediaFailed(error);\r\n    } else {\r\n        Statistics.sendLog(error);\r\n    }\r\n};\r\n\r\n/**\r\n * Sends event to analytics and logs a message to the logger/console. Console\r\n * messages might also be logged to callstats automatically.\r\n *\r\n * @param {string | Object} event the event name, or an object which\r\n * represents the entire event.\r\n * @param {Object} properties properties to attach to the event (if an event\r\n * name as opposed to an event object is provided).\r\n */\r\nStatistics.sendAnalyticsAndLog = function(event, properties = {}) {\r\n    if (!event) {\r\n        logger.warn('No event or event name given.');\r\n\r\n        return;\r\n    }\r\n\r\n    let eventToLog;\r\n\r\n    // Also support an API with a single object as an event.\r\n    if (typeof event === 'object') {\r\n        eventToLog = event;\r\n    } else {\r\n        eventToLog = {\r\n            name: event,\r\n            properties\r\n        };\r\n    }\r\n\r\n    logger.log(JSON.stringify(eventToLog));\r\n\r\n    // We do this last, because it may modify the object which is passed.\r\n    this.analytics.sendEvent(event, properties);\r\n};\r\n\r\n/**\r\n * Sends event to analytics.\r\n *\r\n * @param {string | Object} eventName the event name, or an object which\r\n * represents the entire event.\r\n * @param {Object} properties properties to attach to the event\r\n */\r\nStatistics.sendAnalytics = function(eventName, properties = {}) {\r\n    this.analytics.sendEvent(eventName, properties);\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/statistics/statistics.js","/**\r\n * This class exports constants and factory methods related to the analytics\r\n * API provided by AnalyticsAdapter. In order for entries in a database to be\r\n * somewhat easily traceable back to the code which produced them, events sent\r\n * through analytics should be defined here.\r\n *\r\n * Since the AnalyticsAdapter API can be used in different ways, for some events\r\n * it is more convenient to just define the event name as a constant. For other\r\n * events a factory function is easier.\r\n *\r\n * A general approach for adding a new event:\r\n * 1. Determine the event type: track, UI, page, or operational. If in doubt use\r\n * operational.\r\n * 2. Determine whether the event is related to other existing events, and\r\n * which fields are desired to be set: name, action, actionSubject, source.\r\n * 3. If the name is sufficient (the other fields are not important), use a\r\n * constant. Otherwise use a factory function.\r\n *\r\n * Note that the AnalyticsAdapter uses the events passed to its functions for\r\n * its own purposes, and might modify them. Because of this factory functions\r\n * should create new objects.\r\n *\r\n */\r\n\r\n/**\r\n * The constant which identifies an event of type \"operational\".\r\n * @type {string}\r\n */\r\nexport const TYPE_OPERATIONAL = 'operational';\r\n\r\n/**\r\n * The constant which identifies an event of type \"page\".\r\n * @type {string}\r\n */\r\nexport const TYPE_PAGE = 'page';\r\n\r\n/**\r\n * The constant which identifies an event of type \"track\".\r\n * @type {string}\r\n */\r\nexport const TYPE_TRACK = 'track';\r\n\r\n/**\r\n * The constant which identifies an event of type \"ui\".\r\n * @type {string}\r\n */\r\nexport const TYPE_UI = 'ui';\r\n\r\n/**\r\n * The \"action\" value for Jingle events which indicates that the Jingle session\r\n * was restarted (TODO: verify/fix the documentation)\r\n * @type {string}\r\n */\r\nexport const ACTION_JINGLE_RESTART = 'restart';\r\n\r\n/**\r\n * The \"action\" value for Jingle events which indicates that a session-accept\r\n * timed out (TODO: verify/fix the documentation)\r\n * @type {string}\r\n */\r\nexport const ACTION_JINGLE_SA_TIMEOUT = 'session-accept.timeout';\r\n\r\n/**\r\n * The \"action\" value for Jingle events which indicates that a session-initiate\r\n * was received.\r\n * @type {string}\r\n */\r\nexport const ACTION_JINGLE_SI_RECEIVED = 'session-initiate.received';\r\n\r\n/**\r\n * A constant for the \"terminate\" action for Jingle events. TODO: verify/fix\r\n * the documentation)\r\n * @type {string}\r\n */\r\nexport const ACTION_JINGLE_TERMINATE = 'terminate';\r\n\r\n/**\r\n * The \"action\" value for Jingle events which indicates that a transport-replace\r\n * was received.\r\n * @type {string}\r\n */\r\nexport const ACTION_JINGLE_TR_RECEIVED\r\n    = 'transport-replace.received';\r\n\r\n/**\r\n * The \"action\" value for Jingle events which indicates that a transport-replace\r\n * succeeded (TODO: verify/fix the documentation)\r\n * @type {string}\r\n */\r\nexport const ACTION_JINGLE_TR_SUCCESS\r\n    = 'transport-replace.success';\r\n\r\n/**\r\n * The \"action\" value for P2P events which indicates that a connection was\r\n * established (TODO: verify/fix the documentation)\r\n * @type {string}\r\n */\r\nexport const ACTION_P2P_ESTABLISHED = 'established';\r\n\r\n/**\r\n * The \"action\" value for P2P events which indicates that something failed.\r\n * @type {string}\r\n */\r\nexport const ACTION_P2P_FAILED = 'failed';\r\n\r\n/**\r\n * The \"action\" value for P2P events which indicates that a switch to\r\n * jitsi-videobridge happened.\r\n * @type {string}\r\n */\r\nexport const ACTION_P2P_SWITCH_TO_JVB = 'switch.to.jvb';\r\n\r\n/**\r\n * The name of an event which indicates an available device. We send one such\r\n * event per available device once when the available devices are first known,\r\n * and every time that they change\r\n * @type {string}\r\n *\r\n * Properties:\r\n *      audio_input_device_count: the number of audio input devices available at\r\n *          the time the event was sent.\r\n *      audio_output_device_count: the number of audio output devices available\r\n *          at the time the event was sent.\r\n *      video_input_device_count: the number of video input devices available at\r\n *          the time the event was sent.\r\n *      video_output_device_count: the number of video output devices available\r\n *          at the time the event was sent.\r\n *      device_id: an identifier of the device described in this event.\r\n *      device_group_id:\r\n *      device_kind: one of 'audioinput', 'audiooutput', 'videoinput' or\r\n *          'videooutput'.\r\n *      device_label: a string which describes the device.\r\n */\r\nexport const AVAILABLE_DEVICE = 'available.device';\r\n\r\n/**\r\n * This appears to be fired only in certain cases when the XMPP connection\r\n * disconnects (and it was intentional?). It is currently never observed to\r\n * fire in production.\r\n *\r\n * TODO: document\r\n *\r\n * Properties:\r\n *      message: an error message\r\n */\r\nexport const CONNECTION_DISCONNECTED = 'connection.disconnected';\r\n\r\n/**\r\n * Indicates that the user of the application provided feedback in terms of a\r\n * rating (an integer from 1 to 5) and an optional comment.\r\n * Properties:\r\n *      value: the user's rating (an integer from 1 to 5)\r\n *      comment: the user's comment\r\n */\r\nexport const FEEDBACK = 'feedback';\r\n\r\n/**\r\n * Indicates the duration of a particular phase of the ICE connectivity\r\n * establishment.\r\n *\r\n * Properties:\r\n *      phase: the ICE phase (e.g. 'gathering', 'checking', 'establishment')\r\n *      value: the duration in milliseconds.\r\n *      p2p: whether the associated ICE connection is p2p or towards a\r\n *          jitsi-videobridge\r\n *      initiator: whether the local Jingle peer is the initiator or responder\r\n *          in the Jingle session. XXX we probably actually care about the ICE\r\n *          role (controlling vs controlled), and we assume that this correlates\r\n *          with the Jingle initiator.\r\n */\r\nexport const ICE_DURATION = 'ice.duration';\r\n\r\n/**\r\n * Indicates the difference in milliseconds between the ICE establishment time\r\n * for the P2P and JVB connections (e.g. a value of 10 would indicate that the\r\n * P2P connection took 10ms more than JVB connection to establish).\r\n *\r\n * Properties:\r\n *      value: the difference in establishment durations in milliseconds.\r\n *\r\n */\r\nexport const ICE_ESTABLISHMENT_DURATION_DIFF\r\n    = 'ice.establishment.duration.diff';\r\n\r\n/**\r\n * Indicates that the ICE state has changed.\r\n *\r\n * Properties:\r\n *      state: the ICE state which was entered (e.g. 'checking', 'connected',\r\n *          'completed', etc).\r\n *      value: the time in milliseconds (as reported by\r\n *          window.performance.now()) that the state change occurred.\r\n *      p2p: whether the associated ICE connection is p2p or towards a\r\n *          jitsi-videobridge\r\n *      signalingState: The signaling state of the associated PeerConnection\r\n *      reconnect: whether the associated Jingle session is in the process of\r\n *          reconnecting (or is it ICE? TODO: verify/fix the documentation)\r\n */\r\nexport const ICE_STATE_CHANGED = 'ice.state.changed';\r\n\r\n/**\r\n * Indicates that a track was unmuted (?).\r\n *\r\n * Properties:\r\n *      mediaType: the media type of the local track ('audio' or 'video').\r\n *      trackType: the type of the track ('local' or 'remote').\r\n *      value: TODO: document\r\n */\r\nexport const TRACK_UNMUTED = 'track.unmuted';\r\n\r\n/**\r\n * Creates an operational event which indicates that we have received a\r\n * \"bridge down\" event from jicofo.\r\n */\r\nexport const createBridgeDownEvent = function() {\r\n    const bridgeDown = 'bridge.down';\r\n\r\n    return {\r\n        action: bridgeDown,\r\n        actionSubject: bridgeDown,\r\n        type: TYPE_OPERATIONAL\r\n    };\r\n};\r\n\r\n/**\r\n * Creates an event which indicates that the XMPP connection failed\r\n * @param errorType TODO\r\n * @param errorMessage TODO\r\n * @param detail connection failed details.\r\n */\r\nexport const createConnectionFailedEvent\r\n    = function(errorType, errorMessage, details) {\r\n        return {\r\n            type: TYPE_OPERATIONAL,\r\n            action: 'connection.failed',\r\n            attributes: {\r\n                'error_type': errorType,\r\n                'error_message': errorMessage,\r\n                ...details\r\n            }\r\n        };\r\n    };\r\n\r\n/**\r\n * Creates an operational event which indicates that a particular connection\r\n * stage was reached (i.e. the XMPP connection transitioned to the \"connected\"\r\n * state).\r\n *\r\n * @param stage the stage which was reached\r\n * @param attributes additional attributes for the event. This should be an\r\n * object with a \"value\" property indicating a timestamp in milliseconds\r\n * relative to the beginning of the document's lifetime.\r\n *\r\n */\r\nexport const createConnectionStageReachedEvent = function(stage, attributes) {\r\n    const action = 'connection.stage.reached';\r\n\r\n    return {\r\n        action,\r\n        actionSubject: stage,\r\n        attributes,\r\n        source: action,\r\n        type: TYPE_OPERATIONAL\r\n    };\r\n};\r\n\r\n/**\r\n * Creates an event which indicates that the focus has left the MUC.\r\n */\r\nexport const createFocusLeftEvent = function() {\r\n    const action = 'focus.left';\r\n\r\n    return {\r\n        action,\r\n        actionSubject: action,\r\n        type: TYPE_OPERATIONAL\r\n    };\r\n};\r\n\r\n/**\r\n * Creates an event related to a getUserMedia call.\r\n *\r\n * @param action the type of the result that the event represents: 'error',\r\n * 'success', 'warning', etc.\r\n * @param attributes the attributes to attach to the event.\r\n * @returns {{type: string, source: string, name: string}}\r\n */\r\nexport const createGetUserMediaEvent = function(action, attributes = {}) {\r\n    return {\r\n        type: TYPE_OPERATIONAL,\r\n        source: 'get.user.media',\r\n        action,\r\n        attributes\r\n    };\r\n};\r\n\r\n/**\r\n * Creates an event for a Jingle-related event.\r\n * @param action the action of the event\r\n * @param attributes attributes to add to the event.\r\n */\r\nexport const createJingleEvent = function(action, attributes = {}) {\r\n    return {\r\n        type: TYPE_OPERATIONAL,\r\n        action,\r\n        source: 'jingle',\r\n        attributes\r\n    };\r\n};\r\n\r\n/**\r\n * Creates an event which indicates that a local track was not able to read\r\n * data from its source (a camera or a microphone).\r\n *\r\n * @param mediaType {String} the media type of the local track ('audio' or\r\n * 'video').\r\n */\r\nexport const createNoDataFromSourceEvent = function(mediaType) {\r\n    return {\r\n        attributes: { 'media_type': mediaType },\r\n        action: 'track.no.data.from.source',\r\n        type: TYPE_OPERATIONAL\r\n    };\r\n};\r\n\r\n/**\r\n * Creates an event for a p2p-related event.\r\n * @param action the action of the event\r\n * @param attributes attributes to add to the event.\r\n */\r\nexport const createP2PEvent = function(action, attributes = {}) {\r\n    return {\r\n        type: TYPE_OPERATIONAL,\r\n        action,\r\n        source: 'p2p',\r\n        attributes\r\n    };\r\n};\r\n\r\n/**\r\n * Indicates that we received a remote command to mute.\r\n */\r\nexport const createRemotelyMutedEvent = function() {\r\n    return {\r\n        type: TYPE_OPERATIONAL,\r\n        action: 'remotely.muted'\r\n    };\r\n};\r\n\r\n/**\r\n * Creates an event which contains RTP statistics such as RTT and packet loss.\r\n *\r\n * All average RTP stats are currently reported under 1 event name, but with\r\n * different properties that allows to distinguish between a P2P call, a\r\n * call relayed through TURN or the JVB, and multiparty vs 1:1.\r\n *\r\n * The structure of the event is:\r\n *\r\n * {\r\n *      p2p: true,\r\n *      conferenceSize: 2,\r\n *      localCandidateType: \"relay\",\r\n *      remoteCandidateType: \"relay\",\r\n *      transportType: \"udp\",\r\n *\r\n *      // Average RTT of 200ms\r\n *      \"rtt.avg\": 200,\r\n *      \"rtt.samples\": \"[100, 200, 300]\",\r\n *\r\n *      // Average packet loss of 10%\r\n *      \"packet.loss.avg\": 10,\r\n *      \"packet.loss.samples\": '[5, 10, 15]'\r\n *\r\n *      // Difference in milliseconds in the end-to-end RTT between p2p and jvb.\r\n *      // The e2e RTT through jvb is 15ms shorter:\r\n *      \"rtt.diff\": 15,\r\n *\r\n *      // End-to-end RTT through JVB is ms.\r\n *      \"end2end.rtt.avg\" = 100\r\n * }\r\n *\r\n * Note that the value of the \"samples\" properties are (JSON encoded) strings,\r\n * and not JSON arrays, as events' attributes can not be nested. The samples are\r\n * currently included for debug purposes only and can be removed anytime soon\r\n * from the structure.\r\n *\r\n * Also note that not all of values are present in each event, as values are\r\n * obtained and calculated as part of different process/event pipe. For example\r\n * {@link ConnectionAvgStats} instances are doing the reports for each\r\n * {@link TraceablePeerConnection} and work independently from the main stats\r\n * pipe.\r\n */\r\nexport const createRtpStatsEvent = function(attributes) {\r\n    return {\r\n        type: TYPE_OPERATIONAL,\r\n        action: 'rtp.stats',\r\n        attributes\r\n    };\r\n};\r\n\r\n/**\r\n * Creates an event which indicates the Time To First Media (TTFM).\r\n * It is measured in milliseconds relative to the beginning of the document's\r\n * lifetime (i.e. the origin used by window.performance.now()), and it excludes\r\n * the following:\r\n * 1. The delay due to getUserMedia()\r\n * 2. The period between the MUC being joined and the reception of the Jingle\r\n * session-initiate from jicofo. This is because jicofo will not start a Jingle\r\n * session until there are at least 2 participants in the room.\r\n *\r\n * @param attributes the attributes to add to the event. Currently used fields:\r\n *      mediaType: the media type of the local track ('audio' or 'video').\r\n *      muted: whether the track has ever been muted (?)\r\n *      value: the TTMF in milliseconds.\r\n */\r\nexport const createTtfmEvent = function(attributes) {\r\n    return createConnectionStageReachedEvent('ttfm', attributes);\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./service/statistics/AnalyticsEvents.js","/**\r\n * The events for the conference.\r\n */\r\n\r\n/**\r\n * Indicates that authentication status changed.\r\n */\r\nexport const AUTH_STATUS_CHANGED = 'conference.auth_status_changed';\r\n\r\n/**\r\n * Indicates that available devices changed.\r\n */\r\nexport const AVAILABLE_DEVICES_CHANGED = 'conference.availableDevicesChanged';\r\n\r\n/**\r\n * A participant avatar has changed.\r\n */\r\nexport const AVATAR_CHANGED = 'conference.avatarChanged';\r\n\r\n/**\r\n * Fired just before the statistics module is disposed and it's the last chance\r\n * to submit some logs to the statistics service (ex. CallStats if enabled),\r\n * before it's disconnected.\r\n */\r\nexport const BEFORE_STATISTICS_DISPOSED = 'conference.beforeStatisticsDisposed';\r\n\r\n/**\r\n * Indicates that an error occured.\r\n */\r\nexport const CONFERENCE_ERROR = 'conference.error';\r\n\r\n/**\r\n * Indicates that conference failed.\r\n */\r\nexport const CONFERENCE_FAILED = 'conference.failed';\r\n\r\n/**\r\n * Indicates that conference has been joined. The event does NOT provide any\r\n * parameters to its listeners.\r\n */\r\nexport const CONFERENCE_JOINED = 'conference.joined';\r\n\r\n/**\r\n * Indicates that conference has been left.\r\n */\r\nexport const CONFERENCE_LEFT = 'conference.left';\r\n\r\n/**\r\n * Indicates that the connection to the conference has been interrupted for some\r\n * reason.\r\n * XXX This is currently fired when the *ICE* connection is interrupted.\r\n */\r\nexport const CONNECTION_INTERRUPTED = 'conference.connectionInterrupted';\r\n\r\n/**\r\n * Indicates that the connection to the conference has been restored.\r\n * XXX This is currently fired when the *ICE* connection is restored.\r\n */\r\nexport const CONNECTION_RESTORED = 'conference.connectionRestored';\r\n\r\n/**\r\n * A connection to the video bridge's data channel has been established.\r\n */\r\nexport const DATA_CHANNEL_OPENED = 'conference.dataChannelOpened';\r\n\r\n/**\r\n * A user has changed it display name\r\n */\r\nexport const DISPLAY_NAME_CHANGED = 'conference.displayNameChanged';\r\n\r\n/**\r\n * The dominant speaker was changed.\r\n */\r\nexport const DOMINANT_SPEAKER_CHANGED = 'conference.dominantSpeaker';\r\n\r\n/**\r\n * Indicates that DTMF support changed.\r\n */\r\nexport const DTMF_SUPPORT_CHANGED = 'conference.dtmfSupportChanged';\r\n\r\n/**\r\n * Indicates that a message from another participant is received on data\r\n * channel.\r\n */\r\nexport const ENDPOINT_MESSAGE_RECEIVED = 'conference.endpoint_message_received';\r\n\r\n/**\r\n * NOTE This is lib-jitsi-meet internal event and can be removed at any time !\r\n *\r\n * Event emitted when conference transits, between one to one and multiparty JVB\r\n * conference. If the conference switches to P2P it's neither one to one nor\r\n * a multiparty JVB conference, but P2P (the status argument of this event will\r\n * be <tt>false</tt>).\r\n *\r\n * The first argument is a boolean which carries the previous value and\r\n * the seconds argument is a boolean with the new status. The event is emitted\r\n * only if the previous and the new values are different.\r\n *\r\n * @type {string}\r\n */\r\nexport const JVB121_STATUS = 'conference.jvb121Status';\r\n\r\n/**\r\n * You are kicked from the conference.\r\n */\r\nexport const KICKED = 'conferenece.kicked';\r\n\r\n/**\r\n * The Last N set is changed.\r\n *\r\n * @param {Array<string>|null} leavingEndpointIds the ids of all the endpoints\r\n * which are leaving Last N\r\n * @param {Array<string>|null} enteringEndpointIds the ids of all the endpoints\r\n * which are entering Last N\r\n */\r\nexport const LAST_N_ENDPOINTS_CHANGED = 'conference.lastNEndpointsChanged';\r\n\r\n/**\r\n * Indicates that the room has been locked or unlocked.\r\n */\r\nexport const LOCK_STATE_CHANGED = 'conference.lock_state_changed';\r\n\r\n/**\r\n * New text message was received.\r\n */\r\nexport const MESSAGE_RECEIVED = 'conference.messageReceived';\r\n\r\n/**\r\n * New private text message was received.\r\n */\r\nexport const PRIVATE_MESSAGE_RECEIVED = 'conference.privateMessageReceived';\r\n\r\n/**\r\n * Event fired when JVB sends notification about interrupted/restored user's\r\n * ICE connection status or we detect local problem with the video track.\r\n * First argument is the ID of the participant and\r\n * the seconds is a string indicating if the connection is currently\r\n * - active - the connection is active\r\n * - inactive - the connection is inactive, was intentionally interrupted by\r\n * the bridge\r\n * - interrupted - a network problem occurred\r\n * - restoring - the connection was inactive and is restoring now\r\n *\r\n * The current status value can be obtained by calling\r\n * JitsiParticipant.getConnectionStatus().\r\n */\r\nexport const PARTICIPANT_CONN_STATUS_CHANGED\r\n    = 'conference.participant_conn_status_changed';\r\n\r\n/**\r\n * Indicates that the features of the participant has been changed.\r\n */\r\nexport const PARTCIPANT_FEATURES_CHANGED\r\n    = 'conference.partcipant_features_changed';\r\n\r\n/**\r\n * Indicates that a the value of a specific property of a specific participant\r\n * has changed.\r\n */\r\nexport const PARTICIPANT_PROPERTY_CHANGED\r\n    = 'conference.participant_property_changed';\r\n\r\n/**\r\n * Indicates that the conference has switched between JVB and P2P connections.\r\n * The first argument of this event is a <tt>boolean</tt> which when set to\r\n * <tt>true</tt> means that the conference is running on the P2P connection.\r\n */\r\nexport const P2P_STATUS = 'conference.p2pStatus';\r\n\r\n/**\r\n * Indicates that phone number changed.\r\n */\r\nexport const PHONE_NUMBER_CHANGED = 'conference.phoneNumberChanged';\r\n\r\n/**\r\n * Indicates that recording state changed.\r\n */\r\nexport const RECORDER_STATE_CHANGED = 'conference.recorderStateChanged';\r\n\r\n/**\r\n * Indicates that video SIP GW state changed.\r\n * @param {VideoSIPGWConstants} status.\r\n */\r\nexport const VIDEO_SIP_GW_AVAILABILITY_CHANGED\r\n    = 'conference.videoSIPGWAvailabilityChanged';\r\n\r\n/**\r\n * Indicates that video SIP GW Session state changed.\r\n * @param {options} event - {\r\n *     {string} address,\r\n *     {VideoSIPGWConstants} oldState,\r\n *     {VideoSIPGWConstants} newState,\r\n *     {string} displayName}\r\n * }.\r\n */\r\nexport const VIDEO_SIP_GW_SESSION_STATE_CHANGED\r\n    = 'conference.videoSIPGWSessionStateChanged';\r\n\r\n/**\r\n * Indicates that start muted settings changed.\r\n */\r\nexport const START_MUTED_POLICY_CHANGED\r\n    = 'conference.start_muted_policy_changed';\r\n\r\n/**\r\n * Indicates that the local user has started muted.\r\n */\r\nexport const STARTED_MUTED = 'conference.started_muted';\r\n\r\n/**\r\n * Indicates that subject of the conference has changed.\r\n */\r\nexport const SUBJECT_CHANGED = 'conference.subjectChanged';\r\n\r\n/**\r\n * Indicates that DTMF support changed.\r\n */\r\nexport const SUSPEND_DETECTED = 'conference.suspendDetected';\r\n\r\n/**\r\n * Event indicates that local user is talking while he muted himself\r\n */\r\nexport const TALK_WHILE_MUTED = 'conference.talk_while_muted';\r\n\r\n/**\r\n * A new media track was added to the conference. The event provides the\r\n * following parameters to its listeners:\r\n *\r\n * @param {JitsiTrack} track the added JitsiTrack\r\n */\r\nexport const TRACK_ADDED = 'conference.trackAdded';\r\n\r\n/**\r\n * Audio levels of a media track ( attached to the conference) was changed.\r\n */\r\nexport const TRACK_AUDIO_LEVEL_CHANGED = 'conference.audioLevelsChanged';\r\n\r\n/**\r\n * A media track ( attached to the conference) mute status was changed.\r\n */\r\nexport const TRACK_MUTE_CHANGED = 'conference.trackMuteChanged';\r\n\r\n/**\r\n * The media track was removed from the conference. The event provides the\r\n * following parameters to its listeners:\r\n *\r\n * @param {JitsiTrack} track the removed JitsiTrack\r\n */\r\nexport const TRACK_REMOVED = 'conference.trackRemoved';\r\n\r\n/**\r\n * Notifies for transcription status changes. The event provides the\r\n * following parameters to its listeners:\r\n *\r\n * @param {String} status - The new status.\r\n */\r\nexport const TRANSCRIPTION_STATUS_CHANGED\r\n    = 'conference.transcriptionStatusChanged';\r\n\r\n\r\n/**\r\n * A new user joinned the conference.\r\n */\r\nexport const USER_JOINED = 'conference.userJoined';\r\n\r\n/**\r\n * A user has left the conference.\r\n */\r\nexport const USER_LEFT = 'conference.userLeft';\r\n\r\n/**\r\n * User role changed.\r\n */\r\nexport const USER_ROLE_CHANGED = 'conference.roleChanged';\r\n\r\n/**\r\n * User status changed.\r\n */\r\nexport const USER_STATUS_CHANGED = 'conference.statusChanged';\r\n\n\n\n// WEBPACK FOOTER //\n// ./JitsiConferenceEvents.js","const XMPPEvents = {\r\n    /**\r\n     * Indicates error while adding ice candidate.\r\n     */\r\n    ADD_ICE_CANDIDATE_FAILED: 'xmpp.add_ice_candidate_failed',\r\n\r\n    // Designates an event indicating that the focus has asked us to mute our\r\n    // audio.\r\n    AUDIO_MUTED_BY_FOCUS: 'xmpp.audio_muted_by_focus',\r\n    AUTHENTICATION_REQUIRED: 'xmpp.authentication_required',\r\n    BRIDGE_DOWN: 'xmpp.bridge_down',\r\n\r\n    /**\r\n     * Triggered when 'session-accept' is received from the responder.\r\n     */\r\n    CALL_ACCEPTED: 'xmpp.callaccepted.jingle',\r\n\r\n    // Designates an event indicating that an offer (e.g. Jingle\r\n    // session-initiate) was received.\r\n    CALL_INCOMING: 'xmpp.callincoming.jingle',\r\n\r\n    // Triggered when Jicofo kills our media session, this can happen while\r\n    // we're still in the MUC, when it decides to terminate the media session.\r\n    // For example when the session is idle for too long, because we're the only\r\n    // person in the conference room.\r\n    CALL_ENDED: 'xmpp.callended.jingle',\r\n    CHAT_ERROR_RECEIVED: 'xmpp.chat_error_received',\r\n    CONFERENCE_SETUP_FAILED: 'xmpp.conference_setup_failed',\r\n\r\n    /**\r\n     * This event is triggered when the ICE connects for the first time.\r\n     */\r\n    CONNECTION_ESTABLISHED: 'xmpp.connection.connected',\r\n\r\n    // Designates an event indicating that the connection to the XMPP server\r\n    // failed.\r\n    CONNECTION_FAILED: 'xmpp.connection.failed',\r\n\r\n    // Designates an event indicating that the media (ICE) connection was\r\n    // interrupted. This should go to the RTC module.\r\n    CONNECTION_INTERRUPTED: 'xmpp.connection.interrupted',\r\n\r\n    // Designates an event indicating that the media (ICE) connection was\r\n    // restored. This should go to the RTC module.\r\n    CONNECTION_RESTORED: 'xmpp.connection.restored',\r\n\r\n    // Designates an event indicating that the media (ICE) connection failed.\r\n    // This should go to the RTC module.\r\n    CONNECTION_ICE_FAILED: 'xmpp.connection.ice.failed',\r\n\r\n    // Designates an event indicating that the display name of a participant\r\n    // has changed.\r\n    DISPLAY_NAME_CHANGED: 'xmpp.display_name_changed',\r\n\r\n    /**\r\n     * Chat room instance have been added to Strophe.emuc plugin.\r\n     */\r\n    EMUC_ROOM_ADDED: 'xmpp.emuc_room_added',\r\n\r\n    /**\r\n     * Chat room instance have been removed from Strophe.emuc plugin.\r\n     */\r\n    EMUC_ROOM_REMOVED: 'xmpp.emuc_room_removed',\r\n    ETHERPAD: 'xmpp.etherpad',\r\n    FOCUS_DISCONNECTED: 'xmpp.focus_disconnected',\r\n    FOCUS_LEFT: 'xmpp.focus_left',\r\n    GRACEFUL_SHUTDOWN: 'xmpp.graceful_shutdown',\r\n\r\n    /**\r\n     * Event fired when 'transport-replace' Jingle message has been received,\r\n     * before the new offer is set on the PeerConnection.\r\n     */\r\n    ICE_RESTARTING: 'rtc.ice_restarting',\r\n\r\n    /* Event fired when XMPP error is returned to any request, it is meant to be\r\n     * used to report 'signaling' errors to CallStats\r\n     *\r\n     * {\r\n     *   code: {XMPP error code}\r\n     *   reason: {XMPP error condition}\r\n     *   source = request.tree()\r\n     *   session = {JingleSession instance}\r\n     * }\r\n     */\r\n    JINGLE_ERROR: 'xmpp.jingle_error',\r\n\r\n    // Event fired when we have failed to set initial offer\r\n    JINGLE_FATAL_ERROR: 'xmpp.jingle_fatal_error',\r\n\r\n    // Designates an event indicating that we were kicked from the XMPP MUC.\r\n    KICKED: 'xmpp.kicked',\r\n\r\n    // Designates an event indicating that our role in the XMPP MUC has changed.\r\n    LOCAL_ROLE_CHANGED: 'xmpp.localrole_changed',\r\n\r\n    // Designates an event indicating that an XMPP message in the MUC was\r\n    // received.\r\n    MESSAGE_RECEIVED: 'xmpp.message_received',\r\n\r\n    // Designates an event indicating that a private XMPP message in the MUC was\r\n    // received.\r\n    PRIVATE_MESSAGE_RECEIVED: 'xmpp.private_message_received',\r\n\r\n    // Designates an event indicating that the XMPP MUC was destroyed.\r\n    MUC_DESTROYED: 'xmpp.muc_destroyed',\r\n\r\n    // Designates an event indicating that we have joined the XMPP MUC.\r\n    MUC_JOINED: 'xmpp.muc_joined',\r\n\r\n    // Designates an event indicating that a participant joined the XMPP MUC.\r\n    MUC_MEMBER_JOINED: 'xmpp.muc_member_joined',\r\n\r\n    // Designates an event indicating that a participant left the XMPP MUC.\r\n    MUC_MEMBER_LEFT: 'xmpp.muc_member_left',\r\n\r\n    // Designates an event indicating that local participant left the muc\r\n    MUC_LEFT: 'xmpp.muc_left',\r\n\r\n    // Designates an event indicating that the MUC role of a participant has\r\n    // changed.\r\n    MUC_ROLE_CHANGED: 'xmpp.muc_role_changed',\r\n\r\n    // Designates an event indicating that the MUC has been locked or unlocked.\r\n    MUC_LOCK_CHANGED: 'xmpp.muc_lock_changed',\r\n\r\n    // Designates an event indicating that a participant in the XMPP MUC has\r\n    // advertised that they have audio muted (or unmuted).\r\n    PARTICIPANT_AUDIO_MUTED: 'xmpp.audio_muted',\r\n\r\n    // Designates an event indicating that a participant in the XMPP MUC has\r\n    // advertised that they have video muted (or unmuted).\r\n    PARTICIPANT_VIDEO_MUTED: 'xmpp.video_muted',\r\n\r\n    // Designates an event indicating that the video type (e.g. 'camera' or\r\n    // 'screen') for a participant has changed.\r\n    // Note: currently this event fires every time we receive presence from\r\n    // someone (regardless of whether or not the \"video type\" changed).\r\n    PARTICIPANT_VIDEO_TYPE_CHANGED: 'xmpp.video_type',\r\n\r\n    /**\r\n     * Indicates that the features of the participant has been changed.\r\n     */\r\n    PARTCIPANT_FEATURES_CHANGED: 'xmpp.partcipant_features_changed',\r\n    PASSWORD_REQUIRED: 'xmpp.password_required',\r\n    PEERCONNECTION_READY: 'xmpp.peerconnection_ready',\r\n\r\n    /**\r\n     * Indicates that phone number changed.\r\n     */\r\n    PHONE_NUMBER_CHANGED: 'conference.phoneNumberChanged',\r\n    PRESENCE_STATUS: 'xmpp.presence_status',\r\n    PROMPT_FOR_LOGIN: 'xmpp.prompt_for_login',\r\n\r\n    // xmpp is connected and obtained user media\r\n    READY_TO_JOIN: 'xmpp.ready_to_join',\r\n\r\n    /**\r\n     * Indicates that recording state changed.\r\n     */\r\n    RECORDER_STATE_CHANGED: 'xmpp.recorderStateChanged',\r\n\r\n    // Designates an event indicating that we received statistics from a\r\n    // participant in the MUC.\r\n    REMOTE_STATS: 'xmpp.remote_stats',\r\n    RESERVATION_ERROR: 'xmpp.room_reservation_error',\r\n    ROOM_CONNECT_ERROR: 'xmpp.room_connect_error',\r\n    ROOM_CONNECT_NOT_ALLOWED_ERROR: 'xmpp.room_connect_error.not_allowed',\r\n    ROOM_JOIN_ERROR: 'xmpp.room_join_error',\r\n\r\n    /**\r\n     * Indicates that max users limit has been reached.\r\n     */\r\n    ROOM_MAX_USERS_ERROR: 'xmpp.room_max_users_error',\r\n\r\n    // Designates an event indicating that we sent an XMPP message to the MUC.\r\n    SENDING_CHAT_MESSAGE: 'xmpp.sending_chat_message',\r\n\r\n    // Designates an event indicating that we sent a private XMPP message to\r\n    // a specific user of the muc.\r\n    SENDING_PRIVATE_CHAT_MESSAGE: 'xmpp.sending_private_chat_message',\r\n\r\n    /**\r\n     * Event fired when we do not get our 'session-accept' acknowledged by\r\n     * Jicofo. It most likely means that there is serious problem with our\r\n     * connection or XMPP server and we should reload the conference.\r\n     *\r\n     * We have seen that to happen in BOSH requests race condition when the BOSH\r\n     * request table containing the 'session-accept' was discarded by Prosody.\r\n     * Jicofo does send the RESULT immediately without any condition, so missing\r\n     * packets means that most likely it has never seen our IQ.\r\n     */\r\n    SESSION_ACCEPT_TIMEOUT: 'xmpp.session_accept_timeout',\r\n\r\n    // Designates an event indicating that we should join the conference with\r\n    // audio and/or video muted.\r\n    START_MUTED_FROM_FOCUS: 'xmpp.start_muted_from_focus',\r\n\r\n    // Designates an event indicating that the subject of the XMPP MUC has\r\n    // changed.\r\n    SUBJECT_CHANGED: 'xmpp.subject_changed',\r\n\r\n    // FIXME: how does it belong to XMPP ? - it's detected by the PeerConnection\r\n    // suspending detected\r\n    SUSPEND_DETECTED: 'xmpp.suspend_detected',\r\n\r\n    /**\r\n     * Notifies for transcription status changes. The event provides the\r\n     * following parameters to its listeners:\r\n     *\r\n     * @param {String} status - The new status.\r\n     */\r\n    TRANSCRIPTION_STATUS_CHANGED: 'xmpp.transcription_status_changed',\r\n\r\n    /**\r\n     * Event fired when 'transport-info' with new ICE candidates is received.\r\n     */\r\n    TRANSPORT_INFO: 'xmpp.transportinfo.jingle',\r\n\r\n    /**\r\n     * Indicates that video SIP GW state changed.\r\n     *\r\n     * @param {VideoSIPGWConstants} status - Any of the following statuses:\r\n     * STATUS_BUSY, STATUS_AVAILABLE or STATUS_UNDEFINED.\r\n     */\r\n    VIDEO_SIP_GW_AVAILABILITY_CHANGED: 'xmpp.videoSIPGWAvailabilityChanged',\r\n\r\n    /**\r\n     * Indicates that video SIP GW Session state changed.\r\n     * The statuses are any of the following statuses:\r\n     * STATE_ON, STATE_OFF, STATE_PENDING, STATE_RETRYING, STATE_FAILED.\r\n     * {@see VideoSIPGWConstants}\r\n     *\r\n     * @param {options} event - {address, oldState, newState, displayName}.\r\n     */\r\n    VIDEO_SIP_GW_SESSION_STATE_CHANGED:\r\n        'xmpp.videoSIPGWSessionStateChanged',\r\n\r\n    // Designates an event indicating that the local ICE connection state has\r\n    // changed.\r\n    ICE_CONNECTION_STATE_CHANGED: 'xmpp.ice_connection_state_changed',\r\n\r\n    /**\r\n     * Event which is emitted when the body in an XMPP message in the MUC\r\n     * contains JSON\r\n     */\r\n    JSON_MESSAGE_RECEIVED: 'xmmp.json_message_received'\r\n};\r\n\r\nmodule.exports = XMPPEvents;\r\n\n\n\n// WEBPACK FOOTER //\n// ./service/xmpp/XMPPEvents.js","const RTCEvents = {\r\n    /**\r\n     * Indicates error while create answer call.\r\n     */\r\n    CREATE_ANSWER_FAILED: 'rtc.create_answer_failed',\r\n\r\n    /**\r\n     * Indicates error while create offer call.\r\n     */\r\n    CREATE_OFFER_FAILED: 'rtc.create_offer_failed',\r\n    RTC_READY: 'rtc.ready',\r\n    DATA_CHANNEL_OPEN: 'rtc.data_channel_open',\r\n    ENDPOINT_CONN_STATUS_CHANGED: 'rtc.endpoint_conn_status_changed',\r\n    DOMINANT_SPEAKER_CHANGED: 'rtc.dominant_speaker_changed',\r\n    LASTN_ENDPOINT_CHANGED: 'rtc.lastn_endpoint_changed',\r\n\r\n    /**\r\n     * Event emitted when {@link RTC.setLastN} method is called to update with\r\n     * the new value set.\r\n     * The first argument is the value passed to {@link RTC.setLastN}.\r\n     */\r\n    LASTN_VALUE_CHANGED: 'rtc.lastn_value_changed',\r\n\r\n    /**\r\n     * Event emitted when ssrc for a local track is extracted and stored\r\n     * in {@link TraceablePeerConnection}.\r\n     * @param {JitsiLocalTrack} track which ssrc was updated\r\n     * @param {string} ssrc that was stored\r\n     */\r\n    LOCAL_TRACK_SSRC_UPDATED: 'rtc.local_track_ssrc_updated',\r\n\r\n    AVAILABLE_DEVICES_CHANGED: 'rtc.available_devices_changed',\r\n    TRACK_ATTACHED: 'rtc.track_attached',\r\n\r\n    /**\r\n     * Event fired when we remote track is added to the conference.\r\n     * 1st event argument is the added <tt>JitsiRemoteTrack</tt> instance.\r\n     **/\r\n    REMOTE_TRACK_ADDED: 'rtc.remote_track_added',\r\n\r\n    // FIXME get rid of this event in favour of NO_DATA_FROM_SOURCE event\r\n    // (currently implemented for local tracks only)\r\n    REMOTE_TRACK_MUTE: 'rtc.remote_track_mute',\r\n\r\n    /**\r\n     * Indicates that the remote track has been removed from the conference.\r\n     * 1st event argument is the removed {@link JitsiRemoteTrack} instance.\r\n     */\r\n    REMOTE_TRACK_REMOVED: 'rtc.remote_track_removed',\r\n\r\n    // FIXME get rid of this event in favour of NO_DATA_FROM_SOURCE event\r\n    // (currently implemented for local tracks only)\r\n    REMOTE_TRACK_UNMUTE: 'rtc.remote_track_unmute',\r\n\r\n    /**\r\n     * Indicates error while set local description.\r\n     */\r\n    SET_LOCAL_DESCRIPTION_FAILED: 'rtc.set_local_description_failed',\r\n\r\n    /**\r\n     * Indicates error while set remote description.\r\n     */\r\n    SET_REMOTE_DESCRIPTION_FAILED: 'rtc.set_remote_description_failed',\r\n    AUDIO_OUTPUT_DEVICE_CHANGED: 'rtc.audio_output_device_changed',\r\n    DEVICE_LIST_CHANGED: 'rtc.device_list_changed',\r\n    DEVICE_LIST_AVAILABLE: 'rtc.device_list_available',\r\n\r\n    /**\r\n     * Indicates that a message from another participant is received on\r\n     * data channel.\r\n     */\r\n    ENDPOINT_MESSAGE_RECEIVED: 'rtc.endpoint_message_received',\r\n\r\n    /**\r\n     * Designates an event indicating that the local ICE username fragment of\r\n     * the jingle session has changed.\r\n     * The first argument of the vent is <tt>TraceablePeerConnection</tt> which\r\n     * is the source of the event.\r\n     * The second argument is the actual \"ufrag\" string.\r\n     */\r\n    LOCAL_UFRAG_CHANGED: 'rtc.local_ufrag_changed',\r\n\r\n    /**\r\n     * Designates an event indicating that the local ICE username fragment of\r\n     * the jingle session has changed.\r\n     * The first argument of the vent is <tt>TraceablePeerConnection</tt> which\r\n     * is the source of the event.\r\n     * The second argument is the actual \"ufrag\" string.\r\n     */\r\n    REMOTE_UFRAG_CHANGED: 'rtc.remote_ufrag_changed'\r\n};\r\n\r\nmodule.exports = RTCEvents;\r\n\n\n\n// WEBPACK FOOTER //\n// ./service/RTC/RTCEvents.js","import EventEmitter from 'events';\r\n\r\n/**\r\n * The class implements basic event operations - add/remove listener.\r\n * NOTE: The purpose of the class is to be extended in order to add\r\n * this functionality to other classes.\r\n */\r\nexport default class Listenable {\r\n    /**\r\n     * Creates new instance.\r\n     * @param {EventEmitter} eventEmitter\r\n     * @constructor\r\n     */\r\n    constructor(eventEmitter = new EventEmitter()) {\r\n        this.eventEmitter = eventEmitter;\r\n\r\n        // aliases for addListener/removeListener\r\n        this.addEventListener = this.on = this.addListener;\r\n        this.removeEventListener = this.off = this.removeListener;\r\n    }\r\n\r\n    /**\r\n     * Adds new listener.\r\n     * @param {String} eventName the name of the event\r\n     * @param {Function} listener the listener.\r\n     */\r\n    addListener(eventName, listener) {\r\n        this.eventEmitter.addListener(eventName, listener);\r\n    }\r\n\r\n    /**\r\n     * Removes listener.\r\n     * @param {String} eventName the name of the event that triggers the\r\n     * listener\r\n     * @param {Function} listener the listener.\r\n     */\r\n    removeListener(eventName, listener) {\r\n        this.eventEmitter.removeListener(eventName, listener);\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/util/Listenable.js","/*\r\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\r\n *\r\n *  Use of this source code is governed by a BSD-style license\r\n *  that can be found in the LICENSE file in the root of the source\r\n *  tree.\r\n */\r\n /* eslint-env node */\r\n'use strict';\r\n\r\nvar logDisabled_ = true;\r\nvar deprecationWarnings_ = true;\r\n\r\n// Utility methods.\r\nvar utils = {\r\n  disableLog: function(bool) {\r\n    if (typeof bool !== 'boolean') {\r\n      return new Error('Argument type: ' + typeof bool +\r\n          '. Please use a boolean.');\r\n    }\r\n    logDisabled_ = bool;\r\n    return (bool) ? 'adapter.js logging disabled' :\r\n        'adapter.js logging enabled';\r\n  },\r\n\r\n  /**\r\n   * Disable or enable deprecation warnings\r\n   * @param {!boolean} bool set to true to disable warnings.\r\n   */\r\n  disableWarnings: function(bool) {\r\n    if (typeof bool !== 'boolean') {\r\n      return new Error('Argument type: ' + typeof bool +\r\n          '. Please use a boolean.');\r\n    }\r\n    deprecationWarnings_ = !bool;\r\n    return 'adapter.js deprecation warnings ' + (bool ? 'disabled' : 'enabled');\r\n  },\r\n\r\n  log: function() {\r\n    if (typeof window === 'object') {\r\n      if (logDisabled_) {\r\n        return;\r\n      }\r\n      if (typeof console !== 'undefined' && typeof console.log === 'function') {\r\n        console.log.apply(console, arguments);\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Shows a deprecation warning suggesting the modern and spec-compatible API.\r\n   */\r\n  deprecated: function(oldMethod, newMethod) {\r\n    if (!deprecationWarnings_) {\r\n      return;\r\n    }\r\n    console.warn(oldMethod + ' is deprecated, please use ' + newMethod +\r\n        ' instead.');\r\n  },\r\n\r\n  /**\r\n   * Extract browser version out of the provided user agent string.\r\n   *\r\n   * @param {!string} uastring userAgent string.\r\n   * @param {!string} expr Regular expression used as match criteria.\r\n   * @param {!number} pos position in the version string to be returned.\r\n   * @return {!number} browser version.\r\n   */\r\n  extractVersion: function(uastring, expr, pos) {\r\n    var match = uastring.match(expr);\r\n    return match && match.length >= pos && parseInt(match[pos], 10);\r\n  },\r\n\r\n  /**\r\n   * Browser detector.\r\n   *\r\n   * @return {object} result containing browser and version\r\n   *     properties.\r\n   */\r\n  detectBrowser: function(window) {\r\n    var navigator = window && window.navigator;\r\n\r\n    // Returned result object.\r\n    var result = {};\r\n    result.browser = null;\r\n    result.version = null;\r\n\r\n    // Fail early if it's not a browser\r\n    if (typeof window === 'undefined' || !window.navigator) {\r\n      result.browser = 'Not a browser.';\r\n      return result;\r\n    }\r\n\r\n    // Firefox.\r\n    if (navigator.mozGetUserMedia) {\r\n      result.browser = 'firefox';\r\n      result.version = this.extractVersion(navigator.userAgent,\r\n          /Firefox\\/(\\d+)\\./, 1);\r\n    } else if (navigator.webkitGetUserMedia) {\r\n      // Chrome, Chromium, Webview, Opera, all use the chrome shim for now\r\n      if (window.webkitRTCPeerConnection) {\r\n        result.browser = 'chrome';\r\n        result.version = this.extractVersion(navigator.userAgent,\r\n          /Chrom(e|ium)\\/(\\d+)\\./, 2);\r\n      } else { // Safari (in an unpublished version) or unknown webkit-based.\r\n        if (navigator.userAgent.match(/Version\\/(\\d+).(\\d+)/)) {\r\n          result.browser = 'safari';\r\n          result.version = this.extractVersion(navigator.userAgent,\r\n            /AppleWebKit\\/(\\d+)\\./, 1);\r\n        } else { // unknown webkit-based browser.\r\n          result.browser = 'Unsupported webkit-based browser ' +\r\n              'with GUM support but no WebRTC support.';\r\n          return result;\r\n        }\r\n      }\r\n    } else if (navigator.mediaDevices &&\r\n        navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/)) { // Edge.\r\n      result.browser = 'edge';\r\n      result.version = this.extractVersion(navigator.userAgent,\r\n          /Edge\\/(\\d+).(\\d+)$/, 2);\r\n    } else if (navigator.mediaDevices &&\r\n        navigator.userAgent.match(/AppleWebKit\\/(\\d+)\\./)) {\r\n        // Safari, with webkitGetUserMedia removed.\r\n      result.browser = 'safari';\r\n      result.version = this.extractVersion(navigator.userAgent,\r\n          /AppleWebKit\\/(\\d+)\\./, 1);\r\n    } else { // Default fallthrough: not supported.\r\n      result.browser = 'Not a supported browser.';\r\n      return result;\r\n    }\r\n\r\n    return result;\r\n  },\r\n\r\n};\r\n\r\n// Export.\r\nmodule.exports = {\r\n  log: utils.log,\r\n  deprecated: utils.deprecated,\r\n  disableLog: utils.disableLog,\r\n  disableWarnings: utils.disableWarnings,\r\n  extractVersion: utils.extractVersion,\r\n  shimCreateObjectURL: utils.shimCreateObjectURL,\r\n  detectBrowser: utils.detectBrowser.bind(utils)\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/webrtc-adapter/src/js/utils.js","import * as JitsiTrackErrors from './JitsiTrackErrors';\r\n\r\nconst TRACK_ERROR_TO_MESSAGE_MAP = {};\r\n\r\nTRACK_ERROR_TO_MESSAGE_MAP[JitsiTrackErrors.UNSUPPORTED_RESOLUTION]\r\n    = 'Video resolution is not supported: ';\r\nTRACK_ERROR_TO_MESSAGE_MAP[JitsiTrackErrors.FIREFOX_EXTENSION_NEEDED]\r\n    = 'Firefox extension is not installed';\r\nTRACK_ERROR_TO_MESSAGE_MAP[JitsiTrackErrors.CHROME_EXTENSION_INSTALLATION_ERROR]\r\n    = 'Failed to install Chrome extension';\r\nTRACK_ERROR_TO_MESSAGE_MAP[\r\n    JitsiTrackErrors.CHROME_EXTENSION_USER_GESTURE_REQUIRED]\r\n    = 'Failed to install Chrome extension - installations can only be initiated'\r\n        + ' by a user gesture.';\r\nTRACK_ERROR_TO_MESSAGE_MAP[JitsiTrackErrors.CHROME_EXTENSION_USER_CANCELED]\r\n    = 'User canceled Chrome\\'s screen sharing prompt';\r\nTRACK_ERROR_TO_MESSAGE_MAP[JitsiTrackErrors.CHROME_EXTENSION_GENERIC_ERROR]\r\n    = 'Unknown error from Chrome extension';\r\nTRACK_ERROR_TO_MESSAGE_MAP[JitsiTrackErrors.ELECTRON_DESKTOP_PICKER_ERROR]\r\n    = 'Unkown error from desktop picker';\r\nTRACK_ERROR_TO_MESSAGE_MAP[JitsiTrackErrors.ELECTRON_DESKTOP_PICKER_NOT_FOUND]\r\n    = 'Failed to detect desktop picker';\r\nTRACK_ERROR_TO_MESSAGE_MAP[JitsiTrackErrors.GENERAL]\r\n    = 'Generic getUserMedia error';\r\nTRACK_ERROR_TO_MESSAGE_MAP[JitsiTrackErrors.PERMISSION_DENIED]\r\n    = 'User denied permission to use device(s): ';\r\nTRACK_ERROR_TO_MESSAGE_MAP[JitsiTrackErrors.NOT_FOUND]\r\n    = 'Requested device(s) was/were not found: ';\r\nTRACK_ERROR_TO_MESSAGE_MAP[JitsiTrackErrors.CONSTRAINT_FAILED]\r\n    = 'Constraint could not be satisfied: ';\r\nTRACK_ERROR_TO_MESSAGE_MAP[JitsiTrackErrors.TRACK_IS_DISPOSED]\r\n    = 'Track has been already disposed';\r\nTRACK_ERROR_TO_MESSAGE_MAP[JitsiTrackErrors.TRACK_NO_STREAM_FOUND]\r\n    = 'Track does not have an associated Media Stream';\r\nTRACK_ERROR_TO_MESSAGE_MAP[JitsiTrackErrors.NO_DATA_FROM_SOURCE]\r\n    = 'The track has stopped receiving data from it\\'s source';\r\n\r\n\r\n// FIXME: Using prototype inheritance because otherwise instanceof is not\r\n// working properly (see https://github.com/babel/babel/issues/3083)\r\n\r\n/**\r\n *\r\n * Represents an error that occurred to a JitsiTrack. Can represent various\r\n * types of errors. For error descriptions (@see JitsiTrackErrors).\r\n *\r\n * @extends Error\r\n *\r\n *\r\n * @constructor\r\n * @param {Object|string} error - error object or error name\r\n * @param {Object|string} (options) - getUserMedia constraints object or\r\n * error message\r\n * @param {('audio'|'video'|'desktop'|'screen'|'audiooutput')[]} (devices) -\r\n * list of getUserMedia requested devices\r\n */\r\nfunction JitsiTrackError(error, options, devices) {\r\n    if (typeof error === 'object' && typeof error.name !== 'undefined') {\r\n        /**\r\n         * Additional information about original getUserMedia error\r\n         * and constraints.\r\n         * @type {{\r\n         *     error: Object,\r\n         *     constraints: Object,\r\n         *     devices: Array.<'audio'|'video'|'desktop'|'screen'>\r\n         * }}\r\n         */\r\n        this.gum = {\r\n            error,\r\n            constraints: options,\r\n            devices: devices && Array.isArray(devices)\r\n                ? devices.slice(0)\r\n                : undefined\r\n        };\r\n\r\n        switch (error.name) {\r\n        case 'NotAllowedError':\r\n        case 'PermissionDeniedError':\r\n        case 'SecurityError':\r\n            this.name = JitsiTrackErrors.PERMISSION_DENIED;\r\n            this.message\r\n                = TRACK_ERROR_TO_MESSAGE_MAP[this.name]\r\n                    + (this.gum.devices || []).join(', ');\r\n            break;\r\n        case 'DevicesNotFoundError':\r\n        case 'NotFoundError':\r\n            this.name = JitsiTrackErrors.NOT_FOUND;\r\n            this.message\r\n                = TRACK_ERROR_TO_MESSAGE_MAP[this.name]\r\n                    + (this.gum.devices || []).join(', ');\r\n            break;\r\n        case 'ConstraintNotSatisfiedError':\r\n        case 'OverconstrainedError': {\r\n            const constraintName = error.constraintName || error.constraint;\r\n\r\n            if (options\r\n                    && options.video\r\n                    && (!devices || devices.indexOf('video') > -1)\r\n                    && (constraintName === 'minWidth'\r\n                        || constraintName === 'maxWidth'\r\n                        || constraintName === 'minHeight'\r\n                        || constraintName === 'maxHeight'\r\n                        || constraintName === 'width'\r\n                        || constraintName === 'height')) {\r\n                this.name = JitsiTrackErrors.UNSUPPORTED_RESOLUTION;\r\n                this.message\r\n                    = TRACK_ERROR_TO_MESSAGE_MAP[this.name]\r\n                        + getResolutionFromFailedConstraint(\r\n                            constraintName,\r\n                            options);\r\n            } else {\r\n                this.name = JitsiTrackErrors.CONSTRAINT_FAILED;\r\n                this.message\r\n                    = TRACK_ERROR_TO_MESSAGE_MAP[this.name]\r\n                        + error.constraintName;\r\n            }\r\n            break;\r\n        }\r\n\r\n        default:\r\n            this.name = JitsiTrackErrors.GENERAL;\r\n            this.message\r\n                = error.message || TRACK_ERROR_TO_MESSAGE_MAP[this.name];\r\n            break;\r\n        }\r\n    } else if (typeof error === 'string') {\r\n        if (TRACK_ERROR_TO_MESSAGE_MAP[error]) {\r\n            this.name = error;\r\n            this.message = options || TRACK_ERROR_TO_MESSAGE_MAP[error];\r\n        } else {\r\n            // this is some generic error that do not fit any of our\r\n            // pre-defined errors, so don't give it any specific name, just\r\n            // store message\r\n            this.message = error;\r\n        }\r\n    } else {\r\n        throw new Error('Invalid arguments');\r\n    }\r\n\r\n    this.stack = error.stack || (new Error()).stack;\r\n}\r\n\r\nJitsiTrackError.prototype = Object.create(Error.prototype);\r\nJitsiTrackError.prototype.constructor = JitsiTrackError;\r\n\r\n/**\r\n * Gets failed resolution constraint from corresponding object.\r\n * @param {string} failedConstraintName\r\n * @param {Object} constraints\r\n * @returns {string|number}\r\n */\r\nfunction getResolutionFromFailedConstraint(failedConstraintName, constraints) {\r\n    if (constraints && constraints.video && constraints.video.mandatory) {\r\n        switch (failedConstraintName) {\r\n        case 'width':\r\n            return constraints.video.mandatory.minWidth;\r\n        case 'height':\r\n            return constraints.video.mandatory.minHeight;\r\n        default:\r\n            return constraints.video.mandatory[failedConstraintName] || '';\r\n        }\r\n    }\r\n\r\n    return '';\r\n}\r\n\r\nexport default JitsiTrackError;\r\n\n\n\n// WEBPACK FOOTER //\n// ./JitsiTrackError.js","/* global module */\r\n/**\r\n * Enumeration of the video types\r\n * @type {{CAMERA: string, DESKTOP: string}}\r\n */\r\nconst VideoType = {\r\n    /**\r\n     * The camera video type.\r\n     */\r\n    CAMERA: 'camera',\r\n\r\n    /**\r\n     * The desktop video type.\r\n     */\r\n    DESKTOP: 'desktop'\r\n};\r\n\r\nmodule.exports = VideoType;\r\n\n\n\n// WEBPACK FOOTER //\n// ./service/RTC/VideoType.js","import { getLogger } from 'jitsi-meet-logger';\r\nconst logger = getLogger(__filename);\r\n\r\nimport RandomUtil from '../util/RandomUtil';\r\nimport browser from '../browser';\r\n\r\nconst SDPUtil = {\r\n    filterSpecialChars(text) {\r\n        // XXX Neither one of the falsy values (e.g. null, undefined, false,\r\n        // \"\", etc.) \"contain\" special chars.\r\n        // eslint-disable-next-line no-useless-escape\r\n        return text ? text.replace(/[\\\\\\/\\{,\\}\\+]/g, '') : text;\r\n    },\r\n    iceparams(mediadesc, sessiondesc) {\r\n        let data = null;\r\n        let pwd, ufrag;\r\n\r\n        if ((ufrag = SDPUtil.findLine(mediadesc, 'a=ice-ufrag:', sessiondesc))\r\n                && (pwd\r\n                    = SDPUtil.findLine(\r\n                        mediadesc,\r\n                        'a=ice-pwd:',\r\n                        sessiondesc))) {\r\n            data = {\r\n                ufrag: SDPUtil.parseICEUfrag(ufrag),\r\n                pwd: SDPUtil.parseICEPwd(pwd)\r\n            };\r\n        }\r\n\r\n        return data;\r\n    },\r\n    parseICEUfrag(line) {\r\n        return line.substring(12);\r\n    },\r\n    buildICEUfrag(frag) {\r\n        return `a=ice-ufrag:${frag}`;\r\n    },\r\n    parseICEPwd(line) {\r\n        return line.substring(10);\r\n    },\r\n    buildICEPwd(pwd) {\r\n        return `a=ice-pwd:${pwd}`;\r\n    },\r\n    parseMID(line) {\r\n        return line.substring(6);\r\n    },\r\n    parseMLine(line) {\r\n        const data = {};\r\n        const parts = line.substring(2).split(' ');\r\n\r\n        data.media = parts.shift();\r\n        data.port = parts.shift();\r\n        data.proto = parts.shift();\r\n        if (parts[parts.length - 1] === '') { // trailing whitespace\r\n            parts.pop();\r\n        }\r\n        data.fmt = parts;\r\n\r\n        return data;\r\n    },\r\n    buildMLine(mline) {\r\n        return (\r\n            `m=${mline.media} ${mline.port} ${mline.proto} ${\r\n                mline.fmt.join(' ')}`);\r\n    },\r\n    parseRTPMap(line) {\r\n        const data = {};\r\n        let parts = line.substring(9).split(' ');\r\n\r\n        data.id = parts.shift();\r\n        parts = parts[0].split('/');\r\n        data.name = parts.shift();\r\n        data.clockrate = parts.shift();\r\n        data.channels = parts.length ? parts.shift() : '1';\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Parses SDP line \"a=sctpmap:...\" and extracts SCTP port from it.\r\n     * @param line eg. \"a=sctpmap:5000 webrtc-datachannel\"\r\n     * @returns [SCTP port number, protocol, streams]\r\n     */\r\n    parseSCTPMap(line) {\r\n        const parts = line.substring(10).split(' ');\r\n        const sctpPort = parts[0];\r\n        const protocol = parts[1];\r\n\r\n        // Stream count is optional\r\n        const streamCount = parts.length > 2 ? parts[2] : null;\r\n\r\n\r\n        return [ sctpPort, protocol, streamCount ];// SCTP port\r\n    },\r\n    buildRTPMap(el) {\r\n        let line\r\n            = `a=rtpmap:${el.getAttribute('id')} ${el.getAttribute('name')}/${\r\n                el.getAttribute('clockrate')}`;\r\n\r\n        if (el.getAttribute('channels')\r\n            && el.getAttribute('channels') !== '1') {\r\n            line += `/${el.getAttribute('channels')}`;\r\n        }\r\n\r\n        return line;\r\n    },\r\n    parseCrypto(line) {\r\n        const data = {};\r\n        const parts = line.substring(9).split(' ');\r\n\r\n        data.tag = parts.shift();\r\n        data['crypto-suite'] = parts.shift();\r\n        data['key-params'] = parts.shift();\r\n        if (parts.length) {\r\n            data['session-params'] = parts.join(' ');\r\n        }\r\n\r\n        return data;\r\n    },\r\n    parseFingerprint(line) { // RFC 4572\r\n        const data = {};\r\n        const parts = line.substring(14).split(' ');\r\n\r\n        data.hash = parts.shift();\r\n        data.fingerprint = parts.shift();\r\n\r\n        // TODO assert that fingerprint satisfies 2UHEX *(\":\" 2UHEX) ?\r\n        return data;\r\n    },\r\n    parseFmtp(line) {\r\n        const data = [];\r\n        let parts = line.split(' ');\r\n\r\n        parts.shift();\r\n        parts = parts.join(' ').split(';');\r\n        for (let i = 0; i < parts.length; i++) {\r\n            let key = parts[i].split('=')[0];\r\n\r\n            while (key.length && key[0] === ' ') {\r\n                key = key.substring(1);\r\n            }\r\n            const value = parts[i].split('=')[1];\r\n\r\n            if (key && value) {\r\n                data.push({ name: key,\r\n                    value });\r\n            } else if (key) {\r\n                // rfc 4733 (DTMF) style stuff\r\n                data.push({ name: '',\r\n                    value: key });\r\n            }\r\n        }\r\n\r\n        return data;\r\n    },\r\n    parseICECandidate(line) {\r\n        const candidate = {};\r\n        const elems = line.split(' ');\r\n\r\n        candidate.foundation = elems[0].substring(12);\r\n        candidate.component = elems[1];\r\n        candidate.protocol = elems[2].toLowerCase();\r\n        candidate.priority = elems[3];\r\n        candidate.ip = elems[4];\r\n        candidate.port = elems[5];\r\n\r\n        // elems[6] => \"typ\"\r\n        candidate.type = elems[7];\r\n        candidate.generation = 0; // default value, may be overwritten below\r\n        for (let i = 8; i < elems.length; i += 2) {\r\n            switch (elems[i]) {\r\n            case 'raddr':\r\n                candidate['rel-addr'] = elems[i + 1];\r\n                break;\r\n            case 'rport':\r\n                candidate['rel-port'] = elems[i + 1];\r\n                break;\r\n            case 'generation':\r\n                candidate.generation = elems[i + 1];\r\n                break;\r\n            case 'tcptype':\r\n                candidate.tcptype = elems[i + 1];\r\n                break;\r\n            default: // TODO\r\n                logger.log(\r\n                    `parseICECandidate not translating \"${\r\n                        elems[i]}\" = \"${elems[i + 1]}\"`);\r\n            }\r\n        }\r\n        candidate.network = '1';\r\n\r\n        // not applicable to SDP -- FIXME: should be unique, not just random\r\n        // eslint-disable-next-line newline-per-chained-call\r\n        candidate.id = Math.random().toString(36).substr(2, 10);\r\n\r\n        return candidate;\r\n    },\r\n    buildICECandidate(cand) {\r\n        let line = [\r\n            `a=candidate:${cand.foundation}`,\r\n            cand.component,\r\n            cand.protocol,\r\n            cand.priority,\r\n            cand.ip,\r\n            cand.port,\r\n            'typ',\r\n            cand.type\r\n        ].join(' ');\r\n\r\n        line += ' ';\r\n        switch (cand.type) {\r\n        case 'srflx':\r\n        case 'prflx':\r\n        case 'relay':\r\n            if (cand.hasOwnAttribute('rel-addr')\r\n                    && cand.hasOwnAttribute('rel-port')) {\r\n                line += 'raddr';\r\n                line += ' ';\r\n                line += cand['rel-addr'];\r\n                line += ' ';\r\n                line += 'rport';\r\n                line += ' ';\r\n                line += cand['rel-port'];\r\n                line += ' ';\r\n            }\r\n            break;\r\n        }\r\n        if (cand.hasOwnAttribute('tcptype')) {\r\n            line += 'tcptype';\r\n            line += ' ';\r\n            line += cand.tcptype;\r\n            line += ' ';\r\n        }\r\n        line += 'generation';\r\n        line += ' ';\r\n        line += cand.hasOwnAttribute('generation') ? cand.generation : '0';\r\n\r\n        return line;\r\n    },\r\n    parseSSRC(desc) {\r\n        // proprietary mapping of a=ssrc lines\r\n        // TODO: see \"Jingle RTP Source Description\" by Juberti and P. Thatcher\r\n        // on google docs and parse according to that\r\n        const data = new Map();\r\n        const lines = desc.split('\\r\\n');\r\n\r\n        for (let i = 0; i < lines.length; i++) {\r\n            if (lines[i].substring(0, 7) === 'a=ssrc:') {\r\n                // FIXME: Use regex to smartly find the ssrc.\r\n                const ssrc = lines[i].split('a=ssrc:')[1].split(' ')[0];\r\n\r\n                if (!data.get(ssrc)) {\r\n                    data.set(ssrc, []);\r\n                }\r\n\r\n                data.get(ssrc).push(lines[i]);\r\n            }\r\n        }\r\n\r\n        return data;\r\n    },\r\n    parseRTCPFB(line) {\r\n        const parts = line.substr(10).split(' ');\r\n        const data = {};\r\n\r\n        data.pt = parts.shift();\r\n        data.type = parts.shift();\r\n        data.params = parts;\r\n\r\n        return data;\r\n    },\r\n    parseExtmap(line) {\r\n        const parts = line.substr(9).split(' ');\r\n        const data = {};\r\n\r\n        data.value = parts.shift();\r\n        if (data.value.indexOf('/') === -1) {\r\n            data.direction = 'both';\r\n        } else {\r\n            data.direction = data.value.substr(data.value.indexOf('/') + 1);\r\n            data.value = data.value.substr(0, data.value.indexOf('/'));\r\n        }\r\n        data.uri = parts.shift();\r\n        data.params = parts;\r\n\r\n        return data;\r\n    },\r\n    findLine(haystack, needle, sessionpart) {\r\n        let lines = haystack.split('\\r\\n');\r\n\r\n        for (let i = 0; i < lines.length; i++) {\r\n            if (lines[i].substring(0, needle.length) === needle) {\r\n                return lines[i];\r\n            }\r\n        }\r\n        if (!sessionpart) {\r\n            return false;\r\n        }\r\n\r\n        // search session part\r\n        lines = sessionpart.split('\\r\\n');\r\n        for (let j = 0; j < lines.length; j++) {\r\n            if (lines[j].substring(0, needle.length) === needle) {\r\n                return lines[j];\r\n            }\r\n        }\r\n\r\n        return false;\r\n    },\r\n    findLines(haystack, needle, sessionpart) {\r\n        let lines = haystack.split('\\r\\n');\r\n        const needles = [];\r\n\r\n        for (let i = 0; i < lines.length; i++) {\r\n            if (lines[i].substring(0, needle.length) === needle) {\r\n                needles.push(lines[i]);\r\n            }\r\n        }\r\n        if (needles.length || !sessionpart) {\r\n            return needles;\r\n        }\r\n\r\n        // search session part\r\n        lines = sessionpart.split('\\r\\n');\r\n        for (let j = 0; j < lines.length; j++) {\r\n            if (lines[j].substring(0, needle.length) === needle) {\r\n                needles.push(lines[j]);\r\n            }\r\n        }\r\n\r\n        return needles;\r\n    },\r\n    candidateToJingle(line) {\r\n        // a=candidate:2979166662 1 udp 2113937151 192.168.2.100 57698 typ host\r\n        // generation 0\r\n        //      <candidate component=... foundation=... generation=... id=...\r\n        // ip=... network=... port=... priority=... protocol=... type=.../>\r\n        if (line.indexOf('candidate:') === 0) {\r\n            // eslint-disable-next-line no-param-reassign\r\n            line = `a=${line}`;\r\n        } else if (line.substring(0, 12) !== 'a=candidate:') {\r\n            logger.log(\r\n                'parseCandidate called with a line that is not a candidate'\r\n                    + ' line');\r\n            logger.log(line);\r\n\r\n            return null;\r\n        }\r\n        if (line.substring(line.length - 2) === '\\r\\n') { // chomp it\r\n            // eslint-disable-next-line no-param-reassign\r\n            line = line.substring(0, line.length - 2);\r\n        }\r\n        const candidate = {};\r\n        const elems = line.split(' ');\r\n\r\n        if (elems[6] !== 'typ') {\r\n            logger.log('did not find typ in the right place');\r\n            logger.log(line);\r\n\r\n            return null;\r\n        }\r\n        candidate.foundation = elems[0].substring(12);\r\n        candidate.component = elems[1];\r\n        candidate.protocol = elems[2].toLowerCase();\r\n        candidate.priority = elems[3];\r\n        candidate.ip = elems[4];\r\n        candidate.port = elems[5];\r\n\r\n        // elems[6] => \"typ\"\r\n        candidate.type = elems[7];\r\n\r\n        candidate.generation = '0'; // default, may be overwritten below\r\n        for (let i = 8; i < elems.length; i += 2) {\r\n            switch (elems[i]) {\r\n            case 'raddr':\r\n                candidate['rel-addr'] = elems[i + 1];\r\n                break;\r\n            case 'rport':\r\n                candidate['rel-port'] = elems[i + 1];\r\n                break;\r\n            case 'generation':\r\n                candidate.generation = elems[i + 1];\r\n                break;\r\n            case 'tcptype':\r\n                candidate.tcptype = elems[i + 1];\r\n                break;\r\n            default: // TODO\r\n                logger.log(`not translating \"${elems[i]}\" = \"${elems[i + 1]}\"`);\r\n            }\r\n        }\r\n        candidate.network = '1';\r\n\r\n        // not applicable to SDP -- FIXME: should be unique, not just random\r\n        // eslint-disable-next-line newline-per-chained-call\r\n        candidate.id = Math.random().toString(36).substr(2, 10);\r\n\r\n        return candidate;\r\n    },\r\n    candidateFromJingle(cand) {\r\n        let line = 'a=candidate:';\r\n\r\n        line += cand.getAttribute('foundation');\r\n        line += ' ';\r\n        line += cand.getAttribute('component');\r\n        line += ' ';\r\n\r\n        let protocol = cand.getAttribute('protocol');\r\n\r\n        // use tcp candidates for FF\r\n\r\n        if (browser.isFirefox() && protocol.toLowerCase() === 'ssltcp') {\r\n            protocol = 'tcp';\r\n        }\r\n\r\n        line += protocol; // .toUpperCase(); // chrome M23 doesn't like this\r\n        line += ' ';\r\n        line += cand.getAttribute('priority');\r\n        line += ' ';\r\n        line += cand.getAttribute('ip');\r\n        line += ' ';\r\n        line += cand.getAttribute('port');\r\n        line += ' ';\r\n        line += 'typ';\r\n        line += ` ${cand.getAttribute('type')}`;\r\n        line += ' ';\r\n        switch (cand.getAttribute('type')) {\r\n        case 'srflx':\r\n        case 'prflx':\r\n        case 'relay':\r\n            if (cand.getAttribute('rel-addr')\r\n                    && cand.getAttribute('rel-port')) {\r\n                line += 'raddr';\r\n                line += ' ';\r\n                line += cand.getAttribute('rel-addr');\r\n                line += ' ';\r\n                line += 'rport';\r\n                line += ' ';\r\n                line += cand.getAttribute('rel-port');\r\n                line += ' ';\r\n            }\r\n            break;\r\n        }\r\n        if (protocol.toLowerCase() === 'tcp') {\r\n            line += 'tcptype';\r\n            line += ' ';\r\n            line += cand.getAttribute('tcptype');\r\n            line += ' ';\r\n        }\r\n        line += 'generation';\r\n        line += ' ';\r\n        line += cand.getAttribute('generation') || '0';\r\n\r\n        return `${line}\\r\\n`;\r\n    },\r\n\r\n    /**\r\n     * Parse the 'most' primary video ssrc from the given m line\r\n     * @param {object} mLine object as parsed from transform.parse\r\n     * @return {number} the primary video ssrc from the given m line\r\n     */\r\n    parsePrimaryVideoSsrc(videoMLine) {\r\n        const numSsrcs = videoMLine.ssrcs\r\n            .map(ssrcInfo => ssrcInfo.id)\r\n            .filter((ssrc, index, array) => array.indexOf(ssrc) === index)\r\n            .length;\r\n        const numGroups\r\n            = (videoMLine.ssrcGroups && videoMLine.ssrcGroups.length) || 0;\r\n\r\n        if (numSsrcs > 1 && numGroups === 0) {\r\n            // Ambiguous, can't figure out the primary\r\n            return;\r\n        }\r\n        let primarySsrc = null;\r\n\r\n        if (numSsrcs === 1) {\r\n            primarySsrc = videoMLine.ssrcs[0].id;\r\n        } else if (numSsrcs === 2) {\r\n            // Can figure it out if there's an FID group\r\n            const fidGroup\r\n                = videoMLine.ssrcGroups.find(\r\n                    group => group.semantics === 'FID');\r\n\r\n            if (fidGroup) {\r\n                primarySsrc = fidGroup.ssrcs.split(' ')[0];\r\n            }\r\n        } else if (numSsrcs >= 3) {\r\n            // Can figure it out if there's a sim group\r\n            const simGroup\r\n                = videoMLine.ssrcGroups.find(\r\n                    group => group.semantics === 'SIM');\r\n\r\n            if (simGroup) {\r\n                primarySsrc = simGroup.ssrcs.split(' ')[0];\r\n            }\r\n        }\r\n\r\n        return primarySsrc;\r\n    },\r\n\r\n    /**\r\n     * Generate an ssrc\r\n     * @returns {number} an ssrc\r\n     */\r\n    generateSsrc() {\r\n        return RandomUtil.randomInt(1, 0xffffffff);\r\n    },\r\n\r\n    /**\r\n     * Get an attribute for the given ssrc with the given attributeName\r\n     *  from the given mline\r\n     * @param {object} mLine an mLine object as parsed from transform.parse\r\n     * @param {number} ssrc the ssrc for which an attribtue is desired\r\n     * @param {string} attributeName the name of the desired attribute\r\n     * @returns {string} the value corresponding to the given ssrc\r\n     *  and attributeName\r\n     */\r\n    getSsrcAttribute(mLine, ssrc, attributeName) {\r\n        for (let i = 0; i < mLine.ssrcs.length; ++i) {\r\n            const ssrcLine = mLine.ssrcs[i];\r\n\r\n            if (ssrcLine.id === ssrc\r\n                && ssrcLine.attribute === attributeName) {\r\n                return ssrcLine.value;\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Parses the ssrcs from the group sdp line and\r\n     *  returns them as a list of numbers\r\n     * @param {object} the ssrcGroup object as parsed from\r\n     *  sdp-transform\r\n     * @returns {list<number>} a list of the ssrcs in the group\r\n     *  parsed as numbers\r\n     */\r\n    parseGroupSsrcs(ssrcGroup) {\r\n        return ssrcGroup\r\n            .ssrcs\r\n            .split(' ')\r\n            .map(ssrcStr => parseInt(ssrcStr, 10));\r\n    },\r\n\r\n    /**\r\n     * Get the mline of the given type from the given sdp\r\n     * @param {object} sdp sdp as parsed from transform.parse\r\n     * @param {string} type the type of the desired mline (e.g. \"video\")\r\n     * @returns {object} a media object\r\n     */\r\n    getMedia(sdp, type) {\r\n        return sdp.media.find(m => m.type === type);\r\n    },\r\n\r\n    /**\r\n     * Extracts the ICE username fragment from an SDP string.\r\n     * @param {string} sdp the SDP in raw text format\r\n     */\r\n    getUfrag(sdp) {\r\n        const ufragLines\r\n            = sdp.split('\\n').filter(line => line.startsWith('a=ice-ufrag:'));\r\n\r\n        if (ufragLines.length > 0) {\r\n            return ufragLines[0].substr('a=ice-ufrag:'.length);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Sets the given codecName as the preferred codec by\r\n     *  moving it to the beginning of the payload types\r\n     *  list (modifies the given mline in place).  If there\r\n     *  are multiple options within the same codec (multiple h264\r\n     *  profiles, for instance), this will prefer the first one\r\n     *  that is found.\r\n     * @param {object} videoMLine the video mline object from\r\n     *  an sdp as parsed by transform.parse\r\n     * @param {string} codecName the name of the preferred codec\r\n     */\r\n    preferVideoCodec(videoMLine, codecName) {\r\n        let payloadType = null;\r\n\r\n        if (!videoMLine || !codecName) {\r\n            return;\r\n        }\r\n\r\n        for (let i = 0; i < videoMLine.rtp.length; ++i) {\r\n            const rtp = videoMLine.rtp[i];\r\n\r\n            if (rtp.codec\r\n                && rtp.codec.toLowerCase() === codecName.toLowerCase()) {\r\n                payloadType = rtp.payload;\r\n                break;\r\n            }\r\n        }\r\n        if (payloadType) {\r\n            // Call toString() on payloads to get around an issue within\r\n            // SDPTransform that sets payloads as a number, instead of a string,\r\n            // when there is only one payload.\r\n            const payloadTypes\r\n                = videoMLine.payloads\r\n                    .toString()\r\n                    .split(' ')\r\n                    .map(p => parseInt(p, 10));\r\n            const payloadIndex = payloadTypes.indexOf(payloadType);\r\n\r\n            payloadTypes.splice(payloadIndex, 1);\r\n            payloadTypes.unshift(payloadType);\r\n            videoMLine.payloads = payloadTypes.join(' ');\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Strips the given codec from the given mline. All related RTX payload\r\n     * types are also stripped. If the resulting mline would have no codecs,\r\n     * it's disabled.\r\n     *\r\n     * @param {object} videoMLine the video mline object from an sdp as parsed\r\n     * by transform.parse.\r\n     * @param {string} codecName the name of the codec which will be stripped.\r\n     */\r\n    stripVideoCodec(videoMLine, codecName) {\r\n        if (!videoMLine || !codecName) {\r\n            return;\r\n        }\r\n\r\n        const removePts = [];\r\n\r\n        for (const rtp of videoMLine.rtp) {\r\n            if (rtp.codec\r\n                && rtp.codec.toLowerCase() === codecName.toLowerCase()) {\r\n                removePts.push(rtp.payload);\r\n            }\r\n        }\r\n\r\n        if (removePts.length > 0) {\r\n            // We also need to remove the payload types that are related to RTX\r\n            // for the codecs we want to disable.\r\n            const rtxApts = removePts.map(item => `apt=${item}`);\r\n            const rtxPts = videoMLine.fmtp.filter(\r\n                item => rtxApts.indexOf(item.config) !== -1);\r\n\r\n            removePts.push(...rtxPts.map(item => item.payload));\r\n\r\n            // Call toString() on payloads to get around an issue within\r\n            // SDPTransform that sets payloads as a number, instead of a string,\r\n            // when there is only one payload.\r\n            const allPts = videoMLine.payloads\r\n                .toString()\r\n                .split(' ')\r\n                .map(Number);\r\n            const keepPts = allPts.filter(pt => removePts.indexOf(pt) === -1);\r\n\r\n            if (keepPts.length === 0) {\r\n                // There are no other video codecs, disable the stream.\r\n                videoMLine.port = 0;\r\n                videoMLine.direction = 'inactive';\r\n                videoMLine.payloads = '*';\r\n            } else {\r\n                videoMLine.payloads = keepPts.join(' ');\r\n            }\r\n\r\n            videoMLine.rtp = videoMLine.rtp.filter(\r\n                item => keepPts.indexOf(item.payload) !== -1);\r\n            videoMLine.fmtp = videoMLine.fmtp.filter(\r\n                item => keepPts.indexOf(item.payload) !== -1);\r\n            if (videoMLine.rtcpFb) {\r\n                videoMLine.rtcpFb = videoMLine.rtcpFb.filter(\r\n                    item => keepPts.indexOf(item.payload) !== -1);\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\nexport default SDPUtil;\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/xmpp/SDPUtil.js","var parser = require('./parser');\nvar writer = require('./writer');\n\nexports.write = writer;\nexports.parse = parser.parse;\nexports.parseFmtpConfig = parser.parseFmtpConfig;\nexports.parseParams = parser.parseParams;\nexports.parsePayloads = parser.parsePayloads;\nexports.parseRemoteCandidates = parser.parseRemoteCandidates;\nexports.parseImageAttributes = parser.parseImageAttributes;\nexports.parseSimulcastStreamList = parser.parseSimulcastStreamList;\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/sdp-transform/lib/index.js","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        // At least give some kind of context to the user\n        var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n        err.context = er;\n        throw err;\n      }\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/events/events.js","/**\r\n * The errors for the JitsiTrack objects.\r\n */\r\n\r\n/**\r\n * Generic error for jidesha extension for Chrome.\r\n */\r\nexport const CHROME_EXTENSION_GENERIC_ERROR\r\n    = 'gum.chrome_extension_generic_error';\r\n\r\n/**\r\n * An error which indicates that the jidesha extension for Chrome is\r\n * failed to install.\r\n */\r\nexport const CHROME_EXTENSION_INSTALLATION_ERROR\r\n    = 'gum.chrome_extension_installation_error';\r\n\r\n/**\r\n * This error indicates that the attempt to start screensharing was initiated by\r\n * a script which did not originate in user gesture handler. It means that\r\n * you should to trigger the action again in response to a button click for\r\n * example.\r\n * @type {string}\r\n */\r\nexport const CHROME_EXTENSION_USER_GESTURE_REQUIRED\r\n    = 'gum.chrome_extension_user_gesture_required';\r\n\r\n/**\r\n * An error which indicates that user canceled screen sharing window\r\n * selection dialog in jidesha extension for Chrome.\r\n */\r\nexport const CHROME_EXTENSION_USER_CANCELED\r\n    = 'gum.chrome_extension_user_canceled';\r\n\r\n/**\r\n * An error which indicates that some of requested constraints in\r\n * getUserMedia call were not satisfied.\r\n */\r\nexport const CONSTRAINT_FAILED = 'gum.constraint_failed';\r\n\r\n/**\r\n * A generic error which indicates an error occurred while selecting\r\n * a DesktopCapturerSource from the electron app.\r\n */\r\nexport const ELECTRON_DESKTOP_PICKER_ERROR\r\n    = 'gum.electron_desktop_picker_error';\r\n\r\n/**\r\n * An error which indicates a custom desktop picker could not be detected\r\n * for the electron app.\r\n */\r\nexport const ELECTRON_DESKTOP_PICKER_NOT_FOUND\r\n    = 'gum.electron_desktop_picker_not_found';\r\n\r\n/**\r\n * An error which indicates that the jidesha extension for Firefox is\r\n * needed to proceed with screen sharing, and that it is not installed.\r\n */\r\nexport const FIREFOX_EXTENSION_NEEDED = 'gum.firefox_extension_needed';\r\n\r\n/**\r\n * Generic getUserMedia error.\r\n */\r\nexport const GENERAL = 'gum.general';\r\n\r\n/**\r\n * An error which indicates that requested device was not found.\r\n */\r\nexport const NOT_FOUND = 'gum.not_found';\r\n\r\n/**\r\n * An error which indicates that user denied permission to share requested\r\n * device.\r\n */\r\nexport const PERMISSION_DENIED = 'gum.permission_denied';\r\n\r\n/**\r\n * An error which indicates that track has been already disposed and cannot\r\n * be longer used.\r\n */\r\nexport const TRACK_IS_DISPOSED = 'track.track_is_disposed';\r\n\r\n/**\r\n * An error which indicates that track has no MediaStream associated.\r\n */\r\nexport const TRACK_NO_STREAM_FOUND = 'track.no_stream_found';\r\n\r\n/**\r\n * An error which indicates that requested video resolution is not supported\r\n * by a webcam.\r\n */\r\nexport const UNSUPPORTED_RESOLUTION = 'gum.unsupported_resolution';\r\n\r\n/**\r\n * Indicates that the track is no receiving any data without reason(the\r\n * stream was stopped, etc)\r\n */\r\nexport const NO_DATA_FROM_SOURCE = 'track.no_data_from_source';\r\n\n\n\n// WEBPACK FOOTER //\n// ./JitsiTrackErrors.js","/**\r\n * The media track was removed to the conference.\r\n */\r\nexport const LOCAL_TRACK_STOPPED = 'track.stopped';\r\n\r\n/**\r\n * Audio levels of a this track was changed.\r\n * The first argument is a number with audio level value in range [0, 1].\r\n * The second argument is a <tt>TraceablePeerConnection</tt> which is the peer\r\n * connection which measured the audio level (one audio track can be added\r\n * to multiple peer connection at the same time). This argument is optional for\r\n * local tracks for which we can measure audio level without the peer\r\n * connection (the value will be <tt>undefined</tt>).\r\n *\r\n * NOTE The second argument should be treated as library internal and can be\r\n * removed at any time.\r\n */\r\nexport const TRACK_AUDIO_LEVEL_CHANGED = 'track.audioLevelsChanged';\r\n\r\n/**\r\n * The audio output of the track was changed.\r\n */\r\nexport const TRACK_AUDIO_OUTPUT_CHANGED = 'track.audioOutputChanged';\r\n\r\n/**\r\n * A media track mute status was changed.\r\n */\r\nexport const TRACK_MUTE_CHANGED = 'track.trackMuteChanged';\r\n\r\n/**\r\n * The video type(\"camera\" or \"desktop\") of the track was changed.\r\n */\r\nexport const TRACK_VIDEOTYPE_CHANGED = 'track.videoTypeChanged';\r\n\r\n/**\r\n * Indicates that the track is not receiving any data even though we expect it\r\n * to receive data (i.e. the stream is not stopped).\r\n */\r\nexport const NO_DATA_FROM_SOURCE = 'track.no_data_from_source';\r\n\n\n\n// WEBPACK FOOTER //\n// ./JitsiTrackEvents.js","/**\r\n * @const\r\n */\r\nconst ALPHANUM\r\n    = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';\r\n\r\n/**\r\n * Hexadecimal digits.\r\n * @const\r\n */\r\nconst HEX_DIGITS = '0123456789abcdef';\r\n\r\n/**\r\n * Generates random int within the range [min, max]\r\n * @param min the minimum value for the generated number\r\n * @param max the maximum value for the generated number\r\n * @returns random int number\r\n */\r\nfunction randomInt(min, max) {\r\n    return Math.floor(Math.random() * (max - min + 1)) + min;\r\n}\r\n\r\n/**\r\n * Get random element from array or string.\r\n * @param {Array|string} arr source\r\n * @returns array element or string character\r\n */\r\nfunction randomElement(arr) {\r\n    return arr[randomInt(0, arr.length - 1)];\r\n}\r\n\r\n/**\r\n * Generate random alphanumeric string.\r\n * @param {number} length expected string length\r\n * @returns {string} random string of specified length\r\n */\r\nfunction randomAlphanumStr(length) {\r\n    let result = '';\r\n\r\n    for (let i = 0; i < length; i += 1) {\r\n        result += randomElement(ALPHANUM);\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n/**\r\n * Exported interface.\r\n */\r\nconst RandomUtil = {\r\n    /**\r\n     * Returns a random hex digit.\r\n     * @returns {*}\r\n     */\r\n    randomHexDigit() {\r\n        return randomElement(HEX_DIGITS);\r\n    },\r\n\r\n    /**\r\n     * Returns a random string of hex digits with length 'len'.\r\n     * @param len the length.\r\n     */\r\n    randomHexString(len) {\r\n        let ret = '';\r\n\r\n        while (len--) { // eslint-disable-line no-param-reassign\r\n            ret += this.randomHexDigit();\r\n        }\r\n\r\n        return ret;\r\n    },\r\n    randomElement,\r\n    randomAlphanumStr,\r\n    randomInt\r\n};\r\n\r\nmodule.exports = RandomUtil;\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/util/RandomUtil.js","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n\n// WEBPACK FOOTER //\n// (webpack)/buildin/global.js","/*! precalltest  version = 1.1.5 2018-01-11 */\n\n\"use strict\";function getCurrent(){return window&&window.performance&&window.performance.now&&window.performance.timing&&window.performance.timing.navigationStart?window.performance.now()+window.performance.timing.navigationStart:Date.now()}Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.getCurrent=getCurrent;\n\n\n// WEBPACK FOOTER //\n// ./node_modules/precalltest/dist/utility/timestamps.js","import Listenable from '../util/Listenable';\r\n\r\n/**\r\n * Creates ConnectionPlugin class that extends the passed class.\r\n * @param {Class} base the definition of the class that will be extended by\r\n * ConnectionPlugin\r\n */\r\nfunction getConnectionPluginDefinition(base = class {}) {\r\n    /**\r\n     * Base class for strophe connection plugins.\r\n     */\r\n    return class extends base {\r\n        /**\r\n         *\r\n         */\r\n        constructor(...args) {\r\n            super(...args);\r\n            this.connection = null;\r\n        }\r\n\r\n        /**\r\n         *\r\n         * @param connection\r\n         */\r\n        init(connection) {\r\n            this.connection = connection;\r\n        }\r\n    };\r\n}\r\n\r\n/**\r\n * ConnectionPlugin class.\r\n */\r\nexport default getConnectionPluginDefinition();\r\n\r\n/**\r\n * ConnectionPlugin class that extends Listenable.\r\n */\r\nexport const ConnectionPluginListenable\r\n    = getConnectionPluginDefinition(Listenable);\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/xmpp/ConnectionPlugin.js","import { getLogger } from 'jitsi-meet-logger';\r\nconst logger = getLogger(__filename);\r\n\r\nimport UsernameGenerator from '../util/UsernameGenerator';\r\n\r\nlet _callStatsUserName;\r\n\r\nlet _machineId;\r\n\r\n/**\r\n *\r\n */\r\nexport default {\r\n    /**\r\n     * Returns fake username for callstats\r\n     * @returns {string} fake username for callstats\r\n     */\r\n    get callStatsUserName() {\r\n        if (!_callStatsUserName) {\r\n            const localStorage = getLocalStorage();\r\n\r\n            if (localStorage) {\r\n                _callStatsUserName = localStorage.getItem('callStatsUserName');\r\n            }\r\n            if (!_callStatsUserName) {\r\n                _callStatsUserName = generateCallStatsUserName();\r\n                if (localStorage) {\r\n                    localStorage.setItem(\r\n                        'callStatsUserName',\r\n                        _callStatsUserName);\r\n                }\r\n            }\r\n        }\r\n\r\n        return _callStatsUserName;\r\n    },\r\n\r\n    /**\r\n     * Returns current machine id.\r\n     * @returns {string} machine id\r\n     */\r\n    get machineId() {\r\n        if (!_machineId) {\r\n            const localStorage = getLocalStorage();\r\n\r\n            if (localStorage) {\r\n                _machineId = localStorage.getItem('jitsiMeetId');\r\n            }\r\n            if (!_machineId) {\r\n                _machineId = generateJitsiMeetId();\r\n                if (localStorage) {\r\n                    localStorage.setItem('jitsiMeetId', _machineId);\r\n                }\r\n            }\r\n        }\r\n\r\n        return _machineId;\r\n    },\r\n\r\n    /**\r\n     * Returns current session id.\r\n     * @returns {string} current session id\r\n     */\r\n    get sessionId() {\r\n        // We may update sessionId in localStorage from another JitsiConference\r\n        // instance and that's why we should always re-read it.\r\n        const localStorage = getLocalStorage();\r\n\r\n        return localStorage ? localStorage.getItem('sessionId') : undefined;\r\n    },\r\n\r\n    /**\r\n     * Save current session id.\r\n     * @param {string} sessionId session id\r\n     */\r\n    set sessionId(sessionId) {\r\n        const localStorage = getLocalStorage();\r\n\r\n        if (localStorage) {\r\n            if (sessionId) {\r\n                localStorage.setItem('sessionId', sessionId);\r\n            } else {\r\n                localStorage.removeItem('sessionId');\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * Generate fake username for callstats.\r\n * @returns {string} fake random username\r\n */\r\nfunction generateCallStatsUserName() {\r\n    const username = UsernameGenerator.generateUsername();\r\n\r\n    logger.log('generated callstats uid', username);\r\n\r\n    return username;\r\n}\r\n\r\n/**\r\n * Generate unique id.\r\n * @returns {string} random unique id\r\n */\r\nfunction generateJitsiMeetId() {\r\n    const jitsiMeetId = generateUniqueId();\r\n\r\n    logger.log('generated id', jitsiMeetId);\r\n\r\n    return jitsiMeetId;\r\n}\r\n\r\n/**\r\n * Gets the localStorage of the browser. (Technically, gets the localStorage of\r\n * the global object because there may be no browser but React Native for\r\n * example).\r\n * @returns {Storage} the local Storage object (if any)\r\n */\r\nfunction getLocalStorage() {\r\n    let storage;\r\n\r\n    try {\r\n        // eslint-disable-next-line no-invalid-this\r\n        storage = (window || this).localStorage;\r\n    } catch (error) {\r\n        logger.error(error);\r\n    }\r\n\r\n    return storage;\r\n}\r\n\r\n/**\r\n *\r\n */\r\nfunction generateUniqueId() {\r\n    return _p8() + _p8() + _p8() + _p8();\r\n}\r\n\r\n/**\r\n *\r\n */\r\nfunction _p8() {\r\n    return `${Math.random().toString(16)}000000000`.substr(2, 8);\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/settings/Settings.js","/*! precalltest  version = 1.1.5 2018-01-11 */\n\n\"use strict\";function detect(){var s=Constants.browserName.chrome,e=null,o=null,n=null,i=Constants.codeBaseType.chrome;if(window&&(!window.navigator||!window.navigator.userAgent||window.csioReactNative))return window&&window.csioGetOsName&&(e=window.csioGetOsName()),window&&window.csioGetOsVer&&(o=window.csioGetOsVer()),window&&window.csioReactNative&&(n=\"react-native\"),{browserName:s,codeBase:i,os:e,osVersion:o,userAgent:n};var r=(n=navigator.userAgent).toLowerCase(),t=navigator.appVersion,a=\"\"+parseFloat(navigator.appVersion),d=void 0;-1!==(d=r.indexOf(\"opera\"))?(s=Constants.browserName.opera,a=r.substring(d+6),-1!==(d=r.indexOf(\"Version\"))&&(a=r.substring(d+8)),i=Constants.codeBaseType.chrome):-1!==(d=r.indexOf(\"opr\"))?(s=Constants.browserName.opera,a=r.substring(d+4),-1!==(d=r.indexOf(\"Version\"))&&(a=r.substring(d+8)),i=Constants.codeBaseType.chrome):-1!==(d=r.indexOf(\"msie\"))?(s=Constants.browserName.msie,a=r.substring(d+5),i=Constants.codeBaseType.chrome):-1!==(d=r.indexOf(\"edge\"))?(s=Constants.browserName.edge,a=r.substring(d+5),i=Constants.codeBaseType.edge):-1!==(d=r.indexOf(\"chrome\"))?(s=Constants.browserName.chrome,a=r.substring(d+7),i=Constants.codeBaseType.chrome):-1!==(d=r.indexOf(\"safari\"))?(s=Constants.browserName.safari,a=r.substring(d+7),-1!==(d=r.indexOf(\"Version\"))&&(a=r.substring(d+8)),i=Constants.codeBaseType.chrome):-1!==(d=r.indexOf(\"firefox\"))?(s=Constants.browserName.firefox,a=r.substring(d+8),i=Constants.codeBaseType.firefox):-1!==(d=r.indexOf(\"trident\"))&&(s=Constants.browserName.msie,d=r.indexOf(\"rv\"),a=r.substring(d+3,d+7),i=Constants.codeBaseType.chrome);var w=[{s:\"Windows 3.11\",r:/win16/},{s:\"Windows 95\",r:/(windows 95|win95|windows_95)/},{s:\"Windows ME\",r:/(win 9x 4.90|windows me)/},{s:\"Windows 98\",r:/(windows 98|win98)/},{s:\"Windows CE\",r:/windows ce/},{s:\"Windows 2000\",r:/(windows nt 5.0|windows 2000)/},{s:\"Windows XP\",r:/(windows nt 5.1|windows xp)/},{s:\"Windows Server 2003\",r:/windows nt 5.2/},{s:\"Windows Vista\",r:/windows nt 6.0/},{s:\"Windows 7\",r:/(windows 7|windows nt 6.1)/},{s:\"Windows 8.1\",r:/(windows 8.1|windows nt 6.3)/},{s:\"Windows 8\",r:/(windows 8|windows nt 6.2)/},{s:\"Windows 10\",r:/(windows 10|windows nt 10.0)/},{s:\"Windows NT 4.0\",r:/(windows nt 4.0|winnt4.0|winnt|windows nt)/},{s:\"Windows ME\",r:/windows me/},{s:\"Android\",r:/android/},{s:\"Open BSD\",r:/openbsd/},{s:\"Sun OS\",r:/sunos/},{s:\"Linux\",r:/(linux|x11)/},{s:\"iOS\",r:/(iphone|ipad|ipod)/},{s:\"Mac OS X\",r:/mac os x/},{s:\"Mac OS\",r:/(macppc|macintel|mac_powerpc|macintosh)/},{s:\"QNX\",r:/qnx/},{s:\"UNIX\",r:/unix/},{s:\"BeOS\",r:/beos/},{s:\"OS/2\",r:/os\\/2/},{s:\"Search Bot\",r:/(nuhk|googlebot|yammybot|openbot|slurp|msnbot|ask jeeves\\/teoma|ia_archiver)/}],c=void 0,m=void 0;for(c in w)if(w.hasOwnProperty(c)&&(m=w[c]).r.test(r)){e=m.s;break}switch(e&&/Windows/.test(e)&&(o=/Windows (.*)/.exec(e)[1],e=Constants.osName.windows),e){case Constants.osName.mac:o=/mac os x (10[\\.\\_\\d]+)/.exec(r)[1];break;case Constants.osName.android:o=/android ([\\.\\_\\d]+)/.exec(r)[1];break;case Constants.osName.ios:o=(o=/os (\\d+)_(\\d+)_?(\\d+)?/.exec(t))[1]+\".\"+o[2]+\".\"+(0|o[3])}return{browserName:s,browserVersion:a.toString(),os:e,osVersion:o,codeBase:i,userAgent:n}}Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.detect=detect;var Constants=exports.Constants={codeBaseType:{chrome:\"Chrome\",firefox:\"Firefox\",edge:\"Edge\",plugin:\"Plugin\"},browserName:{chrome:\"Chrome\",firefox:\"Firefox\",edge:\"Edge\",msie:\"Microsoft Internet Explorer\",safari:\"Safari\"},osName:{windows:\"Windows\",mac:\"Mac OS X\",android:\"Android\",ios:\"iOS\"}};\n\n\n// WEBPACK FOOTER //\n// ./node_modules/precalltest/dist/utility/stats/detectbrowser.js","/* @preserve\n * The MIT License (MIT)\n * \n * Copyright (c) 2013-2017 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n/**\n * bluebird build version 3.5.1\n * Features enabled: core, race, call_get, generators, map, nodeify, promisify, props, reduce, settle, some, using, timers, filter, any, each\n*/\n!function(e){if(\"object\"==typeof exports&&\"undefined\"!=typeof module)module.exports=e();else if(\"function\"==typeof define&&define.amd)define([],e);else{var f;\"undefined\"!=typeof window?f=window:\"undefined\"!=typeof global?f=global:\"undefined\"!=typeof self&&(f=self),f.Promise=e()}}(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof _dereq_==\"function\"&&_dereq_;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof _dereq_==\"function\"&&_dereq_;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise) {\nvar SomePromiseArray = Promise._SomePromiseArray;\nfunction any(promises) {\n    var ret = new SomePromiseArray(promises);\n    var promise = ret.promise();\n    ret.setHowMany(1);\n    ret.setUnwrap();\n    ret.init();\n    return promise;\n}\n\nPromise.any = function (promises) {\n    return any(promises);\n};\n\nPromise.prototype.any = function () {\n    return any(this);\n};\n\n};\n\n},{}],2:[function(_dereq_,module,exports){\n\"use strict\";\nvar firstLineError;\ntry {throw new Error(); } catch (e) {firstLineError = e;}\nvar schedule = _dereq_(\"./schedule\");\nvar Queue = _dereq_(\"./queue\");\nvar util = _dereq_(\"./util\");\n\nfunction Async() {\n    this._customScheduler = false;\n    this._isTickUsed = false;\n    this._lateQueue = new Queue(16);\n    this._normalQueue = new Queue(16);\n    this._haveDrainedQueues = false;\n    this._trampolineEnabled = true;\n    var self = this;\n    this.drainQueues = function () {\n        self._drainQueues();\n    };\n    this._schedule = schedule;\n}\n\nAsync.prototype.setScheduler = function(fn) {\n    var prev = this._schedule;\n    this._schedule = fn;\n    this._customScheduler = true;\n    return prev;\n};\n\nAsync.prototype.hasCustomScheduler = function() {\n    return this._customScheduler;\n};\n\nAsync.prototype.enableTrampoline = function() {\n    this._trampolineEnabled = true;\n};\n\nAsync.prototype.disableTrampolineIfNecessary = function() {\n    if (util.hasDevTools) {\n        this._trampolineEnabled = false;\n    }\n};\n\nAsync.prototype.haveItemsQueued = function () {\n    return this._isTickUsed || this._haveDrainedQueues;\n};\n\n\nAsync.prototype.fatalError = function(e, isNode) {\n    if (isNode) {\n        process.stderr.write(\"Fatal \" + (e instanceof Error ? e.stack : e) +\n            \"\\n\");\n        process.exit(2);\n    } else {\n        this.throwLater(e);\n    }\n};\n\nAsync.prototype.throwLater = function(fn, arg) {\n    if (arguments.length === 1) {\n        arg = fn;\n        fn = function () { throw arg; };\n    }\n    if (typeof setTimeout !== \"undefined\") {\n        setTimeout(function() {\n            fn(arg);\n        }, 0);\n    } else try {\n        this._schedule(function() {\n            fn(arg);\n        });\n    } catch (e) {\n        throw new Error(\"No async scheduler available\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n};\n\nfunction AsyncInvokeLater(fn, receiver, arg) {\n    this._lateQueue.push(fn, receiver, arg);\n    this._queueTick();\n}\n\nfunction AsyncInvoke(fn, receiver, arg) {\n    this._normalQueue.push(fn, receiver, arg);\n    this._queueTick();\n}\n\nfunction AsyncSettlePromises(promise) {\n    this._normalQueue._pushOne(promise);\n    this._queueTick();\n}\n\nif (!util.hasDevTools) {\n    Async.prototype.invokeLater = AsyncInvokeLater;\n    Async.prototype.invoke = AsyncInvoke;\n    Async.prototype.settlePromises = AsyncSettlePromises;\n} else {\n    Async.prototype.invokeLater = function (fn, receiver, arg) {\n        if (this._trampolineEnabled) {\n            AsyncInvokeLater.call(this, fn, receiver, arg);\n        } else {\n            this._schedule(function() {\n                setTimeout(function() {\n                    fn.call(receiver, arg);\n                }, 100);\n            });\n        }\n    };\n\n    Async.prototype.invoke = function (fn, receiver, arg) {\n        if (this._trampolineEnabled) {\n            AsyncInvoke.call(this, fn, receiver, arg);\n        } else {\n            this._schedule(function() {\n                fn.call(receiver, arg);\n            });\n        }\n    };\n\n    Async.prototype.settlePromises = function(promise) {\n        if (this._trampolineEnabled) {\n            AsyncSettlePromises.call(this, promise);\n        } else {\n            this._schedule(function() {\n                promise._settlePromises();\n            });\n        }\n    };\n}\n\nAsync.prototype._drainQueue = function(queue) {\n    while (queue.length() > 0) {\n        var fn = queue.shift();\n        if (typeof fn !== \"function\") {\n            fn._settlePromises();\n            continue;\n        }\n        var receiver = queue.shift();\n        var arg = queue.shift();\n        fn.call(receiver, arg);\n    }\n};\n\nAsync.prototype._drainQueues = function () {\n    this._drainQueue(this._normalQueue);\n    this._reset();\n    this._haveDrainedQueues = true;\n    this._drainQueue(this._lateQueue);\n};\n\nAsync.prototype._queueTick = function () {\n    if (!this._isTickUsed) {\n        this._isTickUsed = true;\n        this._schedule(this.drainQueues);\n    }\n};\n\nAsync.prototype._reset = function () {\n    this._isTickUsed = false;\n};\n\nmodule.exports = Async;\nmodule.exports.firstLineError = firstLineError;\n\n},{\"./queue\":26,\"./schedule\":29,\"./util\":36}],3:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise, INTERNAL, tryConvertToPromise, debug) {\nvar calledBind = false;\nvar rejectThis = function(_, e) {\n    this._reject(e);\n};\n\nvar targetRejected = function(e, context) {\n    context.promiseRejectionQueued = true;\n    context.bindingPromise._then(rejectThis, rejectThis, null, this, e);\n};\n\nvar bindingResolved = function(thisArg, context) {\n    if (((this._bitField & 50397184) === 0)) {\n        this._resolveCallback(context.target);\n    }\n};\n\nvar bindingRejected = function(e, context) {\n    if (!context.promiseRejectionQueued) this._reject(e);\n};\n\nPromise.prototype.bind = function (thisArg) {\n    if (!calledBind) {\n        calledBind = true;\n        Promise.prototype._propagateFrom = debug.propagateFromFunction();\n        Promise.prototype._boundValue = debug.boundValueFunction();\n    }\n    var maybePromise = tryConvertToPromise(thisArg);\n    var ret = new Promise(INTERNAL);\n    ret._propagateFrom(this, 1);\n    var target = this._target();\n    ret._setBoundTo(maybePromise);\n    if (maybePromise instanceof Promise) {\n        var context = {\n            promiseRejectionQueued: false,\n            promise: ret,\n            target: target,\n            bindingPromise: maybePromise\n        };\n        target._then(INTERNAL, targetRejected, undefined, ret, context);\n        maybePromise._then(\n            bindingResolved, bindingRejected, undefined, ret, context);\n        ret._setOnCancel(maybePromise);\n    } else {\n        ret._resolveCallback(target);\n    }\n    return ret;\n};\n\nPromise.prototype._setBoundTo = function (obj) {\n    if (obj !== undefined) {\n        this._bitField = this._bitField | 2097152;\n        this._boundTo = obj;\n    } else {\n        this._bitField = this._bitField & (~2097152);\n    }\n};\n\nPromise.prototype._isBound = function () {\n    return (this._bitField & 2097152) === 2097152;\n};\n\nPromise.bind = function (thisArg, value) {\n    return Promise.resolve(value).bind(thisArg);\n};\n};\n\n},{}],4:[function(_dereq_,module,exports){\n\"use strict\";\nvar old;\nif (typeof Promise !== \"undefined\") old = Promise;\nfunction noConflict() {\n    try { if (Promise === bluebird) Promise = old; }\n    catch (e) {}\n    return bluebird;\n}\nvar bluebird = _dereq_(\"./promise\")();\nbluebird.noConflict = noConflict;\nmodule.exports = bluebird;\n\n},{\"./promise\":22}],5:[function(_dereq_,module,exports){\n\"use strict\";\nvar cr = Object.create;\nif (cr) {\n    var callerCache = cr(null);\n    var getterCache = cr(null);\n    callerCache[\" size\"] = getterCache[\" size\"] = 0;\n}\n\nmodule.exports = function(Promise) {\nvar util = _dereq_(\"./util\");\nvar canEvaluate = util.canEvaluate;\nvar isIdentifier = util.isIdentifier;\n\nvar getMethodCaller;\nvar getGetter;\nif (!true) {\nvar makeMethodCaller = function (methodName) {\n    return new Function(\"ensureMethod\", \"                                    \\n\\\n        return function(obj) {                                               \\n\\\n            'use strict'                                                     \\n\\\n            var len = this.length;                                           \\n\\\n            ensureMethod(obj, 'methodName');                                 \\n\\\n            switch(len) {                                                    \\n\\\n                case 1: return obj.methodName(this[0]);                      \\n\\\n                case 2: return obj.methodName(this[0], this[1]);             \\n\\\n                case 3: return obj.methodName(this[0], this[1], this[2]);    \\n\\\n                case 0: return obj.methodName();                             \\n\\\n                default:                                                     \\n\\\n                    return obj.methodName.apply(obj, this);                  \\n\\\n            }                                                                \\n\\\n        };                                                                   \\n\\\n        \".replace(/methodName/g, methodName))(ensureMethod);\n};\n\nvar makeGetter = function (propertyName) {\n    return new Function(\"obj\", \"                                             \\n\\\n        'use strict';                                                        \\n\\\n        return obj.propertyName;                                             \\n\\\n        \".replace(\"propertyName\", propertyName));\n};\n\nvar getCompiled = function(name, compiler, cache) {\n    var ret = cache[name];\n    if (typeof ret !== \"function\") {\n        if (!isIdentifier(name)) {\n            return null;\n        }\n        ret = compiler(name);\n        cache[name] = ret;\n        cache[\" size\"]++;\n        if (cache[\" size\"] > 512) {\n            var keys = Object.keys(cache);\n            for (var i = 0; i < 256; ++i) delete cache[keys[i]];\n            cache[\" size\"] = keys.length - 256;\n        }\n    }\n    return ret;\n};\n\ngetMethodCaller = function(name) {\n    return getCompiled(name, makeMethodCaller, callerCache);\n};\n\ngetGetter = function(name) {\n    return getCompiled(name, makeGetter, getterCache);\n};\n}\n\nfunction ensureMethod(obj, methodName) {\n    var fn;\n    if (obj != null) fn = obj[methodName];\n    if (typeof fn !== \"function\") {\n        var message = \"Object \" + util.classString(obj) + \" has no method '\" +\n            util.toString(methodName) + \"'\";\n        throw new Promise.TypeError(message);\n    }\n    return fn;\n}\n\nfunction caller(obj) {\n    var methodName = this.pop();\n    var fn = ensureMethod(obj, methodName);\n    return fn.apply(obj, this);\n}\nPromise.prototype.call = function (methodName) {\n    var args = [].slice.call(arguments, 1);;\n    if (!true) {\n        if (canEvaluate) {\n            var maybeCaller = getMethodCaller(methodName);\n            if (maybeCaller !== null) {\n                return this._then(\n                    maybeCaller, undefined, undefined, args, undefined);\n            }\n        }\n    }\n    args.push(methodName);\n    return this._then(caller, undefined, undefined, args, undefined);\n};\n\nfunction namedGetter(obj) {\n    return obj[this];\n}\nfunction indexedGetter(obj) {\n    var index = +this;\n    if (index < 0) index = Math.max(0, index + obj.length);\n    return obj[index];\n}\nPromise.prototype.get = function (propertyName) {\n    var isIndex = (typeof propertyName === \"number\");\n    var getter;\n    if (!isIndex) {\n        if (canEvaluate) {\n            var maybeGetter = getGetter(propertyName);\n            getter = maybeGetter !== null ? maybeGetter : namedGetter;\n        } else {\n            getter = namedGetter;\n        }\n    } else {\n        getter = indexedGetter;\n    }\n    return this._then(getter, undefined, undefined, propertyName, undefined);\n};\n};\n\n},{\"./util\":36}],6:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise, PromiseArray, apiRejection, debug) {\nvar util = _dereq_(\"./util\");\nvar tryCatch = util.tryCatch;\nvar errorObj = util.errorObj;\nvar async = Promise._async;\n\nPromise.prototype[\"break\"] = Promise.prototype.cancel = function() {\n    if (!debug.cancellation()) return this._warn(\"cancellation is disabled\");\n\n    var promise = this;\n    var child = promise;\n    while (promise._isCancellable()) {\n        if (!promise._cancelBy(child)) {\n            if (child._isFollowing()) {\n                child._followee().cancel();\n            } else {\n                child._cancelBranched();\n            }\n            break;\n        }\n\n        var parent = promise._cancellationParent;\n        if (parent == null || !parent._isCancellable()) {\n            if (promise._isFollowing()) {\n                promise._followee().cancel();\n            } else {\n                promise._cancelBranched();\n            }\n            break;\n        } else {\n            if (promise._isFollowing()) promise._followee().cancel();\n            promise._setWillBeCancelled();\n            child = promise;\n            promise = parent;\n        }\n    }\n};\n\nPromise.prototype._branchHasCancelled = function() {\n    this._branchesRemainingToCancel--;\n};\n\nPromise.prototype._enoughBranchesHaveCancelled = function() {\n    return this._branchesRemainingToCancel === undefined ||\n           this._branchesRemainingToCancel <= 0;\n};\n\nPromise.prototype._cancelBy = function(canceller) {\n    if (canceller === this) {\n        this._branchesRemainingToCancel = 0;\n        this._invokeOnCancel();\n        return true;\n    } else {\n        this._branchHasCancelled();\n        if (this._enoughBranchesHaveCancelled()) {\n            this._invokeOnCancel();\n            return true;\n        }\n    }\n    return false;\n};\n\nPromise.prototype._cancelBranched = function() {\n    if (this._enoughBranchesHaveCancelled()) {\n        this._cancel();\n    }\n};\n\nPromise.prototype._cancel = function() {\n    if (!this._isCancellable()) return;\n    this._setCancelled();\n    async.invoke(this._cancelPromises, this, undefined);\n};\n\nPromise.prototype._cancelPromises = function() {\n    if (this._length() > 0) this._settlePromises();\n};\n\nPromise.prototype._unsetOnCancel = function() {\n    this._onCancelField = undefined;\n};\n\nPromise.prototype._isCancellable = function() {\n    return this.isPending() && !this._isCancelled();\n};\n\nPromise.prototype.isCancellable = function() {\n    return this.isPending() && !this.isCancelled();\n};\n\nPromise.prototype._doInvokeOnCancel = function(onCancelCallback, internalOnly) {\n    if (util.isArray(onCancelCallback)) {\n        for (var i = 0; i < onCancelCallback.length; ++i) {\n            this._doInvokeOnCancel(onCancelCallback[i], internalOnly);\n        }\n    } else if (onCancelCallback !== undefined) {\n        if (typeof onCancelCallback === \"function\") {\n            if (!internalOnly) {\n                var e = tryCatch(onCancelCallback).call(this._boundValue());\n                if (e === errorObj) {\n                    this._attachExtraTrace(e.e);\n                    async.throwLater(e.e);\n                }\n            }\n        } else {\n            onCancelCallback._resultCancelled(this);\n        }\n    }\n};\n\nPromise.prototype._invokeOnCancel = function() {\n    var onCancelCallback = this._onCancel();\n    this._unsetOnCancel();\n    async.invoke(this._doInvokeOnCancel, this, onCancelCallback);\n};\n\nPromise.prototype._invokeInternalOnCancel = function() {\n    if (this._isCancellable()) {\n        this._doInvokeOnCancel(this._onCancel(), true);\n        this._unsetOnCancel();\n    }\n};\n\nPromise.prototype._resultCancelled = function() {\n    this.cancel();\n};\n\n};\n\n},{\"./util\":36}],7:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(NEXT_FILTER) {\nvar util = _dereq_(\"./util\");\nvar getKeys = _dereq_(\"./es5\").keys;\nvar tryCatch = util.tryCatch;\nvar errorObj = util.errorObj;\n\nfunction catchFilter(instances, cb, promise) {\n    return function(e) {\n        var boundTo = promise._boundValue();\n        predicateLoop: for (var i = 0; i < instances.length; ++i) {\n            var item = instances[i];\n\n            if (item === Error ||\n                (item != null && item.prototype instanceof Error)) {\n                if (e instanceof item) {\n                    return tryCatch(cb).call(boundTo, e);\n                }\n            } else if (typeof item === \"function\") {\n                var matchesPredicate = tryCatch(item).call(boundTo, e);\n                if (matchesPredicate === errorObj) {\n                    return matchesPredicate;\n                } else if (matchesPredicate) {\n                    return tryCatch(cb).call(boundTo, e);\n                }\n            } else if (util.isObject(e)) {\n                var keys = getKeys(item);\n                for (var j = 0; j < keys.length; ++j) {\n                    var key = keys[j];\n                    if (item[key] != e[key]) {\n                        continue predicateLoop;\n                    }\n                }\n                return tryCatch(cb).call(boundTo, e);\n            }\n        }\n        return NEXT_FILTER;\n    };\n}\n\nreturn catchFilter;\n};\n\n},{\"./es5\":13,\"./util\":36}],8:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise) {\nvar longStackTraces = false;\nvar contextStack = [];\n\nPromise.prototype._promiseCreated = function() {};\nPromise.prototype._pushContext = function() {};\nPromise.prototype._popContext = function() {return null;};\nPromise._peekContext = Promise.prototype._peekContext = function() {};\n\nfunction Context() {\n    this._trace = new Context.CapturedTrace(peekContext());\n}\nContext.prototype._pushContext = function () {\n    if (this._trace !== undefined) {\n        this._trace._promiseCreated = null;\n        contextStack.push(this._trace);\n    }\n};\n\nContext.prototype._popContext = function () {\n    if (this._trace !== undefined) {\n        var trace = contextStack.pop();\n        var ret = trace._promiseCreated;\n        trace._promiseCreated = null;\n        return ret;\n    }\n    return null;\n};\n\nfunction createContext() {\n    if (longStackTraces) return new Context();\n}\n\nfunction peekContext() {\n    var lastIndex = contextStack.length - 1;\n    if (lastIndex >= 0) {\n        return contextStack[lastIndex];\n    }\n    return undefined;\n}\nContext.CapturedTrace = null;\nContext.create = createContext;\nContext.deactivateLongStackTraces = function() {};\nContext.activateLongStackTraces = function() {\n    var Promise_pushContext = Promise.prototype._pushContext;\n    var Promise_popContext = Promise.prototype._popContext;\n    var Promise_PeekContext = Promise._peekContext;\n    var Promise_peekContext = Promise.prototype._peekContext;\n    var Promise_promiseCreated = Promise.prototype._promiseCreated;\n    Context.deactivateLongStackTraces = function() {\n        Promise.prototype._pushContext = Promise_pushContext;\n        Promise.prototype._popContext = Promise_popContext;\n        Promise._peekContext = Promise_PeekContext;\n        Promise.prototype._peekContext = Promise_peekContext;\n        Promise.prototype._promiseCreated = Promise_promiseCreated;\n        longStackTraces = false;\n    };\n    longStackTraces = true;\n    Promise.prototype._pushContext = Context.prototype._pushContext;\n    Promise.prototype._popContext = Context.prototype._popContext;\n    Promise._peekContext = Promise.prototype._peekContext = peekContext;\n    Promise.prototype._promiseCreated = function() {\n        var ctx = this._peekContext();\n        if (ctx && ctx._promiseCreated == null) ctx._promiseCreated = this;\n    };\n};\nreturn Context;\n};\n\n},{}],9:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise, Context) {\nvar getDomain = Promise._getDomain;\nvar async = Promise._async;\nvar Warning = _dereq_(\"./errors\").Warning;\nvar util = _dereq_(\"./util\");\nvar canAttachTrace = util.canAttachTrace;\nvar unhandledRejectionHandled;\nvar possiblyUnhandledRejection;\nvar bluebirdFramePattern =\n    /[\\\\\\/]bluebird[\\\\\\/]js[\\\\\\/](release|debug|instrumented)/;\nvar nodeFramePattern = /\\((?:timers\\.js):\\d+:\\d+\\)/;\nvar parseLinePattern = /[\\/<\\(](.+?):(\\d+):(\\d+)\\)?\\s*$/;\nvar stackFramePattern = null;\nvar formatStack = null;\nvar indentStackFrames = false;\nvar printWarning;\nvar debugging = !!(util.env(\"BLUEBIRD_DEBUG\") != 0 &&\n                        (true ||\n                         util.env(\"BLUEBIRD_DEBUG\") ||\n                         util.env(\"NODE_ENV\") === \"development\"));\n\nvar warnings = !!(util.env(\"BLUEBIRD_WARNINGS\") != 0 &&\n    (debugging || util.env(\"BLUEBIRD_WARNINGS\")));\n\nvar longStackTraces = !!(util.env(\"BLUEBIRD_LONG_STACK_TRACES\") != 0 &&\n    (debugging || util.env(\"BLUEBIRD_LONG_STACK_TRACES\")));\n\nvar wForgottenReturn = util.env(\"BLUEBIRD_W_FORGOTTEN_RETURN\") != 0 &&\n    (warnings || !!util.env(\"BLUEBIRD_W_FORGOTTEN_RETURN\"));\n\nPromise.prototype.suppressUnhandledRejections = function() {\n    var target = this._target();\n    target._bitField = ((target._bitField & (~1048576)) |\n                      524288);\n};\n\nPromise.prototype._ensurePossibleRejectionHandled = function () {\n    if ((this._bitField & 524288) !== 0) return;\n    this._setRejectionIsUnhandled();\n    var self = this;\n    setTimeout(function() {\n        self._notifyUnhandledRejection();\n    }, 1);\n};\n\nPromise.prototype._notifyUnhandledRejectionIsHandled = function () {\n    fireRejectionEvent(\"rejectionHandled\",\n                                  unhandledRejectionHandled, undefined, this);\n};\n\nPromise.prototype._setReturnedNonUndefined = function() {\n    this._bitField = this._bitField | 268435456;\n};\n\nPromise.prototype._returnedNonUndefined = function() {\n    return (this._bitField & 268435456) !== 0;\n};\n\nPromise.prototype._notifyUnhandledRejection = function () {\n    if (this._isRejectionUnhandled()) {\n        var reason = this._settledValue();\n        this._setUnhandledRejectionIsNotified();\n        fireRejectionEvent(\"unhandledRejection\",\n                                      possiblyUnhandledRejection, reason, this);\n    }\n};\n\nPromise.prototype._setUnhandledRejectionIsNotified = function () {\n    this._bitField = this._bitField | 262144;\n};\n\nPromise.prototype._unsetUnhandledRejectionIsNotified = function () {\n    this._bitField = this._bitField & (~262144);\n};\n\nPromise.prototype._isUnhandledRejectionNotified = function () {\n    return (this._bitField & 262144) > 0;\n};\n\nPromise.prototype._setRejectionIsUnhandled = function () {\n    this._bitField = this._bitField | 1048576;\n};\n\nPromise.prototype._unsetRejectionIsUnhandled = function () {\n    this._bitField = this._bitField & (~1048576);\n    if (this._isUnhandledRejectionNotified()) {\n        this._unsetUnhandledRejectionIsNotified();\n        this._notifyUnhandledRejectionIsHandled();\n    }\n};\n\nPromise.prototype._isRejectionUnhandled = function () {\n    return (this._bitField & 1048576) > 0;\n};\n\nPromise.prototype._warn = function(message, shouldUseOwnTrace, promise) {\n    return warn(message, shouldUseOwnTrace, promise || this);\n};\n\nPromise.onPossiblyUnhandledRejection = function (fn) {\n    var domain = getDomain();\n    possiblyUnhandledRejection =\n        typeof fn === \"function\" ? (domain === null ?\n                                            fn : util.domainBind(domain, fn))\n                                 : undefined;\n};\n\nPromise.onUnhandledRejectionHandled = function (fn) {\n    var domain = getDomain();\n    unhandledRejectionHandled =\n        typeof fn === \"function\" ? (domain === null ?\n                                            fn : util.domainBind(domain, fn))\n                                 : undefined;\n};\n\nvar disableLongStackTraces = function() {};\nPromise.longStackTraces = function () {\n    if (async.haveItemsQueued() && !config.longStackTraces) {\n        throw new Error(\"cannot enable long stack traces after promises have been created\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n    if (!config.longStackTraces && longStackTracesIsSupported()) {\n        var Promise_captureStackTrace = Promise.prototype._captureStackTrace;\n        var Promise_attachExtraTrace = Promise.prototype._attachExtraTrace;\n        config.longStackTraces = true;\n        disableLongStackTraces = function() {\n            if (async.haveItemsQueued() && !config.longStackTraces) {\n                throw new Error(\"cannot enable long stack traces after promises have been created\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n            }\n            Promise.prototype._captureStackTrace = Promise_captureStackTrace;\n            Promise.prototype._attachExtraTrace = Promise_attachExtraTrace;\n            Context.deactivateLongStackTraces();\n            async.enableTrampoline();\n            config.longStackTraces = false;\n        };\n        Promise.prototype._captureStackTrace = longStackTracesCaptureStackTrace;\n        Promise.prototype._attachExtraTrace = longStackTracesAttachExtraTrace;\n        Context.activateLongStackTraces();\n        async.disableTrampolineIfNecessary();\n    }\n};\n\nPromise.hasLongStackTraces = function () {\n    return config.longStackTraces && longStackTracesIsSupported();\n};\n\nvar fireDomEvent = (function() {\n    try {\n        if (typeof CustomEvent === \"function\") {\n            var event = new CustomEvent(\"CustomEvent\");\n            util.global.dispatchEvent(event);\n            return function(name, event) {\n                var domEvent = new CustomEvent(name.toLowerCase(), {\n                    detail: event,\n                    cancelable: true\n                });\n                return !util.global.dispatchEvent(domEvent);\n            };\n        } else if (typeof Event === \"function\") {\n            var event = new Event(\"CustomEvent\");\n            util.global.dispatchEvent(event);\n            return function(name, event) {\n                var domEvent = new Event(name.toLowerCase(), {\n                    cancelable: true\n                });\n                domEvent.detail = event;\n                return !util.global.dispatchEvent(domEvent);\n            };\n        } else {\n            var event = document.createEvent(\"CustomEvent\");\n            event.initCustomEvent(\"testingtheevent\", false, true, {});\n            util.global.dispatchEvent(event);\n            return function(name, event) {\n                var domEvent = document.createEvent(\"CustomEvent\");\n                domEvent.initCustomEvent(name.toLowerCase(), false, true,\n                    event);\n                return !util.global.dispatchEvent(domEvent);\n            };\n        }\n    } catch (e) {}\n    return function() {\n        return false;\n    };\n})();\n\nvar fireGlobalEvent = (function() {\n    if (util.isNode) {\n        return function() {\n            return process.emit.apply(process, arguments);\n        };\n    } else {\n        if (!util.global) {\n            return function() {\n                return false;\n            };\n        }\n        return function(name) {\n            var methodName = \"on\" + name.toLowerCase();\n            var method = util.global[methodName];\n            if (!method) return false;\n            method.apply(util.global, [].slice.call(arguments, 1));\n            return true;\n        };\n    }\n})();\n\nfunction generatePromiseLifecycleEventObject(name, promise) {\n    return {promise: promise};\n}\n\nvar eventToObjectGenerator = {\n    promiseCreated: generatePromiseLifecycleEventObject,\n    promiseFulfilled: generatePromiseLifecycleEventObject,\n    promiseRejected: generatePromiseLifecycleEventObject,\n    promiseResolved: generatePromiseLifecycleEventObject,\n    promiseCancelled: generatePromiseLifecycleEventObject,\n    promiseChained: function(name, promise, child) {\n        return {promise: promise, child: child};\n    },\n    warning: function(name, warning) {\n        return {warning: warning};\n    },\n    unhandledRejection: function (name, reason, promise) {\n        return {reason: reason, promise: promise};\n    },\n    rejectionHandled: generatePromiseLifecycleEventObject\n};\n\nvar activeFireEvent = function (name) {\n    var globalEventFired = false;\n    try {\n        globalEventFired = fireGlobalEvent.apply(null, arguments);\n    } catch (e) {\n        async.throwLater(e);\n        globalEventFired = true;\n    }\n\n    var domEventFired = false;\n    try {\n        domEventFired = fireDomEvent(name,\n                    eventToObjectGenerator[name].apply(null, arguments));\n    } catch (e) {\n        async.throwLater(e);\n        domEventFired = true;\n    }\n\n    return domEventFired || globalEventFired;\n};\n\nPromise.config = function(opts) {\n    opts = Object(opts);\n    if (\"longStackTraces\" in opts) {\n        if (opts.longStackTraces) {\n            Promise.longStackTraces();\n        } else if (!opts.longStackTraces && Promise.hasLongStackTraces()) {\n            disableLongStackTraces();\n        }\n    }\n    if (\"warnings\" in opts) {\n        var warningsOption = opts.warnings;\n        config.warnings = !!warningsOption;\n        wForgottenReturn = config.warnings;\n\n        if (util.isObject(warningsOption)) {\n            if (\"wForgottenReturn\" in warningsOption) {\n                wForgottenReturn = !!warningsOption.wForgottenReturn;\n            }\n        }\n    }\n    if (\"cancellation\" in opts && opts.cancellation && !config.cancellation) {\n        if (async.haveItemsQueued()) {\n            throw new Error(\n                \"cannot enable cancellation after promises are in use\");\n        }\n        Promise.prototype._clearCancellationData =\n            cancellationClearCancellationData;\n        Promise.prototype._propagateFrom = cancellationPropagateFrom;\n        Promise.prototype._onCancel = cancellationOnCancel;\n        Promise.prototype._setOnCancel = cancellationSetOnCancel;\n        Promise.prototype._attachCancellationCallback =\n            cancellationAttachCancellationCallback;\n        Promise.prototype._execute = cancellationExecute;\n        propagateFromFunction = cancellationPropagateFrom;\n        config.cancellation = true;\n    }\n    if (\"monitoring\" in opts) {\n        if (opts.monitoring && !config.monitoring) {\n            config.monitoring = true;\n            Promise.prototype._fireEvent = activeFireEvent;\n        } else if (!opts.monitoring && config.monitoring) {\n            config.monitoring = false;\n            Promise.prototype._fireEvent = defaultFireEvent;\n        }\n    }\n    return Promise;\n};\n\nfunction defaultFireEvent() { return false; }\n\nPromise.prototype._fireEvent = defaultFireEvent;\nPromise.prototype._execute = function(executor, resolve, reject) {\n    try {\n        executor(resolve, reject);\n    } catch (e) {\n        return e;\n    }\n};\nPromise.prototype._onCancel = function () {};\nPromise.prototype._setOnCancel = function (handler) { ; };\nPromise.prototype._attachCancellationCallback = function(onCancel) {\n    ;\n};\nPromise.prototype._captureStackTrace = function () {};\nPromise.prototype._attachExtraTrace = function () {};\nPromise.prototype._clearCancellationData = function() {};\nPromise.prototype._propagateFrom = function (parent, flags) {\n    ;\n    ;\n};\n\nfunction cancellationExecute(executor, resolve, reject) {\n    var promise = this;\n    try {\n        executor(resolve, reject, function(onCancel) {\n            if (typeof onCancel !== \"function\") {\n                throw new TypeError(\"onCancel must be a function, got: \" +\n                                    util.toString(onCancel));\n            }\n            promise._attachCancellationCallback(onCancel);\n        });\n    } catch (e) {\n        return e;\n    }\n}\n\nfunction cancellationAttachCancellationCallback(onCancel) {\n    if (!this._isCancellable()) return this;\n\n    var previousOnCancel = this._onCancel();\n    if (previousOnCancel !== undefined) {\n        if (util.isArray(previousOnCancel)) {\n            previousOnCancel.push(onCancel);\n        } else {\n            this._setOnCancel([previousOnCancel, onCancel]);\n        }\n    } else {\n        this._setOnCancel(onCancel);\n    }\n}\n\nfunction cancellationOnCancel() {\n    return this._onCancelField;\n}\n\nfunction cancellationSetOnCancel(onCancel) {\n    this._onCancelField = onCancel;\n}\n\nfunction cancellationClearCancellationData() {\n    this._cancellationParent = undefined;\n    this._onCancelField = undefined;\n}\n\nfunction cancellationPropagateFrom(parent, flags) {\n    if ((flags & 1) !== 0) {\n        this._cancellationParent = parent;\n        var branchesRemainingToCancel = parent._branchesRemainingToCancel;\n        if (branchesRemainingToCancel === undefined) {\n            branchesRemainingToCancel = 0;\n        }\n        parent._branchesRemainingToCancel = branchesRemainingToCancel + 1;\n    }\n    if ((flags & 2) !== 0 && parent._isBound()) {\n        this._setBoundTo(parent._boundTo);\n    }\n}\n\nfunction bindingPropagateFrom(parent, flags) {\n    if ((flags & 2) !== 0 && parent._isBound()) {\n        this._setBoundTo(parent._boundTo);\n    }\n}\nvar propagateFromFunction = bindingPropagateFrom;\n\nfunction boundValueFunction() {\n    var ret = this._boundTo;\n    if (ret !== undefined) {\n        if (ret instanceof Promise) {\n            if (ret.isFulfilled()) {\n                return ret.value();\n            } else {\n                return undefined;\n            }\n        }\n    }\n    return ret;\n}\n\nfunction longStackTracesCaptureStackTrace() {\n    this._trace = new CapturedTrace(this._peekContext());\n}\n\nfunction longStackTracesAttachExtraTrace(error, ignoreSelf) {\n    if (canAttachTrace(error)) {\n        var trace = this._trace;\n        if (trace !== undefined) {\n            if (ignoreSelf) trace = trace._parent;\n        }\n        if (trace !== undefined) {\n            trace.attachExtraTrace(error);\n        } else if (!error.__stackCleaned__) {\n            var parsed = parseStackAndMessage(error);\n            util.notEnumerableProp(error, \"stack\",\n                parsed.message + \"\\n\" + parsed.stack.join(\"\\n\"));\n            util.notEnumerableProp(error, \"__stackCleaned__\", true);\n        }\n    }\n}\n\nfunction checkForgottenReturns(returnValue, promiseCreated, name, promise,\n                               parent) {\n    if (returnValue === undefined && promiseCreated !== null &&\n        wForgottenReturn) {\n        if (parent !== undefined && parent._returnedNonUndefined()) return;\n        if ((promise._bitField & 65535) === 0) return;\n\n        if (name) name = name + \" \";\n        var handlerLine = \"\";\n        var creatorLine = \"\";\n        if (promiseCreated._trace) {\n            var traceLines = promiseCreated._trace.stack.split(\"\\n\");\n            var stack = cleanStack(traceLines);\n            for (var i = stack.length - 1; i >= 0; --i) {\n                var line = stack[i];\n                if (!nodeFramePattern.test(line)) {\n                    var lineMatches = line.match(parseLinePattern);\n                    if (lineMatches) {\n                        handlerLine  = \"at \" + lineMatches[1] +\n                            \":\" + lineMatches[2] + \":\" + lineMatches[3] + \" \";\n                    }\n                    break;\n                }\n            }\n\n            if (stack.length > 0) {\n                var firstUserLine = stack[0];\n                for (var i = 0; i < traceLines.length; ++i) {\n\n                    if (traceLines[i] === firstUserLine) {\n                        if (i > 0) {\n                            creatorLine = \"\\n\" + traceLines[i - 1];\n                        }\n                        break;\n                    }\n                }\n\n            }\n        }\n        var msg = \"a promise was created in a \" + name +\n            \"handler \" + handlerLine + \"but was not returned from it, \" +\n            \"see http://goo.gl/rRqMUw\" +\n            creatorLine;\n        promise._warn(msg, true, promiseCreated);\n    }\n}\n\nfunction deprecated(name, replacement) {\n    var message = name +\n        \" is deprecated and will be removed in a future version.\";\n    if (replacement) message += \" Use \" + replacement + \" instead.\";\n    return warn(message);\n}\n\nfunction warn(message, shouldUseOwnTrace, promise) {\n    if (!config.warnings) return;\n    var warning = new Warning(message);\n    var ctx;\n    if (shouldUseOwnTrace) {\n        promise._attachExtraTrace(warning);\n    } else if (config.longStackTraces && (ctx = Promise._peekContext())) {\n        ctx.attachExtraTrace(warning);\n    } else {\n        var parsed = parseStackAndMessage(warning);\n        warning.stack = parsed.message + \"\\n\" + parsed.stack.join(\"\\n\");\n    }\n\n    if (!activeFireEvent(\"warning\", warning)) {\n        formatAndLogError(warning, \"\", true);\n    }\n}\n\nfunction reconstructStack(message, stacks) {\n    for (var i = 0; i < stacks.length - 1; ++i) {\n        stacks[i].push(\"From previous event:\");\n        stacks[i] = stacks[i].join(\"\\n\");\n    }\n    if (i < stacks.length) {\n        stacks[i] = stacks[i].join(\"\\n\");\n    }\n    return message + \"\\n\" + stacks.join(\"\\n\");\n}\n\nfunction removeDuplicateOrEmptyJumps(stacks) {\n    for (var i = 0; i < stacks.length; ++i) {\n        if (stacks[i].length === 0 ||\n            ((i + 1 < stacks.length) && stacks[i][0] === stacks[i+1][0])) {\n            stacks.splice(i, 1);\n            i--;\n        }\n    }\n}\n\nfunction removeCommonRoots(stacks) {\n    var current = stacks[0];\n    for (var i = 1; i < stacks.length; ++i) {\n        var prev = stacks[i];\n        var currentLastIndex = current.length - 1;\n        var currentLastLine = current[currentLastIndex];\n        var commonRootMeetPoint = -1;\n\n        for (var j = prev.length - 1; j >= 0; --j) {\n            if (prev[j] === currentLastLine) {\n                commonRootMeetPoint = j;\n                break;\n            }\n        }\n\n        for (var j = commonRootMeetPoint; j >= 0; --j) {\n            var line = prev[j];\n            if (current[currentLastIndex] === line) {\n                current.pop();\n                currentLastIndex--;\n            } else {\n                break;\n            }\n        }\n        current = prev;\n    }\n}\n\nfunction cleanStack(stack) {\n    var ret = [];\n    for (var i = 0; i < stack.length; ++i) {\n        var line = stack[i];\n        var isTraceLine = \"    (No stack trace)\" === line ||\n            stackFramePattern.test(line);\n        var isInternalFrame = isTraceLine && shouldIgnore(line);\n        if (isTraceLine && !isInternalFrame) {\n            if (indentStackFrames && line.charAt(0) !== \" \") {\n                line = \"    \" + line;\n            }\n            ret.push(line);\n        }\n    }\n    return ret;\n}\n\nfunction stackFramesAsArray(error) {\n    var stack = error.stack.replace(/\\s+$/g, \"\").split(\"\\n\");\n    for (var i = 0; i < stack.length; ++i) {\n        var line = stack[i];\n        if (\"    (No stack trace)\" === line || stackFramePattern.test(line)) {\n            break;\n        }\n    }\n    if (i > 0 && error.name != \"SyntaxError\") {\n        stack = stack.slice(i);\n    }\n    return stack;\n}\n\nfunction parseStackAndMessage(error) {\n    var stack = error.stack;\n    var message = error.toString();\n    stack = typeof stack === \"string\" && stack.length > 0\n                ? stackFramesAsArray(error) : [\"    (No stack trace)\"];\n    return {\n        message: message,\n        stack: error.name == \"SyntaxError\" ? stack : cleanStack(stack)\n    };\n}\n\nfunction formatAndLogError(error, title, isSoft) {\n    if (typeof console !== \"undefined\") {\n        var message;\n        if (util.isObject(error)) {\n            var stack = error.stack;\n            message = title + formatStack(stack, error);\n        } else {\n            message = title + String(error);\n        }\n        if (typeof printWarning === \"function\") {\n            printWarning(message, isSoft);\n        } else if (typeof console.log === \"function\" ||\n            typeof console.log === \"object\") {\n            console.log(message);\n        }\n    }\n}\n\nfunction fireRejectionEvent(name, localHandler, reason, promise) {\n    var localEventFired = false;\n    try {\n        if (typeof localHandler === \"function\") {\n            localEventFired = true;\n            if (name === \"rejectionHandled\") {\n                localHandler(promise);\n            } else {\n                localHandler(reason, promise);\n            }\n        }\n    } catch (e) {\n        async.throwLater(e);\n    }\n\n    if (name === \"unhandledRejection\") {\n        if (!activeFireEvent(name, reason, promise) && !localEventFired) {\n            formatAndLogError(reason, \"Unhandled rejection \");\n        }\n    } else {\n        activeFireEvent(name, promise);\n    }\n}\n\nfunction formatNonError(obj) {\n    var str;\n    if (typeof obj === \"function\") {\n        str = \"[function \" +\n            (obj.name || \"anonymous\") +\n            \"]\";\n    } else {\n        str = obj && typeof obj.toString === \"function\"\n            ? obj.toString() : util.toString(obj);\n        var ruselessToString = /\\[object [a-zA-Z0-9$_]+\\]/;\n        if (ruselessToString.test(str)) {\n            try {\n                var newStr = JSON.stringify(obj);\n                str = newStr;\n            }\n            catch(e) {\n\n            }\n        }\n        if (str.length === 0) {\n            str = \"(empty array)\";\n        }\n    }\n    return (\"(<\" + snip(str) + \">, no stack trace)\");\n}\n\nfunction snip(str) {\n    var maxChars = 41;\n    if (str.length < maxChars) {\n        return str;\n    }\n    return str.substr(0, maxChars - 3) + \"...\";\n}\n\nfunction longStackTracesIsSupported() {\n    return typeof captureStackTrace === \"function\";\n}\n\nvar shouldIgnore = function() { return false; };\nvar parseLineInfoRegex = /[\\/<\\(]([^:\\/]+):(\\d+):(?:\\d+)\\)?\\s*$/;\nfunction parseLineInfo(line) {\n    var matches = line.match(parseLineInfoRegex);\n    if (matches) {\n        return {\n            fileName: matches[1],\n            line: parseInt(matches[2], 10)\n        };\n    }\n}\n\nfunction setBounds(firstLineError, lastLineError) {\n    if (!longStackTracesIsSupported()) return;\n    var firstStackLines = firstLineError.stack.split(\"\\n\");\n    var lastStackLines = lastLineError.stack.split(\"\\n\");\n    var firstIndex = -1;\n    var lastIndex = -1;\n    var firstFileName;\n    var lastFileName;\n    for (var i = 0; i < firstStackLines.length; ++i) {\n        var result = parseLineInfo(firstStackLines[i]);\n        if (result) {\n            firstFileName = result.fileName;\n            firstIndex = result.line;\n            break;\n        }\n    }\n    for (var i = 0; i < lastStackLines.length; ++i) {\n        var result = parseLineInfo(lastStackLines[i]);\n        if (result) {\n            lastFileName = result.fileName;\n            lastIndex = result.line;\n            break;\n        }\n    }\n    if (firstIndex < 0 || lastIndex < 0 || !firstFileName || !lastFileName ||\n        firstFileName !== lastFileName || firstIndex >= lastIndex) {\n        return;\n    }\n\n    shouldIgnore = function(line) {\n        if (bluebirdFramePattern.test(line)) return true;\n        var info = parseLineInfo(line);\n        if (info) {\n            if (info.fileName === firstFileName &&\n                (firstIndex <= info.line && info.line <= lastIndex)) {\n                return true;\n            }\n        }\n        return false;\n    };\n}\n\nfunction CapturedTrace(parent) {\n    this._parent = parent;\n    this._promisesCreated = 0;\n    var length = this._length = 1 + (parent === undefined ? 0 : parent._length);\n    captureStackTrace(this, CapturedTrace);\n    if (length > 32) this.uncycle();\n}\nutil.inherits(CapturedTrace, Error);\nContext.CapturedTrace = CapturedTrace;\n\nCapturedTrace.prototype.uncycle = function() {\n    var length = this._length;\n    if (length < 2) return;\n    var nodes = [];\n    var stackToIndex = {};\n\n    for (var i = 0, node = this; node !== undefined; ++i) {\n        nodes.push(node);\n        node = node._parent;\n    }\n    length = this._length = i;\n    for (var i = length - 1; i >= 0; --i) {\n        var stack = nodes[i].stack;\n        if (stackToIndex[stack] === undefined) {\n            stackToIndex[stack] = i;\n        }\n    }\n    for (var i = 0; i < length; ++i) {\n        var currentStack = nodes[i].stack;\n        var index = stackToIndex[currentStack];\n        if (index !== undefined && index !== i) {\n            if (index > 0) {\n                nodes[index - 1]._parent = undefined;\n                nodes[index - 1]._length = 1;\n            }\n            nodes[i]._parent = undefined;\n            nodes[i]._length = 1;\n            var cycleEdgeNode = i > 0 ? nodes[i - 1] : this;\n\n            if (index < length - 1) {\n                cycleEdgeNode._parent = nodes[index + 1];\n                cycleEdgeNode._parent.uncycle();\n                cycleEdgeNode._length =\n                    cycleEdgeNode._parent._length + 1;\n            } else {\n                cycleEdgeNode._parent = undefined;\n                cycleEdgeNode._length = 1;\n            }\n            var currentChildLength = cycleEdgeNode._length + 1;\n            for (var j = i - 2; j >= 0; --j) {\n                nodes[j]._length = currentChildLength;\n                currentChildLength++;\n            }\n            return;\n        }\n    }\n};\n\nCapturedTrace.prototype.attachExtraTrace = function(error) {\n    if (error.__stackCleaned__) return;\n    this.uncycle();\n    var parsed = parseStackAndMessage(error);\n    var message = parsed.message;\n    var stacks = [parsed.stack];\n\n    var trace = this;\n    while (trace !== undefined) {\n        stacks.push(cleanStack(trace.stack.split(\"\\n\")));\n        trace = trace._parent;\n    }\n    removeCommonRoots(stacks);\n    removeDuplicateOrEmptyJumps(stacks);\n    util.notEnumerableProp(error, \"stack\", reconstructStack(message, stacks));\n    util.notEnumerableProp(error, \"__stackCleaned__\", true);\n};\n\nvar captureStackTrace = (function stackDetection() {\n    var v8stackFramePattern = /^\\s*at\\s*/;\n    var v8stackFormatter = function(stack, error) {\n        if (typeof stack === \"string\") return stack;\n\n        if (error.name !== undefined &&\n            error.message !== undefined) {\n            return error.toString();\n        }\n        return formatNonError(error);\n    };\n\n    if (typeof Error.stackTraceLimit === \"number\" &&\n        typeof Error.captureStackTrace === \"function\") {\n        Error.stackTraceLimit += 6;\n        stackFramePattern = v8stackFramePattern;\n        formatStack = v8stackFormatter;\n        var captureStackTrace = Error.captureStackTrace;\n\n        shouldIgnore = function(line) {\n            return bluebirdFramePattern.test(line);\n        };\n        return function(receiver, ignoreUntil) {\n            Error.stackTraceLimit += 6;\n            captureStackTrace(receiver, ignoreUntil);\n            Error.stackTraceLimit -= 6;\n        };\n    }\n    var err = new Error();\n\n    if (typeof err.stack === \"string\" &&\n        err.stack.split(\"\\n\")[0].indexOf(\"stackDetection@\") >= 0) {\n        stackFramePattern = /@/;\n        formatStack = v8stackFormatter;\n        indentStackFrames = true;\n        return function captureStackTrace(o) {\n            o.stack = new Error().stack;\n        };\n    }\n\n    var hasStackAfterThrow;\n    try { throw new Error(); }\n    catch(e) {\n        hasStackAfterThrow = (\"stack\" in e);\n    }\n    if (!(\"stack\" in err) && hasStackAfterThrow &&\n        typeof Error.stackTraceLimit === \"number\") {\n        stackFramePattern = v8stackFramePattern;\n        formatStack = v8stackFormatter;\n        return function captureStackTrace(o) {\n            Error.stackTraceLimit += 6;\n            try { throw new Error(); }\n            catch(e) { o.stack = e.stack; }\n            Error.stackTraceLimit -= 6;\n        };\n    }\n\n    formatStack = function(stack, error) {\n        if (typeof stack === \"string\") return stack;\n\n        if ((typeof error === \"object\" ||\n            typeof error === \"function\") &&\n            error.name !== undefined &&\n            error.message !== undefined) {\n            return error.toString();\n        }\n        return formatNonError(error);\n    };\n\n    return null;\n\n})([]);\n\nif (typeof console !== \"undefined\" && typeof console.warn !== \"undefined\") {\n    printWarning = function (message) {\n        console.warn(message);\n    };\n    if (util.isNode && process.stderr.isTTY) {\n        printWarning = function(message, isSoft) {\n            var color = isSoft ? \"\\u001b[33m\" : \"\\u001b[31m\";\n            console.warn(color + message + \"\\u001b[0m\\n\");\n        };\n    } else if (!util.isNode && typeof (new Error().stack) === \"string\") {\n        printWarning = function(message, isSoft) {\n            console.warn(\"%c\" + message,\n                        isSoft ? \"color: darkorange\" : \"color: red\");\n        };\n    }\n}\n\nvar config = {\n    warnings: warnings,\n    longStackTraces: false,\n    cancellation: false,\n    monitoring: false\n};\n\nif (longStackTraces) Promise.longStackTraces();\n\nreturn {\n    longStackTraces: function() {\n        return config.longStackTraces;\n    },\n    warnings: function() {\n        return config.warnings;\n    },\n    cancellation: function() {\n        return config.cancellation;\n    },\n    monitoring: function() {\n        return config.monitoring;\n    },\n    propagateFromFunction: function() {\n        return propagateFromFunction;\n    },\n    boundValueFunction: function() {\n        return boundValueFunction;\n    },\n    checkForgottenReturns: checkForgottenReturns,\n    setBounds: setBounds,\n    warn: warn,\n    deprecated: deprecated,\n    CapturedTrace: CapturedTrace,\n    fireDomEvent: fireDomEvent,\n    fireGlobalEvent: fireGlobalEvent\n};\n};\n\n},{\"./errors\":12,\"./util\":36}],10:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise) {\nfunction returner() {\n    return this.value;\n}\nfunction thrower() {\n    throw this.reason;\n}\n\nPromise.prototype[\"return\"] =\nPromise.prototype.thenReturn = function (value) {\n    if (value instanceof Promise) value.suppressUnhandledRejections();\n    return this._then(\n        returner, undefined, undefined, {value: value}, undefined);\n};\n\nPromise.prototype[\"throw\"] =\nPromise.prototype.thenThrow = function (reason) {\n    return this._then(\n        thrower, undefined, undefined, {reason: reason}, undefined);\n};\n\nPromise.prototype.catchThrow = function (reason) {\n    if (arguments.length <= 1) {\n        return this._then(\n            undefined, thrower, undefined, {reason: reason}, undefined);\n    } else {\n        var _reason = arguments[1];\n        var handler = function() {throw _reason;};\n        return this.caught(reason, handler);\n    }\n};\n\nPromise.prototype.catchReturn = function (value) {\n    if (arguments.length <= 1) {\n        if (value instanceof Promise) value.suppressUnhandledRejections();\n        return this._then(\n            undefined, returner, undefined, {value: value}, undefined);\n    } else {\n        var _value = arguments[1];\n        if (_value instanceof Promise) _value.suppressUnhandledRejections();\n        var handler = function() {return _value;};\n        return this.caught(value, handler);\n    }\n};\n};\n\n},{}],11:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise, INTERNAL) {\nvar PromiseReduce = Promise.reduce;\nvar PromiseAll = Promise.all;\n\nfunction promiseAllThis() {\n    return PromiseAll(this);\n}\n\nfunction PromiseMapSeries(promises, fn) {\n    return PromiseReduce(promises, fn, INTERNAL, INTERNAL);\n}\n\nPromise.prototype.each = function (fn) {\n    return PromiseReduce(this, fn, INTERNAL, 0)\n              ._then(promiseAllThis, undefined, undefined, this, undefined);\n};\n\nPromise.prototype.mapSeries = function (fn) {\n    return PromiseReduce(this, fn, INTERNAL, INTERNAL);\n};\n\nPromise.each = function (promises, fn) {\n    return PromiseReduce(promises, fn, INTERNAL, 0)\n              ._then(promiseAllThis, undefined, undefined, promises, undefined);\n};\n\nPromise.mapSeries = PromiseMapSeries;\n};\n\n\n},{}],12:[function(_dereq_,module,exports){\n\"use strict\";\nvar es5 = _dereq_(\"./es5\");\nvar Objectfreeze = es5.freeze;\nvar util = _dereq_(\"./util\");\nvar inherits = util.inherits;\nvar notEnumerableProp = util.notEnumerableProp;\n\nfunction subError(nameProperty, defaultMessage) {\n    function SubError(message) {\n        if (!(this instanceof SubError)) return new SubError(message);\n        notEnumerableProp(this, \"message\",\n            typeof message === \"string\" ? message : defaultMessage);\n        notEnumerableProp(this, \"name\", nameProperty);\n        if (Error.captureStackTrace) {\n            Error.captureStackTrace(this, this.constructor);\n        } else {\n            Error.call(this);\n        }\n    }\n    inherits(SubError, Error);\n    return SubError;\n}\n\nvar _TypeError, _RangeError;\nvar Warning = subError(\"Warning\", \"warning\");\nvar CancellationError = subError(\"CancellationError\", \"cancellation error\");\nvar TimeoutError = subError(\"TimeoutError\", \"timeout error\");\nvar AggregateError = subError(\"AggregateError\", \"aggregate error\");\ntry {\n    _TypeError = TypeError;\n    _RangeError = RangeError;\n} catch(e) {\n    _TypeError = subError(\"TypeError\", \"type error\");\n    _RangeError = subError(\"RangeError\", \"range error\");\n}\n\nvar methods = (\"join pop push shift unshift slice filter forEach some \" +\n    \"every map indexOf lastIndexOf reduce reduceRight sort reverse\").split(\" \");\n\nfor (var i = 0; i < methods.length; ++i) {\n    if (typeof Array.prototype[methods[i]] === \"function\") {\n        AggregateError.prototype[methods[i]] = Array.prototype[methods[i]];\n    }\n}\n\nes5.defineProperty(AggregateError.prototype, \"length\", {\n    value: 0,\n    configurable: false,\n    writable: true,\n    enumerable: true\n});\nAggregateError.prototype[\"isOperational\"] = true;\nvar level = 0;\nAggregateError.prototype.toString = function() {\n    var indent = Array(level * 4 + 1).join(\" \");\n    var ret = \"\\n\" + indent + \"AggregateError of:\" + \"\\n\";\n    level++;\n    indent = Array(level * 4 + 1).join(\" \");\n    for (var i = 0; i < this.length; ++i) {\n        var str = this[i] === this ? \"[Circular AggregateError]\" : this[i] + \"\";\n        var lines = str.split(\"\\n\");\n        for (var j = 0; j < lines.length; ++j) {\n            lines[j] = indent + lines[j];\n        }\n        str = lines.join(\"\\n\");\n        ret += str + \"\\n\";\n    }\n    level--;\n    return ret;\n};\n\nfunction OperationalError(message) {\n    if (!(this instanceof OperationalError))\n        return new OperationalError(message);\n    notEnumerableProp(this, \"name\", \"OperationalError\");\n    notEnumerableProp(this, \"message\", message);\n    this.cause = message;\n    this[\"isOperational\"] = true;\n\n    if (message instanceof Error) {\n        notEnumerableProp(this, \"message\", message.message);\n        notEnumerableProp(this, \"stack\", message.stack);\n    } else if (Error.captureStackTrace) {\n        Error.captureStackTrace(this, this.constructor);\n    }\n\n}\ninherits(OperationalError, Error);\n\nvar errorTypes = Error[\"__BluebirdErrorTypes__\"];\nif (!errorTypes) {\n    errorTypes = Objectfreeze({\n        CancellationError: CancellationError,\n        TimeoutError: TimeoutError,\n        OperationalError: OperationalError,\n        RejectionError: OperationalError,\n        AggregateError: AggregateError\n    });\n    es5.defineProperty(Error, \"__BluebirdErrorTypes__\", {\n        value: errorTypes,\n        writable: false,\n        enumerable: false,\n        configurable: false\n    });\n}\n\nmodule.exports = {\n    Error: Error,\n    TypeError: _TypeError,\n    RangeError: _RangeError,\n    CancellationError: errorTypes.CancellationError,\n    OperationalError: errorTypes.OperationalError,\n    TimeoutError: errorTypes.TimeoutError,\n    AggregateError: errorTypes.AggregateError,\n    Warning: Warning\n};\n\n},{\"./es5\":13,\"./util\":36}],13:[function(_dereq_,module,exports){\nvar isES5 = (function(){\n    \"use strict\";\n    return this === undefined;\n})();\n\nif (isES5) {\n    module.exports = {\n        freeze: Object.freeze,\n        defineProperty: Object.defineProperty,\n        getDescriptor: Object.getOwnPropertyDescriptor,\n        keys: Object.keys,\n        names: Object.getOwnPropertyNames,\n        getPrototypeOf: Object.getPrototypeOf,\n        isArray: Array.isArray,\n        isES5: isES5,\n        propertyIsWritable: function(obj, prop) {\n            var descriptor = Object.getOwnPropertyDescriptor(obj, prop);\n            return !!(!descriptor || descriptor.writable || descriptor.set);\n        }\n    };\n} else {\n    var has = {}.hasOwnProperty;\n    var str = {}.toString;\n    var proto = {}.constructor.prototype;\n\n    var ObjectKeys = function (o) {\n        var ret = [];\n        for (var key in o) {\n            if (has.call(o, key)) {\n                ret.push(key);\n            }\n        }\n        return ret;\n    };\n\n    var ObjectGetDescriptor = function(o, key) {\n        return {value: o[key]};\n    };\n\n    var ObjectDefineProperty = function (o, key, desc) {\n        o[key] = desc.value;\n        return o;\n    };\n\n    var ObjectFreeze = function (obj) {\n        return obj;\n    };\n\n    var ObjectGetPrototypeOf = function (obj) {\n        try {\n            return Object(obj).constructor.prototype;\n        }\n        catch (e) {\n            return proto;\n        }\n    };\n\n    var ArrayIsArray = function (obj) {\n        try {\n            return str.call(obj) === \"[object Array]\";\n        }\n        catch(e) {\n            return false;\n        }\n    };\n\n    module.exports = {\n        isArray: ArrayIsArray,\n        keys: ObjectKeys,\n        names: ObjectKeys,\n        defineProperty: ObjectDefineProperty,\n        getDescriptor: ObjectGetDescriptor,\n        freeze: ObjectFreeze,\n        getPrototypeOf: ObjectGetPrototypeOf,\n        isES5: isES5,\n        propertyIsWritable: function() {\n            return true;\n        }\n    };\n}\n\n},{}],14:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise, INTERNAL) {\nvar PromiseMap = Promise.map;\n\nPromise.prototype.filter = function (fn, options) {\n    return PromiseMap(this, fn, options, INTERNAL);\n};\n\nPromise.filter = function (promises, fn, options) {\n    return PromiseMap(promises, fn, options, INTERNAL);\n};\n};\n\n},{}],15:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise, tryConvertToPromise, NEXT_FILTER) {\nvar util = _dereq_(\"./util\");\nvar CancellationError = Promise.CancellationError;\nvar errorObj = util.errorObj;\nvar catchFilter = _dereq_(\"./catch_filter\")(NEXT_FILTER);\n\nfunction PassThroughHandlerContext(promise, type, handler) {\n    this.promise = promise;\n    this.type = type;\n    this.handler = handler;\n    this.called = false;\n    this.cancelPromise = null;\n}\n\nPassThroughHandlerContext.prototype.isFinallyHandler = function() {\n    return this.type === 0;\n};\n\nfunction FinallyHandlerCancelReaction(finallyHandler) {\n    this.finallyHandler = finallyHandler;\n}\n\nFinallyHandlerCancelReaction.prototype._resultCancelled = function() {\n    checkCancel(this.finallyHandler);\n};\n\nfunction checkCancel(ctx, reason) {\n    if (ctx.cancelPromise != null) {\n        if (arguments.length > 1) {\n            ctx.cancelPromise._reject(reason);\n        } else {\n            ctx.cancelPromise._cancel();\n        }\n        ctx.cancelPromise = null;\n        return true;\n    }\n    return false;\n}\n\nfunction succeed() {\n    return finallyHandler.call(this, this.promise._target()._settledValue());\n}\nfunction fail(reason) {\n    if (checkCancel(this, reason)) return;\n    errorObj.e = reason;\n    return errorObj;\n}\nfunction finallyHandler(reasonOrValue) {\n    var promise = this.promise;\n    var handler = this.handler;\n\n    if (!this.called) {\n        this.called = true;\n        var ret = this.isFinallyHandler()\n            ? handler.call(promise._boundValue())\n            : handler.call(promise._boundValue(), reasonOrValue);\n        if (ret === NEXT_FILTER) {\n            return ret;\n        } else if (ret !== undefined) {\n            promise._setReturnedNonUndefined();\n            var maybePromise = tryConvertToPromise(ret, promise);\n            if (maybePromise instanceof Promise) {\n                if (this.cancelPromise != null) {\n                    if (maybePromise._isCancelled()) {\n                        var reason =\n                            new CancellationError(\"late cancellation observer\");\n                        promise._attachExtraTrace(reason);\n                        errorObj.e = reason;\n                        return errorObj;\n                    } else if (maybePromise.isPending()) {\n                        maybePromise._attachCancellationCallback(\n                            new FinallyHandlerCancelReaction(this));\n                    }\n                }\n                return maybePromise._then(\n                    succeed, fail, undefined, this, undefined);\n            }\n        }\n    }\n\n    if (promise.isRejected()) {\n        checkCancel(this);\n        errorObj.e = reasonOrValue;\n        return errorObj;\n    } else {\n        checkCancel(this);\n        return reasonOrValue;\n    }\n}\n\nPromise.prototype._passThrough = function(handler, type, success, fail) {\n    if (typeof handler !== \"function\") return this.then();\n    return this._then(success,\n                      fail,\n                      undefined,\n                      new PassThroughHandlerContext(this, type, handler),\n                      undefined);\n};\n\nPromise.prototype.lastly =\nPromise.prototype[\"finally\"] = function (handler) {\n    return this._passThrough(handler,\n                             0,\n                             finallyHandler,\n                             finallyHandler);\n};\n\n\nPromise.prototype.tap = function (handler) {\n    return this._passThrough(handler, 1, finallyHandler);\n};\n\nPromise.prototype.tapCatch = function (handlerOrPredicate) {\n    var len = arguments.length;\n    if(len === 1) {\n        return this._passThrough(handlerOrPredicate,\n                                 1,\n                                 undefined,\n                                 finallyHandler);\n    } else {\n         var catchInstances = new Array(len - 1),\n            j = 0, i;\n        for (i = 0; i < len - 1; ++i) {\n            var item = arguments[i];\n            if (util.isObject(item)) {\n                catchInstances[j++] = item;\n            } else {\n                return Promise.reject(new TypeError(\n                    \"tapCatch statement predicate: \"\n                    + \"expecting an object but got \" + util.classString(item)\n                ));\n            }\n        }\n        catchInstances.length = j;\n        var handler = arguments[i];\n        return this._passThrough(catchFilter(catchInstances, handler, this),\n                                 1,\n                                 undefined,\n                                 finallyHandler);\n    }\n\n};\n\nreturn PassThroughHandlerContext;\n};\n\n},{\"./catch_filter\":7,\"./util\":36}],16:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise,\n                          apiRejection,\n                          INTERNAL,\n                          tryConvertToPromise,\n                          Proxyable,\n                          debug) {\nvar errors = _dereq_(\"./errors\");\nvar TypeError = errors.TypeError;\nvar util = _dereq_(\"./util\");\nvar errorObj = util.errorObj;\nvar tryCatch = util.tryCatch;\nvar yieldHandlers = [];\n\nfunction promiseFromYieldHandler(value, yieldHandlers, traceParent) {\n    for (var i = 0; i < yieldHandlers.length; ++i) {\n        traceParent._pushContext();\n        var result = tryCatch(yieldHandlers[i])(value);\n        traceParent._popContext();\n        if (result === errorObj) {\n            traceParent._pushContext();\n            var ret = Promise.reject(errorObj.e);\n            traceParent._popContext();\n            return ret;\n        }\n        var maybePromise = tryConvertToPromise(result, traceParent);\n        if (maybePromise instanceof Promise) return maybePromise;\n    }\n    return null;\n}\n\nfunction PromiseSpawn(generatorFunction, receiver, yieldHandler, stack) {\n    if (debug.cancellation()) {\n        var internal = new Promise(INTERNAL);\n        var _finallyPromise = this._finallyPromise = new Promise(INTERNAL);\n        this._promise = internal.lastly(function() {\n            return _finallyPromise;\n        });\n        internal._captureStackTrace();\n        internal._setOnCancel(this);\n    } else {\n        var promise = this._promise = new Promise(INTERNAL);\n        promise._captureStackTrace();\n    }\n    this._stack = stack;\n    this._generatorFunction = generatorFunction;\n    this._receiver = receiver;\n    this._generator = undefined;\n    this._yieldHandlers = typeof yieldHandler === \"function\"\n        ? [yieldHandler].concat(yieldHandlers)\n        : yieldHandlers;\n    this._yieldedPromise = null;\n    this._cancellationPhase = false;\n}\nutil.inherits(PromiseSpawn, Proxyable);\n\nPromiseSpawn.prototype._isResolved = function() {\n    return this._promise === null;\n};\n\nPromiseSpawn.prototype._cleanup = function() {\n    this._promise = this._generator = null;\n    if (debug.cancellation() && this._finallyPromise !== null) {\n        this._finallyPromise._fulfill();\n        this._finallyPromise = null;\n    }\n};\n\nPromiseSpawn.prototype._promiseCancelled = function() {\n    if (this._isResolved()) return;\n    var implementsReturn = typeof this._generator[\"return\"] !== \"undefined\";\n\n    var result;\n    if (!implementsReturn) {\n        var reason = new Promise.CancellationError(\n            \"generator .return() sentinel\");\n        Promise.coroutine.returnSentinel = reason;\n        this._promise._attachExtraTrace(reason);\n        this._promise._pushContext();\n        result = tryCatch(this._generator[\"throw\"]).call(this._generator,\n                                                         reason);\n        this._promise._popContext();\n    } else {\n        this._promise._pushContext();\n        result = tryCatch(this._generator[\"return\"]).call(this._generator,\n                                                          undefined);\n        this._promise._popContext();\n    }\n    this._cancellationPhase = true;\n    this._yieldedPromise = null;\n    this._continue(result);\n};\n\nPromiseSpawn.prototype._promiseFulfilled = function(value) {\n    this._yieldedPromise = null;\n    this._promise._pushContext();\n    var result = tryCatch(this._generator.next).call(this._generator, value);\n    this._promise._popContext();\n    this._continue(result);\n};\n\nPromiseSpawn.prototype._promiseRejected = function(reason) {\n    this._yieldedPromise = null;\n    this._promise._attachExtraTrace(reason);\n    this._promise._pushContext();\n    var result = tryCatch(this._generator[\"throw\"])\n        .call(this._generator, reason);\n    this._promise._popContext();\n    this._continue(result);\n};\n\nPromiseSpawn.prototype._resultCancelled = function() {\n    if (this._yieldedPromise instanceof Promise) {\n        var promise = this._yieldedPromise;\n        this._yieldedPromise = null;\n        promise.cancel();\n    }\n};\n\nPromiseSpawn.prototype.promise = function () {\n    return this._promise;\n};\n\nPromiseSpawn.prototype._run = function () {\n    this._generator = this._generatorFunction.call(this._receiver);\n    this._receiver =\n        this._generatorFunction = undefined;\n    this._promiseFulfilled(undefined);\n};\n\nPromiseSpawn.prototype._continue = function (result) {\n    var promise = this._promise;\n    if (result === errorObj) {\n        this._cleanup();\n        if (this._cancellationPhase) {\n            return promise.cancel();\n        } else {\n            return promise._rejectCallback(result.e, false);\n        }\n    }\n\n    var value = result.value;\n    if (result.done === true) {\n        this._cleanup();\n        if (this._cancellationPhase) {\n            return promise.cancel();\n        } else {\n            return promise._resolveCallback(value);\n        }\n    } else {\n        var maybePromise = tryConvertToPromise(value, this._promise);\n        if (!(maybePromise instanceof Promise)) {\n            maybePromise =\n                promiseFromYieldHandler(maybePromise,\n                                        this._yieldHandlers,\n                                        this._promise);\n            if (maybePromise === null) {\n                this._promiseRejected(\n                    new TypeError(\n                        \"A value %s was yielded that could not be treated as a promise\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\\u000a\".replace(\"%s\", String(value)) +\n                        \"From coroutine:\\u000a\" +\n                        this._stack.split(\"\\n\").slice(1, -7).join(\"\\n\")\n                    )\n                );\n                return;\n            }\n        }\n        maybePromise = maybePromise._target();\n        var bitField = maybePromise._bitField;\n        ;\n        if (((bitField & 50397184) === 0)) {\n            this._yieldedPromise = maybePromise;\n            maybePromise._proxy(this, null);\n        } else if (((bitField & 33554432) !== 0)) {\n            Promise._async.invoke(\n                this._promiseFulfilled, this, maybePromise._value()\n            );\n        } else if (((bitField & 16777216) !== 0)) {\n            Promise._async.invoke(\n                this._promiseRejected, this, maybePromise._reason()\n            );\n        } else {\n            this._promiseCancelled();\n        }\n    }\n};\n\nPromise.coroutine = function (generatorFunction, options) {\n    if (typeof generatorFunction !== \"function\") {\n        throw new TypeError(\"generatorFunction must be a function\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n    var yieldHandler = Object(options).yieldHandler;\n    var PromiseSpawn$ = PromiseSpawn;\n    var stack = new Error().stack;\n    return function () {\n        var generator = generatorFunction.apply(this, arguments);\n        var spawn = new PromiseSpawn$(undefined, undefined, yieldHandler,\n                                      stack);\n        var ret = spawn.promise();\n        spawn._generator = generator;\n        spawn._promiseFulfilled(undefined);\n        return ret;\n    };\n};\n\nPromise.coroutine.addYieldHandler = function(fn) {\n    if (typeof fn !== \"function\") {\n        throw new TypeError(\"expecting a function but got \" + util.classString(fn));\n    }\n    yieldHandlers.push(fn);\n};\n\nPromise.spawn = function (generatorFunction) {\n    debug.deprecated(\"Promise.spawn()\", \"Promise.coroutine()\");\n    if (typeof generatorFunction !== \"function\") {\n        return apiRejection(\"generatorFunction must be a function\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n    var spawn = new PromiseSpawn(generatorFunction, this);\n    var ret = spawn.promise();\n    spawn._run(Promise.spawn);\n    return ret;\n};\n};\n\n},{\"./errors\":12,\"./util\":36}],17:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports =\nfunction(Promise, PromiseArray, tryConvertToPromise, INTERNAL, async,\n         getDomain) {\nvar util = _dereq_(\"./util\");\nvar canEvaluate = util.canEvaluate;\nvar tryCatch = util.tryCatch;\nvar errorObj = util.errorObj;\nvar reject;\n\nif (!true) {\nif (canEvaluate) {\n    var thenCallback = function(i) {\n        return new Function(\"value\", \"holder\", \"                             \\n\\\n            'use strict';                                                    \\n\\\n            holder.pIndex = value;                                           \\n\\\n            holder.checkFulfillment(this);                                   \\n\\\n            \".replace(/Index/g, i));\n    };\n\n    var promiseSetter = function(i) {\n        return new Function(\"promise\", \"holder\", \"                           \\n\\\n            'use strict';                                                    \\n\\\n            holder.pIndex = promise;                                         \\n\\\n            \".replace(/Index/g, i));\n    };\n\n    var generateHolderClass = function(total) {\n        var props = new Array(total);\n        for (var i = 0; i < props.length; ++i) {\n            props[i] = \"this.p\" + (i+1);\n        }\n        var assignment = props.join(\" = \") + \" = null;\";\n        var cancellationCode= \"var promise;\\n\" + props.map(function(prop) {\n            return \"                                                         \\n\\\n                promise = \" + prop + \";                                      \\n\\\n                if (promise instanceof Promise) {                            \\n\\\n                    promise.cancel();                                        \\n\\\n                }                                                            \\n\\\n            \";\n        }).join(\"\\n\");\n        var passedArguments = props.join(\", \");\n        var name = \"Holder$\" + total;\n\n\n        var code = \"return function(tryCatch, errorObj, Promise, async) {    \\n\\\n            'use strict';                                                    \\n\\\n            function [TheName](fn) {                                         \\n\\\n                [TheProperties]                                              \\n\\\n                this.fn = fn;                                                \\n\\\n                this.asyncNeeded = true;                                     \\n\\\n                this.now = 0;                                                \\n\\\n            }                                                                \\n\\\n                                                                             \\n\\\n            [TheName].prototype._callFunction = function(promise) {          \\n\\\n                promise._pushContext();                                      \\n\\\n                var ret = tryCatch(this.fn)([ThePassedArguments]);           \\n\\\n                promise._popContext();                                       \\n\\\n                if (ret === errorObj) {                                      \\n\\\n                    promise._rejectCallback(ret.e, false);                   \\n\\\n                } else {                                                     \\n\\\n                    promise._resolveCallback(ret);                           \\n\\\n                }                                                            \\n\\\n            };                                                               \\n\\\n                                                                             \\n\\\n            [TheName].prototype.checkFulfillment = function(promise) {       \\n\\\n                var now = ++this.now;                                        \\n\\\n                if (now === [TheTotal]) {                                    \\n\\\n                    if (this.asyncNeeded) {                                  \\n\\\n                        async.invoke(this._callFunction, this, promise);     \\n\\\n                    } else {                                                 \\n\\\n                        this._callFunction(promise);                         \\n\\\n                    }                                                        \\n\\\n                                                                             \\n\\\n                }                                                            \\n\\\n            };                                                               \\n\\\n                                                                             \\n\\\n            [TheName].prototype._resultCancelled = function() {              \\n\\\n                [CancellationCode]                                           \\n\\\n            };                                                               \\n\\\n                                                                             \\n\\\n            return [TheName];                                                \\n\\\n        }(tryCatch, errorObj, Promise, async);                               \\n\\\n        \";\n\n        code = code.replace(/\\[TheName\\]/g, name)\n            .replace(/\\[TheTotal\\]/g, total)\n            .replace(/\\[ThePassedArguments\\]/g, passedArguments)\n            .replace(/\\[TheProperties\\]/g, assignment)\n            .replace(/\\[CancellationCode\\]/g, cancellationCode);\n\n        return new Function(\"tryCatch\", \"errorObj\", \"Promise\", \"async\", code)\n                           (tryCatch, errorObj, Promise, async);\n    };\n\n    var holderClasses = [];\n    var thenCallbacks = [];\n    var promiseSetters = [];\n\n    for (var i = 0; i < 8; ++i) {\n        holderClasses.push(generateHolderClass(i + 1));\n        thenCallbacks.push(thenCallback(i + 1));\n        promiseSetters.push(promiseSetter(i + 1));\n    }\n\n    reject = function (reason) {\n        this._reject(reason);\n    };\n}}\n\nPromise.join = function () {\n    var last = arguments.length - 1;\n    var fn;\n    if (last > 0 && typeof arguments[last] === \"function\") {\n        fn = arguments[last];\n        if (!true) {\n            if (last <= 8 && canEvaluate) {\n                var ret = new Promise(INTERNAL);\n                ret._captureStackTrace();\n                var HolderClass = holderClasses[last - 1];\n                var holder = new HolderClass(fn);\n                var callbacks = thenCallbacks;\n\n                for (var i = 0; i < last; ++i) {\n                    var maybePromise = tryConvertToPromise(arguments[i], ret);\n                    if (maybePromise instanceof Promise) {\n                        maybePromise = maybePromise._target();\n                        var bitField = maybePromise._bitField;\n                        ;\n                        if (((bitField & 50397184) === 0)) {\n                            maybePromise._then(callbacks[i], reject,\n                                               undefined, ret, holder);\n                            promiseSetters[i](maybePromise, holder);\n                            holder.asyncNeeded = false;\n                        } else if (((bitField & 33554432) !== 0)) {\n                            callbacks[i].call(ret,\n                                              maybePromise._value(), holder);\n                        } else if (((bitField & 16777216) !== 0)) {\n                            ret._reject(maybePromise._reason());\n                        } else {\n                            ret._cancel();\n                        }\n                    } else {\n                        callbacks[i].call(ret, maybePromise, holder);\n                    }\n                }\n\n                if (!ret._isFateSealed()) {\n                    if (holder.asyncNeeded) {\n                        var domain = getDomain();\n                        if (domain !== null) {\n                            holder.fn = util.domainBind(domain, holder.fn);\n                        }\n                    }\n                    ret._setAsyncGuaranteed();\n                    ret._setOnCancel(holder);\n                }\n                return ret;\n            }\n        }\n    }\n    var args = [].slice.call(arguments);;\n    if (fn) args.pop();\n    var ret = new PromiseArray(args).promise();\n    return fn !== undefined ? ret.spread(fn) : ret;\n};\n\n};\n\n},{\"./util\":36}],18:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise,\n                          PromiseArray,\n                          apiRejection,\n                          tryConvertToPromise,\n                          INTERNAL,\n                          debug) {\nvar getDomain = Promise._getDomain;\nvar util = _dereq_(\"./util\");\nvar tryCatch = util.tryCatch;\nvar errorObj = util.errorObj;\nvar async = Promise._async;\n\nfunction MappingPromiseArray(promises, fn, limit, _filter) {\n    this.constructor$(promises);\n    this._promise._captureStackTrace();\n    var domain = getDomain();\n    this._callback = domain === null ? fn : util.domainBind(domain, fn);\n    this._preservedValues = _filter === INTERNAL\n        ? new Array(this.length())\n        : null;\n    this._limit = limit;\n    this._inFlight = 0;\n    this._queue = [];\n    async.invoke(this._asyncInit, this, undefined);\n}\nutil.inherits(MappingPromiseArray, PromiseArray);\n\nMappingPromiseArray.prototype._asyncInit = function() {\n    this._init$(undefined, -2);\n};\n\nMappingPromiseArray.prototype._init = function () {};\n\nMappingPromiseArray.prototype._promiseFulfilled = function (value, index) {\n    var values = this._values;\n    var length = this.length();\n    var preservedValues = this._preservedValues;\n    var limit = this._limit;\n\n    if (index < 0) {\n        index = (index * -1) - 1;\n        values[index] = value;\n        if (limit >= 1) {\n            this._inFlight--;\n            this._drainQueue();\n            if (this._isResolved()) return true;\n        }\n    } else {\n        if (limit >= 1 && this._inFlight >= limit) {\n            values[index] = value;\n            this._queue.push(index);\n            return false;\n        }\n        if (preservedValues !== null) preservedValues[index] = value;\n\n        var promise = this._promise;\n        var callback = this._callback;\n        var receiver = promise._boundValue();\n        promise._pushContext();\n        var ret = tryCatch(callback).call(receiver, value, index, length);\n        var promiseCreated = promise._popContext();\n        debug.checkForgottenReturns(\n            ret,\n            promiseCreated,\n            preservedValues !== null ? \"Promise.filter\" : \"Promise.map\",\n            promise\n        );\n        if (ret === errorObj) {\n            this._reject(ret.e);\n            return true;\n        }\n\n        var maybePromise = tryConvertToPromise(ret, this._promise);\n        if (maybePromise instanceof Promise) {\n            maybePromise = maybePromise._target();\n            var bitField = maybePromise._bitField;\n            ;\n            if (((bitField & 50397184) === 0)) {\n                if (limit >= 1) this._inFlight++;\n                values[index] = maybePromise;\n                maybePromise._proxy(this, (index + 1) * -1);\n                return false;\n            } else if (((bitField & 33554432) !== 0)) {\n                ret = maybePromise._value();\n            } else if (((bitField & 16777216) !== 0)) {\n                this._reject(maybePromise._reason());\n                return true;\n            } else {\n                this._cancel();\n                return true;\n            }\n        }\n        values[index] = ret;\n    }\n    var totalResolved = ++this._totalResolved;\n    if (totalResolved >= length) {\n        if (preservedValues !== null) {\n            this._filter(values, preservedValues);\n        } else {\n            this._resolve(values);\n        }\n        return true;\n    }\n    return false;\n};\n\nMappingPromiseArray.prototype._drainQueue = function () {\n    var queue = this._queue;\n    var limit = this._limit;\n    var values = this._values;\n    while (queue.length > 0 && this._inFlight < limit) {\n        if (this._isResolved()) return;\n        var index = queue.pop();\n        this._promiseFulfilled(values[index], index);\n    }\n};\n\nMappingPromiseArray.prototype._filter = function (booleans, values) {\n    var len = values.length;\n    var ret = new Array(len);\n    var j = 0;\n    for (var i = 0; i < len; ++i) {\n        if (booleans[i]) ret[j++] = values[i];\n    }\n    ret.length = j;\n    this._resolve(ret);\n};\n\nMappingPromiseArray.prototype.preservedValues = function () {\n    return this._preservedValues;\n};\n\nfunction map(promises, fn, options, _filter) {\n    if (typeof fn !== \"function\") {\n        return apiRejection(\"expecting a function but got \" + util.classString(fn));\n    }\n\n    var limit = 0;\n    if (options !== undefined) {\n        if (typeof options === \"object\" && options !== null) {\n            if (typeof options.concurrency !== \"number\") {\n                return Promise.reject(\n                    new TypeError(\"'concurrency' must be a number but it is \" +\n                                    util.classString(options.concurrency)));\n            }\n            limit = options.concurrency;\n        } else {\n            return Promise.reject(new TypeError(\n                            \"options argument must be an object but it is \" +\n                             util.classString(options)));\n        }\n    }\n    limit = typeof limit === \"number\" &&\n        isFinite(limit) && limit >= 1 ? limit : 0;\n    return new MappingPromiseArray(promises, fn, limit, _filter).promise();\n}\n\nPromise.prototype.map = function (fn, options) {\n    return map(this, fn, options, null);\n};\n\nPromise.map = function (promises, fn, options, _filter) {\n    return map(promises, fn, options, _filter);\n};\n\n\n};\n\n},{\"./util\":36}],19:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports =\nfunction(Promise, INTERNAL, tryConvertToPromise, apiRejection, debug) {\nvar util = _dereq_(\"./util\");\nvar tryCatch = util.tryCatch;\n\nPromise.method = function (fn) {\n    if (typeof fn !== \"function\") {\n        throw new Promise.TypeError(\"expecting a function but got \" + util.classString(fn));\n    }\n    return function () {\n        var ret = new Promise(INTERNAL);\n        ret._captureStackTrace();\n        ret._pushContext();\n        var value = tryCatch(fn).apply(this, arguments);\n        var promiseCreated = ret._popContext();\n        debug.checkForgottenReturns(\n            value, promiseCreated, \"Promise.method\", ret);\n        ret._resolveFromSyncValue(value);\n        return ret;\n    };\n};\n\nPromise.attempt = Promise[\"try\"] = function (fn) {\n    if (typeof fn !== \"function\") {\n        return apiRejection(\"expecting a function but got \" + util.classString(fn));\n    }\n    var ret = new Promise(INTERNAL);\n    ret._captureStackTrace();\n    ret._pushContext();\n    var value;\n    if (arguments.length > 1) {\n        debug.deprecated(\"calling Promise.try with more than 1 argument\");\n        var arg = arguments[1];\n        var ctx = arguments[2];\n        value = util.isArray(arg) ? tryCatch(fn).apply(ctx, arg)\n                                  : tryCatch(fn).call(ctx, arg);\n    } else {\n        value = tryCatch(fn)();\n    }\n    var promiseCreated = ret._popContext();\n    debug.checkForgottenReturns(\n        value, promiseCreated, \"Promise.try\", ret);\n    ret._resolveFromSyncValue(value);\n    return ret;\n};\n\nPromise.prototype._resolveFromSyncValue = function (value) {\n    if (value === util.errorObj) {\n        this._rejectCallback(value.e, false);\n    } else {\n        this._resolveCallback(value, true);\n    }\n};\n};\n\n},{\"./util\":36}],20:[function(_dereq_,module,exports){\n\"use strict\";\nvar util = _dereq_(\"./util\");\nvar maybeWrapAsError = util.maybeWrapAsError;\nvar errors = _dereq_(\"./errors\");\nvar OperationalError = errors.OperationalError;\nvar es5 = _dereq_(\"./es5\");\n\nfunction isUntypedError(obj) {\n    return obj instanceof Error &&\n        es5.getPrototypeOf(obj) === Error.prototype;\n}\n\nvar rErrorKey = /^(?:name|message|stack|cause)$/;\nfunction wrapAsOperationalError(obj) {\n    var ret;\n    if (isUntypedError(obj)) {\n        ret = new OperationalError(obj);\n        ret.name = obj.name;\n        ret.message = obj.message;\n        ret.stack = obj.stack;\n        var keys = es5.keys(obj);\n        for (var i = 0; i < keys.length; ++i) {\n            var key = keys[i];\n            if (!rErrorKey.test(key)) {\n                ret[key] = obj[key];\n            }\n        }\n        return ret;\n    }\n    util.markAsOriginatingFromRejection(obj);\n    return obj;\n}\n\nfunction nodebackForPromise(promise, multiArgs) {\n    return function(err, value) {\n        if (promise === null) return;\n        if (err) {\n            var wrapped = wrapAsOperationalError(maybeWrapAsError(err));\n            promise._attachExtraTrace(wrapped);\n            promise._reject(wrapped);\n        } else if (!multiArgs) {\n            promise._fulfill(value);\n        } else {\n            var args = [].slice.call(arguments, 1);;\n            promise._fulfill(args);\n        }\n        promise = null;\n    };\n}\n\nmodule.exports = nodebackForPromise;\n\n},{\"./errors\":12,\"./es5\":13,\"./util\":36}],21:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise) {\nvar util = _dereq_(\"./util\");\nvar async = Promise._async;\nvar tryCatch = util.tryCatch;\nvar errorObj = util.errorObj;\n\nfunction spreadAdapter(val, nodeback) {\n    var promise = this;\n    if (!util.isArray(val)) return successAdapter.call(promise, val, nodeback);\n    var ret =\n        tryCatch(nodeback).apply(promise._boundValue(), [null].concat(val));\n    if (ret === errorObj) {\n        async.throwLater(ret.e);\n    }\n}\n\nfunction successAdapter(val, nodeback) {\n    var promise = this;\n    var receiver = promise._boundValue();\n    var ret = val === undefined\n        ? tryCatch(nodeback).call(receiver, null)\n        : tryCatch(nodeback).call(receiver, null, val);\n    if (ret === errorObj) {\n        async.throwLater(ret.e);\n    }\n}\nfunction errorAdapter(reason, nodeback) {\n    var promise = this;\n    if (!reason) {\n        var newReason = new Error(reason + \"\");\n        newReason.cause = reason;\n        reason = newReason;\n    }\n    var ret = tryCatch(nodeback).call(promise._boundValue(), reason);\n    if (ret === errorObj) {\n        async.throwLater(ret.e);\n    }\n}\n\nPromise.prototype.asCallback = Promise.prototype.nodeify = function (nodeback,\n                                                                     options) {\n    if (typeof nodeback == \"function\") {\n        var adapter = successAdapter;\n        if (options !== undefined && Object(options).spread) {\n            adapter = spreadAdapter;\n        }\n        this._then(\n            adapter,\n            errorAdapter,\n            undefined,\n            this,\n            nodeback\n        );\n    }\n    return this;\n};\n};\n\n},{\"./util\":36}],22:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function() {\nvar makeSelfResolutionError = function () {\n    return new TypeError(\"circular promise resolution chain\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n};\nvar reflectHandler = function() {\n    return new Promise.PromiseInspection(this._target());\n};\nvar apiRejection = function(msg) {\n    return Promise.reject(new TypeError(msg));\n};\nfunction Proxyable() {}\nvar UNDEFINED_BINDING = {};\nvar util = _dereq_(\"./util\");\n\nvar getDomain;\nif (util.isNode) {\n    getDomain = function() {\n        var ret = process.domain;\n        if (ret === undefined) ret = null;\n        return ret;\n    };\n} else {\n    getDomain = function() {\n        return null;\n    };\n}\nutil.notEnumerableProp(Promise, \"_getDomain\", getDomain);\n\nvar es5 = _dereq_(\"./es5\");\nvar Async = _dereq_(\"./async\");\nvar async = new Async();\nes5.defineProperty(Promise, \"_async\", {value: async});\nvar errors = _dereq_(\"./errors\");\nvar TypeError = Promise.TypeError = errors.TypeError;\nPromise.RangeError = errors.RangeError;\nvar CancellationError = Promise.CancellationError = errors.CancellationError;\nPromise.TimeoutError = errors.TimeoutError;\nPromise.OperationalError = errors.OperationalError;\nPromise.RejectionError = errors.OperationalError;\nPromise.AggregateError = errors.AggregateError;\nvar INTERNAL = function(){};\nvar APPLY = {};\nvar NEXT_FILTER = {};\nvar tryConvertToPromise = _dereq_(\"./thenables\")(Promise, INTERNAL);\nvar PromiseArray =\n    _dereq_(\"./promise_array\")(Promise, INTERNAL,\n                               tryConvertToPromise, apiRejection, Proxyable);\nvar Context = _dereq_(\"./context\")(Promise);\n /*jshint unused:false*/\nvar createContext = Context.create;\nvar debug = _dereq_(\"./debuggability\")(Promise, Context);\nvar CapturedTrace = debug.CapturedTrace;\nvar PassThroughHandlerContext =\n    _dereq_(\"./finally\")(Promise, tryConvertToPromise, NEXT_FILTER);\nvar catchFilter = _dereq_(\"./catch_filter\")(NEXT_FILTER);\nvar nodebackForPromise = _dereq_(\"./nodeback\");\nvar errorObj = util.errorObj;\nvar tryCatch = util.tryCatch;\nfunction check(self, executor) {\n    if (self == null || self.constructor !== Promise) {\n        throw new TypeError(\"the promise constructor cannot be invoked directly\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n    if (typeof executor !== \"function\") {\n        throw new TypeError(\"expecting a function but got \" + util.classString(executor));\n    }\n\n}\n\nfunction Promise(executor) {\n    if (executor !== INTERNAL) {\n        check(this, executor);\n    }\n    this._bitField = 0;\n    this._fulfillmentHandler0 = undefined;\n    this._rejectionHandler0 = undefined;\n    this._promise0 = undefined;\n    this._receiver0 = undefined;\n    this._resolveFromExecutor(executor);\n    this._promiseCreated();\n    this._fireEvent(\"promiseCreated\", this);\n}\n\nPromise.prototype.toString = function () {\n    return \"[object Promise]\";\n};\n\nPromise.prototype.caught = Promise.prototype[\"catch\"] = function (fn) {\n    var len = arguments.length;\n    if (len > 1) {\n        var catchInstances = new Array(len - 1),\n            j = 0, i;\n        for (i = 0; i < len - 1; ++i) {\n            var item = arguments[i];\n            if (util.isObject(item)) {\n                catchInstances[j++] = item;\n            } else {\n                return apiRejection(\"Catch statement predicate: \" +\n                    \"expecting an object but got \" + util.classString(item));\n            }\n        }\n        catchInstances.length = j;\n        fn = arguments[i];\n        return this.then(undefined, catchFilter(catchInstances, fn, this));\n    }\n    return this.then(undefined, fn);\n};\n\nPromise.prototype.reflect = function () {\n    return this._then(reflectHandler,\n        reflectHandler, undefined, this, undefined);\n};\n\nPromise.prototype.then = function (didFulfill, didReject) {\n    if (debug.warnings() && arguments.length > 0 &&\n        typeof didFulfill !== \"function\" &&\n        typeof didReject !== \"function\") {\n        var msg = \".then() only accepts functions but was passed: \" +\n                util.classString(didFulfill);\n        if (arguments.length > 1) {\n            msg += \", \" + util.classString(didReject);\n        }\n        this._warn(msg);\n    }\n    return this._then(didFulfill, didReject, undefined, undefined, undefined);\n};\n\nPromise.prototype.done = function (didFulfill, didReject) {\n    var promise =\n        this._then(didFulfill, didReject, undefined, undefined, undefined);\n    promise._setIsFinal();\n};\n\nPromise.prototype.spread = function (fn) {\n    if (typeof fn !== \"function\") {\n        return apiRejection(\"expecting a function but got \" + util.classString(fn));\n    }\n    return this.all()._then(fn, undefined, undefined, APPLY, undefined);\n};\n\nPromise.prototype.toJSON = function () {\n    var ret = {\n        isFulfilled: false,\n        isRejected: false,\n        fulfillmentValue: undefined,\n        rejectionReason: undefined\n    };\n    if (this.isFulfilled()) {\n        ret.fulfillmentValue = this.value();\n        ret.isFulfilled = true;\n    } else if (this.isRejected()) {\n        ret.rejectionReason = this.reason();\n        ret.isRejected = true;\n    }\n    return ret;\n};\n\nPromise.prototype.all = function () {\n    if (arguments.length > 0) {\n        this._warn(\".all() was passed arguments but it does not take any\");\n    }\n    return new PromiseArray(this).promise();\n};\n\nPromise.prototype.error = function (fn) {\n    return this.caught(util.originatesFromRejection, fn);\n};\n\nPromise.getNewLibraryCopy = module.exports;\n\nPromise.is = function (val) {\n    return val instanceof Promise;\n};\n\nPromise.fromNode = Promise.fromCallback = function(fn) {\n    var ret = new Promise(INTERNAL);\n    ret._captureStackTrace();\n    var multiArgs = arguments.length > 1 ? !!Object(arguments[1]).multiArgs\n                                         : false;\n    var result = tryCatch(fn)(nodebackForPromise(ret, multiArgs));\n    if (result === errorObj) {\n        ret._rejectCallback(result.e, true);\n    }\n    if (!ret._isFateSealed()) ret._setAsyncGuaranteed();\n    return ret;\n};\n\nPromise.all = function (promises) {\n    return new PromiseArray(promises).promise();\n};\n\nPromise.cast = function (obj) {\n    var ret = tryConvertToPromise(obj);\n    if (!(ret instanceof Promise)) {\n        ret = new Promise(INTERNAL);\n        ret._captureStackTrace();\n        ret._setFulfilled();\n        ret._rejectionHandler0 = obj;\n    }\n    return ret;\n};\n\nPromise.resolve = Promise.fulfilled = Promise.cast;\n\nPromise.reject = Promise.rejected = function (reason) {\n    var ret = new Promise(INTERNAL);\n    ret._captureStackTrace();\n    ret._rejectCallback(reason, true);\n    return ret;\n};\n\nPromise.setScheduler = function(fn) {\n    if (typeof fn !== \"function\") {\n        throw new TypeError(\"expecting a function but got \" + util.classString(fn));\n    }\n    return async.setScheduler(fn);\n};\n\nPromise.prototype._then = function (\n    didFulfill,\n    didReject,\n    _,    receiver,\n    internalData\n) {\n    var haveInternalData = internalData !== undefined;\n    var promise = haveInternalData ? internalData : new Promise(INTERNAL);\n    var target = this._target();\n    var bitField = target._bitField;\n\n    if (!haveInternalData) {\n        promise._propagateFrom(this, 3);\n        promise._captureStackTrace();\n        if (receiver === undefined &&\n            ((this._bitField & 2097152) !== 0)) {\n            if (!((bitField & 50397184) === 0)) {\n                receiver = this._boundValue();\n            } else {\n                receiver = target === this ? undefined : this._boundTo;\n            }\n        }\n        this._fireEvent(\"promiseChained\", this, promise);\n    }\n\n    var domain = getDomain();\n    if (!((bitField & 50397184) === 0)) {\n        var handler, value, settler = target._settlePromiseCtx;\n        if (((bitField & 33554432) !== 0)) {\n            value = target._rejectionHandler0;\n            handler = didFulfill;\n        } else if (((bitField & 16777216) !== 0)) {\n            value = target._fulfillmentHandler0;\n            handler = didReject;\n            target._unsetRejectionIsUnhandled();\n        } else {\n            settler = target._settlePromiseLateCancellationObserver;\n            value = new CancellationError(\"late cancellation observer\");\n            target._attachExtraTrace(value);\n            handler = didReject;\n        }\n\n        async.invoke(settler, target, {\n            handler: domain === null ? handler\n                : (typeof handler === \"function\" &&\n                    util.domainBind(domain, handler)),\n            promise: promise,\n            receiver: receiver,\n            value: value\n        });\n    } else {\n        target._addCallbacks(didFulfill, didReject, promise, receiver, domain);\n    }\n\n    return promise;\n};\n\nPromise.prototype._length = function () {\n    return this._bitField & 65535;\n};\n\nPromise.prototype._isFateSealed = function () {\n    return (this._bitField & 117506048) !== 0;\n};\n\nPromise.prototype._isFollowing = function () {\n    return (this._bitField & 67108864) === 67108864;\n};\n\nPromise.prototype._setLength = function (len) {\n    this._bitField = (this._bitField & -65536) |\n        (len & 65535);\n};\n\nPromise.prototype._setFulfilled = function () {\n    this._bitField = this._bitField | 33554432;\n    this._fireEvent(\"promiseFulfilled\", this);\n};\n\nPromise.prototype._setRejected = function () {\n    this._bitField = this._bitField | 16777216;\n    this._fireEvent(\"promiseRejected\", this);\n};\n\nPromise.prototype._setFollowing = function () {\n    this._bitField = this._bitField | 67108864;\n    this._fireEvent(\"promiseResolved\", this);\n};\n\nPromise.prototype._setIsFinal = function () {\n    this._bitField = this._bitField | 4194304;\n};\n\nPromise.prototype._isFinal = function () {\n    return (this._bitField & 4194304) > 0;\n};\n\nPromise.prototype._unsetCancelled = function() {\n    this._bitField = this._bitField & (~65536);\n};\n\nPromise.prototype._setCancelled = function() {\n    this._bitField = this._bitField | 65536;\n    this._fireEvent(\"promiseCancelled\", this);\n};\n\nPromise.prototype._setWillBeCancelled = function() {\n    this._bitField = this._bitField | 8388608;\n};\n\nPromise.prototype._setAsyncGuaranteed = function() {\n    if (async.hasCustomScheduler()) return;\n    this._bitField = this._bitField | 134217728;\n};\n\nPromise.prototype._receiverAt = function (index) {\n    var ret = index === 0 ? this._receiver0 : this[\n            index * 4 - 4 + 3];\n    if (ret === UNDEFINED_BINDING) {\n        return undefined;\n    } else if (ret === undefined && this._isBound()) {\n        return this._boundValue();\n    }\n    return ret;\n};\n\nPromise.prototype._promiseAt = function (index) {\n    return this[\n            index * 4 - 4 + 2];\n};\n\nPromise.prototype._fulfillmentHandlerAt = function (index) {\n    return this[\n            index * 4 - 4 + 0];\n};\n\nPromise.prototype._rejectionHandlerAt = function (index) {\n    return this[\n            index * 4 - 4 + 1];\n};\n\nPromise.prototype._boundValue = function() {};\n\nPromise.prototype._migrateCallback0 = function (follower) {\n    var bitField = follower._bitField;\n    var fulfill = follower._fulfillmentHandler0;\n    var reject = follower._rejectionHandler0;\n    var promise = follower._promise0;\n    var receiver = follower._receiverAt(0);\n    if (receiver === undefined) receiver = UNDEFINED_BINDING;\n    this._addCallbacks(fulfill, reject, promise, receiver, null);\n};\n\nPromise.prototype._migrateCallbackAt = function (follower, index) {\n    var fulfill = follower._fulfillmentHandlerAt(index);\n    var reject = follower._rejectionHandlerAt(index);\n    var promise = follower._promiseAt(index);\n    var receiver = follower._receiverAt(index);\n    if (receiver === undefined) receiver = UNDEFINED_BINDING;\n    this._addCallbacks(fulfill, reject, promise, receiver, null);\n};\n\nPromise.prototype._addCallbacks = function (\n    fulfill,\n    reject,\n    promise,\n    receiver,\n    domain\n) {\n    var index = this._length();\n\n    if (index >= 65535 - 4) {\n        index = 0;\n        this._setLength(0);\n    }\n\n    if (index === 0) {\n        this._promise0 = promise;\n        this._receiver0 = receiver;\n        if (typeof fulfill === \"function\") {\n            this._fulfillmentHandler0 =\n                domain === null ? fulfill : util.domainBind(domain, fulfill);\n        }\n        if (typeof reject === \"function\") {\n            this._rejectionHandler0 =\n                domain === null ? reject : util.domainBind(domain, reject);\n        }\n    } else {\n        var base = index * 4 - 4;\n        this[base + 2] = promise;\n        this[base + 3] = receiver;\n        if (typeof fulfill === \"function\") {\n            this[base + 0] =\n                domain === null ? fulfill : util.domainBind(domain, fulfill);\n        }\n        if (typeof reject === \"function\") {\n            this[base + 1] =\n                domain === null ? reject : util.domainBind(domain, reject);\n        }\n    }\n    this._setLength(index + 1);\n    return index;\n};\n\nPromise.prototype._proxy = function (proxyable, arg) {\n    this._addCallbacks(undefined, undefined, arg, proxyable, null);\n};\n\nPromise.prototype._resolveCallback = function(value, shouldBind) {\n    if (((this._bitField & 117506048) !== 0)) return;\n    if (value === this)\n        return this._rejectCallback(makeSelfResolutionError(), false);\n    var maybePromise = tryConvertToPromise(value, this);\n    if (!(maybePromise instanceof Promise)) return this._fulfill(value);\n\n    if (shouldBind) this._propagateFrom(maybePromise, 2);\n\n    var promise = maybePromise._target();\n\n    if (promise === this) {\n        this._reject(makeSelfResolutionError());\n        return;\n    }\n\n    var bitField = promise._bitField;\n    if (((bitField & 50397184) === 0)) {\n        var len = this._length();\n        if (len > 0) promise._migrateCallback0(this);\n        for (var i = 1; i < len; ++i) {\n            promise._migrateCallbackAt(this, i);\n        }\n        this._setFollowing();\n        this._setLength(0);\n        this._setFollowee(promise);\n    } else if (((bitField & 33554432) !== 0)) {\n        this._fulfill(promise._value());\n    } else if (((bitField & 16777216) !== 0)) {\n        this._reject(promise._reason());\n    } else {\n        var reason = new CancellationError(\"late cancellation observer\");\n        promise._attachExtraTrace(reason);\n        this._reject(reason);\n    }\n};\n\nPromise.prototype._rejectCallback =\nfunction(reason, synchronous, ignoreNonErrorWarnings) {\n    var trace = util.ensureErrorObject(reason);\n    var hasStack = trace === reason;\n    if (!hasStack && !ignoreNonErrorWarnings && debug.warnings()) {\n        var message = \"a promise was rejected with a non-error: \" +\n            util.classString(reason);\n        this._warn(message, true);\n    }\n    this._attachExtraTrace(trace, synchronous ? hasStack : false);\n    this._reject(reason);\n};\n\nPromise.prototype._resolveFromExecutor = function (executor) {\n    if (executor === INTERNAL) return;\n    var promise = this;\n    this._captureStackTrace();\n    this._pushContext();\n    var synchronous = true;\n    var r = this._execute(executor, function(value) {\n        promise._resolveCallback(value);\n    }, function (reason) {\n        promise._rejectCallback(reason, synchronous);\n    });\n    synchronous = false;\n    this._popContext();\n\n    if (r !== undefined) {\n        promise._rejectCallback(r, true);\n    }\n};\n\nPromise.prototype._settlePromiseFromHandler = function (\n    handler, receiver, value, promise\n) {\n    var bitField = promise._bitField;\n    if (((bitField & 65536) !== 0)) return;\n    promise._pushContext();\n    var x;\n    if (receiver === APPLY) {\n        if (!value || typeof value.length !== \"number\") {\n            x = errorObj;\n            x.e = new TypeError(\"cannot .spread() a non-array: \" +\n                                    util.classString(value));\n        } else {\n            x = tryCatch(handler).apply(this._boundValue(), value);\n        }\n    } else {\n        x = tryCatch(handler).call(receiver, value);\n    }\n    var promiseCreated = promise._popContext();\n    bitField = promise._bitField;\n    if (((bitField & 65536) !== 0)) return;\n\n    if (x === NEXT_FILTER) {\n        promise._reject(value);\n    } else if (x === errorObj) {\n        promise._rejectCallback(x.e, false);\n    } else {\n        debug.checkForgottenReturns(x, promiseCreated, \"\",  promise, this);\n        promise._resolveCallback(x);\n    }\n};\n\nPromise.prototype._target = function() {\n    var ret = this;\n    while (ret._isFollowing()) ret = ret._followee();\n    return ret;\n};\n\nPromise.prototype._followee = function() {\n    return this._rejectionHandler0;\n};\n\nPromise.prototype._setFollowee = function(promise) {\n    this._rejectionHandler0 = promise;\n};\n\nPromise.prototype._settlePromise = function(promise, handler, receiver, value) {\n    var isPromise = promise instanceof Promise;\n    var bitField = this._bitField;\n    var asyncGuaranteed = ((bitField & 134217728) !== 0);\n    if (((bitField & 65536) !== 0)) {\n        if (isPromise) promise._invokeInternalOnCancel();\n\n        if (receiver instanceof PassThroughHandlerContext &&\n            receiver.isFinallyHandler()) {\n            receiver.cancelPromise = promise;\n            if (tryCatch(handler).call(receiver, value) === errorObj) {\n                promise._reject(errorObj.e);\n            }\n        } else if (handler === reflectHandler) {\n            promise._fulfill(reflectHandler.call(receiver));\n        } else if (receiver instanceof Proxyable) {\n            receiver._promiseCancelled(promise);\n        } else if (isPromise || promise instanceof PromiseArray) {\n            promise._cancel();\n        } else {\n            receiver.cancel();\n        }\n    } else if (typeof handler === \"function\") {\n        if (!isPromise) {\n            handler.call(receiver, value, promise);\n        } else {\n            if (asyncGuaranteed) promise._setAsyncGuaranteed();\n            this._settlePromiseFromHandler(handler, receiver, value, promise);\n        }\n    } else if (receiver instanceof Proxyable) {\n        if (!receiver._isResolved()) {\n            if (((bitField & 33554432) !== 0)) {\n                receiver._promiseFulfilled(value, promise);\n            } else {\n                receiver._promiseRejected(value, promise);\n            }\n        }\n    } else if (isPromise) {\n        if (asyncGuaranteed) promise._setAsyncGuaranteed();\n        if (((bitField & 33554432) !== 0)) {\n            promise._fulfill(value);\n        } else {\n            promise._reject(value);\n        }\n    }\n};\n\nPromise.prototype._settlePromiseLateCancellationObserver = function(ctx) {\n    var handler = ctx.handler;\n    var promise = ctx.promise;\n    var receiver = ctx.receiver;\n    var value = ctx.value;\n    if (typeof handler === \"function\") {\n        if (!(promise instanceof Promise)) {\n            handler.call(receiver, value, promise);\n        } else {\n            this._settlePromiseFromHandler(handler, receiver, value, promise);\n        }\n    } else if (promise instanceof Promise) {\n        promise._reject(value);\n    }\n};\n\nPromise.prototype._settlePromiseCtx = function(ctx) {\n    this._settlePromise(ctx.promise, ctx.handler, ctx.receiver, ctx.value);\n};\n\nPromise.prototype._settlePromise0 = function(handler, value, bitField) {\n    var promise = this._promise0;\n    var receiver = this._receiverAt(0);\n    this._promise0 = undefined;\n    this._receiver0 = undefined;\n    this._settlePromise(promise, handler, receiver, value);\n};\n\nPromise.prototype._clearCallbackDataAtIndex = function(index) {\n    var base = index * 4 - 4;\n    this[base + 2] =\n    this[base + 3] =\n    this[base + 0] =\n    this[base + 1] = undefined;\n};\n\nPromise.prototype._fulfill = function (value) {\n    var bitField = this._bitField;\n    if (((bitField & 117506048) >>> 16)) return;\n    if (value === this) {\n        var err = makeSelfResolutionError();\n        this._attachExtraTrace(err);\n        return this._reject(err);\n    }\n    this._setFulfilled();\n    this._rejectionHandler0 = value;\n\n    if ((bitField & 65535) > 0) {\n        if (((bitField & 134217728) !== 0)) {\n            this._settlePromises();\n        } else {\n            async.settlePromises(this);\n        }\n    }\n};\n\nPromise.prototype._reject = function (reason) {\n    var bitField = this._bitField;\n    if (((bitField & 117506048) >>> 16)) return;\n    this._setRejected();\n    this._fulfillmentHandler0 = reason;\n\n    if (this._isFinal()) {\n        return async.fatalError(reason, util.isNode);\n    }\n\n    if ((bitField & 65535) > 0) {\n        async.settlePromises(this);\n    } else {\n        this._ensurePossibleRejectionHandled();\n    }\n};\n\nPromise.prototype._fulfillPromises = function (len, value) {\n    for (var i = 1; i < len; i++) {\n        var handler = this._fulfillmentHandlerAt(i);\n        var promise = this._promiseAt(i);\n        var receiver = this._receiverAt(i);\n        this._clearCallbackDataAtIndex(i);\n        this._settlePromise(promise, handler, receiver, value);\n    }\n};\n\nPromise.prototype._rejectPromises = function (len, reason) {\n    for (var i = 1; i < len; i++) {\n        var handler = this._rejectionHandlerAt(i);\n        var promise = this._promiseAt(i);\n        var receiver = this._receiverAt(i);\n        this._clearCallbackDataAtIndex(i);\n        this._settlePromise(promise, handler, receiver, reason);\n    }\n};\n\nPromise.prototype._settlePromises = function () {\n    var bitField = this._bitField;\n    var len = (bitField & 65535);\n\n    if (len > 0) {\n        if (((bitField & 16842752) !== 0)) {\n            var reason = this._fulfillmentHandler0;\n            this._settlePromise0(this._rejectionHandler0, reason, bitField);\n            this._rejectPromises(len, reason);\n        } else {\n            var value = this._rejectionHandler0;\n            this._settlePromise0(this._fulfillmentHandler0, value, bitField);\n            this._fulfillPromises(len, value);\n        }\n        this._setLength(0);\n    }\n    this._clearCancellationData();\n};\n\nPromise.prototype._settledValue = function() {\n    var bitField = this._bitField;\n    if (((bitField & 33554432) !== 0)) {\n        return this._rejectionHandler0;\n    } else if (((bitField & 16777216) !== 0)) {\n        return this._fulfillmentHandler0;\n    }\n};\n\nfunction deferResolve(v) {this.promise._resolveCallback(v);}\nfunction deferReject(v) {this.promise._rejectCallback(v, false);}\n\nPromise.defer = Promise.pending = function() {\n    debug.deprecated(\"Promise.defer\", \"new Promise\");\n    var promise = new Promise(INTERNAL);\n    return {\n        promise: promise,\n        resolve: deferResolve,\n        reject: deferReject\n    };\n};\n\nutil.notEnumerableProp(Promise,\n                       \"_makeSelfResolutionError\",\n                       makeSelfResolutionError);\n\n_dereq_(\"./method\")(Promise, INTERNAL, tryConvertToPromise, apiRejection,\n    debug);\n_dereq_(\"./bind\")(Promise, INTERNAL, tryConvertToPromise, debug);\n_dereq_(\"./cancel\")(Promise, PromiseArray, apiRejection, debug);\n_dereq_(\"./direct_resolve\")(Promise);\n_dereq_(\"./synchronous_inspection\")(Promise);\n_dereq_(\"./join\")(\n    Promise, PromiseArray, tryConvertToPromise, INTERNAL, async, getDomain);\nPromise.Promise = Promise;\nPromise.version = \"3.5.1\";\n_dereq_('./map.js')(Promise, PromiseArray, apiRejection, tryConvertToPromise, INTERNAL, debug);\n_dereq_('./call_get.js')(Promise);\n_dereq_('./using.js')(Promise, apiRejection, tryConvertToPromise, createContext, INTERNAL, debug);\n_dereq_('./timers.js')(Promise, INTERNAL, debug);\n_dereq_('./generators.js')(Promise, apiRejection, INTERNAL, tryConvertToPromise, Proxyable, debug);\n_dereq_('./nodeify.js')(Promise);\n_dereq_('./promisify.js')(Promise, INTERNAL);\n_dereq_('./props.js')(Promise, PromiseArray, tryConvertToPromise, apiRejection);\n_dereq_('./race.js')(Promise, INTERNAL, tryConvertToPromise, apiRejection);\n_dereq_('./reduce.js')(Promise, PromiseArray, apiRejection, tryConvertToPromise, INTERNAL, debug);\n_dereq_('./settle.js')(Promise, PromiseArray, debug);\n_dereq_('./some.js')(Promise, PromiseArray, apiRejection);\n_dereq_('./filter.js')(Promise, INTERNAL);\n_dereq_('./each.js')(Promise, INTERNAL);\n_dereq_('./any.js')(Promise);\n                                                         \n    util.toFastProperties(Promise);                                          \n    util.toFastProperties(Promise.prototype);                                \n    function fillTypes(value) {                                              \n        var p = new Promise(INTERNAL);                                       \n        p._fulfillmentHandler0 = value;                                      \n        p._rejectionHandler0 = value;                                        \n        p._promise0 = value;                                                 \n        p._receiver0 = value;                                                \n    }                                                                        \n    // Complete slack tracking, opt out of field-type tracking and           \n    // stabilize map                                                         \n    fillTypes({a: 1});                                                       \n    fillTypes({b: 2});                                                       \n    fillTypes({c: 3});                                                       \n    fillTypes(1);                                                            \n    fillTypes(function(){});                                                 \n    fillTypes(undefined);                                                    \n    fillTypes(false);                                                        \n    fillTypes(new Promise(INTERNAL));                                        \n    debug.setBounds(Async.firstLineError, util.lastLineError);               \n    return Promise;                                                          \n\n};\n\n},{\"./any.js\":1,\"./async\":2,\"./bind\":3,\"./call_get.js\":5,\"./cancel\":6,\"./catch_filter\":7,\"./context\":8,\"./debuggability\":9,\"./direct_resolve\":10,\"./each.js\":11,\"./errors\":12,\"./es5\":13,\"./filter.js\":14,\"./finally\":15,\"./generators.js\":16,\"./join\":17,\"./map.js\":18,\"./method\":19,\"./nodeback\":20,\"./nodeify.js\":21,\"./promise_array\":23,\"./promisify.js\":24,\"./props.js\":25,\"./race.js\":27,\"./reduce.js\":28,\"./settle.js\":30,\"./some.js\":31,\"./synchronous_inspection\":32,\"./thenables\":33,\"./timers.js\":34,\"./using.js\":35,\"./util\":36}],23:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise, INTERNAL, tryConvertToPromise,\n    apiRejection, Proxyable) {\nvar util = _dereq_(\"./util\");\nvar isArray = util.isArray;\n\nfunction toResolutionValue(val) {\n    switch(val) {\n    case -2: return [];\n    case -3: return {};\n    case -6: return new Map();\n    }\n}\n\nfunction PromiseArray(values) {\n    var promise = this._promise = new Promise(INTERNAL);\n    if (values instanceof Promise) {\n        promise._propagateFrom(values, 3);\n    }\n    promise._setOnCancel(this);\n    this._values = values;\n    this._length = 0;\n    this._totalResolved = 0;\n    this._init(undefined, -2);\n}\nutil.inherits(PromiseArray, Proxyable);\n\nPromiseArray.prototype.length = function () {\n    return this._length;\n};\n\nPromiseArray.prototype.promise = function () {\n    return this._promise;\n};\n\nPromiseArray.prototype._init = function init(_, resolveValueIfEmpty) {\n    var values = tryConvertToPromise(this._values, this._promise);\n    if (values instanceof Promise) {\n        values = values._target();\n        var bitField = values._bitField;\n        ;\n        this._values = values;\n\n        if (((bitField & 50397184) === 0)) {\n            this._promise._setAsyncGuaranteed();\n            return values._then(\n                init,\n                this._reject,\n                undefined,\n                this,\n                resolveValueIfEmpty\n           );\n        } else if (((bitField & 33554432) !== 0)) {\n            values = values._value();\n        } else if (((bitField & 16777216) !== 0)) {\n            return this._reject(values._reason());\n        } else {\n            return this._cancel();\n        }\n    }\n    values = util.asArray(values);\n    if (values === null) {\n        var err = apiRejection(\n            \"expecting an array or an iterable object but got \" + util.classString(values)).reason();\n        this._promise._rejectCallback(err, false);\n        return;\n    }\n\n    if (values.length === 0) {\n        if (resolveValueIfEmpty === -5) {\n            this._resolveEmptyArray();\n        }\n        else {\n            this._resolve(toResolutionValue(resolveValueIfEmpty));\n        }\n        return;\n    }\n    this._iterate(values);\n};\n\nPromiseArray.prototype._iterate = function(values) {\n    var len = this.getActualLength(values.length);\n    this._length = len;\n    this._values = this.shouldCopyValues() ? new Array(len) : this._values;\n    var result = this._promise;\n    var isResolved = false;\n    var bitField = null;\n    for (var i = 0; i < len; ++i) {\n        var maybePromise = tryConvertToPromise(values[i], result);\n\n        if (maybePromise instanceof Promise) {\n            maybePromise = maybePromise._target();\n            bitField = maybePromise._bitField;\n        } else {\n            bitField = null;\n        }\n\n        if (isResolved) {\n            if (bitField !== null) {\n                maybePromise.suppressUnhandledRejections();\n            }\n        } else if (bitField !== null) {\n            if (((bitField & 50397184) === 0)) {\n                maybePromise._proxy(this, i);\n                this._values[i] = maybePromise;\n            } else if (((bitField & 33554432) !== 0)) {\n                isResolved = this._promiseFulfilled(maybePromise._value(), i);\n            } else if (((bitField & 16777216) !== 0)) {\n                isResolved = this._promiseRejected(maybePromise._reason(), i);\n            } else {\n                isResolved = this._promiseCancelled(i);\n            }\n        } else {\n            isResolved = this._promiseFulfilled(maybePromise, i);\n        }\n    }\n    if (!isResolved) result._setAsyncGuaranteed();\n};\n\nPromiseArray.prototype._isResolved = function () {\n    return this._values === null;\n};\n\nPromiseArray.prototype._resolve = function (value) {\n    this._values = null;\n    this._promise._fulfill(value);\n};\n\nPromiseArray.prototype._cancel = function() {\n    if (this._isResolved() || !this._promise._isCancellable()) return;\n    this._values = null;\n    this._promise._cancel();\n};\n\nPromiseArray.prototype._reject = function (reason) {\n    this._values = null;\n    this._promise._rejectCallback(reason, false);\n};\n\nPromiseArray.prototype._promiseFulfilled = function (value, index) {\n    this._values[index] = value;\n    var totalResolved = ++this._totalResolved;\n    if (totalResolved >= this._length) {\n        this._resolve(this._values);\n        return true;\n    }\n    return false;\n};\n\nPromiseArray.prototype._promiseCancelled = function() {\n    this._cancel();\n    return true;\n};\n\nPromiseArray.prototype._promiseRejected = function (reason) {\n    this._totalResolved++;\n    this._reject(reason);\n    return true;\n};\n\nPromiseArray.prototype._resultCancelled = function() {\n    if (this._isResolved()) return;\n    var values = this._values;\n    this._cancel();\n    if (values instanceof Promise) {\n        values.cancel();\n    } else {\n        for (var i = 0; i < values.length; ++i) {\n            if (values[i] instanceof Promise) {\n                values[i].cancel();\n            }\n        }\n    }\n};\n\nPromiseArray.prototype.shouldCopyValues = function () {\n    return true;\n};\n\nPromiseArray.prototype.getActualLength = function (len) {\n    return len;\n};\n\nreturn PromiseArray;\n};\n\n},{\"./util\":36}],24:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise, INTERNAL) {\nvar THIS = {};\nvar util = _dereq_(\"./util\");\nvar nodebackForPromise = _dereq_(\"./nodeback\");\nvar withAppended = util.withAppended;\nvar maybeWrapAsError = util.maybeWrapAsError;\nvar canEvaluate = util.canEvaluate;\nvar TypeError = _dereq_(\"./errors\").TypeError;\nvar defaultSuffix = \"Async\";\nvar defaultPromisified = {__isPromisified__: true};\nvar noCopyProps = [\n    \"arity\",    \"length\",\n    \"name\",\n    \"arguments\",\n    \"caller\",\n    \"callee\",\n    \"prototype\",\n    \"__isPromisified__\"\n];\nvar noCopyPropsPattern = new RegExp(\"^(?:\" + noCopyProps.join(\"|\") + \")$\");\n\nvar defaultFilter = function(name) {\n    return util.isIdentifier(name) &&\n        name.charAt(0) !== \"_\" &&\n        name !== \"constructor\";\n};\n\nfunction propsFilter(key) {\n    return !noCopyPropsPattern.test(key);\n}\n\nfunction isPromisified(fn) {\n    try {\n        return fn.__isPromisified__ === true;\n    }\n    catch (e) {\n        return false;\n    }\n}\n\nfunction hasPromisified(obj, key, suffix) {\n    var val = util.getDataPropertyOrDefault(obj, key + suffix,\n                                            defaultPromisified);\n    return val ? isPromisified(val) : false;\n}\nfunction checkValid(ret, suffix, suffixRegexp) {\n    for (var i = 0; i < ret.length; i += 2) {\n        var key = ret[i];\n        if (suffixRegexp.test(key)) {\n            var keyWithoutAsyncSuffix = key.replace(suffixRegexp, \"\");\n            for (var j = 0; j < ret.length; j += 2) {\n                if (ret[j] === keyWithoutAsyncSuffix) {\n                    throw new TypeError(\"Cannot promisify an API that has normal methods with '%s'-suffix\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\"\n                        .replace(\"%s\", suffix));\n                }\n            }\n        }\n    }\n}\n\nfunction promisifiableMethods(obj, suffix, suffixRegexp, filter) {\n    var keys = util.inheritedDataKeys(obj);\n    var ret = [];\n    for (var i = 0; i < keys.length; ++i) {\n        var key = keys[i];\n        var value = obj[key];\n        var passesDefaultFilter = filter === defaultFilter\n            ? true : defaultFilter(key, value, obj);\n        if (typeof value === \"function\" &&\n            !isPromisified(value) &&\n            !hasPromisified(obj, key, suffix) &&\n            filter(key, value, obj, passesDefaultFilter)) {\n            ret.push(key, value);\n        }\n    }\n    checkValid(ret, suffix, suffixRegexp);\n    return ret;\n}\n\nvar escapeIdentRegex = function(str) {\n    return str.replace(/([$])/, \"\\\\$\");\n};\n\nvar makeNodePromisifiedEval;\nif (!true) {\nvar switchCaseArgumentOrder = function(likelyArgumentCount) {\n    var ret = [likelyArgumentCount];\n    var min = Math.max(0, likelyArgumentCount - 1 - 3);\n    for(var i = likelyArgumentCount - 1; i >= min; --i) {\n        ret.push(i);\n    }\n    for(var i = likelyArgumentCount + 1; i <= 3; ++i) {\n        ret.push(i);\n    }\n    return ret;\n};\n\nvar argumentSequence = function(argumentCount) {\n    return util.filledRange(argumentCount, \"_arg\", \"\");\n};\n\nvar parameterDeclaration = function(parameterCount) {\n    return util.filledRange(\n        Math.max(parameterCount, 3), \"_arg\", \"\");\n};\n\nvar parameterCount = function(fn) {\n    if (typeof fn.length === \"number\") {\n        return Math.max(Math.min(fn.length, 1023 + 1), 0);\n    }\n    return 0;\n};\n\nmakeNodePromisifiedEval =\nfunction(callback, receiver, originalName, fn, _, multiArgs) {\n    var newParameterCount = Math.max(0, parameterCount(fn) - 1);\n    var argumentOrder = switchCaseArgumentOrder(newParameterCount);\n    var shouldProxyThis = typeof callback === \"string\" || receiver === THIS;\n\n    function generateCallForArgumentCount(count) {\n        var args = argumentSequence(count).join(\", \");\n        var comma = count > 0 ? \", \" : \"\";\n        var ret;\n        if (shouldProxyThis) {\n            ret = \"ret = callback.call(this, {{args}}, nodeback); break;\\n\";\n        } else {\n            ret = receiver === undefined\n                ? \"ret = callback({{args}}, nodeback); break;\\n\"\n                : \"ret = callback.call(receiver, {{args}}, nodeback); break;\\n\";\n        }\n        return ret.replace(\"{{args}}\", args).replace(\", \", comma);\n    }\n\n    function generateArgumentSwitchCase() {\n        var ret = \"\";\n        for (var i = 0; i < argumentOrder.length; ++i) {\n            ret += \"case \" + argumentOrder[i] +\":\" +\n                generateCallForArgumentCount(argumentOrder[i]);\n        }\n\n        ret += \"                                                             \\n\\\n        default:                                                             \\n\\\n            var args = new Array(len + 1);                                   \\n\\\n            var i = 0;                                                       \\n\\\n            for (var i = 0; i < len; ++i) {                                  \\n\\\n               args[i] = arguments[i];                                       \\n\\\n            }                                                                \\n\\\n            args[i] = nodeback;                                              \\n\\\n            [CodeForCall]                                                    \\n\\\n            break;                                                           \\n\\\n        \".replace(\"[CodeForCall]\", (shouldProxyThis\n                                ? \"ret = callback.apply(this, args);\\n\"\n                                : \"ret = callback.apply(receiver, args);\\n\"));\n        return ret;\n    }\n\n    var getFunctionCode = typeof callback === \"string\"\n                                ? (\"this != null ? this['\"+callback+\"'] : fn\")\n                                : \"fn\";\n    var body = \"'use strict';                                                \\n\\\n        var ret = function (Parameters) {                                    \\n\\\n            'use strict';                                                    \\n\\\n            var len = arguments.length;                                      \\n\\\n            var promise = new Promise(INTERNAL);                             \\n\\\n            promise._captureStackTrace();                                    \\n\\\n            var nodeback = nodebackForPromise(promise, \" + multiArgs + \");   \\n\\\n            var ret;                                                         \\n\\\n            var callback = tryCatch([GetFunctionCode]);                      \\n\\\n            switch(len) {                                                    \\n\\\n                [CodeForSwitchCase]                                          \\n\\\n            }                                                                \\n\\\n            if (ret === errorObj) {                                          \\n\\\n                promise._rejectCallback(maybeWrapAsError(ret.e), true, true);\\n\\\n            }                                                                \\n\\\n            if (!promise._isFateSealed()) promise._setAsyncGuaranteed();     \\n\\\n            return promise;                                                  \\n\\\n        };                                                                   \\n\\\n        notEnumerableProp(ret, '__isPromisified__', true);                   \\n\\\n        return ret;                                                          \\n\\\n    \".replace(\"[CodeForSwitchCase]\", generateArgumentSwitchCase())\n        .replace(\"[GetFunctionCode]\", getFunctionCode);\n    body = body.replace(\"Parameters\", parameterDeclaration(newParameterCount));\n    return new Function(\"Promise\",\n                        \"fn\",\n                        \"receiver\",\n                        \"withAppended\",\n                        \"maybeWrapAsError\",\n                        \"nodebackForPromise\",\n                        \"tryCatch\",\n                        \"errorObj\",\n                        \"notEnumerableProp\",\n                        \"INTERNAL\",\n                        body)(\n                    Promise,\n                    fn,\n                    receiver,\n                    withAppended,\n                    maybeWrapAsError,\n                    nodebackForPromise,\n                    util.tryCatch,\n                    util.errorObj,\n                    util.notEnumerableProp,\n                    INTERNAL);\n};\n}\n\nfunction makeNodePromisifiedClosure(callback, receiver, _, fn, __, multiArgs) {\n    var defaultThis = (function() {return this;})();\n    var method = callback;\n    if (typeof method === \"string\") {\n        callback = fn;\n    }\n    function promisified() {\n        var _receiver = receiver;\n        if (receiver === THIS) _receiver = this;\n        var promise = new Promise(INTERNAL);\n        promise._captureStackTrace();\n        var cb = typeof method === \"string\" && this !== defaultThis\n            ? this[method] : callback;\n        var fn = nodebackForPromise(promise, multiArgs);\n        try {\n            cb.apply(_receiver, withAppended(arguments, fn));\n        } catch(e) {\n            promise._rejectCallback(maybeWrapAsError(e), true, true);\n        }\n        if (!promise._isFateSealed()) promise._setAsyncGuaranteed();\n        return promise;\n    }\n    util.notEnumerableProp(promisified, \"__isPromisified__\", true);\n    return promisified;\n}\n\nvar makeNodePromisified = canEvaluate\n    ? makeNodePromisifiedEval\n    : makeNodePromisifiedClosure;\n\nfunction promisifyAll(obj, suffix, filter, promisifier, multiArgs) {\n    var suffixRegexp = new RegExp(escapeIdentRegex(suffix) + \"$\");\n    var methods =\n        promisifiableMethods(obj, suffix, suffixRegexp, filter);\n\n    for (var i = 0, len = methods.length; i < len; i+= 2) {\n        var key = methods[i];\n        var fn = methods[i+1];\n        var promisifiedKey = key + suffix;\n        if (promisifier === makeNodePromisified) {\n            obj[promisifiedKey] =\n                makeNodePromisified(key, THIS, key, fn, suffix, multiArgs);\n        } else {\n            var promisified = promisifier(fn, function() {\n                return makeNodePromisified(key, THIS, key,\n                                           fn, suffix, multiArgs);\n            });\n            util.notEnumerableProp(promisified, \"__isPromisified__\", true);\n            obj[promisifiedKey] = promisified;\n        }\n    }\n    util.toFastProperties(obj);\n    return obj;\n}\n\nfunction promisify(callback, receiver, multiArgs) {\n    return makeNodePromisified(callback, receiver, undefined,\n                                callback, null, multiArgs);\n}\n\nPromise.promisify = function (fn, options) {\n    if (typeof fn !== \"function\") {\n        throw new TypeError(\"expecting a function but got \" + util.classString(fn));\n    }\n    if (isPromisified(fn)) {\n        return fn;\n    }\n    options = Object(options);\n    var receiver = options.context === undefined ? THIS : options.context;\n    var multiArgs = !!options.multiArgs;\n    var ret = promisify(fn, receiver, multiArgs);\n    util.copyDescriptors(fn, ret, propsFilter);\n    return ret;\n};\n\nPromise.promisifyAll = function (target, options) {\n    if (typeof target !== \"function\" && typeof target !== \"object\") {\n        throw new TypeError(\"the target of promisifyAll must be an object or a function\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n    options = Object(options);\n    var multiArgs = !!options.multiArgs;\n    var suffix = options.suffix;\n    if (typeof suffix !== \"string\") suffix = defaultSuffix;\n    var filter = options.filter;\n    if (typeof filter !== \"function\") filter = defaultFilter;\n    var promisifier = options.promisifier;\n    if (typeof promisifier !== \"function\") promisifier = makeNodePromisified;\n\n    if (!util.isIdentifier(suffix)) {\n        throw new RangeError(\"suffix must be a valid identifier\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n\n    var keys = util.inheritedDataKeys(target);\n    for (var i = 0; i < keys.length; ++i) {\n        var value = target[keys[i]];\n        if (keys[i] !== \"constructor\" &&\n            util.isClass(value)) {\n            promisifyAll(value.prototype, suffix, filter, promisifier,\n                multiArgs);\n            promisifyAll(value, suffix, filter, promisifier, multiArgs);\n        }\n    }\n\n    return promisifyAll(target, suffix, filter, promisifier, multiArgs);\n};\n};\n\n\n},{\"./errors\":12,\"./nodeback\":20,\"./util\":36}],25:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(\n    Promise, PromiseArray, tryConvertToPromise, apiRejection) {\nvar util = _dereq_(\"./util\");\nvar isObject = util.isObject;\nvar es5 = _dereq_(\"./es5\");\nvar Es6Map;\nif (typeof Map === \"function\") Es6Map = Map;\n\nvar mapToEntries = (function() {\n    var index = 0;\n    var size = 0;\n\n    function extractEntry(value, key) {\n        this[index] = value;\n        this[index + size] = key;\n        index++;\n    }\n\n    return function mapToEntries(map) {\n        size = map.size;\n        index = 0;\n        var ret = new Array(map.size * 2);\n        map.forEach(extractEntry, ret);\n        return ret;\n    };\n})();\n\nvar entriesToMap = function(entries) {\n    var ret = new Es6Map();\n    var length = entries.length / 2 | 0;\n    for (var i = 0; i < length; ++i) {\n        var key = entries[length + i];\n        var value = entries[i];\n        ret.set(key, value);\n    }\n    return ret;\n};\n\nfunction PropertiesPromiseArray(obj) {\n    var isMap = false;\n    var entries;\n    if (Es6Map !== undefined && obj instanceof Es6Map) {\n        entries = mapToEntries(obj);\n        isMap = true;\n    } else {\n        var keys = es5.keys(obj);\n        var len = keys.length;\n        entries = new Array(len * 2);\n        for (var i = 0; i < len; ++i) {\n            var key = keys[i];\n            entries[i] = obj[key];\n            entries[i + len] = key;\n        }\n    }\n    this.constructor$(entries);\n    this._isMap = isMap;\n    this._init$(undefined, isMap ? -6 : -3);\n}\nutil.inherits(PropertiesPromiseArray, PromiseArray);\n\nPropertiesPromiseArray.prototype._init = function () {};\n\nPropertiesPromiseArray.prototype._promiseFulfilled = function (value, index) {\n    this._values[index] = value;\n    var totalResolved = ++this._totalResolved;\n    if (totalResolved >= this._length) {\n        var val;\n        if (this._isMap) {\n            val = entriesToMap(this._values);\n        } else {\n            val = {};\n            var keyOffset = this.length();\n            for (var i = 0, len = this.length(); i < len; ++i) {\n                val[this._values[i + keyOffset]] = this._values[i];\n            }\n        }\n        this._resolve(val);\n        return true;\n    }\n    return false;\n};\n\nPropertiesPromiseArray.prototype.shouldCopyValues = function () {\n    return false;\n};\n\nPropertiesPromiseArray.prototype.getActualLength = function (len) {\n    return len >> 1;\n};\n\nfunction props(promises) {\n    var ret;\n    var castValue = tryConvertToPromise(promises);\n\n    if (!isObject(castValue)) {\n        return apiRejection(\"cannot await properties of a non-object\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    } else if (castValue instanceof Promise) {\n        ret = castValue._then(\n            Promise.props, undefined, undefined, undefined, undefined);\n    } else {\n        ret = new PropertiesPromiseArray(castValue).promise();\n    }\n\n    if (castValue instanceof Promise) {\n        ret._propagateFrom(castValue, 2);\n    }\n    return ret;\n}\n\nPromise.prototype.props = function () {\n    return props(this);\n};\n\nPromise.props = function (promises) {\n    return props(promises);\n};\n};\n\n},{\"./es5\":13,\"./util\":36}],26:[function(_dereq_,module,exports){\n\"use strict\";\nfunction arrayMove(src, srcIndex, dst, dstIndex, len) {\n    for (var j = 0; j < len; ++j) {\n        dst[j + dstIndex] = src[j + srcIndex];\n        src[j + srcIndex] = void 0;\n    }\n}\n\nfunction Queue(capacity) {\n    this._capacity = capacity;\n    this._length = 0;\n    this._front = 0;\n}\n\nQueue.prototype._willBeOverCapacity = function (size) {\n    return this._capacity < size;\n};\n\nQueue.prototype._pushOne = function (arg) {\n    var length = this.length();\n    this._checkCapacity(length + 1);\n    var i = (this._front + length) & (this._capacity - 1);\n    this[i] = arg;\n    this._length = length + 1;\n};\n\nQueue.prototype.push = function (fn, receiver, arg) {\n    var length = this.length() + 3;\n    if (this._willBeOverCapacity(length)) {\n        this._pushOne(fn);\n        this._pushOne(receiver);\n        this._pushOne(arg);\n        return;\n    }\n    var j = this._front + length - 3;\n    this._checkCapacity(length);\n    var wrapMask = this._capacity - 1;\n    this[(j + 0) & wrapMask] = fn;\n    this[(j + 1) & wrapMask] = receiver;\n    this[(j + 2) & wrapMask] = arg;\n    this._length = length;\n};\n\nQueue.prototype.shift = function () {\n    var front = this._front,\n        ret = this[front];\n\n    this[front] = undefined;\n    this._front = (front + 1) & (this._capacity - 1);\n    this._length--;\n    return ret;\n};\n\nQueue.prototype.length = function () {\n    return this._length;\n};\n\nQueue.prototype._checkCapacity = function (size) {\n    if (this._capacity < size) {\n        this._resizeTo(this._capacity << 1);\n    }\n};\n\nQueue.prototype._resizeTo = function (capacity) {\n    var oldCapacity = this._capacity;\n    this._capacity = capacity;\n    var front = this._front;\n    var length = this._length;\n    var moveItemsCount = (front + length) & (oldCapacity - 1);\n    arrayMove(this, 0, this, oldCapacity, moveItemsCount);\n};\n\nmodule.exports = Queue;\n\n},{}],27:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(\n    Promise, INTERNAL, tryConvertToPromise, apiRejection) {\nvar util = _dereq_(\"./util\");\n\nvar raceLater = function (promise) {\n    return promise.then(function(array) {\n        return race(array, promise);\n    });\n};\n\nfunction race(promises, parent) {\n    var maybePromise = tryConvertToPromise(promises);\n\n    if (maybePromise instanceof Promise) {\n        return raceLater(maybePromise);\n    } else {\n        promises = util.asArray(promises);\n        if (promises === null)\n            return apiRejection(\"expecting an array or an iterable object but got \" + util.classString(promises));\n    }\n\n    var ret = new Promise(INTERNAL);\n    if (parent !== undefined) {\n        ret._propagateFrom(parent, 3);\n    }\n    var fulfill = ret._fulfill;\n    var reject = ret._reject;\n    for (var i = 0, len = promises.length; i < len; ++i) {\n        var val = promises[i];\n\n        if (val === undefined && !(i in promises)) {\n            continue;\n        }\n\n        Promise.cast(val)._then(fulfill, reject, undefined, ret, null);\n    }\n    return ret;\n}\n\nPromise.race = function (promises) {\n    return race(promises, undefined);\n};\n\nPromise.prototype.race = function () {\n    return race(this, undefined);\n};\n\n};\n\n},{\"./util\":36}],28:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise,\n                          PromiseArray,\n                          apiRejection,\n                          tryConvertToPromise,\n                          INTERNAL,\n                          debug) {\nvar getDomain = Promise._getDomain;\nvar util = _dereq_(\"./util\");\nvar tryCatch = util.tryCatch;\n\nfunction ReductionPromiseArray(promises, fn, initialValue, _each) {\n    this.constructor$(promises);\n    var domain = getDomain();\n    this._fn = domain === null ? fn : util.domainBind(domain, fn);\n    if (initialValue !== undefined) {\n        initialValue = Promise.resolve(initialValue);\n        initialValue._attachCancellationCallback(this);\n    }\n    this._initialValue = initialValue;\n    this._currentCancellable = null;\n    if(_each === INTERNAL) {\n        this._eachValues = Array(this._length);\n    } else if (_each === 0) {\n        this._eachValues = null;\n    } else {\n        this._eachValues = undefined;\n    }\n    this._promise._captureStackTrace();\n    this._init$(undefined, -5);\n}\nutil.inherits(ReductionPromiseArray, PromiseArray);\n\nReductionPromiseArray.prototype._gotAccum = function(accum) {\n    if (this._eachValues !== undefined && \n        this._eachValues !== null && \n        accum !== INTERNAL) {\n        this._eachValues.push(accum);\n    }\n};\n\nReductionPromiseArray.prototype._eachComplete = function(value) {\n    if (this._eachValues !== null) {\n        this._eachValues.push(value);\n    }\n    return this._eachValues;\n};\n\nReductionPromiseArray.prototype._init = function() {};\n\nReductionPromiseArray.prototype._resolveEmptyArray = function() {\n    this._resolve(this._eachValues !== undefined ? this._eachValues\n                                                 : this._initialValue);\n};\n\nReductionPromiseArray.prototype.shouldCopyValues = function () {\n    return false;\n};\n\nReductionPromiseArray.prototype._resolve = function(value) {\n    this._promise._resolveCallback(value);\n    this._values = null;\n};\n\nReductionPromiseArray.prototype._resultCancelled = function(sender) {\n    if (sender === this._initialValue) return this._cancel();\n    if (this._isResolved()) return;\n    this._resultCancelled$();\n    if (this._currentCancellable instanceof Promise) {\n        this._currentCancellable.cancel();\n    }\n    if (this._initialValue instanceof Promise) {\n        this._initialValue.cancel();\n    }\n};\n\nReductionPromiseArray.prototype._iterate = function (values) {\n    this._values = values;\n    var value;\n    var i;\n    var length = values.length;\n    if (this._initialValue !== undefined) {\n        value = this._initialValue;\n        i = 0;\n    } else {\n        value = Promise.resolve(values[0]);\n        i = 1;\n    }\n\n    this._currentCancellable = value;\n\n    if (!value.isRejected()) {\n        for (; i < length; ++i) {\n            var ctx = {\n                accum: null,\n                value: values[i],\n                index: i,\n                length: length,\n                array: this\n            };\n            value = value._then(gotAccum, undefined, undefined, ctx, undefined);\n        }\n    }\n\n    if (this._eachValues !== undefined) {\n        value = value\n            ._then(this._eachComplete, undefined, undefined, this, undefined);\n    }\n    value._then(completed, completed, undefined, value, this);\n};\n\nPromise.prototype.reduce = function (fn, initialValue) {\n    return reduce(this, fn, initialValue, null);\n};\n\nPromise.reduce = function (promises, fn, initialValue, _each) {\n    return reduce(promises, fn, initialValue, _each);\n};\n\nfunction completed(valueOrReason, array) {\n    if (this.isFulfilled()) {\n        array._resolve(valueOrReason);\n    } else {\n        array._reject(valueOrReason);\n    }\n}\n\nfunction reduce(promises, fn, initialValue, _each) {\n    if (typeof fn !== \"function\") {\n        return apiRejection(\"expecting a function but got \" + util.classString(fn));\n    }\n    var array = new ReductionPromiseArray(promises, fn, initialValue, _each);\n    return array.promise();\n}\n\nfunction gotAccum(accum) {\n    this.accum = accum;\n    this.array._gotAccum(accum);\n    var value = tryConvertToPromise(this.value, this.array._promise);\n    if (value instanceof Promise) {\n        this.array._currentCancellable = value;\n        return value._then(gotValue, undefined, undefined, this, undefined);\n    } else {\n        return gotValue.call(this, value);\n    }\n}\n\nfunction gotValue(value) {\n    var array = this.array;\n    var promise = array._promise;\n    var fn = tryCatch(array._fn);\n    promise._pushContext();\n    var ret;\n    if (array._eachValues !== undefined) {\n        ret = fn.call(promise._boundValue(), value, this.index, this.length);\n    } else {\n        ret = fn.call(promise._boundValue(),\n                              this.accum, value, this.index, this.length);\n    }\n    if (ret instanceof Promise) {\n        array._currentCancellable = ret;\n    }\n    var promiseCreated = promise._popContext();\n    debug.checkForgottenReturns(\n        ret,\n        promiseCreated,\n        array._eachValues !== undefined ? \"Promise.each\" : \"Promise.reduce\",\n        promise\n    );\n    return ret;\n}\n};\n\n},{\"./util\":36}],29:[function(_dereq_,module,exports){\n\"use strict\";\nvar util = _dereq_(\"./util\");\nvar schedule;\nvar noAsyncScheduler = function() {\n    throw new Error(\"No async scheduler available\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n};\nvar NativePromise = util.getNativePromise();\nif (util.isNode && typeof MutationObserver === \"undefined\") {\n    var GlobalSetImmediate = global.setImmediate;\n    var ProcessNextTick = process.nextTick;\n    schedule = util.isRecentNode\n                ? function(fn) { GlobalSetImmediate.call(global, fn); }\n                : function(fn) { ProcessNextTick.call(process, fn); };\n} else if (typeof NativePromise === \"function\" &&\n           typeof NativePromise.resolve === \"function\") {\n    var nativePromise = NativePromise.resolve();\n    schedule = function(fn) {\n        nativePromise.then(fn);\n    };\n} else if ((typeof MutationObserver !== \"undefined\") &&\n          !(typeof window !== \"undefined\" &&\n            window.navigator &&\n            (window.navigator.standalone || window.cordova))) {\n    schedule = (function() {\n        var div = document.createElement(\"div\");\n        var opts = {attributes: true};\n        var toggleScheduled = false;\n        var div2 = document.createElement(\"div\");\n        var o2 = new MutationObserver(function() {\n            div.classList.toggle(\"foo\");\n            toggleScheduled = false;\n        });\n        o2.observe(div2, opts);\n\n        var scheduleToggle = function() {\n            if (toggleScheduled) return;\n            toggleScheduled = true;\n            div2.classList.toggle(\"foo\");\n        };\n\n        return function schedule(fn) {\n            var o = new MutationObserver(function() {\n                o.disconnect();\n                fn();\n            });\n            o.observe(div, opts);\n            scheduleToggle();\n        };\n    })();\n} else if (typeof setImmediate !== \"undefined\") {\n    schedule = function (fn) {\n        setImmediate(fn);\n    };\n} else if (typeof setTimeout !== \"undefined\") {\n    schedule = function (fn) {\n        setTimeout(fn, 0);\n    };\n} else {\n    schedule = noAsyncScheduler;\n}\nmodule.exports = schedule;\n\n},{\"./util\":36}],30:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports =\n    function(Promise, PromiseArray, debug) {\nvar PromiseInspection = Promise.PromiseInspection;\nvar util = _dereq_(\"./util\");\n\nfunction SettledPromiseArray(values) {\n    this.constructor$(values);\n}\nutil.inherits(SettledPromiseArray, PromiseArray);\n\nSettledPromiseArray.prototype._promiseResolved = function (index, inspection) {\n    this._values[index] = inspection;\n    var totalResolved = ++this._totalResolved;\n    if (totalResolved >= this._length) {\n        this._resolve(this._values);\n        return true;\n    }\n    return false;\n};\n\nSettledPromiseArray.prototype._promiseFulfilled = function (value, index) {\n    var ret = new PromiseInspection();\n    ret._bitField = 33554432;\n    ret._settledValueField = value;\n    return this._promiseResolved(index, ret);\n};\nSettledPromiseArray.prototype._promiseRejected = function (reason, index) {\n    var ret = new PromiseInspection();\n    ret._bitField = 16777216;\n    ret._settledValueField = reason;\n    return this._promiseResolved(index, ret);\n};\n\nPromise.settle = function (promises) {\n    debug.deprecated(\".settle()\", \".reflect()\");\n    return new SettledPromiseArray(promises).promise();\n};\n\nPromise.prototype.settle = function () {\n    return Promise.settle(this);\n};\n};\n\n},{\"./util\":36}],31:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports =\nfunction(Promise, PromiseArray, apiRejection) {\nvar util = _dereq_(\"./util\");\nvar RangeError = _dereq_(\"./errors\").RangeError;\nvar AggregateError = _dereq_(\"./errors\").AggregateError;\nvar isArray = util.isArray;\nvar CANCELLATION = {};\n\n\nfunction SomePromiseArray(values) {\n    this.constructor$(values);\n    this._howMany = 0;\n    this._unwrap = false;\n    this._initialized = false;\n}\nutil.inherits(SomePromiseArray, PromiseArray);\n\nSomePromiseArray.prototype._init = function () {\n    if (!this._initialized) {\n        return;\n    }\n    if (this._howMany === 0) {\n        this._resolve([]);\n        return;\n    }\n    this._init$(undefined, -5);\n    var isArrayResolved = isArray(this._values);\n    if (!this._isResolved() &&\n        isArrayResolved &&\n        this._howMany > this._canPossiblyFulfill()) {\n        this._reject(this._getRangeError(this.length()));\n    }\n};\n\nSomePromiseArray.prototype.init = function () {\n    this._initialized = true;\n    this._init();\n};\n\nSomePromiseArray.prototype.setUnwrap = function () {\n    this._unwrap = true;\n};\n\nSomePromiseArray.prototype.howMany = function () {\n    return this._howMany;\n};\n\nSomePromiseArray.prototype.setHowMany = function (count) {\n    this._howMany = count;\n};\n\nSomePromiseArray.prototype._promiseFulfilled = function (value) {\n    this._addFulfilled(value);\n    if (this._fulfilled() === this.howMany()) {\n        this._values.length = this.howMany();\n        if (this.howMany() === 1 && this._unwrap) {\n            this._resolve(this._values[0]);\n        } else {\n            this._resolve(this._values);\n        }\n        return true;\n    }\n    return false;\n\n};\nSomePromiseArray.prototype._promiseRejected = function (reason) {\n    this._addRejected(reason);\n    return this._checkOutcome();\n};\n\nSomePromiseArray.prototype._promiseCancelled = function () {\n    if (this._values instanceof Promise || this._values == null) {\n        return this._cancel();\n    }\n    this._addRejected(CANCELLATION);\n    return this._checkOutcome();\n};\n\nSomePromiseArray.prototype._checkOutcome = function() {\n    if (this.howMany() > this._canPossiblyFulfill()) {\n        var e = new AggregateError();\n        for (var i = this.length(); i < this._values.length; ++i) {\n            if (this._values[i] !== CANCELLATION) {\n                e.push(this._values[i]);\n            }\n        }\n        if (e.length > 0) {\n            this._reject(e);\n        } else {\n            this._cancel();\n        }\n        return true;\n    }\n    return false;\n};\n\nSomePromiseArray.prototype._fulfilled = function () {\n    return this._totalResolved;\n};\n\nSomePromiseArray.prototype._rejected = function () {\n    return this._values.length - this.length();\n};\n\nSomePromiseArray.prototype._addRejected = function (reason) {\n    this._values.push(reason);\n};\n\nSomePromiseArray.prototype._addFulfilled = function (value) {\n    this._values[this._totalResolved++] = value;\n};\n\nSomePromiseArray.prototype._canPossiblyFulfill = function () {\n    return this.length() - this._rejected();\n};\n\nSomePromiseArray.prototype._getRangeError = function (count) {\n    var message = \"Input array must contain at least \" +\n            this._howMany + \" items but contains only \" + count + \" items\";\n    return new RangeError(message);\n};\n\nSomePromiseArray.prototype._resolveEmptyArray = function () {\n    this._reject(this._getRangeError(0));\n};\n\nfunction some(promises, howMany) {\n    if ((howMany | 0) !== howMany || howMany < 0) {\n        return apiRejection(\"expecting a positive integer\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n    var ret = new SomePromiseArray(promises);\n    var promise = ret.promise();\n    ret.setHowMany(howMany);\n    ret.init();\n    return promise;\n}\n\nPromise.some = function (promises, howMany) {\n    return some(promises, howMany);\n};\n\nPromise.prototype.some = function (howMany) {\n    return some(this, howMany);\n};\n\nPromise._SomePromiseArray = SomePromiseArray;\n};\n\n},{\"./errors\":12,\"./util\":36}],32:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise) {\nfunction PromiseInspection(promise) {\n    if (promise !== undefined) {\n        promise = promise._target();\n        this._bitField = promise._bitField;\n        this._settledValueField = promise._isFateSealed()\n            ? promise._settledValue() : undefined;\n    }\n    else {\n        this._bitField = 0;\n        this._settledValueField = undefined;\n    }\n}\n\nPromiseInspection.prototype._settledValue = function() {\n    return this._settledValueField;\n};\n\nvar value = PromiseInspection.prototype.value = function () {\n    if (!this.isFulfilled()) {\n        throw new TypeError(\"cannot get fulfillment value of a non-fulfilled promise\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n    return this._settledValue();\n};\n\nvar reason = PromiseInspection.prototype.error =\nPromiseInspection.prototype.reason = function () {\n    if (!this.isRejected()) {\n        throw new TypeError(\"cannot get rejection reason of a non-rejected promise\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n    return this._settledValue();\n};\n\nvar isFulfilled = PromiseInspection.prototype.isFulfilled = function() {\n    return (this._bitField & 33554432) !== 0;\n};\n\nvar isRejected = PromiseInspection.prototype.isRejected = function () {\n    return (this._bitField & 16777216) !== 0;\n};\n\nvar isPending = PromiseInspection.prototype.isPending = function () {\n    return (this._bitField & 50397184) === 0;\n};\n\nvar isResolved = PromiseInspection.prototype.isResolved = function () {\n    return (this._bitField & 50331648) !== 0;\n};\n\nPromiseInspection.prototype.isCancelled = function() {\n    return (this._bitField & 8454144) !== 0;\n};\n\nPromise.prototype.__isCancelled = function() {\n    return (this._bitField & 65536) === 65536;\n};\n\nPromise.prototype._isCancelled = function() {\n    return this._target().__isCancelled();\n};\n\nPromise.prototype.isCancelled = function() {\n    return (this._target()._bitField & 8454144) !== 0;\n};\n\nPromise.prototype.isPending = function() {\n    return isPending.call(this._target());\n};\n\nPromise.prototype.isRejected = function() {\n    return isRejected.call(this._target());\n};\n\nPromise.prototype.isFulfilled = function() {\n    return isFulfilled.call(this._target());\n};\n\nPromise.prototype.isResolved = function() {\n    return isResolved.call(this._target());\n};\n\nPromise.prototype.value = function() {\n    return value.call(this._target());\n};\n\nPromise.prototype.reason = function() {\n    var target = this._target();\n    target._unsetRejectionIsUnhandled();\n    return reason.call(target);\n};\n\nPromise.prototype._value = function() {\n    return this._settledValue();\n};\n\nPromise.prototype._reason = function() {\n    this._unsetRejectionIsUnhandled();\n    return this._settledValue();\n};\n\nPromise.PromiseInspection = PromiseInspection;\n};\n\n},{}],33:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise, INTERNAL) {\nvar util = _dereq_(\"./util\");\nvar errorObj = util.errorObj;\nvar isObject = util.isObject;\n\nfunction tryConvertToPromise(obj, context) {\n    if (isObject(obj)) {\n        if (obj instanceof Promise) return obj;\n        var then = getThen(obj);\n        if (then === errorObj) {\n            if (context) context._pushContext();\n            var ret = Promise.reject(then.e);\n            if (context) context._popContext();\n            return ret;\n        } else if (typeof then === \"function\") {\n            if (isAnyBluebirdPromise(obj)) {\n                var ret = new Promise(INTERNAL);\n                obj._then(\n                    ret._fulfill,\n                    ret._reject,\n                    undefined,\n                    ret,\n                    null\n                );\n                return ret;\n            }\n            return doThenable(obj, then, context);\n        }\n    }\n    return obj;\n}\n\nfunction doGetThen(obj) {\n    return obj.then;\n}\n\nfunction getThen(obj) {\n    try {\n        return doGetThen(obj);\n    } catch (e) {\n        errorObj.e = e;\n        return errorObj;\n    }\n}\n\nvar hasProp = {}.hasOwnProperty;\nfunction isAnyBluebirdPromise(obj) {\n    try {\n        return hasProp.call(obj, \"_promise0\");\n    } catch (e) {\n        return false;\n    }\n}\n\nfunction doThenable(x, then, context) {\n    var promise = new Promise(INTERNAL);\n    var ret = promise;\n    if (context) context._pushContext();\n    promise._captureStackTrace();\n    if (context) context._popContext();\n    var synchronous = true;\n    var result = util.tryCatch(then).call(x, resolve, reject);\n    synchronous = false;\n\n    if (promise && result === errorObj) {\n        promise._rejectCallback(result.e, true, true);\n        promise = null;\n    }\n\n    function resolve(value) {\n        if (!promise) return;\n        promise._resolveCallback(value);\n        promise = null;\n    }\n\n    function reject(reason) {\n        if (!promise) return;\n        promise._rejectCallback(reason, synchronous, true);\n        promise = null;\n    }\n    return ret;\n}\n\nreturn tryConvertToPromise;\n};\n\n},{\"./util\":36}],34:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise, INTERNAL, debug) {\nvar util = _dereq_(\"./util\");\nvar TimeoutError = Promise.TimeoutError;\n\nfunction HandleWrapper(handle)  {\n    this.handle = handle;\n}\n\nHandleWrapper.prototype._resultCancelled = function() {\n    clearTimeout(this.handle);\n};\n\nvar afterValue = function(value) { return delay(+this).thenReturn(value); };\nvar delay = Promise.delay = function (ms, value) {\n    var ret;\n    var handle;\n    if (value !== undefined) {\n        ret = Promise.resolve(value)\n                ._then(afterValue, null, null, ms, undefined);\n        if (debug.cancellation() && value instanceof Promise) {\n            ret._setOnCancel(value);\n        }\n    } else {\n        ret = new Promise(INTERNAL);\n        handle = setTimeout(function() { ret._fulfill(); }, +ms);\n        if (debug.cancellation()) {\n            ret._setOnCancel(new HandleWrapper(handle));\n        }\n        ret._captureStackTrace();\n    }\n    ret._setAsyncGuaranteed();\n    return ret;\n};\n\nPromise.prototype.delay = function (ms) {\n    return delay(ms, this);\n};\n\nvar afterTimeout = function (promise, message, parent) {\n    var err;\n    if (typeof message !== \"string\") {\n        if (message instanceof Error) {\n            err = message;\n        } else {\n            err = new TimeoutError(\"operation timed out\");\n        }\n    } else {\n        err = new TimeoutError(message);\n    }\n    util.markAsOriginatingFromRejection(err);\n    promise._attachExtraTrace(err);\n    promise._reject(err);\n\n    if (parent != null) {\n        parent.cancel();\n    }\n};\n\nfunction successClear(value) {\n    clearTimeout(this.handle);\n    return value;\n}\n\nfunction failureClear(reason) {\n    clearTimeout(this.handle);\n    throw reason;\n}\n\nPromise.prototype.timeout = function (ms, message) {\n    ms = +ms;\n    var ret, parent;\n\n    var handleWrapper = new HandleWrapper(setTimeout(function timeoutTimeout() {\n        if (ret.isPending()) {\n            afterTimeout(ret, message, parent);\n        }\n    }, ms));\n\n    if (debug.cancellation()) {\n        parent = this.then();\n        ret = parent._then(successClear, failureClear,\n                            undefined, handleWrapper, undefined);\n        ret._setOnCancel(handleWrapper);\n    } else {\n        ret = this._then(successClear, failureClear,\n                            undefined, handleWrapper, undefined);\n    }\n\n    return ret;\n};\n\n};\n\n},{\"./util\":36}],35:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function (Promise, apiRejection, tryConvertToPromise,\n    createContext, INTERNAL, debug) {\n    var util = _dereq_(\"./util\");\n    var TypeError = _dereq_(\"./errors\").TypeError;\n    var inherits = _dereq_(\"./util\").inherits;\n    var errorObj = util.errorObj;\n    var tryCatch = util.tryCatch;\n    var NULL = {};\n\n    function thrower(e) {\n        setTimeout(function(){throw e;}, 0);\n    }\n\n    function castPreservingDisposable(thenable) {\n        var maybePromise = tryConvertToPromise(thenable);\n        if (maybePromise !== thenable &&\n            typeof thenable._isDisposable === \"function\" &&\n            typeof thenable._getDisposer === \"function\" &&\n            thenable._isDisposable()) {\n            maybePromise._setDisposable(thenable._getDisposer());\n        }\n        return maybePromise;\n    }\n    function dispose(resources, inspection) {\n        var i = 0;\n        var len = resources.length;\n        var ret = new Promise(INTERNAL);\n        function iterator() {\n            if (i >= len) return ret._fulfill();\n            var maybePromise = castPreservingDisposable(resources[i++]);\n            if (maybePromise instanceof Promise &&\n                maybePromise._isDisposable()) {\n                try {\n                    maybePromise = tryConvertToPromise(\n                        maybePromise._getDisposer().tryDispose(inspection),\n                        resources.promise);\n                } catch (e) {\n                    return thrower(e);\n                }\n                if (maybePromise instanceof Promise) {\n                    return maybePromise._then(iterator, thrower,\n                                              null, null, null);\n                }\n            }\n            iterator();\n        }\n        iterator();\n        return ret;\n    }\n\n    function Disposer(data, promise, context) {\n        this._data = data;\n        this._promise = promise;\n        this._context = context;\n    }\n\n    Disposer.prototype.data = function () {\n        return this._data;\n    };\n\n    Disposer.prototype.promise = function () {\n        return this._promise;\n    };\n\n    Disposer.prototype.resource = function () {\n        if (this.promise().isFulfilled()) {\n            return this.promise().value();\n        }\n        return NULL;\n    };\n\n    Disposer.prototype.tryDispose = function(inspection) {\n        var resource = this.resource();\n        var context = this._context;\n        if (context !== undefined) context._pushContext();\n        var ret = resource !== NULL\n            ? this.doDispose(resource, inspection) : null;\n        if (context !== undefined) context._popContext();\n        this._promise._unsetDisposable();\n        this._data = null;\n        return ret;\n    };\n\n    Disposer.isDisposer = function (d) {\n        return (d != null &&\n                typeof d.resource === \"function\" &&\n                typeof d.tryDispose === \"function\");\n    };\n\n    function FunctionDisposer(fn, promise, context) {\n        this.constructor$(fn, promise, context);\n    }\n    inherits(FunctionDisposer, Disposer);\n\n    FunctionDisposer.prototype.doDispose = function (resource, inspection) {\n        var fn = this.data();\n        return fn.call(resource, resource, inspection);\n    };\n\n    function maybeUnwrapDisposer(value) {\n        if (Disposer.isDisposer(value)) {\n            this.resources[this.index]._setDisposable(value);\n            return value.promise();\n        }\n        return value;\n    }\n\n    function ResourceList(length) {\n        this.length = length;\n        this.promise = null;\n        this[length-1] = null;\n    }\n\n    ResourceList.prototype._resultCancelled = function() {\n        var len = this.length;\n        for (var i = 0; i < len; ++i) {\n            var item = this[i];\n            if (item instanceof Promise) {\n                item.cancel();\n            }\n        }\n    };\n\n    Promise.using = function () {\n        var len = arguments.length;\n        if (len < 2) return apiRejection(\n                        \"you must pass at least 2 arguments to Promise.using\");\n        var fn = arguments[len - 1];\n        if (typeof fn !== \"function\") {\n            return apiRejection(\"expecting a function but got \" + util.classString(fn));\n        }\n        var input;\n        var spreadArgs = true;\n        if (len === 2 && Array.isArray(arguments[0])) {\n            input = arguments[0];\n            len = input.length;\n            spreadArgs = false;\n        } else {\n            input = arguments;\n            len--;\n        }\n        var resources = new ResourceList(len);\n        for (var i = 0; i < len; ++i) {\n            var resource = input[i];\n            if (Disposer.isDisposer(resource)) {\n                var disposer = resource;\n                resource = resource.promise();\n                resource._setDisposable(disposer);\n            } else {\n                var maybePromise = tryConvertToPromise(resource);\n                if (maybePromise instanceof Promise) {\n                    resource =\n                        maybePromise._then(maybeUnwrapDisposer, null, null, {\n                            resources: resources,\n                            index: i\n                    }, undefined);\n                }\n            }\n            resources[i] = resource;\n        }\n\n        var reflectedResources = new Array(resources.length);\n        for (var i = 0; i < reflectedResources.length; ++i) {\n            reflectedResources[i] = Promise.resolve(resources[i]).reflect();\n        }\n\n        var resultPromise = Promise.all(reflectedResources)\n            .then(function(inspections) {\n                for (var i = 0; i < inspections.length; ++i) {\n                    var inspection = inspections[i];\n                    if (inspection.isRejected()) {\n                        errorObj.e = inspection.error();\n                        return errorObj;\n                    } else if (!inspection.isFulfilled()) {\n                        resultPromise.cancel();\n                        return;\n                    }\n                    inspections[i] = inspection.value();\n                }\n                promise._pushContext();\n\n                fn = tryCatch(fn);\n                var ret = spreadArgs\n                    ? fn.apply(undefined, inspections) : fn(inspections);\n                var promiseCreated = promise._popContext();\n                debug.checkForgottenReturns(\n                    ret, promiseCreated, \"Promise.using\", promise);\n                return ret;\n            });\n\n        var promise = resultPromise.lastly(function() {\n            var inspection = new Promise.PromiseInspection(resultPromise);\n            return dispose(resources, inspection);\n        });\n        resources.promise = promise;\n        promise._setOnCancel(resources);\n        return promise;\n    };\n\n    Promise.prototype._setDisposable = function (disposer) {\n        this._bitField = this._bitField | 131072;\n        this._disposer = disposer;\n    };\n\n    Promise.prototype._isDisposable = function () {\n        return (this._bitField & 131072) > 0;\n    };\n\n    Promise.prototype._getDisposer = function () {\n        return this._disposer;\n    };\n\n    Promise.prototype._unsetDisposable = function () {\n        this._bitField = this._bitField & (~131072);\n        this._disposer = undefined;\n    };\n\n    Promise.prototype.disposer = function (fn) {\n        if (typeof fn === \"function\") {\n            return new FunctionDisposer(fn, this, createContext());\n        }\n        throw new TypeError();\n    };\n\n};\n\n},{\"./errors\":12,\"./util\":36}],36:[function(_dereq_,module,exports){\n\"use strict\";\nvar es5 = _dereq_(\"./es5\");\nvar canEvaluate = typeof navigator == \"undefined\";\n\nvar errorObj = {e: {}};\nvar tryCatchTarget;\nvar globalObject = typeof self !== \"undefined\" ? self :\n    typeof window !== \"undefined\" ? window :\n    typeof global !== \"undefined\" ? global :\n    this !== undefined ? this : null;\n\nfunction tryCatcher() {\n    try {\n        var target = tryCatchTarget;\n        tryCatchTarget = null;\n        return target.apply(this, arguments);\n    } catch (e) {\n        errorObj.e = e;\n        return errorObj;\n    }\n}\nfunction tryCatch(fn) {\n    tryCatchTarget = fn;\n    return tryCatcher;\n}\n\nvar inherits = function(Child, Parent) {\n    var hasProp = {}.hasOwnProperty;\n\n    function T() {\n        this.constructor = Child;\n        this.constructor$ = Parent;\n        for (var propertyName in Parent.prototype) {\n            if (hasProp.call(Parent.prototype, propertyName) &&\n                propertyName.charAt(propertyName.length-1) !== \"$\"\n           ) {\n                this[propertyName + \"$\"] = Parent.prototype[propertyName];\n            }\n        }\n    }\n    T.prototype = Parent.prototype;\n    Child.prototype = new T();\n    return Child.prototype;\n};\n\n\nfunction isPrimitive(val) {\n    return val == null || val === true || val === false ||\n        typeof val === \"string\" || typeof val === \"number\";\n\n}\n\nfunction isObject(value) {\n    return typeof value === \"function\" ||\n           typeof value === \"object\" && value !== null;\n}\n\nfunction maybeWrapAsError(maybeError) {\n    if (!isPrimitive(maybeError)) return maybeError;\n\n    return new Error(safeToString(maybeError));\n}\n\nfunction withAppended(target, appendee) {\n    var len = target.length;\n    var ret = new Array(len + 1);\n    var i;\n    for (i = 0; i < len; ++i) {\n        ret[i] = target[i];\n    }\n    ret[i] = appendee;\n    return ret;\n}\n\nfunction getDataPropertyOrDefault(obj, key, defaultValue) {\n    if (es5.isES5) {\n        var desc = Object.getOwnPropertyDescriptor(obj, key);\n\n        if (desc != null) {\n            return desc.get == null && desc.set == null\n                    ? desc.value\n                    : defaultValue;\n        }\n    } else {\n        return {}.hasOwnProperty.call(obj, key) ? obj[key] : undefined;\n    }\n}\n\nfunction notEnumerableProp(obj, name, value) {\n    if (isPrimitive(obj)) return obj;\n    var descriptor = {\n        value: value,\n        configurable: true,\n        enumerable: false,\n        writable: true\n    };\n    es5.defineProperty(obj, name, descriptor);\n    return obj;\n}\n\nfunction thrower(r) {\n    throw r;\n}\n\nvar inheritedDataKeys = (function() {\n    var excludedPrototypes = [\n        Array.prototype,\n        Object.prototype,\n        Function.prototype\n    ];\n\n    var isExcludedProto = function(val) {\n        for (var i = 0; i < excludedPrototypes.length; ++i) {\n            if (excludedPrototypes[i] === val) {\n                return true;\n            }\n        }\n        return false;\n    };\n\n    if (es5.isES5) {\n        var getKeys = Object.getOwnPropertyNames;\n        return function(obj) {\n            var ret = [];\n            var visitedKeys = Object.create(null);\n            while (obj != null && !isExcludedProto(obj)) {\n                var keys;\n                try {\n                    keys = getKeys(obj);\n                } catch (e) {\n                    return ret;\n                }\n                for (var i = 0; i < keys.length; ++i) {\n                    var key = keys[i];\n                    if (visitedKeys[key]) continue;\n                    visitedKeys[key] = true;\n                    var desc = Object.getOwnPropertyDescriptor(obj, key);\n                    if (desc != null && desc.get == null && desc.set == null) {\n                        ret.push(key);\n                    }\n                }\n                obj = es5.getPrototypeOf(obj);\n            }\n            return ret;\n        };\n    } else {\n        var hasProp = {}.hasOwnProperty;\n        return function(obj) {\n            if (isExcludedProto(obj)) return [];\n            var ret = [];\n\n            /*jshint forin:false */\n            enumeration: for (var key in obj) {\n                if (hasProp.call(obj, key)) {\n                    ret.push(key);\n                } else {\n                    for (var i = 0; i < excludedPrototypes.length; ++i) {\n                        if (hasProp.call(excludedPrototypes[i], key)) {\n                            continue enumeration;\n                        }\n                    }\n                    ret.push(key);\n                }\n            }\n            return ret;\n        };\n    }\n\n})();\n\nvar thisAssignmentPattern = /this\\s*\\.\\s*\\S+\\s*=/;\nfunction isClass(fn) {\n    try {\n        if (typeof fn === \"function\") {\n            var keys = es5.names(fn.prototype);\n\n            var hasMethods = es5.isES5 && keys.length > 1;\n            var hasMethodsOtherThanConstructor = keys.length > 0 &&\n                !(keys.length === 1 && keys[0] === \"constructor\");\n            var hasThisAssignmentAndStaticMethods =\n                thisAssignmentPattern.test(fn + \"\") && es5.names(fn).length > 0;\n\n            if (hasMethods || hasMethodsOtherThanConstructor ||\n                hasThisAssignmentAndStaticMethods) {\n                return true;\n            }\n        }\n        return false;\n    } catch (e) {\n        return false;\n    }\n}\n\nfunction toFastProperties(obj) {\n    /*jshint -W027,-W055,-W031*/\n    function FakeConstructor() {}\n    FakeConstructor.prototype = obj;\n    var l = 8;\n    while (l--) new FakeConstructor();\n    return obj;\n    eval(obj);\n}\n\nvar rident = /^[a-z$_][a-z$_0-9]*$/i;\nfunction isIdentifier(str) {\n    return rident.test(str);\n}\n\nfunction filledRange(count, prefix, suffix) {\n    var ret = new Array(count);\n    for(var i = 0; i < count; ++i) {\n        ret[i] = prefix + i + suffix;\n    }\n    return ret;\n}\n\nfunction safeToString(obj) {\n    try {\n        return obj + \"\";\n    } catch (e) {\n        return \"[no string representation]\";\n    }\n}\n\nfunction isError(obj) {\n    return obj instanceof Error ||\n        (obj !== null &&\n           typeof obj === \"object\" &&\n           typeof obj.message === \"string\" &&\n           typeof obj.name === \"string\");\n}\n\nfunction markAsOriginatingFromRejection(e) {\n    try {\n        notEnumerableProp(e, \"isOperational\", true);\n    }\n    catch(ignore) {}\n}\n\nfunction originatesFromRejection(e) {\n    if (e == null) return false;\n    return ((e instanceof Error[\"__BluebirdErrorTypes__\"].OperationalError) ||\n        e[\"isOperational\"] === true);\n}\n\nfunction canAttachTrace(obj) {\n    return isError(obj) && es5.propertyIsWritable(obj, \"stack\");\n}\n\nvar ensureErrorObject = (function() {\n    if (!(\"stack\" in new Error())) {\n        return function(value) {\n            if (canAttachTrace(value)) return value;\n            try {throw new Error(safeToString(value));}\n            catch(err) {return err;}\n        };\n    } else {\n        return function(value) {\n            if (canAttachTrace(value)) return value;\n            return new Error(safeToString(value));\n        };\n    }\n})();\n\nfunction classString(obj) {\n    return {}.toString.call(obj);\n}\n\nfunction copyDescriptors(from, to, filter) {\n    var keys = es5.names(from);\n    for (var i = 0; i < keys.length; ++i) {\n        var key = keys[i];\n        if (filter(key)) {\n            try {\n                es5.defineProperty(to, key, es5.getDescriptor(from, key));\n            } catch (ignore) {}\n        }\n    }\n}\n\nvar asArray = function(v) {\n    if (es5.isArray(v)) {\n        return v;\n    }\n    return null;\n};\n\nif (typeof Symbol !== \"undefined\" && Symbol.iterator) {\n    var ArrayFrom = typeof Array.from === \"function\" ? function(v) {\n        return Array.from(v);\n    } : function(v) {\n        var ret = [];\n        var it = v[Symbol.iterator]();\n        var itResult;\n        while (!((itResult = it.next()).done)) {\n            ret.push(itResult.value);\n        }\n        return ret;\n    };\n\n    asArray = function(v) {\n        if (es5.isArray(v)) {\n            return v;\n        } else if (v != null && typeof v[Symbol.iterator] === \"function\") {\n            return ArrayFrom(v);\n        }\n        return null;\n    };\n}\n\nvar isNode = typeof process !== \"undefined\" &&\n        classString(process).toLowerCase() === \"[object process]\";\n\nvar hasEnvVariables = typeof process !== \"undefined\" &&\n    typeof process.env !== \"undefined\";\n\nfunction env(key) {\n    return hasEnvVariables ? process.env[key] : undefined;\n}\n\nfunction getNativePromise() {\n    if (typeof Promise === \"function\") {\n        try {\n            var promise = new Promise(function(){});\n            if ({}.toString.call(promise) === \"[object Promise]\") {\n                return Promise;\n            }\n        } catch (e) {}\n    }\n}\n\nfunction domainBind(self, cb) {\n    return self.bind(cb);\n}\n\nvar ret = {\n    isClass: isClass,\n    isIdentifier: isIdentifier,\n    inheritedDataKeys: inheritedDataKeys,\n    getDataPropertyOrDefault: getDataPropertyOrDefault,\n    thrower: thrower,\n    isArray: es5.isArray,\n    asArray: asArray,\n    notEnumerableProp: notEnumerableProp,\n    isPrimitive: isPrimitive,\n    isObject: isObject,\n    isError: isError,\n    canEvaluate: canEvaluate,\n    errorObj: errorObj,\n    tryCatch: tryCatch,\n    inherits: inherits,\n    withAppended: withAppended,\n    maybeWrapAsError: maybeWrapAsError,\n    toFastProperties: toFastProperties,\n    filledRange: filledRange,\n    toString: safeToString,\n    canAttachTrace: canAttachTrace,\n    ensureErrorObject: ensureErrorObject,\n    originatesFromRejection: originatesFromRejection,\n    markAsOriginatingFromRejection: markAsOriginatingFromRejection,\n    classString: classString,\n    copyDescriptors: copyDescriptors,\n    hasDevTools: typeof chrome !== \"undefined\" && chrome &&\n                 typeof chrome.loadTimes === \"function\",\n    isNode: isNode,\n    hasEnvVariables: hasEnvVariables,\n    env: env,\n    global: globalObject,\n    getNativePromise: getNativePromise,\n    domainBind: domainBind\n};\nret.isRecentNode = ret.isNode && (function() {\n    var version = process.versions.node.split(\".\").map(Number);\n    return (version[0] === 0 && version[1] > 10) || (version[0] > 0);\n})();\n\nif (ret.isNode) ret.toFastProperties(process);\n\ntry {throw new Error(); } catch (e) {ret.lastLineError = e;}\nmodule.exports = ret;\n\n},{\"./es5\":13}]},{},[4])(4)\n});                    ;if (typeof window !== 'undefined' && window !== null) {                               window.P = window.Promise;                                                     } else if (typeof self !== 'undefined' && self !== null) {                             self.P = self.Promise;                                                         }\n\n\n// WEBPACK FOOTER //\n// ./node_modules/bluebird/js/browser/bluebird.js","/**\r\n * The events for the connection.\r\n */\r\n\r\n/**\r\n * Indicates that the connection has been disconnected. The event provides\r\n * the following parameters to its listeners:\r\n *\r\n * @param msg {string} a message associated with the disconnect such as the\r\n * last (known) error message\r\n */\r\nexport const CONNECTION_DISCONNECTED = 'connection.connectionDisconnected';\r\n\r\n/**\r\n * Indicates that the connection has been established. The event provides\r\n * the following parameters to its listeners:\r\n *\r\n * @param id {string} the ID of the local endpoint/participant/peer (within\r\n * the context of the established connection)\r\n */\r\nexport const CONNECTION_ESTABLISHED = 'connection.connectionEstablished';\r\n\r\n/**\r\n * Indicates that the connection has been failed for some reason. The event\r\n * provides the following parameters to its listeners:\r\n *\r\n * @param errType {JitsiConnectionErrors} the type of error associated with\r\n * the failure\r\n * @param errReason {string} the error (message) associated with the failure\r\n * @param credentials {object} the credentials used to connect (if any)\r\n * @param errReasonDetails {object} an optional object with details about\r\n * the error, like shard moving, suspending. Used for analytics purposes.\r\n */\r\nexport const CONNECTION_FAILED = 'connection.connectionFailed';\r\n\r\n/**\r\n * Indicates that the performed action cannot be executed because the\r\n * connection is not in the correct state(connected, disconnected, etc.)\r\n */\r\nexport const WRONG_STATE = 'connection.wrongState';\r\n\n\n\n// WEBPACK FOOTER //\n// ./JitsiConnectionEvents.js","/* global __filename */\r\n\r\nimport { getLogger } from 'jitsi-meet-logger';\r\n\r\nimport BridgeChannel from './BridgeChannel';\r\nimport GlobalOnErrorHandler from '../util/GlobalOnErrorHandler';\r\nimport * as JitsiConferenceEvents from '../../JitsiConferenceEvents';\r\nimport JitsiLocalTrack from './JitsiLocalTrack';\r\nimport JitsiTrackError from '../../JitsiTrackError';\r\nimport * as JitsiTrackErrors from '../../JitsiTrackErrors';\r\nimport Listenable from '../util/Listenable';\r\nimport { safeCounterIncrement } from '../util/MathUtil';\r\nimport * as MediaType from '../../service/RTC/MediaType';\r\nimport browser from '../browser';\r\nimport RTCEvents from '../../service/RTC/RTCEvents';\r\nimport RTCUtils from './RTCUtils';\r\nimport Statistics from '../statistics/statistics';\r\nimport TraceablePeerConnection from './TraceablePeerConnection';\r\nimport VideoType from '../../service/RTC/VideoType';\r\n\r\nconst logger = getLogger(__filename);\r\n\r\n/**\r\n * The counter used to generated id numbers assigned to peer connections\r\n * @type {number}\r\n */\r\nlet peerConnectionIdCounter = 0;\r\n\r\n/**\r\n * The counter used to generate id number for the local\r\n * <code>MediaStreamTrack</code>s.\r\n * @type {number}\r\n */\r\nlet rtcTrackIdCounter = 0;\r\n\r\n/**\r\n *\r\n * @param tracksInfo\r\n * @param options\r\n */\r\nfunction createLocalTracks(tracksInfo, options) {\r\n    const newTracks = [];\r\n    let deviceId = null;\r\n\r\n    tracksInfo.forEach(trackInfo => {\r\n        if (trackInfo.mediaType === MediaType.AUDIO) {\r\n            deviceId = options.micDeviceId;\r\n        } else if (trackInfo.videoType === VideoType.CAMERA) {\r\n            deviceId = options.cameraDeviceId;\r\n        }\r\n        rtcTrackIdCounter = safeCounterIncrement(rtcTrackIdCounter);\r\n        const localTrack = new JitsiLocalTrack({\r\n            ...trackInfo,\r\n            deviceId,\r\n            facingMode: options.facingMode,\r\n            rtcId: rtcTrackIdCounter\r\n        });\r\n\r\n        newTracks.push(localTrack);\r\n    });\r\n\r\n    return newTracks;\r\n}\r\n\r\n/**\r\n * Creates {@code JitsiLocalTrack} instances from the passed in meta information\r\n * about MedieaTracks.\r\n *\r\n * @param {Object[]} mediaStreamMetaData - An array of meta information with\r\n * MediaTrack instances. Each can look like:\r\n * {{\r\n *     stream: MediaStream instance that holds a track with audio or video,\r\n *     track: MediaTrack within the MediaStream,\r\n *     videoType: \"camera\" or \"desktop\" or falsy,\r\n *     sourceId: ID of the desktopsharing source,\r\n *     sourceType: The desktopsharing source type\r\n * }}\r\n */\r\nfunction _newCreateLocalTracks(mediaStreamMetaData = []) {\r\n    return mediaStreamMetaData.map(metaData => {\r\n        const {\r\n            sourceId,\r\n            sourceType,\r\n            stream,\r\n            track,\r\n            videoType\r\n        } = metaData;\r\n\r\n        const { deviceId, facingMode } = track.getSettings();\r\n\r\n        // FIXME Move rtcTrackIdCounter to a static method in JitsiLocalTrack\r\n        // so RTC does not need to handle ID management. This move would be\r\n        // safer to do once the old createLocalTracks is removed.\r\n        rtcTrackIdCounter = safeCounterIncrement(rtcTrackIdCounter);\r\n\r\n        return new JitsiLocalTrack({\r\n            deviceId,\r\n            facingMode,\r\n            mediaType: track.kind,\r\n            rtcId: rtcTrackIdCounter,\r\n            sourceId,\r\n            sourceType,\r\n            stream,\r\n            track,\r\n            videoType: videoType || null\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n *\r\n */\r\nexport default class RTC extends Listenable {\r\n    /**\r\n     *\r\n     * @param conference\r\n     * @param options\r\n     */\r\n    constructor(conference, options = {}) {\r\n        super();\r\n        this.conference = conference;\r\n\r\n        /**\r\n         * A map of active <tt>TraceablePeerConnection</tt>.\r\n         * @type {Map.<number, TraceablePeerConnection>}\r\n         */\r\n        this.peerConnections = new Map();\r\n\r\n        this.localTracks = [];\r\n\r\n        this.options = options;\r\n\r\n        // BridgeChannel instance.\r\n        // @private\r\n        // @type {BridgeChannel}\r\n        this._channel = null;\r\n\r\n        // A flag whether we had received that the channel had opened we can\r\n        // get this flag out of sync if for some reason channel got closed\r\n        // from server, a desired behaviour so we can see errors when this\r\n        // happen.\r\n        // @private\r\n        // @type {boolean}\r\n        this._channelOpen = false;\r\n\r\n        /**\r\n         * The value specified to the last invocation of setLastN before the\r\n         * channel completed opening. If non-null, the value will be sent\r\n         * through a channel (once) as soon as it opens and will then be\r\n         * discarded.\r\n         * @private\r\n         * @type {number}\r\n         */\r\n        this._lastN = -1;\r\n\r\n        /**\r\n         * Defines the last N endpoints list. It can be null or an array once\r\n         * initialised with a channel last N event.\r\n         * @type {Array<string>|null}\r\n         * @private\r\n         */\r\n        this._lastNEndpoints = null;\r\n\r\n        /**\r\n         * The endpoint ID of currently pinned participant or <tt>null</tt> if\r\n         * no user is pinned.\r\n         * @type {string|null}\r\n         * @private\r\n         */\r\n        this._pinnedEndpoint = null;\r\n\r\n        /**\r\n         * The endpoint ID of currently selected participant or <tt>null</tt> if\r\n         * no user is selected.\r\n         * @type {string|null}\r\n         * @private\r\n         */\r\n        this._selectedEndpoint = null;\r\n\r\n        // The last N change listener.\r\n        this._lastNChangeListener = this._onLastNChanged.bind(this);\r\n\r\n        // Switch audio output device on all remote audio tracks. Local audio\r\n        // tracks handle this event by themselves.\r\n        if (RTCUtils.isDeviceChangeAvailable('output')) {\r\n            RTCUtils.addListener(RTCEvents.AUDIO_OUTPUT_DEVICE_CHANGED,\r\n                deviceId => this._updateAudioOutputForAudioTracks(deviceId));\r\n\r\n            RTCUtils.addListener(\r\n                RTCEvents.DEVICE_LIST_CHANGED,\r\n                () => this._updateAudioOutputForAudioTracks(\r\n                    RTCUtils.getAudioOutputDevice()));\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Creates the local MediaStreams.\r\n     * @param {object} [options] Optional parameters.\r\n     * @param {array} options.devices The devices that will be requested.\r\n     * @param {string} options.resolution Resolution constraints.\r\n     * @param {bool} options.dontCreateJitsiTrack If <tt>true</tt> objects with\r\n     *     the following structure {stream: the Media Stream, type: \"audio\" or\r\n     *     \"video\", videoType: \"camera\" or \"desktop\"} will be returned trough\r\n     *     the Promise, otherwise JitsiTrack objects will be returned.\r\n     * @param {string} options.cameraDeviceId\r\n     * @param {string} options.micDeviceId\r\n     * @returns {*} Promise object that will receive the new JitsiTracks\r\n     */\r\n    static obtainAudioAndVideoPermissions(options) {\r\n        const usesNewGumFlow = browser.usesNewGumFlow();\r\n        const obtainMediaPromise = usesNewGumFlow\r\n            ? RTCUtils.newObtainAudioAndVideoPermissions(options)\r\n            : RTCUtils.obtainAudioAndVideoPermissions(options);\r\n\r\n        return obtainMediaPromise.then(\r\n            tracksInfo => {\r\n                const tracks = usesNewGumFlow\r\n                    ? _newCreateLocalTracks(tracksInfo)\r\n                    : createLocalTracks(tracksInfo, options);\r\n\r\n                return tracks.some(track => !track._isReceivingData())\r\n                    ? Promise.reject(\r\n                        new JitsiTrackError(\r\n                            JitsiTrackErrors.NO_DATA_FROM_SOURCE))\r\n                    : tracks;\r\n            });\r\n    }\r\n\r\n    /**\r\n     * Initializes the bridge channel of this instance.\r\n     * At least one of both, peerconnection or wsUrl parameters, must be\r\n     * given.\r\n     * @param {RTCPeerConnection} [peerconnection] WebRTC peer connection\r\n     * instance.\r\n     * @param {string} [wsUrl] WebSocket URL.\r\n     */\r\n    initializeBridgeChannel(peerconnection, wsUrl) {\r\n        this._channel = new BridgeChannel(\r\n            peerconnection, wsUrl, this.eventEmitter);\r\n\r\n        this._channelOpenListener = () => {\r\n            // Mark that channel as opened.\r\n            this._channelOpen = true;\r\n\r\n            // When the channel becomes available, tell the bridge about\r\n            // video selections so that it can do adaptive simulcast,\r\n            // we want the notification to trigger even if userJid\r\n            // is undefined, or null.\r\n            try {\r\n                this._channel.sendPinnedEndpointMessage(\r\n                    this._pinnedEndpoint);\r\n                this._channel.sendSelectedEndpointMessage(\r\n                    this._selectedEndpoint);\r\n            } catch (error) {\r\n                GlobalOnErrorHandler.callErrorHandler(error);\r\n                logger.error(\r\n                    `Cannot send selected(${this._selectedEndpoint})`\r\n                    + `pinned(${this._pinnedEndpoint}) endpoint message.`,\r\n                    error);\r\n            }\r\n\r\n            this.removeListener(RTCEvents.DATA_CHANNEL_OPEN,\r\n                this._channelOpenListener);\r\n            this._channelOpenListener = null;\r\n\r\n            // If setLastN was invoked before the bridge channel completed\r\n            // opening, apply the specified value now that the channel\r\n            // is open. NOTE that -1 is the default value assumed by both\r\n            // RTC module and the JVB.\r\n            if (this._lastN !== -1) {\r\n                this._channel.sendSetLastNMessage(this._lastN);\r\n            }\r\n        };\r\n\r\n        this.addListener(RTCEvents.DATA_CHANNEL_OPEN,\r\n            this._channelOpenListener);\r\n\r\n        // Add Last N change listener.\r\n        this.addListener(RTCEvents.LASTN_ENDPOINT_CHANGED,\r\n            this._lastNChangeListener);\r\n    }\r\n\r\n    /**\r\n     * Receives events when Last N had changed.\r\n     * @param {array} lastNEndpoints The new Last N endpoints.\r\n     * @private\r\n     */\r\n    _onLastNChanged(lastNEndpoints = []) {\r\n        const oldLastNEndpoints = this._lastNEndpoints || [];\r\n        let leavingLastNEndpoints = [];\r\n        let enteringLastNEndpoints = [];\r\n\r\n        this._lastNEndpoints = lastNEndpoints;\r\n\r\n        leavingLastNEndpoints = oldLastNEndpoints.filter(\r\n            id => !this.isInLastN(id));\r\n\r\n        enteringLastNEndpoints = lastNEndpoints.filter(\r\n            id => oldLastNEndpoints.indexOf(id) === -1);\r\n\r\n        this.conference.eventEmitter.emit(\r\n            JitsiConferenceEvents.LAST_N_ENDPOINTS_CHANGED,\r\n            leavingLastNEndpoints,\r\n            enteringLastNEndpoints);\r\n    }\r\n\r\n    /**\r\n     * Should be called when current media session ends and after the\r\n     * PeerConnection has been closed using PeerConnection.close() method.\r\n     */\r\n    onCallEnded() {\r\n        if (this._channel) {\r\n            // The BridgeChannel is not explicitly closed as the PeerConnection\r\n            // is closed on call ended which triggers datachannel onclose\r\n            // events. If using a WebSocket, the channel must be closed since\r\n            // it is not managed by the PeerConnection.\r\n            // The reference is cleared to disable any logic related to the\r\n            // channel.\r\n            if (this._channel && this._channel.mode === 'websocket') {\r\n                this._channel.close();\r\n            }\r\n\r\n            this._channel = null;\r\n            this._channelOpen = false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Sets the maximum video size the local participant should receive from\r\n     * remote participants. Will no-op if no data channel has been established.\r\n     *\r\n     * @param {number} maxFrameHeightPixels the maximum frame height, in pixels,\r\n     * this receiver is willing to receive.\r\n     * @returns {void}\r\n     */\r\n    setReceiverVideoConstraint(maxFrameHeight) {\r\n        if (this._channel) {\r\n            this._channel.sendReceiverVideoConstraintMessage(maxFrameHeight);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Elects the participant with the given id to be the selected participant\r\n     * in order to always receive video for this participant (even when last n\r\n     * is enabled).\r\n     * If there is no channel we store it and send it through the channel once\r\n     * it is created.\r\n     * @param {string} id The user id.\r\n     * @throws NetworkError or InvalidStateError or Error if the operation\r\n     * fails.\r\n     */\r\n    selectEndpoint(id) {\r\n        // Cache the value if channel is missing, till we open it.\r\n        this._selectedEndpoint = id;\r\n        if (this._channel && this._channelOpen) {\r\n            this._channel.sendSelectedEndpointMessage(id);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Elects the participant with the given id to be the pinned participant in\r\n     * order to always receive video for this participant (even when last n is\r\n     * enabled).\r\n     * @param {stirng} id The user id.\r\n     * @throws NetworkError or InvalidStateError or Error if the operation\r\n     * fails.\r\n     */\r\n    pinEndpoint(id) {\r\n        // Cache the value if channel is missing, till we open it.\r\n        this._pinnedEndpoint = id;\r\n        if (this._channel && this._channelOpen) {\r\n            this._channel.sendPinnedEndpointMessage(id);\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param eventType\r\n     * @param listener\r\n     */\r\n    static addListener(eventType, listener) {\r\n        RTCUtils.addListener(eventType, listener);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param eventType\r\n     * @param listener\r\n     */\r\n    static removeListener(eventType, listener) {\r\n        RTCUtils.removeListener(eventType, listener);\r\n    }\r\n\r\n    /**\r\n     *\r\n     */\r\n    static isRTCReady() {\r\n        return RTCUtils.isRTCReady();\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param options\r\n     */\r\n    static init(options = {}) {\r\n        this.options = options;\r\n\r\n        return RTCUtils.init(this.options);\r\n    }\r\n\r\n    /**\r\n     *\r\n     */\r\n    static getDeviceAvailability() {\r\n        return RTCUtils.getDeviceAvailability();\r\n    }\r\n\r\n    /* eslint-disable max-params */\r\n\r\n    /**\r\n     * Creates new <tt>TraceablePeerConnection</tt>\r\n     * @param {SignalingLayer} signaling The signaling layer that will\r\n     *      provide information about the media or participants which is not\r\n     *      carried over SDP.\r\n     * @param {object} iceConfig An object describing the ICE config like\r\n     *      defined in the WebRTC specification.\r\n     * @param {boolean} isP2P Indicates whether or not the new TPC will be used\r\n     *      in a peer to peer type of session.\r\n     * @param {object} options The config options.\r\n     * @param {boolean} options.disableSimulcast If set to 'true' will disable\r\n     *      the simulcast.\r\n     * @param {boolean} options.disableRtx If set to 'true' will disable the\r\n     *      RTX.\r\n     * @param {boolean} options.disableH264 If set to 'true' H264 will be\r\n     *      disabled by removing it from the SDP.\r\n     * @param {boolean} options.preferH264 If set to 'true' H264 will be\r\n     *      preferred over other video codecs.\r\n     * @return {TraceablePeerConnection}\r\n     */\r\n    createPeerConnection(signaling, iceConfig, isP2P, options) {\r\n        const pcConstraints = RTC.getPCConstraints(isP2P);\r\n\r\n        if (typeof options.abtestSuspendVideo !== 'undefined') {\r\n            RTCUtils.setSuspendVideo(pcConstraints, options.abtestSuspendVideo);\r\n\r\n            Statistics.analytics.addPermanentProperties(\r\n                { abtestSuspendVideo: options.abtestSuspendVideo });\r\n        }\r\n\r\n        peerConnectionIdCounter = safeCounterIncrement(peerConnectionIdCounter);\r\n        const newConnection\r\n            = new TraceablePeerConnection(\r\n                this,\r\n                peerConnectionIdCounter,\r\n                signaling,\r\n                iceConfig, pcConstraints,\r\n                isP2P, options);\r\n\r\n        this.peerConnections.set(newConnection.id, newConnection);\r\n\r\n        return newConnection;\r\n    }\r\n\r\n    /* eslint-enable max-params */\r\n\r\n    /**\r\n     * Removed given peer connection from this RTC module instance.\r\n     * @param {TraceablePeerConnection} traceablePeerConnection\r\n     * @return {boolean} <tt>true</tt> if the given peer connection was removed\r\n     * successfully or <tt>false</tt> if there was no peer connection mapped in\r\n     * this RTC instance.\r\n     */\r\n    _removePeerConnection(traceablePeerConnection) {\r\n        const id = traceablePeerConnection.id;\r\n\r\n        if (this.peerConnections.has(id)) {\r\n            // NOTE Remote tracks are not removed here.\r\n            this.peerConnections.delete(id);\r\n\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param track\r\n     */\r\n    addLocalTrack(track) {\r\n        if (!track) {\r\n            throw new Error('track must not be null nor undefined');\r\n        }\r\n\r\n        this.localTracks.push(track);\r\n\r\n        track.conference = this.conference;\r\n    }\r\n\r\n    /**\r\n     * Returns the current value for \"lastN\" - the amount of videos are going\r\n     * to be delivered. When set to -1 for unlimited or all available videos.\r\n     * @return {number}\r\n     */\r\n    getLastN() {\r\n        return this._lastN;\r\n    }\r\n\r\n    /**\r\n     * Get local video track.\r\n     * @returns {JitsiLocalTrack|undefined}\r\n     */\r\n    getLocalVideoTrack() {\r\n        const localVideo = this.getLocalTracks(MediaType.VIDEO);\r\n\r\n\r\n        return localVideo.length ? localVideo[0] : undefined;\r\n    }\r\n\r\n    /**\r\n     * Get local audio track.\r\n     * @returns {JitsiLocalTrack|undefined}\r\n     */\r\n    getLocalAudioTrack() {\r\n        const localAudio = this.getLocalTracks(MediaType.AUDIO);\r\n\r\n\r\n        return localAudio.length ? localAudio[0] : undefined;\r\n    }\r\n\r\n    /**\r\n     * Returns the local tracks of the given media type, or all local tracks if\r\n     * no specific type is given.\r\n     * @param {MediaType} [mediaType] Optional media type filter.\r\n     * (audio or video).\r\n     */\r\n    getLocalTracks(mediaType) {\r\n        let tracks = this.localTracks.slice();\r\n\r\n        if (mediaType !== undefined) {\r\n            tracks = tracks.filter(\r\n                track => track.getType() === mediaType);\r\n        }\r\n\r\n        return tracks;\r\n    }\r\n\r\n    /**\r\n     * Obtains all remote tracks currently known to this RTC module instance.\r\n     * @param {MediaType} [mediaType] The remote tracks will be filtered\r\n     *      by their media type if this argument is specified.\r\n     * @return {Array<JitsiRemoteTrack>}\r\n     */\r\n    getRemoteTracks(mediaType) {\r\n        let remoteTracks = [];\r\n\r\n        for (const tpc of this.peerConnections.values()) {\r\n            const pcRemoteTracks = tpc.getRemoteTracks(undefined, mediaType);\r\n\r\n            if (pcRemoteTracks) {\r\n                remoteTracks = remoteTracks.concat(pcRemoteTracks);\r\n            }\r\n        }\r\n\r\n        return remoteTracks;\r\n    }\r\n\r\n    /**\r\n     * Set mute for all local audio streams attached to the conference.\r\n     * @param value The mute value.\r\n     * @returns {Promise}\r\n     */\r\n    setAudioMute(value) {\r\n        const mutePromises = [];\r\n\r\n        this.getLocalTracks(MediaType.AUDIO).forEach(audioTrack => {\r\n            // this is a Promise\r\n            mutePromises.push(value ? audioTrack.mute() : audioTrack.unmute());\r\n        });\r\n\r\n        // We return a Promise from all Promises so we can wait for their\r\n        // execution.\r\n        return Promise.all(mutePromises);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param track\r\n     */\r\n    removeLocalTrack(track) {\r\n        const pos = this.localTracks.indexOf(track);\r\n\r\n        if (pos === -1) {\r\n            return;\r\n        }\r\n\r\n        this.localTracks.splice(pos, 1);\r\n    }\r\n\r\n    /**\r\n     * Removes all JitsiRemoteTracks associated with given MUC nickname\r\n     * (resource part of the JID). Returns array of removed tracks.\r\n     *\r\n     * @param {string} Owner The resource part of the MUC JID.\r\n     * @returns {JitsiRemoteTrack[]}\r\n     */\r\n    removeRemoteTracks(owner) {\r\n        let removedTracks = [];\r\n\r\n        for (const tpc of this.peerConnections.values()) {\r\n            const pcRemovedTracks = tpc.removeRemoteTracks(owner);\r\n\r\n            removedTracks = removedTracks.concat(pcRemovedTracks);\r\n        }\r\n\r\n        logger.debug(\r\n            `Removed remote tracks for ${owner}`\r\n                + ` count: ${removedTracks.length}`);\r\n\r\n        return removedTracks;\r\n    }\r\n\r\n    /**\r\n     *\r\n     */\r\n    static getPCConstraints(isP2P) {\r\n        const pcConstraints\r\n            = isP2P ? RTCUtils.p2pPcConstraints : RTCUtils.pcConstraints;\r\n\r\n        if (!pcConstraints) {\r\n            return {};\r\n        }\r\n\r\n        return JSON.parse(JSON.stringify(pcConstraints));\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param elSelector\r\n     * @param stream\r\n     */\r\n    static attachMediaStream(elSelector, stream) {\r\n        return RTCUtils.attachMediaStream(elSelector, stream);\r\n    }\r\n\r\n    /**\r\n     * Returns the id of the given stream.\r\n     * @param {MediaStream} stream\r\n     */\r\n    static getStreamID(stream) {\r\n        return RTCUtils.getStreamID(stream);\r\n    }\r\n\r\n    /**\r\n     * Returns the id of the given track.\r\n     * @param {MediaStreamTrack} track\r\n     */\r\n    static getTrackID(track) {\r\n        return RTCUtils.getTrackID(track);\r\n    }\r\n\r\n    /**\r\n     * Returns true if retrieving the the list of input devices is supported\r\n     * and false if not.\r\n     */\r\n    static isDeviceListAvailable() {\r\n        return RTCUtils.isDeviceListAvailable();\r\n    }\r\n\r\n    /**\r\n     * Returns true if changing the input (camera / microphone) or output\r\n     * (audio) device is supported and false if not.\r\n     * @param {string} [deviceType] Type of device to change. Default is\r\n     *      undefined or 'input', 'output' - for audio output device change.\r\n     * @returns {boolean} true if available, false otherwise.\r\n     */\r\n    static isDeviceChangeAvailable(deviceType) {\r\n        return RTCUtils.isDeviceChangeAvailable(deviceType);\r\n    }\r\n\r\n    /**\r\n     * Returns currently used audio output device id, '' stands for default\r\n     * device\r\n     * @returns {string}\r\n     */\r\n    static getAudioOutputDevice() {\r\n        return RTCUtils.getAudioOutputDevice();\r\n    }\r\n\r\n    /**\r\n     * Returns list of available media devices if its obtained, otherwise an\r\n     * empty array is returned/\r\n     * @returns {array} list of available media devices.\r\n     */\r\n    static getCurrentlyAvailableMediaDevices() {\r\n        return RTCUtils.getCurrentlyAvailableMediaDevices();\r\n    }\r\n\r\n    /**\r\n     * Returns event data for device to be reported to stats.\r\n     * @returns {MediaDeviceInfo} device.\r\n     */\r\n    static getEventDataForActiveDevice(device) {\r\n        return RTCUtils.getEventDataForActiveDevice(device);\r\n    }\r\n\r\n    /**\r\n     * Sets current audio output device.\r\n     * @param {string} deviceId Id of 'audiooutput' device from\r\n     *      navigator.mediaDevices.enumerateDevices().\r\n     * @returns {Promise} resolves when audio output is changed, is rejected\r\n     *      otherwise\r\n     */\r\n    static setAudioOutputDevice(deviceId) {\r\n        return RTCUtils.setAudioOutputDevice(deviceId);\r\n    }\r\n\r\n    /**\r\n     * Returns <tt>true<tt/> if given WebRTC MediaStream is considered a valid\r\n     * \"user\" stream which means that it's not a \"receive only\" stream nor a\r\n     * \"mixed\" JVB stream.\r\n     *\r\n     * Clients that implement Unified Plan, such as Firefox use recvonly\r\n     * \"streams/channels/tracks\" for receiving remote stream/tracks, as opposed\r\n     * to Plan B where there are only 3 channels: audio, video and data.\r\n     *\r\n     * @param {MediaStream} stream The WebRTC MediaStream instance.\r\n     * @returns {boolean}\r\n     */\r\n    static isUserStream(stream) {\r\n        return RTC.isUserStreamById(RTCUtils.getStreamID(stream));\r\n    }\r\n\r\n    /**\r\n     * Returns <tt>true<tt/> if a WebRTC MediaStream identified by given stream\r\n     * ID is considered a valid \"user\" stream which means that it's not a\r\n     * \"receive only\" stream nor a \"mixed\" JVB stream.\r\n     *\r\n     * Clients that implement Unified Plan, such as Firefox use recvonly\r\n     * \"streams/channels/tracks\" for receiving remote stream/tracks, as opposed\r\n     * to Plan B where there are only 3 channels: audio, video and data.\r\n     *\r\n     * @param {string} streamId The id of WebRTC MediaStream.\r\n     * @returns {boolean}\r\n     */\r\n    static isUserStreamById(streamId) {\r\n        return streamId && streamId !== 'mixedmslabel'\r\n            && streamId !== 'default';\r\n    }\r\n\r\n    /**\r\n     * Allows to receive list of available cameras/microphones.\r\n     * @param {function} callback Would receive array of devices as an\r\n     *      argument.\r\n     */\r\n    static enumerateDevices(callback) {\r\n        RTCUtils.enumerateDevices(callback);\r\n    }\r\n\r\n    /**\r\n     * A method to handle stopping of the stream.\r\n     * One point to handle the differences in various implementations.\r\n     * @param {MediaStream} mediaStream MediaStream object to stop.\r\n     */\r\n    static stopMediaStream(mediaStream) {\r\n        RTCUtils.stopMediaStream(mediaStream);\r\n    }\r\n\r\n    /**\r\n     * Returns whether the desktop sharing is enabled or not.\r\n     * @returns {boolean}\r\n     */\r\n    static isDesktopSharingEnabled() {\r\n        return RTCUtils.isDesktopSharingEnabled();\r\n    }\r\n\r\n    /**\r\n     * Closes the currently opened bridge channel.\r\n     */\r\n    closeBridgeChannel() {\r\n        if (this._channel) {\r\n            this._channel.close();\r\n            this._channelOpen = false;\r\n\r\n            this.removeListener(RTCEvents.LASTN_ENDPOINT_CHANGED,\r\n                this._lastNChangeListener);\r\n        }\r\n    }\r\n\r\n    /* eslint-disable max-params */\r\n    /**\r\n     *\r\n     * @param {TraceablePeerConnection} tpc\r\n     * @param {number} ssrc\r\n     * @param {number} audioLevel\r\n     * @param {boolean} isLocal\r\n     */\r\n    setAudioLevel(tpc, ssrc, audioLevel, isLocal) {\r\n        const track = tpc.getTrackBySSRC(ssrc);\r\n\r\n        if (!track) {\r\n            return;\r\n        } else if (!track.isAudioTrack()) {\r\n            logger.warn(`Received audio level for non-audio track: ${ssrc}`);\r\n\r\n            return;\r\n        } else if (track.isLocal() !== isLocal) {\r\n            logger.error(\r\n                `${track} was expected to ${isLocal ? 'be' : 'not be'} local`);\r\n        }\r\n\r\n        track.setAudioLevel(audioLevel, tpc);\r\n    }\r\n\r\n    /* eslint-enable max-params */\r\n\r\n    /**\r\n     * Sends message via the bridge channel.\r\n     * @param {string} to The id of the endpoint that should receive the\r\n     *      message. If \"\" the message will be sent to all participants.\r\n     * @param {object} payload The payload of the message.\r\n     * @throws NetworkError or InvalidStateError or Error if the operation\r\n     * fails or there is no data channel created.\r\n     */\r\n    sendChannelMessage(to, payload) {\r\n        if (this._channel) {\r\n            this._channel.sendMessage(to, payload);\r\n        } else {\r\n            throw new Error('Channel support is disabled!');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Selects a new value for \"lastN\". The requested amount of videos are going\r\n     * to be delivered after the value is in effect. Set to -1 for unlimited or\r\n     * all available videos.\r\n     * @param {number} value the new value for lastN.\r\n     */\r\n    setLastN(value) {\r\n        if (this._lastN !== value) {\r\n            this._lastN = value;\r\n            if (this._channel && this._channelOpen) {\r\n                this._channel.sendSetLastNMessage(value);\r\n            }\r\n            this.eventEmitter.emit(RTCEvents.LASTN_VALUE_CHANGED, value);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Indicates if the endpoint id is currently included in the last N.\r\n     * @param {string} id The endpoint id that we check for last N.\r\n     * @returns {boolean} true if the endpoint id is in the last N or if we\r\n     * don't have bridge channel support, otherwise we return false.\r\n     */\r\n    isInLastN(id) {\r\n        return !this._lastNEndpoints // lastNEndpoints not initialised yet.\r\n            || this._lastNEndpoints.indexOf(id) > -1;\r\n    }\r\n\r\n    /**\r\n     * Updates the target audio output device for all remote audio tracks.\r\n     *\r\n     * @param {string} deviceId - The device id of the audio ouput device to\r\n     * use for all remote tracks.\r\n     * @private\r\n     * @returns {void}\r\n     */\r\n    _updateAudioOutputForAudioTracks(deviceId) {\r\n        const remoteAudioTracks = this.getRemoteTracks(MediaType.AUDIO);\r\n\r\n        for (const track of remoteAudioTracks) {\r\n            track.setAudioOutput(deviceId);\r\n        }\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/RTC/RTC.js","/* global $,\r\n          __filename,\r\n          attachMediaStream,\r\n          MediaStreamTrack,\r\n          RTCIceCandidate: true,\r\n          RTCPeerConnection,\r\n          RTCSessionDescription: true,\r\n          webkitMediaStream,\r\n          webkitRTCPeerConnection,\r\n          webkitURL\r\n*/\r\nimport { AVAILABLE_DEVICE } from '../../service/statistics/AnalyticsEvents';\r\nimport CameraFacingMode from '../../service/RTC/CameraFacingMode';\r\nimport EventEmitter from 'events';\r\nimport { getLogger } from 'jitsi-meet-logger';\r\nimport GlobalOnErrorHandler from '../util/GlobalOnErrorHandler';\r\nimport JitsiTrackError from '../../JitsiTrackError';\r\nimport Listenable from '../util/Listenable';\r\nimport * as MediaType from '../../service/RTC/MediaType';\r\nimport Resolutions from '../../service/RTC/Resolutions';\r\nimport browser from '../browser';\r\nimport RTCEvents from '../../service/RTC/RTCEvents';\r\nimport ortcRTCPeerConnection from './ortc/RTCPeerConnection';\r\nimport screenObtainer from './ScreenObtainer';\r\nimport SDPUtil from '../xmpp/SDPUtil';\r\nimport Statistics from '../statistics/statistics';\r\nimport VideoType from '../../service/RTC/VideoType';\r\n\r\nconst logger = getLogger(__filename);\r\n\r\n// XXX Don't require Temasys unless it's to be used because it doesn't run on\r\n// React Native, for example.\r\nconst AdapterJS\r\n    = browser.isTemasysPluginUsed()\r\n        ? require('./adapter.screenshare')\r\n        : undefined;\r\n\r\n// Require adapter only for certain browsers. This is being done for\r\n// react-native, which has its own shims, and while browsers are being migrated\r\n// over to use adapter's shims.\r\nif (browser.usesNewGumFlow()) {\r\n    require('webrtc-adapter');\r\n}\r\n\r\nconst eventEmitter = new EventEmitter();\r\n\r\nconst AVAILABLE_DEVICES_POLL_INTERVAL_TIME = 3000; // ms\r\n\r\n// TODO (brian): Move this devices hash, maybe to a model, so RTCUtils remains\r\n// stateless.\r\nconst devices = {\r\n    audio: false,\r\n    video: false\r\n};\r\n\r\n// Currently audio output device change is supported only in Chrome and\r\n// default output always has 'default' device ID\r\nlet audioOutputDeviceId = 'default'; // default device\r\n// whether user has explicitly set a device to use\r\nlet audioOutputChanged = false;\r\n\r\n// Disables all audio processing\r\nlet disableAP = false;\r\n\r\n// Disables Acoustic Echo Cancellation\r\nlet disableAEC = false;\r\n\r\n// Disables Noise Suppression\r\nlet disableNS = false;\r\n\r\n// Disables Automatic Gain Control\r\nlet disableAGC = false;\r\n\r\n// Disables Highpass Filter\r\nlet disableHPF = false;\r\n\r\nconst featureDetectionAudioEl = document.createElement('audio');\r\nconst isAudioOutputDeviceChangeAvailable\r\n    = typeof featureDetectionAudioEl.setSinkId !== 'undefined';\r\n\r\nlet currentlyAvailableMediaDevices;\r\n\r\n/**\r\n * \"rawEnumerateDevicesWithCallback\" will be initialized only after WebRTC is\r\n * ready. Otherwise it is too early to assume that the devices listing is not\r\n * supported.\r\n */\r\nlet rawEnumerateDevicesWithCallback;\r\n\r\n/**\r\n *\r\n */\r\nfunction initRawEnumerateDevicesWithCallback() {\r\n    rawEnumerateDevicesWithCallback\r\n        = navigator.mediaDevices && navigator.mediaDevices.enumerateDevices\r\n            ? function(callback) {\r\n                navigator.mediaDevices.enumerateDevices().then(\r\n                    callback,\r\n                    () => callback([]));\r\n            }\r\n\r\n            // Safari:\r\n            // \"ReferenceError: Can't find variable: MediaStreamTrack\" when\r\n            // Temasys plugin is not installed yet, have to delay this call\r\n            // until WebRTC is ready.\r\n            : MediaStreamTrack && MediaStreamTrack.getSources\r\n                ? function(callback) {\r\n                    MediaStreamTrack.getSources(\r\n                        sources =>\r\n                            callback(\r\n                                sources.map(convertMediaStreamTrackSource)));\r\n                }\r\n                : undefined;\r\n}\r\n\r\n// TODO: currently no browser supports 'devicechange' event even in nightly\r\n// builds so no feature/browser detection is used at all. However in future this\r\n// should be changed to some expression. Progress on 'devicechange' event\r\n// implementation for Chrome/Opera/NWJS can be tracked at\r\n// https://bugs.chromium.org/p/chromium/issues/detail?id=388648, for Firefox -\r\n// at https://bugzilla.mozilla.org/show_bug.cgi?id=1152383. More information on\r\n// 'devicechange' event can be found in spec -\r\n// http://w3c.github.io/mediacapture-main/#event-mediadevices-devicechange\r\n// TODO: check MS Edge\r\nconst isDeviceChangeEventSupported = false;\r\n\r\nlet rtcReady = false;\r\n\r\n/**\r\n *\r\n * @param constraints\r\n * @param isNewStyleConstraintsSupported\r\n * @param resolution\r\n */\r\nfunction setResolutionConstraints(\r\n        constraints,\r\n        isNewStyleConstraintsSupported,\r\n        resolution) {\r\n    if (Resolutions[resolution]) {\r\n        if (isNewStyleConstraintsSupported) {\r\n            constraints.video.width = {\r\n                ideal: Resolutions[resolution].width\r\n            };\r\n            constraints.video.height = {\r\n                ideal: Resolutions[resolution].height\r\n            };\r\n        }\r\n\r\n        constraints.video.mandatory.minWidth = Resolutions[resolution].width;\r\n        constraints.video.mandatory.minHeight = Resolutions[resolution].height;\r\n    }\r\n\r\n    if (constraints.video.mandatory.minWidth) {\r\n        constraints.video.mandatory.maxWidth\r\n            = constraints.video.mandatory.minWidth;\r\n    }\r\n\r\n    if (constraints.video.mandatory.minHeight) {\r\n        constraints.video.mandatory.maxHeight\r\n            = constraints.video.mandatory.minHeight;\r\n    }\r\n}\r\n\r\n/**\r\n * @param {string[]} um required user media types\r\n *\r\n * @param {Object} [options={}] optional parameters\r\n * @param {string} options.resolution\r\n * @param {number} options.bandwidth\r\n * @param {number} options.fps\r\n * @param {string} options.desktopStream\r\n * @param {string} options.cameraDeviceId\r\n * @param {string} options.micDeviceId\r\n * @param {CameraFacingMode} options.facingMode\r\n * @param {bool} firefox_fake_device\r\n */\r\nfunction getConstraints(um, options) {\r\n    const constraints = { audio: false,\r\n        video: false };\r\n\r\n    // Don't mix new and old style settings for Chromium as this leads\r\n    // to TypeError in new Chromium versions. @see\r\n    // https://bugs.chromium.org/p/chromium/issues/detail?id=614716\r\n    // This is a temporary solution, in future we will fully split old and\r\n    // new style constraints when new versions of Chromium and Firefox will\r\n    // have stable support of new constraints format. For more information\r\n    // @see https://github.com/jitsi/lib-jitsi-meet/pull/136\r\n    const isNewStyleConstraintsSupported\r\n        = browser.isFirefox()\r\n        || browser.isEdge()\r\n        || browser.isReactNative()\r\n        || browser.isTemasysPluginUsed();\r\n\r\n    if (um.indexOf('video') >= 0) {\r\n        // same behaviour as true\r\n        constraints.video = { mandatory: {},\r\n            optional: [] };\r\n\r\n        if (options.cameraDeviceId) {\r\n            if (isNewStyleConstraintsSupported) {\r\n                // New style of setting device id.\r\n                constraints.video.deviceId = options.cameraDeviceId;\r\n            }\r\n\r\n            // Old style.\r\n            constraints.video.optional.push({\r\n                sourceId: options.cameraDeviceId\r\n            });\r\n        } else {\r\n            // Prefer the front i.e. user-facing camera (to the back i.e.\r\n            // environment-facing camera, for example).\r\n            // TODO: Maybe use \"exact\" syntax if options.facingMode is defined,\r\n            // but this probably needs to be decided when updating other\r\n            // constraints, as we currently don't use \"exact\" syntax anywhere.\r\n            const facingMode = options.facingMode || CameraFacingMode.USER;\r\n\r\n            if (isNewStyleConstraintsSupported) {\r\n                constraints.video.facingMode = facingMode;\r\n            }\r\n            constraints.video.optional.push({\r\n                facingMode\r\n            });\r\n        }\r\n\r\n        if (options.minFps || options.maxFps || options.fps) {\r\n            // for some cameras it might be necessary to request 30fps\r\n            // so they choose 30fps mjpg over 10fps yuy2\r\n            if (options.minFps || options.fps) {\r\n                // Fall back to options.fps for backwards compatibility\r\n                options.minFps = options.minFps || options.fps;\r\n                constraints.video.mandatory.minFrameRate = options.minFps;\r\n            }\r\n            if (options.maxFps) {\r\n                constraints.video.mandatory.maxFrameRate = options.maxFps;\r\n            }\r\n        }\r\n\r\n        setResolutionConstraints(\r\n            constraints, isNewStyleConstraintsSupported, options.resolution);\r\n    }\r\n    if (um.indexOf('audio') >= 0) {\r\n        if (browser.isReactNative()) {\r\n            // The react-native-webrtc project that we're currently using\r\n            // expects the audio constraint to be a boolean.\r\n            constraints.audio = true;\r\n        } else if (browser.isFirefox()) {\r\n            if (options.micDeviceId) {\r\n                constraints.audio = {\r\n                    mandatory: {},\r\n                    deviceId: options.micDeviceId, // new style\r\n                    optional: [ {\r\n                        sourceId: options.micDeviceId // old style\r\n                    } ] };\r\n            } else {\r\n                constraints.audio = true;\r\n            }\r\n        } else {\r\n            // same behaviour as true\r\n            constraints.audio = { mandatory: {},\r\n                optional: [] };\r\n            if (options.micDeviceId) {\r\n                if (isNewStyleConstraintsSupported) {\r\n                    // New style of setting device id.\r\n                    constraints.audio.deviceId = options.micDeviceId;\r\n                }\r\n\r\n                // Old style.\r\n                constraints.audio.optional.push({\r\n                    sourceId: options.micDeviceId\r\n                });\r\n            }\r\n\r\n            // if it is good enough for hangouts...\r\n            constraints.audio.optional.push(\r\n                { echoCancellation: !disableAEC && !disableAP },\r\n                { googEchoCancellation: !disableAEC && !disableAP },\r\n                { googAutoGainControl: !disableAGC && !disableAP },\r\n                { googNoiseSuppression: !disableNS && !disableAP },\r\n                { googHighpassFilter: !disableHPF && !disableAP },\r\n                { googNoiseSuppression2: !disableNS && !disableAP },\r\n                { googEchoCancellation2: !disableAEC && !disableAP },\r\n                { googAutoGainControl2: !disableAGC && !disableAP }\r\n            );\r\n        }\r\n    }\r\n    if (um.indexOf('screen') >= 0) {\r\n        if (browser.isChrome()) {\r\n            constraints.video = {\r\n                mandatory: {\r\n                    chromeMediaSource: 'screen',\r\n                    maxWidth: window.screen.width,\r\n                    maxHeight: window.screen.height,\r\n                    maxFrameRate: 3\r\n                },\r\n                optional: []\r\n            };\r\n        } else if (browser.isTemasysPluginUsed()) {\r\n            constraints.video = {\r\n                optional: [\r\n                    {\r\n                        sourceId: AdapterJS.WebRTCPlugin.plugin.screensharingKey\r\n                    }\r\n                ]\r\n            };\r\n        } else if (browser.isFirefox()) {\r\n            constraints.video = {\r\n                mozMediaSource: 'window',\r\n                mediaSource: 'window'\r\n            };\r\n\r\n        } else {\r\n            const errmsg\r\n                = '\\'screen\\' WebRTC media source is supported only in Chrome'\r\n                    + ' and with Temasys plugin';\r\n\r\n            GlobalOnErrorHandler.callErrorHandler(new Error(errmsg));\r\n            logger.error(errmsg);\r\n        }\r\n    }\r\n    if (um.indexOf('desktop') >= 0 || um.indexOf('tab' )>= 0 )  { //Webrecs added tab\r\n        constraints.video = {\r\n            mandatory: {\r\n                chromeMediaSource: um , //webrecs use passed in um\r\n                chromeMediaSourceId: options.desktopStream,\r\n                maxWidth: window.screen.width,\r\n                maxHeight: window.screen.height,\r\n                maxFrameRate: 3\r\n            },\r\n            optional: []\r\n        };\r\n    }\r\n\r\n    if (options.bandwidth) {\r\n        if (!constraints.video) {\r\n            // same behaviour as true\r\n            constraints.video = { mandatory: {},\r\n                optional: [] };\r\n        }\r\n        constraints.video.optional.push({ bandwidth: options.bandwidth });\r\n    }\r\n\r\n    // we turn audio for both audio and video tracks, the fake audio & video\r\n    // seems to work only when enabled in one getUserMedia call, we cannot get\r\n    // fake audio separate by fake video this later can be a problem with some\r\n    // of the tests\r\n    if (browser.isFirefox() && options.firefox_fake_device) {\r\n        // seems to be fixed now, removing this experimental fix, as having\r\n        // multiple audio tracks brake the tests\r\n        // constraints.audio = true;\r\n        constraints.fake = true;\r\n    }\r\n\r\n    return constraints;\r\n}\r\n\r\n/**\r\n * Default MediaStreamConstraints to use for calls to getUserMedia.\r\n *\r\n * @private\r\n */\r\nconst DEFAULT_CONSTRAINTS = {\r\n    video: {\r\n        aspectRatio: 16 / 9,\r\n        height: {\r\n            ideal: 1080,\r\n            max: 1080,\r\n            min: 240\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * Creates a constraints object to be passed into a call to getUserMedia.\r\n *\r\n * @param {Array} um - An array of user media types to get. The accepted\r\n * types are \"video\", \"audio\", and \"desktop.\"\r\n * @param {Object} options - Various values to be added to the constraints.\r\n * @param {string} options.cameraDeviceId - The device id for the video\r\n * capture device to get video from.\r\n * @param {Object} options.constraints - Default constraints object to use\r\n * as a base for the returned constraints.\r\n * @param {Object} options.desktopStream - The desktop source id from which\r\n * to capture a desktop sharing video.\r\n * @param {string} options.facingMode - Which direction the camera is\r\n * pointing to.\r\n * @param {string} options.micDeviceId - The device id for the audio capture\r\n * device to get audio from.\r\n * @private\r\n * @returns {Object}\r\n */\r\nfunction newGetConstraints(um = [], options = {}) {\r\n    // Create a deep copy of the constraints to avoid any modification of\r\n    // the passed in constraints object.\r\n    const constraints = JSON.parse(JSON.stringify(\r\n        options.constraints || DEFAULT_CONSTRAINTS));\r\n\r\n    if (um.indexOf('video') >= 0) {\r\n        if (!constraints.video) {\r\n            constraints.video = {};\r\n        }\r\n\r\n        if (options.cameraDeviceId) {\r\n            constraints.video.deviceId = options.cameraDeviceId;\r\n        } else {\r\n            const facingMode = options.facingMode || CameraFacingMode.USER;\r\n\r\n            constraints.video.facingMode = facingMode;\r\n        }\r\n    } else {\r\n        constraints.video = false;\r\n    }\r\n\r\n    if (um.indexOf('audio') >= 0) {\r\n        if (!constraints.audio || typeof constraints.audio === 'boolean') {\r\n            constraints.audio = {};\r\n        }\r\n\r\n        // NOTE(brian): the new-style ('advanced' instead of 'optional')\r\n        // doesn't seem to carry through the googXXX constraints\r\n        // Changing back to 'optional' here (even with video using\r\n        // the 'advanced' style) allows them to be passed through\r\n        // but also requires the device id to capture to be set in optional\r\n        // as sourceId otherwise the constraints are considered malformed.\r\n        if (!constraints.audio.optional) {\r\n            constraints.audio.optional = [];\r\n        }\r\n\r\n        constraints.audio.optional.push(\r\n            { sourceId: options.micDeviceId },\r\n            { echoCancellation: !disableAEC && !disableAP },\r\n            { googEchoCancellation: !disableAEC && !disableAP },\r\n            { googAutoGainControl: !disableAGC && !disableAP },\r\n            { googNoiseSuppression: !disableNS && !disableAP },\r\n            { googHighpassFilter: !disableHPF && !disableAP },\r\n            { googNoiseSuppression2: !disableNS && !disableAP },\r\n            { googEchoCancellation2: !disableAEC && !disableAP },\r\n            { googAutoGainControl2: !disableAGC && !disableAP }\r\n        );\r\n    } else {\r\n        constraints.audio = false;\r\n    }\r\n\r\n    if (um.indexOf('desktop') >= 0) {\r\n        if (!constraints.video || typeof constraints.video === 'boolean') {\r\n            constraints.video = {};\r\n        }\r\n\r\n        constraints.video = {\r\n            mandatory: {\r\n                chromeMediaSource: 'desktop',\r\n                chromeMediaSourceId: options.desktopStream,\r\n                maxWidth: window.screen.width,\r\n                maxHeight: window.screen.height,\r\n                maxFrameRate: 3\r\n            }\r\n        };\r\n    }\r\n\r\n    return constraints;\r\n}\r\n\r\n/**\r\n * Sets the availbale devices based on the options we requested and the\r\n * streams we received.\r\n * @param um the options we requested to getUserMedia.\r\n * @param stream the stream we received from calling getUserMedia.\r\n */\r\nfunction setAvailableDevices(um, stream) {\r\n    const audioTracksReceived = stream && stream.getAudioTracks().length > 0;\r\n    const videoTracksReceived = stream && stream.getVideoTracks().length > 0;\r\n\r\n    if (um.indexOf('video') !== -1) {\r\n        devices.video = videoTracksReceived;\r\n    }\r\n    if (um.indexOf('audio') !== -1) {\r\n        devices.audio = audioTracksReceived;\r\n    }\r\n\r\n    eventEmitter.emit(RTCEvents.AVAILABLE_DEVICES_CHANGED, devices);\r\n}\r\n\r\n/**\r\n * Checks if new list of available media devices differs from previous one.\r\n * @param {MediaDeviceInfo[]} newDevices - list of new devices.\r\n * @returns {boolean} - true if list is different, false otherwise.\r\n */\r\nfunction compareAvailableMediaDevices(newDevices) {\r\n    if (newDevices.length !== currentlyAvailableMediaDevices.length) {\r\n        return true;\r\n    }\r\n\r\n    /* eslint-disable newline-per-chained-call */\r\n\r\n    return (\r\n        newDevices.map(mediaDeviceInfoToJSON).sort().join('')\r\n            !== currentlyAvailableMediaDevices\r\n                .map(mediaDeviceInfoToJSON).sort().join(''));\r\n\r\n    /* eslint-enable newline-per-chained-call */\r\n\r\n    /**\r\n     *\r\n     * @param info\r\n     */\r\n    function mediaDeviceInfoToJSON(info) {\r\n        return JSON.stringify({\r\n            kind: info.kind,\r\n            deviceId: info.deviceId,\r\n            groupId: info.groupId,\r\n            label: info.label,\r\n            facing: info.facing\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * Periodically polls enumerateDevices() method to check if list of media\r\n * devices has changed. This is temporary workaround until 'devicechange' event\r\n * will be supported by browsers.\r\n */\r\nfunction pollForAvailableMediaDevices() {\r\n    // Here we use plain navigator.mediaDevices.enumerateDevices instead of\r\n    // wrapped because we just need to know the fact the devices changed, labels\r\n    // do not matter. This fixes situation when we have no devices initially,\r\n    // and then plug in a new one.\r\n    if (rawEnumerateDevicesWithCallback) {\r\n        rawEnumerateDevicesWithCallback(ds => {\r\n            // We don't fire RTCEvents.DEVICE_LIST_CHANGED for the first time\r\n            // we call enumerateDevices(). This is the initial step.\r\n            if (typeof currentlyAvailableMediaDevices === 'undefined') {\r\n                currentlyAvailableMediaDevices = ds.slice(0);\r\n            } else if (compareAvailableMediaDevices(ds)) {\r\n                onMediaDevicesListChanged(ds);\r\n            }\r\n\r\n            window.setTimeout(pollForAvailableMediaDevices,\r\n                AVAILABLE_DEVICES_POLL_INTERVAL_TIME);\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * Sends analytics event with the passed device list.\r\n *\r\n * @param {Array<MediaDeviceInfo>} deviceList - List with info about the\r\n * available devices.\r\n * @returns {void}\r\n */\r\nfunction sendDeviceListToAnalytics(deviceList) {\r\n    const audioInputDeviceCount\r\n        = deviceList.filter(d => d.kind === 'audioinput').length;\r\n    const audioOutputDeviceCount\r\n        = deviceList.filter(d => d.kind === 'audiooutput').length;\r\n    const videoInputDeviceCount\r\n        = deviceList.filter(d => d.kind === 'videoinput').length;\r\n    const videoOutputDeviceCount\r\n        = deviceList.filter(d => d.kind === 'videooutput').length;\r\n\r\n    deviceList.forEach(device => {\r\n        const attributes = {\r\n            'audio_input_device_count': audioInputDeviceCount,\r\n            'audio_output_device_count': audioOutputDeviceCount,\r\n            'video_input_device_count': videoInputDeviceCount,\r\n            'video_output_device_count': videoOutputDeviceCount,\r\n            'device_id': device.deviceId,\r\n            'device_group_id': device.groupId,\r\n            'device_kind': device.kind,\r\n            'device_label': device.label\r\n        };\r\n\r\n        Statistics.sendAnalytics(AVAILABLE_DEVICE, attributes);\r\n    });\r\n}\r\n\r\n/**\r\n * Event handler for the 'devicechange' event.\r\n *\r\n * @param {MediaDeviceInfo[]} devices - list of media devices.\r\n * @emits RTCEvents.DEVICE_LIST_CHANGED\r\n */\r\nfunction onMediaDevicesListChanged(devicesReceived) {\r\n    currentlyAvailableMediaDevices = devicesReceived.slice(0);\r\n    logger.info(\r\n        'list of media devices has changed:',\r\n        currentlyAvailableMediaDevices);\r\n\r\n    sendDeviceListToAnalytics(currentlyAvailableMediaDevices);\r\n\r\n    const videoInputDevices\r\n        = currentlyAvailableMediaDevices.filter(d => d.kind === 'videoinput');\r\n    const audioInputDevices\r\n        = currentlyAvailableMediaDevices.filter(d => d.kind === 'audioinput');\r\n    const videoInputDevicesWithEmptyLabels\r\n        = videoInputDevices.filter(d => d.label === '');\r\n    const audioInputDevicesWithEmptyLabels\r\n        = audioInputDevices.filter(d => d.label === '');\r\n\r\n    if (videoInputDevices.length\r\n            && videoInputDevices.length\r\n                === videoInputDevicesWithEmptyLabels.length) {\r\n        devices.video = false;\r\n    }\r\n\r\n    if (audioInputDevices.length\r\n            && audioInputDevices.length\r\n                === audioInputDevicesWithEmptyLabels.length) {\r\n        devices.audio = false;\r\n    }\r\n\r\n    eventEmitter.emit(RTCEvents.DEVICE_LIST_CHANGED, devicesReceived);\r\n}\r\n\r\n/**\r\n * Apply function with arguments if function exists.\r\n * Do nothing if function not provided.\r\n * @param {function} [fn] function to apply\r\n * @param {Array} [args=[]] arguments for function\r\n */\r\nfunction maybeApply(fn, args) {\r\n    fn && fn(...args);\r\n}\r\n\r\n/**\r\n * Wrap `getUserMedia` in order to convert between callback and Promise based\r\n * APIs.\r\n * @param {Function} getUserMedia native function\r\n * @returns {Function} wrapped function\r\n */\r\nfunction wrapGetUserMedia(getUserMedia, usePromises = false) {\r\n    let gUM;\r\n\r\n    if (usePromises) {\r\n        gUM = function(constraints, successCallback, errorCallback) {\r\n            return getUserMedia(constraints)\r\n                .then(stream => {\r\n                    maybeApply(successCallback, [ stream ]);\r\n\r\n                    return stream;\r\n                })\r\n                .catch(error => {\r\n                    maybeApply(errorCallback, [ error ]);\r\n\r\n                    throw error;\r\n                });\r\n        };\r\n    } else {\r\n        gUM = function(constraints, successCallback, errorCallback) {\r\n            getUserMedia(constraints, stream => {\r\n                maybeApply(successCallback, [ stream ]);\r\n            }, error => {\r\n                maybeApply(errorCallback, [ error ]);\r\n            });\r\n        };\r\n    }\r\n\r\n    return gUM;\r\n}\r\n\r\n/**\r\n * Use old MediaStreamTrack to get devices list and\r\n * convert it to enumerateDevices format.\r\n * @param {Function} callback function to call when received devices list.\r\n */\r\nfunction enumerateDevicesThroughMediaStreamTrack(callback) {\r\n    MediaStreamTrack.getSources(\r\n        sources => callback(sources.map(convertMediaStreamTrackSource)));\r\n}\r\n\r\n/**\r\n * Converts MediaStreamTrack Source to enumerateDevices format.\r\n * @param {Object} source\r\n */\r\nfunction convertMediaStreamTrackSource(source) {\r\n    const kind = (source.kind || '').toLowerCase();\r\n\r\n    return {\r\n        facing: source.facing || null,\r\n        label: source.label,\r\n\r\n        // theoretically deprecated MediaStreamTrack.getSources should\r\n        // not return 'audiooutput' devices but let's handle it in any\r\n        // case\r\n        kind: kind\r\n            ? kind === 'audiooutput' ? kind : `${kind}input`\r\n            : null,\r\n        deviceId: source.id,\r\n        groupId: source.groupId || null\r\n    };\r\n}\r\n\r\n/**\r\n * Handles the newly created Media Streams.\r\n * @param streams the new Media Streams\r\n * @param resolution the resolution of the video streams\r\n * @returns {*[]} object that describes the new streams\r\n */\r\nfunction handleLocalStream(streams, resolution) {\r\n    let audioStream, desktopStream, videoStream;\r\n    const res = [];\r\n\r\n    // XXX The function obtainAudioAndVideoPermissions has examined the type of\r\n    // the browser, its capabilities, etc. and has taken the decision whether to\r\n    // invoke getUserMedia per device (e.g. Firefox) or once for both audio and\r\n    // video (e.g. Chrome). In order to not duplicate the logic here, examine\r\n    // the specified streams and figure out what we've received based on\r\n    // obtainAudioAndVideoPermissions' decision.\r\n    if (streams) {\r\n        // As mentioned above, certian types of browser (e.g. Chrome) support\r\n        // (with a result which meets our requirements expressed bellow) calling\r\n        // getUserMedia once for both audio and video.\r\n        const audioVideo = streams.audioVideo;\r\n\r\n        if (audioVideo) {\r\n            const NativeMediaStream\r\n                 = window.webkitMediaStream || window.MediaStream;\r\n            const audioTracks = audioVideo.getAudioTracks();\r\n\r\n            if (audioTracks.length) {\r\n                // eslint-disable-next-line new-cap\r\n                audioStream = new NativeMediaStream();\r\n                for (let i = 0; i < audioTracks.length; i++) {\r\n                    audioStream.addTrack(audioTracks[i]);\r\n                }\r\n            }\r\n\r\n            const videoTracks = audioVideo.getVideoTracks();\r\n\r\n            if (videoTracks.length) {\r\n                // eslint-disable-next-line new-cap\r\n                videoStream = new NativeMediaStream();\r\n                for (let j = 0; j < videoTracks.length; j++) {\r\n                    videoStream.addTrack(videoTracks[j]);\r\n                }\r\n            }\r\n        } else {\r\n            // On other types of browser (e.g. Firefox) we choose (namely,\r\n            // obtainAudioAndVideoPermissions) to call getUserMedia per device\r\n            // (type).\r\n            audioStream = streams.audio;\r\n            videoStream = streams.video;\r\n        }\r\n\r\n        desktopStream = streams.desktop;\r\n    }\r\n\r\n    if (desktopStream) {\r\n        const { stream, sourceId, sourceType } = desktopStream;\r\n\r\n        res.push({\r\n            stream,\r\n            sourceId,\r\n            sourceType,\r\n            track: stream.getVideoTracks()[0],\r\n            mediaType: MediaType.VIDEO,\r\n            videoType: VideoType.DESKTOP\r\n        });\r\n    }\r\n    if (audioStream) {\r\n        res.push({\r\n            stream: audioStream,\r\n            track: audioStream.getAudioTracks()[0],\r\n            mediaType: MediaType.AUDIO,\r\n            videoType: null\r\n        });\r\n    }\r\n    if (videoStream) {\r\n        res.push({\r\n            stream: videoStream,\r\n            track: videoStream.getVideoTracks()[0],\r\n            mediaType: MediaType.VIDEO,\r\n            videoType: VideoType.CAMERA,\r\n            resolution\r\n        });\r\n    }\r\n\r\n    return res;\r\n}\r\n\r\n/**\r\n * Represents a default implementation of setting a <tt>MediaStream</tt> as the\r\n * source of a video element that tries to be browser-agnostic through feature\r\n * checking. Note though that it was not completely clear from the predating\r\n * browser-specific implementations what &quot;videoSrc&quot; was because one\r\n * implementation of {@link RTCUtils#getVideoSrc} would return\r\n * <tt>MediaStream</tt> (e.g. Firefox), another a <tt>string</tt> representation\r\n * of the <tt>URL</tt> of the <tt>MediaStream</tt> (e.g. Chrome) and the return\r\n * value was only used by {@link RTCUIHelper#getVideoId} which itself did not\r\n * appear to be used anywhere. Generally, the implementation will try to follow\r\n * the related standards i.e. work with the <tt>srcObject</tt> and <tt>src</tt>\r\n * properties of the specified <tt>element</tt> taking into account vender\r\n * prefixes.\r\n *\r\n * @param element the element whose video source/src is to be set to the\r\n * specified <tt>stream</tt>\r\n * @param {MediaStream} stream the <tt>MediaStream</tt> to set as the video\r\n * source/src of <tt>element</tt>\r\n */\r\nfunction defaultSetVideoSrc(element, stream) {\r\n    // srcObject\r\n    let srcObjectPropertyName = 'srcObject';\r\n\r\n    if (!(srcObjectPropertyName in element)) {\r\n        srcObjectPropertyName = 'mozSrcObject';\r\n        if (!(srcObjectPropertyName in element)) {\r\n            srcObjectPropertyName = null;\r\n        }\r\n    }\r\n    if (srcObjectPropertyName) {\r\n        element[srcObjectPropertyName] = stream;\r\n\r\n        return;\r\n    }\r\n\r\n    // src\r\n    let src;\r\n\r\n    if (stream) {\r\n        src = stream.jitsiObjectURL;\r\n\r\n        // Save the created URL for stream so we can reuse it and not keep\r\n        // creating URLs.\r\n        if (!src) {\r\n            stream.jitsiObjectURL\r\n                = src\r\n                    = (URL || webkitURL).createObjectURL(stream);\r\n        }\r\n    }\r\n    element.src = src || '';\r\n}\r\n\r\n/**\r\n *\r\n */\r\nclass RTCUtils extends Listenable {\r\n    /**\r\n     *\r\n     */\r\n    constructor() {\r\n        super(eventEmitter);\r\n    }\r\n\r\n    /**\r\n     * Depending on the browser, sets difference instance methods for\r\n     * interacting with user media and adds methods to native webrtc related\r\n     * objects. Also creates an instance variable for peer connection\r\n     * constraints.\r\n     *\r\n     * @param {Object} options\r\n     * @returns {void}\r\n     */\r\n    init(options = {}) {\r\n        if (typeof options.disableAEC === 'boolean') {\r\n            disableAEC = options.disableAEC;\r\n            logger.info(`Disable AEC: ${disableAEC}`);\r\n        }\r\n        if (typeof options.disableNS === 'boolean') {\r\n            disableNS = options.disableNS;\r\n            logger.info(`Disable NS: ${disableNS}`);\r\n        }\r\n        if (typeof options.disableAP === 'boolean') {\r\n            disableAP = options.disableAP;\r\n            logger.info(`Disable AP: ${disableAP}`);\r\n        }\r\n        if (typeof options.disableAGC === 'boolean') {\r\n            disableAGC = options.disableAGC;\r\n            logger.info(`Disable AGC: ${disableAGC}`);\r\n        }\r\n        if (typeof options.disableHPF === 'boolean') {\r\n            disableHPF = options.disableHPF;\r\n            logger.info(`Disable HPF: ${disableHPF}`);\r\n        }\r\n\r\n        // Initialize rawEnumerateDevicesWithCallback\r\n        initRawEnumerateDevicesWithCallback();\r\n\r\n        return new Promise((resolve, reject) => {\r\n            if (browser.usesNewGumFlow()) {\r\n                this.RTCPeerConnectionType = window.RTCPeerConnection;\r\n\r\n                this.getUserMedia\r\n                    = (constraints, successCallback, errorCallback) =>\r\n                        window.navigator.mediaDevices\r\n                            .getUserMedia(constraints)\r\n                            .then(stream => {\r\n                                successCallback && successCallback(stream);\r\n\r\n                                return stream;\r\n                            })\r\n                            .catch(err => {\r\n                                errorCallback && errorCallback(err);\r\n\r\n                                return Promise.reject(err);\r\n                            });\r\n\r\n                this.enumerateDevices = callback =>\r\n                    window.navigator.mediaDevices.enumerateDevices()\r\n                        .then(foundDevices => {\r\n                            callback(foundDevices);\r\n\r\n                            return foundDevices;\r\n                        })\r\n                        .catch(err => {\r\n                            logger.error(`Error enumerating devices: ${err}`);\r\n\r\n                            callback([]);\r\n\r\n                            return [];\r\n                        });\r\n\r\n                this.attachMediaStream\r\n                    = wrapAttachMediaStream((element, stream) => {\r\n                        if (element) {\r\n                            element.srcObject = stream;\r\n                        }\r\n\r\n                        return element;\r\n                    });\r\n\r\n                this.getStreamID = stream => stream.id;\r\n                this.getTrackID = track => track.id;\r\n            } else if (browser.isChrome() // this is chrome < 61\r\n                    || browser.isOpera()\r\n                    || browser.isNWJS()\r\n                    || browser.isElectron()\r\n                    || browser.isReactNative()) {\r\n\r\n                this.RTCPeerConnectionType = webkitRTCPeerConnection;\r\n                const getUserMedia\r\n                    = navigator.webkitGetUserMedia.bind(navigator);\r\n\r\n                this.getUserMedia = wrapGetUserMedia(getUserMedia);\r\n                this.enumerateDevices = rawEnumerateDevicesWithCallback;\r\n\r\n                this.attachMediaStream\r\n                    = wrapAttachMediaStream((element, stream) => {\r\n                        defaultSetVideoSrc(element, stream);\r\n\r\n                        return element;\r\n                    });\r\n                this.getStreamID = function(stream) {\r\n                    // A. MediaStreams from FF endpoints have the characters '{'\r\n                    // and '}' that make jQuery choke.\r\n                    // B. The react-native-webrtc implementation that we use on\r\n                    // React Native at the time of this writing returns a number\r\n                    // for the id of MediaStream. Let's just say that a number\r\n                    // contains no special characters.\r\n                    const id = stream.id;\r\n\r\n                    // XXX The return statement is affected by automatic\r\n                    // semicolon insertion (ASI). No line terminator is allowed\r\n                    // between the return keyword and the expression.\r\n                    return (\r\n                        typeof id === 'number'\r\n                            ? id\r\n                            : SDPUtil.filterSpecialChars(id));\r\n                };\r\n                this.getTrackID = function(track) {\r\n                    return track.id;\r\n                };\r\n\r\n                if (!webkitMediaStream.prototype.getVideoTracks) {\r\n                    webkitMediaStream.prototype.getVideoTracks = function() {\r\n                        return this.videoTracks;\r\n                    };\r\n                }\r\n                if (!webkitMediaStream.prototype.getAudioTracks) {\r\n                    webkitMediaStream.prototype.getAudioTracks = function() {\r\n                        return this.audioTracks;\r\n                    };\r\n                }\r\n            } else if (browser.isEdge()) {\r\n                this.RTCPeerConnectionType = ortcRTCPeerConnection;\r\n                this.getUserMedia\r\n                    = wrapGetUserMedia(\r\n                        navigator.mediaDevices.getUserMedia.bind(\r\n                            navigator.mediaDevices),\r\n                        true);\r\n                this.enumerateDevices = rawEnumerateDevicesWithCallback;\r\n                this.attachMediaStream\r\n                    = wrapAttachMediaStream((element, stream) => {\r\n                        defaultSetVideoSrc(element, stream);\r\n\r\n                        return element;\r\n                    });\r\n\r\n                // ORTC does not generate remote MediaStreams so those are\r\n                // manually created by the ORTC shim. This means that their\r\n                // id (internally generated) does not match the stream id\r\n                // signaled into the remote SDP. Therefore, the shim adds a\r\n                // custom jitsiRemoteId property with the original stream id.\r\n                this.getStreamID = function(stream) {\r\n                    const id = stream.jitsiRemoteId || stream.id;\r\n\r\n                    return SDPUtil.filterSpecialChars(id);\r\n                };\r\n\r\n                // Remote MediaStreamTracks generated by ORTC (within a\r\n                // RTCRtpReceiver) have an internally/random id which does not\r\n                // match the track id signaled in the remote SDP. The shim adds\r\n                // a custom jitsi-id property with the original track id.\r\n                this.getTrackID = function(track) {\r\n                    return track.jitsiRemoteId || track.id;\r\n                };\r\n            } else if (browser.isTemasysPluginUsed()) {\r\n                // Detect IE/Safari\r\n                const webRTCReadyCb = () => {\r\n                    this.RTCPeerConnectionType = RTCPeerConnection;\r\n                    this.getUserMedia = window.getUserMedia;\r\n                    this.enumerateDevices\r\n                        = enumerateDevicesThroughMediaStreamTrack;\r\n                    this.attachMediaStream\r\n                        = wrapAttachMediaStream((element, stream) => {\r\n                            if (stream) {\r\n                                if (stream.id === 'dummyAudio'\r\n                                        || stream.id === 'dummyVideo') {\r\n                                    return;\r\n                                }\r\n\r\n                                // The container must be visible in order to\r\n                                // play or attach the stream when Temasys plugin\r\n                                // is in use\r\n                                const containerSel = $(element);\r\n\r\n                                if (browser.isTemasysPluginUsed()\r\n                                        && !containerSel.is(':visible')) {\r\n                                    containerSel.show();\r\n                                }\r\n                                const video\r\n                                    = stream.getVideoTracks().length > 0;\r\n\r\n                                if (video && !$(element).is(':visible')) {\r\n                                    throw new Error(\r\n                                        'video element must be visible to'\r\n                                            + ' attach video stream');\r\n                                }\r\n                            }\r\n\r\n                            return attachMediaStream(element, stream);\r\n                        });\r\n                    this.getStreamID\r\n                        = stream => SDPUtil.filterSpecialChars(stream.label);\r\n                    this.getTrackID\r\n                        = track => track.id;\r\n\r\n                    onReady(\r\n                        options,\r\n                        this.getUserMediaWithConstraints.bind(this));\r\n                };\r\n                const webRTCReadyPromise\r\n                    = new Promise(r => AdapterJS.webRTCReady(r));\r\n\r\n                // Resolve or reject depending on whether the Temasys plugin is\r\n                // installed.\r\n                AdapterJS.WebRTCPlugin.isPluginInstalled(\r\n                    AdapterJS.WebRTCPlugin.pluginInfo.prefix,\r\n                    AdapterJS.WebRTCPlugin.pluginInfo.plugName,\r\n                    AdapterJS.WebRTCPlugin.pluginInfo.type,\r\n                    /* installed */ () => {\r\n                        webRTCReadyPromise.then(() => {\r\n                            webRTCReadyCb();\r\n                            resolve();\r\n                        });\r\n                    },\r\n                    /* not installed */ () => {\r\n                        const error\r\n                            = new Error('Temasys plugin is not installed');\r\n\r\n                        error.name = 'WEBRTC_NOT_READY';\r\n                        error.webRTCReadyPromise = webRTCReadyPromise;\r\n\r\n                        reject(error);\r\n                    });\r\n            } else {\r\n                rejectWithWebRTCNotSupported(\r\n                    'Browser does not appear to be WebRTC-capable',\r\n                    reject);\r\n\r\n                return;\r\n            }\r\n\r\n            this._initPCConstraints(options);\r\n\r\n            // Call onReady() if Temasys plugin is not used\r\n            if (!browser.isTemasysPluginUsed()) {\r\n                onReady(options, this.getUserMediaWithConstraints.bind(this));\r\n                resolve();\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Creates instance objects for peer connection constraints both for p2p\r\n     * and outside of p2p.\r\n     *\r\n     * @params {Object} options - Configuration for setting RTCUtil's instance\r\n     * objects for peer connection constraints.\r\n     * @params {boolean} options.useIPv6 - Set to true if IPv6 should be used.\r\n     * @params {boolean} options.disableSuspendVideo - Whether or not video\r\n     * should become suspended if bandwidth estimation becomes low.\r\n     * @params {Object} options.testing - Additional configuration for work in\r\n     * development.\r\n     * @params {Object} options.testing.forceP2PSuspendVideoRatio - True if\r\n     * video should become suspended if bandwidth estimation becomes low while\r\n     * in peer to peer connection mode.\r\n     */\r\n    _initPCConstraints(options) {\r\n        if (browser.isFirefox()) {\r\n            this.pcConstraints = {};\r\n        } else if (browser.isChrome()\r\n            || browser.isOpera()\r\n            || browser.isNWJS()\r\n            || browser.isElectron()\r\n            || browser.isReactNative()) {\r\n            this.pcConstraints = { optional: [\r\n                { googHighStartBitrate: 0 },\r\n                { googPayloadPadding: true },\r\n                { googScreencastMinBitrate: 400 },\r\n                { googCpuOveruseDetection: true },\r\n                { googCpuOveruseEncodeUsage: true },\r\n                { googCpuUnderuseThreshold: 55 },\r\n                { googCpuOveruseThreshold: 85 }\r\n            ] };\r\n\r\n            if (options.useIPv6) {\r\n                // https://code.google.com/p/webrtc/issues/detail?id=2828\r\n                this.pcConstraints.optional.push({ googIPv6: true });\r\n            }\r\n\r\n            this.p2pPcConstraints\r\n                = JSON.parse(JSON.stringify(this.pcConstraints));\r\n\r\n            // Allows sending of video to be suspended if the bandwidth\r\n            // estimation is too low.\r\n            if (!options.disableSuspendVideo) {\r\n                this.pcConstraints.optional.push(\r\n                    { googSuspendBelowMinBitrate: true });\r\n            }\r\n\r\n            // There's no reason not to use this for p2p\r\n            this.p2pPcConstraints.optional.push({\r\n                googSuspendBelowMinBitrate: true\r\n            });\r\n        }\r\n\r\n        this.p2pPcConstraints = this.p2pPcConstraints || this.pcConstraints;\r\n    }\r\n\r\n    /* eslint-disable max-params */\r\n\r\n    /**\r\n    * @param {string[]} um required user media types\r\n    * @param {function} successCallback\r\n    * @param {Function} failureCallback\r\n    * @param {Object} [options] optional parameters\r\n    * @param {string} options.resolution\r\n    * @param {number} options.bandwidth\r\n    * @param {number} options.fps\r\n    * @param {string} options.desktopStream\r\n    * @param {string} options.cameraDeviceId\r\n    * @param {string} options.micDeviceId\r\n    **/\r\n    getUserMediaWithConstraints(\r\n            um,\r\n            successCallback,\r\n            failureCallback,\r\n            options = {}) {\r\n        const constraints = getConstraints(um, options);\r\n\r\n        logger.info('Get media constraints', constraints);\r\n\r\n        try {\r\n            this.getUserMedia(\r\n                constraints,\r\n                stream => {\r\n                    logger.log('onUserMediaSuccess');\r\n                    setAvailableDevices(um, stream);\r\n                    successCallback(stream);\r\n                },\r\n                error => {\r\n                    setAvailableDevices(um, undefined);\r\n                    logger.warn('Failed to get access to local media. Error ',\r\n                        error, constraints);\r\n\r\n                    if (failureCallback) {\r\n                        failureCallback(\r\n                            new JitsiTrackError(error, constraints, um));\r\n                    }\r\n                });\r\n        } catch (e) {\r\n            logger.error('GUM failed: ', e);\r\n\r\n            if (failureCallback) {\r\n                failureCallback(new JitsiTrackError(e, constraints, um));\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Acquires a media stream via getUserMedia that\r\n     * matches the given constraints\r\n     *\r\n     * @param {array} umDevices which devices to acquire (e.g. audio, video)\r\n     * @param {Object} constraints - Stream specifications to use.\r\n     * @returns {Promise}\r\n     */\r\n    _newGetUserMediaWithConstraints(umDevices, constraints = {}) {\r\n        return new Promise((resolve, reject) => {\r\n            try {\r\n                this.getUserMedia(constraints)\r\n                    .then(stream => {\r\n                        logger.log('onUserMediaSuccess');\r\n\r\n                        // TODO(brian): Is this call needed? Why is this\r\n                        // happening at gUM time? Isn't there an event listener\r\n                        // for this?\r\n                        setAvailableDevices(umDevices, stream);\r\n\r\n                        resolve(stream);\r\n                    })\r\n                    .catch(error => {\r\n                        logger.warn('Failed to get access to local media. '\r\n                            + ` ${error} ${constraints} `);\r\n\r\n                        // TODO(brian): Is this call needed? Why is this\r\n                        // happening at gUM time? Isn't there an event listener\r\n                        // for this?\r\n                        setAvailableDevices(umDevices, undefined);\r\n                        reject(new JitsiTrackError(\r\n                            error, constraints, umDevices));\r\n                    });\r\n            } catch (error) {\r\n                logger.error(`GUM failed: ${error}`);\r\n                reject(new JitsiTrackError(error, constraints, umDevices));\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Acquire a display stream via the screenObtainer. This requires extra\r\n     * logic compared to use screenObtainer versus normal device capture logic\r\n     * in RTCUtils#_newGetUserMediaWithConstraints.\r\n     *\r\n     * @param {Object} desktopSharingExtensionExternalInstallation\r\n     * @param {string[]} desktopSharingSources\r\n     * @returns {Promise} A promise which will be resolved with an object whic\r\n     * contains the acquired display stream. If desktop sharing is not supported\r\n     * then a rejected promise will be returned.\r\n     */\r\n    _newGetDesktopMedia(\r\n            desktopSharingExtensionExternalInstallation,\r\n            desktopSharingSources) {\r\n        if (!screenObtainer.isSupported() || !browser.supportsVideo()) {\r\n            return Promise.reject(\r\n                new Error('Desktop sharing is not supported!'));\r\n        }\r\n\r\n        const desktopSharingOptions = {\r\n            ...desktopSharingExtensionExternalInstallation,\r\n            desktopSharingSources\r\n        };\r\n\r\n        return new Promise((resolve, reject) => {\r\n            screenObtainer.obtainStream(\r\n                desktopSharingOptions,\r\n                stream => {\r\n                    resolve(stream);\r\n                },\r\n                error => {\r\n                    reject(error);\r\n                });\r\n        });\r\n    }\r\n\r\n    /* eslint-enable max-params */\r\n\r\n    /**\r\n     * Creates the local MediaStreams.\r\n     * @param {Object} [options] optional parameters\r\n     * @param {Array} options.devices the devices that will be requested\r\n     * @param {string} options.resolution resolution constraints\r\n     * @param {bool} options.dontCreateJitsiTrack if <tt>true</tt> objects with\r\n     * the following structure {stream: the Media Stream, type: \"audio\" or\r\n     * \"video\", videoType: \"camera\" or \"desktop\"} will be returned trough the\r\n     * Promise, otherwise JitsiTrack objects will be returned.\r\n     * @param {string} options.cameraDeviceId\r\n     * @param {string} options.micDeviceId\r\n     * @returns {*} Promise object that will receive the new JitsiTracks\r\n     */\r\n    obtainAudioAndVideoPermissions(options = {}) {\r\n        const self = this;\r\n\r\n        const dsOptions = {\r\n            ...options.desktopSharingExtensionExternalInstallation,\r\n            desktopSharingSources: options.desktopSharingSources\r\n        };\r\n\r\n        return new Promise((resolve, reject) => {\r\n            const successCallback = function(stream) {\r\n                resolve(handleLocalStream(stream, options.resolution));\r\n            };\r\n\r\n            options.devices = options.devices || [ 'audio', 'video' ];\r\n            options.resolution = options.resolution || '720';\r\n\r\n            if (!screenObtainer.isSupported()\r\n                && options.devices.indexOf('desktop') !== -1) {\r\n                reject(new Error('Desktop sharing is not supported!'));\r\n            }\r\n            if (browser.isFirefox()\r\n\r\n                    // XXX The react-native-webrtc implementation that we\r\n                    // utilize on React Native at the time of this writing does\r\n                    // not support the MediaStream constructors defined by\r\n                    // https://www.w3.org/TR/mediacapture-streams/#constructors\r\n                    // and instead has a single constructor which expects (an\r\n                    // NSNumber as) a MediaStream ID.\r\n                    || browser.isReactNative()\r\n                    || browser.isTemasysPluginUsed()) {\r\n                const GUM = function(device, s, e) {\r\n                    this.getUserMediaWithConstraints(device, s, e, options);\r\n                };\r\n\r\n                const deviceGUM = {\r\n                    'audio': GUM.bind(self, [ 'audio' ]),\r\n                    'video': GUM.bind(self, [ 'video' ])\r\n                };\r\n\r\n                if (screenObtainer.isSupported()) {\r\n                    deviceGUM.desktop = screenObtainer.obtainStream.bind(\r\n                        screenObtainer,\r\n                        dsOptions);\r\n                }\r\n\r\n                // With FF/IE we can't split the stream into audio and video\r\n                // because FF doesn't support media stream constructors. So, we\r\n                // need to get the audio stream separately from the video stream\r\n                // using two distinct GUM calls. Not very user friendly :-( but\r\n                // we don't have many other options neither.\r\n                //\r\n                // Note that we pack those 2 streams in a single object and pass\r\n                // it to the successCallback method.\r\n                obtainDevices({\r\n                    devices: options.devices,\r\n                    streams: [],\r\n                    successCallback,\r\n                    errorCallback: reject,\r\n                    deviceGUM\r\n                });\r\n            } else {\r\n                const hasDesktop = options.devices.indexOf('desktop') > -1;\r\n\r\n                if (hasDesktop) {\r\n                    options.devices.splice(\r\n                        options.devices.indexOf('desktop'),\r\n                        1);\r\n                }\r\n\r\n                if (options.devices.length) {\r\n                    this.getUserMediaWithConstraints(\r\n                        options.devices,\r\n                        stream => {\r\n                            const audioDeviceRequested\r\n                                = options.devices.indexOf('audio') !== -1;\r\n                            const videoDeviceRequested\r\n                                = options.devices.indexOf('video') !== -1;\r\n                            const audioTracksReceived\r\n                                = stream.getAudioTracks().length > 0;\r\n                            const videoTracksReceived\r\n                                = stream.getVideoTracks().length > 0;\r\n\r\n                            if ((audioDeviceRequested && !audioTracksReceived)\r\n                                    || (videoDeviceRequested\r\n                                        && !videoTracksReceived)) {\r\n                                self.stopMediaStream(stream);\r\n\r\n                                // We are getting here in case if we requested\r\n                                // 'audio' or 'video' devices or both, but\r\n                                // didn't get corresponding MediaStreamTrack in\r\n                                // response stream. We don't know the reason why\r\n                                // this happened, so reject with general error.\r\n                                // eslint-disable-next-line no-shadow\r\n                                const devices = [];\r\n\r\n                                if (audioDeviceRequested\r\n                                        && !audioTracksReceived) {\r\n                                    devices.push('audio');\r\n                                }\r\n\r\n                                if (videoDeviceRequested\r\n                                        && !videoTracksReceived) {\r\n                                    devices.push('video');\r\n                                }\r\n\r\n                                // we are missing one of the media we requested\r\n                                // in order to get the actual error that caused\r\n                                // this missing media we will call one more time\r\n                                // getUserMedia so we can obtain the actual\r\n                                // error (Example usecases are requesting\r\n                                // audio and video and video device is missing\r\n                                // or device is denied to be used and chrome is\r\n                                // set to not ask for permissions)\r\n                                self.getUserMediaWithConstraints(\r\n                                    devices,\r\n                                    () => {\r\n                                        // we already failed to obtain this\r\n                                        // media, so we are not supposed in any\r\n                                        // way to receive success for this call\r\n                                        // any way we will throw an error to be\r\n                                        // sure the promise will finish\r\n                                        reject(new JitsiTrackError(\r\n                                            { name: 'UnknownError' },\r\n                                            getConstraints(\r\n                                                options.devices,\r\n                                                options),\r\n                                            devices)\r\n                                        );\r\n                                    },\r\n                                    error => {\r\n                                        // rejects with real error for not\r\n                                        // obtaining the media\r\n                                        reject(error);\r\n                                    }, options);\r\n\r\n                                return;\r\n                            }\r\n                            if (hasDesktop) {\r\n                                screenObtainer.obtainStream(\r\n                                    dsOptions,\r\n                                    desktop => {\r\n                                        successCallback({ audioVideo: stream,\r\n                                            desktop });\r\n                                    }, error => {\r\n                                        self.stopMediaStream(stream);\r\n\r\n                                        reject(error);\r\n                                    });\r\n                            } else {\r\n                                successCallback({ audioVideo: stream });\r\n                            }\r\n                        },\r\n                        error => reject(error),\r\n                        options);\r\n                } else if (hasDesktop) {\r\n                    screenObtainer.obtainStream(\r\n                        dsOptions,\r\n                        desktop => successCallback({ desktop }),\r\n                        error => reject(error));\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Gets streams from specified device types. This function intentionally\r\n     * ignores errors for upstream to catch and handle instead.\r\n     *\r\n     * @param {Object} options - A hash describing what devices to get and\r\n     * relevant constraints.\r\n     * @param {string[]} options.devices - The types of media to capture. Valid\r\n     * values are \"desktop\", \"audio\", and \"video\".\r\n     * @returns {Promise} The promise, when successful, will return an array of\r\n     * meta data for the requested device type, which includes the stream and\r\n     * track. If an error occurs, it will be deferred to the caller for\r\n     * handling.\r\n     */\r\n    newObtainAudioAndVideoPermissions(options) {\r\n        logger.info('Using the new gUM flow');\r\n\r\n        const mediaStreamsMetaData = [];\r\n\r\n        // Declare private functions to be used in the promise chain below.\r\n        // These functions are declared in the scope of this function because\r\n        // they are not being used anywhere else, so only this function needs to\r\n        // know about them.\r\n\r\n        /**\r\n         * Executes a request for desktop media if specified in options.\r\n         *\r\n         * @returns {Promise}\r\n         */\r\n        const maybeRequestDesktopDevice = function() {\r\n            const umDevices = options.devices || [];\r\n            const isDesktopDeviceRequsted = umDevices.indexOf('desktop') !== -1;\r\n\r\n            return isDesktopDeviceRequsted\r\n                ? this._newGetDesktopMedia(\r\n                    options.desktopSharingExtensionExternalInstallation,\r\n                    options.desktopSharingSources)\r\n                : Promise.resolve();\r\n        }.bind(this);\r\n\r\n        /**\r\n         * Creates a meta data object about the passed in desktopStream and\r\n         * pushes the meta data to the internal array mediaStreamsMetaData to be\r\n         * returned later.\r\n         *\r\n         * @param {MediaStreamTrack} desktopStream - A track for a desktop\r\n         * capture.\r\n         * @returns {void}\r\n         */\r\n        const maybeCreateAndAddDesktopTrack = function(desktopStream) {\r\n            if (!desktopStream) {\r\n                return;\r\n            }\r\n\r\n            const { stream, sourceId, sourceType } = desktopStream;\r\n\r\n            mediaStreamsMetaData.push({\r\n                stream,\r\n                sourceId,\r\n                sourceType,\r\n                track: stream.getVideoTracks()[0],\r\n                videoType: VideoType.DESKTOP\r\n            });\r\n        };\r\n\r\n        /**\r\n         * Executes a request for audio and/or video, as specified in options.\r\n         * By default both audio and video will be captured if options.devices\r\n         * is not defined.\r\n         *\r\n         * @returns {Promise}\r\n         */\r\n        const maybeRequestCaptureDevices = function() {\r\n            const umDevices = options.devices || [ 'audio', 'video' ];\r\n            const requestedCaptureDevices = umDevices.filter(device =>\r\n                device === 'audio'\r\n                || (device === 'video' && browser.supportsVideo()));\r\n\r\n            if (!requestedCaptureDevices.length) {\r\n                return Promise.resolve();\r\n            }\r\n\r\n            const constraints = newGetConstraints(\r\n                requestedCaptureDevices, options);\r\n\r\n            logger.info('Got media constraints: ', constraints);\r\n\r\n            return this._newGetUserMediaWithConstraints(\r\n                requestedCaptureDevices, constraints);\r\n        }.bind(this);\r\n\r\n        /**\r\n         * Splits the passed in media stream into separate audio and video\r\n         * streams and creates meta data objects for each and pushes them to the\r\n         * internal array mediaStreamsMetaData to be returned later.\r\n         *\r\n         * @param {MediaStreamTrack} avStream - A track for with audio and/or\r\n         * video track.\r\n         * @returns {void}\r\n         */\r\n        const maybeCreateAndAddAVTracks = function(avStream) {\r\n            if (!avStream) {\r\n                return;\r\n            }\r\n\r\n            const audioTracks = avStream.getAudioTracks();\r\n\r\n            if (audioTracks.length) {\r\n                const audioStream = new MediaStream(audioTracks);\r\n\r\n                mediaStreamsMetaData.push({\r\n                    stream: audioStream,\r\n                    track: audioStream.getAudioTracks()[0]\r\n                });\r\n            }\r\n\r\n            const videoTracks = avStream.getVideoTracks();\r\n\r\n            if (videoTracks.length) {\r\n                const videoStream = new MediaStream(videoTracks);\r\n\r\n                mediaStreamsMetaData.push({\r\n                    stream: videoStream,\r\n                    track: videoStream.getVideoTracks()[0],\r\n                    videoType: VideoType.CAMERA\r\n                });\r\n            }\r\n        };\r\n\r\n        return maybeRequestDesktopDevice()\r\n            .then(maybeCreateAndAddDesktopTrack)\r\n            .then(maybeRequestCaptureDevices)\r\n            .then(maybeCreateAndAddAVTracks)\r\n            .then(() => mediaStreamsMetaData);\r\n    }\r\n\r\n    /**\r\n     *\r\n     */\r\n    getDeviceAvailability() {\r\n        return devices;\r\n    }\r\n\r\n    /**\r\n     *\r\n     */\r\n    isRTCReady() {\r\n        return rtcReady;\r\n    }\r\n\r\n    /**\r\n     *\r\n     */\r\n    _isDeviceListAvailable() {\r\n        if (!rtcReady) {\r\n            throw new Error('WebRTC not ready yet');\r\n        }\r\n\r\n        return Boolean(\r\n            (navigator.mediaDevices\r\n                && navigator.mediaDevices.enumerateDevices)\r\n            || (typeof MediaStreamTrack !== 'undefined'\r\n                && MediaStreamTrack.getSources));\r\n    }\r\n\r\n    /**\r\n     * Returns a promise which can be used to make sure that the WebRTC stack\r\n     * has been initialized.\r\n     *\r\n     * @returns {Promise} which is resolved only if the WebRTC stack is ready.\r\n     * Note that currently we do not detect stack initialization failure and\r\n     * the promise is never rejected(unless unexpected error occurs).\r\n     */\r\n    onRTCReady() {\r\n        if (rtcReady) {\r\n            return Promise.resolve();\r\n        }\r\n\r\n        return new Promise(resolve => {\r\n            const listener = () => {\r\n                eventEmitter.removeListener(RTCEvents.RTC_READY, listener);\r\n                resolve();\r\n            };\r\n\r\n            eventEmitter.addListener(RTCEvents.RTC_READY, listener);\r\n\r\n            // We have no failed event, so... it either resolves or nothing\r\n            // happens.\r\n        });\r\n\r\n    }\r\n\r\n    /**\r\n     * Checks if its possible to enumerate available cameras/microphones.\r\n     *\r\n     * @returns {Promise<boolean>} a Promise which will be resolved only once\r\n     * the WebRTC stack is ready, either with true if the device listing is\r\n     * available available or with false otherwise.\r\n     */\r\n    isDeviceListAvailable() {\r\n        return this.onRTCReady().then(this._isDeviceListAvailable.bind(this));\r\n    }\r\n\r\n    /**\r\n     * Returns true if changing the input (camera / microphone) or output\r\n     * (audio) device is supported and false if not.\r\n     * @params {string} [deviceType] - type of device to change. Default is\r\n     *      undefined or 'input', 'output' - for audio output device change.\r\n     * @returns {boolean} true if available, false otherwise.\r\n     */\r\n    isDeviceChangeAvailable(deviceType) {\r\n        return deviceType === 'output' || deviceType === 'audiooutput'\r\n            ? isAudioOutputDeviceChangeAvailable\r\n            : browser.isChrome()\r\n                || browser.isFirefox()\r\n                || browser.isOpera()\r\n                || browser.isTemasysPluginUsed()\r\n                || browser.isNWJS()\r\n                || browser.isElectron()\r\n                || browser.isEdge();\r\n    }\r\n\r\n    /**\r\n     * A method to handle stopping of the stream.\r\n     * One point to handle the differences in various implementations.\r\n     * @param mediaStream MediaStream object to stop.\r\n     */\r\n    stopMediaStream(mediaStream) {\r\n        mediaStream.getTracks().forEach(track => {\r\n            // stop() not supported with IE\r\n            if (!browser.isTemasysPluginUsed() && track.stop) {\r\n                track.stop();\r\n            }\r\n        });\r\n\r\n        // leave stop for implementation still using it\r\n        if (mediaStream.stop) {\r\n            mediaStream.stop();\r\n        }\r\n\r\n        // The MediaStream implementation of the react-native-webrtc project has\r\n        // an explicit release method that is to be invoked in order to release\r\n        // used resources such as memory.\r\n        if (mediaStream.release) {\r\n            mediaStream.release();\r\n        }\r\n\r\n        // if we have done createObjectURL, lets clean it\r\n        const url = mediaStream.jitsiObjectURL;\r\n\r\n        if (url) {\r\n            delete mediaStream.jitsiObjectURL;\r\n            (URL || webkitURL).revokeObjectURL(url);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns whether the desktop sharing is enabled or not.\r\n     * @returns {boolean}\r\n     */\r\n    isDesktopSharingEnabled() {\r\n        return screenObtainer.isSupported();\r\n    }\r\n\r\n    /**\r\n     * Sets current audio output device.\r\n     * @param {string} deviceId - id of 'audiooutput' device from\r\n     *      navigator.mediaDevices.enumerateDevices(), 'default' for default\r\n     *      device\r\n     * @returns {Promise} - resolves when audio output is changed, is rejected\r\n     *      otherwise\r\n     */\r\n    setAudioOutputDevice(deviceId) {\r\n        if (!this.isDeviceChangeAvailable('output')) {\r\n            Promise.reject(\r\n                new Error('Audio output device change is not supported'));\r\n        }\r\n\r\n        return featureDetectionAudioEl.setSinkId(deviceId)\r\n            .then(() => {\r\n                audioOutputDeviceId = deviceId;\r\n                audioOutputChanged = true;\r\n\r\n                logger.log(`Audio output device set to ${deviceId}`);\r\n\r\n                eventEmitter.emit(RTCEvents.AUDIO_OUTPUT_DEVICE_CHANGED,\r\n                    deviceId);\r\n            });\r\n    }\r\n\r\n    /**\r\n     * Returns currently used audio output device id, '' stands for default\r\n     * device\r\n     * @returns {string}\r\n     */\r\n    getAudioOutputDevice() {\r\n        return audioOutputDeviceId;\r\n    }\r\n\r\n    /**\r\n     * Returns list of available media devices if its obtained, otherwise an\r\n     * empty array is returned/\r\n     * @returns {Array} list of available media devices.\r\n     */\r\n    getCurrentlyAvailableMediaDevices() {\r\n        return currentlyAvailableMediaDevices;\r\n    }\r\n\r\n    /**\r\n     * Returns event data for device to be reported to stats.\r\n     * @returns {MediaDeviceInfo} device.\r\n     */\r\n    getEventDataForActiveDevice(device) {\r\n        const deviceList = [];\r\n        const deviceData = {\r\n            'deviceId': device.deviceId,\r\n            'kind': device.kind,\r\n            'label': device.label,\r\n            'groupId': device.groupId\r\n        };\r\n\r\n        deviceList.push(deviceData);\r\n\r\n        return { deviceList };\r\n    }\r\n\r\n    /**\r\n     * Configures the given PeerConnection constraints to either enable or\r\n     * disable (according to the value of the 'enable' parameter) the\r\n     * 'googSuspendBelowMinBitrate' option.\r\n     * @param constraints the constraints on which to operate.\r\n     * @param enable {boolean} whether to enable or disable the suspend video\r\n     * option.\r\n     */\r\n    setSuspendVideo(constraints, enable) {\r\n        if (!constraints.optional) {\r\n            constraints.optional = [];\r\n        }\r\n\r\n        // Get rid of all \"googSuspendBelowMinBitrate\" constraints (we assume\r\n        // that the elements of constraints.optional contain a single property).\r\n        constraints.optional\r\n            = constraints.optional.filter(\r\n                c => !c.hasOwnProperty('googSuspendBelowMinBitrate'));\r\n\r\n        if (enable) {\r\n            constraints.optional.push({ googSuspendBelowMinBitrate: 'true' });\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Rejects a Promise because WebRTC is not supported.\r\n *\r\n * @param {string} errorMessage - The human-readable message of the Error which\r\n * is the reason for the rejection.\r\n * @param {Function} reject - The reject function of the Promise.\r\n * @returns {void}\r\n */\r\nfunction rejectWithWebRTCNotSupported(errorMessage, reject) {\r\n    const error = new Error(errorMessage);\r\n\r\n    // WebRTC is not supported either natively or via a known plugin such as\r\n    // Temasys.\r\n    // XXX The Error class already has a property name which is commonly used to\r\n    // detail the represented error in a non-human-readable way (in contrast to\r\n    // the human-readable property message). I explicitly did not want to\r\n    // introduce a new specific property.\r\n    // FIXME None of the existing JitsiXXXErrors seemed to be appropriate\r\n    // recipients of the constant WEBRTC_NOT_SUPPORTED so I explicitly chose to\r\n    // leave it as a magic string at the time of this writing.\r\n    error.name = 'WEBRTC_NOT_SUPPORTED';\r\n\r\n    logger.error(errorMessage);\r\n    reject(error);\r\n}\r\n\r\nconst rtcUtils = new RTCUtils();\r\n\r\n/**\r\n *\r\n * @param options\r\n */\r\nfunction obtainDevices(options) {\r\n    if (!options.devices || options.devices.length === 0) {\r\n        return options.successCallback(options.streams || {});\r\n    }\r\n\r\n    const device = options.devices.splice(0, 1);\r\n\r\n    options.deviceGUM[device](\r\n        stream => {\r\n            options.streams = options.streams || {};\r\n            options.streams[device] = stream;\r\n            obtainDevices(options);\r\n        },\r\n        error => {\r\n            Object.keys(options.streams).forEach(\r\n                d => rtcUtils.stopMediaStream(options.streams[d]));\r\n            logger.error(\r\n                `failed to obtain ${device} stream - stop`, error);\r\n\r\n            options.errorCallback(error);\r\n        });\r\n}\r\n\r\n/**\r\n * In case of IE we continue from 'onReady' callback passed to RTCUtils\r\n * constructor. It will be invoked by Temasys plugin once it is initialized.\r\n *\r\n * @param options\r\n * @param GUM\r\n */\r\nfunction onReady(options, GUM) {\r\n    rtcReady = true;\r\n    eventEmitter.emit(RTCEvents.RTC_READY, true);\r\n    screenObtainer.init(options, GUM);\r\n\r\n    if (rtcUtils.isDeviceListAvailable() && rawEnumerateDevicesWithCallback) {\r\n        rawEnumerateDevicesWithCallback(ds => {\r\n            currentlyAvailableMediaDevices = ds.splice(0);\r\n\r\n            logger.info('Available devices: ', currentlyAvailableMediaDevices);\r\n            sendDeviceListToAnalytics(currentlyAvailableMediaDevices);\r\n\r\n            eventEmitter.emit(RTCEvents.DEVICE_LIST_AVAILABLE,\r\n                currentlyAvailableMediaDevices);\r\n\r\n            if (isDeviceChangeEventSupported) {\r\n                navigator.mediaDevices.addEventListener(\r\n                    'devicechange',\r\n                    () => rtcUtils.enumerateDevices(onMediaDevicesListChanged));\r\n            } else {\r\n                pollForAvailableMediaDevices();\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * Wraps original attachMediaStream function to set current audio output device\r\n * if this is supported.\r\n * @param {Function} origAttachMediaStream\r\n * @returns {Function}\r\n */\r\nfunction wrapAttachMediaStream(origAttachMediaStream) {\r\n    return function(element, stream) {\r\n        // eslint-disable-next-line prefer-rest-params\r\n        const res = origAttachMediaStream.apply(rtcUtils, arguments);\r\n\r\n        if (stream\r\n                && rtcUtils.isDeviceChangeAvailable('output')\r\n                && stream.getAudioTracks\r\n                && stream.getAudioTracks().length\r\n\r\n                // we skip setting audio output if there was no explicit change\r\n                && audioOutputChanged) {\r\n            element.setSinkId(rtcUtils.getAudioOutputDevice())\r\n                .catch(function(ex) {\r\n                    const err\r\n                        = new JitsiTrackError(ex, null, [ 'audiooutput' ]);\r\n\r\n                    GlobalOnErrorHandler.callUnhandledRejectionHandler({\r\n                        promise: this, // eslint-disable-line no-invalid-this\r\n                        reason: err\r\n                    });\r\n\r\n                    logger.warn(\r\n                        'Failed to set audio output device for the element.'\r\n                            + ' Default audio output device will be used'\r\n                            + ' instead',\r\n                        element,\r\n                        err);\r\n                });\r\n        }\r\n\r\n        return res;\r\n    };\r\n}\r\n\r\nexport default rtcUtils;\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/RTC/RTCUtils.js","import * as transform from 'sdp-transform';\r\n\r\n/**\r\n * Parses the primary SSRC of given SSRC group.\r\n * @param {object} group the SSRC group object as defined by the 'sdp-transform'\r\n * @return {Number} the primary SSRC number\r\n */\r\nexport function parsePrimarySSRC(group) {\r\n    return parseInt(group.ssrcs.split(' ')[0], 10);\r\n}\r\n\r\n/**\r\n * Parses the secondary SSRC of given SSRC group.\r\n * @param {object} group the SSRC group object as defined by the 'sdp-transform'\r\n * @return {Number} the secondary SSRC number\r\n */\r\nexport function parseSecondarySSRC(group) {\r\n    return parseInt(group.ssrcs.split(' ')[1], 10);\r\n}\r\n\r\n/**\r\n * Tells how many distinct SSRCs are contained in given media line.\r\n * @param {Object} mLine the media line object as defined by 'sdp-transform' lib\r\n * @return {number}\r\n */\r\nfunction _getSSRCCount(mLine) {\r\n    if (!mLine.ssrcs) {\r\n        return 0;\r\n    }\r\n\r\n    return mLine.ssrcs\r\n        .map(ssrcInfo => ssrcInfo.id)\r\n        .filter((ssrc, index, array) => array.indexOf(ssrc) === index)\r\n        .length;\r\n}\r\n\r\n/**\r\n * A wrapper around 'sdp-transform' media description object which provides\r\n * utility methods for common SDP/SSRC related operations.\r\n */\r\nclass MLineWrap {\r\n\r\n    /**\r\n     * Creates new <tt>MLineWrap</t>>\r\n     * @param {Object} mLine the media line object as defined by 'sdp-transform'\r\n     * lib.\r\n     */\r\n    constructor(mLine) {\r\n        if (!mLine) {\r\n            throw new Error('mLine is undefined');\r\n        }\r\n\r\n        this.mLine = mLine;\r\n    }\r\n\r\n    /**\r\n     * Getter for the mLine's \"ssrcs\" array. If the array was undefined an empty\r\n     * one will be preassigned.\r\n     *\r\n     * @return {Array<Object>} an array of 'sdp-transform' SSRC attributes\r\n     * objects.\r\n     */\r\n    get ssrcs() {\r\n        if (!this.mLine.ssrcs) {\r\n            this.mLine.ssrcs = [];\r\n        }\r\n\r\n        return this.mLine.ssrcs;\r\n    }\r\n\r\n    /**\r\n     * Setter for the mLine's \"ssrcs\" array.\r\n     *\r\n     * @param {Array<Object>} ssrcs an array of 'sdp-transform' SSRC attributes\r\n     * objects.\r\n     */\r\n    set ssrcs(ssrcs) {\r\n        this.mLine.ssrcs = ssrcs;\r\n    }\r\n\r\n    /**\r\n     * Returns the direction of the underlying media description.\r\n     * @return {string} the media direction name as defined in the SDP.\r\n     */\r\n    get direction() {\r\n        return this.mLine.direction;\r\n    }\r\n\r\n    /**\r\n     * Modifies the direction of the underlying media description.\r\n     * @param {string} direction the new direction to be set\r\n     */\r\n    set direction(direction) {\r\n        this.mLine.direction = direction;\r\n    }\r\n\r\n    /**\r\n     * Exposes the SSRC group array of the underlying media description object.\r\n     * @return {Array.<Object>}\r\n     */\r\n    get ssrcGroups() {\r\n        if (!this.mLine.ssrcGroups) {\r\n            this.mLine.ssrcGroups = [];\r\n        }\r\n\r\n        return this.mLine.ssrcGroups;\r\n    }\r\n\r\n    /**\r\n     * Modifies the SSRC groups array of the underlying media description\r\n     * object.\r\n     * @param {Array.<Object>} ssrcGroups\r\n     */\r\n    set ssrcGroups(ssrcGroups) {\r\n        this.mLine.ssrcGroups = ssrcGroups;\r\n    }\r\n\r\n    /**\r\n     * Obtains value from SSRC attribute.\r\n     * @param {number} ssrcNumber the SSRC number for which attribute is to be\r\n     * found\r\n     * @param {string} attrName the name of the SSRC attribute to be found.\r\n     * @return {string|undefined} the value of SSRC attribute or\r\n     * <tt>undefined</tt> if no such attribute exists.\r\n     */\r\n    getSSRCAttrValue(ssrcNumber, attrName) {\r\n        const attribute = this.ssrcs.find(\r\n            ssrcObj => ssrcObj.id === ssrcNumber\r\n            && ssrcObj.attribute === attrName);\r\n\r\n\r\n        return attribute && attribute.value;\r\n    }\r\n\r\n    /**\r\n     * Removes all attributes for given SSRC number.\r\n     * @param {number} ssrcNum the SSRC number for which all attributes will be\r\n     * removed.\r\n     */\r\n    removeSSRC(ssrcNum) {\r\n        if (!this.mLine.ssrcs || !this.mLine.ssrcs.length) {\r\n            return;\r\n        }\r\n\r\n        this.mLine.ssrcs\r\n            = this.mLine.ssrcs.filter(ssrcObj => ssrcObj.id !== ssrcNum);\r\n    }\r\n\r\n    /**\r\n     * Adds SSRC attribute\r\n     * @param {object} ssrcObj the SSRC attribute object as defined in\r\n     * the 'sdp-transform' lib.\r\n     */\r\n    addSSRCAttribute(ssrcObj) {\r\n        this.ssrcs.push(ssrcObj);\r\n    }\r\n\r\n    /**\r\n     * Finds a SSRC group matching both semantics and SSRCs in order.\r\n     * @param {string} semantics the name of the semantics\r\n     * @param {string} [ssrcs] group SSRCs as a string (like it's defined in\r\n     * SSRC group object of the 'sdp-transform' lib) e.g. \"1232546 342344 25434\"\r\n     * @return {object|undefined} the SSRC group object or <tt>undefined</tt> if\r\n     * not found.\r\n     */\r\n    findGroup(semantics, ssrcs) {\r\n        return this.ssrcGroups.find(\r\n            group =>\r\n                group.semantics === semantics\r\n                    && (!ssrcs || ssrcs === group.ssrcs));\r\n    }\r\n\r\n    /**\r\n     * Finds all groups matching given semantic's name.\r\n     * @param {string} semantics the name of the semantics\r\n     * @return {Array.<object>} an array of SSRC group objects as defined by\r\n     * the 'sdp-transform' lib.\r\n     */\r\n    findGroups(semantics) {\r\n        return this.ssrcGroups.filter(\r\n            group => group.semantics === semantics);\r\n    }\r\n\r\n    /**\r\n     * Finds all groups matching given semantic's name and group's primary SSRC.\r\n     * @param {string} semantics the name of the semantics\r\n     * @param {number} primarySSRC the primary SSRC number to be matched\r\n     * @return {Object} SSRC group object as defined by the 'sdp-transform' lib.\r\n     */\r\n    findGroupByPrimarySSRC(semantics, primarySSRC) {\r\n        return this.ssrcGroups.find(\r\n            group => group.semantics === semantics\r\n                && parsePrimarySSRC(group) === primarySSRC);\r\n    }\r\n\r\n    /**\r\n     * @param {string|null} msid the media stream id or <tt>null</tt> to match\r\n     * the first SSRC object with any 'msid' value.\r\n     * @return {Object|undefined} the SSRC object as defined by 'sdp-transform'\r\n     * lib.\r\n     */\r\n    findSSRCByMSID(msid) {\r\n        return this.ssrcs.find(\r\n            ssrcObj => ssrcObj.attribute === 'msid'\r\n                && (msid === null || ssrcObj.value === msid));\r\n    }\r\n\r\n    /**\r\n     * Gets the SSRC count for the underlying media description.\r\n     * @return {number}\r\n     */\r\n    getSSRCCount() {\r\n        return _getSSRCCount(this.mLine);\r\n    }\r\n\r\n    /**\r\n     * Checks whether the underlying media description contains any SSRC groups.\r\n     * @return {boolean} <tt>true</tt> if there are any SSRC groups or\r\n     * <tt>false</tt> otherwise.\r\n     */\r\n    containsAnySSRCGroups() {\r\n        return this.mLine.ssrcGroups !== undefined;\r\n    }\r\n\r\n    /**\r\n     * Finds the primary video SSRC.\r\n     * @returns {number|undefined} the primary video ssrc\r\n     * @throws Error if the underlying media description is not a video\r\n     */\r\n    getPrimaryVideoSsrc() {\r\n        const mediaType = this.mLine.type;\r\n\r\n        if (mediaType !== 'video') {\r\n            throw new Error(\r\n                `getPrimarySsrc doesn't work with '${mediaType}'`);\r\n        }\r\n\r\n        const numSsrcs = _getSSRCCount(this.mLine);\r\n\r\n        if (numSsrcs === 1) {\r\n            // Not using \"ssrcs\" getter on purpose here\r\n            return this.mLine.ssrcs[0].id;\r\n        }\r\n\r\n        // Look for a SIM, FID, or FEC-FR group\r\n        if (this.mLine.ssrcGroups) {\r\n            const simGroup = this.findGroup('SIM');\r\n\r\n            if (simGroup) {\r\n                return parsePrimarySSRC(simGroup);\r\n            }\r\n            const fidGroup = this.findGroup('FID');\r\n\r\n            if (fidGroup) {\r\n                return parsePrimarySSRC(fidGroup);\r\n            }\r\n            const fecGroup = this.findGroup('FEC-FR');\r\n\r\n            if (fecGroup) {\r\n                return parsePrimarySSRC(fecGroup);\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * Obtains RTX SSRC from the underlying video description (the\r\n     * secondary SSRC of the first \"FID\" group found)\r\n     * @param {number} primarySsrc the video ssrc for which to find the\r\n     * corresponding rtx ssrc\r\n     * @returns {number|undefined} the rtx ssrc (or undefined if there isn't\r\n     * one)\r\n     */\r\n    getRtxSSRC(primarySsrc) {\r\n        const fidGroup = this.findGroupByPrimarySSRC('FID', primarySsrc);\r\n\r\n\r\n        return fidGroup && parseSecondarySSRC(fidGroup);\r\n    }\r\n\r\n    /**\r\n     * Obtains all SSRCs contained in the underlying media description.\r\n     * @return {Array.<number>} an array with all SSRC as numbers.\r\n     */\r\n    getSSRCs() {\r\n        return this.ssrcs\r\n            .map(ssrcInfo => ssrcInfo.id)\r\n            .filter((ssrc, index, array) => array.indexOf(ssrc) === index);\r\n    }\r\n\r\n    /**\r\n     * Obtains primary video SSRCs.\r\n     * @return {Array.<number>} an array of all primary video SSRCs as numbers.\r\n     * @throws Error if the wrapped media description is not a video.\r\n     */\r\n    getPrimaryVideoSSRCs() {\r\n        const mediaType = this.mLine.type;\r\n\r\n        if (mediaType !== 'video') {\r\n            throw new Error(\r\n                `getPrimaryVideoSSRCs doesn't work with ${mediaType}`);\r\n        }\r\n\r\n        const videoSSRCs = this.getSSRCs();\r\n\r\n        for (const ssrcGroupInfo of this.ssrcGroups) {\r\n            // Right now, FID and FEC-FR groups are the only ones we parse to\r\n            // disqualify streams.  If/when others arise we'll\r\n            // need to add support for them here\r\n            if (ssrcGroupInfo.semantics === 'FID'\r\n                    || ssrcGroupInfo.semantics === 'FEC-FR') {\r\n                // secondary streams should be filtered out\r\n                const secondarySsrc = parseSecondarySSRC(ssrcGroupInfo);\r\n\r\n                videoSSRCs.splice(\r\n                    videoSSRCs.indexOf(secondarySsrc), 1);\r\n            }\r\n        }\r\n\r\n        return videoSSRCs;\r\n    }\r\n\r\n    /**\r\n     * Dumps all SSRC groups of this media description to JSON.\r\n     */\r\n    dumpSSRCGroups() {\r\n        return JSON.stringify(this.mLine.ssrcGroups);\r\n    }\r\n\r\n    /**\r\n     * Removes all SSRC groups which contain given SSRC number at any position.\r\n     * @param {number} ssrc the SSRC for which all matching groups are to be\r\n     * removed.\r\n     */\r\n    removeGroupsWithSSRC(ssrc) {\r\n        if (!this.mLine.ssrcGroups) {\r\n            return;\r\n        }\r\n\r\n        this.mLine.ssrcGroups = this.mLine.ssrcGroups\r\n            .filter(groupInfo => groupInfo.ssrcs.indexOf(`${ssrc}`) === -1);\r\n    }\r\n\r\n    /**\r\n     * Removes groups that match given semantics.\r\n     * @param {string} semantics e.g. \"SIM\" or \"FID\"\r\n     */\r\n    removeGroupsBySemantics(semantics) {\r\n        if (!this.mLine.ssrcGroups) {\r\n            return;\r\n        }\r\n\r\n        this.mLine.ssrcGroups\r\n            = this.mLine.ssrcGroups\r\n                .filter(groupInfo => groupInfo.semantics !== semantics);\r\n    }\r\n\r\n    /**\r\n     * Replaces SSRC (does not affect SSRC groups, but only attributes).\r\n     * @param {number} oldSSRC the old SSRC number\r\n     * @param {number} newSSRC the new SSRC number\r\n     */\r\n    replaceSSRC(oldSSRC, newSSRC) {\r\n        if (this.mLine.ssrcs) {\r\n            this.mLine.ssrcs.forEach(ssrcInfo => {\r\n                if (ssrcInfo.id === oldSSRC) {\r\n                    ssrcInfo.id = newSSRC;\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Adds given SSRC group to this media description.\r\n     * @param {object} group the SSRC group object as defined by\r\n     * the 'sdp-transform' lib.\r\n     */\r\n    addSSRCGroup(group) {\r\n        this.ssrcGroups.push(group);\r\n    }\r\n}\r\n\r\n/**\r\n * Utility class for SDP manipulation using the 'sdp-transform' library.\r\n *\r\n * Typical use usage scenario:\r\n *\r\n * const transformer = new SdpTransformWrap(rawSdp);\r\n * const videoMLine = transformer.selectMedia('video);\r\n * if (videoMLine) {\r\n *     videoMLiner.addSSRCAttribute({\r\n *         id: 2342343,\r\n *         attribute: \"cname\",\r\n *         value: \"someCname\"\r\n *     });\r\n *     rawSdp = transformer.toRawSdp();\r\n * }\r\n */\r\nexport class SdpTransformWrap {\r\n\r\n    /**\r\n     * Creates new instance and parses the raw SDP into objects using\r\n     * 'sdp-transform' lib.\r\n     * @param {string} rawSDP the SDP in raw text format.\r\n     */\r\n    constructor(rawSDP) {\r\n        this.parsedSDP = transform.parse(rawSDP);\r\n    }\r\n\r\n    /**\r\n     * Selects the first media SDP of given name.\r\n     * @param {string} mediaType the name of the media e.g. 'audio', 'video',\r\n     * 'data'.\r\n     * @return {MLineWrap|null} return {@link MLineWrap} instance for the media\r\n     * line or <tt>null</tt> if not found. The object returned references\r\n     * the underlying SDP state held by this <tt>SdpTransformWrap</tt> instance\r\n     * (it's not a copy).\r\n     */\r\n    selectMedia(mediaType) {\r\n        const selectedMLine\r\n            = this.parsedSDP.media.find(mLine => mLine.type === mediaType);\r\n\r\n        return selectedMLine ? new MLineWrap(selectedMLine) : null;\r\n    }\r\n\r\n    /**\r\n     * Converts the currently stored SDP state in this instance to raw text SDP\r\n     * format.\r\n     * @return {string}\r\n     */\r\n    toRawSDP() {\r\n        return transform.write(this.parsedSDP);\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/xmpp/SdpTransformUtil.js","/**\r\n * Status that video SIP GW service is available.\r\n * @type {string}\r\n */\r\nexport const STATUS_AVAILABLE = 'available';\r\n\r\n/**\r\n * Status that video SIP GW service is not available.\r\n * @type {string}\r\n */\r\nexport const STATUS_UNDEFINED = 'undefined';\r\n\r\n/**\r\n * Status that video SIP GW service is available but there are no free nodes\r\n * at the moment to serve new requests.\r\n * @type {string}\r\n */\r\nexport const STATUS_BUSY = 'busy';\r\n\r\n/**\r\n * Video SIP GW session state, currently running.\r\n * @type {string}\r\n */\r\nexport const STATE_ON = 'on';\r\n\r\n/**\r\n * Video SIP GW session state, currently stopped and not running.\r\n * @type {string}\r\n */\r\nexport const STATE_OFF = 'off';\r\n\r\n/**\r\n * Video SIP GW session state, currently is starting.\r\n * @type {string}\r\n */\r\nexport const STATE_PENDING = 'pending';\r\n\r\n/**\r\n * Video SIP GW session state, has observed some issues and is retrying at the\r\n * moment.\r\n * @type {string}\r\n */\r\nexport const STATE_RETRYING = 'retrying';\r\n\r\n/**\r\n * Video SIP GW session state, tried to start but it failed.\r\n * @type {string}\r\n */\r\nexport const STATE_FAILED = 'failed';\r\n\r\n/**\r\n * Error on trying to create video SIP GW session in conference where\r\n * there is no room connection (hasn't joined or has left the room).\r\n * @type {string}\r\n */\r\nexport const ERROR_NO_CONNECTION = 'error_no_connection';\r\n\r\n/**\r\n * Error on trying to create video SIP GW session with address for which\r\n * there is an already created session.\r\n * @type {string}\r\n */\r\nexport const ERROR_SESSION_EXISTS = 'error_session_already_exists';\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/videosipgw/VideoSIPGWConstants.js","/**\r\n * Indicates that the local connection statistics were updated.\r\n */\r\nexport const LOCAL_STATS_UPDATED = 'cq.local_stats_updated';\r\n\r\n/**\r\n * Indicates that the connection statistics for a particular remote participant\r\n * were updated.\r\n */\r\nexport const REMOTE_STATS_UPDATED = 'cq.remote_stats_updated';\r\n\n\n\n// WEBPACK FOOTER //\n// ./service/connectivity/ConnectionQualityEvents.js","/**\r\n * The errors for the conference.\r\n */\r\n\r\n/**\r\n * Indicates that client must be authenticated to create the conference.\r\n */\r\nexport const AUTHENTICATION_REQUIRED = 'conference.authenticationRequired';\r\n\r\n/**\r\n * Indicates that chat error occurred.\r\n */\r\nexport const CHAT_ERROR = 'conference.chatError';\r\n\r\n/**\r\n * Indicates that conference has been destroyed.\r\n */\r\nexport const CONFERENCE_DESTROYED = 'conference.destroyed';\r\n\r\n/**\r\n * Indicates that max users limit has been reached.\r\n */\r\nexport const CONFERENCE_MAX_USERS = 'conference.max_users';\r\n\r\n/**\r\n * Indicates that a connection error occurred when trying to join a conference.\r\n */\r\nexport const CONNECTION_ERROR = 'conference.connectionError';\r\n\r\n/**\r\n * Indicates that a connection error is due to not allowed,\r\n * occurred when trying to join a conference.\r\n */\r\nexport const NOT_ALLOWED_ERROR = 'conference.connectionError.notAllowed';\r\n\r\n/**\r\n * Indicates that focus error happened.\r\n */\r\nexport const FOCUS_DISCONNECTED = 'conference.focusDisconnected';\r\n\r\n/**\r\n * Indicates that focus left the conference.\r\n */\r\nexport const FOCUS_LEFT = 'conference.focusLeft';\r\n\r\n/**\r\n * Indicates that graceful shutdown happened.\r\n */\r\nexport const GRACEFUL_SHUTDOWN = 'conference.gracefulShutdown';\r\n\r\n/**\r\n * Indicates that the versions of the server side components are incompatible\r\n * with the client side.\r\n */\r\nexport const INCOMPATIBLE_SERVER_VERSIONS\r\n    = 'conference.incompatible_server_versions';\r\n\r\n/**\r\n * Indicates that jingle fatal error happened.\r\n */\r\nexport const JINGLE_FATAL_ERROR = 'conference.jingleFatalError';\r\n\r\n/**\r\n * Indicates that password cannot be set for this conference.\r\n */\r\nexport const PASSWORD_NOT_SUPPORTED = 'conference.passwordNotSupported';\r\n\r\n/**\r\n * Indicates that a password is required in order to join the conference.\r\n */\r\nexport const PASSWORD_REQUIRED = 'conference.passwordRequired';\r\n\r\n/**\r\n * Indicates that reservation system returned error.\r\n */\r\nexport const RESERVATION_ERROR = 'conference.reservationError';\r\n\r\n/**\r\n * Indicates that the conference setup failed.\r\n */\r\nexport const SETUP_FAILED = 'conference.setup_failed';\r\n\r\n/**\r\n * Indicates that there is no available videobridge.\r\n */\r\nexport const VIDEOBRIDGE_NOT_AVAILABLE = 'conference.videobridgeNotAvailable';\r\n\n\n\n// WEBPACK FOOTER //\n// ./JitsiConferenceErrors.js","/*! callstats.js  version = 3.27.0 2017-12-14 */\nfunction SWPlugin(){this.attaches=[],this.signalListeners=[],this.mapFnc=null}SWPlugin.prototype={constructor:SWPlugin,add:function(a){console.log(\"Abstract method is called width value: \"+a)},remove:function(a){console.log(\"Abstract method is called with value: \"+a)},attach:function(a,b){this.attaches.push({cb:a,that:\"undefined\"==typeof b?null:b})},notify:function(a){for(var b=0;b<this.attaches.length;++b){var c=this.attaches[b];c.cb?c.cb.call(c.that,a):c.cb(a)}},addMapFnc:function(a){this.mapFnc=a},map:function(){},mapping:function(a,b){null!==this.mapFnc&&this.mapFnc(a,b)},addSignalListener:function(a,b,c){this.signalListeners.push({signalName:a,cb:b,that:\"undefined\"==typeof c?null:c})},signalize:function(a,b){for(var c=0;c<this.signalListeners.length;++c){var d=this.signalListeners[c];d.signalName===a&&null!==d.cb&&void 0!==d.cb&&(d.that?d.cb.call(d.that,b):d.cb(b))}}},module.exports=SWPlugin;\n\n\n// WEBPACK FOOTER //\n// ./node_modules/react-native-callstats/swPlugin.js","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/process/browser.js","const Resolutions = {\r\n    '1080': {\r\n        width: 1920,\r\n        height: 1080,\r\n        order: 7\r\n    },\r\n    'fullhd': {\r\n        width: 1920,\r\n        height: 1080,\r\n        order: 7\r\n    },\r\n    '720': {\r\n        width: 1280,\r\n        height: 720,\r\n        order: 6\r\n    },\r\n    'hd': {\r\n        width: 1280,\r\n        height: 720,\r\n        order: 6\r\n    },\r\n    '960': {\r\n        width: 960,\r\n        height: 720,\r\n        order: 5\r\n    },\r\n\r\n    // 16:9 resolution first.\r\n    '360': {\r\n        width: 640,\r\n        height: 360,\r\n        order: 4\r\n    },\r\n    '640': {\r\n        width: 640,\r\n        height: 480,\r\n        order: 3\r\n    },\r\n    'vga': {\r\n        width: 640,\r\n        height: 480,\r\n        order: 3\r\n    },\r\n\r\n    // 16:9 resolution first.\r\n    '180': {\r\n        width: 320,\r\n        height: 180,\r\n        order: 2\r\n    },\r\n    '320': {\r\n        width: 320,\r\n        height: 240,\r\n        order: 1\r\n    }\r\n};\r\n\r\nmodule.exports = Resolutions;\r\n\n\n\n// WEBPACK FOOTER //\n// ./service/RTC/Resolutions.js","/* global __filename */\r\nimport { getLogger } from 'jitsi-meet-logger';\r\nimport * as JitsiConferenceEvents from '../../JitsiConferenceEvents';\r\nimport * as JitsiTrackEvents from '../../JitsiTrackEvents';\r\nimport * as MediaType from '../../service/RTC/MediaType';\r\nimport browser from '../browser';\r\nimport RTCEvents from '../../service/RTC/RTCEvents';\r\nimport Statistics from '../statistics/statistics';\r\n\r\nconst logger = getLogger(__filename);\r\n\r\n/**\r\n * Default value of 500 milliseconds for\r\n * {@link ParticipantConnectionStatus.outOfLastNTimeout}.\r\n *\r\n * @type {number}\r\n */\r\nconst DEFAULT_NOT_IN_LAST_N_TIMEOUT = 500;\r\n\r\n/**\r\n * Default value of 2000 milliseconds for\r\n * {@link ParticipantConnectionStatus.rtcMuteTimeout}.\r\n *\r\n * @type {number}\r\n */\r\nconst DEFAULT_RTC_MUTE_TIMEOUT = 2000;\r\n\r\n/**\r\n * The time to wait a track to be restored. Track which was out of lastN\r\n * should be inactive and when entering lastN it becomes restoring and when\r\n * data is received from bridge it will become active, but if no data is\r\n * received for some time we set status of that participant connection to\r\n * interrupted.\r\n * @type {number}\r\n */\r\nconst DEFAULT_RESTORING_TIMEOUT = 5000;\r\n\r\n/**\r\n * Participant connection statuses.\r\n *\r\n * @type {{\r\n *      ACTIVE: string,\r\n *      INACTIVE: string,\r\n *      INTERRUPTED: string,\r\n *      RESTORING: string\r\n * }}\r\n */\r\nexport const ParticipantConnectionStatus = {\r\n    /**\r\n     * Status indicating that connection is currently active.\r\n     */\r\n    ACTIVE: 'active',\r\n\r\n    /**\r\n     * Status indicating that connection is currently inactive.\r\n     * Inactive means the connection was stopped on purpose from the bridge,\r\n     * like exiting lastN or adaptivity decided to drop video because of not\r\n     * enough bandwidth.\r\n     */\r\n    INACTIVE: 'inactive',\r\n\r\n    /**\r\n     * Status indicating that connection is currently interrupted.\r\n     */\r\n    INTERRUPTED: 'interrupted',\r\n\r\n    /**\r\n     * Status indicating that connection is currently restoring.\r\n     */\r\n    RESTORING: 'restoring'\r\n};\r\n\r\n/**\r\n * Class is responsible for emitting\r\n * JitsiConferenceEvents.PARTICIPANT_CONN_STATUS_CHANGED events.\r\n */\r\nexport default class ParticipantConnectionStatusHandler {\r\n    /* eslint-disable max-params*/\r\n    /**\r\n     * Calculates the new {@link ParticipantConnectionStatus} based on\r\n     * the values given for some specific remote user. It is assumed that\r\n     * the conference is currently in the JVB mode (in contrary to the P2P mode)\r\n     * @param {boolean} isConnectionActiveByJvb true if the JVB did not get any\r\n     * data from the user for the last 15 seconds.\r\n     * @param {boolean} isInLastN indicates whether the user is in the last N\r\n     * set. When set to false it means that JVB is not sending any video for\r\n     * the user.\r\n     * @param {boolean} isRestoringTimedout if true it means that the user has\r\n     * been outside of last N too long to be considered\r\n     * {@link ParticipantConnectionStatus.RESTORING}.\r\n     * @param {boolean} isVideoMuted true if the user is video muted and we\r\n     * should not expect to receive any video.\r\n     * @param {boolean} isVideoTrackFrozen if the current browser support video\r\n     * frozen detection then it will be set to true when the video track is\r\n     * frozen. If the current browser does not support frozen detection the it's\r\n     * always false.\r\n     * @return {ParticipantConnectionStatus} the new connection status for\r\n     * the user for whom the values above were provided.\r\n     * @private\r\n     */\r\n    static _getNewStateForJvbMode(\r\n            isConnectionActiveByJvb,\r\n            isInLastN,\r\n            isRestoringTimedout,\r\n            isVideoMuted,\r\n            isVideoTrackFrozen) {\r\n        if (!isConnectionActiveByJvb) {\r\n            // when there is a connection problem signaled from jvb\r\n            // it means no media was flowing for at least 15secs, so both audio\r\n            // and video are most likely interrupted\r\n            return ParticipantConnectionStatus.INTERRUPTED;\r\n        } else if (isVideoMuted) {\r\n            // If the connection is active according to JVB and the user is\r\n            // video muted there is no way for the connection to be inactive,\r\n            // because the detection logic below only makes sense for video.\r\n            return ParticipantConnectionStatus.ACTIVE;\r\n        }\r\n\r\n        // Logic when isVideoTrackFrozen is supported\r\n        if (browser.supportsVideoMuteOnConnInterrupted()) {\r\n            if (!isVideoTrackFrozen) {\r\n                // If the video is playing we're good\r\n                return ParticipantConnectionStatus.ACTIVE;\r\n            } else if (isInLastN) {\r\n                return isRestoringTimedout\r\n                    ? ParticipantConnectionStatus.INTERRUPTED\r\n                    : ParticipantConnectionStatus.RESTORING;\r\n            }\r\n\r\n            return ParticipantConnectionStatus.INACTIVE;\r\n        }\r\n\r\n        // Because this browser is incapable of detecting frozen video we must\r\n        // rely on the lastN value\r\n        return isInLastN\r\n            ? ParticipantConnectionStatus.ACTIVE\r\n            : ParticipantConnectionStatus.INACTIVE;\r\n    }\r\n\r\n    /* eslint-enable max-params*/\r\n\r\n    /**\r\n     * In P2P mode we don't care about any values coming from the JVB and\r\n     * the connection status can be only active or interrupted.\r\n     * @param {boolean} isVideoMuted the user if video muted\r\n     * @param {boolean} isVideoTrackFrozen true if the video track for\r\n     * the remote user is currently frozen. If the current browser does not\r\n     * support video frozen detection then it's always false.\r\n     * @return {ParticipantConnectionStatus}\r\n     * @private\r\n     */\r\n    static _getNewStateForP2PMode(isVideoMuted, isVideoTrackFrozen) {\r\n        if (!browser.supportsVideoMuteOnConnInterrupted()) {\r\n            // There's no way to detect problems in P2P when there's no video\r\n            // track frozen detection...\r\n            return ParticipantConnectionStatus.ACTIVE;\r\n        }\r\n\r\n        return isVideoMuted || !isVideoTrackFrozen\r\n            ? ParticipantConnectionStatus.ACTIVE\r\n            : ParticipantConnectionStatus.INTERRUPTED;\r\n    }\r\n\r\n    /**\r\n     * Creates new instance of <tt>ParticipantConnectionStatus</tt>.\r\n     *\r\n     * @constructor\r\n     * @param {RTC} rtc the RTC service instance\r\n     * @param {JitsiConference} conference parent conference instance\r\n     * @param {Object} options\r\n     * @param {number} [options.rtcMuteTimeout=2000] custom value for\r\n     * {@link ParticipantConnectionStatus.rtcMuteTimeout}.\r\n     * @param {number} [options.outOfLastNTimeout=500] custom value for\r\n     * {@link ParticipantConnectionStatus.outOfLastNTimeout}.\r\n     */\r\n    constructor(rtc, conference, options) {\r\n        this.rtc = rtc;\r\n        this.conference = conference;\r\n\r\n        /**\r\n         * A map of the \"endpoint ID\"(which corresponds to the resource part\r\n         * of MUC JID(nickname)) to the timeout callback IDs scheduled using\r\n         * window.setTimeout.\r\n         * @type {Object.<string, number>}\r\n         */\r\n        this.trackTimers = {};\r\n\r\n        /**\r\n         * This map holds the endpoint connection status received from the JVB\r\n         * (as it might be different than the one stored in JitsiParticipant).\r\n         * Required for getting back in sync when remote video track is removed.\r\n         * @type {Object.<string, boolean>}\r\n         */\r\n        this.connStatusFromJvb = { };\r\n\r\n        /**\r\n         * If video track frozen detection through RTC mute event is supported,\r\n         * we wait some time until video track is considered frozen. But because\r\n         * when the user falls out of last N it is expected for the video to\r\n         * freeze this timeout must be significantly reduced in \"out of last N\"\r\n         * case.\r\n         *\r\n         * Basically this value is used instead of {@link rtcMuteTimeout} when\r\n         * user is not in last N.\r\n         * @type {number}\r\n         */\r\n        this.outOfLastNTimeout\r\n            = typeof options.outOfLastNTimeout === 'number'\r\n                ? options.outOfLastNTimeout : DEFAULT_NOT_IN_LAST_N_TIMEOUT;\r\n\r\n        /**\r\n         * How long we're going to wait after the RTC video track muted event\r\n         * for the corresponding signalling mute event, before the connection\r\n         * interrupted is fired. The default value is\r\n         * {@link DEFAULT_RTC_MUTE_TIMEOUT}.\r\n         *\r\n         * @type {number} amount of time in milliseconds\r\n         */\r\n        this.rtcMuteTimeout\r\n            = typeof options.rtcMuteTimeout === 'number'\r\n                ? options.rtcMuteTimeout : DEFAULT_RTC_MUTE_TIMEOUT;\r\n\r\n        /**\r\n         * This map holds a timestamp indicating  when participant's video track\r\n         * was RTC muted (it is assumed that each participant can have only 1\r\n         * video track at a time). The purpose of storing the timestamp is to\r\n         * avoid the transition to disconnected status in case of legitimate\r\n         * video mute operation where the signalling video muted event can\r\n         * arrive shortly after RTC muted event.\r\n         *\r\n         * The key is participant's ID which is the same as endpoint id in\r\n         * the Colibri conference allocated on the JVB.\r\n         *\r\n         * The value is a timestamp measured in milliseconds obtained with\r\n         * <tt>Date.now()</tt>.\r\n         *\r\n         * FIXME merge this logic with NO_DATA_FROM_SOURCE event\r\n         *       implemented in JitsiLocalTrack by extending the event to\r\n         *       the remote track and allowing to set different timeout for\r\n         *       local and remote tracks.\r\n         *\r\n         * @type {Object.<string, number>}\r\n         */\r\n        this.rtcMutedTimestamp = { };\r\n        logger.info(`RtcMuteTimeout set to: ${this.rtcMuteTimeout}`);\r\n\r\n        /**\r\n         * This map holds the timestamps indicating when participant's video\r\n         * entered lastN set. Participants entering lastN will have connection\r\n         * status restoring and when we start receiving video will become\r\n         * active, but if video is not received for certain time\r\n         * {@link DEFAULT_RESTORING_TIMEOUT} that participant connection status\r\n         * will become interrupted.\r\n         *\r\n         * @type {Map<string, number>}\r\n         */\r\n        this.enteredLastNTimestamp = new Map();\r\n\r\n        /**\r\n         * A map of the \"endpoint ID\"(which corresponds to the resource part\r\n         * of MUC JID(nickname)) to the restoring timeout callback IDs\r\n         * scheduled using window.setTimeout.\r\n         *\r\n         * @type {Map<string, number>}\r\n         */\r\n        this.restoringTimers = new Map();\r\n    }\r\n\r\n    /**\r\n     * Gets the video frozen timeout for given user.\r\n     * @param {string} id endpoint/participant ID\r\n     * @return {number} how long are we going to wait since RTC video muted\r\n     * even, before a video track is considered frozen.\r\n     * @private\r\n     */\r\n    _getVideoFrozenTimeout(id) {\r\n        return this.rtc.isInLastN(id)\r\n            ? this.rtcMuteTimeout : this.outOfLastNTimeout;\r\n    }\r\n\r\n    /**\r\n     * Initializes <tt>ParticipantConnectionStatus</tt> and bind required event\r\n     * listeners.\r\n     */\r\n    init() {\r\n\r\n        this._onEndpointConnStatusChanged\r\n            = this.onEndpointConnStatusChanged.bind(this);\r\n\r\n        this.rtc.addListener(\r\n            RTCEvents.ENDPOINT_CONN_STATUS_CHANGED,\r\n            this._onEndpointConnStatusChanged);\r\n\r\n        // Handles P2P status changes\r\n        this._onP2PStatus = this.refreshConnectionStatusForAll.bind(this);\r\n        this.conference.on(JitsiConferenceEvents.P2P_STATUS, this._onP2PStatus);\r\n\r\n        // On some browsers MediaStreamTrack trigger \"onmute\"/\"onunmute\"\r\n        // events for video type tracks when they stop receiving data which is\r\n        // often a sign that remote user is having connectivity issues\r\n        if (browser.supportsVideoMuteOnConnInterrupted()) {\r\n\r\n            this._onTrackRtcMuted = this.onTrackRtcMuted.bind(this);\r\n            this.rtc.addListener(\r\n                RTCEvents.REMOTE_TRACK_MUTE, this._onTrackRtcMuted);\r\n\r\n            this._onTrackRtcUnmuted = this.onTrackRtcUnmuted.bind(this);\r\n            this.rtc.addListener(\r\n                RTCEvents.REMOTE_TRACK_UNMUTE, this._onTrackRtcUnmuted);\r\n\r\n            // Track added/removed listeners are used to bind \"mute\"/\"unmute\"\r\n            // event handlers\r\n            this._onRemoteTrackAdded = this.onRemoteTrackAdded.bind(this);\r\n            this.conference.on(\r\n                JitsiConferenceEvents.TRACK_ADDED,\r\n                this._onRemoteTrackAdded);\r\n\r\n            this._onRemoteTrackRemoved = this.onRemoteTrackRemoved.bind(this);\r\n            this.conference.on(\r\n                JitsiConferenceEvents.TRACK_REMOVED,\r\n                this._onRemoteTrackRemoved);\r\n\r\n            // Listened which will be bound to JitsiRemoteTrack to listen for\r\n            // signalling mute/unmute events.\r\n            this._onSignallingMuteChanged\r\n                = this.onSignallingMuteChanged.bind(this);\r\n        }\r\n\r\n        this._onLastNChanged = this._onLastNChanged.bind(this);\r\n        this.conference.on(\r\n            JitsiConferenceEvents.LAST_N_ENDPOINTS_CHANGED,\r\n            this._onLastNChanged);\r\n\r\n        this._onLastNValueChanged\r\n            = this.refreshConnectionStatusForAll.bind(this);\r\n        this.rtc.on(\r\n            RTCEvents.LASTN_VALUE_CHANGED, this._onLastNValueChanged);\r\n    }\r\n\r\n    /**\r\n     * Removes all event listeners and disposes of all resources held by this\r\n     * instance.\r\n     */\r\n    dispose() {\r\n\r\n        this.rtc.removeListener(\r\n            RTCEvents.ENDPOINT_CONN_STATUS_CHANGED,\r\n            this._onEndpointConnStatusChanged);\r\n\r\n        if (browser.supportsVideoMuteOnConnInterrupted()) {\r\n            this.rtc.removeListener(\r\n                RTCEvents.REMOTE_TRACK_MUTE,\r\n                this._onTrackRtcMuted);\r\n            this.rtc.removeListener(\r\n                RTCEvents.REMOTE_TRACK_UNMUTE,\r\n                this._onTrackRtcUnmuted);\r\n\r\n            this.conference.off(\r\n                JitsiConferenceEvents.TRACK_ADDED,\r\n                this._onRemoteTrackAdded);\r\n            this.conference.off(\r\n                JitsiConferenceEvents.TRACK_REMOVED,\r\n                this._onRemoteTrackRemoved);\r\n        }\r\n\r\n        this.conference.off(\r\n            JitsiConferenceEvents.LAST_N_ENDPOINTS_CHANGED,\r\n            this._onLastNChanged);\r\n\r\n        this.rtc.removeListener(\r\n            RTCEvents.LASTN_VALUE_CHANGED, this._onLastNValueChanged);\r\n\r\n        this.conference.off(\r\n            JitsiConferenceEvents.P2P_STATUS, this._onP2PStatus);\r\n\r\n        const participantIds = Object.keys(this.trackTimers);\r\n\r\n        for (const participantId of participantIds) {\r\n            this.clearTimeout(participantId);\r\n            this.clearRtcMutedTimestamp(participantId);\r\n        }\r\n\r\n        // Clear RTC connection status cache\r\n        this.connStatusFromJvb = {};\r\n    }\r\n\r\n    /**\r\n     * Handles RTCEvents.ENDPOINT_CONN_STATUS_CHANGED triggered when we receive\r\n     * notification over the data channel from the bridge about endpoint's\r\n     * connection status update.\r\n     * @param {string} endpointId the endpoint ID(MUC nickname/resource JID)\r\n     * @param {boolean} isActive true if the connection is OK or false otherwise\r\n     */\r\n    onEndpointConnStatusChanged(endpointId, isActive) {\r\n\r\n        logger.debug(\r\n            `Detector RTCEvents.ENDPOINT_CONN_STATUS_CHANGED(${Date.now()}): ${\r\n                endpointId}: ${isActive}`);\r\n\r\n        // Filter out events for the local JID for now\r\n        if (endpointId !== this.conference.myUserId()) {\r\n            // Store the status received over the data channels\r\n            this.connStatusFromJvb[endpointId] = isActive;\r\n            this.figureOutConnectionStatus(endpointId);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Changes connection status.\r\n     * @param {JitsiParticipant} participant\r\n     * @param newStatus\r\n     */\r\n    _changeConnectionStatus(participant, newStatus) {\r\n        if (participant.getConnectionStatus() !== newStatus) {\r\n\r\n            const endpointId = participant.getId();\r\n\r\n            participant._setConnectionStatus(newStatus);\r\n\r\n            logger.debug(\r\n                `Emit endpoint conn status(${Date.now()}) ${endpointId}: ${\r\n                    newStatus}`);\r\n\r\n            // Log the event on CallStats\r\n            Statistics.sendLog(\r\n                JSON.stringify({\r\n                    id: 'peer.conn.status',\r\n                    participant: endpointId,\r\n                    status: newStatus\r\n                }));\r\n\r\n            this.conference.eventEmitter.emit(\r\n                JitsiConferenceEvents.PARTICIPANT_CONN_STATUS_CHANGED,\r\n                endpointId, newStatus);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Reset the postponed \"connection interrupted\" event which was previously\r\n     * scheduled as a timeout on RTC 'onmute' event.\r\n     *\r\n     * @param {string} participantId the participant for which the \"connection\r\n     * interrupted\" timeout was scheduled\r\n     */\r\n    clearTimeout(participantId) {\r\n        if (this.trackTimers[participantId]) {\r\n            window.clearTimeout(this.trackTimers[participantId]);\r\n            this.trackTimers[participantId] = null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Clears the timestamp of the RTC muted event for participant's video track\r\n     * @param {string} participantId the id of the conference participant which\r\n     * is the same as the Colibri endpoint ID of the video channel allocated for\r\n     * the user on the videobridge.\r\n     */\r\n    clearRtcMutedTimestamp(participantId) {\r\n        this.rtcMutedTimestamp[participantId] = null;\r\n    }\r\n\r\n    /**\r\n     * Bind signalling mute event listeners for video {JitsiRemoteTrack} when\r\n     * a new one is added to the conference.\r\n     *\r\n     * @param {JitsiTrack} remoteTrack the {JitsiTrack} which is being added to\r\n     * the conference.\r\n     */\r\n    onRemoteTrackAdded(remoteTrack) {\r\n        if (!remoteTrack.isLocal()\r\n                && remoteTrack.getType() === MediaType.VIDEO) {\r\n\r\n            logger.debug(\r\n                `Detector on remote track added for: ${\r\n                    remoteTrack.getParticipantId()}`);\r\n\r\n            remoteTrack.on(\r\n                JitsiTrackEvents.TRACK_MUTE_CHANGED,\r\n                this._onSignallingMuteChanged);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Removes all event listeners bound to the remote video track and clears\r\n     * any related timeouts.\r\n     *\r\n     * @param {JitsiRemoteTrack} remoteTrack the remote track which is being\r\n     * removed from the conference.\r\n     */\r\n    onRemoteTrackRemoved(remoteTrack) {\r\n        if (!remoteTrack.isLocal()\r\n                && remoteTrack.getType() === MediaType.VIDEO) {\r\n\r\n            const endpointId = remoteTrack.getParticipantId();\r\n\r\n            logger.debug(`Detector on remote track removed: ${endpointId}`);\r\n\r\n            remoteTrack.off(\r\n                JitsiTrackEvents.TRACK_MUTE_CHANGED,\r\n                this._onSignallingMuteChanged);\r\n\r\n            this.clearTimeout(endpointId);\r\n            this.clearRtcMutedTimestamp(endpointId);\r\n\r\n            this.figureOutConnectionStatus(endpointId);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Checks if given participant's video is considered frozen.\r\n     * @param {JitsiParticipant} participant\r\n     * @return {boolean} <tt>true</tt> if the video has frozen for given\r\n     * participant or <tt>false</tt> when it's either not considered frozen\r\n     * (yet) or if freeze detection is not supported by the current browser.\r\n     *\r\n     * FIXME merge this logic with NO_DATA_FROM_SOURCE event\r\n     *       implemented in JitsiLocalTrack by extending the event to\r\n     *       the remote track and allowing to set different timeout for\r\n     *       local and remote tracks.\r\n     *\r\n     */\r\n    isVideoTrackFrozen(participant) {\r\n        if (!browser.supportsVideoMuteOnConnInterrupted()) {\r\n            return false;\r\n        }\r\n\r\n        const id = participant.getId();\r\n        const hasAnyVideoRTCMuted = participant.hasAnyVideoTrackWebRTCMuted();\r\n        const rtcMutedTimestamp = this.rtcMutedTimestamp[id];\r\n        const timeout = this._getVideoFrozenTimeout(id);\r\n\r\n        return hasAnyVideoRTCMuted\r\n            && typeof rtcMutedTimestamp === 'number'\r\n            && (Date.now() - rtcMutedTimestamp) >= timeout;\r\n    }\r\n\r\n    /**\r\n     * Goes over every participant and updates connectivity status.\r\n     * Should be called when a parameter which affects all of the participants\r\n     * is changed (P2P for example).\r\n     */\r\n    refreshConnectionStatusForAll() {\r\n        const participants = this.conference.getParticipants();\r\n\r\n        for (const participant of participants) {\r\n            this.figureOutConnectionStatus(participant.getId());\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Figures out (and updates) the current connectivity status for\r\n     * the participant identified by the given id.\r\n     *\r\n     * @param {string} id the participant's id (MUC nickname or Colibri endpoint\r\n     * ID).\r\n     */\r\n    figureOutConnectionStatus(id) {\r\n        const participant = this.conference.getParticipantById(id);\r\n\r\n        if (!participant) {\r\n            // Probably the participant is no longer in the conference\r\n            // (at the time of writing this code, participant is\r\n            // detached from the conference and TRACK_REMOVED events are\r\n            // fired),\r\n            // so we don't care, but let's print the warning for\r\n            // debugging purpose\r\n            logger.warn(`figure out conn status - no participant for: ${id}`);\r\n\r\n            return;\r\n        }\r\n\r\n        const inP2PMode = this.conference.isP2PActive();\r\n        const isRestoringTimedOut = this._isRestoringTimedout(id);\r\n        const audioOnlyMode = this.rtc.getLastN() === 0;\r\n\r\n        // NOTE Overriding videoMuted to true for audioOnlyMode should disable\r\n        // any detection based on video playback or the last N.\r\n        const isVideoMuted = participant.isVideoMuted() || audioOnlyMode;\r\n        const isVideoTrackFrozen = this.isVideoTrackFrozen(participant);\r\n        const isInLastN = this.rtc.isInLastN(id);\r\n        let isConnActiveByJvb = this.connStatusFromJvb[id];\r\n\r\n        if (typeof isConnActiveByJvb !== 'boolean') {\r\n            // If no status was received from the JVB it means that it's active\r\n            // (the bridge does not send notification unless there is a problem)\r\n            logger.debug('Assuming connection active by JVB - no notification');\r\n            isConnActiveByJvb = true;\r\n        }\r\n\r\n        const newState\r\n            = inP2PMode\r\n                ? ParticipantConnectionStatusHandler._getNewStateForP2PMode(\r\n                    isVideoMuted,\r\n                    isVideoTrackFrozen)\r\n                : ParticipantConnectionStatusHandler._getNewStateForJvbMode(\r\n                    isConnActiveByJvb,\r\n                    isInLastN,\r\n                    isRestoringTimedOut,\r\n                    isVideoMuted,\r\n                    isVideoTrackFrozen);\r\n\r\n        // if the new state is not restoring clear timers and timestamps\r\n        // that we use to track the restoring state\r\n        if (newState !== ParticipantConnectionStatus.RESTORING) {\r\n            this._clearRestoringTimer(id);\r\n        }\r\n\r\n        logger.debug(\r\n            `Figure out conn status for ${id}, is video muted: ${\r\n                isVideoMuted} is active(jvb): ${\r\n                isConnActiveByJvb} video track frozen: ${\r\n                isVideoTrackFrozen} p2p mode: ${\r\n                inP2PMode} is in last N: ${\r\n                isInLastN} currentStatus => newStatus: ${\r\n                participant.getConnectionStatus()} => ${newState}`);\r\n\r\n        this._changeConnectionStatus(participant, newState);\r\n    }\r\n\r\n    /**\r\n     * On change in Last N set check all leaving and entering participants to\r\n     * change their corresponding statuses.\r\n     *\r\n     * @param {Array<string>} leavingLastN array of ids leaving lastN.\r\n     * @param {Array<string>} enteringLastN array of ids entering lastN.\r\n     * @private\r\n     */\r\n    _onLastNChanged(leavingLastN = [], enteringLastN = []) {\r\n        const now = Date.now();\r\n\r\n        logger.debug(\r\n            'leaving/entering lastN', leavingLastN, enteringLastN, now);\r\n\r\n        for (const id of leavingLastN) {\r\n            this.enteredLastNTimestamp.delete(id);\r\n            this._clearRestoringTimer(id);\r\n            this.figureOutConnectionStatus(id);\r\n        }\r\n        for (const id of enteringLastN) {\r\n            // store the timestamp this id is entering lastN\r\n            this.enteredLastNTimestamp.set(id, now);\r\n            this.figureOutConnectionStatus(id);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Clears the restoring timer for participant's video track and the\r\n     * timestamp for entering lastN.\r\n     *\r\n     * @param {string} participantId the id of the conference participant which\r\n     * is the same as the Colibri endpoint ID of the video channel allocated for\r\n     * the user on the videobridge.\r\n     */\r\n    _clearRestoringTimer(participantId) {\r\n        const rTimer = this.restoringTimers.get(participantId);\r\n\r\n        if (rTimer) {\r\n            clearTimeout(rTimer);\r\n            this.restoringTimers.delete(participantId);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Checks whether a track had stayed enough in restoring state, compares\r\n     * current time and the time the track entered in lastN. If it hasn't\r\n     * timedout and there is no timer added, add new timer in order to give it\r\n     * more time to become active or mark it as interrupted on next check.\r\n     *\r\n     * @param {string} participantId the id of the conference participant which\r\n     * is the same as the Colibri endpoint ID of the video channel allocated for\r\n     * the user on the videobridge.\r\n     * @returns {boolean} <tt>true</tt> if the track was in restoring state\r\n     * more than the timeout ({@link DEFAULT_RESTORING_TIMEOUT}.) in order to\r\n     * set its status to interrupted.\r\n     * @private\r\n     */\r\n    _isRestoringTimedout(participantId) {\r\n        const enteredLastNTimestamp\r\n            = this.enteredLastNTimestamp.get(participantId);\r\n\r\n        if (enteredLastNTimestamp\r\n            && (Date.now() - enteredLastNTimestamp)\r\n                >= DEFAULT_RESTORING_TIMEOUT) {\r\n            return true;\r\n        }\r\n\r\n        // still haven't reached timeout, if there is no timer scheduled,\r\n        // schedule one so we can track the restoring state and change it after\r\n        // reaching the timeout\r\n        const rTimer = this.restoringTimers.get(participantId);\r\n\r\n        if (!rTimer) {\r\n            this.restoringTimers.set(participantId, setTimeout(\r\n                () => this.figureOutConnectionStatus(participantId),\r\n                DEFAULT_RESTORING_TIMEOUT));\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Handles RTC 'onmute' event for the video track.\r\n     *\r\n     * @param {JitsiRemoteTrack} track the video track for which 'onmute' event\r\n     * will be processed.\r\n     */\r\n    onTrackRtcMuted(track) {\r\n        const participantId = track.getParticipantId();\r\n        const participant = this.conference.getParticipantById(participantId);\r\n\r\n        logger.debug(`Detector track RTC muted: ${participantId}`, Date.now());\r\n        if (!participant) {\r\n            logger.error(`No participant for id: ${participantId}`);\r\n\r\n            return;\r\n        }\r\n        this.rtcMutedTimestamp[participantId] = Date.now();\r\n        if (!participant.isVideoMuted()) {\r\n            // If the user is not muted according to the signalling we'll give\r\n            // it some time, before the connection interrupted event is\r\n            // triggered.\r\n            this.clearTimeout(participantId);\r\n\r\n            // The timeout is reduced when user is not in the last N\r\n            const timeout = this._getVideoFrozenTimeout(participantId);\r\n\r\n            this.trackTimers[participantId] = window.setTimeout(() => {\r\n                logger.debug(\r\n                    `Set RTC mute timeout for: ${participantId}\\\r\n                     of ${timeout} ms`);\r\n                this.clearTimeout(participantId);\r\n                this.figureOutConnectionStatus(participantId);\r\n            }, timeout);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Handles RTC 'onunmute' event for the video track.\r\n     *\r\n     * @param {JitsiRemoteTrack} track the video track for which 'onunmute'\r\n     * event will be processed.\r\n     */\r\n    onTrackRtcUnmuted(track) {\r\n        const participantId = track.getParticipantId();\r\n\r\n        logger.debug(\r\n            `Detector track RTC unmuted: ${participantId}`, Date.now());\r\n\r\n        this.clearTimeout(participantId);\r\n        this.clearRtcMutedTimestamp(participantId);\r\n\r\n        this.figureOutConnectionStatus(participantId);\r\n    }\r\n\r\n    /**\r\n     * Here the signalling \"mute\"/\"unmute\" events are processed.\r\n     *\r\n     * @param {JitsiRemoteTrack} track the remote video track for which\r\n     * the signalling mute/unmute event will be processed.\r\n     */\r\n    onSignallingMuteChanged(track) {\r\n        const participantId = track.getParticipantId();\r\n\r\n        logger.debug(\r\n            `Detector on track signalling mute changed: ${participantId}`,\r\n            track.isMuted());\r\n\r\n        this.figureOutConnectionStatus(participantId);\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/connectivity/ParticipantConnectionStatus.js","/*! adapterjs - v0.14.0 - 2016-10-03 */\r\nvar console = require(\"jitsi-meet-logger\").getLogger(__filename);\r\n// Adapter's interface.\r\nvar AdapterJS = AdapterJS || {};\r\n\r\n// Browserify compatibility\r\nif(typeof exports !== 'undefined') {\r\n  module.exports = AdapterJS;\r\n}\r\n\r\nAdapterJS.options = AdapterJS.options || {};\r\n\r\n// uncomment to get virtual webcams\r\n// AdapterJS.options.getAllCams = true;\r\n\r\n// uncomment to prevent the install prompt when the plugin in not yet installed\r\n// AdapterJS.options.hidePluginInstallPrompt = true;\r\n\r\n// AdapterJS version\r\nAdapterJS.VERSION = '0.14.0';\r\n\r\n// This function will be called when the WebRTC API is ready to be used\r\n// Whether it is the native implementation (Chrome, Firefox, Opera) or\r\n// the plugin\r\n// You may Override this function to synchronise the start of your application\r\n// with the WebRTC API being ready.\r\n// If you decide not to override use this synchronisation, it may result in\r\n// an extensive CPU usage on the plugin start (once per tab loaded)\r\n// Params:\r\n//    - isUsingPlugin: true is the WebRTC plugin is being used, false otherwise\r\n//\r\nAdapterJS.onwebrtcready = AdapterJS.onwebrtcready || function(isUsingPlugin) {\r\n  // The WebRTC API is ready.\r\n  // Override me and do whatever you want here\r\n};\r\n\r\n// New interface to store multiple callbacks, private\r\nAdapterJS._onwebrtcreadies = [];\r\n\r\n// Sets a callback function to be called when the WebRTC interface is ready.\r\n// The first argument is the function to callback.\\\r\n// Throws an error if the first argument is not a function\r\nAdapterJS.webRTCReady = function (callback) {\r\n  if (typeof callback !== 'function') {\r\n    throw new Error('Callback provided is not a function');\r\n  }\r\n\r\n  if (true === AdapterJS.onwebrtcreadyDone) {\r\n    // All WebRTC interfaces are ready, just call the callback\r\n    callback(null !== AdapterJS.WebRTCPlugin.plugin);\r\n  } else {\r\n    // will be triggered automatically when your browser/plugin is ready.\r\n    AdapterJS._onwebrtcreadies.push(callback);\r\n  }\r\n};\r\n\r\n// Plugin namespace\r\nAdapterJS.WebRTCPlugin = AdapterJS.WebRTCPlugin || {};\r\n\r\n// The object to store plugin information\r\n/* jshint ignore:start */\r\nAdapterJS.WebRTCPlugin.pluginInfo = AdapterJS.WebRTCPlugin.pluginInfo || {\r\n  prefix : 'Tem',\r\n  plugName : 'TemWebRTCPlugin',\r\n  pluginId : 'plugin0',\r\n  type : 'application/x-temwebrtcplugin',\r\n  onload : '__TemWebRTCReady0',\r\n  portalLink : 'http://skylink.io/plugin/',\r\n  downloadLink : null, //set below\r\n  companyName: 'Temasys',\r\n  downloadLinks : {\r\n    mac: 'http://bit.ly/webrtcpluginpkg',\r\n    win: 'http://bit.ly/webrtcpluginmsi'\r\n  }\r\n};\r\nif(typeof AdapterJS.WebRTCPlugin.pluginInfo.downloadLinks !== \"undefined\" && AdapterJS.WebRTCPlugin.pluginInfo.downloadLinks !== null) {\r\n  if(!!navigator.platform.match(/^Mac/i)) {\r\n    AdapterJS.WebRTCPlugin.pluginInfo.downloadLink = AdapterJS.WebRTCPlugin.pluginInfo.downloadLinks.mac;\r\n  }\r\n  else if(!!navigator.platform.match(/^Win/i)) {\r\n    AdapterJS.WebRTCPlugin.pluginInfo.downloadLink = AdapterJS.WebRTCPlugin.pluginInfo.downloadLinks.win;\r\n  }\r\n}\r\n\r\n/* jshint ignore:end */\r\n\r\nAdapterJS.WebRTCPlugin.TAGS = {\r\n  NONE  : 'none',\r\n  AUDIO : 'audio',\r\n  VIDEO : 'video'\r\n};\r\n\r\n// Unique identifier of each opened page\r\nAdapterJS.WebRTCPlugin.pageId = Math.random().toString(36).slice(2);\r\n\r\n// Use this whenever you want to call the plugin.\r\nAdapterJS.WebRTCPlugin.plugin = null;\r\n\r\n// Set log level for the plugin once it is ready.\r\n// The different values are\r\n// This is an asynchronous function that will run when the plugin is ready\r\nAdapterJS.WebRTCPlugin.setLogLevel = null;\r\n\r\n// Defines webrtc's JS interface according to the plugin's implementation.\r\n// Define plugin Browsers as WebRTC Interface.\r\nAdapterJS.WebRTCPlugin.defineWebRTCInterface = null;\r\n\r\n// This function detects whether or not a plugin is installed.\r\n// Checks if Not IE (firefox, for example), else if it's IE,\r\n// we're running IE and do something. If not it is not supported.\r\nAdapterJS.WebRTCPlugin.isPluginInstalled = null;\r\n\r\n // Lets adapter.js wait until the the document is ready before injecting the plugin\r\nAdapterJS.WebRTCPlugin.pluginInjectionInterval = null;\r\n\r\n// Inject the HTML DOM object element into the page.\r\nAdapterJS.WebRTCPlugin.injectPlugin = null;\r\n\r\n// States of readiness that the plugin goes through when\r\n// being injected and stated\r\nAdapterJS.WebRTCPlugin.PLUGIN_STATES = {\r\n  NONE : 0,           // no plugin use\r\n  INITIALIZING : 1,   // Detected need for plugin\r\n  INJECTING : 2,      // Injecting plugin\r\n  INJECTED: 3,        // Plugin element injected but not usable yet\r\n  READY: 4            // Plugin ready to be used\r\n};\r\n\r\n// Current state of the plugin. You cannot use the plugin before this is\r\n// equal to AdapterJS.WebRTCPlugin.PLUGIN_STATES.READY\r\nAdapterJS.WebRTCPlugin.pluginState = AdapterJS.WebRTCPlugin.PLUGIN_STATES.NONE;\r\n\r\n// True is AdapterJS.onwebrtcready was already called, false otherwise\r\n// Used to make sure AdapterJS.onwebrtcready is only called once\r\nAdapterJS.onwebrtcreadyDone = false;\r\n\r\n// Log levels for the plugin.\r\n// To be set by calling AdapterJS.WebRTCPlugin.setLogLevel\r\n/*\r\nLog outputs are prefixed in some cases.\r\n  INFO: Information reported by the plugin.\r\n  ERROR: Errors originating from within the plugin.\r\n  WEBRTC: Error originating from within the libWebRTC library\r\n*/\r\n// From the least verbose to the most verbose\r\nAdapterJS.WebRTCPlugin.PLUGIN_LOG_LEVELS = {\r\n  NONE : 'NONE',\r\n  ERROR : 'ERROR',\r\n  WARNING : 'WARNING',\r\n  INFO: 'INFO',\r\n  VERBOSE: 'VERBOSE',\r\n  SENSITIVE: 'SENSITIVE'\r\n};\r\n\r\n// Does a waiting check before proceeding to load the plugin.\r\nAdapterJS.WebRTCPlugin.WaitForPluginReady = null;\r\n\r\n// This methid will use an interval to wait for the plugin to be ready.\r\nAdapterJS.WebRTCPlugin.callWhenPluginReady = null;\r\n\r\n// !!!! WARNING: DO NOT OVERRIDE THIS FUNCTION. !!!\r\n// This function will be called when plugin is ready. It sends necessary\r\n// details to the plugin.\r\n// The function will wait for the document to be ready and the set the\r\n// plugin state to AdapterJS.WebRTCPlugin.PLUGIN_STATES.READY,\r\n// indicating that it can start being requested.\r\n// This function is not in the IE/Safari condition brackets so that\r\n// TemPluginLoaded function might be called on Chrome/Firefox.\r\n// This function is the only private function that is not encapsulated to\r\n// allow the plugin method to be called.\r\n__TemWebRTCReady0 = function () {\r\n  if (document.readyState === 'complete') {\r\n    AdapterJS.WebRTCPlugin.pluginState = AdapterJS.WebRTCPlugin.PLUGIN_STATES.READY;\r\n    AdapterJS.maybeThroughWebRTCReady();\r\n  } else {\r\n    var timer = setInterval(function () {\r\n      if (document.readyState === 'complete') {\r\n        // TODO: update comments, we wait for the document to be ready\r\n        clearInterval(timer);\r\n        AdapterJS.WebRTCPlugin.pluginState = AdapterJS.WebRTCPlugin.PLUGIN_STATES.READY;\r\n        AdapterJS.maybeThroughWebRTCReady();\r\n      }\r\n    }, 100);\r\n  }\r\n};\r\n\r\nAdapterJS.maybeThroughWebRTCReady = function() {\r\n  if (!AdapterJS.onwebrtcreadyDone) {\r\n    AdapterJS.onwebrtcreadyDone = true;\r\n\r\n    // If new interface for multiple callbacks used\r\n    if (AdapterJS._onwebrtcreadies.length) {\r\n      AdapterJS._onwebrtcreadies.forEach(function (callback) {\r\n        if (typeof(callback) === 'function') {\r\n          callback(AdapterJS.WebRTCPlugin.plugin !== null);\r\n        }\r\n      });\r\n    // Else if no callbacks on new interface assuming user used old(deprecated) way to set callback through AdapterJS.onwebrtcready = ...\r\n    } else if (typeof(AdapterJS.onwebrtcready) === 'function') {\r\n      AdapterJS.onwebrtcready(AdapterJS.WebRTCPlugin.plugin !== null);\r\n    }\r\n  }\r\n};\r\n\r\n// Text namespace\r\nAdapterJS.TEXT = {\r\n  PLUGIN: {\r\n    REQUIRE_INSTALLATION: 'This website requires you to install a WebRTC-enabling plugin ' +\r\n      'to work on this browser.',\r\n    NOT_SUPPORTED: 'Your browser does not support WebRTC.',\r\n    BUTTON: 'Install Now'\r\n  },\r\n  REFRESH: {\r\n    REQUIRE_REFRESH: 'Please refresh page',\r\n    BUTTON: 'Refresh Page'\r\n  }\r\n};\r\n\r\n// The result of ice connection states.\r\n// - starting: Ice connection is starting.\r\n// - checking: Ice connection is checking.\r\n// - connected Ice connection is connected.\r\n// - completed Ice connection is connected.\r\n// - done Ice connection has been completed.\r\n// - disconnected Ice connection has been disconnected.\r\n// - failed Ice connection has failed.\r\n// - closed Ice connection is closed.\r\nAdapterJS._iceConnectionStates = {\r\n  starting : 'starting',\r\n  checking : 'checking',\r\n  connected : 'connected',\r\n  completed : 'connected',\r\n  done : 'completed',\r\n  disconnected : 'disconnected',\r\n  failed : 'failed',\r\n  closed : 'closed'\r\n};\r\n\r\n//The IceConnection states that has been fired for each peer.\r\nAdapterJS._iceConnectionFiredStates = [];\r\n\r\n\r\n// Check if WebRTC Interface is defined.\r\nAdapterJS.isDefined = null;\r\n\r\n// This function helps to retrieve the webrtc detected browser information.\r\n// This sets:\r\n// - webrtcDetectedBrowser: The browser agent name.\r\n// - webrtcDetectedVersion: The browser version.\r\n// - webrtcMinimumVersion: The minimum browser version still supported by AJS.\r\n// - webrtcDetectedType: The types of webRTC support.\r\n//   - 'moz': Mozilla implementation of webRTC.\r\n//   - 'webkit': WebKit implementation of webRTC.\r\n//   - 'plugin': Using the plugin implementation.\r\nAdapterJS.parseWebrtcDetectedBrowser = function () {\r\n  var hasMatch = null;\r\n\r\n  // Detect Opera (8.0+)\r\n  if ((!!window.opr && !!opr.addons) || !!window.opera || navigator.userAgent.indexOf(' OPR/') >= 0) {\r\n    hasMatch = navigator.userAgent.match(/OPR\\/(\\d+)/i) || [];\r\n\r\n    webrtcDetectedBrowser   = 'opera';\r\n    webrtcDetectedVersion   = parseInt(hasMatch[1] || '0', 10);\r\n    webrtcMinimumVersion    = 26;\r\n    webrtcDetectedType      = 'webkit';\r\n    webrtcDetectedDCSupport = 'SCTP'; // Opera 20+ uses Chrome 33\r\n\r\n  // Detect Bowser on iOS\r\n  } else if (navigator.userAgent.match(/Bowser\\/[0-9.]*/g)) {\r\n    hasMatch = navigator.userAgent.match(/Bowser\\/[0-9.]*/g) || [];\r\n\r\n    var chromiumVersion = parseInt((navigator.userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./i) || [])[2] || '0', 10);\r\n\r\n    webrtcDetectedBrowser   = 'bowser';\r\n    webrtcDetectedVersion   = parseFloat((hasMatch[0] || '0/0').split('/')[1], 10);\r\n    webrtcMinimumVersion    = 0;\r\n    webrtcDetectedType      = 'webkit';\r\n    webrtcDetectedDCSupport = chromiumVersion > 30 ? 'SCTP' : 'RTP';\r\n\r\n\r\n  // Detect Opera on iOS (does not support WebRTC yet)\r\n  } else if (navigator.userAgent.indexOf('OPiOS') > 0) {\r\n    hasMatch = navigator.userAgent.match(/OPiOS\\/([0-9]+)\\./);\r\n\r\n    // Browser which do not support webrtc yet\r\n    webrtcDetectedBrowser   = 'opera';\r\n    webrtcDetectedVersion   = parseInt(hasMatch[1] || '0', 10);\r\n    webrtcMinimumVersion    = 0;\r\n    webrtcDetectedType      = null;\r\n    webrtcDetectedDCSupport = null;\r\n\r\n  // Detect Chrome on iOS (does not support WebRTC yet)\r\n  } else if (navigator.userAgent.indexOf('CriOS') > 0) {\r\n    hasMatch = navigator.userAgent.match(/CriOS\\/([0-9]+)\\./) || [];\r\n\r\n    webrtcDetectedBrowser   = 'chrome';\r\n    webrtcDetectedVersion   = parseInt(hasMatch[1] || '0', 10);\r\n    webrtcMinimumVersion    = 0;\r\n    webrtcDetectedType      = null;\r\n    webrtcDetectedDCSupport = null;\r\n\r\n  // Detect Firefox on iOS (does not support WebRTC yet)\r\n  } else if (navigator.userAgent.indexOf('FxiOS') > 0) {\r\n    hasMatch = navigator.userAgent.match(/FxiOS\\/([0-9]+)\\./) || [];\r\n\r\n    // Browser which do not support webrtc yet\r\n    webrtcDetectedBrowser   = 'firefox';\r\n    webrtcDetectedVersion   = parseInt(hasMatch[1] || '0', 10);\r\n    webrtcMinimumVersion    = 0;\r\n    webrtcDetectedType      = null;\r\n    webrtcDetectedDCSupport = null;\r\n\r\n  // Detect IE (6-11)\r\n  } else if (/*@cc_on!@*/false || !!document.documentMode) {\r\n    hasMatch = /\\brv[ :]+(\\d+)/g.exec(navigator.userAgent) || [];\r\n\r\n    webrtcDetectedBrowser   = 'IE';\r\n    webrtcDetectedVersion   = parseInt(hasMatch[1], 10);\r\n    webrtcMinimumVersion    = 9;\r\n    webrtcDetectedType      = 'plugin';\r\n    webrtcDetectedDCSupport = 'SCTP';\r\n\r\n    if (!webrtcDetectedVersion) {\r\n      hasMatch = /\\bMSIE[ :]+(\\d+)/g.exec(navigator.userAgent) || [];\r\n\r\n      webrtcDetectedVersion = parseInt(hasMatch[1] || '0', 10);\r\n    }\r\n\r\n  // Detect Edge (20+)\r\n  } else if (!!window.StyleMedia || navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/)) {\r\n    hasMatch = navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/) || [];\r\n\r\n    // Previous webrtc/adapter uses minimum version as 10547 but checking in the Edge release history,\r\n    // It's close to 13.10547 and ObjectRTC API is fully supported in that version\r\n\r\n    webrtcDetectedBrowser   = 'edge';\r\n    webrtcDetectedVersion   = parseFloat((hasMatch[0] || '0/0').split('/')[1], 10);\r\n    webrtcMinimumVersion    = 13.10547;\r\n    webrtcDetectedType      = 'ms';\r\n    webrtcDetectedDCSupport = null;\r\n\r\n  // Detect Firefox (1.0+)\r\n  // Placed before Safari check to ensure Firefox on Android is detected\r\n  } else if (typeof InstallTrigger !== 'undefined' || navigator.userAgent.indexOf('irefox') > 0) {\r\n    hasMatch = navigator.userAgent.match(/Firefox\\/([0-9]+)\\./) || [];\r\n\r\n    webrtcDetectedBrowser   = 'firefox';\r\n    webrtcDetectedVersion   = parseInt(hasMatch[1] || '0', 10);\r\n    webrtcMinimumVersion    = 31;\r\n    webrtcDetectedType      = 'moz';\r\n    webrtcDetectedDCSupport = 'SCTP';\r\n\r\n  // Detect Chrome (1+ and mobile)\r\n  // Placed before Safari check to ensure Chrome on Android is detected\r\n  } else if ((!!window.chrome && !!window.chrome.webstore) || navigator.userAgent.indexOf('Chrom') > 0) {\r\n    hasMatch = navigator.userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./i) || [];\r\n\r\n    webrtcDetectedBrowser   = 'chrome';\r\n    webrtcDetectedVersion   = parseInt(hasMatch[2] || '0', 10);\r\n    webrtcMinimumVersion    = 38;\r\n    webrtcDetectedType      = 'webkit';\r\n    webrtcDetectedDCSupport = webrtcDetectedVersion > 30 ? 'SCTP' : 'RTP'; // Chrome 31+ supports SCTP without flags\r\n\r\n  // Detect Safari\r\n  } else if (/^((?!chrome|android).)*safari/i.test(navigator.userAgent)) {\r\n    hasMatch = navigator.userAgent.match(/version\\/(\\d+)/i) || [];\r\n\r\n    var isMobile = navigator.userAgent.match(/(iPhone|iPad)/gi) || [];\r\n\r\n    webrtcDetectedBrowser   = 'safari';\r\n    webrtcDetectedVersion   = parseInt(hasMatch[1] || '0', 10);\r\n    webrtcMinimumVersion    = 7;\r\n    webrtcDetectedType      = isMobile.length === 0 ? 'plugin' : null;\r\n    webrtcDetectedDCSupport = isMobile.length === 0 ? 'SCTP' : null;\r\n\r\n  // Detect WebView on iOS (does not support WebRTC yet)\r\n  } else if (/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent)) {\r\n    hasMatch = navigator.userAgent.match(/AppleWebKit\\/([0-9]+)\\./) || [];\r\n\r\n    webrtcDetectedBrowser   = 'safari';\r\n    webrtcDetectedVersion   = parseInt(hasMatch[1] || '0', 10);\r\n    webrtcMinimumVersion    = 0;\r\n    webrtcDetectedType      = null;\r\n    webrtcDetectedDCSupport = null;\r\n\r\n  }\r\n\r\n  window.webrtcDetectedBrowser   = webrtcDetectedBrowser;\r\n  window.webrtcDetectedVersion   = webrtcDetectedVersion;\r\n  window.webrtcMinimumVersion    = webrtcMinimumVersion;\r\n  window.webrtcDetectedType      = webrtcDetectedType; // Scope it to window for better consistency\r\n  window.webrtcDetectedDCSupport = webrtcDetectedDCSupport; // Scope it to window for better consistency\r\n};\r\n\r\nAdapterJS.addEvent = function(elem, evnt, func) {\r\n  if (elem.addEventListener) { // W3C DOM\r\n    elem.addEventListener(evnt, func, false);\r\n  } else if (elem.attachEvent) {// OLD IE DOM\r\n    elem.attachEvent('on'+evnt, func);\r\n  } else { // No much to do\r\n    elem[evnt] = func;\r\n  }\r\n};\r\n\r\nAdapterJS.renderNotificationBar = function (text, buttonText, buttonLink, openNewTab, displayRefreshBar) {\r\n  // only inject once the page is ready\r\n  if (document.readyState !== 'complete') {\r\n    return;\r\n  }\r\n\r\n  var w = window;\r\n  var i = document.createElement('iframe');\r\n  i.name = 'adapterjs-alert';\r\n  i.style.position = 'fixed';\r\n  i.style.top = '-41px';\r\n  i.style.left = 0;\r\n  i.style.right = 0;\r\n  i.style.width = '100%';\r\n  i.style.height = '40px';\r\n  i.style.backgroundColor = '#ffffe1';\r\n  i.style.border = 'none';\r\n  i.style.borderBottom = '1px solid #888888';\r\n  i.style.zIndex = '9999999';\r\n  if(typeof i.style.webkitTransition === 'string') {\r\n    i.style.webkitTransition = 'all .5s ease-out';\r\n  } else if(typeof i.style.transition === 'string') {\r\n    i.style.transition = 'all .5s ease-out';\r\n  }\r\n  document.body.appendChild(i);\r\n  var c = (i.contentWindow) ? i.contentWindow :\r\n    (i.contentDocument.document) ? i.contentDocument.document : i.contentDocument;\r\n  c.document.open();\r\n  c.document.write('<span style=\"display: inline-block; font-family: Helvetica, Arial,' +\r\n    'sans-serif; font-size: .9rem; padding: 4px; vertical-align: ' +\r\n    'middle; cursor: default;\">' + text + '</span>');\r\n  if(buttonText && buttonLink) {\r\n    c.document.write('<button id=\"okay\">' + buttonText + '</button><button id=\"cancel\">Cancel</button>');\r\n    c.document.close();\r\n\r\n    // On click on okay\r\n    AdapterJS.addEvent(c.document.getElementById('okay'), 'click', function(e) {\r\n      if (!!displayRefreshBar) {\r\n        AdapterJS.renderNotificationBar(AdapterJS.TEXT.EXTENSION ?\r\n          AdapterJS.TEXT.EXTENSION.REQUIRE_REFRESH : AdapterJS.TEXT.REFRESH.REQUIRE_REFRESH,\r\n          AdapterJS.TEXT.REFRESH.BUTTON, 'javascript:location.reload()'); // jshint ignore:line\r\n      }\r\n      window.open(buttonLink, !!openNewTab ? '_blank' : '_top');\r\n\r\n      e.preventDefault();\r\n      try {\r\n        e.cancelBubble = true;\r\n      } catch(error) { }\r\n\r\n      var pluginInstallInterval = setInterval(function(){\r\n        if(! isIE) {\r\n          navigator.plugins.refresh(false);\r\n        }\r\n        AdapterJS.WebRTCPlugin.isPluginInstalled(\r\n          AdapterJS.WebRTCPlugin.pluginInfo.prefix,\r\n          AdapterJS.WebRTCPlugin.pluginInfo.plugName,\r\n          AdapterJS.WebRTCPlugin.pluginInfo.type,\r\n          function() { // plugin now installed\r\n            clearInterval(pluginInstallInterval);\r\n            AdapterJS.WebRTCPlugin.defineWebRTCInterface();\r\n          },\r\n          function() {\r\n            // still no plugin detected, nothing to do\r\n          });\r\n      } , 500);\r\n    });\r\n\r\n    // On click on Cancel\r\n    AdapterJS.addEvent(c.document.getElementById('cancel'), 'click', function(e) {\r\n      w.document.body.removeChild(i);\r\n    });\r\n  } else {\r\n    c.document.close();\r\n  }\r\n  setTimeout(function() {\r\n    if(typeof i.style.webkitTransform === 'string') {\r\n      i.style.webkitTransform = 'translateY(40px)';\r\n    } else if(typeof i.style.transform === 'string') {\r\n      i.style.transform = 'translateY(40px)';\r\n    } else {\r\n      i.style.top = '0px';\r\n    }\r\n  }, 300);\r\n};\r\n\r\n// -----------------------------------------------------------\r\n// Detected webrtc implementation. Types are:\r\n// - 'moz': Mozilla implementation of webRTC.\r\n// - 'webkit': WebKit implementation of webRTC.\r\n// - 'plugin': Using the plugin implementation.\r\nwebrtcDetectedType = null;\r\n\r\n// Set the settings for creating DataChannels, MediaStream for\r\n// Cross-browser compability.\r\n// - This is only for SCTP based support browsers.\r\n// the 'urls' attribute.\r\ncheckMediaDataChannelSettings =\r\n  function (peerBrowserAgent, peerBrowserVersion, callback, constraints) {\r\n  if (typeof callback !== 'function') {\r\n    return;\r\n  }\r\n  var beOfferer = true;\r\n  var isLocalFirefox = webrtcDetectedBrowser === 'firefox';\r\n  // Nightly version does not require MozDontOfferDataChannel for interop\r\n  var isLocalFirefoxInterop = webrtcDetectedType === 'moz' && webrtcDetectedVersion > 30;\r\n  var isPeerFirefox = peerBrowserAgent === 'firefox';\r\n  var isPeerFirefoxInterop = peerBrowserAgent === 'firefox' &&\r\n    ((peerBrowserVersion) ? (peerBrowserVersion > 30) : false);\r\n\r\n  // Resends an updated version of constraints for MozDataChannel to work\r\n  // If other userAgent is firefox and user is firefox, remove MozDataChannel\r\n  if ((isLocalFirefox && isPeerFirefox) || (isLocalFirefoxInterop)) {\r\n    try {\r\n      delete constraints.mandatory.MozDontOfferDataChannel;\r\n    } catch (error) {\r\n      console.error('Failed deleting MozDontOfferDataChannel');\r\n      console.error(error);\r\n    }\r\n  } else if ((isLocalFirefox && !isPeerFirefox)) {\r\n    constraints.mandatory.MozDontOfferDataChannel = true;\r\n  }\r\n  if (!isLocalFirefox) {\r\n    // temporary measure to remove Moz* constraints in non Firefox browsers\r\n    for (var prop in constraints.mandatory) {\r\n      if (constraints.mandatory.hasOwnProperty(prop)) {\r\n        if (prop.indexOf('Moz') !== -1) {\r\n          delete constraints.mandatory[prop];\r\n        }\r\n      }\r\n    }\r\n  }\r\n  // Firefox (not interopable) cannot offer DataChannel as it will cause problems to the\r\n  // interopability of the media stream\r\n  if (isLocalFirefox && !isPeerFirefox && !isLocalFirefoxInterop) {\r\n    beOfferer = false;\r\n  }\r\n  callback(beOfferer, constraints);\r\n};\r\n\r\n// Handles the differences for all browsers ice connection state output.\r\n// - Tested outcomes are:\r\n//   - Chrome (offerer)  : 'checking' > 'completed' > 'completed'\r\n//   - Chrome (answerer) : 'checking' > 'connected'\r\n//   - Firefox (offerer) : 'checking' > 'connected'\r\n//   - Firefox (answerer): 'checking' > 'connected'\r\ncheckIceConnectionState = function (peerId, iceConnectionState, callback) {\r\n  if (typeof callback !== 'function') {\r\n    console.warn('No callback specified in checkIceConnectionState. Aborted.');\r\n    return;\r\n  }\r\n  peerId = (peerId) ? peerId : 'peer';\r\n\r\n  if (!AdapterJS._iceConnectionFiredStates[peerId] ||\r\n    iceConnectionState === AdapterJS._iceConnectionStates.disconnected ||\r\n    iceConnectionState === AdapterJS._iceConnectionStates.failed ||\r\n    iceConnectionState === AdapterJS._iceConnectionStates.closed) {\r\n    AdapterJS._iceConnectionFiredStates[peerId] = [];\r\n  }\r\n  iceConnectionState = AdapterJS._iceConnectionStates[iceConnectionState];\r\n  if (AdapterJS._iceConnectionFiredStates[peerId].indexOf(iceConnectionState) < 0) {\r\n    AdapterJS._iceConnectionFiredStates[peerId].push(iceConnectionState);\r\n    if (iceConnectionState === AdapterJS._iceConnectionStates.connected) {\r\n      setTimeout(function () {\r\n        AdapterJS._iceConnectionFiredStates[peerId]\r\n          .push(AdapterJS._iceConnectionStates.done);\r\n        callback(AdapterJS._iceConnectionStates.done);\r\n      }, 1000);\r\n    }\r\n    callback(iceConnectionState);\r\n  }\r\n  return;\r\n};\r\n\r\n// Firefox:\r\n// - Creates iceServer from the url for Firefox.\r\n// - Create iceServer with stun url.\r\n// - Create iceServer with turn url.\r\n//   - Ignore the transport parameter from TURN url for FF version <=27.\r\n//   - Return null for createIceServer if transport=tcp.\r\n// - FF 27 and above supports transport parameters in TURN url,\r\n// - So passing in the full url to create iceServer.\r\n// Chrome:\r\n// - Creates iceServer from the url for Chrome M33 and earlier.\r\n//   - Create iceServer with stun url.\r\n//   - Chrome M28 & above uses below TURN format.\r\n// Plugin:\r\n// - Creates Ice Server for Plugin Browsers\r\n//   - If Stun - Create iceServer with stun url.\r\n//   - Else - Create iceServer with turn url\r\n//   - This is a WebRTC Function\r\ncreateIceServer = null;\r\n\r\n// Firefox:\r\n// - Creates IceServers for Firefox\r\n//   - Use .url for FireFox.\r\n//   - Multiple Urls support\r\n// Chrome:\r\n// - Creates iceServers from the urls for Chrome M34 and above.\r\n//   - .urls is supported since Chrome M34.\r\n//   - Multiple Urls support\r\n// Plugin:\r\n// - Creates Ice Servers for Plugin Browsers\r\n//   - Multiple Urls support\r\n//   - This is a WebRTC Function\r\ncreateIceServers = null;\r\n//------------------------------------------------------------\r\n\r\n//The RTCPeerConnection object.\r\nRTCPeerConnection = null;\r\n\r\n// Creates RTCSessionDescription object for Plugin Browsers\r\nRTCSessionDescription = (typeof RTCSessionDescription === 'function') ?\r\n  RTCSessionDescription : null;\r\n\r\n// Creates RTCIceCandidate object for Plugin Browsers\r\nRTCIceCandidate = (typeof RTCIceCandidate === 'function') ?\r\n  RTCIceCandidate : null;\r\n\r\n// Get UserMedia (only difference is the prefix).\r\n// Code from Adam Barth.\r\ngetUserMedia = null;\r\n\r\n// Attach a media stream to an element.\r\nattachMediaStream = null;\r\n\r\n// Re-attach a media stream to an element.\r\nreattachMediaStream = null;\r\n\r\n\r\n// Detected browser agent name. Types are:\r\n// - 'firefox': Firefox browser.\r\n// - 'chrome': Chrome browser.\r\n// - 'opera': Opera browser.\r\n// - 'safari': Safari browser.\r\n// - 'IE' - Internet Explorer browser.\r\nwebrtcDetectedBrowser = null;\r\n\r\n// Detected browser version.\r\nwebrtcDetectedVersion = null;\r\n\r\n// The minimum browser version still supported by AJS.\r\nwebrtcMinimumVersion  = null;\r\n\r\n// Check for browser types and react accordingly\r\nif ( (navigator.mozGetUserMedia ||\r\n      navigator.webkitGetUserMedia ||\r\n      (navigator.mediaDevices &&\r\n       navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/)))\r\n    && !((navigator.userAgent.match(/android/ig) || []).length === 0 &&\r\n      (navigator.userAgent.match(/chrome/ig) || []).length === 0 && navigator.userAgent.indexOf('Safari/') > 0)) {\r\n\r\n  ///////////////////////////////////////////////////////////////////\r\n  // INJECTION OF GOOGLE'S ADAPTER.JS CONTENT\r\n\r\n/* jshint ignore:start */\r\n  (function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.adapter = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\r\n   /* eslint-env node */\r\n  'use strict';\r\n\r\n  // SDP helpers.\r\n  var SDPUtils = {};\r\n\r\n  // Generate an alphanumeric identifier for cname or mids.\r\n  // TODO: use UUIDs instead? https://gist.github.com/jed/982883\r\n  SDPUtils.generateIdentifier = function() {\r\n    return Math.random().toString(36).substr(2, 10);\r\n  };\r\n\r\n  // The RTCP CNAME used by all peerconnections from the same JS.\r\n  SDPUtils.localCName = SDPUtils.generateIdentifier();\r\n\r\n  // Splits SDP into lines, dealing with both CRLF and LF.\r\n  SDPUtils.splitLines = function(blob) {\r\n    return blob.trim().split('\\n').map(function(line) {\r\n      return line.trim();\r\n    });\r\n  };\r\n  // Splits SDP into sessionpart and mediasections. Ensures CRLF.\r\n  SDPUtils.splitSections = function(blob) {\r\n    var parts = blob.split('\\nm=');\r\n    return parts.map(function(part, index) {\r\n      return (index > 0 ? 'm=' + part : part).trim() + '\\r\\n';\r\n    });\r\n  };\r\n\r\n  // Returns lines that start with a certain prefix.\r\n  SDPUtils.matchPrefix = function(blob, prefix) {\r\n    return SDPUtils.splitLines(blob).filter(function(line) {\r\n      return line.indexOf(prefix) === 0;\r\n    });\r\n  };\r\n\r\n  // Parses an ICE candidate line. Sample input:\r\n  // candidate:702786350 2 udp 41819902 8.8.8.8 60769 typ relay raddr 8.8.8.8\r\n  // rport 55996\"\r\n  SDPUtils.parseCandidate = function(line) {\r\n    var parts;\r\n    // Parse both variants.\r\n    if (line.indexOf('a=candidate:') === 0) {\r\n      parts = line.substring(12).split(' ');\r\n    } else {\r\n      parts = line.substring(10).split(' ');\r\n    }\r\n\r\n    var candidate = {\r\n      foundation: parts[0],\r\n      component: parts[1],\r\n      protocol: parts[2].toLowerCase(),\r\n      priority: parseInt(parts[3], 10),\r\n      ip: parts[4],\r\n      port: parseInt(parts[5], 10),\r\n      // skip parts[6] == 'typ'\r\n      type: parts[7]\r\n    };\r\n\r\n    for (var i = 8; i < parts.length; i += 2) {\r\n      switch (parts[i]) {\r\n        case 'raddr':\r\n          candidate.relatedAddress = parts[i + 1];\r\n          break;\r\n        case 'rport':\r\n          candidate.relatedPort = parseInt(parts[i + 1], 10);\r\n          break;\r\n        case 'tcptype':\r\n          candidate.tcpType = parts[i + 1];\r\n          break;\r\n        default: // Unknown extensions are silently ignored.\r\n          break;\r\n      }\r\n    }\r\n    return candidate;\r\n  };\r\n\r\n  // Translates a candidate object into SDP candidate attribute.\r\n  SDPUtils.writeCandidate = function(candidate) {\r\n    var sdp = [];\r\n    sdp.push(candidate.foundation);\r\n    sdp.push(candidate.component);\r\n    sdp.push(candidate.protocol.toUpperCase());\r\n    sdp.push(candidate.priority);\r\n    sdp.push(candidate.ip);\r\n    sdp.push(candidate.port);\r\n\r\n    var type = candidate.type;\r\n    sdp.push('typ');\r\n    sdp.push(type);\r\n    if (type !== 'host' && candidate.relatedAddress &&\r\n        candidate.relatedPort) {\r\n      sdp.push('raddr');\r\n      sdp.push(candidate.relatedAddress); // was: relAddr\r\n      sdp.push('rport');\r\n      sdp.push(candidate.relatedPort); // was: relPort\r\n    }\r\n    if (candidate.tcpType && candidate.protocol.toLowerCase() === 'tcp') {\r\n      sdp.push('tcptype');\r\n      sdp.push(candidate.tcpType);\r\n    }\r\n    return 'candidate:' + sdp.join(' ');\r\n  };\r\n\r\n  // Parses an rtpmap line, returns RTCRtpCoddecParameters. Sample input:\r\n  // a=rtpmap:111 opus/48000/2\r\n  SDPUtils.parseRtpMap = function(line) {\r\n    var parts = line.substr(9).split(' ');\r\n    var parsed = {\r\n      payloadType: parseInt(parts.shift(), 10) // was: id\r\n    };\r\n\r\n    parts = parts[0].split('/');\r\n\r\n    parsed.name = parts[0];\r\n    parsed.clockRate = parseInt(parts[1], 10); // was: clockrate\r\n    // was: channels\r\n    parsed.numChannels = parts.length === 3 ? parseInt(parts[2], 10) : 1;\r\n    return parsed;\r\n  };\r\n\r\n  // Generate an a=rtpmap line from RTCRtpCodecCapability or\r\n  // RTCRtpCodecParameters.\r\n  SDPUtils.writeRtpMap = function(codec) {\r\n    var pt = codec.payloadType;\r\n    if (codec.preferredPayloadType !== undefined) {\r\n      pt = codec.preferredPayloadType;\r\n    }\r\n    return 'a=rtpmap:' + pt + ' ' + codec.name + '/' + codec.clockRate +\r\n        (codec.numChannels !== 1 ? '/' + codec.numChannels : '') + '\\r\\n';\r\n  };\r\n\r\n  // Parses an a=extmap line (headerextension from RFC 5285). Sample input:\r\n  // a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\r\n  SDPUtils.parseExtmap = function(line) {\r\n    var parts = line.substr(9).split(' ');\r\n    return {\r\n      id: parseInt(parts[0], 10),\r\n      uri: parts[1]\r\n    };\r\n  };\r\n\r\n  // Generates a=extmap line from RTCRtpHeaderExtensionParameters or\r\n  // RTCRtpHeaderExtension.\r\n  SDPUtils.writeExtmap = function(headerExtension) {\r\n    return 'a=extmap:' + (headerExtension.id || headerExtension.preferredId) +\r\n         ' ' + headerExtension.uri + '\\r\\n';\r\n  };\r\n\r\n  // Parses an ftmp line, returns dictionary. Sample input:\r\n  // a=fmtp:96 vbr=on;cng=on\r\n  // Also deals with vbr=on; cng=on\r\n  SDPUtils.parseFmtp = function(line) {\r\n    var parsed = {};\r\n    var kv;\r\n    var parts = line.substr(line.indexOf(' ') + 1).split(';');\r\n    for (var j = 0; j < parts.length; j++) {\r\n      kv = parts[j].trim().split('=');\r\n      parsed[kv[0].trim()] = kv[1];\r\n    }\r\n    return parsed;\r\n  };\r\n\r\n  // Generates an a=ftmp line from RTCRtpCodecCapability or RTCRtpCodecParameters.\r\n  SDPUtils.writeFmtp = function(codec) {\r\n    var line = '';\r\n    var pt = codec.payloadType;\r\n    if (codec.preferredPayloadType !== undefined) {\r\n      pt = codec.preferredPayloadType;\r\n    }\r\n    if (codec.parameters && Object.keys(codec.parameters).length) {\r\n      var params = [];\r\n      Object.keys(codec.parameters).forEach(function(param) {\r\n        params.push(param + '=' + codec.parameters[param]);\r\n      });\r\n      line += 'a=fmtp:' + pt + ' ' + params.join(';') + '\\r\\n';\r\n    }\r\n    return line;\r\n  };\r\n\r\n  // Parses an rtcp-fb line, returns RTCPRtcpFeedback object. Sample input:\r\n  // a=rtcp-fb:98 nack rpsi\r\n  SDPUtils.parseRtcpFb = function(line) {\r\n    var parts = line.substr(line.indexOf(' ') + 1).split(' ');\r\n    return {\r\n      type: parts.shift(),\r\n      parameter: parts.join(' ')\r\n    };\r\n  };\r\n  // Generate a=rtcp-fb lines from RTCRtpCodecCapability or RTCRtpCodecParameters.\r\n  SDPUtils.writeRtcpFb = function(codec) {\r\n    var lines = '';\r\n    var pt = codec.payloadType;\r\n    if (codec.preferredPayloadType !== undefined) {\r\n      pt = codec.preferredPayloadType;\r\n    }\r\n    if (codec.rtcpFeedback && codec.rtcpFeedback.length) {\r\n      // FIXME: special handling for trr-int?\r\n      codec.rtcpFeedback.forEach(function(fb) {\r\n        lines += 'a=rtcp-fb:' + pt + ' ' + fb.type +\r\n        (fb.parameter && fb.parameter.length ? ' ' + fb.parameter : '') +\r\n            '\\r\\n';\r\n      });\r\n    }\r\n    return lines;\r\n  };\r\n\r\n  // Parses an RFC 5576 ssrc media attribute. Sample input:\r\n  // a=ssrc:3735928559 cname:something\r\n  SDPUtils.parseSsrcMedia = function(line) {\r\n    var sp = line.indexOf(' ');\r\n    var parts = {\r\n      ssrc: parseInt(line.substr(7, sp - 7), 10)\r\n    };\r\n    var colon = line.indexOf(':', sp);\r\n    if (colon > -1) {\r\n      parts.attribute = line.substr(sp + 1, colon - sp - 1);\r\n      parts.value = line.substr(colon + 1);\r\n    } else {\r\n      parts.attribute = line.substr(sp + 1);\r\n    }\r\n    return parts;\r\n  };\r\n\r\n  // Extracts DTLS parameters from SDP media section or sessionpart.\r\n  // FIXME: for consistency with other functions this should only\r\n  //   get the fingerprint line as input. See also getIceParameters.\r\n  SDPUtils.getDtlsParameters = function(mediaSection, sessionpart) {\r\n    var lines = SDPUtils.splitLines(mediaSection);\r\n    // Search in session part, too.\r\n    lines = lines.concat(SDPUtils.splitLines(sessionpart));\r\n    var fpLine = lines.filter(function(line) {\r\n      return line.indexOf('a=fingerprint:') === 0;\r\n    })[0].substr(14);\r\n    // Note: a=setup line is ignored since we use the 'auto' role.\r\n    var dtlsParameters = {\r\n      role: 'auto',\r\n      fingerprints: [{\r\n        algorithm: fpLine.split(' ')[0],\r\n        value: fpLine.split(' ')[1]\r\n      }]\r\n    };\r\n    return dtlsParameters;\r\n  };\r\n\r\n  // Serializes DTLS parameters to SDP.\r\n  SDPUtils.writeDtlsParameters = function(params, setupType) {\r\n    var sdp = 'a=setup:' + setupType + '\\r\\n';\r\n    params.fingerprints.forEach(function(fp) {\r\n      sdp += 'a=fingerprint:' + fp.algorithm + ' ' + fp.value + '\\r\\n';\r\n    });\r\n    return sdp;\r\n  };\r\n  // Parses ICE information from SDP media section or sessionpart.\r\n  // FIXME: for consistency with other functions this should only\r\n  //   get the ice-ufrag and ice-pwd lines as input.\r\n  SDPUtils.getIceParameters = function(mediaSection, sessionpart) {\r\n    var lines = SDPUtils.splitLines(mediaSection);\r\n    // Search in session part, too.\r\n    lines = lines.concat(SDPUtils.splitLines(sessionpart));\r\n    var iceParameters = {\r\n      usernameFragment: lines.filter(function(line) {\r\n        return line.indexOf('a=ice-ufrag:') === 0;\r\n      })[0].substr(12),\r\n      password: lines.filter(function(line) {\r\n        return line.indexOf('a=ice-pwd:') === 0;\r\n      })[0].substr(10)\r\n    };\r\n    return iceParameters;\r\n  };\r\n\r\n  // Serializes ICE parameters to SDP.\r\n  SDPUtils.writeIceParameters = function(params) {\r\n    return 'a=ice-ufrag:' + params.usernameFragment + '\\r\\n' +\r\n        'a=ice-pwd:' + params.password + '\\r\\n';\r\n  };\r\n\r\n  // Parses the SDP media section and returns RTCRtpParameters.\r\n  SDPUtils.parseRtpParameters = function(mediaSection) {\r\n    var description = {\r\n      codecs: [],\r\n      headerExtensions: [],\r\n      fecMechanisms: [],\r\n      rtcp: []\r\n    };\r\n    var lines = SDPUtils.splitLines(mediaSection);\r\n    var mline = lines[0].split(' ');\r\n    for (var i = 3; i < mline.length; i++) { // find all codecs from mline[3..]\r\n      var pt = mline[i];\r\n      var rtpmapline = SDPUtils.matchPrefix(\r\n          mediaSection, 'a=rtpmap:' + pt + ' ')[0];\r\n      if (rtpmapline) {\r\n        var codec = SDPUtils.parseRtpMap(rtpmapline);\r\n        var fmtps = SDPUtils.matchPrefix(\r\n            mediaSection, 'a=fmtp:' + pt + ' ');\r\n        // Only the first a=fmtp:<pt> is considered.\r\n        codec.parameters = fmtps.length ? SDPUtils.parseFmtp(fmtps[0]) : {};\r\n        codec.rtcpFeedback = SDPUtils.matchPrefix(\r\n            mediaSection, 'a=rtcp-fb:' + pt + ' ')\r\n          .map(SDPUtils.parseRtcpFb);\r\n        description.codecs.push(codec);\r\n        // parse FEC mechanisms from rtpmap lines.\r\n        switch (codec.name.toUpperCase()) {\r\n          case 'RED':\r\n          case 'ULPFEC':\r\n            description.fecMechanisms.push(codec.name.toUpperCase());\r\n            break;\r\n          default: // only RED and ULPFEC are recognized as FEC mechanisms.\r\n            break;\r\n        }\r\n      }\r\n    }\r\n    SDPUtils.matchPrefix(mediaSection, 'a=extmap:').forEach(function(line) {\r\n      description.headerExtensions.push(SDPUtils.parseExtmap(line));\r\n    });\r\n    // FIXME: parse rtcp.\r\n    return description;\r\n  };\r\n\r\n  // Generates parts of the SDP media section describing the capabilities /\r\n  // parameters.\r\n  SDPUtils.writeRtpDescription = function(kind, caps) {\r\n    var sdp = '';\r\n\r\n    // Build the mline.\r\n    sdp += 'm=' + kind + ' ';\r\n    sdp += caps.codecs.length > 0 ? '9' : '0'; // reject if no codecs.\r\n    sdp += ' UDP/TLS/RTP/SAVPF ';\r\n    sdp += caps.codecs.map(function(codec) {\r\n      if (codec.preferredPayloadType !== undefined) {\r\n        return codec.preferredPayloadType;\r\n      }\r\n      return codec.payloadType;\r\n    }).join(' ') + '\\r\\n';\r\n\r\n    sdp += 'c=IN IP4 0.0.0.0\\r\\n';\r\n    sdp += 'a=rtcp:9 IN IP4 0.0.0.0\\r\\n';\r\n\r\n    // Add a=rtpmap lines for each codec. Also fmtp and rtcp-fb.\r\n    caps.codecs.forEach(function(codec) {\r\n      sdp += SDPUtils.writeRtpMap(codec);\r\n      sdp += SDPUtils.writeFmtp(codec);\r\n      sdp += SDPUtils.writeRtcpFb(codec);\r\n    });\r\n    // FIXME: add headerExtensions, fecMechanism and rtcp.\r\n    sdp += 'a=rtcp-mux\\r\\n';\r\n    return sdp;\r\n  };\r\n\r\n  // Parses the SDP media section and returns an array of\r\n  // RTCRtpEncodingParameters.\r\n  SDPUtils.parseRtpEncodingParameters = function(mediaSection) {\r\n    var encodingParameters = [];\r\n    var description = SDPUtils.parseRtpParameters(mediaSection);\r\n    var hasRed = description.fecMechanisms.indexOf('RED') !== -1;\r\n    var hasUlpfec = description.fecMechanisms.indexOf('ULPFEC') !== -1;\r\n\r\n    // filter a=ssrc:... cname:, ignore PlanB-msid\r\n    var ssrcs = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\r\n    .map(function(line) {\r\n      return SDPUtils.parseSsrcMedia(line);\r\n    })\r\n    .filter(function(parts) {\r\n      return parts.attribute === 'cname';\r\n    });\r\n    var primarySsrc = ssrcs.length > 0 && ssrcs[0].ssrc;\r\n    var secondarySsrc;\r\n\r\n    var flows = SDPUtils.matchPrefix(mediaSection, 'a=ssrc-group:FID')\r\n    .map(function(line) {\r\n      var parts = line.split(' ');\r\n      parts.shift();\r\n      return parts.map(function(part) {\r\n        return parseInt(part, 10);\r\n      });\r\n    });\r\n    if (flows.length > 0 && flows[0].length > 1 && flows[0][0] === primarySsrc) {\r\n      secondarySsrc = flows[0][1];\r\n    }\r\n\r\n    description.codecs.forEach(function(codec) {\r\n      if (codec.name.toUpperCase() === 'RTX' && codec.parameters.apt) {\r\n        var encParam = {\r\n          ssrc: primarySsrc,\r\n          codecPayloadType: parseInt(codec.parameters.apt, 10),\r\n          rtx: {\r\n            payloadType: codec.payloadType,\r\n            ssrc: secondarySsrc\r\n          }\r\n        };\r\n        encodingParameters.push(encParam);\r\n        if (hasRed) {\r\n          encParam = JSON.parse(JSON.stringify(encParam));\r\n          encParam.fec = {\r\n            ssrc: secondarySsrc,\r\n            mechanism: hasUlpfec ? 'red+ulpfec' : 'red'\r\n          };\r\n          encodingParameters.push(encParam);\r\n        }\r\n      }\r\n    });\r\n    if (encodingParameters.length === 0 && primarySsrc) {\r\n      encodingParameters.push({\r\n        ssrc: primarySsrc\r\n      });\r\n    }\r\n\r\n    // we support both b=AS and b=TIAS but interpret AS as TIAS.\r\n    var bandwidth = SDPUtils.matchPrefix(mediaSection, 'b=');\r\n    if (bandwidth.length) {\r\n      if (bandwidth[0].indexOf('b=TIAS:') === 0) {\r\n        bandwidth = parseInt(bandwidth[0].substr(7), 10);\r\n      } else if (bandwidth[0].indexOf('b=AS:') === 0) {\r\n        bandwidth = parseInt(bandwidth[0].substr(5), 10);\r\n      }\r\n      encodingParameters.forEach(function(params) {\r\n        params.maxBitrate = bandwidth;\r\n      });\r\n    }\r\n    return encodingParameters;\r\n  };\r\n\r\n  SDPUtils.writeSessionBoilerplate = function() {\r\n    // FIXME: sess-id should be an NTP timestamp.\r\n    return 'v=0\\r\\n' +\r\n        'o=thisisadapterortc 8169639915646943137 2 IN IP4 127.0.0.1\\r\\n' +\r\n        's=-\\r\\n' +\r\n        't=0 0\\r\\n';\r\n  };\r\n\r\n  SDPUtils.writeMediaSection = function(transceiver, caps, type, stream) {\r\n    var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\r\n\r\n    // Map ICE parameters (ufrag, pwd) to SDP.\r\n    sdp += SDPUtils.writeIceParameters(\r\n        transceiver.iceGatherer.getLocalParameters());\r\n\r\n    // Map DTLS parameters to SDP.\r\n    sdp += SDPUtils.writeDtlsParameters(\r\n        transceiver.dtlsTransport.getLocalParameters(),\r\n        type === 'offer' ? 'actpass' : 'active');\r\n\r\n    sdp += 'a=mid:' + transceiver.mid + '\\r\\n';\r\n\r\n    if (transceiver.rtpSender && transceiver.rtpReceiver) {\r\n      sdp += 'a=sendrecv\\r\\n';\r\n    } else if (transceiver.rtpSender) {\r\n      sdp += 'a=sendonly\\r\\n';\r\n    } else if (transceiver.rtpReceiver) {\r\n      sdp += 'a=recvonly\\r\\n';\r\n    } else {\r\n      sdp += 'a=inactive\\r\\n';\r\n    }\r\n\r\n    // FIXME: for RTX there might be multiple SSRCs. Not implemented in Edge yet.\r\n    if (transceiver.rtpSender) {\r\n      var msid = 'msid:' + stream.id + ' ' +\r\n          transceiver.rtpSender.track.id + '\\r\\n';\r\n      sdp += 'a=' + msid;\r\n      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\r\n          ' ' + msid;\r\n    }\r\n    // FIXME: this should be written by writeRtpDescription.\r\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\r\n        ' cname:' + SDPUtils.localCName + '\\r\\n';\r\n    return sdp;\r\n  };\r\n\r\n  // Gets the direction from the mediaSection or the sessionpart.\r\n  SDPUtils.getDirection = function(mediaSection, sessionpart) {\r\n    // Look for sendrecv, sendonly, recvonly, inactive, default to sendrecv.\r\n    var lines = SDPUtils.splitLines(mediaSection);\r\n    for (var i = 0; i < lines.length; i++) {\r\n      switch (lines[i]) {\r\n        case 'a=sendrecv':\r\n        case 'a=sendonly':\r\n        case 'a=recvonly':\r\n        case 'a=inactive':\r\n          return lines[i].substr(2);\r\n        default:\r\n          // FIXME: What should happen here?\r\n      }\r\n    }\r\n    if (sessionpart) {\r\n      return SDPUtils.getDirection(sessionpart);\r\n    }\r\n    return 'sendrecv';\r\n  };\r\n\r\n  // Expose public methods.\r\n  module.exports = SDPUtils;\r\n\r\n  },{}],2:[function(require,module,exports){\r\n  /*\r\n   *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\r\n   *\r\n   *  Use of this source code is governed by a BSD-style license\r\n   *  that can be found in the LICENSE file in the root of the source\r\n   *  tree.\r\n   */\r\n   /* eslint-env node */\r\n\r\n  'use strict';\r\n\r\n  // Shimming starts here.\r\n  (function() {\r\n    // Utils.\r\n    var logging = require('./utils').log;\r\n    var browserDetails = require('./utils').browserDetails;\r\n    // Export to the adapter global object visible in the browser.\r\n    module.exports.browserDetails = browserDetails;\r\n    module.exports.extractVersion = require('./utils').extractVersion;\r\n    module.exports.disableLog = require('./utils').disableLog;\r\n\r\n    // Uncomment the line below if you want logging to occur, including logging\r\n    // for the switch statement below. Can also be turned on in the browser via\r\n    // adapter.disableLog(false), but then logging from the switch statement below\r\n    // will not appear.\r\n    // require('./utils').disableLog(false);\r\n\r\n    // Browser shims.\r\n    var chromeShim = require('./chrome/chrome_shim') || null;\r\n    var edgeShim = require('./edge/edge_shim') || null;\r\n    var firefoxShim = require('./firefox/firefox_shim') || null;\r\n    var safariShim = require('./safari/safari_shim') || null;\r\n\r\n    // Shim browser if found.\r\n    switch (browserDetails.browser) {\r\n      case 'opera': // fallthrough as it uses chrome shims\r\n      case 'chrome':\r\n        if (!chromeShim || !chromeShim.shimPeerConnection) {\r\n          logging('Chrome shim is not included in this adapter release.');\r\n          return;\r\n        }\r\n        logging('adapter.js shimming chrome.');\r\n        // Export to the adapter global object visible in the browser.\r\n        module.exports.browserShim = chromeShim;\r\n\r\n        chromeShim.shimGetUserMedia();\r\n        chromeShim.shimMediaStream();\r\n        chromeShim.shimSourceObject();\r\n        chromeShim.shimPeerConnection();\r\n        chromeShim.shimOnTrack();\r\n        break;\r\n      case 'firefox':\r\n        if (!firefoxShim || !firefoxShim.shimPeerConnection) {\r\n          logging('Firefox shim is not included in this adapter release.');\r\n          return;\r\n        }\r\n        logging('adapter.js shimming firefox.');\r\n        // Export to the adapter global object visible in the browser.\r\n        module.exports.browserShim = firefoxShim;\r\n\r\n        firefoxShim.shimGetUserMedia();\r\n        firefoxShim.shimSourceObject();\r\n        firefoxShim.shimPeerConnection();\r\n        firefoxShim.shimOnTrack();\r\n        break;\r\n      case 'edge':\r\n        if (!edgeShim || !edgeShim.shimPeerConnection) {\r\n          logging('MS edge shim is not included in this adapter release.');\r\n          return;\r\n        }\r\n        logging('adapter.js shimming edge.');\r\n        // Export to the adapter global object visible in the browser.\r\n        module.exports.browserShim = edgeShim;\r\n\r\n        edgeShim.shimGetUserMedia();\r\n        edgeShim.shimPeerConnection();\r\n        break;\r\n      case 'safari':\r\n        if (!safariShim) {\r\n          logging('Safari shim is not included in this adapter release.');\r\n          return;\r\n        }\r\n        logging('adapter.js shimming safari.');\r\n        // Export to the adapter global object visible in the browser.\r\n        module.exports.browserShim = safariShim;\r\n\r\n        safariShim.shimGetUserMedia();\r\n        break;\r\n      default:\r\n        logging('Unsupported browser!');\r\n    }\r\n  })();\r\n\r\n  },{\"./chrome/chrome_shim\":3,\"./edge/edge_shim\":5,\"./firefox/firefox_shim\":7,\"./safari/safari_shim\":9,\"./utils\":10}],3:[function(require,module,exports){\r\n\r\n  /*\r\n   *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\r\n   *\r\n   *  Use of this source code is governed by a BSD-style license\r\n   *  that can be found in the LICENSE file in the root of the source\r\n   *  tree.\r\n   */\r\n   /* eslint-env node */\r\n  'use strict';\r\n  var logging = require('../utils.js').log;\r\n  var browserDetails = require('../utils.js').browserDetails;\r\n\r\n  var chromeShim = {\r\n    shimMediaStream: function() {\r\n      window.MediaStream = window.MediaStream || window.webkitMediaStream;\r\n    },\r\n\r\n    shimOnTrack: function() {\r\n      if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in\r\n          window.RTCPeerConnection.prototype)) {\r\n        Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\r\n          get: function() {\r\n            return this._ontrack;\r\n          },\r\n          set: function(f) {\r\n            var self = this;\r\n            if (this._ontrack) {\r\n              this.removeEventListener('track', this._ontrack);\r\n              this.removeEventListener('addstream', this._ontrackpoly);\r\n            }\r\n            this.addEventListener('track', this._ontrack = f);\r\n            this.addEventListener('addstream', this._ontrackpoly = function(e) {\r\n              // onaddstream does not fire when a track is added to an existing\r\n              // stream. But stream.onaddtrack is implemented so we use that.\r\n              e.stream.addEventListener('addtrack', function(te) {\r\n                var event = new Event('track');\r\n                event.track = te.track;\r\n                event.receiver = {track: te.track};\r\n                event.streams = [e.stream];\r\n                self.dispatchEvent(event);\r\n              });\r\n              e.stream.getTracks().forEach(function(track) {\r\n                var event = new Event('track');\r\n                event.track = track;\r\n                event.receiver = {track: track};\r\n                event.streams = [e.stream];\r\n                this.dispatchEvent(event);\r\n              }.bind(this));\r\n            }.bind(this));\r\n          }\r\n        });\r\n      }\r\n    },\r\n\r\n    shimSourceObject: function() {\r\n      if (typeof window === 'object') {\r\n        if (window.HTMLMediaElement &&\r\n          !('srcObject' in window.HTMLMediaElement.prototype)) {\r\n          // Shim the srcObject property, once, when HTMLMediaElement is found.\r\n          Object.defineProperty(window.HTMLMediaElement.prototype, 'srcObject', {\r\n            get: function() {\r\n              return this._srcObject;\r\n            },\r\n            set: function(stream) {\r\n              var self = this;\r\n              // Use _srcObject as a private property for this shim\r\n              this._srcObject = stream;\r\n              if (this.src) {\r\n                URL.revokeObjectURL(this.src);\r\n              }\r\n\r\n              if (!stream) {\r\n                this.src = '';\r\n                return;\r\n              }\r\n              this.src = URL.createObjectURL(stream);\r\n              // We need to recreate the blob url when a track is added or\r\n              // removed. Doing it manually since we want to avoid a recursion.\r\n              stream.addEventListener('addtrack', function() {\r\n                if (self.src) {\r\n                  URL.revokeObjectURL(self.src);\r\n                }\r\n                self.src = URL.createObjectURL(stream);\r\n              });\r\n              stream.addEventListener('removetrack', function() {\r\n                if (self.src) {\r\n                  URL.revokeObjectURL(self.src);\r\n                }\r\n                self.src = URL.createObjectURL(stream);\r\n              });\r\n            }\r\n          });\r\n        }\r\n      }\r\n    },\r\n\r\n    shimPeerConnection: function() {\r\n      // The RTCPeerConnection object.\r\n      window.RTCPeerConnection = function(pcConfig, pcConstraints) {\r\n        // Translate iceTransportPolicy to iceTransports,\r\n        // see https://code.google.com/p/webrtc/issues/detail?id=4869\r\n        logging('PeerConnection');\r\n        if (pcConfig && pcConfig.iceTransportPolicy) {\r\n          pcConfig.iceTransports = pcConfig.iceTransportPolicy;\r\n        }\r\n\r\n        var pc = new webkitRTCPeerConnection(pcConfig, pcConstraints);\r\n        var origGetStats = pc.getStats.bind(pc);\r\n        pc.getStats = function(selector, successCallback, errorCallback) {\r\n          var self = this;\r\n          var args = arguments;\r\n\r\n          // If selector is a function then we are in the old style stats so just\r\n          // pass back the original getStats format to avoid breaking old users.\r\n          if (arguments.length > 0 && typeof selector === 'function') {\r\n            return origGetStats(selector, successCallback);\r\n          }\r\n\r\n          var fixChromeStats_ = function(response) {\r\n            var standardReport = {};\r\n            var reports = response.result();\r\n            reports.forEach(function(report) {\r\n              var standardStats = {\r\n                id: report.id,\r\n                timestamp: report.timestamp,\r\n                type: report.type\r\n              };\r\n              report.names().forEach(function(name) {\r\n                standardStats[name] = report.stat(name);\r\n              });\r\n              standardReport[standardStats.id] = standardStats;\r\n            });\r\n\r\n            return standardReport;\r\n          };\r\n\r\n          // shim getStats with maplike support\r\n          var makeMapStats = function(stats, legacyStats) {\r\n            var map = new Map(Object.keys(stats).map(function(key) {\r\n              return[key, stats[key]];\r\n            }));\r\n            legacyStats = legacyStats || stats;\r\n            Object.keys(legacyStats).forEach(function(key) {\r\n              map[key] = legacyStats[key];\r\n            });\r\n            return map;\r\n          };\r\n\r\n          if (arguments.length >= 2) {\r\n            var successCallbackWrapper_ = function(response) {\r\n              args[1](makeMapStats(fixChromeStats_(response)));\r\n            };\r\n\r\n            return origGetStats.apply(this, [successCallbackWrapper_,\r\n                arguments[0]]);\r\n          }\r\n\r\n          // promise-support\r\n          return new Promise(function(resolve, reject) {\r\n            if (args.length === 1 && typeof selector === 'object') {\r\n              origGetStats.apply(self, [\r\n                function(response) {\r\n                  resolve(makeMapStats(fixChromeStats_(response)));\r\n                }, reject]);\r\n            } else {\r\n              // Preserve legacy chrome stats only on legacy access of stats obj\r\n              origGetStats.apply(self, [\r\n                function(response) {\r\n                  resolve(makeMapStats(fixChromeStats_(response),\r\n                      response.result()));\r\n                }, reject]);\r\n            }\r\n          }).then(successCallback, errorCallback);\r\n        };\r\n\r\n        return pc;\r\n      };\r\n      window.RTCPeerConnection.prototype = webkitRTCPeerConnection.prototype;\r\n\r\n      // wrap static methods. Currently just generateCertificate.\r\n      if (webkitRTCPeerConnection.generateCertificate) {\r\n        Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\r\n          get: function() {\r\n            return webkitRTCPeerConnection.generateCertificate;\r\n          }\r\n        });\r\n      }\r\n\r\n      ['createOffer', 'createAnswer'].forEach(function(method) {\r\n        var nativeMethod = webkitRTCPeerConnection.prototype[method];\r\n        webkitRTCPeerConnection.prototype[method] = function() {\r\n          var self = this;\r\n          if (arguments.length < 1 || (arguments.length === 1 &&\r\n              typeof arguments[0] === 'object')) {\r\n            var opts = arguments.length === 1 ? arguments[0] : undefined;\r\n            return new Promise(function(resolve, reject) {\r\n              nativeMethod.apply(self, [resolve, reject, opts]);\r\n            });\r\n          }\r\n          return nativeMethod.apply(this, arguments);\r\n        };\r\n      });\r\n\r\n      // add promise support -- natively available in Chrome 51\r\n      if (browserDetails.version < 51) {\r\n        ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\r\n            .forEach(function(method) {\r\n              var nativeMethod = webkitRTCPeerConnection.prototype[method];\r\n              webkitRTCPeerConnection.prototype[method] = function() {\r\n                var args = arguments;\r\n                var self = this;\r\n                var promise = new Promise(function(resolve, reject) {\r\n                  nativeMethod.apply(self, [args[0], resolve, reject]);\r\n                });\r\n                if (args.length < 2) {\r\n                  return promise;\r\n                }\r\n                return promise.then(function() {\r\n                  args[1].apply(null, []);\r\n                },\r\n                function(err) {\r\n                  if (args.length >= 3) {\r\n                    args[2].apply(null, [err]);\r\n                  }\r\n                });\r\n              };\r\n            });\r\n      }\r\n\r\n      // shim implicit creation of RTCSessionDescription/RTCIceCandidate\r\n      ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\r\n          .forEach(function(method) {\r\n            var nativeMethod = webkitRTCPeerConnection.prototype[method];\r\n            webkitRTCPeerConnection.prototype[method] = function() {\r\n              arguments[0] = new ((method === 'addIceCandidate') ?\r\n                  RTCIceCandidate : RTCSessionDescription)(arguments[0]);\r\n              return nativeMethod.apply(this, arguments);\r\n            };\r\n          });\r\n\r\n      // support for addIceCandidate(null)\r\n      var nativeAddIceCandidate =\r\n          RTCPeerConnection.prototype.addIceCandidate;\r\n      RTCPeerConnection.prototype.addIceCandidate = function() {\r\n        return arguments[0] === null ? Promise.resolve()\r\n            : nativeAddIceCandidate.apply(this, arguments);\r\n      };\r\n    }\r\n  };\r\n\r\n\r\n  // Expose public methods.\r\n  module.exports = {\r\n    shimMediaStream: chromeShim.shimMediaStream,\r\n    shimOnTrack: chromeShim.shimOnTrack,\r\n    shimSourceObject: chromeShim.shimSourceObject,\r\n    shimPeerConnection: chromeShim.shimPeerConnection,\r\n    shimGetUserMedia: require('./getusermedia')\r\n  };\r\n\r\n  },{\"../utils.js\":10,\"./getusermedia\":4}],4:[function(require,module,exports){\r\n  /*\r\n   *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\r\n   *\r\n   *  Use of this source code is governed by a BSD-style license\r\n   *  that can be found in the LICENSE file in the root of the source\r\n   *  tree.\r\n   */\r\n   /* eslint-env node */\r\n  'use strict';\r\n  var logging = require('../utils.js').log;\r\n\r\n  // Expose public methods.\r\n  module.exports = function() {\r\n    var constraintsToChrome_ = function(c) {\r\n      if (typeof c !== 'object' || c.mandatory || c.optional) {\r\n        return c;\r\n      }\r\n      var cc = {};\r\n      Object.keys(c).forEach(function(key) {\r\n        if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\r\n          return;\r\n        }\r\n        var r = (typeof c[key] === 'object') ? c[key] : {ideal: c[key]};\r\n        if (r.exact !== undefined && typeof r.exact === 'number') {\r\n          r.min = r.max = r.exact;\r\n        }\r\n        var oldname_ = function(prefix, name) {\r\n          if (prefix) {\r\n            return prefix + name.charAt(0).toUpperCase() + name.slice(1);\r\n          }\r\n          return (name === 'deviceId') ? 'sourceId' : name;\r\n        };\r\n        if (r.ideal !== undefined) {\r\n          cc.optional = cc.optional || [];\r\n          var oc = {};\r\n          if (typeof r.ideal === 'number') {\r\n            oc[oldname_('min', key)] = r.ideal;\r\n            cc.optional.push(oc);\r\n            oc = {};\r\n            oc[oldname_('max', key)] = r.ideal;\r\n            cc.optional.push(oc);\r\n          } else {\r\n            oc[oldname_('', key)] = r.ideal;\r\n            cc.optional.push(oc);\r\n          }\r\n        }\r\n        if (r.exact !== undefined && typeof r.exact !== 'number') {\r\n          cc.mandatory = cc.mandatory || {};\r\n          cc.mandatory[oldname_('', key)] = r.exact;\r\n        } else {\r\n          ['min', 'max'].forEach(function(mix) {\r\n            if (r[mix] !== undefined) {\r\n              cc.mandatory = cc.mandatory || {};\r\n              cc.mandatory[oldname_(mix, key)] = r[mix];\r\n            }\r\n          });\r\n        }\r\n      });\r\n      if (c.advanced) {\r\n        cc.optional = (cc.optional || []).concat(c.advanced);\r\n      }\r\n      return cc;\r\n    };\r\n\r\n    var shimConstraints_ = function(constraints, func) {\r\n      constraints = JSON.parse(JSON.stringify(constraints));\r\n      if (constraints && constraints.audio) {\r\n        constraints.audio = constraintsToChrome_(constraints.audio);\r\n      }\r\n      if (constraints && typeof constraints.video === 'object') {\r\n        // Shim facingMode for mobile, where it defaults to \"user\".\r\n        var face = constraints.video.facingMode;\r\n        face = face && ((typeof face === 'object') ? face : {ideal: face});\r\n\r\n        if ((face && (face.exact === 'user' || face.exact === 'environment' ||\r\n                      face.ideal === 'user' || face.ideal === 'environment')) &&\r\n            !(navigator.mediaDevices.getSupportedConstraints &&\r\n              navigator.mediaDevices.getSupportedConstraints().facingMode)) {\r\n          delete constraints.video.facingMode;\r\n          if (face.exact === 'environment' || face.ideal === 'environment') {\r\n            // Look for \"back\" in label, or use last cam (typically back cam).\r\n            return navigator.mediaDevices.enumerateDevices()\r\n            .then(function(devices) {\r\n              devices = devices.filter(function(d) {\r\n                return d.kind === 'videoinput';\r\n              });\r\n              var back = devices.find(function(d) {\r\n                return d.label.toLowerCase().indexOf('back') !== -1;\r\n              }) || (devices.length && devices[devices.length - 1]);\r\n              if (back) {\r\n                constraints.video.deviceId = face.exact ? {exact: back.deviceId} :\r\n                                                          {ideal: back.deviceId};\r\n              }\r\n              constraints.video = constraintsToChrome_(constraints.video);\r\n              logging('chrome: ' + JSON.stringify(constraints));\r\n              return func(constraints);\r\n            });\r\n          }\r\n        }\r\n        constraints.video = constraintsToChrome_(constraints.video);\r\n      }\r\n      logging('chrome: ' + JSON.stringify(constraints));\r\n      return func(constraints);\r\n    };\r\n\r\n    var shimError_ = function(e) {\r\n      return {\r\n        name: {\r\n          PermissionDeniedError: 'NotAllowedError',\r\n          ConstraintNotSatisfiedError: 'OverconstrainedError'\r\n        }[e.name] || e.name,\r\n        message: e.message,\r\n        constraint: e.constraintName,\r\n        toString: function() {\r\n          return this.name + (this.message && ': ') + this.message;\r\n        }\r\n      };\r\n    };\r\n\r\n    var getUserMedia_ = function(constraints, onSuccess, onError) {\r\n      shimConstraints_(constraints, function(c) {\r\n        navigator.webkitGetUserMedia(c, onSuccess, function(e) {\r\n          onError(shimError_(e));\r\n        });\r\n      });\r\n    };\r\n\r\n    navigator.getUserMedia = getUserMedia_;\r\n\r\n    // Returns the result of getUserMedia as a Promise.\r\n    var getUserMediaPromise_ = function(constraints) {\r\n      return new Promise(function(resolve, reject) {\r\n        navigator.getUserMedia(constraints, resolve, reject);\r\n      });\r\n    };\r\n\r\n    if (!navigator.mediaDevices) {\r\n      navigator.mediaDevices = {\r\n        getUserMedia: getUserMediaPromise_,\r\n        enumerateDevices: function() {\r\n          return new Promise(function(resolve) {\r\n            var kinds = {audio: 'audioinput', video: 'videoinput'};\r\n            return MediaStreamTrack.getSources(function(devices) {\r\n              resolve(devices.map(function(device) {\r\n                return {label: device.label,\r\n                        kind: kinds[device.kind],\r\n                        deviceId: device.id,\r\n                        groupId: ''};\r\n              }));\r\n            });\r\n          });\r\n        }\r\n      };\r\n    }\r\n\r\n    // A shim for getUserMedia method on the mediaDevices object.\r\n    // TODO(KaptenJansson) remove once implemented in Chrome stable.\r\n    if (!navigator.mediaDevices.getUserMedia) {\r\n      navigator.mediaDevices.getUserMedia = function(constraints) {\r\n        return getUserMediaPromise_(constraints);\r\n      };\r\n    } else {\r\n      // Even though Chrome 45 has navigator.mediaDevices and a getUserMedia\r\n      // function which returns a Promise, it does not accept spec-style\r\n      // constraints.\r\n      var origGetUserMedia = navigator.mediaDevices.getUserMedia.\r\n          bind(navigator.mediaDevices);\r\n      navigator.mediaDevices.getUserMedia = function(cs) {\r\n        return shimConstraints_(cs, function(c) {\r\n          return origGetUserMedia(c).catch(function(e) {\r\n            return Promise.reject(shimError_(e));\r\n          });\r\n        });\r\n      };\r\n    }\r\n\r\n    // Dummy devicechange event methods.\r\n    // TODO(KaptenJansson) remove once implemented in Chrome stable.\r\n    if (typeof navigator.mediaDevices.addEventListener === 'undefined') {\r\n      navigator.mediaDevices.addEventListener = function() {\r\n        logging('Dummy mediaDevices.addEventListener called.');\r\n      };\r\n    }\r\n    if (typeof navigator.mediaDevices.removeEventListener === 'undefined') {\r\n      navigator.mediaDevices.removeEventListener = function() {\r\n        logging('Dummy mediaDevices.removeEventListener called.');\r\n      };\r\n    }\r\n  };\r\n\r\n  },{\"../utils.js\":10}],5:[function(require,module,exports){\r\n  /*\r\n   *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\r\n   *\r\n   *  Use of this source code is governed by a BSD-style license\r\n   *  that can be found in the LICENSE file in the root of the source\r\n   *  tree.\r\n   */\r\n   /* eslint-env node */\r\n  'use strict';\r\n\r\n  var SDPUtils = require('sdp');\r\n  var browserDetails = require('../utils').browserDetails;\r\n\r\n  var edgeShim = {\r\n    shimPeerConnection: function() {\r\n      if (window.RTCIceGatherer) {\r\n        // ORTC defines an RTCIceCandidate object but no constructor.\r\n        // Not implemented in Edge.\r\n        if (!window.RTCIceCandidate) {\r\n          window.RTCIceCandidate = function(args) {\r\n            return args;\r\n          };\r\n        }\r\n        // ORTC does not have a session description object but\r\n        // other browsers (i.e. Chrome) that will support both PC and ORTC\r\n        // in the future might have this defined already.\r\n        if (!window.RTCSessionDescription) {\r\n          window.RTCSessionDescription = function(args) {\r\n            return args;\r\n          };\r\n        }\r\n      }\r\n\r\n      window.RTCPeerConnection = function(config) {\r\n        var self = this;\r\n\r\n        var _eventTarget = document.createDocumentFragment();\r\n        ['addEventListener', 'removeEventListener', 'dispatchEvent']\r\n            .forEach(function(method) {\r\n              self[method] = _eventTarget[method].bind(_eventTarget);\r\n            });\r\n\r\n        this.onicecandidate = null;\r\n        this.onaddstream = null;\r\n        this.ontrack = null;\r\n        this.onremovestream = null;\r\n        this.onsignalingstatechange = null;\r\n        this.oniceconnectionstatechange = null;\r\n        this.onnegotiationneeded = null;\r\n        this.ondatachannel = null;\r\n\r\n        this.localStreams = [];\r\n        this.remoteStreams = [];\r\n        this.getLocalStreams = function() {\r\n          return self.localStreams;\r\n        };\r\n        this.getRemoteStreams = function() {\r\n          return self.remoteStreams;\r\n        };\r\n\r\n        this.localDescription = new RTCSessionDescription({\r\n          type: '',\r\n          sdp: ''\r\n        });\r\n        this.remoteDescription = new RTCSessionDescription({\r\n          type: '',\r\n          sdp: ''\r\n        });\r\n        this.signalingState = 'stable';\r\n        this.iceConnectionState = 'new';\r\n        this.iceGatheringState = 'new';\r\n\r\n        this.iceOptions = {\r\n          gatherPolicy: 'all',\r\n          iceServers: []\r\n        };\r\n        if (config && config.iceTransportPolicy) {\r\n          switch (config.iceTransportPolicy) {\r\n            case 'all':\r\n            case 'relay':\r\n              this.iceOptions.gatherPolicy = config.iceTransportPolicy;\r\n              break;\r\n            case 'none':\r\n              // FIXME: remove once implementation and spec have added this.\r\n              throw new TypeError('iceTransportPolicy \"none\" not supported');\r\n            default:\r\n              // don't set iceTransportPolicy.\r\n              break;\r\n          }\r\n        }\r\n        this.usingBundle = config && config.bundlePolicy === 'max-bundle';\r\n\r\n        if (config && config.iceServers) {\r\n          // Edge does not like\r\n          // 1) stun:\r\n          // 2) turn: that does not have all of turn:host:port?transport=udp\r\n          // 3) turn: with ipv6 addresses\r\n          var iceServers = JSON.parse(JSON.stringify(config.iceServers));\r\n          this.iceOptions.iceServers = iceServers.filter(function(server) {\r\n            if (server && server.urls) {\r\n              var urls = server.urls;\r\n              if (typeof urls === 'string') {\r\n                urls = [urls];\r\n              }\r\n              urls = urls.filter(function(url) {\r\n                return (url.indexOf('turn:') === 0 &&\r\n                    url.indexOf('transport=udp') !== -1 &&\r\n                    url.indexOf('turn:[') === -1) ||\r\n                    (url.indexOf('stun:') === 0 &&\r\n                      browserDetails.version >= 14393);\r\n              })[0];\r\n              return !!urls;\r\n            }\r\n            return false;\r\n          });\r\n        }\r\n\r\n        // per-track iceGathers, iceTransports, dtlsTransports, rtpSenders, ...\r\n        // everything that is needed to describe a SDP m-line.\r\n        this.transceivers = [];\r\n\r\n        // since the iceGatherer is currently created in createOffer but we\r\n        // must not emit candidates until after setLocalDescription we buffer\r\n        // them in this array.\r\n        this._localIceCandidatesBuffer = [];\r\n      };\r\n\r\n      window.RTCPeerConnection.prototype._emitBufferedCandidates = function() {\r\n        var self = this;\r\n        var sections = SDPUtils.splitSections(self.localDescription.sdp);\r\n        // FIXME: need to apply ice candidates in a way which is async but\r\n        // in-order\r\n        this._localIceCandidatesBuffer.forEach(function(event) {\r\n          var end = !event.candidate || Object.keys(event.candidate).length === 0;\r\n          if (end) {\r\n            for (var j = 1; j < sections.length; j++) {\r\n              if (sections[j].indexOf('\\r\\na=end-of-candidates\\r\\n') === -1) {\r\n                sections[j] += 'a=end-of-candidates\\r\\n';\r\n              }\r\n            }\r\n          } else if (event.candidate.candidate.indexOf('typ endOfCandidates')\r\n              === -1) {\r\n            sections[event.candidate.sdpMLineIndex + 1] +=\r\n                'a=' + event.candidate.candidate + '\\r\\n';\r\n          }\r\n          self.localDescription.sdp = sections.join('');\r\n          self.dispatchEvent(event);\r\n          if (self.onicecandidate !== null) {\r\n            self.onicecandidate(event);\r\n          }\r\n          if (!event.candidate && self.iceGatheringState !== 'complete') {\r\n            var complete = self.transceivers.every(function(transceiver) {\r\n              return transceiver.iceGatherer &&\r\n                  transceiver.iceGatherer.state === 'completed';\r\n            });\r\n            if (complete) {\r\n              self.iceGatheringState = 'complete';\r\n            }\r\n          }\r\n        });\r\n        this._localIceCandidatesBuffer = [];\r\n      };\r\n\r\n      window.RTCPeerConnection.prototype.addStream = function(stream) {\r\n        // Clone is necessary for local demos mostly, attaching directly\r\n        // to two different senders does not work (build 10547).\r\n        this.localStreams.push(stream.clone());\r\n        this._maybeFireNegotiationNeeded();\r\n      };\r\n\r\n      window.RTCPeerConnection.prototype.removeStream = function(stream) {\r\n        var idx = this.localStreams.indexOf(stream);\r\n        if (idx > -1) {\r\n          this.localStreams.splice(idx, 1);\r\n          this._maybeFireNegotiationNeeded();\r\n        }\r\n      };\r\n\r\n      window.RTCPeerConnection.prototype.getSenders = function() {\r\n        return this.transceivers.filter(function(transceiver) {\r\n          return !!transceiver.rtpSender;\r\n        })\r\n        .map(function(transceiver) {\r\n          return transceiver.rtpSender;\r\n        });\r\n      };\r\n\r\n      window.RTCPeerConnection.prototype.getReceivers = function() {\r\n        return this.transceivers.filter(function(transceiver) {\r\n          return !!transceiver.rtpReceiver;\r\n        })\r\n        .map(function(transceiver) {\r\n          return transceiver.rtpReceiver;\r\n        });\r\n      };\r\n\r\n      // Determines the intersection of local and remote capabilities.\r\n      window.RTCPeerConnection.prototype._getCommonCapabilities =\r\n          function(localCapabilities, remoteCapabilities) {\r\n            var commonCapabilities = {\r\n              codecs: [],\r\n              headerExtensions: [],\r\n              fecMechanisms: []\r\n            };\r\n            localCapabilities.codecs.forEach(function(lCodec) {\r\n              for (var i = 0; i < remoteCapabilities.codecs.length; i++) {\r\n                var rCodec = remoteCapabilities.codecs[i];\r\n                if (lCodec.name.toLowerCase() === rCodec.name.toLowerCase() &&\r\n                    lCodec.clockRate === rCodec.clockRate &&\r\n                    lCodec.numChannels === rCodec.numChannels) {\r\n                  // push rCodec so we reply with offerer payload type\r\n                  commonCapabilities.codecs.push(rCodec);\r\n\r\n                  // determine common feedback mechanisms\r\n                  rCodec.rtcpFeedback = rCodec.rtcpFeedback.filter(function(fb) {\r\n                    for (var j = 0; j < lCodec.rtcpFeedback.length; j++) {\r\n                      if (lCodec.rtcpFeedback[j].type === fb.type &&\r\n                          lCodec.rtcpFeedback[j].parameter === fb.parameter) {\r\n                        return true;\r\n                      }\r\n                    }\r\n                    return false;\r\n                  });\r\n                  // FIXME: also need to determine .parameters\r\n                  //  see https://github.com/openpeer/ortc/issues/569\r\n                  break;\r\n                }\r\n              }\r\n            });\r\n\r\n            localCapabilities.headerExtensions\r\n                .forEach(function(lHeaderExtension) {\r\n                  for (var i = 0; i < remoteCapabilities.headerExtensions.length;\r\n                       i++) {\r\n                    var rHeaderExtension = remoteCapabilities.headerExtensions[i];\r\n                    if (lHeaderExtension.uri === rHeaderExtension.uri) {\r\n                      commonCapabilities.headerExtensions.push(rHeaderExtension);\r\n                      break;\r\n                    }\r\n                  }\r\n                });\r\n\r\n            // FIXME: fecMechanisms\r\n            return commonCapabilities;\r\n          };\r\n\r\n      // Create ICE gatherer, ICE transport and DTLS transport.\r\n      window.RTCPeerConnection.prototype._createIceAndDtlsTransports =\r\n          function(mid, sdpMLineIndex) {\r\n            var self = this;\r\n            var iceGatherer = new RTCIceGatherer(self.iceOptions);\r\n            var iceTransport = new RTCIceTransport(iceGatherer);\r\n            iceGatherer.onlocalcandidate = function(evt) {\r\n              var event = new Event('icecandidate');\r\n              event.candidate = {sdpMid: mid, sdpMLineIndex: sdpMLineIndex};\r\n\r\n              var cand = evt.candidate;\r\n              var end = !cand || Object.keys(cand).length === 0;\r\n              // Edge emits an empty object for RTCIceCandidateComplete\r\n              if (end) {\r\n                // polyfill since RTCIceGatherer.state is not implemented in\r\n                // Edge 10547 yet.\r\n                if (iceGatherer.state === undefined) {\r\n                  iceGatherer.state = 'completed';\r\n                }\r\n\r\n                // Emit a candidate with type endOfCandidates to make the samples\r\n                // work. Edge requires addIceCandidate with this empty candidate\r\n                // to start checking. The real solution is to signal\r\n                // end-of-candidates to the other side when getting the null\r\n                // candidate but some apps (like the samples) don't do that.\r\n                event.candidate.candidate =\r\n                    'candidate:1 1 udp 1 0.0.0.0 9 typ endOfCandidates';\r\n              } else {\r\n                // RTCIceCandidate doesn't have a component, needs to be added\r\n                cand.component = iceTransport.component === 'RTCP' ? 2 : 1;\r\n                event.candidate.candidate = SDPUtils.writeCandidate(cand);\r\n              }\r\n\r\n              // update local description.\r\n              var sections = SDPUtils.splitSections(self.localDescription.sdp);\r\n              if (event.candidate.candidate.indexOf('typ endOfCandidates')\r\n                  === -1) {\r\n                sections[event.candidate.sdpMLineIndex + 1] +=\r\n                    'a=' + event.candidate.candidate + '\\r\\n';\r\n              } else {\r\n                sections[event.candidate.sdpMLineIndex + 1] +=\r\n                    'a=end-of-candidates\\r\\n';\r\n              }\r\n              self.localDescription.sdp = sections.join('');\r\n\r\n              var complete = self.transceivers.every(function(transceiver) {\r\n                return transceiver.iceGatherer &&\r\n                    transceiver.iceGatherer.state === 'completed';\r\n              });\r\n\r\n              // Emit candidate if localDescription is set.\r\n              // Also emits null candidate when all gatherers are complete.\r\n              switch (self.iceGatheringState) {\r\n                case 'new':\r\n                  self._localIceCandidatesBuffer.push(event);\r\n                  if (end && complete) {\r\n                    self._localIceCandidatesBuffer.push(\r\n                        new Event('icecandidate'));\r\n                  }\r\n                  break;\r\n                case 'gathering':\r\n                  self._emitBufferedCandidates();\r\n                  self.dispatchEvent(event);\r\n                  if (self.onicecandidate !== null) {\r\n                    self.onicecandidate(event);\r\n                  }\r\n                  if (complete) {\r\n                    self.dispatchEvent(new Event('icecandidate'));\r\n                    if (self.onicecandidate !== null) {\r\n                      self.onicecandidate(new Event('icecandidate'));\r\n                    }\r\n                    self.iceGatheringState = 'complete';\r\n                  }\r\n                  break;\r\n                case 'complete':\r\n                  // should not happen... currently!\r\n                  break;\r\n                default: // no-op.\r\n                  break;\r\n              }\r\n            };\r\n            iceTransport.onicestatechange = function() {\r\n              self._updateConnectionState();\r\n            };\r\n\r\n            var dtlsTransport = new RTCDtlsTransport(iceTransport);\r\n            dtlsTransport.ondtlsstatechange = function() {\r\n              self._updateConnectionState();\r\n            };\r\n            dtlsTransport.onerror = function() {\r\n              // onerror does not set state to failed by itself.\r\n              dtlsTransport.state = 'failed';\r\n              self._updateConnectionState();\r\n            };\r\n\r\n            return {\r\n              iceGatherer: iceGatherer,\r\n              iceTransport: iceTransport,\r\n              dtlsTransport: dtlsTransport\r\n            };\r\n          };\r\n\r\n      // Start the RTP Sender and Receiver for a transceiver.\r\n      window.RTCPeerConnection.prototype._transceive = function(transceiver,\r\n          send, recv) {\r\n        var params = this._getCommonCapabilities(transceiver.localCapabilities,\r\n            transceiver.remoteCapabilities);\r\n        if (send && transceiver.rtpSender) {\r\n          params.encodings = transceiver.sendEncodingParameters;\r\n          params.rtcp = {\r\n            cname: SDPUtils.localCName\r\n          };\r\n          if (transceiver.recvEncodingParameters.length) {\r\n            params.rtcp.ssrc = transceiver.recvEncodingParameters[0].ssrc;\r\n          }\r\n          transceiver.rtpSender.send(params);\r\n        }\r\n        if (recv && transceiver.rtpReceiver) {\r\n          params.encodings = transceiver.recvEncodingParameters;\r\n          params.rtcp = {\r\n            cname: transceiver.cname\r\n          };\r\n          if (transceiver.sendEncodingParameters.length) {\r\n            params.rtcp.ssrc = transceiver.sendEncodingParameters[0].ssrc;\r\n          }\r\n          transceiver.rtpReceiver.receive(params);\r\n        }\r\n      };\r\n\r\n      window.RTCPeerConnection.prototype.setLocalDescription =\r\n          function(description) {\r\n            var self = this;\r\n            var sections;\r\n            var sessionpart;\r\n            if (description.type === 'offer') {\r\n              // FIXME: What was the purpose of this empty if statement?\r\n              // if (!this._pendingOffer) {\r\n              // } else {\r\n              if (this._pendingOffer) {\r\n                // VERY limited support for SDP munging. Limited to:\r\n                // * changing the order of codecs\r\n                sections = SDPUtils.splitSections(description.sdp);\r\n                sessionpart = sections.shift();\r\n                sections.forEach(function(mediaSection, sdpMLineIndex) {\r\n                  var caps = SDPUtils.parseRtpParameters(mediaSection);\r\n                  self._pendingOffer[sdpMLineIndex].localCapabilities = caps;\r\n                });\r\n                this.transceivers = this._pendingOffer;\r\n                delete this._pendingOffer;\r\n              }\r\n            } else if (description.type === 'answer') {\r\n              sections = SDPUtils.splitSections(self.remoteDescription.sdp);\r\n              sessionpart = sections.shift();\r\n              var isIceLite = SDPUtils.matchPrefix(sessionpart,\r\n                  'a=ice-lite').length > 0;\r\n              sections.forEach(function(mediaSection, sdpMLineIndex) {\r\n                var transceiver = self.transceivers[sdpMLineIndex];\r\n                var iceGatherer = transceiver.iceGatherer;\r\n                var iceTransport = transceiver.iceTransport;\r\n                var dtlsTransport = transceiver.dtlsTransport;\r\n                var localCapabilities = transceiver.localCapabilities;\r\n                var remoteCapabilities = transceiver.remoteCapabilities;\r\n\r\n                var rejected = mediaSection.split('\\n', 1)[0]\r\n                    .split(' ', 2)[1] === '0';\r\n\r\n                if (!rejected && !transceiver.isDatachannel) {\r\n                  var remoteIceParameters = SDPUtils.getIceParameters(\r\n                      mediaSection, sessionpart);\r\n                  if (isIceLite) {\r\n                    var cands = SDPUtils.matchPrefix(mediaSection, 'a=candidate:')\r\n                    .map(function(cand) {\r\n                      return SDPUtils.parseCandidate(cand);\r\n                    })\r\n                    .filter(function(cand) {\r\n                      return cand.component === '1';\r\n                    });\r\n                    // ice-lite only includes host candidates in the SDP so we can\r\n                    // use setRemoteCandidates (which implies an\r\n                    // RTCIceCandidateComplete)\r\n                    if (cands.length) {\r\n                      iceTransport.setRemoteCandidates(cands);\r\n                    }\r\n                  }\r\n                  var remoteDtlsParameters = SDPUtils.getDtlsParameters(\r\n                      mediaSection, sessionpart);\r\n                  if (isIceLite) {\r\n                    remoteDtlsParameters.role = 'server';\r\n                  }\r\n\r\n                  if (!self.usingBundle || sdpMLineIndex === 0) {\r\n                    iceTransport.start(iceGatherer, remoteIceParameters,\r\n                        isIceLite ? 'controlling' : 'controlled');\r\n                    dtlsTransport.start(remoteDtlsParameters);\r\n                  }\r\n\r\n                  // Calculate intersection of capabilities.\r\n                  var params = self._getCommonCapabilities(localCapabilities,\r\n                      remoteCapabilities);\r\n\r\n                  // Start the RTCRtpSender. The RTCRtpReceiver for this\r\n                  // transceiver has already been started in setRemoteDescription.\r\n                  self._transceive(transceiver,\r\n                      params.codecs.length > 0,\r\n                      false);\r\n                }\r\n              });\r\n            }\r\n\r\n            this.localDescription = {\r\n              type: description.type,\r\n              sdp: description.sdp\r\n            };\r\n            switch (description.type) {\r\n              case 'offer':\r\n                this._updateSignalingState('have-local-offer');\r\n                break;\r\n              case 'answer':\r\n                this._updateSignalingState('stable');\r\n                break;\r\n              default:\r\n                throw new TypeError('unsupported type \"' + description.type +\r\n                    '\"');\r\n            }\r\n\r\n            // If a success callback was provided, emit ICE candidates after it\r\n            // has been executed. Otherwise, emit callback after the Promise is\r\n            // resolved.\r\n            var hasCallback = arguments.length > 1 &&\r\n              typeof arguments[1] === 'function';\r\n            if (hasCallback) {\r\n              var cb = arguments[1];\r\n              window.setTimeout(function() {\r\n                cb();\r\n                if (self.iceGatheringState === 'new') {\r\n                  self.iceGatheringState = 'gathering';\r\n                }\r\n                self._emitBufferedCandidates();\r\n              }, 0);\r\n            }\r\n            var p = Promise.resolve();\r\n            p.then(function() {\r\n              if (!hasCallback) {\r\n                if (self.iceGatheringState === 'new') {\r\n                  self.iceGatheringState = 'gathering';\r\n                }\r\n                // Usually candidates will be emitted earlier.\r\n                window.setTimeout(self._emitBufferedCandidates.bind(self), 500);\r\n              }\r\n            });\r\n            return p;\r\n          };\r\n\r\n      window.RTCPeerConnection.prototype.setRemoteDescription =\r\n          function(description) {\r\n            var self = this;\r\n            var stream = new MediaStream();\r\n            var receiverList = [];\r\n            var sections = SDPUtils.splitSections(description.sdp);\r\n            var sessionpart = sections.shift();\r\n            var isIceLite = SDPUtils.matchPrefix(sessionpart,\r\n                'a=ice-lite').length > 0;\r\n            this.usingBundle = SDPUtils.matchPrefix(sessionpart,\r\n                'a=group:BUNDLE ').length > 0;\r\n            sections.forEach(function(mediaSection, sdpMLineIndex) {\r\n              var lines = SDPUtils.splitLines(mediaSection);\r\n              var mline = lines[0].substr(2).split(' ');\r\n              var kind = mline[0];\r\n              var rejected = mline[1] === '0';\r\n              var direction = SDPUtils.getDirection(mediaSection, sessionpart);\r\n\r\n              var mid = SDPUtils.matchPrefix(mediaSection, 'a=mid:');\r\n              if (mid.length) {\r\n                mid = mid[0].substr(6);\r\n              } else {\r\n                mid = SDPUtils.generateIdentifier();\r\n              }\r\n\r\n              // Reject datachannels which are not implemented yet.\r\n              if (kind === 'application' && mline[2] === 'DTLS/SCTP') {\r\n                self.transceivers[sdpMLineIndex] = {\r\n                  mid: mid,\r\n                  isDatachannel: true\r\n                };\r\n                return;\r\n              }\r\n\r\n              var transceiver;\r\n              var iceGatherer;\r\n              var iceTransport;\r\n              var dtlsTransport;\r\n              var rtpSender;\r\n              var rtpReceiver;\r\n              var sendEncodingParameters;\r\n              var recvEncodingParameters;\r\n              var localCapabilities;\r\n\r\n              var track;\r\n              // FIXME: ensure the mediaSection has rtcp-mux set.\r\n              var remoteCapabilities = SDPUtils.parseRtpParameters(mediaSection);\r\n              var remoteIceParameters;\r\n              var remoteDtlsParameters;\r\n              if (!rejected) {\r\n                remoteIceParameters = SDPUtils.getIceParameters(mediaSection,\r\n                    sessionpart);\r\n                remoteDtlsParameters = SDPUtils.getDtlsParameters(mediaSection,\r\n                    sessionpart);\r\n                remoteDtlsParameters.role = 'client';\r\n              }\r\n              recvEncodingParameters =\r\n                  SDPUtils.parseRtpEncodingParameters(mediaSection);\r\n\r\n              var cname;\r\n              // Gets the first SSRC. Note that with RTX there might be multiple\r\n              // SSRCs.\r\n              var remoteSsrc = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\r\n                  .map(function(line) {\r\n                    return SDPUtils.parseSsrcMedia(line);\r\n                  })\r\n                  .filter(function(obj) {\r\n                    return obj.attribute === 'cname';\r\n                  })[0];\r\n              if (remoteSsrc) {\r\n                cname = remoteSsrc.value;\r\n              }\r\n\r\n              var isComplete = SDPUtils.matchPrefix(mediaSection,\r\n                  'a=end-of-candidates', sessionpart).length > 0;\r\n              var cands = SDPUtils.matchPrefix(mediaSection, 'a=candidate:')\r\n                  .map(function(cand) {\r\n                    return SDPUtils.parseCandidate(cand);\r\n                  })\r\n                  .filter(function(cand) {\r\n                    return cand.component === '1';\r\n                  });\r\n              if (description.type === 'offer' && !rejected) {\r\n                var transports = self.usingBundle && sdpMLineIndex > 0 ? {\r\n                  iceGatherer: self.transceivers[0].iceGatherer,\r\n                  iceTransport: self.transceivers[0].iceTransport,\r\n                  dtlsTransport: self.transceivers[0].dtlsTransport\r\n                } : self._createIceAndDtlsTransports(mid, sdpMLineIndex);\r\n\r\n                if (isComplete) {\r\n                  transports.iceTransport.setRemoteCandidates(cands);\r\n                }\r\n\r\n                localCapabilities = RTCRtpReceiver.getCapabilities(kind);\r\n                sendEncodingParameters = [{\r\n                  ssrc: (2 * sdpMLineIndex + 2) * 1001\r\n                }];\r\n\r\n                rtpReceiver = new RTCRtpReceiver(transports.dtlsTransport, kind);\r\n\r\n                track = rtpReceiver.track;\r\n                receiverList.push([track, rtpReceiver]);\r\n                // FIXME: not correct when there are multiple streams but that is\r\n                // not currently supported in this shim.\r\n                stream.addTrack(track);\r\n\r\n                // FIXME: look at direction.\r\n                if (self.localStreams.length > 0 &&\r\n                    self.localStreams[0].getTracks().length >= sdpMLineIndex) {\r\n                  var localTrack;\r\n                  if (kind === 'audio') {\r\n                    localTrack = self.localStreams[0].getAudioTracks()[0];\r\n                  } else if (kind === 'video') {\r\n                    localTrack = self.localStreams[0].getVideoTracks()[0];\r\n                  }\r\n                  if (localTrack) {\r\n                    rtpSender = new RTCRtpSender(localTrack,\r\n                        transports.dtlsTransport);\r\n                  }\r\n                }\r\n\r\n                self.transceivers[sdpMLineIndex] = {\r\n                  iceGatherer: transports.iceGatherer,\r\n                  iceTransport: transports.iceTransport,\r\n                  dtlsTransport: transports.dtlsTransport,\r\n                  localCapabilities: localCapabilities,\r\n                  remoteCapabilities: remoteCapabilities,\r\n                  rtpSender: rtpSender,\r\n                  rtpReceiver: rtpReceiver,\r\n                  kind: kind,\r\n                  mid: mid,\r\n                  cname: cname,\r\n                  sendEncodingParameters: sendEncodingParameters,\r\n                  recvEncodingParameters: recvEncodingParameters\r\n                };\r\n                // Start the RTCRtpReceiver now. The RTPSender is started in\r\n                // setLocalDescription.\r\n                self._transceive(self.transceivers[sdpMLineIndex],\r\n                    false,\r\n                    direction === 'sendrecv' || direction === 'sendonly');\r\n              } else if (description.type === 'answer' && !rejected) {\r\n                transceiver = self.transceivers[sdpMLineIndex];\r\n                iceGatherer = transceiver.iceGatherer;\r\n                iceTransport = transceiver.iceTransport;\r\n                dtlsTransport = transceiver.dtlsTransport;\r\n                rtpSender = transceiver.rtpSender;\r\n                rtpReceiver = transceiver.rtpReceiver;\r\n                sendEncodingParameters = transceiver.sendEncodingParameters;\r\n                localCapabilities = transceiver.localCapabilities;\r\n\r\n                self.transceivers[sdpMLineIndex].recvEncodingParameters =\r\n                    recvEncodingParameters;\r\n                self.transceivers[sdpMLineIndex].remoteCapabilities =\r\n                    remoteCapabilities;\r\n                self.transceivers[sdpMLineIndex].cname = cname;\r\n\r\n                if ((isIceLite || isComplete) && cands.length) {\r\n                  iceTransport.setRemoteCandidates(cands);\r\n                }\r\n                if (!self.usingBundle || sdpMLineIndex === 0) {\r\n                  iceTransport.start(iceGatherer, remoteIceParameters,\r\n                      'controlling');\r\n                  dtlsTransport.start(remoteDtlsParameters);\r\n                }\r\n\r\n                self._transceive(transceiver,\r\n                    direction === 'sendrecv' || direction === 'recvonly',\r\n                    direction === 'sendrecv' || direction === 'sendonly');\r\n\r\n                if (rtpReceiver &&\r\n                    (direction === 'sendrecv' || direction === 'sendonly')) {\r\n                  track = rtpReceiver.track;\r\n                  receiverList.push([track, rtpReceiver]);\r\n                  stream.addTrack(track);\r\n                } else {\r\n                  // FIXME: actually the receiver should be created later.\r\n                  delete transceiver.rtpReceiver;\r\n                }\r\n              }\r\n            });\r\n\r\n            this.remoteDescription = {\r\n              type: description.type,\r\n              sdp: description.sdp\r\n            };\r\n            switch (description.type) {\r\n              case 'offer':\r\n                this._updateSignalingState('have-remote-offer');\r\n                break;\r\n              case 'answer':\r\n                this._updateSignalingState('stable');\r\n                break;\r\n              default:\r\n                throw new TypeError('unsupported type \"' + description.type +\r\n                    '\"');\r\n            }\r\n            if (stream.getTracks().length) {\r\n              self.remoteStreams.push(stream);\r\n              window.setTimeout(function() {\r\n                var event = new Event('addstream');\r\n                event.stream = stream;\r\n                self.dispatchEvent(event);\r\n                if (self.onaddstream !== null) {\r\n                  window.setTimeout(function() {\r\n                    self.onaddstream(event);\r\n                  }, 0);\r\n                }\r\n\r\n                receiverList.forEach(function(item) {\r\n                  var track = item[0];\r\n                  var receiver = item[1];\r\n                  var trackEvent = new Event('track');\r\n                  trackEvent.track = track;\r\n                  trackEvent.receiver = receiver;\r\n                  trackEvent.streams = [stream];\r\n                  self.dispatchEvent(event);\r\n                  if (self.ontrack !== null) {\r\n                    window.setTimeout(function() {\r\n                      self.ontrack(trackEvent);\r\n                    }, 0);\r\n                  }\r\n                });\r\n              }, 0);\r\n            }\r\n            if (arguments.length > 1 && typeof arguments[1] === 'function') {\r\n              window.setTimeout(arguments[1], 0);\r\n            }\r\n            return Promise.resolve();\r\n          };\r\n\r\n      window.RTCPeerConnection.prototype.close = function() {\r\n        this.transceivers.forEach(function(transceiver) {\r\n          /* not yet\r\n          if (transceiver.iceGatherer) {\r\n            transceiver.iceGatherer.close();\r\n          }\r\n          */\r\n          if (transceiver.iceTransport) {\r\n            transceiver.iceTransport.stop();\r\n          }\r\n          if (transceiver.dtlsTransport) {\r\n            transceiver.dtlsTransport.stop();\r\n          }\r\n          if (transceiver.rtpSender) {\r\n            transceiver.rtpSender.stop();\r\n          }\r\n          if (transceiver.rtpReceiver) {\r\n            transceiver.rtpReceiver.stop();\r\n          }\r\n        });\r\n        // FIXME: clean up tracks, local streams, remote streams, etc\r\n        this._updateSignalingState('closed');\r\n      };\r\n\r\n      // Update the signaling state.\r\n      window.RTCPeerConnection.prototype._updateSignalingState =\r\n          function(newState) {\r\n            this.signalingState = newState;\r\n            var event = new Event('signalingstatechange');\r\n            this.dispatchEvent(event);\r\n            if (this.onsignalingstatechange !== null) {\r\n              this.onsignalingstatechange(event);\r\n            }\r\n          };\r\n\r\n      // Determine whether to fire the negotiationneeded event.\r\n      window.RTCPeerConnection.prototype._maybeFireNegotiationNeeded =\r\n          function() {\r\n            // Fire away (for now).\r\n            var event = new Event('negotiationneeded');\r\n            this.dispatchEvent(event);\r\n            if (this.onnegotiationneeded !== null) {\r\n              this.onnegotiationneeded(event);\r\n            }\r\n          };\r\n\r\n      // Update the connection state.\r\n      window.RTCPeerConnection.prototype._updateConnectionState = function() {\r\n        var self = this;\r\n        var newState;\r\n        var states = {\r\n          'new': 0,\r\n          closed: 0,\r\n          connecting: 0,\r\n          checking: 0,\r\n          connected: 0,\r\n          completed: 0,\r\n          failed: 0\r\n        };\r\n        this.transceivers.forEach(function(transceiver) {\r\n          states[transceiver.iceTransport.state]++;\r\n          states[transceiver.dtlsTransport.state]++;\r\n        });\r\n        // ICETransport.completed and connected are the same for this purpose.\r\n        states.connected += states.completed;\r\n\r\n        newState = 'new';\r\n        if (states.failed > 0) {\r\n          newState = 'failed';\r\n        } else if (states.connecting > 0 || states.checking > 0) {\r\n          newState = 'connecting';\r\n        } else if (states.disconnected > 0) {\r\n          newState = 'disconnected';\r\n        } else if (states.new > 0) {\r\n          newState = 'new';\r\n        } else if (states.connected > 0 || states.completed > 0) {\r\n          newState = 'connected';\r\n        }\r\n\r\n        if (newState !== self.iceConnectionState) {\r\n          self.iceConnectionState = newState;\r\n          var event = new Event('iceconnectionstatechange');\r\n          this.dispatchEvent(event);\r\n          if (this.oniceconnectionstatechange !== null) {\r\n            this.oniceconnectionstatechange(event);\r\n          }\r\n        }\r\n      };\r\n\r\n      window.RTCPeerConnection.prototype.createOffer = function() {\r\n        var self = this;\r\n        if (this._pendingOffer) {\r\n          throw new Error('createOffer called while there is a pending offer.');\r\n        }\r\n        var offerOptions;\r\n        if (arguments.length === 1 && typeof arguments[0] !== 'function') {\r\n          offerOptions = arguments[0];\r\n        } else if (arguments.length === 3) {\r\n          offerOptions = arguments[2];\r\n        }\r\n\r\n        var tracks = [];\r\n        var numAudioTracks = 0;\r\n        var numVideoTracks = 0;\r\n        // Default to sendrecv.\r\n        if (this.localStreams.length) {\r\n          numAudioTracks = this.localStreams[0].getAudioTracks().length;\r\n          numVideoTracks = this.localStreams[0].getVideoTracks().length;\r\n        }\r\n        // Determine number of audio and video tracks we need to send/recv.\r\n        if (offerOptions) {\r\n          // Reject Chrome legacy constraints.\r\n          if (offerOptions.mandatory || offerOptions.optional) {\r\n            throw new TypeError(\r\n                'Legacy mandatory/optional constraints not supported.');\r\n          }\r\n          if (offerOptions.offerToReceiveAudio !== undefined) {\r\n            numAudioTracks = offerOptions.offerToReceiveAudio;\r\n          }\r\n          if (offerOptions.offerToReceiveVideo !== undefined) {\r\n            numVideoTracks = offerOptions.offerToReceiveVideo;\r\n          }\r\n        }\r\n        if (this.localStreams.length) {\r\n          // Push local streams.\r\n          this.localStreams[0].getTracks().forEach(function(track) {\r\n            tracks.push({\r\n              kind: track.kind,\r\n              track: track,\r\n              wantReceive: track.kind === 'audio' ?\r\n                  numAudioTracks > 0 : numVideoTracks > 0\r\n            });\r\n            if (track.kind === 'audio') {\r\n              numAudioTracks--;\r\n            } else if (track.kind === 'video') {\r\n              numVideoTracks--;\r\n            }\r\n          });\r\n        }\r\n        // Create M-lines for recvonly streams.\r\n        while (numAudioTracks > 0 || numVideoTracks > 0) {\r\n          if (numAudioTracks > 0) {\r\n            tracks.push({\r\n              kind: 'audio',\r\n              wantReceive: true\r\n            });\r\n            numAudioTracks--;\r\n          }\r\n          if (numVideoTracks > 0) {\r\n            tracks.push({\r\n              kind: 'video',\r\n              wantReceive: true\r\n            });\r\n            numVideoTracks--;\r\n          }\r\n        }\r\n\r\n        var sdp = SDPUtils.writeSessionBoilerplate();\r\n        var transceivers = [];\r\n        tracks.forEach(function(mline, sdpMLineIndex) {\r\n          // For each track, create an ice gatherer, ice transport,\r\n          // dtls transport, potentially rtpsender and rtpreceiver.\r\n          var track = mline.track;\r\n          var kind = mline.kind;\r\n          var mid = SDPUtils.generateIdentifier();\r\n\r\n          var transports = self.usingBundle && sdpMLineIndex > 0 ? {\r\n            iceGatherer: transceivers[0].iceGatherer,\r\n            iceTransport: transceivers[0].iceTransport,\r\n            dtlsTransport: transceivers[0].dtlsTransport\r\n          } : self._createIceAndDtlsTransports(mid, sdpMLineIndex);\r\n\r\n          var localCapabilities = RTCRtpSender.getCapabilities(kind);\r\n          var rtpSender;\r\n          var rtpReceiver;\r\n\r\n          // generate an ssrc now, to be used later in rtpSender.send\r\n          var sendEncodingParameters = [{\r\n            ssrc: (2 * sdpMLineIndex + 1) * 1001\r\n          }];\r\n          if (track) {\r\n            rtpSender = new RTCRtpSender(track, transports.dtlsTransport);\r\n          }\r\n\r\n          if (mline.wantReceive) {\r\n            rtpReceiver = new RTCRtpReceiver(transports.dtlsTransport, kind);\r\n          }\r\n\r\n          transceivers[sdpMLineIndex] = {\r\n            iceGatherer: transports.iceGatherer,\r\n            iceTransport: transports.iceTransport,\r\n            dtlsTransport: transports.dtlsTransport,\r\n            localCapabilities: localCapabilities,\r\n            remoteCapabilities: null,\r\n            rtpSender: rtpSender,\r\n            rtpReceiver: rtpReceiver,\r\n            kind: kind,\r\n            mid: mid,\r\n            sendEncodingParameters: sendEncodingParameters,\r\n            recvEncodingParameters: null\r\n          };\r\n        });\r\n        if (this.usingBundle) {\r\n          sdp += 'a=group:BUNDLE ' + transceivers.map(function(t) {\r\n            return t.mid;\r\n          }).join(' ') + '\\r\\n';\r\n        }\r\n        tracks.forEach(function(mline, sdpMLineIndex) {\r\n          var transceiver = transceivers[sdpMLineIndex];\r\n          sdp += SDPUtils.writeMediaSection(transceiver,\r\n              transceiver.localCapabilities, 'offer', self.localStreams[0]);\r\n        });\r\n\r\n        this._pendingOffer = transceivers;\r\n        var desc = new RTCSessionDescription({\r\n          type: 'offer',\r\n          sdp: sdp\r\n        });\r\n        if (arguments.length && typeof arguments[0] === 'function') {\r\n          window.setTimeout(arguments[0], 0, desc);\r\n        }\r\n        return Promise.resolve(desc);\r\n      };\r\n\r\n      window.RTCPeerConnection.prototype.createAnswer = function() {\r\n        var self = this;\r\n\r\n        var sdp = SDPUtils.writeSessionBoilerplate();\r\n        if (this.usingBundle) {\r\n          sdp += 'a=group:BUNDLE ' + this.transceivers.map(function(t) {\r\n            return t.mid;\r\n          }).join(' ') + '\\r\\n';\r\n        }\r\n        this.transceivers.forEach(function(transceiver) {\r\n          if (transceiver.isDatachannel) {\r\n            sdp += 'm=application 0 DTLS/SCTP 5000\\r\\n' +\r\n                'c=IN IP4 0.0.0.0\\r\\n' +\r\n                'a=mid:' + transceiver.mid + '\\r\\n';\r\n            return;\r\n          }\r\n          // Calculate intersection of capabilities.\r\n          var commonCapabilities = self._getCommonCapabilities(\r\n              transceiver.localCapabilities,\r\n              transceiver.remoteCapabilities);\r\n\r\n          sdp += SDPUtils.writeMediaSection(transceiver, commonCapabilities,\r\n              'answer', self.localStreams[0]);\r\n        });\r\n\r\n        var desc = new RTCSessionDescription({\r\n          type: 'answer',\r\n          sdp: sdp\r\n        });\r\n        if (arguments.length && typeof arguments[0] === 'function') {\r\n          window.setTimeout(arguments[0], 0, desc);\r\n        }\r\n        return Promise.resolve(desc);\r\n      };\r\n\r\n      window.RTCPeerConnection.prototype.addIceCandidate = function(candidate) {\r\n        if (candidate === null) {\r\n          this.transceivers.forEach(function(transceiver) {\r\n            transceiver.iceTransport.addRemoteCandidate({});\r\n          });\r\n        } else {\r\n          var mLineIndex = candidate.sdpMLineIndex;\r\n          if (candidate.sdpMid) {\r\n            for (var i = 0; i < this.transceivers.length; i++) {\r\n              if (this.transceivers[i].mid === candidate.sdpMid) {\r\n                mLineIndex = i;\r\n                break;\r\n              }\r\n            }\r\n          }\r\n          var transceiver = this.transceivers[mLineIndex];\r\n          if (transceiver) {\r\n            var cand = Object.keys(candidate.candidate).length > 0 ?\r\n                SDPUtils.parseCandidate(candidate.candidate) : {};\r\n            // Ignore Chrome's invalid candidates since Edge does not like them.\r\n            if (cand.protocol === 'tcp' && (cand.port === 0 || cand.port === 9)) {\r\n              return;\r\n            }\r\n            // Ignore RTCP candidates, we assume RTCP-MUX.\r\n            if (cand.component !== '1') {\r\n              return;\r\n            }\r\n            // A dirty hack to make samples work.\r\n            if (cand.type === 'endOfCandidates') {\r\n              cand = {};\r\n            }\r\n            transceiver.iceTransport.addRemoteCandidate(cand);\r\n\r\n            // update the remoteDescription.\r\n            var sections = SDPUtils.splitSections(this.remoteDescription.sdp);\r\n            sections[mLineIndex + 1] += (cand.type ? candidate.candidate.trim()\r\n                : 'a=end-of-candidates') + '\\r\\n';\r\n            this.remoteDescription.sdp = sections.join('');\r\n          }\r\n        }\r\n        if (arguments.length > 1 && typeof arguments[1] === 'function') {\r\n          window.setTimeout(arguments[1], 0);\r\n        }\r\n        return Promise.resolve();\r\n      };\r\n\r\n      window.RTCPeerConnection.prototype.getStats = function() {\r\n        var promises = [];\r\n        this.transceivers.forEach(function(transceiver) {\r\n          ['rtpSender', 'rtpReceiver', 'iceGatherer', 'iceTransport',\r\n              'dtlsTransport'].forEach(function(method) {\r\n                if (transceiver[method]) {\r\n                  promises.push(transceiver[method].getStats());\r\n                }\r\n              });\r\n        });\r\n        var cb = arguments.length > 1 && typeof arguments[1] === 'function' &&\r\n            arguments[1];\r\n        return new Promise(function(resolve) {\r\n          // shim getStats with maplike support\r\n          var results = new Map();\r\n          Promise.all(promises).then(function(res) {\r\n            res.forEach(function(result) {\r\n              Object.keys(result).forEach(function(id) {\r\n                results.set(id, result[id]);\r\n                results[id] = result[id];\r\n              });\r\n            });\r\n            if (cb) {\r\n              window.setTimeout(cb, 0, results);\r\n            }\r\n            resolve(results);\r\n          });\r\n        });\r\n      };\r\n    }\r\n  };\r\n\r\n  // Expose public methods.\r\n  module.exports = {\r\n    shimPeerConnection: edgeShim.shimPeerConnection,\r\n    shimGetUserMedia: require('./getusermedia')\r\n  };\r\n\r\n  },{\"../utils\":10,\"./getusermedia\":6,\"sdp\":1}],6:[function(require,module,exports){\r\n  /*\r\n   *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\r\n   *\r\n   *  Use of this source code is governed by a BSD-style license\r\n   *  that can be found in the LICENSE file in the root of the source\r\n   *  tree.\r\n   */\r\n   /* eslint-env node */\r\n  'use strict';\r\n\r\n  // Expose public methods.\r\n  module.exports = function() {\r\n    var shimError_ = function(e) {\r\n      return {\r\n        name: {PermissionDeniedError: 'NotAllowedError'}[e.name] || e.name,\r\n        message: e.message,\r\n        constraint: e.constraint,\r\n        toString: function() {\r\n          return this.name;\r\n        }\r\n      };\r\n    };\r\n\r\n    // getUserMedia error shim.\r\n    var origGetUserMedia = navigator.mediaDevices.getUserMedia.\r\n        bind(navigator.mediaDevices);\r\n    navigator.mediaDevices.getUserMedia = function(c) {\r\n      return origGetUserMedia(c).catch(function(e) {\r\n        return Promise.reject(shimError_(e));\r\n      });\r\n    };\r\n  };\r\n\r\n  },{}],7:[function(require,module,exports){\r\n  /*\r\n   *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\r\n   *\r\n   *  Use of this source code is governed by a BSD-style license\r\n   *  that can be found in the LICENSE file in the root of the source\r\n   *  tree.\r\n   */\r\n   /* eslint-env node */\r\n  'use strict';\r\n\r\n  var browserDetails = require('../utils').browserDetails;\r\n\r\n  var firefoxShim = {\r\n    shimOnTrack: function() {\r\n      if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in\r\n          window.RTCPeerConnection.prototype)) {\r\n        Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\r\n          get: function() {\r\n            return this._ontrack;\r\n          },\r\n          set: function(f) {\r\n            if (this._ontrack) {\r\n              this.removeEventListener('track', this._ontrack);\r\n              this.removeEventListener('addstream', this._ontrackpoly);\r\n            }\r\n            this.addEventListener('track', this._ontrack = f);\r\n            this.addEventListener('addstream', this._ontrackpoly = function(e) {\r\n              e.stream.getTracks().forEach(function(track) {\r\n                var event = new Event('track');\r\n                event.track = track;\r\n                event.receiver = {track: track};\r\n                event.streams = [e.stream];\r\n                this.dispatchEvent(event);\r\n              }.bind(this));\r\n            }.bind(this));\r\n          }\r\n        });\r\n      }\r\n    },\r\n\r\n    shimSourceObject: function() {\r\n      // Firefox has supported mozSrcObject since FF22, unprefixed in 42.\r\n      if (typeof window === 'object') {\r\n        if (window.HTMLMediaElement &&\r\n          !('srcObject' in window.HTMLMediaElement.prototype)) {\r\n          // Shim the srcObject property, once, when HTMLMediaElement is found.\r\n          Object.defineProperty(window.HTMLMediaElement.prototype, 'srcObject', {\r\n            get: function() {\r\n              return this.mozSrcObject;\r\n            },\r\n            set: function(stream) {\r\n              this.mozSrcObject = stream;\r\n            }\r\n          });\r\n        }\r\n      }\r\n    },\r\n\r\n    shimPeerConnection: function() {\r\n      if (typeof window !== 'object' || !(window.RTCPeerConnection ||\r\n          window.mozRTCPeerConnection)) {\r\n        return; // probably media.peerconnection.enabled=false in about:config\r\n      }\r\n      // The RTCPeerConnection object.\r\n      if (!window.RTCPeerConnection) {\r\n        window.RTCPeerConnection = function(pcConfig, pcConstraints) {\r\n          if (browserDetails.version < 38) {\r\n            // .urls is not supported in FF < 38.\r\n            // create RTCIceServers with a single url.\r\n            if (pcConfig && pcConfig.iceServers) {\r\n              var newIceServers = [];\r\n              for (var i = 0; i < pcConfig.iceServers.length; i++) {\r\n                var server = pcConfig.iceServers[i];\r\n                if (server.hasOwnProperty('urls')) {\r\n                  for (var j = 0; j < server.urls.length; j++) {\r\n                    var newServer = {\r\n                      url: server.urls[j]\r\n                    };\r\n                    if (server.urls[j].indexOf('turn') === 0) {\r\n                      newServer.username = server.username;\r\n                      newServer.credential = server.credential;\r\n                    }\r\n                    newIceServers.push(newServer);\r\n                  }\r\n                } else {\r\n                  newIceServers.push(pcConfig.iceServers[i]);\r\n                }\r\n              }\r\n              pcConfig.iceServers = newIceServers;\r\n            }\r\n          }\r\n          return new mozRTCPeerConnection(pcConfig, pcConstraints);\r\n        };\r\n        window.RTCPeerConnection.prototype = mozRTCPeerConnection.prototype;\r\n\r\n        // wrap static methods. Currently just generateCertificate.\r\n        if (mozRTCPeerConnection.generateCertificate) {\r\n          Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\r\n            get: function() {\r\n              return mozRTCPeerConnection.generateCertificate;\r\n            }\r\n          });\r\n        }\r\n\r\n        window.RTCSessionDescription = mozRTCSessionDescription;\r\n        window.RTCIceCandidate = mozRTCIceCandidate;\r\n      }\r\n\r\n      // shim away need for obsolete RTCIceCandidate/RTCSessionDescription.\r\n      ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\r\n          .forEach(function(method) {\r\n            var nativeMethod = RTCPeerConnection.prototype[method];\r\n            RTCPeerConnection.prototype[method] = function() {\r\n              arguments[0] = new ((method === 'addIceCandidate') ?\r\n                  RTCIceCandidate : RTCSessionDescription)(arguments[0]);\r\n              return nativeMethod.apply(this, arguments);\r\n            };\r\n          });\r\n\r\n      // support for addIceCandidate(null)\r\n      var nativeAddIceCandidate =\r\n          RTCPeerConnection.prototype.addIceCandidate;\r\n      RTCPeerConnection.prototype.addIceCandidate = function() {\r\n        return arguments[0] === null ? Promise.resolve()\r\n            : nativeAddIceCandidate.apply(this, arguments);\r\n      };\r\n\r\n      // shim getStats with maplike support\r\n      var makeMapStats = function(stats) {\r\n        var map = new Map();\r\n        Object.keys(stats).forEach(function(key) {\r\n          map.set(key, stats[key]);\r\n          map[key] = stats[key];\r\n        });\r\n        return map;\r\n      };\r\n\r\n      var nativeGetStats = RTCPeerConnection.prototype.getStats;\r\n      RTCPeerConnection.prototype.getStats = function(selector, onSucc, onErr) {\r\n        return nativeGetStats.apply(this, [selector || null])\r\n          .then(function(stats) {\r\n            return makeMapStats(stats);\r\n          })\r\n          .then(onSucc, onErr);\r\n      };\r\n    }\r\n  };\r\n\r\n  // Expose public methods.\r\n  module.exports = {\r\n    shimOnTrack: firefoxShim.shimOnTrack,\r\n    shimSourceObject: firefoxShim.shimSourceObject,\r\n    shimPeerConnection: firefoxShim.shimPeerConnection,\r\n    shimGetUserMedia: require('./getusermedia')\r\n  };\r\n\r\n  },{\"../utils\":10,\"./getusermedia\":8}],8:[function(require,module,exports){\r\n  /*\r\n   *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\r\n   *\r\n   *  Use of this source code is governed by a BSD-style license\r\n   *  that can be found in the LICENSE file in the root of the source\r\n   *  tree.\r\n   */\r\n   /* eslint-env node */\r\n  'use strict';\r\n\r\n  var logging = require('../utils').log;\r\n  var browserDetails = require('../utils').browserDetails;\r\n\r\n  // Expose public methods.\r\n  module.exports = function() {\r\n    var shimError_ = function(e) {\r\n      return {\r\n        name: {\r\n          SecurityError: 'NotAllowedError',\r\n          PermissionDeniedError: 'NotAllowedError'\r\n        }[e.name] || e.name,\r\n        message: {\r\n          'The operation is insecure.': 'The request is not allowed by the ' +\r\n          'user agent or the platform in the current context.'\r\n        }[e.message] || e.message,\r\n        constraint: e.constraint,\r\n        toString: function() {\r\n          return this.name + (this.message && ': ') + this.message;\r\n        }\r\n      };\r\n    };\r\n\r\n    // getUserMedia constraints shim.\r\n    var getUserMedia_ = function(constraints, onSuccess, onError) {\r\n      var constraintsToFF37_ = function(c) {\r\n        if (typeof c !== 'object' || c.require) {\r\n          return c;\r\n        }\r\n        var require = [];\r\n        Object.keys(c).forEach(function(key) {\r\n          if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\r\n            return;\r\n          }\r\n          var r = c[key] = (typeof c[key] === 'object') ?\r\n              c[key] : {ideal: c[key]};\r\n          if (r.min !== undefined ||\r\n              r.max !== undefined || r.exact !== undefined) {\r\n            require.push(key);\r\n          }\r\n          if (r.exact !== undefined) {\r\n            if (typeof r.exact === 'number') {\r\n              r. min = r.max = r.exact;\r\n            } else {\r\n              c[key] = r.exact;\r\n            }\r\n            delete r.exact;\r\n          }\r\n          if (r.ideal !== undefined) {\r\n            c.advanced = c.advanced || [];\r\n            var oc = {};\r\n            if (typeof r.ideal === 'number') {\r\n              oc[key] = {min: r.ideal, max: r.ideal};\r\n            } else {\r\n              oc[key] = r.ideal;\r\n            }\r\n            c.advanced.push(oc);\r\n            delete r.ideal;\r\n            if (!Object.keys(r).length) {\r\n              delete c[key];\r\n            }\r\n          }\r\n        });\r\n        if (require.length) {\r\n          c.require = require;\r\n        }\r\n        return c;\r\n      };\r\n      constraints = JSON.parse(JSON.stringify(constraints));\r\n      if (browserDetails.version < 38) {\r\n        logging('spec: ' + JSON.stringify(constraints));\r\n        if (constraints.audio) {\r\n          constraints.audio = constraintsToFF37_(constraints.audio);\r\n        }\r\n        if (constraints.video) {\r\n          constraints.video = constraintsToFF37_(constraints.video);\r\n        }\r\n        logging('ff37: ' + JSON.stringify(constraints));\r\n      }\r\n      return navigator.mozGetUserMedia(constraints, onSuccess, function(e) {\r\n        onError(shimError_(e));\r\n      });\r\n    };\r\n\r\n    // Returns the result of getUserMedia as a Promise.\r\n    var getUserMediaPromise_ = function(constraints) {\r\n      return new Promise(function(resolve, reject) {\r\n        getUserMedia_(constraints, resolve, reject);\r\n      });\r\n    };\r\n\r\n    // Shim for mediaDevices on older versions.\r\n    if (!navigator.mediaDevices) {\r\n      navigator.mediaDevices = {getUserMedia: getUserMediaPromise_,\r\n        addEventListener: function() { },\r\n        removeEventListener: function() { }\r\n      };\r\n    }\r\n    navigator.mediaDevices.enumerateDevices =\r\n        navigator.mediaDevices.enumerateDevices || function() {\r\n          return new Promise(function(resolve) {\r\n            var infos = [\r\n              {kind: 'audioinput', deviceId: 'default', label: '', groupId: ''},\r\n              {kind: 'videoinput', deviceId: 'default', label: '', groupId: ''}\r\n            ];\r\n            resolve(infos);\r\n          });\r\n        };\r\n\r\n    if (browserDetails.version < 41) {\r\n      // Work around http://bugzil.la/1169665\r\n      var orgEnumerateDevices =\r\n          navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);\r\n      navigator.mediaDevices.enumerateDevices = function() {\r\n        return orgEnumerateDevices().then(undefined, function(e) {\r\n          if (e.name === 'NotFoundError') {\r\n            return [];\r\n          }\r\n          throw e;\r\n        });\r\n      };\r\n    }\r\n    if (browserDetails.version < 49) {\r\n      var origGetUserMedia = navigator.mediaDevices.getUserMedia.\r\n          bind(navigator.mediaDevices);\r\n      navigator.mediaDevices.getUserMedia = function(c) {\r\n        return origGetUserMedia(c).catch(function(e) {\r\n          return Promise.reject(shimError_(e));\r\n        });\r\n      };\r\n    }\r\n    navigator.getUserMedia = function(constraints, onSuccess, onError) {\r\n      if (browserDetails.version < 44) {\r\n        return getUserMedia_(constraints, onSuccess, onError);\r\n      }\r\n      // Replace Firefox 44+'s deprecation warning with unprefixed version.\r\n      console.warn('navigator.getUserMedia has been replaced by ' +\r\n                   'navigator.mediaDevices.getUserMedia');\r\n      navigator.mediaDevices.getUserMedia(constraints).then(onSuccess, onError);\r\n    };\r\n  };\r\n\r\n  },{\"../utils\":10}],9:[function(require,module,exports){\r\n  /*\r\n   *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\r\n   *\r\n   *  Use of this source code is governed by a BSD-style license\r\n   *  that can be found in the LICENSE file in the root of the source\r\n   *  tree.\r\n   */\r\n  'use strict';\r\n  var safariShim = {\r\n    // TODO: DrAlex, should be here, double check against LayoutTests\r\n    // shimOnTrack: function() { },\r\n\r\n    // TODO: once the back-end for the mac port is done, add.\r\n    // TODO: check for webkitGTK+\r\n    // shimPeerConnection: function() { },\r\n\r\n    shimGetUserMedia: function() {\r\n      navigator.getUserMedia = navigator.webkitGetUserMedia;\r\n    }\r\n  };\r\n\r\n  // Expose public methods.\r\n  module.exports = {\r\n    shimGetUserMedia: safariShim.shimGetUserMedia\r\n    // TODO\r\n    // shimOnTrack: safariShim.shimOnTrack,\r\n    // shimPeerConnection: safariShim.shimPeerConnection\r\n  };\r\n\r\n  },{}],10:[function(require,module,exports){\r\n  /*\r\n   *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\r\n   *\r\n   *  Use of this source code is governed by a BSD-style license\r\n   *  that can be found in the LICENSE file in the root of the source\r\n   *  tree.\r\n   */\r\n   /* eslint-env node */\r\n  'use strict';\r\n\r\n  var logDisabled_ = true;\r\n\r\n  // Utility methods.\r\n  var utils = {\r\n    disableLog: function(bool) {\r\n      if (typeof bool !== 'boolean') {\r\n        return new Error('Argument type: ' + typeof bool +\r\n            '. Please use a boolean.');\r\n      }\r\n      logDisabled_ = bool;\r\n      return (bool) ? 'adapter.js logging disabled' :\r\n          'adapter.js logging enabled';\r\n    },\r\n\r\n    log: function() {\r\n      if (typeof window === 'object') {\r\n        if (logDisabled_) {\r\n          return;\r\n        }\r\n        if (typeof console !== 'undefined' && typeof console.log === 'function') {\r\n          console.log.apply(console, arguments);\r\n        }\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Extract browser version out of the provided user agent string.\r\n     *\r\n     * @param {!string} uastring userAgent string.\r\n     * @param {!string} expr Regular expression used as match criteria.\r\n     * @param {!number} pos position in the version string to be returned.\r\n     * @return {!number} browser version.\r\n     */\r\n    extractVersion: function(uastring, expr, pos) {\r\n      var match = uastring.match(expr);\r\n      return match && match.length >= pos && parseInt(match[pos], 10);\r\n    },\r\n\r\n    /**\r\n     * Browser detector.\r\n     *\r\n     * @return {object} result containing browser and version\r\n     *     properties.\r\n     */\r\n    detectBrowser: function() {\r\n      // Returned result object.\r\n      var result = {};\r\n      result.browser = null;\r\n      result.version = null;\r\n\r\n      // Fail early if it's not a browser\r\n      if (typeof window === 'undefined' || !window.navigator) {\r\n        result.browser = 'Not a browser.';\r\n        return result;\r\n      }\r\n\r\n      // Firefox.\r\n      if (navigator.mozGetUserMedia) {\r\n        result.browser = 'firefox';\r\n        result.version = this.extractVersion(navigator.userAgent,\r\n            /Firefox\\/([0-9]+)\\./, 1);\r\n\r\n      // all webkit-based browsers\r\n      } else if (navigator.webkitGetUserMedia) {\r\n        // Chrome, Chromium, Webview, Opera, all use the chrome shim for now\r\n        if (window.webkitRTCPeerConnection) {\r\n          result.browser = 'chrome';\r\n          result.version = this.extractVersion(navigator.userAgent,\r\n            /Chrom(e|ium)\\/([0-9]+)\\./, 2);\r\n\r\n        // Safari or unknown webkit-based\r\n        // for the time being Safari has support for MediaStreams but not webRTC\r\n        } else {\r\n          // Safari UA substrings of interest for reference:\r\n          // - webkit version:           AppleWebKit/602.1.25 (also used in Op,Cr)\r\n          // - safari UI version:        Version/9.0.3 (unique to Safari)\r\n          // - safari UI webkit version: Safari/601.4.4 (also used in Op,Cr)\r\n          //\r\n          // if the webkit version and safari UI webkit versions are equals,\r\n          // ... this is a stable version.\r\n          //\r\n          // only the internal webkit version is important today to know if\r\n          // media streams are supported\r\n          //\r\n          if (navigator.userAgent.match(/Version\\/(\\d+).(\\d+)/)) {\r\n            result.browser = 'safari';\r\n            result.version = this.extractVersion(navigator.userAgent,\r\n              /AppleWebKit\\/([0-9]+)\\./, 1);\r\n\r\n          // unknown webkit-based browser\r\n          } else {\r\n            result.browser = 'Unsupported webkit-based browser ' +\r\n                'with GUM support but no WebRTC support.';\r\n            return result;\r\n          }\r\n        }\r\n\r\n      // Edge.\r\n      } else if (navigator.mediaDevices &&\r\n          navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/)) {\r\n        result.browser = 'edge';\r\n        result.version = this.extractVersion(navigator.userAgent,\r\n            /Edge\\/(\\d+).(\\d+)$/, 2);\r\n\r\n      // Default fallthrough: not supported.\r\n      } else {\r\n        result.browser = 'Not a supported browser.';\r\n        return result;\r\n      }\r\n\r\n      return result;\r\n    }\r\n  };\r\n\r\n  // Export.\r\n  module.exports = {\r\n    log: utils.log,\r\n    disableLog: utils.disableLog,\r\n    browserDetails: utils.detectBrowser(),\r\n    extractVersion: utils.extractVersion\r\n  };\r\n\r\n  },{}]},{},[2])(2)\r\n});\r\n/* jshint ignore:end */\r\n\r\n  // END OF INJECTION OF GOOGLE'S ADAPTER.JS CONTENT\r\n  ///////////////////////////////////////////////////////////////////\r\n\r\n  AdapterJS.parseWebrtcDetectedBrowser();\r\n\r\n  ///////////////////////////////////////////////////////////////////\r\n  // EXTENSION FOR CHROME, FIREFOX AND EDGE\r\n  // Includes legacy functions\r\n  // -- createIceServer\r\n  // -- createIceServers\r\n  // -- MediaStreamTrack.getSources\r\n  //\r\n  // and additional shims\r\n  // -- attachMediaStream\r\n  // -- reattachMediaStream\r\n  // -- requestUserMedia\r\n  // -- a call to AdapterJS.maybeThroughWebRTCReady (notifies WebRTC is ready)\r\n\r\n  // Add support for legacy functions createIceServer and createIceServers\r\n  if ( navigator.mozGetUserMedia ) {\r\n    // Shim for MediaStreamTrack.getSources.\r\n    MediaStreamTrack.getSources = function(successCb) {\r\n      setTimeout(function() {\r\n        var infos = [\r\n          { kind: 'audio', id: 'default', label:'', facing:'' },\r\n          { kind: 'video', id: 'default', label:'', facing:'' }\r\n        ];\r\n        successCb(infos);\r\n      }, 0);\r\n    };\r\n\r\n    // Attach a media stream to an element.\r\n    attachMediaStream = function(element, stream) {\r\n      element.srcObject = stream;\r\n      return element;\r\n    };\r\n\r\n    reattachMediaStream = function(to, from) {\r\n      to.srcObject = from.srcObject;\r\n      return to;\r\n    };\r\n\r\n    createIceServer = function (url, username, password) {\r\n      console.warn('createIceServer is deprecated. It should be replaced with an application level implementation.');\r\n      // Note: Google's import of AJS will auto-reverse to 'url': '...' for FF < 38\r\n\r\n      var iceServer = null;\r\n      var urlParts = url.split(':');\r\n      if (urlParts[0].indexOf('stun') === 0) {\r\n        iceServer = { urls : [url] };\r\n      } else if (urlParts[0].indexOf('turn') === 0) {\r\n        if (webrtcDetectedVersion < 27) {\r\n          var turnUrlParts = url.split('?');\r\n          if (turnUrlParts.length === 1 ||\r\n            turnUrlParts[1].indexOf('transport=udp') === 0) {\r\n            iceServer = {\r\n              urls : [turnUrlParts[0]],\r\n              credential : password,\r\n              username : username\r\n            };\r\n          }\r\n        } else {\r\n          iceServer = {\r\n            urls : [url],\r\n            credential : password,\r\n            username : username\r\n          };\r\n        }\r\n      }\r\n      return iceServer;\r\n    };\r\n\r\n    createIceServers = function (urls, username, password) {\r\n      console.warn('createIceServers is deprecated. It should be replaced with an application level implementation.');\r\n\r\n      var iceServers = [];\r\n      for (i = 0; i < urls.length; i++) {\r\n        var iceServer = createIceServer(urls[i], username, password);\r\n        if (iceServer !== null) {\r\n          iceServers.push(iceServer);\r\n        }\r\n      }\r\n      return iceServers;\r\n    };\r\n  } else if ( navigator.webkitGetUserMedia ) {\r\n    // Attach a media stream to an element.\r\n    attachMediaStream = function(element, stream) {\r\n      if (webrtcDetectedVersion >= 43) {\r\n        element.srcObject = stream;\r\n      } else if (typeof element.src !== 'undefined') {\r\n        element.src = URL.createObjectURL(stream);\r\n      } else {\r\n        console.error('Error attaching stream to element.');\r\n        // logging('Error attaching stream to element.');\r\n      }\r\n      return element;\r\n    };\r\n\r\n    reattachMediaStream = function(to, from) {\r\n      if (webrtcDetectedVersion >= 43) {\r\n        to.srcObject = from.srcObject;\r\n      } else {\r\n        to.src = from.src;\r\n      }\r\n      return to;\r\n    };\r\n\r\n    createIceServer = function (url, username, password) {\r\n      console.warn('createIceServer is deprecated. It should be replaced with an application level implementation.');\r\n\r\n      var iceServer = null;\r\n      var urlParts = url.split(':');\r\n      if (urlParts[0].indexOf('stun') === 0) {\r\n        iceServer = { 'url' : url };\r\n      } else if (urlParts[0].indexOf('turn') === 0) {\r\n        iceServer = {\r\n          'url' : url,\r\n          'credential' : password,\r\n          'username' : username\r\n        };\r\n      }\r\n      return iceServer;\r\n    };\r\n\r\n    createIceServers = function (urls, username, password) {\r\n      console.warn('createIceServers is deprecated. It should be replaced with an application level implementation.');\r\n\r\n      var iceServers = [];\r\n      if (webrtcDetectedVersion >= 34) {\r\n        iceServers = {\r\n          'urls' : urls,\r\n          'credential' : password,\r\n          'username' : username\r\n        };\r\n      } else {\r\n        for (i = 0; i < urls.length; i++) {\r\n          var iceServer = createIceServer(urls[i], username, password);\r\n          if (iceServer !== null) {\r\n            iceServers.push(iceServer);\r\n          }\r\n        }\r\n      }\r\n      return iceServers;\r\n    };\r\n  } else if (navigator.mediaDevices && navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/)) {\r\n    // Attach a media stream to an element.\r\n    attachMediaStream = function(element, stream) {\r\n      element.srcObject = stream;\r\n      return element;\r\n    };\r\n\r\n    reattachMediaStream = function(to, from) {\r\n      to.srcObject = from.srcObject;\r\n      return to;\r\n    };\r\n  }\r\n\r\n  // Need to override attachMediaStream and reattachMediaStream\r\n  // to support the plugin's logic\r\n  attachMediaStream_base = attachMediaStream;\r\n\r\n  if (webrtcDetectedBrowser === 'opera') {\r\n    attachMediaStream_base = function (element, stream) {\r\n      if (webrtcDetectedVersion > 38) {\r\n        element.srcObject = stream;\r\n      } else if (typeof element.src !== 'undefined') {\r\n        element.src = URL.createObjectURL(stream);\r\n      }\r\n      // Else it doesn't work\r\n    };\r\n  }\r\n\r\n  attachMediaStream = function (element, stream) {\r\n    if ((webrtcDetectedBrowser === 'chrome' ||\r\n         webrtcDetectedBrowser === 'opera') &&\r\n        !stream) {\r\n      // Chrome does not support \"src = null\"\r\n      element.src = '';\r\n    } else {\r\n      attachMediaStream_base(element, stream);\r\n    }\r\n    return element;\r\n  };\r\n  reattachMediaStream_base = reattachMediaStream;\r\n  reattachMediaStream = function (to, from) {\r\n    reattachMediaStream_base(to, from);\r\n    return to;\r\n  };\r\n\r\n  // Propagate attachMediaStream and gUM in window and AdapterJS\r\n  window.attachMediaStream      = attachMediaStream;\r\n  window.reattachMediaStream    = reattachMediaStream;\r\n  window.getUserMedia           = function(constraints, onSuccess, onFailure) {\r\n    navigator.getUserMedia(constraints, onSuccess, onFailure);\r\n  };\r\n  AdapterJS.attachMediaStream   = attachMediaStream;\r\n  AdapterJS.reattachMediaStream = reattachMediaStream;\r\n  AdapterJS.getUserMedia        = getUserMedia;\r\n\r\n  // Removed Google defined promises when promise is not defined\r\n  if (typeof Promise === 'undefined') {\r\n    requestUserMedia = null;\r\n  }\r\n\r\n  AdapterJS.maybeThroughWebRTCReady();\r\n\r\n  // END OF EXTENSION OF CHROME, FIREFOX AND EDGE\r\n  ///////////////////////////////////////////////////////////////////\r\n\r\n} else { // TRY TO USE PLUGIN\r\n\r\n  ///////////////////////////////////////////////////////////////////\r\n  // WEBRTC PLUGIN SHIM\r\n  // Will automatically check if the plugin is available and inject it\r\n  // into the DOM if it is.\r\n  // When the plugin is not available, will prompt a banner to suggest installing it\r\n  // Use AdapterJS.options.hidePluginInstallPrompt to prevent this banner from popping\r\n  //\r\n  // Shims the follwing:\r\n  // -- getUserMedia\r\n  // -- MediaStreamTrack\r\n  // -- MediaStreamTrack.getSources\r\n  // -- RTCPeerConnection\r\n  // -- RTCSessionDescription\r\n  // -- RTCIceCandidate\r\n  // -- createIceServer\r\n  // -- createIceServers\r\n  // -- attachMediaStream\r\n  // -- reattachMediaStream\r\n  // -- webrtcDetectedBrowser\r\n  // -- webrtcDetectedVersion\r\n\r\n  // IE 9 is not offering an implementation of console.log until you open a console\r\n  if (typeof console !== 'object' || typeof console.log !== 'function') {\r\n    /* jshint -W020 */\r\n    console = {} || console;\r\n    // Implemented based on console specs from MDN\r\n    // You may override these functions\r\n    console.log = function (arg) {};\r\n    console.info = function (arg) {};\r\n    console.error = function (arg) {};\r\n    console.dir = function (arg) {};\r\n    console.exception = function (arg) {};\r\n    console.trace = function (arg) {};\r\n    console.warn = function (arg) {};\r\n    console.count = function (arg) {};\r\n    console.debug = function (arg) {};\r\n    console.count = function (arg) {};\r\n    console.time = function (arg) {};\r\n    console.timeEnd = function (arg) {};\r\n    console.group = function (arg) {};\r\n    console.groupCollapsed = function (arg) {};\r\n    console.groupEnd = function (arg) {};\r\n    /* jshint +W020 */\r\n  }\r\n  AdapterJS.parseWebrtcDetectedBrowser();\r\n  isIE = webrtcDetectedBrowser === 'IE';\r\n\r\n  /* jshint -W035 */\r\n  AdapterJS.WebRTCPlugin.WaitForPluginReady = function() {\r\n    while (AdapterJS.WebRTCPlugin.pluginState !== AdapterJS.WebRTCPlugin.PLUGIN_STATES.READY) {\r\n      /* empty because it needs to prevent the function from running. */\r\n    }\r\n  };\r\n  /* jshint +W035 */\r\n\r\n  AdapterJS.WebRTCPlugin.callWhenPluginReady = function (callback) {\r\n    if (AdapterJS.WebRTCPlugin.pluginState === AdapterJS.WebRTCPlugin.PLUGIN_STATES.READY) {\r\n      // Call immediately if possible\r\n      // Once the plugin is set, the code will always take this path\r\n      callback();\r\n    } else {\r\n      // otherwise start a 100ms interval\r\n      var checkPluginReadyState = setInterval(function () {\r\n        if (AdapterJS.WebRTCPlugin.pluginState === AdapterJS.WebRTCPlugin.PLUGIN_STATES.READY) {\r\n          clearInterval(checkPluginReadyState);\r\n          callback();\r\n        }\r\n      }, 100);\r\n    }\r\n  };\r\n\r\n  AdapterJS.WebRTCPlugin.setLogLevel = function(logLevel) {\r\n    AdapterJS.WebRTCPlugin.callWhenPluginReady(function() {\r\n      AdapterJS.WebRTCPlugin.plugin.setLogLevel(logLevel);\r\n    });\r\n  };\r\n\r\n  AdapterJS.WebRTCPlugin.injectPlugin = function () {\r\n    // only inject once the page is ready\r\n    if (document.readyState !== 'complete') {\r\n      return;\r\n    }\r\n\r\n    // Prevent multiple injections\r\n    if (AdapterJS.WebRTCPlugin.pluginState !== AdapterJS.WebRTCPlugin.PLUGIN_STATES.INITIALIZING) {\r\n      return;\r\n    }\r\n\r\n    AdapterJS.WebRTCPlugin.pluginState = AdapterJS.WebRTCPlugin.PLUGIN_STATES.INJECTING;\r\n\r\n    if (webrtcDetectedBrowser === 'IE' && webrtcDetectedVersion <= 10) {\r\n      var frag = document.createDocumentFragment();\r\n      AdapterJS.WebRTCPlugin.plugin = document.createElement('div');\r\n      AdapterJS.WebRTCPlugin.plugin.innerHTML = '<object id=\"' +\r\n        AdapterJS.WebRTCPlugin.pluginInfo.pluginId + '\" type=\"' +\r\n        AdapterJS.WebRTCPlugin.pluginInfo.type + '\" ' + 'width=\"1\" height=\"1\">' +\r\n        '<param name=\"pluginId\" value=\"' +\r\n        AdapterJS.WebRTCPlugin.pluginInfo.pluginId + '\" /> ' +\r\n        '<param name=\"windowless\" value=\"false\" /> ' +\r\n        '<param name=\"pageId\" value=\"' + AdapterJS.WebRTCPlugin.pageId + '\" /> ' +\r\n        '<param name=\"onload\" value=\"' + AdapterJS.WebRTCPlugin.pluginInfo.onload + '\" />' +\r\n        '<param name=\"tag\" value=\"' + AdapterJS.WebRTCPlugin.TAGS.NONE + '\" />' +\r\n        // uncomment to be able to use virtual cams\r\n        (AdapterJS.options.getAllCams ? '<param name=\"forceGetAllCams\" value=\"True\" />':'') +\r\n\r\n        '</object>';\r\n      while (AdapterJS.WebRTCPlugin.plugin.firstChild) {\r\n        frag.appendChild(AdapterJS.WebRTCPlugin.plugin.firstChild);\r\n      }\r\n      document.body.appendChild(frag);\r\n\r\n      // Need to re-fetch the plugin\r\n      AdapterJS.WebRTCPlugin.plugin =\r\n        document.getElementById(AdapterJS.WebRTCPlugin.pluginInfo.pluginId);\r\n    } else {\r\n      // Load Plugin\r\n      AdapterJS.WebRTCPlugin.plugin = document.createElement('object');\r\n      AdapterJS.WebRTCPlugin.plugin.id =\r\n        AdapterJS.WebRTCPlugin.pluginInfo.pluginId;\r\n      // IE will only start the plugin if it's ACTUALLY visible\r\n      if (isIE) {\r\n        AdapterJS.WebRTCPlugin.plugin.width = '1px';\r\n        AdapterJS.WebRTCPlugin.plugin.height = '1px';\r\n      } else { // The size of the plugin on Safari should be 0x0px\r\n              // so that the autorisation prompt is at the top\r\n        AdapterJS.WebRTCPlugin.plugin.width = '0px';\r\n        AdapterJS.WebRTCPlugin.plugin.height = '0px';\r\n      }\r\n      AdapterJS.WebRTCPlugin.plugin.type = AdapterJS.WebRTCPlugin.pluginInfo.type;\r\n      AdapterJS.WebRTCPlugin.plugin.innerHTML = '<param name=\"onload\" value=\"' +\r\n        AdapterJS.WebRTCPlugin.pluginInfo.onload + '\">' +\r\n        '<param name=\"pluginId\" value=\"' +\r\n        AdapterJS.WebRTCPlugin.pluginInfo.pluginId + '\">' +\r\n        '<param name=\"windowless\" value=\"false\" /> ' +\r\n        (AdapterJS.options.getAllCams ? '<param name=\"forceGetAllCams\" value=\"True\" />':'') +\r\n        '<param name=\"pageId\" value=\"' + AdapterJS.WebRTCPlugin.pageId + '\">' +\r\n        '<param name=\"tag\" value=\"' + AdapterJS.WebRTCPlugin.TAGS.NONE + '\" />';\r\n      document.body.appendChild(AdapterJS.WebRTCPlugin.plugin);\r\n    }\r\n\r\n\r\n    AdapterJS.WebRTCPlugin.pluginState = AdapterJS.WebRTCPlugin.PLUGIN_STATES.INJECTED;\r\n  };\r\n\r\n  AdapterJS.WebRTCPlugin.isPluginInstalled =\r\n    function (comName, plugName, plugType, installedCb, notInstalledCb) {\r\n    if (!isIE) {\r\n      var pluginArray = navigator.mimeTypes;\r\n      for (var i = 0; i < pluginArray.length; i++) {\r\n        if (pluginArray[i].type.indexOf(plugType) >= 0) {\r\n          installedCb();\r\n          return;\r\n        }\r\n      }\r\n      notInstalledCb();\r\n    } else {\r\n      try {\r\n        var axo = new ActiveXObject(comName + '.' + plugName);\r\n      } catch (e) {\r\n        notInstalledCb();\r\n        return;\r\n      }\r\n      installedCb();\r\n    }\r\n  };\r\n\r\n  AdapterJS.WebRTCPlugin.defineWebRTCInterface = function () {\r\n    if (AdapterJS.WebRTCPlugin.pluginState ===\r\n        AdapterJS.WebRTCPlugin.PLUGIN_STATES.READY) {\r\n      console.error('AdapterJS - WebRTC interface has already been defined');\r\n      return;\r\n    }\r\n\r\n    AdapterJS.WebRTCPlugin.pluginState = AdapterJS.WebRTCPlugin.PLUGIN_STATES.INITIALIZING;\r\n\r\n    AdapterJS.isDefined = function (variable) {\r\n      return variable !== null && variable !== undefined;\r\n    };\r\n\r\n    createIceServer = function (url, username, password) {\r\n      var iceServer = null;\r\n      var urlParts = url.split(':');\r\n      if (urlParts[0].indexOf('stun') === 0) {\r\n        iceServer = {\r\n          'url' : url,\r\n          'hasCredentials' : false\r\n        };\r\n      } else if (urlParts[0].indexOf('turn') === 0) {\r\n        iceServer = {\r\n          'url' : url,\r\n          'hasCredentials' : true,\r\n          'credential' : password,\r\n          'username' : username\r\n        };\r\n      }\r\n      return iceServer;\r\n    };\r\n\r\n    createIceServers = function (urls, username, password) {\r\n      var iceServers = [];\r\n      for (var i = 0; i < urls.length; ++i) {\r\n        iceServers.push(createIceServer(urls[i], username, password));\r\n      }\r\n      return iceServers;\r\n    };\r\n\r\n    RTCSessionDescription = function (info) {\r\n      AdapterJS.WebRTCPlugin.WaitForPluginReady();\r\n      return AdapterJS.WebRTCPlugin.plugin.\r\n        ConstructSessionDescription(info.type, info.sdp);\r\n    };\r\n\r\n    RTCPeerConnection = function (servers, constraints) {\r\n      // Validate server argumenr\r\n      if (!(servers === undefined ||\r\n            servers === null ||\r\n            Array.isArray(servers.iceServers))) {\r\n        throw new Error('Failed to construct \\'RTCPeerConnection\\': Malformed RTCConfiguration');\r\n      }\r\n\r\n      // Validate constraints argument\r\n      if (typeof constraints !== 'undefined' && constraints !== null) {\r\n        var invalidConstraits = false;\r\n        invalidConstraits |= typeof constraints !== 'object';\r\n        invalidConstraits |= constraints.hasOwnProperty('mandatory') &&\r\n                              constraints.mandatory !== undefined &&\r\n                              constraints.mandatory !== null &&\r\n                              constraints.mandatory.constructor !== Object;\r\n        invalidConstraits |= constraints.hasOwnProperty('optional') &&\r\n                              constraints.optional !== undefined &&\r\n                              constraints.optional !== null &&\r\n                              !Array.isArray(constraints.optional);\r\n        if (invalidConstraits) {\r\n          throw new Error('Failed to construct \\'RTCPeerConnection\\': Malformed constraints object');\r\n        }\r\n      }\r\n\r\n      // Call relevant PeerConnection constructor according to plugin version\r\n      AdapterJS.WebRTCPlugin.WaitForPluginReady();\r\n\r\n      // RTCPeerConnection prototype from the old spec\r\n      var iceServers = null;\r\n      if (servers && Array.isArray(servers.iceServers)) {\r\n        iceServers = servers.iceServers;\r\n        for (var i = 0; i < iceServers.length; i++) {\r\n          // Legacy plugin versions compatibility\r\n          if (iceServers[i].urls && !iceServers[i].url) {\r\n            iceServers[i].url = iceServers[i].urls;\r\n          }\r\n          iceServers[i].hasCredentials = AdapterJS.\r\n            isDefined(iceServers[i].username) &&\r\n            AdapterJS.isDefined(iceServers[i].credential);\r\n        }\r\n      }\r\n\r\n      if (AdapterJS.WebRTCPlugin.plugin.PEER_CONNECTION_VERSION &&\r\n          AdapterJS.WebRTCPlugin.plugin.PEER_CONNECTION_VERSION > 1) {\r\n        // RTCPeerConnection prototype from the new spec\r\n        if (iceServers) {\r\n          servers.iceServers = iceServers;\r\n        }\r\n        return AdapterJS.WebRTCPlugin.plugin.PeerConnection(servers);\r\n      } else {\r\n        var mandatory = (constraints && constraints.mandatory) ?\r\n          constraints.mandatory : null;\r\n        var optional = (constraints && constraints.optional) ?\r\n          constraints.optional : null;\r\n        return AdapterJS.WebRTCPlugin.plugin.\r\n          PeerConnection(AdapterJS.WebRTCPlugin.pageId,\r\n          iceServers, mandatory, optional);\r\n      }\r\n    };\r\n\r\n    MediaStreamTrack = function(){};\r\n    MediaStreamTrack.getSources = function (callback) {\r\n      AdapterJS.WebRTCPlugin.callWhenPluginReady(function() {\r\n        AdapterJS.WebRTCPlugin.plugin.GetSources(callback);\r\n      });\r\n    };\r\n\r\n    // getUserMedia constraints shim.\r\n    // Copied from Chrome\r\n    var constraintsToPlugin = function(c) {\r\n      if (typeof c !== 'object' || c.mandatory || c.optional) {\r\n        return c;\r\n      }\r\n      var cc = {};\r\n      Object.keys(c).forEach(function(key) {\r\n        if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\r\n          return;\r\n        }\r\n        var r = (typeof c[key] === 'object') ? c[key] : {ideal: c[key]};\r\n        if (r.exact !== undefined && typeof r.exact === 'number') {\r\n          r.min = r.max = r.exact;\r\n        }\r\n        var oldname = function(prefix, name) {\r\n          if (prefix) {\r\n            return prefix + name.charAt(0).toUpperCase() + name.slice(1);\r\n          }\r\n          return (name === 'deviceId') ? 'sourceId' : name;\r\n        };\r\n        if (r.ideal !== undefined) {\r\n          cc.optional = cc.optional || [];\r\n          var oc = {};\r\n          if (typeof r.ideal === 'number') {\r\n            oc[oldname('min', key)] = r.ideal;\r\n            cc.optional.push(oc);\r\n            oc = {};\r\n            oc[oldname('max', key)] = r.ideal;\r\n            cc.optional.push(oc);\r\n          } else {\r\n            oc[oldname('', key)] = r.ideal;\r\n            cc.optional.push(oc);\r\n          }\r\n        }\r\n        if (r.exact !== undefined && typeof r.exact !== 'number') {\r\n          cc.mandatory = cc.mandatory || {};\r\n          cc.mandatory[oldname('', key)] = r.exact;\r\n        } else {\r\n          ['min', 'max'].forEach(function(mix) {\r\n            if (r[mix] !== undefined) {\r\n              cc.mandatory = cc.mandatory || {};\r\n              cc.mandatory[oldname(mix, key)] = r[mix];\r\n            }\r\n          });\r\n        }\r\n      });\r\n      if (c.advanced) {\r\n        cc.optional = (cc.optional || []).concat(c.advanced);\r\n      }\r\n      return cc;\r\n    };\r\n\r\n    getUserMedia = function (constraints, successCallback, failureCallback) {\r\n      var cc = {};\r\n      cc.audio = constraints.audio ?\r\n        constraintsToPlugin(constraints.audio) : false;\r\n      cc.video = constraints.video ?\r\n        constraintsToPlugin(constraints.video) : false;\r\n\r\n      AdapterJS.WebRTCPlugin.callWhenPluginReady(function() {\r\n        AdapterJS.WebRTCPlugin.plugin.\r\n          getUserMedia(cc, successCallback, failureCallback);\r\n      });\r\n    };\r\n    window.navigator.getUserMedia = getUserMedia;\r\n\r\n    // Defined mediaDevices when promises are available\r\n    if ( !navigator.mediaDevices &&\r\n      typeof Promise !== 'undefined') {\r\n      requestUserMedia = function(constraints) {\r\n        return new Promise(function(resolve, reject) {\r\n          getUserMedia(constraints, resolve, reject);\r\n        });\r\n      };\r\n      navigator.mediaDevices = {getUserMedia: requestUserMedia,\r\n                                enumerateDevices: function() {\r\n        return new Promise(function(resolve) {\r\n          var kinds = {audio: 'audioinput', video: 'videoinput'};\r\n          return MediaStreamTrack.getSources(function(devices) {\r\n            resolve(devices.map(function(device) {\r\n              return {label: device.label,\r\n                      kind: kinds[device.kind],\r\n                      id: device.id,\r\n                      deviceId: device.id,\r\n                      groupId: ''};\r\n            }));\r\n          });\r\n        });\r\n      }};\r\n    }\r\n\r\n    attachMediaStream = function (element, stream) {\r\n      if (!element || !element.parentNode) {\r\n        return;\r\n      }\r\n\r\n      var streamId;\r\n      if (stream === null) {\r\n        streamId = '';\r\n      } else {\r\n        if (typeof stream.enableSoundTracks !== 'undefined') {\r\n          stream.enableSoundTracks(true);\r\n        }\r\n        streamId = stream.id;\r\n      }\r\n\r\n      var elementId = element.id.length === 0 ? Math.random().toString(36).slice(2) : element.id;\r\n      var nodeName = element.nodeName.toLowerCase();\r\n      if (nodeName !== 'object') { // not a plugin <object> tag yet\r\n        var tag;\r\n        switch(nodeName) {\r\n          case 'audio':\r\n            tag = AdapterJS.WebRTCPlugin.TAGS.AUDIO;\r\n            break;\r\n          case 'video':\r\n            tag = AdapterJS.WebRTCPlugin.TAGS.VIDEO;\r\n            break;\r\n          default:\r\n            tag = AdapterJS.WebRTCPlugin.TAGS.NONE;\r\n          }\r\n\r\n        var frag = document.createDocumentFragment();\r\n        var temp = document.createElement('div');\r\n        var classHTML = '';\r\n        if (element.className) {\r\n          classHTML = 'class=\"' + element.className + '\" ';\r\n        } else if (element.attributes && element.attributes['class']) {\r\n          classHTML = 'class=\"' + element.attributes['class'].value + '\" ';\r\n        }\r\n\r\n        temp.innerHTML = '<object id=\"' + elementId + '\" ' + classHTML +\r\n          'type=\"' + AdapterJS.WebRTCPlugin.pluginInfo.type + '\">' +\r\n          '<param name=\"pluginId\" value=\"' + elementId + '\" /> ' +\r\n          '<param name=\"pageId\" value=\"' + AdapterJS.WebRTCPlugin.pageId + '\" /> ' +\r\n          '<param name=\"windowless\" value=\"true\" /> ' +\r\n          '<param name=\"streamId\" value=\"' + streamId + '\" /> ' +\r\n          '<param name=\"tag\" value=\"' + tag + '\" /> ' +\r\n          '</object>';\r\n        while (temp.firstChild) {\r\n          frag.appendChild(temp.firstChild);\r\n        }\r\n\r\n        var height = '';\r\n        var width = '';\r\n        if (element.clientWidth || element.clientHeight) {\r\n          width = element.clientWidth;\r\n          height = element.clientHeight;\r\n        }\r\n        else if (element.width || element.height) {\r\n          width = element.width;\r\n          height = element.height;\r\n        }\r\n\r\n        element.parentNode.insertBefore(frag, element);\r\n        frag = document.getElementById(elementId);\r\n        frag.width = width;\r\n        frag.height = height;\r\n        element.parentNode.removeChild(element);\r\n      } else { // already an <object> tag, just change the stream id\r\n        var children = element.children;\r\n        for (var i = 0; i !== children.length; ++i) {\r\n          if (children[i].name === 'streamId') {\r\n            children[i].value = streamId;\r\n            break;\r\n          }\r\n        }\r\n        element.setStreamId(streamId);\r\n      }\r\n      var newElement = document.getElementById(elementId);\r\n      AdapterJS.forwardEventHandlers(newElement, element, Object.getPrototypeOf(element));\r\n\r\n      return newElement;\r\n    };\r\n\r\n    reattachMediaStream = function (to, from) {\r\n      var stream = null;\r\n      var children = from.children;\r\n      for (var i = 0; i !== children.length; ++i) {\r\n        if (children[i].name === 'streamId') {\r\n          AdapterJS.WebRTCPlugin.WaitForPluginReady();\r\n          stream = AdapterJS.WebRTCPlugin.plugin\r\n            .getStreamWithId(AdapterJS.WebRTCPlugin.pageId, children[i].value);\r\n          break;\r\n        }\r\n      }\r\n      if (stream !== null) {\r\n        return attachMediaStream(to, stream);\r\n      } else {\r\n        console.log('Could not find the stream associated with this element');\r\n      }\r\n    };\r\n\r\n    // Propagate attachMediaStream and gUM in window and AdapterJS\r\n    window.attachMediaStream      = attachMediaStream;\r\n    window.reattachMediaStream    = reattachMediaStream;\r\n    window.getUserMedia           = getUserMedia;\r\n    AdapterJS.attachMediaStream   = attachMediaStream;\r\n    AdapterJS.reattachMediaStream = reattachMediaStream;\r\n    AdapterJS.getUserMedia        = getUserMedia;\r\n\r\n    AdapterJS.forwardEventHandlers = function (destElem, srcElem, prototype) {\r\n      properties = Object.getOwnPropertyNames( prototype );\r\n      for(var prop in properties) {\r\n        if (prop) {\r\n          propName = properties[prop];\r\n\r\n          if (typeof propName.slice === 'function' &&\r\n              propName.slice(0,2) === 'on' &&\r\n              typeof srcElem[propName] === 'function') {\r\n              AdapterJS.addEvent(destElem, propName.slice(2), srcElem[propName]);\r\n          }\r\n        }\r\n      }\r\n      var subPrototype = Object.getPrototypeOf(prototype);\r\n      if(!!subPrototype) {\r\n        AdapterJS.forwardEventHandlers(destElem, srcElem, subPrototype);\r\n      }\r\n    };\r\n\r\n    RTCIceCandidate = function (candidate) {\r\n      if (!candidate.sdpMid) {\r\n        candidate.sdpMid = '';\r\n      }\r\n\r\n      AdapterJS.WebRTCPlugin.WaitForPluginReady();\r\n      return AdapterJS.WebRTCPlugin.plugin.ConstructIceCandidate(\r\n        candidate.sdpMid, candidate.sdpMLineIndex, candidate.candidate\r\n      );\r\n    };\r\n\r\n    // inject plugin\r\n    AdapterJS.addEvent(document, 'readystatechange', AdapterJS.WebRTCPlugin.injectPlugin);\r\n    AdapterJS.WebRTCPlugin.injectPlugin();\r\n  };\r\n\r\n  // This function will be called if the plugin is needed (browser different\r\n  // from Chrome or Firefox), but the plugin is not installed.\r\n  AdapterJS.WebRTCPlugin.pluginNeededButNotInstalledCb = AdapterJS.WebRTCPlugin.pluginNeededButNotInstalledCb ||\r\n    function() {\r\n      AdapterJS.addEvent(document,\r\n                        'readystatechange',\r\n                         AdapterJS.WebRTCPlugin.pluginNeededButNotInstalledCbPriv);\r\n      AdapterJS.WebRTCPlugin.pluginNeededButNotInstalledCbPriv();\r\n    };\r\n\r\n  AdapterJS.WebRTCPlugin.pluginNeededButNotInstalledCbPriv = function () {\r\n    if (AdapterJS.options.hidePluginInstallPrompt) {\r\n      return;\r\n    }\r\n\r\n    var downloadLink = AdapterJS.WebRTCPlugin.pluginInfo.downloadLink;\r\n    if(downloadLink) { // if download link\r\n      var popupString;\r\n      if (AdapterJS.WebRTCPlugin.pluginInfo.portalLink) { // is portal link\r\n       popupString = 'This website requires you to install the ' +\r\n        ' <a href=\"' + AdapterJS.WebRTCPlugin.pluginInfo.portalLink +\r\n        '\" target=\"_blank\">' + AdapterJS.WebRTCPlugin.pluginInfo.companyName +\r\n        ' WebRTC Plugin</a>' +\r\n        ' to work on this browser.';\r\n      } else { // no portal link, just print a generic explanation\r\n       popupString = AdapterJS.TEXT.PLUGIN.REQUIRE_INSTALLATION;\r\n      }\r\n\r\n      AdapterJS.renderNotificationBar(popupString, AdapterJS.TEXT.PLUGIN.BUTTON, downloadLink);\r\n    } else { // no download link, just print a generic explanation\r\n      AdapterJS.renderNotificationBar(AdapterJS.TEXT.PLUGIN.NOT_SUPPORTED);\r\n    }\r\n  };\r\n\r\n\r\n  // Try to detect the plugin and act accordingly\r\n  AdapterJS.WebRTCPlugin.isPluginInstalled(\r\n    AdapterJS.WebRTCPlugin.pluginInfo.prefix,\r\n    AdapterJS.WebRTCPlugin.pluginInfo.plugName,\r\n    AdapterJS.WebRTCPlugin.pluginInfo.type,\r\n    AdapterJS.WebRTCPlugin.defineWebRTCInterface,\r\n    AdapterJS.WebRTCPlugin.pluginNeededButNotInstalledCb);\r\n\r\n  // END OF WEBRTC PLUGIN SHIM\r\n  ///////////////////////////////////////////////////////////////////\r\n}\r\n\r\n(function () {\r\n\r\n  'use strict';\r\n\r\n  var baseGetUserMedia = null;\r\n\r\n  AdapterJS.TEXT.EXTENSION = {\r\n    REQUIRE_INSTALLATION_FF: 'To enable screensharing you need to install the Skylink WebRTC tools Firefox Add-on.',\r\n    REQUIRE_INSTALLATION_CHROME: 'To enable screensharing you need to install the Skylink WebRTC tools Chrome Extension.',\r\n    REQUIRE_REFRESH: 'Please refresh this page after the Skylink WebRTC tools extension has been installed.',\r\n    BUTTON_FF: 'Install Now',\r\n    BUTTON_CHROME: 'Go to Chrome Web Store'\r\n  };\r\n\r\n  var clone = function(obj) {\r\n    if (null === obj || 'object' !== typeof obj) {\r\n      return obj;\r\n    }\r\n    var copy = obj.constructor();\r\n    for (var attr in obj) {\r\n      if (obj.hasOwnProperty(attr)) {\r\n        copy[attr] = obj[attr];\r\n      }\r\n    }\r\n    return copy;\r\n  };\r\n\r\n  if (window.navigator.mozGetUserMedia) {\r\n    baseGetUserMedia = window.navigator.getUserMedia;\r\n\r\n    navigator.getUserMedia = function (constraints, successCb, failureCb) {\r\n\r\n      if (constraints && constraints.video && !!constraints.video.mediaSource) {\r\n        // intercepting screensharing requests\r\n\r\n        // Invalid mediaSource for firefox, only \"screen\" and \"window\" are supported\r\n        if (constraints.video.mediaSource !== 'screen' && constraints.video.mediaSource !== 'window') {\r\n          failureCb(new Error('GetUserMedia: Only \"screen\" and \"window\" are supported as mediaSource constraints'));\r\n          return;\r\n        }\r\n\r\n        var updatedConstraints = clone(constraints);\r\n\r\n        //constraints.video.mediaSource = constraints.video.mediaSource;\r\n        updatedConstraints.video.mozMediaSource = updatedConstraints.video.mediaSource;\r\n\r\n        // so generally, it requires for document.readyState to be completed before the getUserMedia could be invoked.\r\n        // strange but this works anyway\r\n        var checkIfReady = setInterval(function () {\r\n          if (document.readyState === 'complete') {\r\n            clearInterval(checkIfReady);\r\n\r\n            baseGetUserMedia(updatedConstraints, successCb, function (error) {\r\n              if (['PermissionDeniedError', 'SecurityError'].indexOf(error.name) > -1 && window.parent.location.protocol === 'https:') {\r\n                AdapterJS.renderNotificationBar(AdapterJS.TEXT.EXTENSION.REQUIRE_INSTALLATION_FF,\r\n                  AdapterJS.TEXT.EXTENSION.BUTTON_FF,\r\n                  'https://addons.mozilla.org/en-US/firefox/addon/skylink-webrtc-tools/', true, true);\r\n              } else {\r\n                failureCb(error);\r\n              }\r\n            });\r\n          }\r\n        }, 1);\r\n\r\n      } else { // regular GetUserMediaRequest\r\n        baseGetUserMedia(constraints, successCb, failureCb);\r\n      }\r\n    };\r\n\r\n    AdapterJS.getUserMedia = window.getUserMedia = navigator.getUserMedia;\r\n    /* Comment out to prevent recursive errors\r\n    navigator.mediaDevices.getUserMedia = function(constraints) {\r\n      return new Promise(function(resolve, reject) {\r\n        window.getUserMedia(constraints, resolve, reject);\r\n      });\r\n    };*/\r\n\r\n  } else if (window.navigator.webkitGetUserMedia && window.webrtcDetectedBrowser !== 'safari') {\r\n    baseGetUserMedia = window.navigator.getUserMedia;\r\n\r\n    navigator.getUserMedia = function (constraints, successCb, failureCb) {\r\n      if (constraints && constraints.video && !!constraints.video.mediaSource) {\r\n        if (window.webrtcDetectedBrowser !== 'chrome') {\r\n          // This is Opera, which does not support screensharing\r\n          failureCb(new Error('Current browser does not support screensharing'));\r\n          return;\r\n        }\r\n\r\n        // would be fine since no methods\r\n        var updatedConstraints = clone(constraints);\r\n\r\n        var chromeCallback = function(error, sourceId) {\r\n          if(!error) {\r\n            updatedConstraints.video.mandatory = updatedConstraints.video.mandatory || {};\r\n            updatedConstraints.video.mandatory.chromeMediaSource = 'desktop';\r\n            updatedConstraints.video.mandatory.maxWidth = window.screen.width > 1920 ? window.screen.width : 1920;\r\n            updatedConstraints.video.mandatory.maxHeight = window.screen.height > 1080 ? window.screen.height : 1080;\r\n\r\n            if (sourceId) {\r\n              updatedConstraints.video.mandatory.chromeMediaSourceId = sourceId;\r\n            }\r\n\r\n            delete updatedConstraints.video.mediaSource;\r\n\r\n            baseGetUserMedia(updatedConstraints, successCb, failureCb);\r\n\r\n          } else { // GUM failed\r\n            if (error === 'permission-denied') {\r\n              failureCb(new Error('Permission denied for screen retrieval'));\r\n            } else {\r\n              // NOTE(J-O): I don't think we ever pass in here.\r\n              // A failure to capture the screen does not lead here.\r\n              failureCb(new Error('Failed retrieving selected screen'));\r\n            }\r\n          }\r\n        };\r\n\r\n        var onIFrameCallback = function (event) {\r\n          if (!event.data) {\r\n            return;\r\n          }\r\n\r\n          if (event.data.chromeMediaSourceId) {\r\n            if (event.data.chromeMediaSourceId === 'PermissionDeniedError') {\r\n                chromeCallback('permission-denied');\r\n            } else {\r\n              chromeCallback(null, event.data.chromeMediaSourceId);\r\n            }\r\n          }\r\n\r\n          if (event.data.chromeExtensionStatus) {\r\n            if (event.data.chromeExtensionStatus === 'not-installed') {\r\n              AdapterJS.renderNotificationBar(AdapterJS.TEXT.EXTENSION.REQUIRE_INSTALLATION_CHROME,\r\n                AdapterJS.TEXT.EXTENSION.BUTTON_CHROME,\r\n                event.data.data, true, true);\r\n            } else {\r\n              chromeCallback(event.data.chromeExtensionStatus, null);\r\n            }\r\n          }\r\n\r\n          // this event listener is no more needed\r\n          window.removeEventListener('message', onIFrameCallback);\r\n        };\r\n\r\n        window.addEventListener('message', onIFrameCallback);\r\n\r\n        postFrameMessage({\r\n          captureSourceId: true\r\n        });\r\n\r\n      } else {\r\n        baseGetUserMedia(constraints, successCb, failureCb);\r\n      }\r\n    };\r\n\r\n    AdapterJS.getUserMedia = window.getUserMedia = navigator.getUserMedia;\r\n    navigator.mediaDevices.getUserMedia = function(constraints) {\r\n      return new Promise(function(resolve, reject) {\r\n        window.getUserMedia(constraints, resolve, reject);\r\n      });\r\n    };\r\n\r\n  } else if (navigator.mediaDevices && navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/)) {\r\n    // nothing here because edge does not support screensharing\r\n    console.warn('Edge does not support screensharing feature in getUserMedia');\r\n\r\n  } else {\r\n    baseGetUserMedia = window.navigator.getUserMedia;\r\n\r\n    navigator.getUserMedia = function (constraints, successCb, failureCb) {\r\n      if (constraints && constraints.video && !!constraints.video.mediaSource) {\r\n        // would be fine since no methods\r\n        var updatedConstraints = clone(constraints);\r\n\r\n        // wait for plugin to be ready\r\n        AdapterJS.WebRTCPlugin.callWhenPluginReady(function() {\r\n          // check if screensharing feature is available\r\n          if (!!AdapterJS.WebRTCPlugin.plugin.HasScreensharingFeature &&\r\n            !!AdapterJS.WebRTCPlugin.plugin.isScreensharingAvailable) {\r\n            // set the constraints\r\n            updatedConstraints.video.optional = updatedConstraints.video.optional || [];\r\n            updatedConstraints.video.optional.push({\r\n              sourceId: AdapterJS.WebRTCPlugin.plugin.screensharingKey || 'Screensharing'\r\n            });\r\n\r\n            delete updatedConstraints.video.mediaSource;\r\n          } else {\r\n            failureCb(new Error('Your version of the WebRTC plugin does not support screensharing'));\r\n            return;\r\n          }\r\n          baseGetUserMedia(updatedConstraints, successCb, failureCb);\r\n        });\r\n      } else {\r\n        baseGetUserMedia(constraints, successCb, failureCb);\r\n      }\r\n    };\r\n\r\n    AdapterJS.getUserMedia = getUserMedia =\r\n       window.getUserMedia = navigator.getUserMedia;\r\n    if ( navigator.mediaDevices &&\r\n      typeof Promise !== 'undefined') {\r\n      navigator.mediaDevices.getUserMedia = typeof requestUserMedia === 'undefined' ? undefined : requestUserMedia;\r\n    }\r\n  }\r\n\r\n  // For chrome, use an iframe to load the screensharing extension\r\n  // in the correct domain.\r\n  // Modify here for custom screensharing extension in chrome\r\n  if (window.webrtcDetectedBrowser === 'chrome') {\r\n    var iframe = document.createElement('iframe');\r\n\r\n    iframe.onload = function() {\r\n      iframe.isLoaded = true;\r\n    };\r\n\r\n    iframe.src = 'https://cdn.temasys.com.sg/skylink/extensions/detectRTC.html';\r\n    iframe.style.display = 'none';\r\n\r\n    (document.body || document.documentElement).appendChild(iframe);\r\n\r\n    var postFrameMessage = function (object) { // jshint ignore:line\r\n      object = object || {};\r\n\r\n      if (!iframe.isLoaded) {\r\n        setTimeout(function () {\r\n          iframe.contentWindow.postMessage(object, '*');\r\n        }, 100);\r\n        return;\r\n      }\r\n\r\n      iframe.contentWindow.postMessage(object, '*');\r\n    };\r\n  } else if (window.webrtcDetectedBrowser === 'opera') {\r\n    console.warn('Opera does not support screensharing feature in getUserMedia');\r\n  }\r\n})();\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/RTC/adapter.screenshare.js","/* Copyright @ 2015 Atlassian Pty Ltd\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\n/**\r\n * Ordered log levels.\r\n */\r\nvar levels = {\r\n    \"trace\": 0,\r\n    \"debug\": 1,\r\n    \"info\": 2,\r\n    \"log\": 3,\r\n    \"warn\": 4,\r\n    \"error\": 5\r\n};\r\n\r\n/**\r\n * The default transport - console\r\n * @type LoggerTransport\r\n */\r\nLogger.consoleTransport = console;\r\n\r\n/**\r\n * The array which stores currently registered global transports.\r\n * @type {[LoggerTransport]}\r\n */\r\nvar globalTransports = [ Logger.consoleTransport ];\r\n\r\n/**\r\n * Adds given {@link LoggerTransport} instance to the list of global\r\n * transports which means that it'll be used by all {@link Logger}s\r\n * @param {LoggerTransport} transport\r\n */\r\nLogger.addGlobalTransport = function(transport) {\r\n    if (globalTransports.indexOf(transport) === -1) {\r\n        globalTransports.push(transport);\r\n    }\r\n};\r\n\r\n/**\r\n * Removes given {@link LoggerTransport} instance from the list of global\r\n * transports\r\n * @param {LoggerTransport} transport\r\n */\r\nLogger.removeGlobalTransport = function(transport) {\r\n    var transportIdx = globalTransports.indexOf(transport);\r\n    if (transportIdx !== -1) {\r\n        globalTransports.splice(transportIdx, 1);\r\n    }\r\n};\r\n\r\n/**\r\n * Parses Error's object stack trace and extracts information about the last\r\n * caller before the log method was called.\r\n * @returns JS object with info about the caller - method name, file location,\r\n * line and column.\r\n */\r\nfunction getCallerInfo() {\r\n    var callerInfo = {\r\n        methodName: \"\",\r\n        fileLocation: \"\",\r\n        line: null,\r\n        column: null\r\n    };\r\n    //gets the part of the stack without the logger wrappers\r\n    var error = new Error();\r\n    var stack = error.stack? error.stack.split(\"\\n\") : [];\r\n    if(!stack || stack.length < 1) {\r\n        return callerInfo;\r\n    }\r\n    var m = null;\r\n    if(stack[3]) {\r\n        m = stack[3].match(/\\s*at\\s*(.+?)\\s*\\((\\S*)\\s*:(\\d*)\\s*:(\\d*)\\)/);\r\n    }\r\n    if(!m || m.length <= 4) {\r\n        //Firefox && Safari\r\n        if(stack[2].indexOf(\"log@\") === 0){\r\n            //Safari\r\n            callerInfo.methodName = stack[3].substr(0, stack[3].indexOf(\"@\"));\r\n        } else {\r\n            //Firefox\r\n            callerInfo.methodName = stack[2].substr(0, stack[2].indexOf(\"@\"));\r\n        }\r\n        return callerInfo;\r\n    }\r\n\r\n    callerInfo.methodName = m[1];\r\n    callerInfo.fileLocation = m[2];\r\n    callerInfo.line = m[3];\r\n    callerInfo.column = m[4];\r\n    return callerInfo;\r\n}\r\n\r\n/**\r\n * Logs messages using the transports and level from the logger.\r\n * @param logger a logger instance.\r\n * @param level the log level of the message. See the levels variable.\r\n * @param arguments array with arguments that will be logged.\r\n */\r\nfunction log() {\r\n    var logger = arguments[0], level = arguments[1],\r\n        args = Array.prototype.slice.call(arguments, 2);\r\n    if(levels[level] < logger.level) {\r\n        return;\r\n    }\r\n\r\n    var callerInfo = getCallerInfo();\r\n    var transports = globalTransports.concat(logger.transports);\r\n    for(var i = 0; i < transports.length; i++) {\r\n        var t = transports[i];\r\n        var l = t[level];\r\n        if(l && typeof(l) === \"function\") {\r\n            l.bind(t, logger.id? \"[\" + logger.id + \"]\" : \"\", \"<\" + callerInfo.methodName + \">: \")\r\n                .apply(t, args);\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n *\r\n * Constructs new logger object.\r\n * @param level the logging level for the new logger\r\n * @param id optional identifier for the logger instance.\r\n * @param {LoggerTransport} transports optional list of handlers(objects) for\r\n * the logs. The handlers must support - log, warn, error, debug, info, trace.\r\n * @param format optional (NOT implemented) string.\r\n */\r\nfunction Logger(level, id, transports, format) {\r\n    this.id = id;\r\n    this.format = format;\r\n    this.transports = transports;\r\n    if(!this.transports) {\r\n        this.transports = [];\r\n    }\r\n    this.level = levels[level];\r\n    var methods = Object.keys(levels);\r\n    for(var i = 0; i < methods.length; i++){\r\n        this[methods[i]] =\r\n            log.bind(null, this, methods[i]);\r\n    }\r\n}\r\n\r\n/**\r\n * Sets the log level for the logger.\r\n * @param level the new log level.\r\n */\r\nLogger.prototype.setLevel = function (level) {\r\n    this.level = levels[level];\r\n};\r\nmodule.exports = Logger;\r\n\r\n/**\r\n * Enum for the supported log levels.\r\n */\r\nLogger.levels = {\r\n    TRACE: \"trace\",\r\n    DEBUG: \"debug\",\r\n    INFO: \"info\",\r\n    LOG: \"log\",\r\n    WARN: \"warn\",\r\n    ERROR: \"error\"\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/jitsi-meet-logger/lib/Logger.js","// TODO: Maybe fix the values to 'Chrome', 'Internet Explorer', etc. Currently\r\n// this values needs to be as they are becuse they are going to analytics,\r\n// callstats, etc.\r\n\r\nexport const CHROME = 'chrome';\r\n\r\nexport const OPERA = 'opera';\r\n\r\nexport const FIREFOX = 'firefox';\r\n\r\nexport const INTERNET_EXPLORER = 'iexplorer';\r\n\r\nexport const EDGE = 'edge';\r\n\r\nexport const SAFARI = 'safari';\r\n\r\nexport const NWJS = 'nwjs';\r\n\r\nexport const ELECTRON = 'electron';\r\n\r\nexport const REACT_NATIVE = 'react-native';\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/browser/browsers.js","var apply = Function.prototype.apply;\n\n// DOM APIs, for completeness\n\nexports.setTimeout = function() {\n  return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);\n};\nexports.setInterval = function() {\n  return new Timeout(apply.call(setInterval, window, arguments), clearInterval);\n};\nexports.clearTimeout =\nexports.clearInterval = function(timeout) {\n  if (timeout) {\n    timeout.close();\n  }\n};\n\nfunction Timeout(id, clearFn) {\n  this._id = id;\n  this._clearFn = clearFn;\n}\nTimeout.prototype.unref = Timeout.prototype.ref = function() {};\nTimeout.prototype.close = function() {\n  this._clearFn.call(window, this._id);\n};\n\n// Does not start the time, just sets up the members needed.\nexports.enroll = function(item, msecs) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = msecs;\n};\n\nexports.unenroll = function(item) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = -1;\n};\n\nexports._unrefActive = exports.active = function(item) {\n  clearTimeout(item._idleTimeoutId);\n\n  var msecs = item._idleTimeout;\n  if (msecs >= 0) {\n    item._idleTimeoutId = setTimeout(function onTimeout() {\n      if (item._onTimeout)\n        item._onTimeout();\n    }, msecs);\n  }\n};\n\n// setimmediate attaches itself to the global object\nrequire(\"setimmediate\");\nexports.setImmediate = setImmediate;\nexports.clearImmediate = clearImmediate;\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/timers-browserify/main.js","/*! precalltest  version = 1.1.5 2018-01-11 */\n\n\"use strict\";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}Object.defineProperty(exports,\"__esModule\",{value:!0});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),Promise=require(\"bluebird\"),TurnTest=function(){function e(t){_classCallCheck(this,e),this.connection=t,this.active=!1,this.results={}}return _createClass(e,[{key:\"getResults\",value:function(){return this.results}},{key:\"start\",value:function(){var e=this,t=new Promise(function(t,n){e.resolveCb=t,e.rejectCb=n});return this.connection.setMessageCallback(this.handleMessage.bind(this)),this.connection.setErrorCallback(this.handleError.bind(this)),this.active=!0,this.forceStopped=!1,this.initiate(),t}},{key:\"stop\",value:function(){this.active=!1}},{key:\"forceStop\",value:function(){this.forceStopped=!0,this.stop(),this.finished()}},{key:\"isActive\",value:function(){return this.active}},{key:\"initiate\",value:function(){}},{key:\"handleMessage\",value:function(e){}},{key:\"handleError\",value:function(e){}},{key:\"send\",value:function(e){this.connection.send(e)}},{key:\"finished\",value:function(){this.active=!1,this.resolveCb&&(this.resolveCb(),this.resolveCb=null)}},{key:\"failed\",value:function(e){this.active=!1,this.rejectCb&&(this.rejectCb(e),this.rejectCb=null)}}]),e}();exports.TurnTest=TurnTest;\n\n\n// WEBPACK FOOTER //\n// ./node_modules/precalltest/dist/tests/turnTest.js","/*! precalltest  version = 1.1.5 2018-01-11 */\n\n\"use strict\";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}function randomAsciiString(e){for(var t=\"\",r=0;r<e;r++)t+=String.fromCharCode(35+58*Math.random());return t}Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.randomAsciiString=exports.MessageMaker=void 0;var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,r,s){return r&&e(t.prototype,r),s&&e(t,s),t}}(),_timestamps=require(\"../utility/timestamps\"),Timestamps=_interopRequireWildcard(_timestamps),MessageMaker=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1200;_classCallCheck(this,e),this.message={timestamp:\"\",sentBytes:1e4,padding:\"\"};var r=randomAsciiString(t-Timestamps.getCurrent().toString().length-JSON.stringify(this.message).length);this.message.padding=r}return _createClass(e,[{key:\"make\",value:function(e){return this.message.timestamp=Timestamps.getCurrent(),this.message.sentBytes=e,JSON.stringify(this.message)}}]),e}();exports.MessageMaker=MessageMaker,exports.randomAsciiString=randomAsciiString;\n\n\n// WEBPACK FOOTER //\n// ./node_modules/precalltest/dist/utility/messageMaker.js","/**\r\n * Provides statistics for the local stream.\r\n */\r\n\r\nimport browser from '../browser';\r\n\r\n/**\r\n * Size of the webaudio analyzer buffer.\r\n * @type {number}\r\n */\r\nconst WEBAUDIO_ANALYZER_FFT_SIZE = 2048;\r\n\r\n/**\r\n * Value of the webaudio analyzer smoothing time parameter.\r\n * @type {number}\r\n */\r\nconst WEBAUDIO_ANALYZER_SMOOTING_TIME = 0.8;\r\n\r\nwindow.AudioContext = window.AudioContext || window.webkitAudioContext;\r\n\r\nlet context = null;\r\n\r\nif (window.AudioContext) {\r\n    context = new AudioContext();\r\n\r\n    // XXX Not all browsers define a suspend method on AudioContext. As the\r\n    // invocation is at the (ES6 module) global execution level, it breaks the\r\n    // loading of the lib-jitsi-meet library in such browsers and, consequently,\r\n    // the loading of the very Web app that uses the lib-jitsi-meet library. For\r\n    // example, Google Chrome 40 on Android does not define the method but we\r\n    // still want to be able to load the lib-jitsi-meet library there and\r\n    // display a page which notifies the user that the Web app is not supported\r\n    // there.\r\n    context.suspend && context.suspend();\r\n}\r\n\r\n/**\r\n * Converts time domain data array to audio level.\r\n * @param samples the time domain data array.\r\n * @returns {number} the audio level\r\n */\r\nfunction timeDomainDataToAudioLevel(samples) {\r\n\r\n    let maxVolume = 0;\r\n\r\n    const length = samples.length;\r\n\r\n    for (let i = 0; i < length; i++) {\r\n        if (maxVolume < samples[i]) {\r\n            maxVolume = samples[i];\r\n        }\r\n    }\r\n\r\n    return parseFloat(((maxVolume - 127) / 128).toFixed(3));\r\n}\r\n\r\n/**\r\n * Animates audio level change\r\n * @param newLevel the new audio level\r\n * @param lastLevel the last audio level\r\n * @returns {Number} the audio level to be set\r\n */\r\nfunction animateLevel(newLevel, lastLevel) {\r\n    let value = 0;\r\n    const diff = lastLevel - newLevel;\r\n\r\n    if (diff > 0.2) {\r\n        value = lastLevel - 0.2;\r\n    } else if (diff < -0.4) {\r\n        value = lastLevel + 0.4;\r\n    } else {\r\n        value = newLevel;\r\n    }\r\n\r\n    return parseFloat(value.toFixed(3));\r\n}\r\n\r\n\r\n/**\r\n * <tt>LocalStatsCollector</tt> calculates statistics for the local stream.\r\n *\r\n * @param stream the local stream\r\n * @param interval stats refresh interval given in ms.\r\n * @param callback function that receives the audio levels.\r\n * @constructor\r\n */\r\nexport default function LocalStatsCollector(stream, interval, callback) {\r\n    this.stream = stream;\r\n    this.intervalId = null;\r\n    this.intervalMilis = interval;\r\n    this.audioLevel = 0;\r\n    this.callback = callback;\r\n}\r\n\r\n/**\r\n * Starts the collecting the statistics.\r\n */\r\nLocalStatsCollector.prototype.start = function() {\r\n    if (!LocalStatsCollector.isLocalStatsSupported()) {\r\n        return;\r\n    }\r\n    context.resume();\r\n    const analyser = context.createAnalyser();\r\n\r\n    analyser.smoothingTimeConstant = WEBAUDIO_ANALYZER_SMOOTING_TIME;\r\n    analyser.fftSize = WEBAUDIO_ANALYZER_FFT_SIZE;\r\n\r\n    const source = context.createMediaStreamSource(this.stream);\r\n\r\n    source.connect(analyser);\r\n\r\n\r\n    const self = this;\r\n\r\n    this.intervalId = setInterval(\r\n        () => {\r\n            const array = new Uint8Array(analyser.frequencyBinCount);\r\n\r\n            analyser.getByteTimeDomainData(array);\r\n            const audioLevel = timeDomainDataToAudioLevel(array);\r\n\r\n            if (audioLevel !== self.audioLevel) {\r\n                self.audioLevel = animateLevel(audioLevel, self.audioLevel);\r\n                self.callback(self.audioLevel);\r\n            }\r\n        },\r\n        this.intervalMilis\r\n    );\r\n};\r\n\r\n/**\r\n * Stops collecting the statistics.\r\n */\r\nLocalStatsCollector.prototype.stop = function() {\r\n    if (this.intervalId) {\r\n        clearInterval(this.intervalId);\r\n        this.intervalId = null;\r\n    }\r\n};\r\n\r\n/**\r\n * Checks if the environment has the necessary conditions to support\r\n * collecting stats from local streams.\r\n *\r\n * @returns {boolean}\r\n */\r\nLocalStatsCollector.isLocalStatsSupported = function() {\r\n    return Boolean(context && !browser.isTemasysPluginUsed());\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/statistics/LocalStatsCollector.js","/**\r\n * Notifies about audio level in RTP statistics by SSRC.\r\n *\r\n * @param ssrc - The synchronization source identifier (SSRC) of the\r\n * endpoint/participant whose audio level is being reported.\r\n * @param {number} audioLevel - The audio level of <tt>ssrc</tt> according to\r\n * RTP statistics.\r\n * @param {boolean} isLocal - <tt>true</tt> if <tt>ssrc</tt> identifies the\r\n * local endpoint/participant; otherwise, <tt>false</tt>.\r\n */\r\nexport const AUDIO_LEVEL = 'statistics.audioLevel';\r\n\r\n/**\r\n * An event fired just before the statistics module gets disposes and it's\r\n * the last chance to submit some logs that will end up in stats services like\r\n * CallStats (if enabled).\r\n */\r\nexport const BEFORE_DISPOSED = 'statistics.before_disposed';\r\n\r\n/**\r\n * An event carrying all statistics by ssrc.\r\n */\r\nexport const BYTE_SENT_STATS = 'statistics.byte_sent_stats';\r\n\r\n/**\r\n * An event carrying connection statistics.\r\n *\r\n * @param {object} connectionStats - The connection statistics carried by the\r\n * event such as <tt>bandwidth</tt>, <tt>bitrate</tt>, <tt>packetLoss</tt>,\r\n * <tt>resolution</tt>, and <tt>transport</tt>.\r\n */\r\nexport const CONNECTION_STATS = 'statistics.connectionstats';\r\n\n\n\n// WEBPACK FOOTER //\n// ./service/statistics/Events.js","const currentExecutingScript = require('current-executing-script');\r\n\r\n/* eslint-disable max-params */\r\n\r\n/**\r\n * Implements utility functions which facilitate the dealing with scripts such\r\n * as the download and execution of a JavaScript file.\r\n */\r\nconst ScriptUtil = {\r\n    /**\r\n     * Loads a script from a specific source.\r\n     *\r\n     * @param src the source from the which the script is to be (down)loaded\r\n     * @param async true to asynchronously load the script or false to\r\n     * synchronously load the script\r\n     * @param prepend true to schedule the loading of the script as soon as\r\n     * possible or false to schedule the loading of the script at the end of the\r\n     * scripts known at the time\r\n     * @param relativeURL whether we need load the library from url relative\r\n     * to the url that lib-jitsi-meet was loaded. Useful when sourcing the\r\n     * library from different location than the app that is using it\r\n     * @param loadCallback on load callback function\r\n     * @param errorCallback callback to be called on error loading the script\r\n     */\r\n    loadScript(\r\n            src,\r\n            async,\r\n            prepend,\r\n            relativeURL,\r\n            loadCallback,\r\n            errorCallback) {\r\n        const d = document;\r\n        const tagName = 'script';\r\n        const script = d.createElement(tagName);\r\n        const referenceNode = d.getElementsByTagName(tagName)[0];\r\n\r\n        script.async = async;\r\n\r\n        if (relativeURL) {\r\n            // finds the src url of the current loaded script\r\n            // and use it as base of the src supplied argument\r\n            const scriptEl = currentExecutingScript();\r\n\r\n            if (scriptEl) {\r\n                const scriptSrc = scriptEl.src;\r\n                const baseScriptSrc\r\n                    = scriptSrc.substring(0, scriptSrc.lastIndexOf('/') + 1);\r\n\r\n                if (scriptSrc && baseScriptSrc) {\r\n                    // eslint-disable-next-line no-param-reassign\r\n                    src = baseScriptSrc + src;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (loadCallback) {\r\n            script.onload = loadCallback;\r\n        }\r\n        if (errorCallback) {\r\n            script.onerror = errorCallback;\r\n        }\r\n\r\n        script.src = src;\r\n        if (prepend) {\r\n            referenceNode.parentNode.insertBefore(script, referenceNode);\r\n        } else {\r\n            referenceNode.parentNode.appendChild(script);\r\n        }\r\n    }\r\n};\r\n\r\n/* eslint-enable max-params */\r\n\r\nmodule.exports = ScriptUtil;\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/util/ScriptUtil.js","/* global $ */\r\n\r\nimport { getLogger } from 'jitsi-meet-logger';\r\nimport { Strophe } from 'strophe.js';\r\nimport 'strophejs-plugin-disco';\r\n\r\nimport RandomUtil from '../util/RandomUtil';\r\nimport * as JitsiConnectionErrors from '../../JitsiConnectionErrors';\r\nimport * as JitsiConnectionEvents from '../../JitsiConnectionEvents';\r\nimport browser from '../browser';\r\nimport initEmuc from './strophe.emuc';\r\nimport initJingle from './strophe.jingle';\r\nimport initStropheUtil from './strophe.util';\r\nimport initPing from './strophe.ping';\r\nimport initRayo from './strophe.rayo';\r\nimport initStropheLogger from './strophe.logger';\r\nimport Listenable from '../util/Listenable';\r\nimport Caps from './Caps';\r\n\r\nconst logger = getLogger(__filename);\r\n\r\n/**\r\n *\r\n * @param token\r\n * @param bosh\r\n */\r\nfunction createConnection(token, bosh = '/http-bind') {\r\n    // Append token as URL param\r\n    if (token) {\r\n        // eslint-disable-next-line no-param-reassign\r\n        bosh += `${bosh.indexOf('?') === -1 ? '?' : '&'}token=${token}`;\r\n    }\r\n\r\n    const conn = new Strophe.Connection(bosh);\r\n\r\n    // The default maxRetries is 5, which is too long.\r\n    conn.maxRetries = 3;\r\n\r\n    return conn;\r\n}\r\n\r\n/**\r\n *\r\n */\r\nexport default class XMPP extends Listenable {\r\n    /**\r\n     * FIXME describe all options\r\n     * @param {Object} options\r\n     * @param {Array<Object>} options.p2pStunServers see\r\n     * {@link JingleConnectionPlugin} for more details.\r\n     * @param token\r\n     */\r\n    constructor(options, token) {\r\n        super();\r\n        this.connection = null;\r\n        this.disconnectInProgress = false;\r\n        this.connectionTimes = {};\r\n        this.options = options;\r\n        this.token = token;\r\n        this.authenticatedUser = false;\r\n        this._initStrophePlugins(this);\r\n\r\n        this.connection = createConnection(token, options.bosh);\r\n\r\n        this.caps = new Caps(this.connection, this.options.clientNode);\r\n\r\n        // Initialize features advertised in disco-info\r\n        this.initFeaturesList();\r\n\r\n        // Setup a disconnect on unload as a way to facilitate API consumers. It\r\n        // sounds like they would want that. A problem for them though may be if\r\n        // they wanted to utilize the connected connection in an unload handler\r\n        // of their own. However, it should be fairly easy for them to do that\r\n        // by registering their unload handler before us.\r\n        $(window).on('beforeunload unload', this.disconnect.bind(this));\r\n    }\r\n\r\n    /**\r\n     * Initializes the list of feature advertised through the disco-info\r\n     * mechanism.\r\n     */\r\n    initFeaturesList() {\r\n        // http://xmpp.org/extensions/xep-0167.html#support\r\n        // http://xmpp.org/extensions/xep-0176.html#support\r\n        this.caps.addFeature('urn:xmpp:jingle:1');\r\n        this.caps.addFeature('urn:xmpp:jingle:apps:rtp:1');\r\n        this.caps.addFeature('urn:xmpp:jingle:transports:ice-udp:1');\r\n        this.caps.addFeature('urn:xmpp:jingle:apps:dtls:0');\r\n        this.caps.addFeature('urn:xmpp:jingle:transports:dtls-sctp:1');\r\n        this.caps.addFeature('urn:xmpp:jingle:apps:rtp:audio');\r\n        this.caps.addFeature('urn:xmpp:jingle:apps:rtp:video');\r\n\r\n        if (!this.options.disableRtx && browser.supportsRtx()) {\r\n            this.caps.addFeature('urn:ietf:rfc:4588');\r\n        }\r\n\r\n        // this is dealt with by SDP O/A so we don't need to announce this\r\n        // XEP-0293\r\n        // this.caps.addFeature('urn:xmpp:jingle:apps:rtp:rtcp-fb:0');\r\n        // XEP-0294\r\n        // this.caps.addFeature('urn:xmpp:jingle:apps:rtp:rtp-hdrext:0');\r\n\r\n        this.caps.addFeature('urn:ietf:rfc:5761'); // rtcp-mux\r\n        this.caps.addFeature('urn:ietf:rfc:5888'); // a=group, e.g. bundle\r\n\r\n        // this.caps.addFeature('urn:ietf:rfc:5576'); // a=ssrc\r\n\r\n        // Enable Lipsync ?\r\n        if (browser.isChrome() && this.options.enableLipSync !== false) {\r\n            logger.info('Lip-sync enabled !');\r\n            this.caps.addFeature('http://jitsi.org/meet/lipsync');\r\n        }\r\n\r\n        if (this.connection.rayo) {\r\n            this.caps.addFeature('urn:xmpp:rayo:client:1');\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     */\r\n    getConnection() {\r\n        return this.connection;\r\n    }\r\n\r\n    /**\r\n     * Receive connection status changes and handles them.\r\n     *\r\n     * @param {Object} credentials\r\n     * @param {string} credentials.jid - The user's XMPP ID passed to the\r\n     * connect method. For example, 'user@xmpp.com'.\r\n     * @param {string} credentials.password - The password passed to the connect\r\n     * method.\r\n     * @param {string} status - One of Strophe's connection status strings.\r\n     * @param {string} [msg] - The connection error message provided by Strophe.\r\n     */\r\n    connectionHandler(credentials = {}, status, msg) {\r\n        const now = window.performance.now();\r\n        const statusStr = Strophe.getStatusString(status).toLowerCase();\r\n\r\n        this.connectionTimes[statusStr] = now;\r\n        logger.log(\r\n            `(TIME) Strophe ${statusStr}${msg ? `[${msg}]` : ''}:\\t`,\r\n            now);\r\n        if (status === Strophe.Status.CONNECTED\r\n            || status === Strophe.Status.ATTACHED) {\r\n            if (this.options.useStunTurn\r\n                || (this.options.p2p && this.options.p2p.useStunTurn)) {\r\n                this.connection.jingle.getStunAndTurnCredentials();\r\n            }\r\n\r\n            logger.info(`My Jabber ID: ${this.connection.jid}`);\r\n\r\n            // Schedule ping ?\r\n            const pingJid = this.connection.domain;\r\n\r\n            this.connection.ping.hasPingSupport(\r\n                pingJid,\r\n                hasPing => {\r\n                    if (hasPing) {\r\n                        this.connection.ping.startInterval(pingJid);\r\n                    } else {\r\n                        logger.warn(`Ping NOT supported by ${pingJid}`);\r\n                    }\r\n                });\r\n\r\n            if (credentials.password) {\r\n                this.authenticatedUser = true;\r\n            }\r\n            if (this.connection && this.connection.connected\r\n                    && Strophe.getResourceFromJid(this.connection.jid)) {\r\n                // .connected is true while connecting?\r\n                // this.connection.send($pres());\r\n                this.eventEmitter.emit(\r\n                    JitsiConnectionEvents.CONNECTION_ESTABLISHED,\r\n                    Strophe.getResourceFromJid(this.connection.jid));\r\n            }\r\n        } else if (status === Strophe.Status.CONNFAIL) {\r\n            if (msg === 'x-strophe-bad-non-anon-jid') {\r\n                this.anonymousConnectionFailed = true;\r\n            } else {\r\n                this.connectionFailed = true;\r\n            }\r\n            this.lastErrorMsg = msg;\r\n            if (msg === 'giving-up') {\r\n                this.eventEmitter.emit(\r\n                    JitsiConnectionEvents.CONNECTION_FAILED,\r\n                    JitsiConnectionErrors.OTHER_ERROR, msg);\r\n            }\r\n        } else if (status === Strophe.Status.DISCONNECTED) {\r\n            // Stop ping interval\r\n            this.connection.ping.stopInterval();\r\n            const wasIntentionalDisconnect = this.disconnectInProgress;\r\n            const errMsg = msg || this.lastErrorMsg;\r\n\r\n            this.disconnectInProgress = false;\r\n            if (this.anonymousConnectionFailed) {\r\n                // prompt user for username and password\r\n                this.eventEmitter.emit(\r\n                    JitsiConnectionEvents.CONNECTION_FAILED,\r\n                    JitsiConnectionErrors.PASSWORD_REQUIRED);\r\n            } else if (this.connectionFailed) {\r\n                this.eventEmitter.emit(\r\n                    JitsiConnectionEvents.CONNECTION_FAILED,\r\n                    JitsiConnectionErrors.OTHER_ERROR,\r\n                    errMsg,\r\n                    undefined, /* credentials */\r\n                    this._getConnectionFailedReasonDetails());\r\n            } else if (wasIntentionalDisconnect) {\r\n                this.eventEmitter.emit(\r\n                    JitsiConnectionEvents.CONNECTION_DISCONNECTED, errMsg);\r\n            } else {\r\n                // XXX if Strophe drops the connection while not being asked to,\r\n                // it means that most likely some serious error has occurred.\r\n                // One currently known case is when a BOSH request fails for\r\n                // more than 4 times. The connection is dropped without\r\n                // supplying a reason(error message/event) through the API.\r\n                logger.error('XMPP connection dropped!');\r\n\r\n                // XXX if the last request error is within 5xx range it means it\r\n                // was a server failure\r\n                const lastErrorStatus = Strophe.getLastErrorStatus();\r\n\r\n                if (lastErrorStatus >= 500 && lastErrorStatus < 600) {\r\n                    this.eventEmitter.emit(\r\n                        JitsiConnectionEvents.CONNECTION_FAILED,\r\n                        JitsiConnectionErrors.SERVER_ERROR,\r\n                        errMsg || 'server-error');\r\n                } else {\r\n                    this.eventEmitter.emit(\r\n                        JitsiConnectionEvents.CONNECTION_FAILED,\r\n                        JitsiConnectionErrors.CONNECTION_DROPPED_ERROR,\r\n                        errMsg || 'connection-dropped-error');\r\n                }\r\n            }\r\n        } else if (status === Strophe.Status.AUTHFAIL) {\r\n            // wrong password or username, prompt user\r\n            this.eventEmitter.emit(\r\n                JitsiConnectionEvents.CONNECTION_FAILED,\r\n                JitsiConnectionErrors.PASSWORD_REQUIRED,\r\n                msg,\r\n                credentials);\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param jid\r\n     * @param password\r\n     */\r\n    _connect(jid, password) {\r\n        // connection.connect() starts the connection process.\r\n        //\r\n        // As the connection process proceeds, the user supplied callback will\r\n        // be triggered multiple times with status updates. The callback should\r\n        // take two arguments - the status code and the error condition.\r\n        //\r\n        // The status code will be one of the values in the Strophe.Status\r\n        // constants. The error condition will be one of the conditions defined\r\n        // in RFC 3920 or the condition strophe-parsererror.\r\n        //\r\n        // The Parameters wait, hold and route are optional and only relevant\r\n        // for BOSH connections. Please see XEP 124 for a more detailed\r\n        // explanation of the optional parameters.\r\n        //\r\n        // Connection status constants for use by the connection handler\r\n        // callback.\r\n        //\r\n        //  Status.ERROR - An error has occurred (websockets specific)\r\n        //  Status.CONNECTING - The connection is currently being made\r\n        //  Status.CONNFAIL - The connection attempt failed\r\n        //  Status.AUTHENTICATING - The connection is authenticating\r\n        //  Status.AUTHFAIL - The authentication attempt failed\r\n        //  Status.CONNECTED - The connection has succeeded\r\n        //  Status.DISCONNECTED - The connection has been terminated\r\n        //  Status.DISCONNECTING - The connection is currently being terminated\r\n        //  Status.ATTACHED - The connection has been attached\r\n\r\n        this.anonymousConnectionFailed = false;\r\n        this.connectionFailed = false;\r\n        this.lastErrorMsg = undefined;\r\n        this.connection.connect(\r\n            jid,\r\n            password,\r\n            this.connectionHandler.bind(this, {\r\n                jid,\r\n                password\r\n            }));\r\n    }\r\n\r\n    /**\r\n     * Attach to existing connection. Can be used for optimizations. For\r\n     * example: if the connection is created on the server we can attach to it\r\n     * and start using it.\r\n     *\r\n     * @param options {object} connecting options - rid, sid, jid and password.\r\n     */\r\n    attach(options) {\r\n        const now = this.connectionTimes.attaching = window.performance.now();\r\n\r\n        logger.log(`(TIME) Strophe Attaching\\t:${now}`);\r\n        this.connection.attach(options.jid, options.sid,\r\n            parseInt(options.rid, 10) + 1,\r\n            this.connectionHandler.bind(this, {\r\n                jid: options.jid,\r\n                password: options.password\r\n            }));\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param jid\r\n     * @param password\r\n     */\r\n    connect(jid, password) {\r\n        if (!jid) {\r\n            const { anonymousdomain, domain } = this.options.hosts;\r\n            let configDomain = anonymousdomain || domain;\r\n\r\n            // Force authenticated domain if room is appended with '?login=true'\r\n            // or if we're joining with the token\r\n\r\n            // FIXME Do not rely on window.location because (1) React Native\r\n            // does not have a window.location by default and (2) here we cannot\r\n            // know for sure that query/search has not be stripped from\r\n            // window.location by the time the following executes.\r\n            const { location } = window;\r\n\r\n            if (anonymousdomain) {\r\n                const search = location && location.search;\r\n\r\n                if ((search && search.indexOf('login=true') !== -1)\r\n                        || this.token) {\r\n                    configDomain = domain;\r\n                }\r\n            }\r\n\r\n            // eslint-disable-next-line no-param-reassign\r\n            jid = configDomain || (location && location.hostname);\r\n        }\r\n\r\n        return this._connect(jid, password);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param roomName\r\n     * @param options\r\n     */\r\n    createRoom(roomName, options) {\r\n        // By default MUC nickname is the resource part of the JID\r\n        let mucNickname = Strophe.getNodeFromJid(this.connection.jid);\r\n        let roomjid = `${roomName}@${this.options.hosts.muc}/`;\r\n        const cfgNickname\r\n            = options.useNicks && options.nick ? options.nick : null;\r\n\r\n        if (cfgNickname) {\r\n            // Use nick if it's defined\r\n            mucNickname = options.nick;\r\n        } else if (!this.authenticatedUser) {\r\n            // node of the anonymous JID is very long - here we trim it a bit\r\n            mucNickname = mucNickname.substr(0, 8);\r\n        }\r\n\r\n        // Constant JIDs need some random part to be appended in order to be\r\n        // able to join the MUC more than once.\r\n        if (this.authenticatedUser || cfgNickname !== null) {\r\n            mucNickname += `-${RandomUtil.randomHexString(6)}`;\r\n        }\r\n\r\n        roomjid += mucNickname;\r\n\r\n        return this.connection.emuc.createRoom(roomjid, null, options);\r\n    }\r\n\r\n    /**\r\n     * Returns the logs from strophe.jingle.\r\n     * @returns {Object}\r\n     */\r\n    getJingleLog() {\r\n        const jingle = this.connection.jingle;\r\n\r\n\r\n        return jingle ? jingle.getLog() : {};\r\n    }\r\n\r\n    /**\r\n     * Returns the logs from strophe.\r\n     */\r\n    getXmppLog() {\r\n        return (this.connection.logger || {}).log || null;\r\n    }\r\n\r\n    /**\r\n     *\r\n     */\r\n    dial(...args) {\r\n        this.connection.rayo.dial(...args);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param jid\r\n     * @param mute\r\n     */\r\n    setMute(jid, mute) {\r\n        this.connection.moderate.setMute(jid, mute);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param jid\r\n     */\r\n    eject(jid) {\r\n        this.connection.moderate.eject(jid);\r\n    }\r\n\r\n    /**\r\n     *\r\n     */\r\n    getSessions() {\r\n        return this.connection.jingle.sessions;\r\n    }\r\n\r\n    /**\r\n     * Disconnects this from the XMPP server (if this is connected).\r\n     *\r\n     * @param ev optionally, the event which triggered the necessity to\r\n     * disconnect from the XMPP server (e.g. beforeunload, unload).\r\n     */\r\n    disconnect(ev) {\r\n        if (this.disconnectInProgress\r\n                || !this.connection\r\n                || !this.connection.connected) {\r\n            this.eventEmitter.emit(JitsiConnectionEvents.WRONG_STATE);\r\n\r\n            return;\r\n        }\r\n\r\n        this.disconnectInProgress = true;\r\n\r\n        // XXX Strophe is asynchronously sending by default. Unfortunately, that\r\n        // means that there may not be enough time to send an unavailable\r\n        // presence or disconnect at all. Switching Strophe to synchronous\r\n        // sending is not much of an option because it may lead to a noticeable\r\n        // delay in navigating away from the current location. As a compromise,\r\n        // we will try to increase the chances of sending an unavailable\r\n        // presence and/or disconecting within the short time span that we have\r\n        // upon unloading by invoking flush() on the connection. We flush() once\r\n        // before disconnect() in order to attemtp to have its unavailable\r\n        // presence at the top of the send queue. We flush() once more after\r\n        // disconnect() in order to attempt to have its unavailable presence\r\n        // sent as soon as possible.\r\n        this.connection.flush();\r\n\r\n        if (ev !== null && typeof ev !== 'undefined') {\r\n            const evType = ev.type;\r\n\r\n            if (evType === 'beforeunload' || evType === 'unload') {\r\n                // XXX Whatever we said above, synchronous sending is the best\r\n                // (known) way to properly disconnect from the XMPP server.\r\n                // Consequently, it may be fine to have the source code and\r\n                // comment it in or out depending on whether we want to run with\r\n                // it for some time.\r\n                this.connection.options.sync = true;\r\n            }\r\n        }\r\n\r\n        this.connection.disconnect();\r\n\r\n        if (this.connection.options.sync !== true) {\r\n            this.connection.flush();\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     */\r\n    _initStrophePlugins() {\r\n        const iceConfig = {\r\n            jvb: { iceServers: [ ] },\r\n            p2p: { iceServers: [ ] }\r\n        };\r\n\r\n        // FIXME: remove once we have a default config template. -saghul\r\n        const defaultStunServers = [\r\n            { urls: 'stun:stun.l.google.com:19302' },\r\n            { urls: 'stun:stun1.l.google.com:19302' },\r\n            { urls: 'stun:stun2.l.google.com:19302' }\r\n        ];\r\n\r\n        const p2pStunServers = (this.options.p2p\r\n            && this.options.p2p.stunServers) || defaultStunServers;\r\n\r\n        if (Array.isArray(p2pStunServers)) {\r\n            logger.info('P2P STUN servers: ', p2pStunServers);\r\n            iceConfig.p2p.iceServers = p2pStunServers;\r\n        }\r\n\r\n        if (this.options.p2p && this.options.p2p.iceTransportPolicy) {\r\n            logger.info('P2P ICE transport policy: ',\r\n                this.options.p2p.iceTransportPolicy);\r\n\r\n            iceConfig.p2p.iceTransportPolicy\r\n                = this.options.p2p.iceTransportPolicy;\r\n        }\r\n\r\n        initEmuc(this);\r\n        initJingle(this, this.eventEmitter, iceConfig);\r\n        initStropheUtil();\r\n        initPing(this);\r\n        initRayo();\r\n        initStropheLogger();\r\n    }\r\n\r\n    /**\r\n     * Returns details about connection failure. Shard change or is it after\r\n     * suspend.\r\n     * @returns {object} contains details about a connection failure.\r\n     * @private\r\n     */\r\n    _getConnectionFailedReasonDetails() {\r\n        const details = {};\r\n\r\n        // check for moving between shard if information is available\r\n        if (this.options.deploymentInfo\r\n            && this.options.deploymentInfo.shard\r\n            && this.connection._proto\r\n            && this.connection._proto.lastResponseHeaders) {\r\n\r\n            // split headers by line\r\n            const headersArr = this.connection._proto.lastResponseHeaders\r\n                .trim().split(/[\\r\\n]+/);\r\n            const headers = {};\r\n\r\n            headersArr.forEach(line => {\r\n                const parts = line.split(': ');\r\n                const header = parts.shift();\r\n                const value = parts.join(': ');\r\n\r\n                headers[header] = value;\r\n            });\r\n\r\n            /* eslint-disable camelcase */\r\n            details.shard_changed\r\n                = this.options.deploymentInfo.shard\r\n                    !== headers['x-jitsi-shard'];\r\n            /* eslint-enable camelcase */\r\n        }\r\n\r\n        /* eslint-disable camelcase */\r\n        // check for possible suspend\r\n        details.suspend_time = this.connection.ping.getPingSuspendTime();\r\n        /* eslint-enable camelcase */\r\n\r\n        return details;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/xmpp/xmpp.js","/**\r\n * The errors for the connection.\r\n */\r\n\r\n/**\r\n * Indicates that the connection was dropped with an error which was most likely\r\n * caused by some networking issues. The dropped term in this context means that\r\n * the connection was closed unexpectedly (not on user's request).\r\n *\r\n * One example is 'item-not-found' error thrown by Prosody when the BOSH session\r\n * times out after 60 seconds of inactivity. On the other hand 'item-not-found'\r\n * could also happen when BOSH request is sent to the server with the session-id\r\n * that is not know to the server. But this should not happen in lib-jitsi-meet\r\n * case as long as the service is configured correctly (there is no bug).\r\n */\r\nexport const CONNECTION_DROPPED_ERROR = 'connection.droppedError';\r\n\r\n/**\r\n * Not specified errors.\r\n */\r\nexport const OTHER_ERROR = 'connection.otherError';\r\n\r\n/**\r\n * Indicates that a password is required in order to join the conference.\r\n */\r\nexport const PASSWORD_REQUIRED = 'connection.passwordRequired';\r\n\r\n/**\r\n * Indicates that the connection was dropped, because of too many 5xx HTTP\r\n * errors on BOSH requests.\r\n */\r\nexport const SERVER_ERROR = 'connection.serverError';\r\n\n\n\n// WEBPACK FOOTER //\n// ./JitsiConnectionErrors.js","/**\r\n * The transciption is on.\r\n *\r\n * @type {String}\r\n */\r\nexport const ON = 'on';\r\n\r\n/**\r\n * The transciption is off.\r\n *\r\n * @type {String}\r\n */\r\nexport const OFF = 'off';\r\n\n\n\n// WEBPACK FOOTER //\n// ./JitsiTranscriptionStatus.js","const AuthenticationEvents = {\r\n    /**\r\n     * Event callback arguments:\r\n     * function(authenticationEnabled, userIdentity)\r\n     * authenticationEnabled - indicates whether authentication has been enabled\r\n     *                         in this session\r\n     * userIdentity - if user has been logged in then it contains user name. If\r\n     *                contains 'null' or 'undefined' then user is not logged in.\r\n     */\r\n    IDENTITY_UPDATED: 'authentication.identity_updated'\r\n};\r\n\r\nmodule.exports = AuthenticationEvents;\r\n\n\n\n// WEBPACK FOOTER //\n// ./service/authentication/AuthenticationEvents.js","/* global $ */\r\n\r\nimport { getLogger } from 'jitsi-meet-logger';\r\nimport { $iq } from 'strophe.js';\r\n\r\nconst XMPPEvents = require('../../service/xmpp/XMPPEvents');\r\nconst JitsiRecorderErrors = require('../../JitsiRecorderErrors');\r\nconst GlobalOnErrorHandler = require('../util/GlobalOnErrorHandler');\r\n\r\nconst logger = getLogger(__filename);\r\n\r\n/**\r\n * Extracts the error details from given error element/node.\r\n *\r\n * @param {Element|Object} errorIqNode - Either DOM element or the structure\r\n * from ChatRoom packet2JSON.\r\n * @return {{\r\n *     code: string,\r\n *     type: string,\r\n *     message: string\r\n * }}\r\n */\r\nfunction getJibriErrorDetails(errorIqNode) {\r\n    if (typeof errorIqNode.querySelector === 'function') {\r\n        const error = errorIqNode.querySelector('error');\r\n        const errorText = error && error.querySelector('text');\r\n\r\n        return error && {\r\n            code: error.attributes.code && error.attributes.code.value,\r\n            type: error.attributes.type && error.attributes.type.value,\r\n            message: errorText && errorText.textContent\r\n        };\r\n    }\r\n\r\n    let error = null;\r\n\r\n    for (const child of errorIqNode.children) {\r\n        if (child.tagName === 'error') {\r\n            error = child;\r\n            break;\r\n        }\r\n    }\r\n\r\n    if (!error) {\r\n        return null;\r\n    }\r\n\r\n    let errorText = null;\r\n\r\n    for (const errorChild of error.children) {\r\n        if (errorChild.tagName === 'text') {\r\n            errorText = errorChild.value;\r\n            break;\r\n        }\r\n    }\r\n\r\n    return {\r\n        code: error.attributes.code,\r\n        type: error.attributes.type,\r\n        message: errorText\r\n    };\r\n}\r\n\r\n/* eslint-disable max-params */\r\n\r\n/**\r\n *\r\n * @param type\r\n * @param eventEmitter\r\n * @param connection\r\n * @param focusMucJid\r\n * @param jirecon\r\n * @param roomjid\r\n */\r\nexport default function Recording(\r\n        type,\r\n        eventEmitter,\r\n        connection,\r\n        focusMucJid,\r\n        jirecon,\r\n        roomjid) {\r\n    this.eventEmitter = eventEmitter;\r\n    this.connection = connection;\r\n    this.state = null;\r\n    this.focusMucJid = focusMucJid;\r\n    this.jirecon = jirecon;\r\n    this.url = null;\r\n    this.type = type;\r\n    this._isSupported\r\n        = !(\r\n            (type === Recording.types.JIRECON && !this.jirecon)\r\n                || (type !== Recording.types.JIBRI\r\n                    && type !== Recording.types.JIBRI_FILE\r\n                    && type !== Recording.types.COLIBRI));\r\n\r\n    /**\r\n     * The ID of the jirecon recording session. Jirecon generates it when we\r\n     * initially start recording, and it needs to be used in subsequent requests\r\n     * to jirecon.\r\n     */\r\n    this.jireconRid = null;\r\n    this.roomjid = roomjid;\r\n}\r\n\r\n/* eslint-enable max-params */\r\n\r\nRecording.types = {\r\n    COLIBRI: 'colibri',\r\n    JIRECON: 'jirecon',\r\n    JIBRI: 'jibri',\r\n    JIBRI_FILE: 'jibri_file'\r\n};\r\n\r\nRecording.status = {\r\n    ON: 'on',\r\n    OFF: 'off',\r\n    AVAILABLE: 'available',\r\n    UNAVAILABLE: 'unavailable',\r\n    PENDING: 'pending',\r\n    RETRYING: 'retrying',\r\n    ERROR: 'error',\r\n    BUSY: 'busy',\r\n    FAILED: 'failed'\r\n};\r\n\r\nRecording.action = {\r\n    START: 'start',\r\n    STOP: 'stop'\r\n};\r\n\r\nRecording.prototype.handleJibriPresence = function(jibri) {\r\n    const attributes = jibri.attributes;\r\n\r\n    if (!attributes) {\r\n        return;\r\n    }\r\n\r\n    const newState = attributes.status;\r\n    const errorDetails = getJibriErrorDetails(jibri);\r\n\r\n    logger.log(`Handle Jibri presence : ${newState}`, errorDetails);\r\n\r\n    if (newState === this.state) {\r\n        return;\r\n    }\r\n\r\n    if (newState === 'undefined') {\r\n        this.state = Recording.status.UNAVAILABLE;\r\n    } else if (newState === Recording.status.OFF) {\r\n        if (!this.state\r\n            || this.state === 'undefined'\r\n            || this.state === Recording.status.UNAVAILABLE) {\r\n            this.state = Recording.status.AVAILABLE;\r\n        } else {\r\n            this.state = Recording.status.OFF;\r\n        }\r\n    } else {\r\n        this.state = newState;\r\n    }\r\n\r\n    this.eventEmitter.emit(XMPPEvents.RECORDER_STATE_CHANGED, this.state);\r\n};\r\n\r\n/* eslint-disable max-params */\r\n\r\nRecording.prototype.setRecordingJibri = function(\r\n        state,\r\n        callback,\r\n        errCallback,\r\n        options = {}) {\r\n    if (state === this.state) {\r\n        errCallback(JitsiRecorderErrors.INVALID_STATE);\r\n    }\r\n\r\n    // FIXME jibri does not accept IQ without 'url' attribute set ?\r\n    const iq\r\n        = $iq({\r\n            to: this.focusMucJid,\r\n            type: 'set'\r\n        })\r\n            .c('jibri', {\r\n                'xmlns': 'http://jitsi.org/protocol/jibri',\r\n                'action':\r\n                    state === Recording.status.ON\r\n                        ? Recording.action.START\r\n                        : Recording.action.STOP,\r\n                'recording_mode':\r\n                    this.type === Recording.types.JIBRI_FILE\r\n                        ? 'file'\r\n                        : 'stream',\r\n                'streamid':\r\n                    this.type === Recording.types.JIBRI\r\n                        ? options.streamId\r\n                        : undefined\r\n            })\r\n            .up();\r\n\r\n    logger.log(`Set jibri recording: ${state}`, iq.nodeTree);\r\n    logger.log(iq.nodeTree);\r\n    this.connection.sendIQ(\r\n        iq,\r\n        result => {\r\n            logger.log('Result', result);\r\n\r\n            const jibri = $(result).find('jibri');\r\n\r\n            callback(jibri.attr('state'), jibri.attr('url'));\r\n        },\r\n        error => {\r\n            logger.log(\r\n                'Failed to start recording, error: ',\r\n                getJibriErrorDetails(error));\r\n            errCallback(error);\r\n        });\r\n};\r\n\r\n/* eslint-enable max-params */\r\n\r\nRecording.prototype.setRecordingJirecon\r\n    = function(state, callback, errCallback) {\r\n        if (state === this.state) {\r\n            errCallback(new Error('Invalid state!'));\r\n        }\r\n\r\n        const iq\r\n            = $iq({\r\n                to: this.jirecon,\r\n                type: 'set'\r\n            })\r\n                .c('recording', { xmlns: 'http://jitsi.org/protocol/jirecon',\r\n                    action: state === Recording.status.ON\r\n                        ? Recording.action.START\r\n                        : Recording.action.STOP,\r\n                    mucjid: this.roomjid });\r\n\r\n        if (state === Recording.status.OFF) {\r\n            iq.attrs({ rid: this.jireconRid });\r\n        }\r\n\r\n        logger.log('Start recording');\r\n        const self = this;\r\n\r\n        this.connection.sendIQ(\r\n            iq,\r\n            result => {\r\n                // TODO wait for an IQ with the real status, since this is\r\n                // provisional?\r\n                // eslint-disable-next-line newline-per-chained-call\r\n                self.jireconRid = $(result).find('recording').attr('rid');\r\n\r\n                const stateStr\r\n                    = state === Recording.status.ON ? 'started' : 'stopped';\r\n\r\n                logger.log(`Recording ${stateStr}(jirecon)${result}`);\r\n\r\n                self.state = state;\r\n                if (state === Recording.status.OFF) {\r\n                    self.jireconRid = null;\r\n                }\r\n\r\n                callback(state);\r\n            },\r\n            error => {\r\n                logger.log('Failed to start recording, error: ', error);\r\n                errCallback(error);\r\n            });\r\n    };\r\n\r\n/* eslint-disable max-params */\r\n\r\n// Sends a COLIBRI message which enables or disables (according to 'state')\r\n// the recording on the bridge. Waits for the result IQ and calls 'callback'\r\n// with the new recording state, according to the IQ.\r\nRecording.prototype.setRecordingColibri = function(\r\n        state,\r\n        callback,\r\n        errCallback,\r\n        options) {\r\n    const elem = $iq({\r\n        to: this.focusMucJid,\r\n        type: 'set'\r\n    });\r\n\r\n    elem.c('conference', {\r\n        xmlns: 'http://jitsi.org/protocol/colibri'\r\n    });\r\n    elem.c('recording', {\r\n        state,\r\n        token: options.token\r\n    });\r\n\r\n    const self = this;\r\n\r\n    this.connection.sendIQ(\r\n        elem,\r\n        result => {\r\n            logger.log('Set recording \"', state, '\". Result:', result);\r\n            const recordingElem = $(result).find('>conference>recording');\r\n            const newState = recordingElem.attr('state');\r\n\r\n            self.state = newState;\r\n            callback(newState);\r\n\r\n            if (newState === 'pending') {\r\n                self.connection.addHandler(iq => {\r\n                    // eslint-disable-next-line newline-per-chained-call\r\n                    const s = $(iq).find('recording').attr('state');\r\n\r\n                    if (s) {\r\n                        self.state = newState;\r\n                        callback(s);\r\n                    }\r\n                }, 'http://jitsi.org/protocol/colibri', 'iq', null, null, null);\r\n            }\r\n        },\r\n        error => {\r\n            logger.warn(error);\r\n            errCallback(error);\r\n        }\r\n    );\r\n};\r\n\r\n/* eslint-enable max-params */\r\n\r\nRecording.prototype.setRecording = function(...args) {\r\n    switch (this.type) {\r\n    case Recording.types.JIRECON:\r\n        this.setRecordingJirecon(...args);\r\n        break;\r\n    case Recording.types.COLIBRI:\r\n        this.setRecordingColibri(...args);\r\n        break;\r\n    case Recording.types.JIBRI:\r\n    case Recording.types.JIBRI_FILE:\r\n        this.setRecordingJibri(...args);\r\n        break;\r\n    default: {\r\n        const errmsg = 'Unknown recording type!';\r\n\r\n        GlobalOnErrorHandler.callErrorHandler(new Error(errmsg));\r\n        logger.error(errmsg);\r\n        break;\r\n    }\r\n    }\r\n};\r\n\r\n/**\r\n * Starts/stops the recording.\r\n * @param {Object} options\r\n * @param {string} options.token token for authentication\r\n * @param {string} options.streamId the stream ID to be used with Jibri in\r\n * the streaming mode.\r\n * @param statusChangeHandler {function} receives the new status as argument.\r\n */\r\nRecording.prototype.toggleRecording = function(\r\n        options = { },\r\n        statusChangeHandler) {\r\n    const oldState = this.state;\r\n\r\n    // If the recorder is currently unavailable we throw an error.\r\n    if (oldState === Recording.status.UNAVAILABLE\r\n        || oldState === Recording.status.FAILED) {\r\n        statusChangeHandler(\r\n            Recording.status.FAILED,\r\n            JitsiRecorderErrors.RECORDER_UNAVAILABLE);\r\n    } else if (oldState === Recording.status.BUSY) {\r\n        statusChangeHandler(\r\n            Recording.status.BUSY,\r\n            JitsiRecorderErrors.RECORDER_BUSY);\r\n    }\r\n\r\n    // If we're about to turn ON the recording we need either a streamId or\r\n    // an authentication token depending on the recording type. If we don't\r\n    // have any of those we throw an error.\r\n    if ((oldState === Recording.status.OFF\r\n                || oldState === Recording.status.AVAILABLE)\r\n            && ((!options.token && this.type === Recording.types.COLIBRI)\r\n                || (!options.streamId\r\n                    && this.type === Recording.types.JIBRI))) {\r\n        statusChangeHandler(\r\n            Recording.status.FAILED,\r\n            JitsiRecorderErrors.NO_TOKEN);\r\n        logger.error('No token passed!');\r\n\r\n        return;\r\n    }\r\n\r\n    const newState\r\n        = oldState === Recording.status.AVAILABLE\r\n                || oldState === Recording.status.OFF\r\n            ? Recording.status.ON\r\n            : Recording.status.OFF;\r\n\r\n    const self = this;\r\n\r\n    logger.log('Toggle recording (old state, new state): ', oldState, newState);\r\n    this.setRecording(\r\n        newState,\r\n        (state, url) => {\r\n            // If the state is undefined we're going to wait for presence\r\n            // update.\r\n            if (state && state !== oldState) {\r\n                self.state = state;\r\n                self.url = url;\r\n                statusChangeHandler(state);\r\n            }\r\n        },\r\n        error => statusChangeHandler(Recording.status.FAILED, error),\r\n        options);\r\n};\r\n\r\n/**\r\n * Returns true if the recording is supproted and false if not.\r\n */\r\nRecording.prototype.isSupported = function() {\r\n    return this._isSupported;\r\n};\r\n\r\n/**\r\n * Returns null if the recording is not supported, \"on\" if the recording started\r\n * and \"off\" if the recording is not started.\r\n */\r\nRecording.prototype.getState = function() {\r\n    return this.state;\r\n};\r\n\r\n/**\r\n * Returns the url of the recorded video.\r\n */\r\nRecording.prototype.getURL = function() {\r\n    return this.url;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/xmpp/recording.js","/**\r\n * Enumeration with the errors for the conference.\r\n * @type {{string: string}}\r\n */\r\nconst JitsiRecorderErrors = {\r\n    /**\r\n     * Indicates that the recorder is currently unavailable.\r\n     */\r\n    RECORDER_UNAVAILABLE: 'recorder.unavailable',\r\n\r\n    /**\r\n     * Indicates that all available recorders are currently busy.\r\n     */\r\n    RECORDER_BUSY: 'recorder.busy',\r\n\r\n    /**\r\n     * Indicates that the authentication token is missing.\r\n     */\r\n    NO_TOKEN: 'recorder.noToken',\r\n\r\n    /**\r\n     * Indicates that a state change failed.\r\n     */\r\n    STATE_CHANGE_FAILED: 'recorder.stateChangeFailed',\r\n\r\n    /**\r\n     * Indicates an invalid state.\r\n     */\r\n    INVALID_STATE: 'recorder.invalidState'\r\n};\r\n\r\nmodule.exports = JitsiRecorderErrors;\r\n\n\n\n// WEBPACK FOOTER //\n// ./JitsiRecorderErrors.js","/**\r\n * The pending Jingle session state which means the session as defined in\r\n * XEP-0166(before 'session-invite/session-accept' took place).\r\n *\r\n * @type {string}\r\n */\r\nexport const PENDING = 'pending';\r\n\r\n/**\r\n * The active Jingle session state as defined in XEP-0166\r\n * (after 'session-invite'/'session-accept').\r\n *\r\n * @type {string}\r\n */\r\nexport const ACTIVE = 'active';\r\n\r\n/**\r\n * The ended Jingle session state as defined in XEP-0166\r\n * (after 'session-terminate').\r\n * @type {string}\r\n */\r\nexport const ENDED = 'ended';\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/xmpp/JingleSessionState.js","/* global $ */\r\n\r\nimport SDPUtil from './SDPUtil';\r\n\r\n/**\r\n *\r\n * @param sdp\r\n */\r\nexport default function SDP(sdp) {\r\n    const media = sdp.split('\\r\\nm=');\r\n\r\n    for (let i = 1, length = media.length; i < length; i++) {\r\n        let mediaI = `m=${media[i]}`;\r\n\r\n        if (i !== length - 1) {\r\n            mediaI += '\\r\\n';\r\n        }\r\n        media[i] = mediaI;\r\n    }\r\n    const session = `${media.shift()}\\r\\n`;\r\n\r\n    this.media = media;\r\n    this.raw = session + media.join('');\r\n    this.session = session;\r\n}\r\n\r\n/**\r\n * A flag will make {@link transportToJingle} and {@link jingle2media} replace\r\n * ICE candidates IPs with invalid value of '1.1.1.1' which will cause ICE\r\n * failure. The flag is used in the automated testing.\r\n * @type {boolean}\r\n */\r\nSDP.prototype.failICE = false;\r\n\r\n/**\r\n * Whether or not to remove TCP ice candidates when translating from/to jingle.\r\n * @type {boolean}\r\n */\r\nSDP.prototype.removeTcpCandidates = false;\r\n\r\n/**\r\n * Whether or not to remove UDP ice candidates when translating from/to jingle.\r\n * @type {boolean}\r\n */\r\nSDP.prototype.removeUdpCandidates = false;\r\n\r\n/**\r\n * Returns map of MediaChannel mapped per channel idx.\r\n */\r\nSDP.prototype.getMediaSsrcMap = function() {\r\n    const self = this;\r\n    const mediaSSRCs = {};\r\n    let tmp;\r\n\r\n    for (let mediaindex = 0; mediaindex < self.media.length; mediaindex++) {\r\n        tmp = SDPUtil.findLines(self.media[mediaindex], 'a=ssrc:');\r\n        const mid\r\n            = SDPUtil.parseMID(\r\n                SDPUtil.findLine(self.media[mediaindex], 'a=mid:'));\r\n        const media = {\r\n            mediaindex,\r\n            mid,\r\n            ssrcs: {},\r\n            ssrcGroups: []\r\n        };\r\n\r\n        mediaSSRCs[mediaindex] = media;\r\n        tmp.forEach(line => {\r\n            const linessrc = line.substring(7).split(' ')[0];\r\n\r\n            // allocate new ChannelSsrc\r\n\r\n            if (!media.ssrcs[linessrc]) {\r\n                media.ssrcs[linessrc] = {\r\n                    ssrc: linessrc,\r\n                    lines: []\r\n                };\r\n            }\r\n            media.ssrcs[linessrc].lines.push(line);\r\n        });\r\n        tmp = SDPUtil.findLines(self.media[mediaindex], 'a=ssrc-group:');\r\n        tmp.forEach(line => {\r\n            const idx = line.indexOf(' ');\r\n            const semantics = line.substr(0, idx).substr(13);\r\n            const ssrcs = line.substr(14 + semantics.length).split(' ');\r\n\r\n            if (ssrcs.length) {\r\n                media.ssrcGroups.push({\r\n                    semantics,\r\n                    ssrcs\r\n                });\r\n            }\r\n        });\r\n    }\r\n\r\n    return mediaSSRCs;\r\n};\r\n\r\n/**\r\n * Returns <tt>true</tt> if this SDP contains given SSRC.\r\n * @param ssrc the ssrc to check.\r\n * @returns {boolean} <tt>true</tt> if this SDP contains given SSRC.\r\n */\r\nSDP.prototype.containsSSRC = function(ssrc) {\r\n    // FIXME this code is really strange - improve it if you can\r\n    const medias = this.getMediaSsrcMap();\r\n    let result = false;\r\n\r\n    Object.keys(medias).forEach(mediaindex => {\r\n        if (result) {\r\n            return;\r\n        }\r\n        if (medias[mediaindex].ssrcs[ssrc]) {\r\n            result = true;\r\n        }\r\n    });\r\n\r\n    return result;\r\n};\r\n\r\n// remove iSAC and CN from SDP\r\nSDP.prototype.mangle = function() {\r\n    let i, j, lines, mline, newdesc, rtpmap;\r\n\r\n    for (i = 0; i < this.media.length; i++) {\r\n        lines = this.media[i].split('\\r\\n');\r\n        lines.pop(); // remove empty last element\r\n        mline = SDPUtil.parseMLine(lines.shift());\r\n        if (mline.media !== 'audio') {\r\n            continue; // eslint-disable-line no-continue\r\n        }\r\n        newdesc = '';\r\n        mline.fmt.length = 0;\r\n        for (j = 0; j < lines.length; j++) {\r\n            if (lines[j].substr(0, 9) === 'a=rtpmap:') {\r\n                rtpmap = SDPUtil.parseRTPMap(lines[j]);\r\n                if (rtpmap.name === 'CN' || rtpmap.name === 'ISAC') {\r\n                    continue; // eslint-disable-line no-continue\r\n                }\r\n                mline.fmt.push(rtpmap.id);\r\n            }\r\n            newdesc += `${lines[j]}\\r\\n`;\r\n        }\r\n        this.media[i] = `${SDPUtil.buildMLine(mline)}\\r\\n${newdesc}`;\r\n    }\r\n    this.raw = this.session + this.media.join('');\r\n};\r\n\r\n// remove lines matching prefix from session section\r\nSDP.prototype.removeSessionLines = function(prefix) {\r\n    const self = this;\r\n    const lines = SDPUtil.findLines(this.session, prefix);\r\n\r\n    lines.forEach(line => {\r\n        self.session = self.session.replace(`${line}\\r\\n`, '');\r\n    });\r\n    this.raw = this.session + this.media.join('');\r\n\r\n    return lines;\r\n};\r\n\r\n// remove lines matching prefix from a media section specified by mediaindex\r\n// TODO: non-numeric mediaindex could match mid\r\nSDP.prototype.removeMediaLines = function(mediaindex, prefix) {\r\n    const self = this;\r\n    const lines = SDPUtil.findLines(this.media[mediaindex], prefix);\r\n\r\n    lines.forEach(line => {\r\n        self.media[mediaindex]\r\n            = self.media[mediaindex].replace(`${line}\\r\\n`, '');\r\n    });\r\n    this.raw = this.session + this.media.join('');\r\n\r\n    return lines;\r\n};\r\n\r\n// add content's to a jingle element\r\nSDP.prototype.toJingle = function(elem, thecreator) {\r\n    let i, j, k, lines, mline, rtpmap, ssrc, tmp;\r\n\r\n    // new bundle plan\r\n\r\n    lines = SDPUtil.findLines(this.session, 'a=group:');\r\n    if (lines.length) {\r\n        for (i = 0; i < lines.length; i++) {\r\n            tmp = lines[i].split(' ');\r\n            const semantics = tmp.shift().substr(8);\r\n\r\n            elem.c('group', { xmlns: 'urn:xmpp:jingle:apps:grouping:0',\r\n                semantics });\r\n            for (j = 0; j < tmp.length; j++) {\r\n                elem.c('content', { name: tmp[j] }).up();\r\n            }\r\n            elem.up();\r\n        }\r\n    }\r\n    for (i = 0; i < this.media.length; i++) {\r\n        mline = SDPUtil.parseMLine(this.media[i].split('\\r\\n')[0]);\r\n        if (!(mline.media === 'audio'\r\n              || mline.media === 'video'\r\n              || mline.media === 'application')) {\r\n            continue; // eslint-disable-line no-continue\r\n        }\r\n        const assrcline = SDPUtil.findLine(this.media[i], 'a=ssrc:');\r\n\r\n        if (assrcline) {\r\n            ssrc = assrcline.substring(7).split(' ')[0]; // take the first\r\n        } else {\r\n            ssrc = false;\r\n        }\r\n\r\n        elem.c('content', { creator: thecreator,\r\n            name: mline.media });\r\n        const amidline = SDPUtil.findLine(this.media[i], 'a=mid:');\r\n\r\n        if (amidline) {\r\n            // prefer identifier from a=mid if present\r\n            const mid = SDPUtil.parseMID(amidline);\r\n\r\n            elem.attrs({ name: mid });\r\n        }\r\n\r\n        if (SDPUtil.findLine(this.media[i], 'a=rtpmap:').length) {\r\n            elem.c('description',\r\n                { xmlns: 'urn:xmpp:jingle:apps:rtp:1',\r\n                    media: mline.media });\r\n            if (ssrc) {\r\n                elem.attrs({ ssrc });\r\n            }\r\n            for (j = 0; j < mline.fmt.length; j++) {\r\n                rtpmap\r\n                    = SDPUtil.findLine(\r\n                        this.media[i],\r\n                        `a=rtpmap:${mline.fmt[j]}`);\r\n                elem.c('payload-type', SDPUtil.parseRTPMap(rtpmap));\r\n\r\n                // put any 'a=fmtp:' + mline.fmt[j] lines into <param name=foo\r\n                // value=bar/>\r\n                const afmtpline\r\n                    = SDPUtil.findLine(\r\n                        this.media[i],\r\n                        `a=fmtp:${mline.fmt[j]}`);\r\n\r\n                if (afmtpline) {\r\n                    tmp = SDPUtil.parseFmtp(afmtpline);\r\n\r\n                    // eslint-disable-next-line max-depth\r\n                    for (k = 0; k < tmp.length; k++) {\r\n                        elem.c('parameter', tmp[k]).up();\r\n                    }\r\n                }\r\n\r\n                // XEP-0293 -- map a=rtcp-fb\r\n                this.rtcpFbToJingle(i, elem, mline.fmt[j]);\r\n\r\n                elem.up();\r\n            }\r\n            const crypto\r\n                = SDPUtil.findLines(this.media[i], 'a=crypto:', this.session);\r\n\r\n            if (crypto.length) {\r\n                elem.c('encryption', { required: 1 });\r\n                crypto.forEach(\r\n                    line => elem.c('crypto', SDPUtil.parseCrypto(line)).up());\r\n                elem.up(); // end of encryption\r\n            }\r\n\r\n            if (ssrc) {\r\n                const ssrcMap = SDPUtil.parseSSRC(this.media[i]);\r\n\r\n                for (const [ availableSsrc, ssrcParameters ] of ssrcMap) {\r\n                    elem.c('source', {\r\n                        ssrc: availableSsrc,\r\n                        xmlns: 'urn:xmpp:jingle:apps:rtp:ssma:0'\r\n                    });\r\n\r\n                    ssrcParameters.forEach(ssrcSdpLine => {\r\n                        // get everything after first space\r\n                        const idx = ssrcSdpLine.indexOf(' ');\r\n                        const kv = ssrcSdpLine.substr(idx + 1);\r\n\r\n                        elem.c('parameter');\r\n                        if (kv.indexOf(':') === -1) {\r\n                            elem.attrs({ name: kv });\r\n                        } else {\r\n                            const name = kv.split(':', 2)[0];\r\n\r\n                            elem.attrs({ name });\r\n\r\n                            let v = kv.split(':', 2)[1];\r\n\r\n                            v = SDPUtil.filterSpecialChars(v);\r\n                            elem.attrs({ value: v });\r\n                        }\r\n                        elem.up();\r\n                    });\r\n\r\n                    elem.up();\r\n                }\r\n\r\n                // XEP-0339 handle ssrc-group attributes\r\n                const ssrcGroupLines\r\n                    = SDPUtil.findLines(this.media[i], 'a=ssrc-group:');\r\n\r\n                ssrcGroupLines.forEach(line => {\r\n                    const idx = line.indexOf(' ');\r\n                    const semantics = line.substr(0, idx).substr(13);\r\n                    const ssrcs = line.substr(14 + semantics.length).split(' ');\r\n\r\n                    if (ssrcs.length) {\r\n                        elem.c('ssrc-group', { semantics,\r\n                            xmlns: 'urn:xmpp:jingle:apps:rtp:ssma:0' });\r\n                        ssrcs.forEach(s => elem.c('source', { ssrc: s }).up());\r\n                        elem.up();\r\n                    }\r\n                });\r\n            }\r\n\r\n            const ridLines = SDPUtil.findLines(this.media[i], 'a=rid');\r\n\r\n            if (ridLines.length) {\r\n                // Map a line which looks like \"a=rid:2 send\" to just\r\n                // the rid (\"2\")\r\n                const rids = ridLines\r\n                    .map(ridLine => ridLine.split(':')[1])\r\n                    .map(ridInfo => ridInfo.split(' ')[0]);\r\n\r\n                rids.forEach(rid => {\r\n                    elem.c('source', {\r\n                        rid,\r\n                        xmlns: 'urn:xmpp:jingle:apps:rtp:ssma:0'\r\n                    });\r\n                    elem.up();\r\n                });\r\n                const unifiedSimulcast\r\n                    = SDPUtil.findLine(this.media[i], 'a=simulcast');\r\n\r\n                if (unifiedSimulcast) {\r\n                    elem.c('rid-group', {\r\n                        semantics: 'SIM',\r\n                        xmlns: 'urn:xmpp:jingle:apps:rtp:ssma:0'\r\n                    });\r\n                    rids.forEach(rid => {\r\n                        elem.c('source', { rid }).up();\r\n                    });\r\n                    elem.up();\r\n                }\r\n            }\r\n\r\n            if (SDPUtil.findLine(this.media[i], 'a=rtcp-mux')) {\r\n                elem.c('rtcp-mux').up();\r\n            }\r\n\r\n            // XEP-0293 -- map a=rtcp-fb:*\r\n            this.rtcpFbToJingle(i, elem, '*');\r\n\r\n            // XEP-0294\r\n            lines = SDPUtil.findLines(this.media[i], 'a=extmap:');\r\n            if (lines.length) {\r\n                for (j = 0; j < lines.length; j++) {\r\n                    tmp = SDPUtil.parseExtmap(lines[j]);\r\n                    elem.c('rtp-hdrext', {\r\n                        xmlns: 'urn:xmpp:jingle:apps:rtp:rtp-hdrext:0',\r\n                        uri: tmp.uri,\r\n                        id: tmp.value\r\n                    });\r\n\r\n                    // eslint-disable-next-line max-depth\r\n                    if (tmp.hasOwnProperty('direction')) {\r\n\r\n                        // eslint-disable-next-line max-depth\r\n                        switch (tmp.direction) {\r\n                        case 'sendonly':\r\n                            elem.attrs({ senders: 'responder' });\r\n                            break;\r\n                        case 'recvonly':\r\n                            elem.attrs({ senders: 'initiator' });\r\n                            break;\r\n                        case 'sendrecv':\r\n                            elem.attrs({ senders: 'both' });\r\n                            break;\r\n                        case 'inactive':\r\n                            elem.attrs({ senders: 'none' });\r\n                            break;\r\n                        }\r\n                    }\r\n\r\n                    // TODO: handle params\r\n                    elem.up();\r\n                }\r\n            }\r\n            elem.up(); // end of description\r\n        }\r\n\r\n        // map ice-ufrag/pwd, dtls fingerprint, candidates\r\n        this.transportToJingle(i, elem);\r\n\r\n        const m = this.media[i];\r\n\r\n        if (SDPUtil.findLine(m, 'a=sendrecv', this.session)) {\r\n            elem.attrs({ senders: 'both' });\r\n        } else if (SDPUtil.findLine(m, 'a=sendonly', this.session)) {\r\n            elem.attrs({ senders: 'initiator' });\r\n        } else if (SDPUtil.findLine(m, 'a=recvonly', this.session)) {\r\n            elem.attrs({ senders: 'responder' });\r\n        } else if (SDPUtil.findLine(m, 'a=inactive', this.session)) {\r\n            elem.attrs({ senders: 'none' });\r\n        }\r\n        if (mline.port === '0') {\r\n            // estos hack to reject an m-line\r\n            elem.attrs({ senders: 'rejected' });\r\n        }\r\n        elem.up(); // end of content\r\n    }\r\n    elem.up();\r\n\r\n    return elem;\r\n};\r\n\r\nSDP.prototype.transportToJingle = function(mediaindex, elem) {\r\n    let tmp;\r\n    const self = this;\r\n\r\n    elem.c('transport');\r\n\r\n    // XEP-0343 DTLS/SCTP\r\n    const sctpmap\r\n        = SDPUtil.findLine(this.media[mediaindex], 'a=sctpmap:', self.session);\r\n\r\n    if (sctpmap) {\r\n        const sctpAttrs = SDPUtil.parseSCTPMap(sctpmap);\r\n\r\n        elem.c('sctpmap', {\r\n            xmlns: 'urn:xmpp:jingle:transports:dtls-sctp:1',\r\n            number: sctpAttrs[0], /* SCTP port */\r\n            protocol: sctpAttrs[1] /* protocol */\r\n        });\r\n\r\n        // Optional stream count attribute\r\n        if (sctpAttrs.length > 2) {\r\n            elem.attrs({ streams: sctpAttrs[2] });\r\n        }\r\n        elem.up();\r\n    }\r\n\r\n    // XEP-0320\r\n    const fingerprints\r\n        = SDPUtil.findLines(\r\n            this.media[mediaindex],\r\n            'a=fingerprint:',\r\n            this.session);\r\n\r\n    fingerprints.forEach(line => {\r\n        tmp = SDPUtil.parseFingerprint(line);\r\n        tmp.xmlns = 'urn:xmpp:jingle:apps:dtls:0';\r\n        elem.c('fingerprint').t(tmp.fingerprint);\r\n        delete tmp.fingerprint;\r\n\r\n        // eslint-disable-next-line no-param-reassign\r\n        line\r\n            = SDPUtil.findLine(\r\n                self.media[mediaindex],\r\n                'a=setup:',\r\n                self.session);\r\n        if (line) {\r\n            tmp.setup = line.substr(8);\r\n        }\r\n        elem.attrs(tmp);\r\n        elem.up(); // end of fingerprint\r\n    });\r\n    tmp = SDPUtil.iceparams(this.media[mediaindex], this.session);\r\n    if (tmp) {\r\n        tmp.xmlns = 'urn:xmpp:jingle:transports:ice-udp:1';\r\n        elem.attrs(tmp);\r\n\r\n        // XEP-0176\r\n        const lines\r\n            = SDPUtil.findLines(\r\n                this.media[mediaindex],\r\n                'a=candidate:',\r\n                this.session);\r\n\r\n        if (lines.length) { // add any a=candidate lines\r\n            lines.forEach(line => {\r\n                const candidate = SDPUtil.candidateToJingle(line);\r\n\r\n                if (self.failICE) {\r\n                    candidate.ip = '1.1.1.1';\r\n                }\r\n                const protocol\r\n                    = candidate && typeof candidate.protocol === 'string'\r\n                        ? candidate.protocol.toLowerCase()\r\n                        : '';\r\n\r\n                if ((self.removeTcpCandidates\r\n                        && (protocol === 'tcp' || protocol === 'ssltcp'))\r\n                    || (self.removeUdpCandidates && protocol === 'udp')) {\r\n                    return;\r\n                }\r\n                elem.c('candidate', candidate).up();\r\n            });\r\n        }\r\n    }\r\n    elem.up(); // end of transport\r\n};\r\n\r\n// XEP-0293\r\nSDP.prototype.rtcpFbToJingle = function(mediaindex, elem, payloadtype) {\r\n    const lines\r\n        = SDPUtil.findLines(\r\n            this.media[mediaindex],\r\n            `a=rtcp-fb:${payloadtype}`);\r\n\r\n    lines.forEach(line => {\r\n        const tmp = SDPUtil.parseRTCPFB(line);\r\n\r\n        if (tmp.type === 'trr-int') {\r\n            elem.c('rtcp-fb-trr-int', {\r\n                xmlns: 'urn:xmpp:jingle:apps:rtp:rtcp-fb:0',\r\n                value: tmp.params[0]\r\n            });\r\n            elem.up();\r\n        } else {\r\n            elem.c('rtcp-fb', {\r\n                xmlns: 'urn:xmpp:jingle:apps:rtp:rtcp-fb:0',\r\n                type: tmp.type\r\n            });\r\n            if (tmp.params.length > 0) {\r\n                elem.attrs({ 'subtype': tmp.params[0] });\r\n            }\r\n            elem.up();\r\n        }\r\n    });\r\n};\r\n\r\nSDP.prototype.rtcpFbFromJingle = function(elem, payloadtype) { // XEP-0293\r\n    let media = '';\r\n    let tmp\r\n        = elem.find(\r\n            '>rtcp-fb-trr-int[xmlns=\"urn:xmpp:jingle:apps:rtp:rtcp-fb:0\"]');\r\n\r\n    if (tmp.length) {\r\n        media += 'a=rtcp-fb:* trr-int ';\r\n        if (tmp.attr('value')) {\r\n            media += tmp.attr('value');\r\n        } else {\r\n            media += '0';\r\n        }\r\n        media += '\\r\\n';\r\n    }\r\n    tmp = elem.find('>rtcp-fb[xmlns=\"urn:xmpp:jingle:apps:rtp:rtcp-fb:0\"]');\r\n    tmp.each(function() {\r\n        /* eslint-disable no-invalid-this */\r\n        media += `a=rtcp-fb:${payloadtype} ${$(this).attr('type')}`;\r\n        if ($(this).attr('subtype')) {\r\n            media += ` ${$(this).attr('subtype')}`;\r\n        }\r\n        media += '\\r\\n';\r\n\r\n        /* eslint-enable no-invalid-this */\r\n    });\r\n\r\n    return media;\r\n};\r\n\r\n// construct an SDP from a jingle stanza\r\nSDP.prototype.fromJingle = function(jingle) {\r\n    const self = this;\r\n\r\n    this.raw = 'v=0\\r\\n'\r\n        + 'o=- 1923518516 2 IN IP4 0.0.0.0\\r\\n'// FIXME\r\n        + 's=-\\r\\n'\r\n        + 't=0 0\\r\\n';\r\n\r\n    // http://tools.ietf.org/html/draft-ietf-mmusic-sdp-bundle-negotiation-04\r\n    // #section-8\r\n    const groups\r\n        = $(jingle).find('>group[xmlns=\"urn:xmpp:jingle:apps:grouping:0\"]');\r\n\r\n    if (groups.length) {\r\n        groups.each((idx, group) => {\r\n            const contents\r\n                = $(group)\r\n                    .find('>content')\r\n                    .map((_, content) => content.getAttribute('name'))\r\n                    .get();\r\n\r\n            if (contents.length > 0) {\r\n                self.raw\r\n                    += `a=group:${\r\n                        group.getAttribute('semantics')\r\n                            || group.getAttribute('type')} ${\r\n                        contents.join(' ')}\\r\\n`;\r\n            }\r\n        });\r\n    }\r\n\r\n    this.session = this.raw;\r\n    jingle.find('>content').each(function() {\r\n        // eslint-disable-next-line no-invalid-this\r\n        const m = self.jingle2media($(this));\r\n\r\n        self.media.push(m);\r\n    });\r\n\r\n    // reconstruct msid-semantic -- apparently not necessary\r\n    /*\r\n     var msid = SDPUtil.parseSSRC(this.raw);\r\n     if (msid.hasOwnProperty('mslabel')) {\r\n     this.session += \"a=msid-semantic: WMS \" + msid.mslabel + \"\\r\\n\";\r\n     }\r\n     */\r\n\r\n    this.raw = this.session + this.media.join('');\r\n};\r\n\r\n// translate a jingle content element into an an SDP media part\r\nSDP.prototype.jingle2media = function(content) {\r\n    const desc = content.find('description');\r\n    let media = '';\r\n    const self = this;\r\n    const sctp = content.find(\r\n        '>transport>sctpmap[xmlns=\"urn:xmpp:jingle:transports:dtls-sctp:1\"]');\r\n\r\n    let tmp = { media: desc.attr('media') };\r\n\r\n    tmp.port = '1';\r\n    if (content.attr('senders') === 'rejected') {\r\n        // estos hack to reject an m-line.\r\n        tmp.port = '0';\r\n    }\r\n    if (content.find('>transport>fingerprint').length\r\n            || desc.find('encryption').length) {\r\n        tmp.proto = sctp.length ? 'DTLS/SCTP' : 'RTP/SAVPF';\r\n    } else {\r\n        tmp.proto = 'RTP/AVPF';\r\n    }\r\n    if (sctp.length) {\r\n        media += `m=application 1 DTLS/SCTP ${sctp.attr('number')}\\r\\n`;\r\n        media += `a=sctpmap:${sctp.attr('number')} ${sctp.attr('protocol')}`;\r\n\r\n        const streamCount = sctp.attr('streams');\r\n\r\n        if (streamCount) {\r\n            media += ` ${streamCount}\\r\\n`;\r\n        } else {\r\n            media += '\\r\\n';\r\n        }\r\n    } else {\r\n        tmp.fmt\r\n            = desc\r\n                .find('payload-type')\r\n                .map(function() {\r\n                    // eslint-disable-next-line no-invalid-this\r\n                    return this.getAttribute('id');\r\n                })\r\n                .get();\r\n        media += `${SDPUtil.buildMLine(tmp)}\\r\\n`;\r\n    }\r\n\r\n    media += 'c=IN IP4 0.0.0.0\\r\\n';\r\n    if (!sctp.length) {\r\n        media += 'a=rtcp:1 IN IP4 0.0.0.0\\r\\n';\r\n    }\r\n    tmp\r\n        = content.find(\r\n            '>transport[xmlns=\"urn:xmpp:jingle:transports:ice-udp:1\"]');\r\n    if (tmp.length) {\r\n        if (tmp.attr('ufrag')) {\r\n            media += `${SDPUtil.buildICEUfrag(tmp.attr('ufrag'))}\\r\\n`;\r\n        }\r\n        if (tmp.attr('pwd')) {\r\n            media += `${SDPUtil.buildICEPwd(tmp.attr('pwd'))}\\r\\n`;\r\n        }\r\n        tmp.find('>fingerprint').each(function() {\r\n            /* eslint-disable no-invalid-this */\r\n            // FIXME: check namespace at some point\r\n            media += `a=fingerprint:${this.getAttribute('hash')}`;\r\n            media += ` ${$(this).text()}`;\r\n            media += '\\r\\n';\r\n            if (this.getAttribute('setup')) {\r\n                media += `a=setup:${this.getAttribute('setup')}\\r\\n`;\r\n            }\r\n\r\n            /* eslint-enable no-invalid-this */\r\n        });\r\n    }\r\n    switch (content.attr('senders')) {\r\n    case 'initiator':\r\n        media += 'a=sendonly\\r\\n';\r\n        break;\r\n    case 'responder':\r\n        media += 'a=recvonly\\r\\n';\r\n        break;\r\n    case 'none':\r\n        media += 'a=inactive\\r\\n';\r\n        break;\r\n    case 'both':\r\n        media += 'a=sendrecv\\r\\n';\r\n        break;\r\n    }\r\n    media += `a=mid:${content.attr('name')}\\r\\n`;\r\n\r\n    // <description><rtcp-mux/></description>\r\n    // see http://code.google.com/p/libjingle/issues/detail?id=309 -- no spec\r\n    // though\r\n    // and http://mail.jabber.org/pipermail/jingle/2011-December/001761.html\r\n    if (desc.find('rtcp-mux').length) {\r\n        media += 'a=rtcp-mux\\r\\n';\r\n    }\r\n\r\n    if (desc.find('encryption').length) {\r\n        desc.find('encryption>crypto').each(function() {\r\n            /* eslint-disable no-invalid-this */\r\n            media += `a=crypto:${this.getAttribute('tag')}`;\r\n            media += ` ${this.getAttribute('crypto-suite')}`;\r\n            media += ` ${this.getAttribute('key-params')}`;\r\n            if (this.getAttribute('session-params')) {\r\n                media += ` ${this.getAttribute('session-params')}`;\r\n            }\r\n            media += '\\r\\n';\r\n\r\n            /* eslint-enable no-invalid-this */\r\n        });\r\n    }\r\n    desc.find('payload-type').each(function() {\r\n        /* eslint-disable no-invalid-this */\r\n        media += `${SDPUtil.buildRTPMap(this)}\\r\\n`;\r\n        if ($(this).find('>parameter').length) {\r\n            media += `a=fmtp:${this.getAttribute('id')} `;\r\n            media\r\n                += $(this)\r\n                    .find('parameter')\r\n                    .map(function() {\r\n                        const name = this.getAttribute('name');\r\n\r\n                        return (\r\n                            (name ? `${name}=` : '')\r\n                                + this.getAttribute('value'));\r\n                    })\r\n                    .get()\r\n                    .join('; ');\r\n            media += '\\r\\n';\r\n        }\r\n\r\n        // xep-0293\r\n        media += self.rtcpFbFromJingle($(this), this.getAttribute('id'));\r\n\r\n        /* eslint-enable no-invalid-this */\r\n    });\r\n\r\n    // xep-0293\r\n    media += self.rtcpFbFromJingle(desc, '*');\r\n\r\n    // xep-0294\r\n    tmp\r\n        = desc.find(\r\n            '>rtp-hdrext[xmlns=\"urn:xmpp:jingle:apps:rtp:rtp-hdrext:0\"]');\r\n    tmp.each(function() {\r\n        /* eslint-disable no-invalid-this */\r\n        media\r\n            += `a=extmap:${this.getAttribute('id')} ${\r\n                this.getAttribute('uri')}\\r\\n`;\r\n\r\n        /* eslint-enable no-invalid-this */\r\n    });\r\n\r\n    content\r\n        .find(\r\n            '>transport[xmlns=\"urn:xmpp:jingle:transports:ice-udp:1\"]'\r\n                + '>candidate')\r\n        .each(function() {\r\n            /* eslint-disable no-invalid-this */\r\n            let protocol = this.getAttribute('protocol');\r\n\r\n            protocol\r\n                = typeof protocol === 'string' ? protocol.toLowerCase() : '';\r\n\r\n            if ((self.removeTcpCandidates\r\n                    && (protocol === 'tcp' || protocol === 'ssltcp'))\r\n                || (self.removeUdpCandidates && protocol === 'udp')) {\r\n                return;\r\n            } else if (self.failICE) {\r\n                this.setAttribute('ip', '1.1.1.1');\r\n            }\r\n\r\n            media += SDPUtil.candidateFromJingle(this);\r\n\r\n            /* eslint-enable no-invalid-this */\r\n        });\r\n\r\n    // XEP-0339 handle ssrc-group attributes\r\n    content\r\n        .find('description>ssrc-group[xmlns=\"urn:xmpp:jingle:apps:rtp:ssma:0\"]')\r\n        .each(function() {\r\n            /* eslint-disable no-invalid-this */\r\n            const semantics = this.getAttribute('semantics');\r\n            const ssrcs\r\n                = $(this)\r\n                    .find('>source')\r\n                    .map(function() {\r\n                        return this.getAttribute('ssrc');\r\n                    })\r\n                    .get();\r\n\r\n            if (ssrcs.length) {\r\n                media += `a=ssrc-group:${semantics} ${ssrcs.join(' ')}\\r\\n`;\r\n            }\r\n\r\n            /* eslint-enable no-invalid-this */\r\n        });\r\n\r\n    tmp\r\n        = content.find(\r\n            'description>source[xmlns=\"urn:xmpp:jingle:apps:rtp:ssma:0\"]');\r\n    tmp.each(function() {\r\n        /* eslint-disable no-invalid-this */\r\n        const ssrc = this.getAttribute('ssrc');\r\n\r\n        // eslint-disable-next-line newline-per-chained-call\r\n        $(this).find('>parameter').each(function() {\r\n            const name = this.getAttribute('name');\r\n            let value = this.getAttribute('value');\r\n\r\n            value = SDPUtil.filterSpecialChars(value);\r\n            media += `a=ssrc:${ssrc} ${name}`;\r\n            if (value && value.length) {\r\n                media += `:${value}`;\r\n            }\r\n            media += '\\r\\n';\r\n        });\r\n\r\n        /* eslint-enable no-invalid-this */\r\n    });\r\n\r\n    return media;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/xmpp/SDP.js","/**\r\n * Event triggered when participant's muted status changes.\r\n * @param {string} endpointId the track owner's identifier (MUC nickname)\r\n * @param {MediaType} mediaType \"audio\" or \"video\"\r\n * @param {boolean} isMuted the new muted state\r\n */\r\nexport const PEER_MUTED_CHANGED = 'signaling.peerMuted';\r\n\r\n/**\r\n * Event triggered when participant's video type changes.\r\n * @param {string} endpointId the video owner's ID (MUC nickname)\r\n * @param {VideoType} videoType the new value\r\n */\r\nexport const PEER_VIDEO_TYPE_CHANGED = 'signaling.peerVideoType';\r\n\n\n\n// WEBPACK FOOTER //\n// ./service/RTC/SignalingEvents.js","/* global __filename, module */\r\nimport EventEmitter from 'events';\r\nimport { getLogger } from 'jitsi-meet-logger';\r\nimport * as JitsiTrackEvents from '../../JitsiTrackEvents';\r\nimport * as MediaType from '../../service/RTC/MediaType';\r\nimport RTCUtils from './RTCUtils';\r\n\r\nconst logger = getLogger(__filename);\r\n\r\n/**\r\n * Maps our handler types to MediaStreamTrack properties.\r\n */\r\nconst trackHandler2Prop = {\r\n    'track_mute': 'onmute', // Not supported on FF\r\n    'track_unmute': 'onunmute',\r\n    'track_ended': 'onended'\r\n};\r\n\r\n/**\r\n * Adds onended/oninactive handler to a MediaStream.\r\n * @param mediaStream a MediaStream to attach onended/oninactive handler\r\n * @param handler the handler\r\n */\r\nfunction addMediaStreamInactiveHandler(mediaStream, handler) {\r\n    // Temasys will use onended\r\n    if (typeof mediaStream.active === 'undefined') {\r\n        mediaStream.onended = handler;\r\n    } else {\r\n        mediaStream.oninactive = handler;\r\n    }\r\n}\r\n\r\n/**\r\n * Represents a single media track (either audio or video).\r\n */\r\nexport default class JitsiTrack extends EventEmitter {\r\n    /* eslint-disable max-params */\r\n    /**\r\n     * Represents a single media track (either audio or video).\r\n     * @constructor\r\n     * @param conference the rtc instance\r\n     * @param stream the WebRTC MediaStream instance\r\n     * @param track the WebRTC MediaStreamTrack instance, must be part of\r\n     * the given <tt>stream</tt>.\r\n     * @param streamInactiveHandler the function that will handle\r\n     *        onended/oninactive events of the stream.\r\n     * @param trackMediaType the media type of the JitsiTrack\r\n     * @param videoType the VideoType for this track if any\r\n     */\r\n    constructor(\r\n            conference,\r\n            stream,\r\n            track,\r\n            streamInactiveHandler,\r\n            trackMediaType,\r\n            videoType) {\r\n        super();\r\n\r\n        // aliases for addListener/removeListener\r\n        this.addEventListener = this.addListener;\r\n        this.removeEventListener = this.off = this.removeListener;\r\n\r\n        /**\r\n         * Array with the HTML elements that are displaying the streams.\r\n         * @type {Array}\r\n         */\r\n        this.containers = [];\r\n        this.conference = conference;\r\n        this.audioLevel = -1;\r\n        this.type = trackMediaType;\r\n        this.track = track;\r\n        this.videoType = videoType;\r\n        this.handlers = new Map();\r\n\r\n        /**\r\n         * Indicates whether this JitsiTrack has been disposed. If true, this\r\n         * JitsiTrack is to be considered unusable and operations involving it\r\n         * are to fail (e.g. {@link JitsiConference#addTrack(JitsiTrack)},\r\n         * {@link JitsiConference#removeTrack(JitsiTrack)}).\r\n         * @type {boolean}\r\n         */\r\n        this.disposed = false;\r\n\r\n        /**\r\n         * The inactive handler which will be triggered when the underlying\r\n         * <tt>MediaStream</tt> ends.\r\n         *\r\n         * @private\r\n         * @type {Function}\r\n         */\r\n        this._streamInactiveHandler = streamInactiveHandler;\r\n\r\n        this._setStream(stream);\r\n    }\r\n\r\n    /* eslint-enable max-params */\r\n\r\n    /**\r\n     * Sets handler to the WebRTC MediaStream or MediaStreamTrack object\r\n     * depending on the passed type.\r\n     * @param {string} type the type of the handler that is going to be set\r\n     * @param {Function} handler the handler.\r\n     */\r\n    _setHandler(type, handler) {\r\n        if (!trackHandler2Prop.hasOwnProperty(type)) {\r\n            logger.error(`Invalid handler type ${type}`);\r\n\r\n            return;\r\n        }\r\n        if (handler) {\r\n            this.handlers.set(type, handler);\r\n        } else {\r\n            this.handlers.delete(type);\r\n        }\r\n\r\n        if (this.stream) {\r\n            // FIXME Why only video tracks?\r\n            for (const track of this.stream.getVideoTracks()) {\r\n                track[trackHandler2Prop[type]] = handler;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Unregisters all event handlers bound to the underlying media stream/track\r\n     * @private\r\n     */\r\n    _unregisterHandlers() {\r\n        if (!this.stream) {\r\n            logger.warn(\r\n                `${this}: unable to unregister handlers - no stream object`);\r\n\r\n            return;\r\n        }\r\n\r\n        for (const type of this.handlers.keys()) {\r\n            // FIXME Why only video tracks?\r\n            for (const videoTrack of this.stream.getVideoTracks()) {\r\n                videoTrack[trackHandler2Prop[type]] = undefined;\r\n            }\r\n        }\r\n        if (this._streamInactiveHandler) {\r\n            addMediaStreamInactiveHandler(this.stream, undefined);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Sets the stream property of JitsiTrack object and sets all stored\r\n     * handlers to it.\r\n     *\r\n     * @param {MediaStream} stream the new stream.\r\n     * @protected\r\n     */\r\n    _setStream(stream) {\r\n        if (this.stream === stream) {\r\n            return;\r\n        }\r\n\r\n        this.stream = stream;\r\n\r\n        // TODO Practically, that's like the opposite of _unregisterHandlers\r\n        // i.e. may be abstracted into a function/method called\r\n        // _registerHandlers for clarity and easing the maintenance of the two\r\n        // pieces of source code.\r\n        if (this.stream) {\r\n            for (const type of this.handlers.keys()) {\r\n                this._setHandler(type, this.handlers.get(type));\r\n            }\r\n            if (this._streamInactiveHandler) {\r\n                addMediaStreamInactiveHandler(\r\n                    this.stream, this._streamInactiveHandler);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns the type (audio or video) of this track.\r\n     */\r\n    getType() {\r\n        return this.type;\r\n    }\r\n\r\n    /**\r\n     * Check if this is an audio track.\r\n     */\r\n    isAudioTrack() {\r\n        return this.getType() === MediaType.AUDIO;\r\n    }\r\n\r\n    /**\r\n     * Checks whether the underlying WebRTC <tt>MediaStreamTrack</tt> is muted\r\n     * according to it's 'muted' field status.\r\n     * @return {boolean} <tt>true</tt> if the underlying\r\n     * <tt>MediaStreamTrack</tt> is muted or <tt>false</tt> otherwise.\r\n     */\r\n    isWebRTCTrackMuted() {\r\n        return this.track && this.track.muted;\r\n    }\r\n\r\n    /**\r\n     * Check if this is a video track.\r\n     */\r\n    isVideoTrack() {\r\n        return this.getType() === MediaType.VIDEO;\r\n    }\r\n\r\n    /**\r\n     * Checks whether this is a local track.\r\n     * @abstract\r\n     * @return {boolean} 'true' if it's a local track or 'false' otherwise.\r\n     */\r\n    isLocal() {\r\n        throw new Error('Not implemented by subclass');\r\n    }\r\n\r\n    /**\r\n     * Returns the WebRTC MediaStream instance.\r\n     */\r\n    getOriginalStream() {\r\n        return this.stream;\r\n    }\r\n\r\n    /**\r\n     * Returns the ID of the underlying WebRTC Media Stream(if any)\r\n     * @returns {String|null}\r\n     */\r\n    getStreamId() {\r\n        return this.stream ? this.stream.id : null;\r\n    }\r\n\r\n    /**\r\n     * Return the underlying WebRTC MediaStreamTrack\r\n     * @returns {MediaStreamTrack}\r\n     */\r\n    getTrack() {\r\n        return this.track;\r\n    }\r\n\r\n    /**\r\n     * Returns the ID of the underlying WebRTC MediaStreamTrack(if any)\r\n     * @returns {String|null}\r\n     */\r\n    getTrackId() {\r\n        return this.track ? this.track.id : null;\r\n    }\r\n\r\n    /**\r\n     * Return meaningful usage label for this track depending on it's media and\r\n     * eventual video type.\r\n     * @returns {string}\r\n     */\r\n    getUsageLabel() {\r\n        if (this.isAudioTrack()) {\r\n            return 'mic';\r\n        }\r\n\r\n        return this.videoType ? this.videoType : 'default';\r\n    }\r\n\r\n    /**\r\n     * Eventually will trigger RTCEvents.TRACK_ATTACHED event.\r\n     * @param container the video/audio container to which this stream is\r\n     *        attached and for which event will be fired.\r\n     * @private\r\n     */\r\n    _maybeFireTrackAttached(container) {\r\n        if (this.conference && container) {\r\n            this.conference._onTrackAttach(this, container);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Attaches the MediaStream of this track to an HTML container.\r\n     * Adds the container to the list of containers that are displaying the\r\n     * track. Note that Temasys plugin will replace original audio/video element\r\n     * with 'object' when stream is being attached to the container for the\r\n     * first time.\r\n     * * NOTE * if given container element is not visible when the stream is\r\n     * being attached it will be shown back given that Temasys plugin is\r\n     * currently in use.\r\n     *\r\n     * @param container the HTML container which can be 'video' or 'audio'\r\n     * element. It can also be 'object' element if Temasys plugin is in use and\r\n     * this method has been called previously on video or audio HTML element.\r\n     *\r\n     * @returns potentially new instance of container if it was replaced by the\r\n     *          library. That's the case when Temasys plugin is in use.\r\n     */\r\n    attach(container) {\r\n        let c = container;\r\n\r\n        if (this.stream) {\r\n            c = RTCUtils.attachMediaStream(container, this.stream);\r\n        }\r\n        this.containers.push(c);\r\n        this._maybeFireTrackAttached(c);\r\n        this._attachTTFMTracker(c);\r\n\r\n        return c;\r\n    }\r\n\r\n    /**\r\n     * Removes this JitsiTrack from the passed HTML container.\r\n     *\r\n     * @param container the HTML container to detach from this JitsiTrack. If\r\n     * <tt>null</tt> or <tt>undefined</tt>, all containers are removed. A\r\n     * container can be a 'video', 'audio' or 'object' HTML element instance to\r\n     * which this JitsiTrack is currently attached.\r\n     */\r\n    detach(container) {\r\n        for (let cs = this.containers, i = cs.length - 1; i >= 0; --i) {\r\n            const c = cs[i];\r\n\r\n            if (!container) {\r\n                RTCUtils.attachMediaStream(c, null);\r\n            }\r\n            if (!container || c === container) {\r\n                cs.splice(i, 1);\r\n            }\r\n        }\r\n\r\n        if (container) {\r\n            RTCUtils.attachMediaStream(container, null);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Attach time to first media tracker only if there is conference and only\r\n     * for the first element.\r\n     *\r\n     * @param {HTMLElement} container the HTML container which can be 'video' or\r\n     * 'audio' element. It can also be 'object' element if Temasys plugin is in\r\n     * use and this method has been called previously on video or audio HTML\r\n     * element.\r\n     * @private\r\n     */\r\n    _attachTTFMTracker(container) { // eslint-disable-line no-unused-vars\r\n        // Should be defined by the classes that are extending JitsiTrack\r\n    }\r\n\r\n    /**\r\n     * Removes attached event listeners.\r\n     *\r\n     * @returns {Promise}\r\n     */\r\n    dispose() {\r\n        this.removeAllListeners();\r\n\r\n        this.disposed = true;\r\n\r\n        return Promise.resolve();\r\n    }\r\n\r\n    /**\r\n     * Returns true if this is a video track and the source of the video is a\r\n     * screen capture as opposed to a camera.\r\n     */\r\n    isScreenSharing() {\r\n        // FIXME: Should be fixed or removed.\r\n    }\r\n\r\n    /**\r\n     * Returns id of the track.\r\n     * @returns {string|null} id of the track or null if this is fake track.\r\n     */\r\n    getId() {\r\n        if (this.stream) {\r\n            return RTCUtils.getStreamID(this.stream);\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Checks whether the MediaStream is active/not ended.\r\n     * When there is no check for active we don't have information and so\r\n     * will return that stream is active (in case of FF).\r\n     * @returns {boolean} whether MediaStream is active.\r\n     */\r\n    isActive() {\r\n        if (typeof this.stream.active !== 'undefined') {\r\n            return this.stream.active;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Sets the audio level for the stream\r\n     * @param {number} audioLevel value between 0 and 1\r\n     * @param {TraceablePeerConnection} [tpc] the peerconnection instance which\r\n     * is source for the audio level. It can be <tt>undefined</tt> for\r\n     * a local track if the audio level was measured outside of the\r\n     * peerconnection (see /modules/statistics/LocalStatsCollector.js).\r\n     */\r\n    setAudioLevel(audioLevel, tpc) {\r\n        if (this.audioLevel !== audioLevel) {\r\n            this.audioLevel = audioLevel;\r\n            this.emit(\r\n                JitsiTrackEvents.TRACK_AUDIO_LEVEL_CHANGED,\r\n                audioLevel,\r\n                tpc);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns the msid of the stream attached to the JitsiTrack object or null\r\n     * if no stream is attached.\r\n     */\r\n    getMSID() {\r\n        const streamId = this.getStreamId();\r\n        const trackId = this.getTrackId();\r\n\r\n        return streamId && trackId ? `${streamId} ${trackId}` : null;\r\n    }\r\n\r\n    /**\r\n     * Sets new audio output device for track's DOM elements. Video tracks are\r\n     * ignored.\r\n     * @param {string} audioOutputDeviceId - id of 'audiooutput' device from\r\n     *      navigator.mediaDevices.enumerateDevices(), '' for default device\r\n     * @emits JitsiTrackEvents.TRACK_AUDIO_OUTPUT_CHANGED\r\n     * @returns {Promise}\r\n     */\r\n    setAudioOutput(audioOutputDeviceId) {\r\n        if (!RTCUtils.isDeviceChangeAvailable('output')) {\r\n            return Promise.reject(\r\n                new Error('Audio output device change is not supported'));\r\n        }\r\n\r\n        // All audio communication is done through audio tracks, so ignore\r\n        // changing audio output for video tracks at all.\r\n        if (this.isVideoTrack()) {\r\n            return Promise.resolve();\r\n        }\r\n\r\n        return (\r\n            Promise.all(\r\n                this.containers.map(\r\n                    element =>\r\n                        element.setSinkId(audioOutputDeviceId)\r\n                            .catch(error => {\r\n                                logger.warn(\r\n                                    'Failed to change audio output device on'\r\n                                        + ' element. Default or previously set'\r\n                                        + ' audio output device will be used.',\r\n                                    element,\r\n                                    error);\r\n                                throw error;\r\n                            }))\r\n            )\r\n                .then(() => {\r\n                    this.emit(\r\n                        JitsiTrackEvents.TRACK_AUDIO_OUTPUT_CHANGED,\r\n                        audioOutputDeviceId);\r\n                }));\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/RTC/JitsiTrack.js","/**\r\n * The possible camera facing modes. For now support only 'user' and\r\n * 'environment' because 'left' and 'right' are not used anywhere in our\r\n * projects at the time of this writing. For more information please refer to\r\n * https://w3c.github.io/mediacapture-main/getusermedia.html\r\n * #def-constraint-facingMode.\r\n *\r\n * @enum {string}\r\n */\r\nconst CameraFacingMode = {\r\n    /**\r\n     * The mode which specifies the environment-facing camera.\r\n     */\r\n    ENVIRONMENT: 'environment',\r\n\r\n    /**\r\n     * The mode which specifies the user-facing camera.\r\n     */\r\n    USER: 'user'\r\n};\r\n\r\nmodule.exports = CameraFacingMode;\r\n\n\n\n// WEBPACK FOOTER //\n// ./service/RTC/CameraFacingMode.js","var grammar = module.exports = {\n  v: [{\n    name: 'version',\n    reg: /^(\\d*)$/\n  }],\n  o: [{ //o=- 20518 0 IN IP4 203.0.113.1\n    // NB: sessionId will be a String in most cases because it is huge\n    name: 'origin',\n    reg: /^(\\S*) (\\d*) (\\d*) (\\S*) IP(\\d) (\\S*)/,\n    names: ['username', 'sessionId', 'sessionVersion', 'netType', 'ipVer', 'address'],\n    format: '%s %s %d %s IP%d %s'\n  }],\n  // default parsing of these only (though some of these feel outdated)\n  s: [{ name: 'name' }],\n  i: [{ name: 'description' }],\n  u: [{ name: 'uri' }],\n  e: [{ name: 'email' }],\n  p: [{ name: 'phone' }],\n  z: [{ name: 'timezones' }], // TODO: this one can actually be parsed properly..\n  r: [{ name: 'repeats' }],   // TODO: this one can also be parsed properly\n  //k: [{}], // outdated thing ignored\n  t: [{ //t=0 0\n    name: 'timing',\n    reg: /^(\\d*) (\\d*)/,\n    names: ['start', 'stop'],\n    format: '%d %d'\n  }],\n  c: [{ //c=IN IP4 10.47.197.26\n    name: 'connection',\n    reg: /^IN IP(\\d) (\\S*)/,\n    names: ['version', 'ip'],\n    format: 'IN IP%d %s'\n  }],\n  b: [{ //b=AS:4000\n    push: 'bandwidth',\n    reg: /^(TIAS|AS|CT|RR|RS):(\\d*)/,\n    names: ['type', 'limit'],\n    format: '%s:%s'\n  }],\n  m: [{ //m=video 51744 RTP/AVP 126 97 98 34 31\n    // NB: special - pushes to session\n    // TODO: rtp/fmtp should be filtered by the payloads found here?\n    reg: /^(\\w*) (\\d*) ([\\w\\/]*)(?: (.*))?/,\n    names: ['type', 'port', 'protocol', 'payloads'],\n    format: '%s %d %s %s'\n  }],\n  a: [\n    { //a=rtpmap:110 opus/48000/2\n      push: 'rtp',\n      reg: /^rtpmap:(\\d*) ([\\w\\-\\.]*)(?:\\s*\\/(\\d*)(?:\\s*\\/(\\S*))?)?/,\n      names: ['payload', 'codec', 'rate', 'encoding'],\n      format: function (o) {\n        return (o.encoding) ?\n          'rtpmap:%d %s/%s/%s':\n          o.rate ?\n          'rtpmap:%d %s/%s':\n          'rtpmap:%d %s';\n      }\n    },\n    { //a=fmtp:108 profile-level-id=24;object=23;bitrate=64000\n      //a=fmtp:111 minptime=10; useinbandfec=1\n      push: 'fmtp',\n      reg: /^fmtp:(\\d*) ([\\S| ]*)/,\n      names: ['payload', 'config'],\n      format: 'fmtp:%d %s'\n    },\n    { //a=control:streamid=0\n      name: 'control',\n      reg: /^control:(.*)/,\n      format: 'control:%s'\n    },\n    { //a=rtcp:65179 IN IP4 193.84.77.194\n      name: 'rtcp',\n      reg: /^rtcp:(\\d*)(?: (\\S*) IP(\\d) (\\S*))?/,\n      names: ['port', 'netType', 'ipVer', 'address'],\n      format: function (o) {\n        return (o.address != null) ?\n          'rtcp:%d %s IP%d %s':\n          'rtcp:%d';\n      }\n    },\n    { //a=rtcp-fb:98 trr-int 100\n      push: 'rtcpFbTrrInt',\n      reg: /^rtcp-fb:(\\*|\\d*) trr-int (\\d*)/,\n      names: ['payload', 'value'],\n      format: 'rtcp-fb:%d trr-int %d'\n    },\n    { //a=rtcp-fb:98 nack rpsi\n      push: 'rtcpFb',\n      reg: /^rtcp-fb:(\\*|\\d*) ([\\w-_]*)(?: ([\\w-_]*))?/,\n      names: ['payload', 'type', 'subtype'],\n      format: function (o) {\n        return (o.subtype != null) ?\n          'rtcp-fb:%s %s %s':\n          'rtcp-fb:%s %s';\n      }\n    },\n    { //a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\n      //a=extmap:1/recvonly URI-gps-string\n      push: 'ext',\n      reg: /^extmap:(\\d+)(?:\\/(\\w+))? (\\S*)(?: (\\S*))?/,\n      names: ['value', 'direction', 'uri', 'config'],\n      format: function (o) {\n        return 'extmap:%d' + (o.direction ? '/%s' : '%v') + ' %s' + (o.config ? ' %s' : '');\n      }\n    },\n    { //a=crypto:1 AES_CM_128_HMAC_SHA1_80 inline:PS1uQCVeeCFCanVmcjkpPywjNWhcYD0mXXtxaVBR|2^20|1:32\n      push: 'crypto',\n      reg: /^crypto:(\\d*) ([\\w_]*) (\\S*)(?: (\\S*))?/,\n      names: ['id', 'suite', 'config', 'sessionConfig'],\n      format: function (o) {\n        return (o.sessionConfig != null) ?\n          'crypto:%d %s %s %s':\n          'crypto:%d %s %s';\n      }\n    },\n    { //a=setup:actpass\n      name: 'setup',\n      reg: /^setup:(\\w*)/,\n      format: 'setup:%s'\n    },\n    { //a=mid:1\n      name: 'mid',\n      reg: /^mid:([^\\s]*)/,\n      format: 'mid:%s'\n    },\n    { //a=msid:0c8b064d-d807-43b4-b434-f92a889d8587 98178685-d409-46e0-8e16-7ef0db0db64a\n      name: 'msid',\n      reg: /^msid:(.*)/,\n      format: 'msid:%s'\n    },\n    { //a=ptime:20\n      name: 'ptime',\n      reg: /^ptime:(\\d*)/,\n      format: 'ptime:%d'\n    },\n    { //a=maxptime:60\n      name: 'maxptime',\n      reg: /^maxptime:(\\d*)/,\n      format: 'maxptime:%d'\n    },\n    { //a=sendrecv\n      name: 'direction',\n      reg: /^(sendrecv|recvonly|sendonly|inactive)/\n    },\n    { //a=ice-lite\n      name: 'icelite',\n      reg: /^(ice-lite)/\n    },\n    { //a=ice-ufrag:F7gI\n      name: 'iceUfrag',\n      reg: /^ice-ufrag:(\\S*)/,\n      format: 'ice-ufrag:%s'\n    },\n    { //a=ice-pwd:x9cml/YzichV2+XlhiMu8g\n      name: 'icePwd',\n      reg: /^ice-pwd:(\\S*)/,\n      format: 'ice-pwd:%s'\n    },\n    { //a=fingerprint:SHA-1 00:11:22:33:44:55:66:77:88:99:AA:BB:CC:DD:EE:FF:00:11:22:33\n      name: 'fingerprint',\n      reg: /^fingerprint:(\\S*) (\\S*)/,\n      names: ['type', 'hash'],\n      format: 'fingerprint:%s %s'\n    },\n    { //a=candidate:0 1 UDP 2113667327 203.0.113.1 54400 typ host\n      //a=candidate:1162875081 1 udp 2113937151 192.168.34.75 60017 typ host generation 0 network-id 3 network-cost 10\n      //a=candidate:3289912957 2 udp 1845501695 193.84.77.194 60017 typ srflx raddr 192.168.34.75 rport 60017 generation 0 network-id 3 network-cost 10\n      //a=candidate:229815620 1 tcp 1518280447 192.168.150.19 60017 typ host tcptype active generation 0 network-id 3 network-cost 10\n      //a=candidate:3289912957 2 tcp 1845501695 193.84.77.194 60017 typ srflx raddr 192.168.34.75 rport 60017 tcptype passive generation 0 network-id 3 network-cost 10\n      push:'candidates',\n      reg: /^candidate:(\\S*) (\\d*) (\\S*) (\\d*) (\\S*) (\\d*) typ (\\S*)(?: raddr (\\S*) rport (\\d*))?(?: tcptype (\\S*))?(?: generation (\\d*))?(?: network-id (\\d*))?(?: network-cost (\\d*))?/,\n      names: ['foundation', 'component', 'transport', 'priority', 'ip', 'port', 'type', 'raddr', 'rport', 'tcptype', 'generation', 'network-id', 'network-cost'],\n      format: function (o) {\n        var str = 'candidate:%s %d %s %d %s %d typ %s';\n\n        str += (o.raddr != null) ? ' raddr %s rport %d' : '%v%v';\n\n        // NB: candidate has three optional chunks, so %void middles one if it's missing\n        str += (o.tcptype != null) ? ' tcptype %s' : '%v';\n\n        if (o.generation != null) {\n          str += ' generation %d';\n        }\n\n        str += (o['network-id'] != null) ? ' network-id %d' : '%v';\n        str += (o['network-cost'] != null) ? ' network-cost %d' : '%v';\n        return str;\n      }\n    },\n    { //a=end-of-candidates (keep after the candidates line for readability)\n      name: 'endOfCandidates',\n      reg: /^(end-of-candidates)/\n    },\n    { //a=remote-candidates:1 203.0.113.1 54400 2 203.0.113.1 54401 ...\n      name: 'remoteCandidates',\n      reg: /^remote-candidates:(.*)/,\n      format: 'remote-candidates:%s'\n    },\n    { //a=ice-options:google-ice\n      name: 'iceOptions',\n      reg: /^ice-options:(\\S*)/,\n      format: 'ice-options:%s'\n    },\n    { //a=ssrc:2566107569 cname:t9YU8M1UxTF8Y1A1\n      push: 'ssrcs',\n      reg: /^ssrc:(\\d*) ([\\w_]*)(?::(.*))?/,\n      names: ['id', 'attribute', 'value'],\n      format: function (o) {\n        var str = 'ssrc:%d';\n        if (o.attribute != null) {\n          str += ' %s';\n          if (o.value != null) {\n            str += ':%s';\n          }\n        }\n        return str;\n      }\n    },\n    { //a=ssrc-group:FEC 1 2\n      //a=ssrc-group:FEC-FR 3004364195 1080772241\n      push: 'ssrcGroups',\n      // token-char = %x21 / %x23-27 / %x2A-2B / %x2D-2E / %x30-39 / %x41-5A / %x5E-7E\n      reg: /^ssrc-group:([\\x21\\x23\\x24\\x25\\x26\\x27\\x2A\\x2B\\x2D\\x2E\\w]*) (.*)/,\n      names: ['semantics', 'ssrcs'],\n      format: 'ssrc-group:%s %s'\n    },\n    { //a=msid-semantic: WMS Jvlam5X3SX1OP6pn20zWogvaKJz5Hjf9OnlV\n      name: 'msidSemantic',\n      reg: /^msid-semantic:\\s?(\\w*) (\\S*)/,\n      names: ['semantic', 'token'],\n      format: 'msid-semantic: %s %s' // space after ':' is not accidental\n    },\n    { //a=group:BUNDLE audio video\n      push: 'groups',\n      reg: /^group:(\\w*) (.*)/,\n      names: ['type', 'mids'],\n      format: 'group:%s %s'\n    },\n    { //a=rtcp-mux\n      name: 'rtcpMux',\n      reg: /^(rtcp-mux)/\n    },\n    { //a=rtcp-rsize\n      name: 'rtcpRsize',\n      reg: /^(rtcp-rsize)/\n    },\n    { //a=sctpmap:5000 webrtc-datachannel 1024\n      name: 'sctpmap',\n      reg: /^sctpmap:([\\w_\\/]*) (\\S*)(?: (\\S*))?/,\n      names: ['sctpmapNumber', 'app', 'maxMessageSize'],\n      format: function (o) {\n        return (o.maxMessageSize != null) ?\n          'sctpmap:%s %s %s' :\n          'sctpmap:%s %s';\n      }\n    },\n    { //a=x-google-flag:conference\n      name: 'xGoogleFlag',\n      reg: /^x-google-flag:([^\\s]*)/,\n      format: 'x-google-flag:%s'\n    },\n    { //a=rid:1 send max-width=1280;max-height=720;max-fps=30;depend=0\n      push: 'rids',\n      reg: /^rid:([\\d\\w]+) (\\w+)(?: ([\\S| ]*))?/,\n      names: ['id', 'direction', 'params'],\n      format: function (o) {\n        return (o.params) ? 'rid:%s %s %s' : 'rid:%s %s';\n      }\n    },\n    { //a=imageattr:97 send [x=800,y=640,sar=1.1,q=0.6] [x=480,y=320] recv [x=330,y=250]\n      //a=imageattr:* send [x=800,y=640] recv *\n      //a=imageattr:100 recv [x=320,y=240]\n      push: 'imageattrs',\n      reg: new RegExp(\n        //a=imageattr:97\n        '^imageattr:(\\\\d+|\\\\*)' +\n        //send [x=800,y=640,sar=1.1,q=0.6] [x=480,y=320]\n        '[\\\\s\\\\t]+(send|recv)[\\\\s\\\\t]+(\\\\*|\\\\[\\\\S+\\\\](?:[\\\\s\\\\t]+\\\\[\\\\S+\\\\])*)' +\n        //recv [x=330,y=250]\n        '(?:[\\\\s\\\\t]+(recv|send)[\\\\s\\\\t]+(\\\\*|\\\\[\\\\S+\\\\](?:[\\\\s\\\\t]+\\\\[\\\\S+\\\\])*))?'\n      ),\n      names: ['pt', 'dir1', 'attrs1', 'dir2', 'attrs2'],\n      format: function (o) {\n        return 'imageattr:%s %s %s' + (o.dir2 ? ' %s %s' : '');\n      }\n    },\n    { //a=simulcast:send 1,2,3;~4,~5 recv 6;~7,~8\n      //a=simulcast:recv 1;4,5 send 6;7\n      name: 'simulcast',\n      reg: new RegExp(\n        //a=simulcast:\n        '^simulcast:' +\n        //send 1,2,3;~4,~5\n        '(send|recv) ([a-zA-Z0-9\\\\-_~;,]+)' +\n        //space + recv 6;~7,~8\n        '(?:\\\\s?(send|recv) ([a-zA-Z0-9\\\\-_~;,]+))?' +\n        //end\n        '$'\n      ),\n      names: ['dir1', 'list1', 'dir2', 'list2'],\n      format: function (o) {\n        return 'simulcast:%s %s' + (o.dir2 ? ' %s %s' : '');\n      }\n    },\n    { //Old simulcast draft 03 (implemented by Firefox)\n      //  https://tools.ietf.org/html/draft-ietf-mmusic-sdp-simulcast-03\n      //a=simulcast: recv pt=97;98 send pt=97\n      //a=simulcast: send rid=5;6;7 paused=6,7\n      name: 'simulcast_03',\n      reg: /^simulcast:[\\s\\t]+([\\S+\\s\\t]+)$/,\n      names: ['value'],\n      format: 'simulcast: %s'\n    },\n    {\n      //a=framerate:25\n      //a=framerate:29.97\n      name: 'framerate',\n      reg: /^framerate:(\\d+(?:$|\\.\\d+))/,\n      format: 'framerate:%s'\n    },\n    { // any a= that we don't understand is kepts verbatim on media.invalid\n      push: 'invalid',\n      names: ['value']\n    }\n  ]\n};\n\n// set sensible defaults to avoid polluting the grammar with boring details\nObject.keys(grammar).forEach(function (key) {\n  var objs = grammar[key];\n  objs.forEach(function (obj) {\n    if (!obj.reg) {\n      obj.reg = /(.*)/;\n    }\n    if (!obj.format) {\n      obj.format = '%s';\n    }\n  });\n});\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/sdp-transform/lib/grammar.js"," /* eslint-env node */\n'use strict';\n\n// SDP helpers.\nvar SDPUtils = {};\n\n// Generate an alphanumeric identifier for cname or mids.\n// TODO: use UUIDs instead? https://gist.github.com/jed/982883\nSDPUtils.generateIdentifier = function() {\n  return Math.random().toString(36).substr(2, 10);\n};\n\n// The RTCP CNAME used by all peerconnections from the same JS.\nSDPUtils.localCName = SDPUtils.generateIdentifier();\n\n// Splits SDP into lines, dealing with both CRLF and LF.\nSDPUtils.splitLines = function(blob) {\n  return blob.trim().split('\\n').map(function(line) {\n    return line.trim();\n  });\n};\n// Splits SDP into sessionpart and mediasections. Ensures CRLF.\nSDPUtils.splitSections = function(blob) {\n  var parts = blob.split('\\nm=');\n  return parts.map(function(part, index) {\n    return (index > 0 ? 'm=' + part : part).trim() + '\\r\\n';\n  });\n};\n\n// Returns lines that start with a certain prefix.\nSDPUtils.matchPrefix = function(blob, prefix) {\n  return SDPUtils.splitLines(blob).filter(function(line) {\n    return line.indexOf(prefix) === 0;\n  });\n};\n\n// Parses an ICE candidate line. Sample input:\n// candidate:702786350 2 udp 41819902 8.8.8.8 60769 typ relay raddr 8.8.8.8\n// rport 55996\"\nSDPUtils.parseCandidate = function(line) {\n  var parts;\n  // Parse both variants.\n  if (line.indexOf('a=candidate:') === 0) {\n    parts = line.substring(12).split(' ');\n  } else {\n    parts = line.substring(10).split(' ');\n  }\n\n  var candidate = {\n    foundation: parts[0],\n    component: parseInt(parts[1], 10),\n    protocol: parts[2].toLowerCase(),\n    priority: parseInt(parts[3], 10),\n    ip: parts[4],\n    port: parseInt(parts[5], 10),\n    // skip parts[6] == 'typ'\n    type: parts[7]\n  };\n\n  for (var i = 8; i < parts.length; i += 2) {\n    switch (parts[i]) {\n      case 'raddr':\n        candidate.relatedAddress = parts[i + 1];\n        break;\n      case 'rport':\n        candidate.relatedPort = parseInt(parts[i + 1], 10);\n        break;\n      case 'tcptype':\n        candidate.tcpType = parts[i + 1];\n        break;\n      case 'ufrag':\n        candidate.ufrag = parts[i + 1]; // for backward compability.\n        candidate.usernameFragment = parts[i + 1];\n        break;\n      default: // extension handling, in particular ufrag\n        candidate[parts[i]] = parts[i + 1];\n        break;\n    }\n  }\n  return candidate;\n};\n\n// Translates a candidate object into SDP candidate attribute.\nSDPUtils.writeCandidate = function(candidate) {\n  var sdp = [];\n  sdp.push(candidate.foundation);\n  sdp.push(candidate.component);\n  sdp.push(candidate.protocol.toUpperCase());\n  sdp.push(candidate.priority);\n  sdp.push(candidate.ip);\n  sdp.push(candidate.port);\n\n  var type = candidate.type;\n  sdp.push('typ');\n  sdp.push(type);\n  if (type !== 'host' && candidate.relatedAddress &&\n      candidate.relatedPort) {\n    sdp.push('raddr');\n    sdp.push(candidate.relatedAddress); // was: relAddr\n    sdp.push('rport');\n    sdp.push(candidate.relatedPort); // was: relPort\n  }\n  if (candidate.tcpType && candidate.protocol.toLowerCase() === 'tcp') {\n    sdp.push('tcptype');\n    sdp.push(candidate.tcpType);\n  }\n  if (candidate.ufrag) {\n    sdp.push('ufrag');\n    sdp.push(candidate.ufrag);\n  }\n  return 'candidate:' + sdp.join(' ');\n};\n\n// Parses an ice-options line, returns an array of option tags.\n// a=ice-options:foo bar\nSDPUtils.parseIceOptions = function(line) {\n  return line.substr(14).split(' ');\n}\n\n// Parses an rtpmap line, returns RTCRtpCoddecParameters. Sample input:\n// a=rtpmap:111 opus/48000/2\nSDPUtils.parseRtpMap = function(line) {\n  var parts = line.substr(9).split(' ');\n  var parsed = {\n    payloadType: parseInt(parts.shift(), 10) // was: id\n  };\n\n  parts = parts[0].split('/');\n\n  parsed.name = parts[0];\n  parsed.clockRate = parseInt(parts[1], 10); // was: clockrate\n  // was: channels\n  parsed.numChannels = parts.length === 3 ? parseInt(parts[2], 10) : 1;\n  return parsed;\n};\n\n// Generate an a=rtpmap line from RTCRtpCodecCapability or\n// RTCRtpCodecParameters.\nSDPUtils.writeRtpMap = function(codec) {\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  return 'a=rtpmap:' + pt + ' ' + codec.name + '/' + codec.clockRate +\n      (codec.numChannels !== 1 ? '/' + codec.numChannels : '') + '\\r\\n';\n};\n\n// Parses an a=extmap line (headerextension from RFC 5285). Sample input:\n// a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\n// a=extmap:2/sendonly urn:ietf:params:rtp-hdrext:toffset\nSDPUtils.parseExtmap = function(line) {\n  var parts = line.substr(9).split(' ');\n  return {\n    id: parseInt(parts[0], 10),\n    direction: parts[0].indexOf('/') > 0 ? parts[0].split('/')[1] : 'sendrecv',\n    uri: parts[1]\n  };\n};\n\n// Generates a=extmap line from RTCRtpHeaderExtensionParameters or\n// RTCRtpHeaderExtension.\nSDPUtils.writeExtmap = function(headerExtension) {\n  return 'a=extmap:' + (headerExtension.id || headerExtension.preferredId) +\n      (headerExtension.direction && headerExtension.direction !== 'sendrecv'\n          ? '/' + headerExtension.direction\n          : '') +\n      ' ' + headerExtension.uri + '\\r\\n';\n};\n\n// Parses an ftmp line, returns dictionary. Sample input:\n// a=fmtp:96 vbr=on;cng=on\n// Also deals with vbr=on; cng=on\nSDPUtils.parseFmtp = function(line) {\n  var parsed = {};\n  var kv;\n  var parts = line.substr(line.indexOf(' ') + 1).split(';');\n  for (var j = 0; j < parts.length; j++) {\n    kv = parts[j].trim().split('=');\n    parsed[kv[0].trim()] = kv[1];\n  }\n  return parsed;\n};\n\n// Generates an a=ftmp line from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeFmtp = function(codec) {\n  var line = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.parameters && Object.keys(codec.parameters).length) {\n    var params = [];\n    Object.keys(codec.parameters).forEach(function(param) {\n      params.push(param + '=' + codec.parameters[param]);\n    });\n    line += 'a=fmtp:' + pt + ' ' + params.join(';') + '\\r\\n';\n  }\n  return line;\n};\n\n// Parses an rtcp-fb line, returns RTCPRtcpFeedback object. Sample input:\n// a=rtcp-fb:98 nack rpsi\nSDPUtils.parseRtcpFb = function(line) {\n  var parts = line.substr(line.indexOf(' ') + 1).split(' ');\n  return {\n    type: parts.shift(),\n    parameter: parts.join(' ')\n  };\n};\n// Generate a=rtcp-fb lines from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeRtcpFb = function(codec) {\n  var lines = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.rtcpFeedback && codec.rtcpFeedback.length) {\n    // FIXME: special handling for trr-int?\n    codec.rtcpFeedback.forEach(function(fb) {\n      lines += 'a=rtcp-fb:' + pt + ' ' + fb.type +\n      (fb.parameter && fb.parameter.length ? ' ' + fb.parameter : '') +\n          '\\r\\n';\n    });\n  }\n  return lines;\n};\n\n// Parses an RFC 5576 ssrc media attribute. Sample input:\n// a=ssrc:3735928559 cname:something\nSDPUtils.parseSsrcMedia = function(line) {\n  var sp = line.indexOf(' ');\n  var parts = {\n    ssrc: parseInt(line.substr(7, sp - 7), 10)\n  };\n  var colon = line.indexOf(':', sp);\n  if (colon > -1) {\n    parts.attribute = line.substr(sp + 1, colon - sp - 1);\n    parts.value = line.substr(colon + 1);\n  } else {\n    parts.attribute = line.substr(sp + 1);\n  }\n  return parts;\n};\n\n// Extracts the MID (RFC 5888) from a media section.\n// returns the MID or undefined if no mid line was found.\nSDPUtils.getMid = function(mediaSection) {\n  var mid = SDPUtils.matchPrefix(mediaSection, 'a=mid:')[0];\n  if (mid) {\n    return mid.substr(6);\n  }\n}\n\nSDPUtils.parseFingerprint = function(line) {\n  var parts = line.substr(14).split(' ');\n  return {\n    algorithm: parts[0].toLowerCase(), // algorithm is case-sensitive in Edge.\n    value: parts[1]\n  };\n};\n\n// Extracts DTLS parameters from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the fingerprint line as input. See also getIceParameters.\nSDPUtils.getDtlsParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n      'a=fingerprint:');\n  // Note: a=setup line is ignored since we use the 'auto' role.\n  // Note2: 'algorithm' is not case sensitive except in Edge.\n  return {\n    role: 'auto',\n    fingerprints: lines.map(SDPUtils.parseFingerprint)\n  };\n};\n\n// Serializes DTLS parameters to SDP.\nSDPUtils.writeDtlsParameters = function(params, setupType) {\n  var sdp = 'a=setup:' + setupType + '\\r\\n';\n  params.fingerprints.forEach(function(fp) {\n    sdp += 'a=fingerprint:' + fp.algorithm + ' ' + fp.value + '\\r\\n';\n  });\n  return sdp;\n};\n// Parses ICE information from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the ice-ufrag and ice-pwd lines as input.\nSDPUtils.getIceParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  // Search in session part, too.\n  lines = lines.concat(SDPUtils.splitLines(sessionpart));\n  var iceParameters = {\n    usernameFragment: lines.filter(function(line) {\n      return line.indexOf('a=ice-ufrag:') === 0;\n    })[0].substr(12),\n    password: lines.filter(function(line) {\n      return line.indexOf('a=ice-pwd:') === 0;\n    })[0].substr(10)\n  };\n  return iceParameters;\n};\n\n// Serializes ICE parameters to SDP.\nSDPUtils.writeIceParameters = function(params) {\n  return 'a=ice-ufrag:' + params.usernameFragment + '\\r\\n' +\n      'a=ice-pwd:' + params.password + '\\r\\n';\n};\n\n// Parses the SDP media section and returns RTCRtpParameters.\nSDPUtils.parseRtpParameters = function(mediaSection) {\n  var description = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: [],\n    rtcp: []\n  };\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  for (var i = 3; i < mline.length; i++) { // find all codecs from mline[3..]\n    var pt = mline[i];\n    var rtpmapline = SDPUtils.matchPrefix(\n        mediaSection, 'a=rtpmap:' + pt + ' ')[0];\n    if (rtpmapline) {\n      var codec = SDPUtils.parseRtpMap(rtpmapline);\n      var fmtps = SDPUtils.matchPrefix(\n          mediaSection, 'a=fmtp:' + pt + ' ');\n      // Only the first a=fmtp:<pt> is considered.\n      codec.parameters = fmtps.length ? SDPUtils.parseFmtp(fmtps[0]) : {};\n      codec.rtcpFeedback = SDPUtils.matchPrefix(\n          mediaSection, 'a=rtcp-fb:' + pt + ' ')\n        .map(SDPUtils.parseRtcpFb);\n      description.codecs.push(codec);\n      // parse FEC mechanisms from rtpmap lines.\n      switch (codec.name.toUpperCase()) {\n        case 'RED':\n        case 'ULPFEC':\n          description.fecMechanisms.push(codec.name.toUpperCase());\n          break;\n        default: // only RED and ULPFEC are recognized as FEC mechanisms.\n          break;\n      }\n    }\n  }\n  SDPUtils.matchPrefix(mediaSection, 'a=extmap:').forEach(function(line) {\n    description.headerExtensions.push(SDPUtils.parseExtmap(line));\n  });\n  // FIXME: parse rtcp.\n  return description;\n};\n\n// Generates parts of the SDP media section describing the capabilities /\n// parameters.\nSDPUtils.writeRtpDescription = function(kind, caps) {\n  var sdp = '';\n\n  // Build the mline.\n  sdp += 'm=' + kind + ' ';\n  sdp += caps.codecs.length > 0 ? '9' : '0'; // reject if no codecs.\n  sdp += ' UDP/TLS/RTP/SAVPF ';\n  sdp += caps.codecs.map(function(codec) {\n    if (codec.preferredPayloadType !== undefined) {\n      return codec.preferredPayloadType;\n    }\n    return codec.payloadType;\n  }).join(' ') + '\\r\\n';\n\n  sdp += 'c=IN IP4 0.0.0.0\\r\\n';\n  sdp += 'a=rtcp:9 IN IP4 0.0.0.0\\r\\n';\n\n  // Add a=rtpmap lines for each codec. Also fmtp and rtcp-fb.\n  caps.codecs.forEach(function(codec) {\n    sdp += SDPUtils.writeRtpMap(codec);\n    sdp += SDPUtils.writeFmtp(codec);\n    sdp += SDPUtils.writeRtcpFb(codec);\n  });\n  var maxptime = 0;\n  caps.codecs.forEach(function(codec) {\n    if (codec.maxptime > maxptime) {\n      maxptime = codec.maxptime;\n    }\n  });\n  if (maxptime > 0) {\n    sdp += 'a=maxptime:' + maxptime + '\\r\\n';\n  }\n  sdp += 'a=rtcp-mux\\r\\n';\n\n  caps.headerExtensions.forEach(function(extension) {\n    sdp += SDPUtils.writeExtmap(extension);\n  });\n  // FIXME: write fecMechanisms.\n  return sdp;\n};\n\n// Parses the SDP media section and returns an array of\n// RTCRtpEncodingParameters.\nSDPUtils.parseRtpEncodingParameters = function(mediaSection) {\n  var encodingParameters = [];\n  var description = SDPUtils.parseRtpParameters(mediaSection);\n  var hasRed = description.fecMechanisms.indexOf('RED') !== -1;\n  var hasUlpfec = description.fecMechanisms.indexOf('ULPFEC') !== -1;\n\n  // filter a=ssrc:... cname:, ignore PlanB-msid\n  var ssrcs = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n  .map(function(line) {\n    return SDPUtils.parseSsrcMedia(line);\n  })\n  .filter(function(parts) {\n    return parts.attribute === 'cname';\n  });\n  var primarySsrc = ssrcs.length > 0 && ssrcs[0].ssrc;\n  var secondarySsrc;\n\n  var flows = SDPUtils.matchPrefix(mediaSection, 'a=ssrc-group:FID')\n  .map(function(line) {\n    var parts = line.split(' ');\n    parts.shift();\n    return parts.map(function(part) {\n      return parseInt(part, 10);\n    });\n  });\n  if (flows.length > 0 && flows[0].length > 1 && flows[0][0] === primarySsrc) {\n    secondarySsrc = flows[0][1];\n  }\n\n  description.codecs.forEach(function(codec) {\n    if (codec.name.toUpperCase() === 'RTX' && codec.parameters.apt) {\n      var encParam = {\n        ssrc: primarySsrc,\n        codecPayloadType: parseInt(codec.parameters.apt, 10),\n        rtx: {\n          ssrc: secondarySsrc\n        }\n      };\n      encodingParameters.push(encParam);\n      if (hasRed) {\n        encParam = JSON.parse(JSON.stringify(encParam));\n        encParam.fec = {\n          ssrc: secondarySsrc,\n          mechanism: hasUlpfec ? 'red+ulpfec' : 'red'\n        };\n        encodingParameters.push(encParam);\n      }\n    }\n  });\n  if (encodingParameters.length === 0 && primarySsrc) {\n    encodingParameters.push({\n      ssrc: primarySsrc\n    });\n  }\n\n  // we support both b=AS and b=TIAS but interpret AS as TIAS.\n  var bandwidth = SDPUtils.matchPrefix(mediaSection, 'b=');\n  if (bandwidth.length) {\n    if (bandwidth[0].indexOf('b=TIAS:') === 0) {\n      bandwidth = parseInt(bandwidth[0].substr(7), 10);\n    } else if (bandwidth[0].indexOf('b=AS:') === 0) {\n      // use formula from JSEP to convert b=AS to TIAS value.\n      bandwidth = parseInt(bandwidth[0].substr(5), 10) * 1000 * 0.95\n          - (50 * 40 * 8);\n    } else {\n      bandwidth = undefined;\n    }\n    encodingParameters.forEach(function(params) {\n      params.maxBitrate = bandwidth;\n    });\n  }\n  return encodingParameters;\n};\n\n// parses http://draft.ortc.org/#rtcrtcpparameters*\nSDPUtils.parseRtcpParameters = function(mediaSection) {\n  var rtcpParameters = {};\n\n  var cname;\n  // Gets the first SSRC. Note that with RTX there might be multiple\n  // SSRCs.\n  var remoteSsrc = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n      .map(function(line) {\n        return SDPUtils.parseSsrcMedia(line);\n      })\n      .filter(function(obj) {\n        return obj.attribute === 'cname';\n      })[0];\n  if (remoteSsrc) {\n    rtcpParameters.cname = remoteSsrc.value;\n    rtcpParameters.ssrc = remoteSsrc.ssrc;\n  }\n\n  // Edge uses the compound attribute instead of reducedSize\n  // compound is !reducedSize\n  var rsize = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-rsize');\n  rtcpParameters.reducedSize = rsize.length > 0;\n  rtcpParameters.compound = rsize.length === 0;\n\n  // parses the rtcp-mux attrbute.\n  // Note that Edge does not support unmuxed RTCP.\n  var mux = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-mux');\n  rtcpParameters.mux = mux.length > 0;\n\n  return rtcpParameters;\n};\n\n// parses either a=msid: or a=ssrc:... msid lines and returns\n// the id of the MediaStream and MediaStreamTrack.\nSDPUtils.parseMsid = function(mediaSection) {\n  var parts;\n  var spec = SDPUtils.matchPrefix(mediaSection, 'a=msid:');\n  if (spec.length === 1) {\n    parts = spec[0].substr(7).split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n  var planB = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n  .map(function(line) {\n    return SDPUtils.parseSsrcMedia(line);\n  })\n  .filter(function(parts) {\n    return parts.attribute === 'msid';\n  });\n  if (planB.length > 0) {\n    parts = planB[0].value.split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n};\n\n// Generate a session ID for SDP.\n// https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-20#section-5.2.1\n// recommends using a cryptographically random +ve 64-bit value\n// but right now this should be acceptable and within the right range\nSDPUtils.generateSessionId = function() {\n  return Math.random().toString().substr(2, 21);\n};\n\n// Write boilder plate for start of SDP\n// sessId argument is optional - if not supplied it will\n// be generated randomly\n// sessVersion is optional and defaults to 2\nSDPUtils.writeSessionBoilerplate = function(sessId, sessVer) {\n  var sessionId;\n  var version = sessVer !== undefined ? sessVer : 2;\n  if (sessId) {\n    sessionId = sessId;\n  } else {\n    sessionId = SDPUtils.generateSessionId();\n  }\n  // FIXME: sess-id should be an NTP timestamp.\n  return 'v=0\\r\\n' +\n      'o=thisisadapterortc ' + sessionId + ' ' + version + ' IN IP4 127.0.0.1\\r\\n' +\n      's=-\\r\\n' +\n      't=0 0\\r\\n';\n};\n\nSDPUtils.writeMediaSection = function(transceiver, caps, type, stream) {\n  var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\n\n  // Map ICE parameters (ufrag, pwd) to SDP.\n  sdp += SDPUtils.writeIceParameters(\n      transceiver.iceGatherer.getLocalParameters());\n\n  // Map DTLS parameters to SDP.\n  sdp += SDPUtils.writeDtlsParameters(\n      transceiver.dtlsTransport.getLocalParameters(),\n      type === 'offer' ? 'actpass' : 'active');\n\n  sdp += 'a=mid:' + transceiver.mid + '\\r\\n';\n\n  if (transceiver.direction) {\n    sdp += 'a=' + transceiver.direction + '\\r\\n';\n  } else if (transceiver.rtpSender && transceiver.rtpReceiver) {\n    sdp += 'a=sendrecv\\r\\n';\n  } else if (transceiver.rtpSender) {\n    sdp += 'a=sendonly\\r\\n';\n  } else if (transceiver.rtpReceiver) {\n    sdp += 'a=recvonly\\r\\n';\n  } else {\n    sdp += 'a=inactive\\r\\n';\n  }\n\n  if (transceiver.rtpSender) {\n    // spec.\n    var msid = 'msid:' + stream.id + ' ' +\n        transceiver.rtpSender.track.id + '\\r\\n';\n    sdp += 'a=' + msid;\n\n    // for Chrome.\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n        ' ' + msid;\n    if (transceiver.sendEncodingParameters[0].rtx) {\n      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n          ' ' + msid;\n      sdp += 'a=ssrc-group:FID ' +\n          transceiver.sendEncodingParameters[0].ssrc + ' ' +\n          transceiver.sendEncodingParameters[0].rtx.ssrc +\n          '\\r\\n';\n    }\n  }\n  // FIXME: this should be written by writeRtpDescription.\n  sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n      ' cname:' + SDPUtils.localCName + '\\r\\n';\n  if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n        ' cname:' + SDPUtils.localCName + '\\r\\n';\n  }\n  return sdp;\n};\n\n// Gets the direction from the mediaSection or the sessionpart.\nSDPUtils.getDirection = function(mediaSection, sessionpart) {\n  // Look for sendrecv, sendonly, recvonly, inactive, default to sendrecv.\n  var lines = SDPUtils.splitLines(mediaSection);\n  for (var i = 0; i < lines.length; i++) {\n    switch (lines[i]) {\n      case 'a=sendrecv':\n      case 'a=sendonly':\n      case 'a=recvonly':\n      case 'a=inactive':\n        return lines[i].substr(2);\n      default:\n        // FIXME: What should happen here?\n    }\n  }\n  if (sessionpart) {\n    return SDPUtils.getDirection(sessionpart);\n  }\n  return 'sendrecv';\n};\n\nSDPUtils.getKind = function(mediaSection) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  return mline[0].substr(2);\n};\n\nSDPUtils.isRejected = function(mediaSection) {\n  return mediaSection.split(' ', 2)[1] === '0';\n};\n\nSDPUtils.parseMLine = function(mediaSection) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  return {\n    kind: mline[0].substr(2),\n    port: parseInt(mline[1], 10),\n    protocol: mline[2],\n    fmt: mline.slice(3).join(' ')\n  };\n};\n\n// Expose public methods.\nif (typeof module === 'object') {\n  module.exports = SDPUtils;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/sdp/sdp.js","/* global MediaRecorder, MediaStream, webkitMediaStream */\r\n\r\nconst RecordingResult = require('./recordingResult');\r\n\r\n/**\r\n * Possible audio formats MIME types\r\n */\r\nconst AUDIO_WEBM = 'audio/webm'; // Supported in chrome\r\nconst AUDIO_OGG = 'audio/ogg'; // Supported in firefox\r\n\r\n/**\r\n * A TrackRecorder object holds all the information needed for recording a\r\n * single JitsiTrack (either remote or local)\r\n * @param track The JitsiTrack the object is going to hold\r\n */\r\nconst TrackRecorder = function(track) {\r\n    // The JitsiTrack holding the stream\r\n    this.track = track;\r\n\r\n    // The MediaRecorder recording the stream\r\n    this.recorder = null;\r\n\r\n    // The array of data chunks recorded from the stream\r\n    // acts as a buffer until the data is stored on disk\r\n    this.data = null;\r\n\r\n    // the name of the person of the JitsiTrack. This can be undefined and/or\r\n    // not unique\r\n    this.name = null;\r\n\r\n    // the time of the start of the recording\r\n    this.startTime = null;\r\n};\r\n\r\n/**\r\n * Starts the recording of a JitsiTrack in a TrackRecorder object.\r\n * This will also define the timestamp and try to update the name\r\n * @param trackRecorder the TrackRecorder to start\r\n */\r\nfunction startRecorder(trackRecorder) {\r\n    if (trackRecorder.recorder === undefined) {\r\n        throw new Error('Passed an object to startRecorder which is not a '\r\n            + 'TrackRecorder object');\r\n    }\r\n    trackRecorder.recorder.start();\r\n    trackRecorder.startTime = new Date();\r\n}\r\n\r\n/**\r\n * Stops the recording of a JitsiTrack in a TrackRecorder object.\r\n * This will also try to update the name\r\n * @param trackRecorder the TrackRecorder to stop\r\n */\r\nfunction stopRecorder(trackRecorder) {\r\n    if (trackRecorder.recorder === undefined) {\r\n        throw new Error('Passed an object to stopRecorder which is not a '\r\n            + 'TrackRecorder object');\r\n    }\r\n    trackRecorder.recorder.stop();\r\n}\r\n\r\n/**\r\n * Determines which kind of audio recording the browser supports\r\n * chrome supports \"audio/webm\" and firefox supports \"audio/ogg\"\r\n */\r\nfunction determineCorrectFileType() {\r\n    if (MediaRecorder.isTypeSupported(AUDIO_WEBM)) {\r\n        return AUDIO_WEBM;\r\n    } else if (MediaRecorder.isTypeSupported(AUDIO_OGG)) {\r\n        return AUDIO_OGG;\r\n    }\r\n    throw new Error(\r\n        'unable to create a MediaRecorder with the right mimetype!');\r\n}\r\n\r\n/**\r\n * main exported object of the file, holding all\r\n * relevant functions and variables for the outside world\r\n * @param jitsiConference the jitsiConference which this object\r\n * is going to record\r\n */\r\nfunction AudioRecorder(jitsiConference) {\r\n    // array of TrackRecorders, where each trackRecorder\r\n    // holds the JitsiTrack, MediaRecorder and recorder data\r\n    this.recorders = [];\r\n\r\n    // get which file type is supported by the current browser\r\n    this.fileType = determineCorrectFileType();\r\n\r\n    // boolean flag for active recording\r\n    this.isRecording = false;\r\n\r\n    // the jitsiconference the object is recording\r\n    this.jitsiConference = jitsiConference;\r\n}\r\n\r\n/**\r\n * Add the the exported module so that it can be accessed by other files\r\n */\r\nAudioRecorder.determineCorrectFileType = determineCorrectFileType;\r\n\r\n/**\r\n * Adds a new TrackRecorder object to the array.\r\n *\r\n * @param track the track potentially holding an audio stream\r\n */\r\nAudioRecorder.prototype.addTrack = function(track) {\r\n    if (track.isAudioTrack()) {\r\n        // create the track recorder\r\n        const trackRecorder = this.instantiateTrackRecorder(track);\r\n\r\n        // push it to the local array of all recorders\r\n\r\n        this.recorders.push(trackRecorder);\r\n\r\n        // update the name of the trackRecorders\r\n        this.updateNames();\r\n\r\n        // If we're already recording, immediately start recording this new\r\n        // track.\r\n        if (this.isRecording) {\r\n            startRecorder(trackRecorder);\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * Creates a TrackRecorder object. Also creates the MediaRecorder and\r\n * data array for the trackRecorder.\r\n * @param track the JitsiTrack holding the audio MediaStream(s)\r\n */\r\nAudioRecorder.prototype.instantiateTrackRecorder = function(track) {\r\n    const trackRecorder = new TrackRecorder(track);\r\n\r\n    // Create a new stream which only holds the audio track\r\n    const originalStream = trackRecorder.track.getOriginalStream();\r\n    const stream = createEmptyStream();\r\n\r\n    originalStream.getAudioTracks().forEach(t => stream.addTrack(t));\r\n\r\n    // Create the MediaRecorder\r\n    trackRecorder.recorder = new MediaRecorder(stream,\r\n        { mimeType: this.fileType });\r\n\r\n    // array for holding the recorder data. Resets it when\r\n    // audio already has been recorder once\r\n    trackRecorder.data = [];\r\n\r\n    // function handling a dataEvent, e.g the stream gets new data\r\n    trackRecorder.recorder.ondataavailable = function(dataEvent) {\r\n        if (dataEvent.data.size > 0) {\r\n            trackRecorder.data.push(dataEvent.data);\r\n        }\r\n    };\r\n\r\n    return trackRecorder;\r\n};\r\n\r\n/**\r\n * Notifies the module that a specific track has stopped, e.g participant left\r\n * the conference.\r\n * if the recording has not started yet, the TrackRecorder will be removed from\r\n * the array. If the recording has started, the recorder will stop recording\r\n * but not removed from the array so that the recorded stream can still be\r\n * accessed\r\n *\r\n * @param {JitsiTrack} track the JitsiTrack to remove from the recording session\r\n */\r\nAudioRecorder.prototype.removeTrack = function(track) {\r\n    if (track.isVideoTrack()) {\r\n        return;\r\n    }\r\n\r\n    const array = this.recorders;\r\n    let i;\r\n\r\n    for (i = 0; i < array.length; i++) {\r\n        if (array[i].track.getParticipantId() === track.getParticipantId()) {\r\n            const recorderToRemove = array[i];\r\n\r\n            if (this.isRecording) {\r\n                stopRecorder(recorderToRemove);\r\n            } else {\r\n                // remove the TrackRecorder from the array\r\n                array.splice(i, 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    // make sure the names are up to date\r\n    this.updateNames();\r\n};\r\n\r\n/**\r\n * Tries to update the name value of all TrackRecorder in the array.\r\n * If it hasn't changed,it will keep the exiting name. If it changes to a\r\n * undefined value, the old value will also be kept.\r\n */\r\nAudioRecorder.prototype.updateNames = function() {\r\n    const conference = this.jitsiConference;\r\n\r\n    this.recorders.forEach(trackRecorder => {\r\n        if (trackRecorder.track.isLocal()) {\r\n            trackRecorder.name = 'the transcriber';\r\n        } else {\r\n            const id = trackRecorder.track.getParticipantId();\r\n            const participant = conference.getParticipantById(id);\r\n            const newName = participant.getDisplayName();\r\n\r\n            if (newName !== 'undefined') {\r\n                trackRecorder.name = newName;\r\n            }\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * Starts the audio recording of every local and remote track\r\n */\r\nAudioRecorder.prototype.start = function() {\r\n    if (this.isRecording) {\r\n        throw new Error('audiorecorder is already recording');\r\n    }\r\n\r\n    // set boolean isRecording flag to true so if new participants join the\r\n    // conference, that track can instantly start recording as well\r\n    this.isRecording = true;\r\n\r\n    // start all the mediaRecorders\r\n    this.recorders.forEach(trackRecorder => startRecorder(trackRecorder));\r\n\r\n    // log that recording has started\r\n    console.log(\r\n        `Started the recording of the audio. There are currently ${\r\n            this.recorders.length} recorders active.`);\r\n};\r\n\r\n/**\r\n * Stops the audio recording of every local and remote track\r\n */\r\nAudioRecorder.prototype.stop = function() {\r\n    // set the boolean flag to false\r\n    this.isRecording = false;\r\n\r\n    // stop all recorders\r\n    this.recorders.forEach(trackRecorder => stopRecorder(trackRecorder));\r\n    console.log('stopped recording');\r\n};\r\n\r\n/**\r\n * link hacking to download all recorded audio streams\r\n */\r\nAudioRecorder.prototype.download = function() {\r\n    this.recorders.forEach(trackRecorder => {\r\n        const blob = new Blob(trackRecorder.data, { type: this.fileType });\r\n        const url = URL.createObjectURL(blob);\r\n        const a = document.createElement('a');\r\n\r\n        document.body.appendChild(a);\r\n        a.style = 'display: none';\r\n        a.href = url;\r\n        a.download = `test.${this.fileType.split('/')[1]}`;\r\n        a.click();\r\n        window.URL.revokeObjectURL(url);\r\n    });\r\n};\r\n\r\n/**\r\n * returns the audio files of all recorders as an array of objects,\r\n * which include the name of the owner of the track and the starting time stamp\r\n * @returns {Array} an array of RecordingResult objects\r\n */\r\nAudioRecorder.prototype.getRecordingResults = function() {\r\n    if (this.isRecording) {\r\n        throw new Error(\r\n            'cannot get blobs because the AudioRecorder is still recording!');\r\n    }\r\n\r\n    // make sure the names are up to date before sending them off\r\n    this.updateNames();\r\n\r\n    const array = [];\r\n\r\n    this.recorders.forEach(\r\n        recorder =>\r\n            array.push(\r\n                new RecordingResult(\r\n                    new Blob(recorder.data, { type: this.fileType }),\r\n                    recorder.name,\r\n                    recorder.startTime)));\r\n\r\n    return array;\r\n};\r\n\r\n/**\r\n * Gets the mime type of the recorder audio\r\n * @returns {String} the mime type of the recorder audio\r\n */\r\nAudioRecorder.prototype.getFileType = function() {\r\n    return this.fileType;\r\n};\r\n\r\n/**\r\n * Creates a empty MediaStream object which can be used\r\n * to add MediaStreamTracks to\r\n * @returns MediaStream\r\n */\r\nfunction createEmptyStream() {\r\n    // Firefox supports the MediaStream object, Chrome webkitMediaStream\r\n    if (typeof MediaStream !== 'undefined') {\r\n        return new MediaStream();\r\n    } else if (typeof webkitMediaStream !== 'undefined') {\r\n        return new webkitMediaStream(); // eslint-disable-line new-cap\r\n    }\r\n    throw new Error('cannot create a clean mediaStream');\r\n}\r\n\r\n/**\r\n * export the main object AudioRecorder\r\n */\r\nmodule.exports = AudioRecorder;\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/transcription/audioRecorder.js","/**\r\n * The events for the media devices.\r\n */\r\n\r\n/**\r\n * Indicates that the list of available media devices has been changed. The\r\n * event provides the following parameters to its listeners:\r\n *\r\n * @param {MediaDeviceInfo[]} devices - array of MediaDeviceInfo or\r\n *  MediaDeviceInfo-like objects that are currently connected.\r\n *  @see https://developer.mozilla.org/en-US/docs/Web/API/MediaDeviceInfo\r\n */\r\nexport const DEVICE_LIST_CHANGED = 'mediaDevices.devicechange';\r\n\r\n/**\r\n * Indicates that the environment is currently showing permission prompt to\r\n * access camera and/or microphone. The event provides the following\r\n * parameters to its listeners:\r\n *\r\n * @param {'chrome'|'opera'|'firefox'|'iexplorer'|'safari'|'nwjs'\r\n *  |'react-native'|'android'} environmentType - type of browser or\r\n *  other execution environment.\r\n */\r\nexport const PERMISSION_PROMPT_IS_SHOWN\r\n    = 'mediaDevices.permissionPromptIsShown';\r\n\n\n\n// WEBPACK FOOTER //\n// ./JitsiMediaDevicesEvents.js","// For legacy purposes, preserve the UMD of the public API of the Jitsi Meet\r\n// library (a.k.a. JitsiMeetJS).\r\nmodule.exports = require('./JitsiMeetJS').default;\r\n\n\n\n// WEBPACK FOOTER //\n// ./index.js","/* global __filename */\r\n\r\nimport { createGetUserMediaEvent } from './service/statistics/AnalyticsEvents';\r\nimport AuthUtil from './modules/util/AuthUtil';\r\nimport * as ConnectionQualityEvents\r\n    from './service/connectivity/ConnectionQualityEvents';\r\nimport GlobalOnErrorHandler from './modules/util/GlobalOnErrorHandler';\r\nimport * as JitsiConferenceErrors from './JitsiConferenceErrors';\r\nimport * as JitsiConferenceEvents from './JitsiConferenceEvents';\r\nimport JitsiConnection from './JitsiConnection';\r\nimport * as JitsiConnectionErrors from './JitsiConnectionErrors';\r\nimport * as JitsiConnectionEvents from './JitsiConnectionEvents';\r\nimport JitsiMediaDevices from './JitsiMediaDevices';\r\nimport * as JitsiMediaDevicesEvents from './JitsiMediaDevicesEvents';\r\nimport JitsiRecorderErrors from './JitsiRecorderErrors';\r\nimport JitsiTrackError from './JitsiTrackError';\r\nimport * as JitsiTrackErrors from './JitsiTrackErrors';\r\nimport * as JitsiTrackEvents from './JitsiTrackEvents';\r\nimport * as JitsiTranscriptionStatus from './JitsiTranscriptionStatus';\r\nimport LocalStatsCollector from './modules/statistics/LocalStatsCollector';\r\nimport Recording from './modules/xmpp/recording';\r\nimport Logger from 'jitsi-meet-logger';\r\nimport * as MediaType from './service/RTC/MediaType';\r\nimport Resolutions from './service/RTC/Resolutions';\r\nimport { ParticipantConnectionStatus }\r\n    from './modules/connectivity/ParticipantConnectionStatus';\r\nimport RTC from './modules/RTC/RTC';\r\nimport browser from './modules/browser';\r\nimport RTCUIHelper from './modules/RTC/RTCUIHelper';\r\nimport ScriptUtil from './modules/util/ScriptUtil';\r\nimport Statistics from './modules/statistics/statistics';\r\nimport * as VideoSIPGWConstants from './modules/videosipgw/VideoSIPGWConstants';\r\n\r\nconst logger = Logger.getLogger(__filename);\r\n\r\n// The amount of time to wait until firing\r\n// JitsiMediaDevicesEvents.PERMISSION_PROMPT_IS_SHOWN event\r\nconst USER_MEDIA_PERMISSION_PROMPT_TIMEOUT = 1000;\r\n\r\n/**\r\n *\r\n * @param resolution\r\n */\r\nfunction getLowerResolution(resolution) {\r\n    if (!Resolutions[resolution]) {\r\n        return null;\r\n    }\r\n    const order = Resolutions[resolution].order;\r\n    let res = null;\r\n    let resName = null;\r\n\r\n    Object.keys(Resolutions).forEach(r => {\r\n        const value = Resolutions[r];\r\n\r\n        if (!res || (res.order < value.order && value.order < order)) {\r\n            resName = r;\r\n            res = value;\r\n        }\r\n    });\r\n\r\n    return resName;\r\n}\r\n\r\n/**\r\n * Extracts from an 'options' objects with a specific format\r\n * (TODO what IS the format?) the attributes which are to be logged in analytics\r\n * events.\r\n *\r\n * @param options gum options (???)\r\n * @returns {*} the attributes to attach to analytics events.\r\n */\r\nfunction getAnalyticsAttributesFromOptions(options) {\r\n    const attributes = {\r\n        'audio_requested':\r\n            options.devices.includes('audio'),\r\n        'video_requested':\r\n            options.devices.includes('video'),\r\n        'screen_sharing_requested':\r\n            options.devices.includes('desktop')\r\n    };\r\n\r\n    if (attributes.video_requested) {\r\n        attributes.resolution = options.resolution;\r\n    }\r\n\r\n    return attributes;\r\n}\r\n\r\n/**\r\n * The public API of the Jitsi Meet library (a.k.a. JitsiMeetJS).\r\n */\r\nexport default {\r\n\r\n    version: '{#COMMIT_HASH#}',\r\n\r\n    JitsiConnection,\r\n    constants: {\r\n        participantConnectionStatus: ParticipantConnectionStatus,\r\n        recordingStatus: Recording.status,\r\n        recordingTypes: Recording.types,\r\n        sipVideoGW: VideoSIPGWConstants,\r\n        transcriptionStatus: JitsiTranscriptionStatus\r\n    },\r\n    events: {\r\n        conference: JitsiConferenceEvents,\r\n        connection: JitsiConnectionEvents,\r\n        track: JitsiTrackEvents,\r\n        mediaDevices: JitsiMediaDevicesEvents,\r\n        connectionQuality: ConnectionQualityEvents\r\n    },\r\n    errors: {\r\n        conference: JitsiConferenceErrors,\r\n        connection: JitsiConnectionErrors,\r\n        recorder: JitsiRecorderErrors,\r\n        track: JitsiTrackErrors\r\n    },\r\n    errorTypes: {\r\n        JitsiTrackError\r\n    },\r\n    logLevels: Logger.levels,\r\n    mediaDevices: JitsiMediaDevices,\r\n    analytics: Statistics.analytics,\r\n    init(options) {\r\n        Statistics.init(options);\r\n\r\n        // Initialize global window.connectionTimes\r\n        // FIXME do not use 'window'\r\n        if (!window.connectionTimes) {\r\n            window.connectionTimes = {};\r\n        }\r\n\r\n        if (options.enableAnalyticsLogging !== true) {\r\n            this.analytics.dispose();\r\n        }\r\n\r\n        if (options.enableWindowOnErrorHandler) {\r\n            GlobalOnErrorHandler.addHandler(\r\n                this.getGlobalOnErrorHandler.bind(this));\r\n        }\r\n\r\n        // Log deployment-specific information, if available.\r\n        // Defined outside the application by individual deployments\r\n        const aprops = options.deploymentInfo;\r\n\r\n        if (aprops && Object.keys(aprops).length > 0) {\r\n            const logObject = {};\r\n\r\n            for (const attr in aprops) {\r\n                if (aprops.hasOwnProperty(attr)) {\r\n                    logObject[attr] = aprops[attr];\r\n                }\r\n            }\r\n\r\n            logObject.id = 'deployment_info';\r\n            Statistics.sendLog(JSON.stringify(logObject));\r\n        }\r\n\r\n        if (this.version) {\r\n            const logObject = {\r\n                id: 'component_version',\r\n                component: 'lib-jitsi-meet',\r\n                version: this.version\r\n            };\r\n\r\n            Statistics.sendLog(JSON.stringify(logObject));\r\n        }\r\n\r\n        return RTC.init(options || {});\r\n    },\r\n\r\n    /**\r\n     * Returns whether the desktop sharing is enabled or not.\r\n     * @returns {boolean}\r\n     */\r\n    isDesktopSharingEnabled() {\r\n        return RTC.isDesktopSharingEnabled();\r\n    },\r\n    setLogLevel(level) {\r\n        Logger.setLogLevel(level);\r\n    },\r\n\r\n    /**\r\n     * Sets the log level to the <tt>Logger</tt> instance with given id.\r\n     * @param {Logger.levels} level the logging level to be set\r\n     * @param {string} id the logger id to which new logging level will be set.\r\n     * Usually it's the name of the JavaScript source file including the path\r\n     * ex. \"modules/xmpp/ChatRoom.js\"\r\n     */\r\n    setLogLevelById(level, id) {\r\n        Logger.setLogLevelById(level, id);\r\n    },\r\n\r\n    /**\r\n     * Registers new global logger transport to the library logging framework.\r\n     * @param globalTransport\r\n     * @see Logger.addGlobalTransport\r\n     */\r\n    addGlobalLogTransport(globalTransport) {\r\n        Logger.addGlobalTransport(globalTransport);\r\n    },\r\n\r\n    /**\r\n     * Removes global logging transport from the library logging framework.\r\n     * @param globalTransport\r\n     * @see Logger.removeGlobalTransport\r\n     */\r\n    removeGlobalLogTransport(globalTransport) {\r\n        Logger.removeGlobalTransport(globalTransport);\r\n    },\r\n\r\n    /**\r\n     * Creates the media tracks and returns them trough the callback.\r\n     * @param options Object with properties / settings specifying the tracks\r\n     * which should be created. should be created or some additional\r\n     * configurations about resolution for example.\r\n     * @param {Array} options.devices the devices that will be requested\r\n     * @param {string} options.resolution resolution constraints\r\n     * @param {bool} options.dontCreateJitsiTrack if <tt>true</tt> objects with\r\n     * the following structure {stream: the Media Stream, type: \"audio\" or\r\n     * \"video\", videoType: \"camera\" or \"desktop\"} will be returned trough the\r\n     * Promise, otherwise JitsiTrack objects will be returned.\r\n     * @param {string} options.cameraDeviceId\r\n     * @param {string} options.micDeviceId\r\n     * @param {object} options.desktopSharingExtensionExternalInstallation -\r\n     * enables external installation process for desktop sharing extension if\r\n     * the inline installation is not posible. The following properties should\r\n     * be provided:\r\n     * @param {intiger} interval - the interval (in ms) for\r\n     * checking whether the desktop sharing extension is installed or not\r\n     * @param {Function} checkAgain - returns boolean. While checkAgain()==true\r\n     * createLocalTracks will wait and check on every \"interval\" ms for the\r\n     * extension. If the desktop extension is not install and checkAgain()==true\r\n     * createLocalTracks will finish with rejected Promise.\r\n     * @param {Function} listener - The listener will be called to notify the\r\n     * user of lib-jitsi-meet that createLocalTracks is starting external\r\n     * extension installation process.\r\n     * NOTE: If the inline installation process is not possible and external\r\n     * installation is enabled the listener property will be called to notify\r\n     * the start of external installation process. After that createLocalTracks\r\n     * will start to check for the extension on every interval ms until the\r\n     * plugin is installed or until checkAgain return false. If the extension\r\n     * is found createLocalTracks will try to get the desktop sharing track and\r\n     * will finish the execution. If checkAgain returns false, createLocalTracks\r\n     * will finish the execution with rejected Promise.\r\n     *\r\n     * @param {boolean} (firePermissionPromptIsShownEvent) - if event\r\n     *      JitsiMediaDevicesEvents.PERMISSION_PROMPT_IS_SHOWN should be fired\r\n     * @returns {Promise.<{Array.<JitsiTrack>}, JitsiConferenceError>}\r\n     *     A promise that returns an array of created JitsiTracks if resolved,\r\n     *     or a JitsiConferenceError if rejected.\r\n     */\r\n    createLocalTracks(options = {}, firePermissionPromptIsShownEvent) {\r\n        let promiseFulfilled = false;\r\n\r\n        if (firePermissionPromptIsShownEvent === true) {\r\n            window.setTimeout(() => {\r\n                if (!promiseFulfilled) {\r\n                    JitsiMediaDevices.emitEvent(\r\n                        JitsiMediaDevicesEvents.PERMISSION_PROMPT_IS_SHOWN,\r\n                        browser.getName());\r\n                }\r\n            }, USER_MEDIA_PERMISSION_PROMPT_TIMEOUT);\r\n        }\r\n\r\n        if (!window.connectionTimes) {\r\n            window.connectionTimes = {};\r\n        }\r\n        window.connectionTimes['obtainPermissions.start']\r\n            = window.performance.now();\r\n\r\n        return RTC.obtainAudioAndVideoPermissions(options)\r\n            .then(tracks => {\r\n                promiseFulfilled = true;\r\n\r\n                window.connectionTimes['obtainPermissions.end']\r\n                    = window.performance.now();\r\n\r\n                Statistics.sendAnalytics(\r\n                    createGetUserMediaEvent(\r\n                        'success',\r\n                        getAnalyticsAttributesFromOptions(options)));\r\n\r\n                if (!RTC.options.disableAudioLevels) {\r\n                    for (let i = 0; i < tracks.length; i++) {\r\n                        const track = tracks[i];\r\n                        const mStream = track.getOriginalStream();\r\n\r\n                        if (track.getType() === MediaType.AUDIO) {\r\n                            Statistics.startLocalStats(mStream,\r\n                                track.setAudioLevel.bind(track));\r\n                            track.addEventListener(\r\n                                JitsiTrackEvents.LOCAL_TRACK_STOPPED,\r\n                                () => {\r\n                                    Statistics.stopLocalStats(mStream);\r\n                                });\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // set real device ids\r\n                const currentlyAvailableMediaDevices\r\n                    = RTC.getCurrentlyAvailableMediaDevices();\r\n\r\n                if (currentlyAvailableMediaDevices) {\r\n                    for (let i = 0; i < tracks.length; i++) {\r\n                        const track = tracks[i];\r\n\r\n                        track._setRealDeviceIdFromDeviceList(\r\n                            currentlyAvailableMediaDevices);\r\n                    }\r\n                }\r\n\r\n                return tracks;\r\n            })\r\n            .catch(error => {\r\n                promiseFulfilled = true;\r\n\r\n                if (error.name === JitsiTrackErrors.UNSUPPORTED_RESOLUTION\r\n                    && !browser.usesNewGumFlow()) {\r\n                    const oldResolution = options.resolution || '720';\r\n                    const newResolution = getLowerResolution(oldResolution);\r\n\r\n                    if (newResolution !== null) {\r\n                        options.resolution = newResolution;\r\n\r\n                        logger.debug(\r\n                            'Retry createLocalTracks with resolution',\r\n                            newResolution);\r\n\r\n                        Statistics.sendAnalytics(createGetUserMediaEvent(\r\n                            'warning',\r\n                            {\r\n                                'old_resolution': oldResolution,\r\n                                'new_resolution': newResolution,\r\n                                reason: 'unsupported resolution'\r\n                            }));\r\n\r\n                        return this.createLocalTracks(options);\r\n                    }\r\n                }\r\n\r\n                if (error.name\r\n                        === JitsiTrackErrors.CHROME_EXTENSION_USER_CANCELED) {\r\n                    // User cancelled action is not really an error, so only\r\n                    // log it as an event to avoid having conference classified\r\n                    // as partially failed\r\n                    const logObject = {\r\n                        id: 'chrome_extension_user_canceled',\r\n                        message: error.message\r\n                    };\r\n\r\n                    Statistics.sendLog(JSON.stringify(logObject));\r\n\r\n                    Statistics.sendAnalytics(\r\n                        createGetUserMediaEvent(\r\n                            'warning',\r\n                            {\r\n                                reason: 'extension install user canceled'\r\n                            }));\r\n                } else if (error.name === JitsiTrackErrors.NOT_FOUND) {\r\n                    // logs not found devices with just application log to cs\r\n                    const logObject = {\r\n                        id: 'usermedia_missing_device',\r\n                        status: error.gum.devices\r\n                    };\r\n\r\n                    Statistics.sendLog(JSON.stringify(logObject));\r\n\r\n                    const attributes\r\n                        = getAnalyticsAttributesFromOptions(options);\r\n\r\n                    attributes.reason = 'device not found';\r\n                    attributes.devices = error.gum.devices.join('.');\r\n                    Statistics.sendAnalytics(\r\n                        createGetUserMediaEvent('error', attributes));\r\n                } else {\r\n                    // Report gUM failed to the stats\r\n                    Statistics.sendGetUserMediaFailed(error);\r\n\r\n                    const attributes\r\n                        = getAnalyticsAttributesFromOptions(options);\r\n\r\n                    attributes.reason = error.name;\r\n                    Statistics.sendAnalytics(\r\n                        createGetUserMediaEvent('error', attributes));\r\n                }\r\n\r\n                window.connectionTimes['obtainPermissions.end']\r\n                    = window.performance.now();\r\n\r\n                return Promise.reject(error);\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Checks if its possible to enumerate available cameras/microphones.\r\n     * @returns {Promise<boolean>} a Promise which will be resolved only once\r\n     * the WebRTC stack is ready, either with true if the device listing is\r\n     * available available or with false otherwise.\r\n     * @deprecated use JitsiMeetJS.mediaDevices.isDeviceListAvailable instead\r\n     */\r\n    isDeviceListAvailable() {\r\n        logger.warn('This method is deprecated, use '\r\n            + 'JitsiMeetJS.mediaDevices.isDeviceListAvailable instead');\r\n\r\n        return this.mediaDevices.isDeviceListAvailable();\r\n    },\r\n\r\n    /**\r\n     * Returns true if changing the input (camera / microphone) or output\r\n     * (audio) device is supported and false if not.\r\n     * @params {string} [deviceType] - type of device to change. Default is\r\n     *      undefined or 'input', 'output' - for audio output device change.\r\n     * @returns {boolean} true if available, false otherwise.\r\n     * @deprecated use JitsiMeetJS.mediaDevices.isDeviceChangeAvailable instead\r\n     */\r\n    isDeviceChangeAvailable(deviceType) {\r\n        logger.warn('This method is deprecated, use '\r\n            + 'JitsiMeetJS.mediaDevices.isDeviceChangeAvailable instead');\r\n\r\n        return this.mediaDevices.isDeviceChangeAvailable(deviceType);\r\n    },\r\n\r\n\r\n    /**\r\n     * Checks if the current environment supports having multiple audio\r\n     * input devices in use simultaneously.\r\n     *\r\n     * @returns {boolean} True if multiple audio input devices can be used.\r\n     */\r\n    isMultipleAudioInputSupported() {\r\n        return this.mediaDevices.isMultipleAudioInputSupported();\r\n    },\r\n\r\n    /**\r\n     * Checks if local tracks can collect stats and collection is enabled.\r\n     *\r\n     * @param {boolean} True if stats are being collected for local tracks.\r\n     */\r\n    isCollectingLocalStats() {\r\n        return Statistics.audioLevelsEnabled\r\n            && LocalStatsCollector.isLocalStatsSupported();\r\n    },\r\n\r\n    /**\r\n     * Executes callback with list of media devices connected.\r\n     * @param {function} callback\r\n     * @deprecated use JitsiMeetJS.mediaDevices.enumerateDevices instead\r\n     */\r\n    enumerateDevices(callback) {\r\n        logger.warn('This method is deprecated, use '\r\n            + 'JitsiMeetJS.mediaDevices.enumerateDevices instead');\r\n        this.mediaDevices.enumerateDevices(callback);\r\n    },\r\n\r\n    /* eslint-disable max-params */\r\n\r\n    /**\r\n     * @returns function that can be used to be attached to window.onerror and\r\n     * if options.enableWindowOnErrorHandler is enabled returns\r\n     * the function used by the lib.\r\n     * (function(message, source, lineno, colno, error)).\r\n     */\r\n    getGlobalOnErrorHandler(message, source, lineno, colno, error) {\r\n        logger.error(\r\n            `UnhandledError: ${message}`,\r\n            `Script: ${source}`,\r\n            `Line: ${lineno}`,\r\n            `Column: ${colno}`,\r\n            'StackTrace: ', error);\r\n        Statistics.reportGlobalError(error);\r\n    },\r\n\r\n    /* eslint-enable max-params */\r\n\r\n    /**\r\n     * Represents a hub/namespace for utility functionality which may be of\r\n     * interest to lib-jitsi-meet clients.\r\n     */\r\n    util: {\r\n        AuthUtil,\r\n        RTCUIHelper,\r\n        ScriptUtil,\r\n        browser\r\n    }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./JitsiMeetJS.js","const AuthUtil = {\r\n    /**\r\n     * Creates the URL pointing to JWT token authentication service. It is\r\n     * formatted from the 'urlPattern' argument which can contain the following\r\n     * constants:\r\n     * '{room}' - name of the conference room passed as <tt>roomName</tt>\r\n     * argument to this method.\r\n     * '{roleUpgrade}' - will contain 'true' if the URL will be used for\r\n     * the role upgrade scenario, where user connects from anonymous domain and\r\n     * then gets upgraded to the moderator by logging-in from the popup window.\r\n     *\r\n     * @param urlPattern a URL pattern pointing to the login service\r\n     * @param roomName the name of the conference room for which the user will\r\n     * be authenticated\r\n     * @param {bool} roleUpgrade <tt>true</tt> if the URL will be used for role\r\n     * upgrade scenario, where the user logs-in from the popup window in order\r\n     * to have the moderator rights granted\r\n     *\r\n     * @returns {string|null} the URL pointing to JWT login service or\r\n     * <tt>null</tt> if 'urlPattern' is not a string and the URL can not be\r\n     * constructed.\r\n     */\r\n    getTokenAuthUrl(urlPattern, roomName, roleUpgrade) {\r\n        const url = urlPattern;\r\n\r\n        if (typeof url !== 'string') {\r\n            return null;\r\n        }\r\n\r\n        return url.replace('{room}', roomName)\r\n            .replace('{roleUpgrade}', roleUpgrade === true);\r\n    }\r\n};\r\n\r\nmodule.exports = AuthUtil;\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/util/AuthUtil.js","import {\r\n    CONNECTION_DISCONNECTED as ANALYTICS_CONNECTION_DISCONNECTED,\r\n    createConnectionFailedEvent\r\n} from './service/statistics/AnalyticsEvents';\r\nimport JitsiConference from './JitsiConference';\r\nimport * as JitsiConnectionEvents from './JitsiConnectionEvents';\r\nimport Statistics from './modules/statistics/statistics';\r\nimport XMPP from './modules/xmpp/xmpp';\r\n\r\n/**\r\n * Creates a new connection object for the Jitsi Meet server side video\r\n * conferencing service. Provides access to the JitsiConference interface.\r\n * @param appID identification for the provider of Jitsi Meet video conferencing\r\n * services.\r\n * @param token the JWT token used to authenticate with the server(optional)\r\n * @param options Object with properties / settings related to connection with\r\n * the server.\r\n * @constructor\r\n */\r\nexport default function JitsiConnection(appID, token, options) {\r\n    this.appID = appID;\r\n    this.token = token;\r\n    this.options = options;\r\n    this.xmpp = new XMPP(options, token);\r\n\r\n    /* eslint-disable max-params */\r\n    this.addEventListener(JitsiConnectionEvents.CONNECTION_FAILED,\r\n        (errType, msg, credentials, details) => {\r\n            Statistics.sendAnalyticsAndLog(\r\n                createConnectionFailedEvent(errType, msg, details));\r\n        });\r\n    /* eslint-enable max-params */\r\n\r\n    this.addEventListener(JitsiConnectionEvents.CONNECTION_DISCONNECTED,\r\n        msg => {\r\n            // we can see disconnects from normal tab closing of the browser\r\n            // and then there are no msgs, but we want to log only disconnects\r\n            // when there is real error\r\n            // XXX Do we need the difference in handling between the log and\r\n            // analytics event here?\r\n            if (msg) {\r\n                Statistics.sendAnalytics(\r\n                    ANALYTICS_CONNECTION_DISCONNECTED,\r\n                    { message: msg });\r\n            }\r\n            Statistics.sendLog(\r\n                JSON.stringify(\r\n                    {\r\n                        id: ANALYTICS_CONNECTION_DISCONNECTED,\r\n                        msg\r\n                    }));\r\n        });\r\n}\r\n\r\n/**\r\n * Connect the client with the server.\r\n * @param options {object} connecting options\r\n * (for example authentications parameters).\r\n */\r\nJitsiConnection.prototype.connect = function(options = {}) {\r\n    this.xmpp.connect(options.id, options.password);\r\n};\r\n\r\n/**\r\n * Attach to existing connection. Can be used for optimizations. For example:\r\n * if the connection is created on the server we can attach to it and start\r\n * using it.\r\n *\r\n * @param options {object} connecting options - rid, sid and jid.\r\n */\r\nJitsiConnection.prototype.attach = function(options) {\r\n    this.xmpp.attach(options);\r\n};\r\n\r\n/**\r\n * Disconnect the client from the server.\r\n */\r\nJitsiConnection.prototype.disconnect = function(...args) {\r\n    // XXX Forward any arguments passed to JitsiConnection.disconnect to\r\n    // XMPP.disconnect. For example, the caller of JitsiConnection.disconnect\r\n    // may optionally pass the event which triggered the disconnect in order to\r\n    // provide the implementation with finer-grained context.\r\n    this.xmpp.disconnect(...args);\r\n};\r\n\r\n/**\r\n * This method allows renewal of the tokens if they are expiring.\r\n * @param token the new token.\r\n */\r\nJitsiConnection.prototype.setToken = function(token) {\r\n    this.token = token;\r\n};\r\n\r\n/**\r\n * Creates and joins new conference.\r\n * @param name the name of the conference; if null - a generated name will be\r\n * provided from the api\r\n * @param options Object with properties / settings related to the conference\r\n * that will be created.\r\n * @returns {JitsiConference} returns the new conference object.\r\n */\r\nJitsiConnection.prototype.initJitsiConference = function(name, options) {\r\n    return new JitsiConference({\r\n        name,\r\n        config: options,\r\n        connection: this\r\n    });\r\n};\r\n\r\n/**\r\n * Subscribes the passed listener to the event.\r\n * @param event {JitsiConnectionEvents} the connection event.\r\n * @param listener {Function} the function that will receive the event\r\n */\r\nJitsiConnection.prototype.addEventListener = function(event, listener) {\r\n    this.xmpp.addListener(event, listener);\r\n};\r\n\r\n/**\r\n * Unsubscribes the passed handler.\r\n * @param event {JitsiConnectionEvents} the connection event.\r\n * @param listener {Function} the function that will receive the event\r\n */\r\nJitsiConnection.prototype.removeEventListener = function(event, listener) {\r\n    this.xmpp.removeListener(event, listener);\r\n};\r\n\r\n/**\r\n * Returns measured connectionTimes.\r\n */\r\nJitsiConnection.prototype.getConnectionTimes = function() {\r\n    return this.xmpp.connectionTimes;\r\n};\r\n\r\n/**\r\n * Adds new feature to the list of supported features for the local\r\n * participant.\r\n * @param {String} feature the name of the feature.\r\n * @param {boolean} submit if true - the new list of features will be\r\n * immediately submitted to the others.\r\n */\r\nJitsiConnection.prototype.addFeature = function(feature, submit = false) {\r\n    return this.xmpp.caps.addFeature(feature, submit);\r\n};\r\n\r\n/**\r\n * Removes a feature from the list of supported features for the local\r\n * participant\r\n * @param {String} feature the name of the feature.\r\n * @param {boolean} submit if true - the new list of features will be\r\n * immediately submitted to the others.\r\n */\r\nJitsiConnection.prototype.removeFeature = function(feature, submit = false) {\r\n    return this.xmpp.caps.removeFeature(feature, submit);\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./JitsiConnection.js","/* global __filename, $, Promise */\r\nimport { Strophe } from 'strophe.js';\r\n\r\nimport {\r\n    ACTION_JINGLE_RESTART,\r\n    ACTION_JINGLE_SI_RECEIVED,\r\n    ACTION_JINGLE_TERMINATE,\r\n    ACTION_P2P_ESTABLISHED,\r\n    ACTION_P2P_FAILED,\r\n    ACTION_P2P_SWITCH_TO_JVB,\r\n    ICE_ESTABLISHMENT_DURATION_DIFF,\r\n    createJingleEvent,\r\n    createP2PEvent\r\n} from './service/statistics/AnalyticsEvents';\r\nimport AvgRTPStatsReporter from './modules/statistics/AvgRTPStatsReporter';\r\nimport ComponentsVersions from './modules/version/ComponentsVersions';\r\nimport ConnectionQuality from './modules/connectivity/ConnectionQuality';\r\nimport { getLogger } from 'jitsi-meet-logger';\r\nimport GlobalOnErrorHandler from './modules/util/GlobalOnErrorHandler';\r\nimport EventEmitter from 'events';\r\nimport authenticateAndUpgradeRole from './authenticateAndUpgradeRole';\r\nimport * as JitsiConferenceErrors from './JitsiConferenceErrors';\r\nimport JitsiConferenceEventManager from './JitsiConferenceEventManager';\r\nimport * as JitsiConferenceEvents from './JitsiConferenceEvents';\r\nimport JitsiDTMFManager from './modules/DTMF/JitsiDTMFManager';\r\nimport JitsiParticipant from './JitsiParticipant';\r\nimport JitsiTrackError from './JitsiTrackError';\r\nimport * as JitsiTrackErrors from './JitsiTrackErrors';\r\nimport * as JitsiTrackEvents from './JitsiTrackEvents';\r\nimport Jvb121EventGenerator from './modules/event/Jvb121EventGenerator';\r\nimport * as MediaType from './service/RTC/MediaType';\r\nimport ParticipantConnectionStatusHandler\r\n    from './modules/connectivity/ParticipantConnectionStatus';\r\nimport P2PDominantSpeakerDetection from './modules/P2PDominantSpeakerDetection';\r\nimport RTC from './modules/RTC/RTC';\r\nimport browser from './modules/browser';\r\nimport * as RTCEvents from './service/RTC/RTCEvents';\r\nimport Statistics from './modules/statistics/statistics';\r\nimport TalkMutedDetection from './modules/TalkMutedDetection';\r\nimport Transcriber from './modules/transcription/transcriber';\r\nimport VideoType from './service/RTC/VideoType';\r\nimport VideoSIPGW from './modules/videosipgw/VideoSIPGW';\r\nimport * as VideoSIPGWConstants from './modules/videosipgw/VideoSIPGWConstants';\r\nimport * as XMPPEvents from './service/xmpp/XMPPEvents';\r\n\r\nimport SpeakerStatsCollector from './modules/statistics/SpeakerStatsCollector';\r\n\r\nconst logger = getLogger(__filename);\r\n\r\n/**\r\n * Creates a JitsiConference object with the given name and properties.\r\n * Note: this constructor is not a part of the public API (objects should be\r\n * created using JitsiConnection.createConference).\r\n * @param options.config properties / settings related to the conference that\r\n * will be created.\r\n * @param options.name the name of the conference\r\n * @param options.connection the JitsiConnection object for this\r\n * JitsiConference.\r\n * @param {number} [options.config.avgRtpStatsN=15] how many samples are to be\r\n * collected by {@link AvgRTPStatsReporter}, before arithmetic mean is\r\n * calculated and submitted to the analytics module.\r\n * @param {boolean} [options.config.p2p.enabled] when set to <tt>true</tt>\r\n * the peer to peer mode will be enabled. It means that when there are only 2\r\n * participants in the conference an attempt to make direct connection will be\r\n * made. If the connection succeeds the conference will stop sending data\r\n * through the JVB connection and will use the direct one instead.\r\n * @param {number} [options.config.p2p.backToP2PDelay=5] a delay given in\r\n * seconds, before the conference switches back to P2P, after the 3rd\r\n * participant has left the room.\r\n * @param {number} [options.config.channelLastN=-1] The requested amount of\r\n * videos are going to be delivered after the value is in effect. Set to -1 for\r\n * unlimited or all available videos.\r\n * @param {number} [options.config.forceJVB121Ratio]\r\n * \"Math.random() < forceJVB121Ratio\" will determine whether a 2 people\r\n * conference should be moved to the JVB instead of P2P. The decision is made on\r\n * the responder side, after ICE succeeds on the P2P connection.\r\n * @param {*} [options.config.openBridgeChannel] Which kind of communication to\r\n * open with the videobridge. Values can be \"datachannel\", \"websocket\", true\r\n * (treat it as \"datachannel\"), undefined (treat it as \"datachannel\") and false\r\n * (don't open any channel).\r\n * @constructor\r\n *\r\n * FIXME Make all methods which are called from lib-internal classes\r\n *       to non-public (use _). To name a few:\r\n *       {@link JitsiConference.onLocalRoleChanged}\r\n *       {@link JitsiConference.onUserRoleChanged}\r\n *       {@link JitsiConference.onMemberLeft}\r\n *       and so on...\r\n */\r\nexport default function JitsiConference(options) {\r\n    if (!options.name || options.name.toLowerCase() !== options.name) {\r\n        const errmsg\r\n            = 'Invalid conference name (no conference name passed or it '\r\n                + 'contains invalid characters like capital letters)!';\r\n\r\n        logger.error(errmsg);\r\n        throw new Error(errmsg);\r\n    }\r\n    this.eventEmitter = new EventEmitter();\r\n    this.options = options;\r\n    this.eventManager = new JitsiConferenceEventManager(this);\r\n    this.participants = {};\r\n    this._init(options);\r\n    this.componentsVersions = new ComponentsVersions(this);\r\n\r\n    /**\r\n     * Jingle session instance for the JVB connection.\r\n     * @type {JingleSessionPC}\r\n     */\r\n    this.jvbJingleSession = null;\r\n    this.lastDominantSpeaker = null;\r\n    this.dtmfManager = null;\r\n    this.somebodySupportsDTMF = false;\r\n    this.authEnabled = false;\r\n    this.startAudioMuted = false;\r\n    this.startVideoMuted = false;\r\n    this.startMutedPolicy = {\r\n        audio: false,\r\n        video: false\r\n    };\r\n    this.availableDevices = {\r\n        audio: undefined,\r\n        video: undefined\r\n    };\r\n    this.isMutedByFocus = false;\r\n\r\n    // Flag indicates if the 'onCallEnded' method was ever called on this\r\n    // instance. Used to log extra analytics event for debugging purpose.\r\n    // We need to know if the potential issue happened before or after\r\n    // the restart.\r\n    this.wasStopped = false;\r\n\r\n    /**\r\n     * The object which monitors local and remote connection statistics (e.g.\r\n     * sending bitrate) and calculates a number which represents the connection\r\n     * quality.\r\n     */\r\n    this.connectionQuality\r\n        = new ConnectionQuality(this, this.eventEmitter, options);\r\n\r\n    /**\r\n     * Reports average RTP statistics to the analytics module.\r\n     * @type {AvgRTPStatsReporter}\r\n     */\r\n    this.avgRtpStatsReporter\r\n        = new AvgRTPStatsReporter(this, options.config.avgRtpStatsN || 15);\r\n\r\n    /**\r\n     * Indicates whether the connection is interrupted or not.\r\n     */\r\n    this.isJvbConnectionInterrupted = false;\r\n\r\n    /**\r\n     * The object which tracks active speaker times\r\n     */\r\n    this.speakerStatsCollector = new SpeakerStatsCollector(this);\r\n\r\n    /* P2P related fields below: */\r\n\r\n    /**\r\n     * Stores reference to deferred start P2P task. It's created when 3rd\r\n     * participant leaves the room in order to avoid ping pong effect (it\r\n     * could be just a page reload).\r\n     * @type {number|null}\r\n     */\r\n    this.deferredStartP2PTask = null;\r\n\r\n    const delay\r\n        = parseInt(options.config.p2p && options.config.p2p.backToP2PDelay, 10);\r\n\r\n    /**\r\n     * A delay given in seconds, before the conference switches back to P2P\r\n     * after the 3rd participant has left.\r\n     * @type {number}\r\n     */\r\n    this.backToP2PDelay = isNaN(delay) ? 5 : delay;\r\n    logger.info(`backToP2PDelay: ${this.backToP2PDelay}`);\r\n\r\n    /**\r\n     * If set to <tt>true</tt> it means the P2P ICE is no longer connected.\r\n     * When <tt>false</tt> it means that P2P ICE (media) connection is up\r\n     * and running.\r\n     * @type {boolean}\r\n     */\r\n    this.isP2PConnectionInterrupted = false;\r\n\r\n    /**\r\n     * Flag set to <tt>true</tt> when P2P session has been established\r\n     * (ICE has been connected) and this conference is currently in the peer to\r\n     * peer mode (P2P connection is the active one).\r\n     * @type {boolean}\r\n     */\r\n    this.p2p = false;\r\n\r\n    /**\r\n     * A JingleSession for the direct peer to peer connection.\r\n     * @type {JingleSessionPC}\r\n     */\r\n    this.p2pJingleSession = null;\r\n\r\n    this.videoSIPGWHandler = new VideoSIPGW(this.room);\r\n}\r\n\r\n// FIXME convert JitsiConference to ES6 - ASAP !\r\nJitsiConference.prototype.constructor = JitsiConference;\r\n\r\n/**\r\n * Initializes the conference object properties\r\n * @param options {object}\r\n * @param options.connection {JitsiConnection} overrides this.connection\r\n */\r\nJitsiConference.prototype._init = function(options = {}) {\r\n    // Override connection and xmpp properties (Useful if the connection\r\n    // reloaded)\r\n    if (options.connection) {\r\n        this.connection = options.connection;\r\n        this.xmpp = this.connection.xmpp;\r\n\r\n        // Setup XMPP events only if we have new connection object.\r\n        this.eventManager.setupXMPPListeners();\r\n    }\r\n\r\n    const { config } = this.options;\r\n\r\n    this.room = this.xmpp.createRoom(this.options.name, config);\r\n\r\n    // Connection interrupted/restored listeners\r\n    this._onIceConnectionInterrupted\r\n        = this._onIceConnectionInterrupted.bind(this);\r\n    this.room.addListener(\r\n        XMPPEvents.CONNECTION_INTERRUPTED, this._onIceConnectionInterrupted);\r\n\r\n    this._onIceConnectionRestored = this._onIceConnectionRestored.bind(this);\r\n    this.room.addListener(\r\n        XMPPEvents.CONNECTION_RESTORED, this._onIceConnectionRestored);\r\n\r\n    this._onIceConnectionEstablished\r\n        = this._onIceConnectionEstablished.bind(this);\r\n    this.room.addListener(\r\n        XMPPEvents.CONNECTION_ESTABLISHED, this._onIceConnectionEstablished);\r\n\r\n    this.room.updateDeviceAvailability(RTC.getDeviceAvailability());\r\n\r\n    if (!this.rtc) {\r\n        this.rtc = new RTC(this, options);\r\n        this.eventManager.setupRTCListeners();\r\n    }\r\n\r\n    this.participantConnectionStatus\r\n        = new ParticipantConnectionStatusHandler(\r\n            this.rtc,\r\n            this,\r\n            {\r\n                // Both these options are not public API, leaving it here only\r\n                // as an entry point through config for tuning up purposes.\r\n                // Default values should be adjusted as soon as optimal values\r\n                // are discovered.\r\n                rtcMuteTimeout: config._peerConnStatusRtcMuteTimeout,\r\n                outOfLastNTimeout: config._peerConnStatusOutOfLastNTimeout\r\n            });\r\n    this.participantConnectionStatus.init();\r\n\r\n    if (!this.statistics) {\r\n        // XXX The property location on the global variable window is not\r\n        // defined in all execution environments (e.g. react-native). While\r\n        // jitsi-meet may polyfill it when executing on react-native, it is\r\n        // better for the cross-platform support to not require window.location\r\n        // especially when there is a worthy alternative (as demonstrated\r\n        // bellow).\r\n        const windowLocation = window.location;\r\n\r\n        let callStatsAliasName = this.myUserId();\r\n\r\n        if (config.enableDisplayNameInStats && config.displayName) {\r\n            callStatsAliasName = config.displayName;\r\n        }\r\n\r\n        this.statistics = new Statistics(this.xmpp, {\r\n            callStatsAliasName,\r\n            callStatsConfIDNamespace:\r\n                config.callStatsConfIDNamespace\r\n                    || (windowLocation && windowLocation.hostname)\r\n                    || (config.hosts && config.hosts.domain),\r\n            callStatsCustomScriptUrl: config.callStatsCustomScriptUrl,\r\n            callStatsID: config.callStatsID,\r\n            callStatsSecret: config.callStatsSecret,\r\n            roomName: this.options.name,\r\n            swapUserNameAndAlias: config.enableStatsID,\r\n            applicationName: config.applicationName,\r\n            getWiFiStatsMethod: config.getWiFiStatsMethod\r\n        });\r\n    }\r\n\r\n    this.eventManager.setupChatRoomListeners();\r\n\r\n    // Always add listeners because on reload we are executing leave and the\r\n    // listeners are removed from statistics module.\r\n    this.eventManager.setupStatisticsListeners();\r\n\r\n    if (config.enableTalkWhileMuted) {\r\n        // eslint-disable-next-line no-new\r\n        new TalkMutedDetection(\r\n            this,\r\n            () =>\r\n                this.eventEmitter.emit(JitsiConferenceEvents.TALK_WHILE_MUTED));\r\n    }\r\n\r\n    if ('channelLastN' in config) {\r\n        this.setLastN(config.channelLastN);\r\n    }\r\n\r\n    /**\r\n     * Emits {@link JitsiConferenceEvents.JVB121_STATUS}.\r\n     * @type {Jvb121EventGenerator}\r\n     */\r\n    this.jvb121Status = new Jvb121EventGenerator(this);\r\n\r\n    // creates dominant speaker detection that works only in p2p mode\r\n    this.p2pDominantSpeakerDetection = new P2PDominantSpeakerDetection(this);\r\n};\r\n\r\n/**\r\n * Joins the conference.\r\n * @param password {string} the password\r\n */\r\nJitsiConference.prototype.join = function(password) {\r\n    if (this.room) {\r\n        this.room.join(password);\r\n    }\r\n};\r\n\r\n/**\r\n * Authenticates and upgrades the role of the local participant/user.\r\n *\r\n * @returns {Object} A <tt>thenable</tt> which (1) settles when the process of\r\n * authenticating and upgrading the role of the local participant/user finishes\r\n * and (2) has a <tt>cancel</tt> method that allows the caller to interrupt the\r\n * process.\r\n */\r\nJitsiConference.prototype.authenticateAndUpgradeRole = function(...args) {\r\n    return authenticateAndUpgradeRole.apply(this, args);\r\n};\r\n\r\n/**\r\n * Check if joined to the conference.\r\n */\r\nJitsiConference.prototype.isJoined = function() {\r\n    return this.room && this.room.joined;\r\n};\r\n\r\n/**\r\n * Tells whether or not the P2P mode is enabled in the configuration.\r\n * @return {boolean}\r\n */\r\nJitsiConference.prototype.isP2PEnabled = function() {\r\n    return Boolean(this.options.config.p2p && this.options.config.p2p.enabled)\r\n\r\n        // FIXME: remove once we have a default config template. -saghul\r\n        || typeof this.options.config.p2p === 'undefined';\r\n};\r\n\r\n/**\r\n * When in P2P test mode, the conference will not automatically switch to P2P\r\n * when there 2 participants.\r\n * @return {boolean}\r\n */\r\nJitsiConference.prototype.isP2PTestModeEnabled = function() {\r\n    return Boolean(this.options.config.testing\r\n        && this.options.config.testing.p2pTestMode);\r\n};\r\n\r\n/**\r\n * Leaves the conference.\r\n * @returns {Promise}\r\n */\r\nJitsiConference.prototype.leave = function() {\r\n    if (this.participantConnectionStatus) {\r\n        this.participantConnectionStatus.dispose();\r\n        this.participantConnectionStatus = null;\r\n    }\r\n    if (this.avgRtpStatsReporter) {\r\n        this.avgRtpStatsReporter.dispose();\r\n        this.avgRtpStatsReporter = null;\r\n    }\r\n\r\n    this.getLocalTracks().forEach(track => this.onLocalTrackRemoved(track));\r\n\r\n    this.rtc.closeBridgeChannel();\r\n    if (this.statistics) {\r\n        this.statistics.dispose();\r\n    }\r\n\r\n    // Close both JVb and P2P JingleSessions\r\n    if (this.jvbJingleSession) {\r\n        this.jvbJingleSession.close();\r\n        this.jvbJingleSession = null;\r\n    }\r\n    if (this.p2pJingleSession) {\r\n        this.p2pJingleSession.close();\r\n        this.p2pJingleSession = null;\r\n    }\r\n\r\n    // leave the conference\r\n    if (this.room) {\r\n        const room = this.room;\r\n\r\n        // Unregister connection state listeners\r\n        room.removeListener(\r\n            XMPPEvents.CONNECTION_INTERRUPTED,\r\n            this._onIceConnectionInterrupted);\r\n        room.removeListener(\r\n            XMPPEvents.CONNECTION_RESTORED,\r\n            this._onIceConnectionRestored);\r\n        room.removeListener(\r\n            XMPPEvents.CONNECTION_ESTABLISHED,\r\n            this._onIceConnectionEstablished);\r\n\r\n        this.room = null;\r\n\r\n        return room.leave().catch(() => {\r\n            // remove all participants because currently the conference won't\r\n            // be usable anyway. This is done on success automatically by the\r\n            // ChatRoom instance.\r\n            this.getParticipants().forEach(\r\n                participant => this.onMemberLeft(participant.getJid()));\r\n        });\r\n    }\r\n\r\n    // If this.room == null we are calling second time leave().\r\n    return Promise.reject(\r\n        new Error('The conference is has been already left'));\r\n};\r\n\r\n/**\r\n * Returns name of this conference.\r\n */\r\nJitsiConference.prototype.getName = function() {\r\n    return this.options.name;\r\n};\r\n\r\n/**\r\n * Check if authentication is enabled for this conference.\r\n */\r\nJitsiConference.prototype.isAuthEnabled = function() {\r\n    return this.authEnabled;\r\n};\r\n\r\n/**\r\n * Check if user is logged in.\r\n */\r\nJitsiConference.prototype.isLoggedIn = function() {\r\n    return Boolean(this.authIdentity);\r\n};\r\n\r\n/**\r\n * Get authorized login.\r\n */\r\nJitsiConference.prototype.getAuthLogin = function() {\r\n    return this.authIdentity;\r\n};\r\n\r\n/**\r\n * Check if external authentication is enabled for this conference.\r\n */\r\nJitsiConference.prototype.isExternalAuthEnabled = function() {\r\n    return this.room && this.room.moderator.isExternalAuthEnabled();\r\n};\r\n\r\n/**\r\n * Get url for external authentication.\r\n * @param {boolean} [urlForPopup] if true then return url for login popup,\r\n *                                else url of login page.\r\n * @returns {Promise}\r\n */\r\nJitsiConference.prototype.getExternalAuthUrl = function(urlForPopup) {\r\n    return new Promise((resolve, reject) => {\r\n        if (!this.isExternalAuthEnabled()) {\r\n            reject();\r\n\r\n            return;\r\n        }\r\n        if (urlForPopup) {\r\n            this.room.moderator.getPopupLoginUrl(resolve, reject);\r\n        } else {\r\n            this.room.moderator.getLoginUrl(resolve, reject);\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * Returns the local tracks of the given media type, or all local tracks if no\r\n * specific type is given.\r\n * @param {MediaType} [mediaType] Optional media type (audio or video).\r\n */\r\nJitsiConference.prototype.getLocalTracks = function(mediaType) {\r\n    let tracks = [];\r\n\r\n    if (this.rtc) {\r\n        tracks = this.rtc.getLocalTracks(mediaType);\r\n    }\r\n\r\n    return tracks;\r\n};\r\n\r\n/**\r\n * Obtains local audio track.\r\n * @return {JitsiLocalTrack|null}\r\n */\r\nJitsiConference.prototype.getLocalAudioTrack = function() {\r\n    return this.rtc ? this.rtc.getLocalAudioTrack() : null;\r\n};\r\n\r\n/**\r\n * Obtains local video track.\r\n * @return {JitsiLocalTrack|null}\r\n */\r\nJitsiConference.prototype.getLocalVideoTrack = function() {\r\n    return this.rtc ? this.rtc.getLocalVideoTrack() : null;\r\n};\r\n\r\n/**\r\n * Attaches a handler for events(For example - \"participant joined\".) in the\r\n * conference. All possible event are defined in JitsiConferenceEvents.\r\n * @param eventId the event ID.\r\n * @param handler handler for the event.\r\n *\r\n * Note: consider adding eventing functionality by extending an EventEmitter\r\n * impl, instead of rolling ourselves\r\n */\r\nJitsiConference.prototype.on = function(eventId, handler) {\r\n    if (this.eventEmitter) {\r\n        this.eventEmitter.on(eventId, handler);\r\n    }\r\n};\r\n\r\n/**\r\n * Removes event listener\r\n * @param eventId the event ID.\r\n * @param [handler] optional, the specific handler to unbind\r\n *\r\n * Note: consider adding eventing functionality by extending an EventEmitter\r\n * impl, instead of rolling ourselves\r\n */\r\nJitsiConference.prototype.off = function(eventId, handler) {\r\n    if (this.eventEmitter) {\r\n        this.eventEmitter.removeListener(eventId, handler);\r\n    }\r\n};\r\n\r\n// Common aliases for event emitter\r\nJitsiConference.prototype.addEventListener = JitsiConference.prototype.on;\r\nJitsiConference.prototype.removeEventListener = JitsiConference.prototype.off;\r\n\r\n/**\r\n * Receives notifications from other participants about commands / custom events\r\n * (sent by sendCommand or sendCommandOnce methods).\r\n * @param command {String} the name of the command\r\n * @param handler {Function} handler for the command\r\n */\r\nJitsiConference.prototype.addCommandListener = function(command, handler) {\r\n    if (this.room) {\r\n        this.room.addPresenceListener(command, handler);\r\n    }\r\n};\r\n\r\n/**\r\n  * Removes command  listener\r\n  * @param command {String} the name of the command\r\n  */\r\nJitsiConference.prototype.removeCommandListener = function(command) {\r\n    if (this.room) {\r\n        this.room.removePresenceListener(command);\r\n    }\r\n};\r\n\r\n/**\r\n * Sends text message to the other participants in the conference\r\n * @param message the text message.\r\n */\r\nJitsiConference.prototype.sendTextMessage = function(message) {\r\n    if (this.room) {\r\n        this.room.sendMessage(message);\r\n    }\r\n};\r\n\r\n/**\r\n * Send private text message to another participant of the conference\r\n * @param message the text message.\r\n */\r\nJitsiConference.prototype.sendPrivateTextMessage = function(id, message) {\r\n    if (this.room) {\r\n        this.room.sendPrivateMessage(id, message);\r\n    }\r\n};\r\n\r\n/**\r\n * Send presence command.\r\n * @param name {String} the name of the command.\r\n * @param values {Object} with keys and values that will be sent.\r\n **/\r\nJitsiConference.prototype.sendCommand = function(name, values) {\r\n    if (this.room) {\r\n        this.room.addToPresence(name, values);\r\n        this.room.sendPresence();\r\n    }\r\n};\r\n\r\n/**\r\n * Send presence command one time.\r\n * @param name {String} the name of the command.\r\n * @param values {Object} with keys and values that will be sent.\r\n **/\r\nJitsiConference.prototype.sendCommandOnce = function(name, values) {\r\n    this.sendCommand(name, values);\r\n    this.removeCommand(name);\r\n};\r\n\r\n/**\r\n * Removes presence command.\r\n * @param name {String} the name of the command.\r\n **/\r\nJitsiConference.prototype.removeCommand = function(name) {\r\n    if (this.room) {\r\n        this.room.removeFromPresence(name);\r\n    }\r\n};\r\n\r\n/**\r\n * Sets the display name for this conference.\r\n * @param name the display name to set\r\n */\r\nJitsiConference.prototype.setDisplayName = function(name) {\r\n    if (this.room) {\r\n        // remove previously set nickname\r\n        this.room.removeFromPresence('nick');\r\n\r\n        this.room.addToPresence('nick', {\r\n            attributes: { xmlns: 'http://jabber.org/protocol/nick' },\r\n            value: name\r\n        });\r\n        this.room.sendPresence();\r\n    }\r\n};\r\n\r\n/**\r\n * Set new subject for this conference. (available only for moderator)\r\n * @param {string} subject new subject\r\n */\r\nJitsiConference.prototype.setSubject = function(subject) {\r\n    if (this.room && this.isModerator()) {\r\n        this.room.setSubject(subject);\r\n    }\r\n};\r\n\r\n/**\r\n * Get a transcriber object for all current participants in this conference\r\n * @return {Transcriber} the transcriber object\r\n */\r\nJitsiConference.prototype.getTranscriber = function() {\r\n    if (this.transcriber === undefined) {\r\n        this.transcriber = new Transcriber();\r\n\r\n        // add all existing local audio tracks to the transcriber\r\n        const localAudioTracks = this.getLocalTracks(MediaType.AUDIO);\r\n\r\n        for (const localAudio of localAudioTracks) {\r\n            this.transcriber.addTrack(localAudio);\r\n        }\r\n\r\n        // and all remote audio tracks\r\n        const remoteAudioTracks = this.rtc.getRemoteTracks(MediaType.AUDIO);\r\n\r\n        for (const remoteTrack of remoteAudioTracks) {\r\n            this.transcriber.addTrack(remoteTrack);\r\n        }\r\n    }\r\n\r\n    return this.transcriber;\r\n};\r\n\r\n/**\r\n * Returns the transcription status.\r\n *\r\n * @returns {String} \"on\" or \"off\".\r\n */\r\nJitsiConference.prototype.getTranscriptionStatus = function() {\r\n    return this.room.transcriptionStatus;\r\n};\r\n\r\n/**\r\n * Adds JitsiLocalTrack object to the conference.\r\n * @param track the JitsiLocalTrack object.\r\n * @returns {Promise<JitsiLocalTrack>}\r\n * @throws {Error} if the specified track is a video track and there is already\r\n * another video track in the conference.\r\n */\r\nJitsiConference.prototype.addTrack = function(track) {\r\n    if (track.isVideoTrack()) {\r\n        // Ensure there's exactly 1 local video track in the conference.\r\n        const localVideoTrack = this.rtc.getLocalVideoTrack();\r\n\r\n        if (localVideoTrack) {\r\n            // Don't be excessively harsh and severe if the API client happens\r\n            // to attempt to add the same local video track twice.\r\n            if (track === localVideoTrack) {\r\n                return Promise.resolve(track);\r\n            }\r\n\r\n            return Promise.reject(new Error(\r\n                'cannot add second video track to the conference'));\r\n\r\n        }\r\n    }\r\n\r\n    return this.replaceTrack(null, track);\r\n};\r\n\r\n/**\r\n * Fires TRACK_AUDIO_LEVEL_CHANGED change conference event (for local tracks).\r\n * @param {number} audioLevel the audio level\r\n * @param {TraceablePeerConnection} [tpc]\r\n */\r\nJitsiConference.prototype._fireAudioLevelChangeEvent = function(\r\n        audioLevel,\r\n        tpc) {\r\n    const activeTpc = this.getActivePeerConnection();\r\n\r\n    // There will be no TraceablePeerConnection if audio levels do not come from\r\n    // a peerconnection. LocalStatsCollector.js measures audio levels using Web\r\n    // Audio Analyser API and emits local audio levels events through\r\n    // JitsiTrack.setAudioLevel, but does not provide TPC instance which is\r\n    // optional.\r\n    if (!tpc || activeTpc === tpc) {\r\n        this.eventEmitter.emit(\r\n            JitsiConferenceEvents.TRACK_AUDIO_LEVEL_CHANGED,\r\n            this.myUserId(), audioLevel);\r\n    }\r\n};\r\n\r\n/**\r\n * Fires TRACK_MUTE_CHANGED change conference event.\r\n * @param track the JitsiTrack object related to the event.\r\n */\r\nJitsiConference.prototype._fireMuteChangeEvent = function(track) {\r\n    // check if track was muted by focus and now is unmuted by user\r\n    if (this.isMutedByFocus && track.isAudioTrack() && !track.isMuted()) {\r\n        this.isMutedByFocus = false;\r\n\r\n        // unmute local user on server\r\n        this.room.muteParticipant(this.room.myroomjid, false);\r\n    }\r\n    this.eventEmitter.emit(JitsiConferenceEvents.TRACK_MUTE_CHANGED, track);\r\n};\r\n\r\n/**\r\n * Clear JitsiLocalTrack properties and listeners.\r\n * @param track the JitsiLocalTrack object.\r\n */\r\nJitsiConference.prototype.onLocalTrackRemoved = function(track) {\r\n    track._setConference(null);\r\n    this.rtc.removeLocalTrack(track);\r\n    track.removeEventListener(JitsiTrackEvents.TRACK_MUTE_CHANGED,\r\n        track.muteHandler);\r\n    track.removeEventListener(JitsiTrackEvents.TRACK_AUDIO_LEVEL_CHANGED,\r\n        track.audioLevelHandler);\r\n\r\n    // send event for stopping screen sharing\r\n    // FIXME: we assume we have only one screen sharing track\r\n    // if we change this we need to fix this check\r\n    if (track.isVideoTrack() && track.videoType === VideoType.DESKTOP) {\r\n        this.statistics.sendScreenSharingEvent(false);\r\n    }\r\n\r\n    this.eventEmitter.emit(JitsiConferenceEvents.TRACK_REMOVED, track);\r\n};\r\n\r\n/**\r\n * Removes JitsiLocalTrack from the conference and performs\r\n * a new offer/answer cycle.\r\n * @param {JitsiLocalTrack} track\r\n * @returns {Promise}\r\n */\r\nJitsiConference.prototype.removeTrack = function(track) {\r\n    return this.replaceTrack(track, null);\r\n};\r\n\r\n/**\r\n * Replaces oldTrack with newTrack and performs a single offer/answer\r\n *  cycle after both operations are done.  Either oldTrack or newTrack\r\n *  can be null; replacing a valid 'oldTrack' with a null 'newTrack'\r\n *  effectively just removes 'oldTrack'\r\n * @param {JitsiLocalTrack} oldTrack the current stream in use to be replaced\r\n * @param {JitsiLocalTrack} newTrack the new stream to use\r\n * @returns {Promise} resolves when the replacement is finished\r\n */\r\nJitsiConference.prototype.replaceTrack = function(oldTrack, newTrack) {\r\n    // First do the removal of the oldTrack at the JitsiConference level\r\n    if (oldTrack) {\r\n        if (oldTrack.disposed) {\r\n            return Promise.reject(\r\n                new JitsiTrackError(JitsiTrackErrors.TRACK_IS_DISPOSED));\r\n        }\r\n    }\r\n    if (newTrack) {\r\n        if (newTrack.disposed) {\r\n            return Promise.reject(\r\n                new JitsiTrackError(JitsiTrackErrors.TRACK_IS_DISPOSED));\r\n        }\r\n    }\r\n\r\n    // Now replace the stream at the lower levels\r\n    return this._doReplaceTrack(oldTrack, newTrack)\r\n        .then(() => {\r\n            if (oldTrack) {\r\n                this.onLocalTrackRemoved(oldTrack);\r\n            }\r\n            if (newTrack) {\r\n                // Now handle the addition of the newTrack at the\r\n                // JitsiConference level\r\n                this._setupNewTrack(newTrack);\r\n            }\r\n\r\n            return Promise.resolve();\r\n        }, error => Promise.reject(new Error(error)));\r\n};\r\n\r\n/**\r\n * Replaces the tracks at the lower level by going through the Jingle session\r\n * and WebRTC peer connection. The method will resolve immediately if there is\r\n * currently no JingleSession started.\r\n * @param {JitsiLocalTrack|null} oldTrack the track to be removed during\r\n * the process or <tt>null</t> if the method should act as \"add track\"\r\n * @param {JitsiLocalTrack|null} newTrack the new track to be added or\r\n * <tt>null</tt> if the method should act as \"remove track\"\r\n * @return {Promise} resolved when the process is done or rejected with a string\r\n * which describes the error.\r\n * @private\r\n */\r\nJitsiConference.prototype._doReplaceTrack = function(oldTrack, newTrack) {\r\n    const replaceTrackPromises = [];\r\n\r\n    if (this.jvbJingleSession) {\r\n        replaceTrackPromises.push(\r\n            this.jvbJingleSession.replaceTrack(oldTrack, newTrack));\r\n    } else {\r\n        logger.info('_doReplaceTrack - no JVB JingleSession');\r\n    }\r\n\r\n    if (this.p2pJingleSession) {\r\n        replaceTrackPromises.push(\r\n            this.p2pJingleSession.replaceTrack(oldTrack, newTrack));\r\n    } else {\r\n        logger.info('_doReplaceTrack - no P2P JingleSession');\r\n    }\r\n\r\n    return Promise.all(replaceTrackPromises);\r\n};\r\n\r\n/**\r\n * Operations related to creating a new track\r\n * @param {JitsiLocalTrack} newTrack the new track being created\r\n */\r\nJitsiConference.prototype._setupNewTrack = function(newTrack) {\r\n    if (newTrack.isAudioTrack() || (newTrack.isVideoTrack()\r\n            && newTrack.videoType !== VideoType.DESKTOP)) {\r\n        // Report active device to statistics\r\n        const devices = RTC.getCurrentlyAvailableMediaDevices();\r\n        const device\r\n            = devices.find(\r\n                d =>\r\n                    d.kind === `${newTrack.getTrack().kind}input`\r\n                        && d.label === newTrack.getTrack().label);\r\n\r\n        if (device) {\r\n            Statistics.sendActiveDeviceListEvent(\r\n                RTC.getEventDataForActiveDevice(device));\r\n        }\r\n    }\r\n    if (newTrack.isVideoTrack()) {\r\n        this.removeCommand('videoType');\r\n        this.sendCommand('videoType', {\r\n            value: newTrack.videoType,\r\n            attributes: {\r\n                xmlns: 'http://jitsi.org/jitmeet/video'\r\n            }\r\n        });\r\n    }\r\n    this.rtc.addLocalTrack(newTrack);\r\n\r\n    // ensure that we're sharing proper \"is muted\" state\r\n    if (newTrack.isAudioTrack()) {\r\n        this.room.setAudioMute(newTrack.isMuted());\r\n    } else {\r\n        this.room.setVideoMute(newTrack.isMuted());\r\n    }\r\n\r\n    newTrack.muteHandler = this._fireMuteChangeEvent.bind(this, newTrack);\r\n    newTrack.audioLevelHandler = this._fireAudioLevelChangeEvent.bind(this);\r\n    newTrack.addEventListener(\r\n        JitsiTrackEvents.TRACK_MUTE_CHANGED,\r\n        newTrack.muteHandler);\r\n    newTrack.addEventListener(\r\n        JitsiTrackEvents.TRACK_AUDIO_LEVEL_CHANGED,\r\n        newTrack.audioLevelHandler);\r\n\r\n    newTrack._setConference(this);\r\n\r\n    this.eventEmitter.emit(JitsiConferenceEvents.TRACK_ADDED, newTrack);\r\n};\r\n\r\n/**\r\n * Method called by the {@link JitsiLocalTrack} (a video one) in order to add\r\n * back the underlying WebRTC MediaStream to the PeerConnection (which has\r\n * removed on video mute).\r\n * @param {JitsiLocalTrack} track the local track that will be added as part of\r\n * the unmute operation.\r\n * @return {Promise} resolved when the process is done or rejected with a string\r\n * which describes the error.\r\n */\r\nJitsiConference.prototype._addLocalTrackAsUnmute = function(track) {\r\n    const addAsUnmutePromises = [];\r\n\r\n    if (this.jvbJingleSession) {\r\n        addAsUnmutePromises.push(this.jvbJingleSession.addTrackAsUnmute(track));\r\n    } else {\r\n        logger.info(\r\n            'Add local MediaStream as unmute -'\r\n                + ' no JVB Jingle session started yet');\r\n    }\r\n\r\n    if (this.p2pJingleSession) {\r\n        addAsUnmutePromises.push(this.p2pJingleSession.addTrackAsUnmute(track));\r\n    } else {\r\n        logger.info(\r\n            'Add local MediaStream as unmute -'\r\n                + ' no P2P Jingle session started yet');\r\n    }\r\n\r\n    return Promise.all(addAsUnmutePromises);\r\n};\r\n\r\n/**\r\n * Method called by the {@link JitsiLocalTrack} (a video one) in order to remove\r\n * the underlying WebRTC MediaStream from the PeerConnection. The purpose of\r\n * that is to stop sending any data and turn off the HW camera device.\r\n * @param {JitsiLocalTrack} track the local track that will be removed.\r\n * @return {Promise}\r\n */\r\nJitsiConference.prototype._removeLocalTrackAsMute = function(track) {\r\n    const removeAsMutePromises = [];\r\n\r\n    if (this.jvbJingleSession) {\r\n        removeAsMutePromises.push(\r\n            this.jvbJingleSession.removeTrackAsMute(track));\r\n    } else {\r\n        logger.info(\r\n            'Remove local MediaStream - no JVB JingleSession started yet');\r\n    }\r\n    if (this.p2pJingleSession) {\r\n        removeAsMutePromises.push(\r\n            this.p2pJingleSession.removeTrackAsMute(track));\r\n    } else {\r\n        logger.info(\r\n            'Remove local MediaStream - no P2P JingleSession started yet');\r\n    }\r\n\r\n    return Promise.all(removeAsMutePromises);\r\n};\r\n\r\n/**\r\n * Get role of the local user.\r\n * @returns {string} user role: 'moderator' or 'none'\r\n */\r\nJitsiConference.prototype.getRole = function() {\r\n    return this.room.role;\r\n};\r\n\r\n/**\r\n * Check if local user is moderator.\r\n * @returns {boolean|null} true if local user is moderator, false otherwise. If\r\n * we're no longer in the conference room then <tt>null</tt> is returned.\r\n */\r\nJitsiConference.prototype.isModerator = function() {\r\n    return this.room ? this.room.isModerator() : null;\r\n};\r\n\r\n/**\r\n * Set password for the room.\r\n * @param {string} password new password for the room.\r\n * @returns {Promise}\r\n */\r\nJitsiConference.prototype.lock = function(password) {\r\n    if (!this.isModerator()) {\r\n        return Promise.reject();\r\n    }\r\n\r\n    return new Promise((resolve, reject) => {\r\n        this.room.lockRoom(\r\n            password || '',\r\n            () => resolve(),\r\n            err => reject(err),\r\n            () => reject(JitsiConferenceErrors.PASSWORD_NOT_SUPPORTED));\r\n    });\r\n};\r\n\r\n/**\r\n * Remove password from the room.\r\n * @returns {Promise}\r\n */\r\nJitsiConference.prototype.unlock = function() {\r\n    return this.lock();\r\n};\r\n\r\n/**\r\n * Elects the participant with the given id to be the selected participant in\r\n * order to receive higher video quality (if simulcast is enabled).\r\n * Or cache it if channel is not created and send it once channel is available.\r\n * @param participantId the identifier of the participant\r\n * @throws NetworkError or InvalidStateError or Error if the operation fails.\r\n */\r\nJitsiConference.prototype.selectParticipant = function(participantId) {\r\n    this.rtc.selectEndpoint(participantId);\r\n};\r\n\r\n/**\r\n * Elects the participant with the given id to be the pinned participant in\r\n * order to always receive video for this participant (even when last n is\r\n * enabled).\r\n * @param participantId the identifier of the participant\r\n * @throws NetworkError or InvalidStateError or Error if the operation fails.\r\n */\r\nJitsiConference.prototype.pinParticipant = function(participantId) {\r\n    this.rtc.pinEndpoint(participantId);\r\n};\r\n\r\n/**\r\n * Obtains the current value for \"lastN\". See {@link setLastN} for more info.\r\n * @returns {number}\r\n */\r\nJitsiConference.prototype.getLastN = function() {\r\n    return this.rtc.getLastN();\r\n};\r\n\r\n/**\r\n * Selects a new value for \"lastN\". The requested amount of videos are going\r\n * to be delivered after the value is in effect. Set to -1 for unlimited or\r\n * all available videos.\r\n * @param lastN the new number of videos the user would like to receive.\r\n * @throws Error or RangeError if the given value is not a number or is smaller\r\n * than -1.\r\n */\r\nJitsiConference.prototype.setLastN = function(lastN) {\r\n    if (!Number.isInteger(lastN) && !Number.parseInt(lastN, 10)) {\r\n        throw new Error(`Invalid value for lastN: ${lastN}`);\r\n    }\r\n    const n = Number(lastN);\r\n\r\n    if (n < -1) {\r\n        throw new RangeError('lastN cannot be smaller than -1');\r\n    }\r\n    this.rtc.setLastN(n);\r\n\r\n    // If the P2P session is not fully established yet, we wait until it gets\r\n    // established.\r\n    if (this.p2pJingleSession) {\r\n        const isVideoActive = n !== 0;\r\n\r\n        this.p2pJingleSession\r\n            .setMediaTransferActive(true, isVideoActive)\r\n            .catch(error => {\r\n                logger.error(\r\n                    `Failed to adjust video transfer status (${isVideoActive})`,\r\n                    error);\r\n            });\r\n    }\r\n};\r\n\r\n/**\r\n * Checks if the participant given by participantId is currently included in\r\n * the last N.\r\n * @param {string} participantId the identifier of the participant we would\r\n * like to check.\r\n * @return {boolean} true if the participant with id is in the last N set or\r\n * if there's no last N set, false otherwise.\r\n * @deprecated this method should never be used to figure out the UI, but\r\n * {@link ParticipantConnectionStatus} should be used instead.\r\n */\r\nJitsiConference.prototype.isInLastN = function(participantId) {\r\n    return this.rtc.isInLastN(participantId);\r\n};\r\n\r\n/**\r\n * @return Array<JitsiParticipant> an array of all participants in this\r\n * conference.\r\n */\r\nJitsiConference.prototype.getParticipants = function() {\r\n    return Object.keys(this.participants).map(function(key) {\r\n        return this.participants[key];\r\n    }, this);\r\n};\r\n\r\n/**\r\n * Returns the number of participants in the conference, including the local\r\n * participant.\r\n * @param countHidden {boolean} Whether or not to include hidden participants\r\n * in the count. Default: false.\r\n **/\r\nJitsiConference.prototype.getParticipantCount\r\n    = function(countHidden = false) {\r\n\r\n        let participants = this.getParticipants();\r\n\r\n        if (!countHidden) {\r\n            participants = participants.filter(p => !p.isHidden());\r\n        }\r\n\r\n        // Add one for the local participant.\r\n        return participants.length + 1;\r\n    };\r\n\r\n/**\r\n * @returns {JitsiParticipant} the participant in this conference with the\r\n * specified id (or undefined if there isn't one).\r\n * @param id the id of the participant.\r\n */\r\nJitsiConference.prototype.getParticipantById = function(id) {\r\n    return this.participants[id];\r\n};\r\n\r\n/**\r\n * Kick participant from this conference.\r\n * @param {string} id id of the participant to kick\r\n */\r\nJitsiConference.prototype.kickParticipant = function(id) {\r\n    const participant = this.getParticipantById(id);\r\n\r\n    if (!participant) {\r\n        return;\r\n    }\r\n    this.room.kick(participant.getJid());\r\n};\r\n\r\n/**\r\n * Mutes a participant.\r\n * @param {string} id The id of the participant to mute.\r\n */\r\nJitsiConference.prototype.muteParticipant = function(id) {\r\n    const participant = this.getParticipantById(id);\r\n\r\n    if (!participant) {\r\n        return;\r\n    }\r\n    this.room.muteParticipant(participant.getJid(), true);\r\n};\r\n\r\n/* eslint-disable max-params */\r\n\r\n/**\r\n * Notifies this JitsiConference that a new member has joined its chat room.\r\n *\r\n * FIXME This should NOT be exposed!\r\n *\r\n * @param jid the jid of the participant in the MUC\r\n * @param nick the display name of the participant\r\n * @param role the role of the participant in the MUC\r\n * @param isHidden indicates if this is a hidden participant (system\r\n * participant for example a recorder).\r\n * @param statsID the participant statsID (optional)\r\n * @param status the initial status if any\r\n */\r\nJitsiConference.prototype.onMemberJoined = function(\r\n        jid, nick, role, isHidden, statsID, status) {\r\n    const id = Strophe.getResourceFromJid(jid);\r\n\r\n    if (id === 'focus' || this.myUserId() === id) {\r\n        return;\r\n    }\r\n    const participant\r\n        = new JitsiParticipant(jid, this, nick, isHidden, statsID, status);\r\n\r\n    participant._role = role;\r\n    this.participants[id] = participant;\r\n    this.eventEmitter.emit(\r\n        JitsiConferenceEvents.USER_JOINED,\r\n        id,\r\n        participant);\r\n    this.xmpp.caps.getFeatures(jid)\r\n        .then(features => {\r\n            participant._supportsDTMF = features.has('urn:xmpp:jingle:dtmf:0');\r\n            this.updateDTMFSupport();\r\n        },\r\n        error => logger.warn(`Failed to discover features of ${jid}`, error));\r\n\r\n    this._maybeStartOrStopP2P();\r\n};\r\n\r\n/* eslint-enable max-params */\r\n\r\nJitsiConference.prototype.onMemberLeft = function(jid) {\r\n    const id = Strophe.getResourceFromJid(jid);\r\n\r\n    if (id === 'focus' || this.myUserId() === id) {\r\n        return;\r\n    }\r\n    const participant = this.participants[id];\r\n\r\n    delete this.participants[id];\r\n\r\n    const removedTracks = this.rtc.removeRemoteTracks(id);\r\n\r\n    removedTracks.forEach(\r\n        track =>\r\n            this.eventEmitter.emit(JitsiConferenceEvents.TRACK_REMOVED, track));\r\n\r\n    // there can be no participant in case the member that left is focus\r\n    if (participant) {\r\n        this.eventEmitter.emit(\r\n            JitsiConferenceEvents.USER_LEFT, id, participant);\r\n    }\r\n\r\n    this._maybeStartOrStopP2P(true /* triggered by user left event */);\r\n};\r\n\r\n/**\r\n * Method called on local MUC role change.\r\n * @param {string} role the name of new user's role as defined by XMPP MUC.\r\n */\r\nJitsiConference.prototype.onLocalRoleChanged = function(role) {\r\n    // Emit role changed for local  JID\r\n    this.eventEmitter.emit(\r\n        JitsiConferenceEvents.USER_ROLE_CHANGED, this.myUserId(), role);\r\n\r\n    // Maybe start P2P\r\n    this._maybeStartOrStopP2P();\r\n};\r\n\r\nJitsiConference.prototype.onUserRoleChanged = function(jid, role) {\r\n    const id = Strophe.getResourceFromJid(jid);\r\n    const participant = this.getParticipantById(id);\r\n\r\n    if (!participant) {\r\n        return;\r\n    }\r\n    participant._role = role;\r\n    this.eventEmitter.emit(JitsiConferenceEvents.USER_ROLE_CHANGED, id, role);\r\n};\r\n\r\nJitsiConference.prototype.onDisplayNameChanged = function(jid, displayName) {\r\n    const id = Strophe.getResourceFromJid(jid);\r\n    const participant = this.getParticipantById(id);\r\n\r\n    if (!participant) {\r\n        return;\r\n    }\r\n\r\n    if (participant._displayName === displayName) {\r\n        return;\r\n    }\r\n\r\n    participant._displayName = displayName;\r\n    this.eventEmitter.emit(\r\n        JitsiConferenceEvents.DISPLAY_NAME_CHANGED,\r\n        id,\r\n        displayName);\r\n};\r\n\r\n/**\r\n * Notifies this JitsiConference that a JitsiRemoteTrack was added into\r\n * the conference.\r\n *\r\n * @param {JitsiRemoteTrack} track the JitsiRemoteTrack which was added to this\r\n * JitsiConference\r\n */\r\nJitsiConference.prototype.onRemoteTrackAdded = function(track) {\r\n    if (track.isP2P && !this.isP2PActive()) {\r\n        logger.info(\r\n            'Trying to add remote P2P track, when not in P2P - IGNORED');\r\n\r\n        return;\r\n    } else if (!track.isP2P && this.isP2PActive()) {\r\n        logger.info(\r\n            'Trying to add remote JVB track, when in P2P - IGNORED');\r\n\r\n        return;\r\n    }\r\n\r\n    const id = track.getParticipantId();\r\n    const participant = this.getParticipantById(id);\r\n\r\n    if (!participant) {\r\n        logger.error(`No participant found for id: ${id}`);\r\n\r\n        return;\r\n    }\r\n\r\n    // Add track to JitsiParticipant.\r\n    participant._tracks.push(track);\r\n\r\n    if (this.transcriber) {\r\n        this.transcriber.addTrack(track);\r\n    }\r\n\r\n    const emitter = this.eventEmitter;\r\n\r\n    track.addEventListener(\r\n        JitsiTrackEvents.TRACK_MUTE_CHANGED,\r\n        () => emitter.emit(JitsiConferenceEvents.TRACK_MUTE_CHANGED, track));\r\n    track.addEventListener(\r\n        JitsiTrackEvents.TRACK_AUDIO_LEVEL_CHANGED,\r\n        (audioLevel, tpc) => {\r\n            const activeTPC = this.getActivePeerConnection();\r\n\r\n            if (activeTPC === tpc) {\r\n                emitter.emit(\r\n                    JitsiConferenceEvents.TRACK_AUDIO_LEVEL_CHANGED,\r\n                    id,\r\n                    audioLevel);\r\n            }\r\n        }\r\n    );\r\n\r\n    emitter.emit(JitsiConferenceEvents.TRACK_ADDED, track);\r\n};\r\n\r\n/**\r\n * Callback called by the Jingle plugin when 'session-answer' is received.\r\n * @param {JingleSessionPC} session the Jingle session for which an answer was\r\n * received.\r\n * @param {jQuery} answer a jQuery selector pointing to 'jingle' IQ element\r\n */\r\n// eslint-disable-next-line no-unused-vars\r\nJitsiConference.prototype.onCallAccepted = function(session, answer) {\r\n    if (this.p2pJingleSession === session) {\r\n        logger.info('P2P setAnswer');\r\n        this.p2pJingleSession.setAnswer(answer);\r\n    }\r\n};\r\n\r\n/**\r\n * Callback called by the Jingle plugin when 'transport-info' is received.\r\n * @param {JingleSessionPC} session the Jingle session for which the IQ was\r\n * received\r\n * @param {jQuery} transportInfo a jQuery selector pointing to 'jingle' IQ\r\n * element\r\n */\r\n// eslint-disable-next-line no-unused-vars\r\nJitsiConference.prototype.onTransportInfo = function(session, transportInfo) {\r\n    if (this.p2pJingleSession === session) {\r\n        logger.info('P2P addIceCandidates');\r\n        this.p2pJingleSession.addIceCandidates(transportInfo);\r\n    }\r\n};\r\n\r\n/**\r\n * Notifies this JitsiConference that a JitsiRemoteTrack was removed from\r\n * the conference.\r\n *\r\n * @param {JitsiRemoteTrack} removedTrack\r\n */\r\nJitsiConference.prototype.onRemoteTrackRemoved = function(removedTrack) {\r\n    this.getParticipants().forEach(participant => {\r\n        const tracks = participant.getTracks();\r\n\r\n        for (let i = 0; i < tracks.length; i++) {\r\n            if (tracks[i] === removedTrack) {\r\n                // Since the tracks have been compared and are\r\n                // considered equal the result of splice can be ignored.\r\n                participant._tracks.splice(i, 1);\r\n\r\n                this.eventEmitter.emit(\r\n                    JitsiConferenceEvents.TRACK_REMOVED, removedTrack);\r\n\r\n                if (this.transcriber) {\r\n                    this.transcriber.removeTrack(removedTrack);\r\n                }\r\n\r\n                break;\r\n            }\r\n        }\r\n    }, this);\r\n};\r\n\r\n/**\r\n * Handles an incoming call event for the P2P jingle session.\r\n */\r\nJitsiConference.prototype._onIncomingCallP2P = function(\r\n        jingleSession,\r\n        jingleOffer) {\r\n\r\n    let rejectReason;\r\n    const role = this.room.getMemberRole(jingleSession.remoteJid);\r\n\r\n    if (role !== 'moderator') {\r\n        rejectReason = {\r\n            reason: 'security-error',\r\n            reasonDescription: 'Only focus can start new sessions',\r\n            errorMsg: 'Rejecting session-initiate from non-focus and'\r\n                        + `non-moderator user: ${jingleSession.remoteJid}`\r\n        };\r\n    } else if (!browser.supportsP2P()) {\r\n        rejectReason = {\r\n            reason: 'unsupported-applications',\r\n            reasonDescription: 'P2P not supported',\r\n            errorMsg: 'This client does not support P2P connections'\r\n        };\r\n    } else if (!this.isP2PEnabled() && !this.isP2PTestModeEnabled()) {\r\n        rejectReason = {\r\n            reason: 'decline',\r\n            reasonDescription: 'P2P disabled',\r\n            errorMsg: 'P2P mode disabled in the configuration'\r\n        };\r\n    } else if (this.p2pJingleSession) {\r\n        // Reject incoming P2P call (already in progress)\r\n        rejectReason = {\r\n            reason: 'busy',\r\n            reasonDescription: 'P2P already in progress',\r\n            errorMsg: 'Duplicated P2P \"session-initiate\"'\r\n        };\r\n    }\r\n\r\n    if (rejectReason) {\r\n        this._rejectIncomingCall(jingleSession, rejectReason);\r\n    } else {\r\n        this._acceptP2PIncomingCall(jingleSession, jingleOffer);\r\n    }\r\n};\r\n\r\n/**\r\n * Handles an incoming call event.\r\n */\r\nJitsiConference.prototype.onIncomingCall = function(\r\n        jingleSession,\r\n        jingleOffer,\r\n        now) {\r\n    // Handle incoming P2P call\r\n    if (jingleSession.isP2P) {\r\n        this._onIncomingCallP2P(jingleSession, jingleOffer);\r\n    } else {\r\n        if (!this.room.isFocus(jingleSession.remoteJid)) {\r\n            const description = 'Rejecting session-initiate from non-focus.';\r\n\r\n            this._rejectIncomingCall(\r\n                jingleSession, {\r\n                    reason: 'security-error',\r\n                    reasonDescription: description,\r\n                    errorMsg: description\r\n                });\r\n\r\n            return;\r\n        }\r\n        this._acceptJvbIncomingCall(jingleSession, jingleOffer, now);\r\n    }\r\n};\r\n\r\n/**\r\n * Accepts an incoming call event for the JVB jingle session.\r\n */\r\nJitsiConference.prototype._acceptJvbIncomingCall = function(\r\n        jingleSession,\r\n        jingleOffer,\r\n        now) {\r\n\r\n    // Accept incoming call\r\n    this.jvbJingleSession = jingleSession;\r\n    this.room.connectionTimes['session.initiate'] = now;\r\n\r\n    if (this.wasStopped) {\r\n        Statistics.sendAnalyticsAndLog(\r\n            createJingleEvent(ACTION_JINGLE_RESTART, { p2p: false }));\r\n    }\r\n\r\n    Statistics.sendAnalytics(createJingleEvent(\r\n        ACTION_JINGLE_SI_RECEIVED,\r\n        {\r\n            p2p: false,\r\n            value: now\r\n        }));\r\n    try {\r\n        jingleSession.initialize(false /* initiator */, this.room, this.rtc);\r\n    } catch (error) {\r\n        GlobalOnErrorHandler.callErrorHandler(error);\r\n    }\r\n\r\n    // Open a channel with the videobridge.\r\n    this._setBridgeChannel(jingleOffer, jingleSession.peerconnection);\r\n\r\n    // Add local tracks to the session\r\n    try {\r\n        jingleSession.acceptOffer(\r\n            jingleOffer,\r\n            () => {\r\n                // If for any reason invite for the JVB session arrived after\r\n                // the P2P has been established already the media transfer needs\r\n                // to be turned off here.\r\n                if (this.isP2PActive() && this.jvbJingleSession) {\r\n                    this._suspendMediaTransferForJvbConnection();\r\n                }\r\n            },\r\n            error => {\r\n                GlobalOnErrorHandler.callErrorHandler(error);\r\n                logger.error(\r\n                    'Failed to accept incoming Jingle session', error);\r\n            },\r\n            this.getLocalTracks()\r\n        );\r\n\r\n        // Start callstats as soon as peerconnection is initialized,\r\n        // do not wait for XMPPEvents.PEERCONNECTION_READY, as it may never\r\n        // happen in case if user doesn't have or denied permission to\r\n        // both camera and microphone.\r\n        logger.info('Starting CallStats for JVB connection...');\r\n        this.statistics.startCallStats(\r\n            this.jvbJingleSession.peerconnection,\r\n            'jitsi' /* Remote user ID for JVB is 'jitsi' */);\r\n        this.statistics.startRemoteStats(this.jvbJingleSession.peerconnection);\r\n    } catch (e) {\r\n        GlobalOnErrorHandler.callErrorHandler(e);\r\n        logger.error(e);\r\n    }\r\n};\r\n\r\n/**\r\n * Sets the BridgeChannel.\r\n *\r\n * @param {jQuery} offerIq a jQuery selector pointing to the jingle element of\r\n * the offer IQ which may carry the WebSocket URL for the 'websocket'\r\n * BridgeChannel mode.\r\n * @param {TraceablePeerConnection} pc the peer connection which will be used\r\n * to listen for new WebRTC Data Channels (in the 'datachannel' mode).\r\n */\r\nJitsiConference.prototype._setBridgeChannel = function(offerIq, pc) {\r\n    let wsUrl = null;\r\n    const webSocket\r\n        = $(offerIq)\r\n            .find('>content>transport>web-socket')\r\n            .first();\r\n\r\n    if (webSocket.length === 1) {\r\n        wsUrl = webSocket[0].getAttribute('url');\r\n    }\r\n\r\n    let bridgeChannelType;\r\n\r\n    switch (this.options.config.openBridgeChannel) {\r\n    case 'datachannel':\r\n    case true:\r\n    case undefined:\r\n        bridgeChannelType = 'datachannel';\r\n        break;\r\n    case 'websocket':\r\n        bridgeChannelType = 'websocket';\r\n        break;\r\n    }\r\n\r\n    if (bridgeChannelType === 'datachannel'\r\n        && !browser.supportsDataChannels()) {\r\n        bridgeChannelType = 'websocket';\r\n    }\r\n\r\n    if (bridgeChannelType === 'datachannel') {\r\n        this.rtc.initializeBridgeChannel(pc, null);\r\n    } else if (bridgeChannelType === 'websocket' && wsUrl) {\r\n        this.rtc.initializeBridgeChannel(null, wsUrl);\r\n    }\r\n};\r\n\r\n/**\r\n * Rejects incoming Jingle call.\r\n * @param {JingleSessionPC} jingleSession the session instance to be rejected.\r\n * @param {object} [options]\r\n * @param {string} options.reason the name of the reason element as defined\r\n * by Jingle\r\n * @param {string} options.reasonDescription the reason description which will\r\n * be included in Jingle 'session-terminate' message.\r\n * @param {string} options.errorMsg an error message to be logged on global\r\n * error handler\r\n * @private\r\n */\r\nJitsiConference.prototype._rejectIncomingCall = function(\r\n        jingleSession,\r\n        options) {\r\n    if (options && options.errorMsg) {\r\n        GlobalOnErrorHandler.callErrorHandler(new Error(options.errorMsg));\r\n    }\r\n\r\n    // Terminate the jingle session with a reason\r\n    jingleSession.terminate(\r\n        null /* success callback => we don't care */,\r\n        error => {\r\n            logger.warn(\r\n                'An error occurred while trying to terminate'\r\n                    + ' invalid Jingle session', error);\r\n        }, {\r\n            reason: options && options.reason,\r\n            reasonDescription: options && options.reasonDescription,\r\n            sendSessionTerminate: true\r\n        });\r\n};\r\n\r\n/**\r\n * Handles the call ended event.\r\n * XXX is this due to the remote side terminating the Jingle session?\r\n *\r\n * @param {JingleSessionPC} jingleSession the jingle session which has been\r\n * terminated.\r\n * @param {String} reasonCondition the Jingle reason condition.\r\n * @param {String|null} reasonText human readable reason text which may provide\r\n * more details about why the call has been terminated.\r\n */\r\nJitsiConference.prototype.onCallEnded = function(\r\n        jingleSession,\r\n        reasonCondition,\r\n        reasonText) {\r\n    logger.info(\r\n        `Call ended: ${reasonCondition} - ${reasonText} P2P ?${\r\n            jingleSession.isP2P}`);\r\n    if (jingleSession === this.jvbJingleSession) {\r\n        this.wasStopped = true;\r\n\r\n        Statistics.sendAnalytics(\r\n            createJingleEvent(ACTION_JINGLE_TERMINATE, { p2p: false }));\r\n\r\n        // Stop the stats\r\n        if (this.statistics) {\r\n            this.statistics.stopRemoteStats(\r\n                this.jvbJingleSession.peerconnection);\r\n            logger.info('Stopping JVB CallStats');\r\n            this.statistics.stopCallStats(\r\n                this.jvbJingleSession.peerconnection);\r\n        }\r\n\r\n        // Current JVB JingleSession is no longer valid, so set it to null\r\n        this.jvbJingleSession = null;\r\n\r\n        // Let the RTC service do any cleanups\r\n        this.rtc.onCallEnded();\r\n    } else if (jingleSession === this.p2pJingleSession) {\r\n        // It's the responder who decides to enforce JVB mode, so that both\r\n        // initiator and responder are aware if it was intentional.\r\n        if (reasonCondition === 'decline' && reasonText === 'force JVB121') {\r\n            logger.info('In forced JVB 121 mode...');\r\n            Statistics.analytics.addPermanentProperties({ forceJvb121: true });\r\n        } else if (reasonCondition === 'connectivity-error'\r\n            && reasonText === 'ICE FAILED') {\r\n            // It can happen that the other peer detects ICE failed and\r\n            // terminates the session, before we get the event on our side.\r\n            // But we are able to parse the reason and mark it here.\r\n            Statistics.analytics.addPermanentProperties({ p2pFailed: true });\r\n        }\r\n        this._stopP2PSession();\r\n    } else {\r\n        logger.error(\r\n            'Received onCallEnded for invalid session',\r\n            jingleSession.sid,\r\n            jingleSession.remoteJid,\r\n            reasonCondition,\r\n            reasonText);\r\n    }\r\n};\r\n\r\n/**\r\n * Handles the suspend detected event. Leaves the room and fires suspended.\r\n * @param {JingleSessionPC} jingleSession\r\n */\r\nJitsiConference.prototype.onSuspendDetected = function(jingleSession) {\r\n    if (!jingleSession.isP2P) {\r\n        this.leave();\r\n        this.eventEmitter.emit(JitsiConferenceEvents.SUSPEND_DETECTED);\r\n    }\r\n};\r\n\r\nJitsiConference.prototype.updateDTMFSupport = function() {\r\n    let somebodySupportsDTMF = false;\r\n    const participants = this.getParticipants();\r\n\r\n    // check if at least 1 participant supports DTMF\r\n    for (let i = 0; i < participants.length; i += 1) {\r\n        if (participants[i].supportsDTMF()) {\r\n            somebodySupportsDTMF = true;\r\n            break;\r\n        }\r\n    }\r\n    if (somebodySupportsDTMF !== this.somebodySupportsDTMF) {\r\n        this.somebodySupportsDTMF = somebodySupportsDTMF;\r\n        this.eventEmitter.emit(\r\n            JitsiConferenceEvents.DTMF_SUPPORT_CHANGED,\r\n            somebodySupportsDTMF);\r\n    }\r\n};\r\n\r\n/**\r\n * Allows to check if there is at least one user in the conference\r\n * that supports DTMF.\r\n * @returns {boolean} true if somebody supports DTMF, false otherwise\r\n */\r\nJitsiConference.prototype.isDTMFSupported = function() {\r\n    return this.somebodySupportsDTMF;\r\n};\r\n\r\n/**\r\n * Returns the local user's ID\r\n * @return {string} local user's ID\r\n */\r\nJitsiConference.prototype.myUserId = function() {\r\n    return (\r\n        this.room && this.room.myroomjid\r\n            ? Strophe.getResourceFromJid(this.room.myroomjid)\r\n            : null);\r\n};\r\n\r\nJitsiConference.prototype.sendTones = function(tones, duration, pause) {\r\n    if (!this.dtmfManager) {\r\n        const peerConnection = this.getActivePeerConnection();\r\n\r\n        if (!peerConnection) {\r\n            logger.warn('cannot sendTones: no peer connection');\r\n\r\n            return;\r\n        }\r\n\r\n        const localAudio = this.getLocalAudioTrack();\r\n\r\n        if (!localAudio) {\r\n            logger.warn('cannot sendTones: no local audio stream');\r\n\r\n            return;\r\n        }\r\n        this.dtmfManager = new JitsiDTMFManager(localAudio, peerConnection);\r\n    }\r\n\r\n    this.dtmfManager.sendTones(tones, duration, pause);\r\n};\r\n\r\n/**\r\n * Returns true if recording is supported and false if not.\r\n */\r\nJitsiConference.prototype.isRecordingSupported = function() {\r\n    if (this.room) {\r\n        return this.room.isRecordingSupported();\r\n    }\r\n\r\n    return false;\r\n};\r\n\r\n/**\r\n * Returns null if the recording is not supported, \"on\" if the recording started\r\n * and \"off\" if the recording is not started.\r\n */\r\nJitsiConference.prototype.getRecordingState = function() {\r\n    return this.room ? this.room.getRecordingState() : undefined;\r\n};\r\n\r\n/**\r\n * Returns the url of the recorded video.\r\n */\r\nJitsiConference.prototype.getRecordingURL = function() {\r\n    return this.room ? this.room.getRecordingURL() : null;\r\n};\r\n\r\n/**\r\n * Starts/stops the recording\r\n */\r\nJitsiConference.prototype.toggleRecording = function(options) {\r\n    if (this.room) {\r\n        return this.room.toggleRecording(options, (status, error) => {\r\n            this.eventEmitter.emit(\r\n                JitsiConferenceEvents.RECORDER_STATE_CHANGED, status, error);\r\n        });\r\n    }\r\n    this.eventEmitter.emit(\r\n        JitsiConferenceEvents.RECORDER_STATE_CHANGED, 'error',\r\n        new Error('The conference is not created yet!'));\r\n};\r\n\r\n/**\r\n * Returns true if the SIP calls are supported and false otherwise\r\n */\r\nJitsiConference.prototype.isSIPCallingSupported = function() {\r\n    if (this.room) {\r\n        return this.room.isSIPCallingSupported();\r\n    }\r\n\r\n    return false;\r\n};\r\n\r\n/**\r\n * Dials a number.\r\n * @param number the number\r\n */\r\nJitsiConference.prototype.dial = function(number) {\r\n    if (this.room) {\r\n        return this.room.dial(number);\r\n    }\r\n\r\n    return new Promise((resolve, reject) => {\r\n        reject(new Error('The conference is not created yet!'));\r\n    });\r\n};\r\n\r\n/**\r\n * Hangup an existing call\r\n */\r\nJitsiConference.prototype.hangup = function() {\r\n    if (this.room) {\r\n        return this.room.hangup();\r\n    }\r\n\r\n    return new Promise((resolve, reject) => {\r\n        reject(new Error('The conference is not created yet!'));\r\n    });\r\n};\r\n\r\n/**\r\n * Starts the transcription service.\r\n */\r\nJitsiConference.prototype.startTranscriber = function() {\r\n    return this.dial('jitsi_meet_transcribe');\r\n};\r\n\r\n\r\n/**\r\n * Stops the transcription service.\r\n */\r\nJitsiConference.prototype.stopTranscriber = JitsiConference.prototype.hangup;\r\n\r\n/**\r\n * Returns the phone number for joining the conference.\r\n */\r\nJitsiConference.prototype.getPhoneNumber = function() {\r\n    if (this.room) {\r\n        return this.room.getPhoneNumber();\r\n    }\r\n\r\n    return null;\r\n};\r\n\r\n/**\r\n * Returns the pin for joining the conference with phone.\r\n */\r\nJitsiConference.prototype.getPhonePin = function() {\r\n    if (this.room) {\r\n        return this.room.getPhonePin();\r\n    }\r\n\r\n    return null;\r\n};\r\n\r\n/**\r\n * Will return P2P or JVB <tt>TraceablePeerConnection</tt> depending on\r\n * which connection is currently active.\r\n *\r\n * @return {TraceablePeerConnection|null} null if there isn't any active\r\n * <tt>TraceablePeerConnection</tt> currently available.\r\n * @public (FIXME how to make package local ?)\r\n */\r\nJitsiConference.prototype.getActivePeerConnection = function() {\r\n    if (this.isP2PActive()) {\r\n        return this.p2pJingleSession.peerconnection;\r\n    }\r\n\r\n    return this.jvbJingleSession ? this.jvbJingleSession.peerconnection : null;\r\n};\r\n\r\n/**\r\n * Returns the connection state for the current room. Its ice connection state\r\n * for its session.\r\n * NOTE that \"completed\" ICE state which can appear on the P2P connection will\r\n * be converted to \"connected\".\r\n * @return {string|null} ICE state name or <tt>null</tt> if there is no active\r\n * peer connection at this time.\r\n */\r\nJitsiConference.prototype.getConnectionState = function() {\r\n    const peerConnection = this.getActivePeerConnection();\r\n\r\n    return peerConnection ? peerConnection.getConnectionState() : null;\r\n};\r\n\r\n/**\r\n * Make all new participants mute their audio/video on join.\r\n * @param policy {Object} object with 2 boolean properties for video and audio:\r\n * @param {boolean} audio if audio should be muted.\r\n * @param {boolean} video if video should be muted.\r\n */\r\nJitsiConference.prototype.setStartMutedPolicy = function(policy) {\r\n    if (!this.isModerator()) {\r\n        return;\r\n    }\r\n    this.startMutedPolicy = policy;\r\n    this.room.removeFromPresence('startmuted');\r\n    this.room.addToPresence('startmuted', {\r\n        attributes: {\r\n            audio: policy.audio,\r\n            video: policy.video,\r\n            xmlns: 'http://jitsi.org/jitmeet/start-muted'\r\n        }\r\n    });\r\n    this.room.sendPresence();\r\n};\r\n\r\n/**\r\n * Returns current start muted policy\r\n * @returns {Object} with 2 properties - audio and video.\r\n */\r\nJitsiConference.prototype.getStartMutedPolicy = function() {\r\n    return this.startMutedPolicy;\r\n};\r\n\r\n/**\r\n * Check if audio is muted on join.\r\n */\r\nJitsiConference.prototype.isStartAudioMuted = function() {\r\n    return this.startAudioMuted;\r\n};\r\n\r\n/**\r\n * Check if video is muted on join.\r\n */\r\nJitsiConference.prototype.isStartVideoMuted = function() {\r\n    return this.startVideoMuted;\r\n};\r\n\r\n/**\r\n * Get object with internal logs.\r\n */\r\nJitsiConference.prototype.getLogs = function() {\r\n    const data = this.xmpp.getJingleLog();\r\n\r\n    const metadata = {};\r\n\r\n    metadata.time = new Date();\r\n    metadata.url = window.location.href;\r\n    metadata.ua = navigator.userAgent;\r\n\r\n    const log = this.xmpp.getXmppLog();\r\n\r\n    if (log) {\r\n        metadata.xmpp = log;\r\n    }\r\n\r\n    data.metadata = metadata;\r\n\r\n    return data;\r\n};\r\n\r\n/**\r\n * Returns measured connectionTimes.\r\n */\r\nJitsiConference.prototype.getConnectionTimes = function() {\r\n    return this.room.connectionTimes;\r\n};\r\n\r\n/**\r\n * Sets a property for the local participant.\r\n */\r\nJitsiConference.prototype.setLocalParticipantProperty = function(name, value) {\r\n    this.sendCommand(`jitsi_participant_${name}`, { value });\r\n};\r\n\r\n/**\r\n * Sends the given feedback through CallStats if enabled.\r\n *\r\n * @param overallFeedback an integer between 1 and 5 indicating the\r\n * user feedback\r\n * @param detailedFeedback detailed feedback from the user. Not yet used\r\n */\r\nJitsiConference.prototype.sendFeedback = function(\r\n        overallFeedback,\r\n        detailedFeedback) {\r\n    this.statistics.sendFeedback(overallFeedback, detailedFeedback);\r\n};\r\n\r\n/**\r\n * Returns true if the callstats integration is enabled, otherwise returns\r\n * false.\r\n *\r\n * @returns true if the callstats integration is enabled, otherwise returns\r\n * false.\r\n */\r\nJitsiConference.prototype.isCallstatsEnabled = function() {\r\n    return this.statistics.isCallstatsEnabled();\r\n};\r\n\r\n\r\n/**\r\n * Handles track attached to container (Calls associateStreamWithVideoTag method\r\n * from statistics module)\r\n * @param {JitsiLocalTrack|JitsiRemoteTrack} track the track\r\n * @param container the container\r\n */\r\nJitsiConference.prototype._onTrackAttach = function(track, container) {\r\n    const isLocal = track.isLocal();\r\n    let ssrc = null;\r\n    const isP2P = track.isP2P;\r\n    const remoteUserId = isP2P ? track.getParticipantId() : 'jitsi';\r\n    const peerConnection\r\n        = isP2P\r\n            ? this.p2pJingleSession && this.p2pJingleSession.peerconnection\r\n            : this.jvbJingleSession && this.jvbJingleSession.peerconnection;\r\n\r\n    if (isLocal) {\r\n        // Local tracks have SSRC stored on per peer connection basis\r\n        if (peerConnection) {\r\n            ssrc = peerConnection.getLocalSSRC(track);\r\n        }\r\n    } else {\r\n        ssrc = track.getSSRC();\r\n    }\r\n    if (!container.id || !ssrc || !peerConnection) {\r\n        return;\r\n    }\r\n\r\n    this.statistics.associateStreamWithVideoTag(\r\n        peerConnection,\r\n        ssrc,\r\n        isLocal,\r\n        remoteUserId,\r\n        track.getUsageLabel(),\r\n        container.id);\r\n};\r\n\r\n/**\r\n * Logs an \"application log\" message.\r\n * @param message {string} The message to log. Note that while this can be a\r\n * generic string, the convention used by lib-jitsi-meet and jitsi-meet is to\r\n * log valid JSON strings, with an \"id\" field used for distinguishing between\r\n * message types. E.g.: {id: \"recorder_status\", status: \"off\"}\r\n */\r\nJitsiConference.prototype.sendApplicationLog = function(message) {\r\n    Statistics.sendLog(message);\r\n};\r\n\r\n/**\r\n * Checks if the user identified by given <tt>mucJid</tt> is the conference\r\n * focus.\r\n * @param mucJid the full MUC address of the user to be checked.\r\n * @returns {boolean|null} <tt>true</tt> if MUC user is the conference focus,\r\n * <tt>false</tt> when is not. <tt>null</tt> if we're not in the MUC anymore and\r\n * are unable to figure out the status or if given <tt>mucJid</tt> is invalid.\r\n */\r\nJitsiConference.prototype._isFocus = function(mucJid) {\r\n    return this.room ? this.room.isFocus(mucJid) : null;\r\n};\r\n\r\n/**\r\n * Fires CONFERENCE_FAILED event with INCOMPATIBLE_SERVER_VERSIONS parameter\r\n */\r\nJitsiConference.prototype._fireIncompatibleVersionsEvent = function() {\r\n    this.eventEmitter.emit(JitsiConferenceEvents.CONFERENCE_FAILED,\r\n        JitsiConferenceErrors.INCOMPATIBLE_SERVER_VERSIONS);\r\n};\r\n\r\n/**\r\n * Sends a message via the data channel.\r\n * @param to {string} the id of the endpoint that should receive the message.\r\n * If \"\" the message will be sent to all participants.\r\n * @param payload {object} the payload of the message.\r\n * @throws NetworkError or InvalidStateError or Error if the operation fails.\r\n */\r\nJitsiConference.prototype.sendEndpointMessage = function(to, payload) {\r\n    this.rtc.sendChannelMessage(to, payload);\r\n};\r\n\r\n/**\r\n * Sends a broadcast message via the data channel.\r\n * @param payload {object} the payload of the message.\r\n * @throws NetworkError or InvalidStateError or Error if the operation fails.\r\n */\r\nJitsiConference.prototype.broadcastEndpointMessage = function(payload) {\r\n    this.sendEndpointMessage('', payload);\r\n};\r\n\r\nJitsiConference.prototype.isConnectionInterrupted = function() {\r\n    return this.isP2PActive()\r\n        ? this.isP2PConnectionInterrupted : this.isJvbConnectionInterrupted;\r\n};\r\n\r\n/**\r\n * Handles {@link XMPPEvents.CONNECTION_INTERRUPTED}\r\n * @param {JingleSessionPC} session\r\n * @private\r\n */\r\nJitsiConference.prototype._onIceConnectionInterrupted = function(session) {\r\n    if (session.isP2P) {\r\n        this.isP2PConnectionInterrupted = true;\r\n    } else {\r\n        this.isJvbConnectionInterrupted = true;\r\n    }\r\n    if (session.isP2P === this.isP2PActive()) {\r\n        this.eventEmitter.emit(JitsiConferenceEvents.CONNECTION_INTERRUPTED);\r\n    }\r\n};\r\n\r\n/**\r\n * Handles {@link XMPPEvents.CONNECTION_ICE_FAILED}\r\n * @param {JingleSessionPC} session\r\n * @private\r\n */\r\nJitsiConference.prototype._onIceConnectionFailed = function(session) {\r\n    // We do nothing for the JVB connection, because it's up to the Jicofo to\r\n    // eventually come up with the new offer (at least for the time being).\r\n    if (session.isP2P) {\r\n        // Add p2pFailed property to analytics to distinguish, between \"good\"\r\n        // and \"bad\" connection\r\n        Statistics.analytics.addPermanentProperties({ p2pFailed: true });\r\n\r\n        if (this.p2pJingleSession) {\r\n            Statistics.sendAnalyticsAndLog(\r\n                createP2PEvent(\r\n                    ACTION_P2P_FAILED,\r\n                    {\r\n                        initiator: this.p2pJingleSession.isInitiator\r\n                    }));\r\n\r\n        }\r\n        this._stopP2PSession('connectivity-error', 'ICE FAILED');\r\n    }\r\n};\r\n\r\n/**\r\n * Handles {@link XMPPEvents.CONNECTION_RESTORED}\r\n * @param {JingleSessionPC} session\r\n * @private\r\n */\r\nJitsiConference.prototype._onIceConnectionRestored = function(session) {\r\n    if (session.isP2P) {\r\n        this.isP2PConnectionInterrupted = false;\r\n    } else {\r\n        this.isJvbConnectionInterrupted = false;\r\n    }\r\n\r\n    if (session.isP2P === this.isP2PActive()) {\r\n        this.eventEmitter.emit(JitsiConferenceEvents.CONNECTION_RESTORED);\r\n    }\r\n};\r\n\r\n/**\r\n * Accept incoming P2P Jingle call.\r\n * @param {JingleSessionPC} jingleSession the session instance\r\n * @param {jQuery} jingleOffer a jQuery selector pointing to 'jingle' IQ element\r\n * @private\r\n */\r\nJitsiConference.prototype._acceptP2PIncomingCall = function(\r\n        jingleSession,\r\n        jingleOffer) {\r\n    this.isP2PConnectionInterrupted = false;\r\n\r\n    // Accept the offer\r\n    this.p2pJingleSession = jingleSession;\r\n\r\n    this.p2pJingleSession.initialize(\r\n        false /* initiator */, this.room, this.rtc);\r\n\r\n    logger.info('Starting CallStats for P2P connection...');\r\n\r\n    let remoteID = Strophe.getResourceFromJid(this.p2pJingleSession.remoteJid);\r\n\r\n    if (this.options.config.enableStatsID) {\r\n        const participant = this.participants[remoteID];\r\n\r\n        if (participant) {\r\n            remoteID = participant.getStatsID() || remoteID;\r\n        }\r\n    }\r\n\r\n    this.statistics.startCallStats(\r\n        this.p2pJingleSession.peerconnection,\r\n        remoteID);\r\n\r\n    const localTracks = this.getLocalTracks();\r\n\r\n    this.p2pJingleSession.acceptOffer(\r\n        jingleOffer,\r\n        () => {\r\n            logger.debug('Got RESULT for P2P \"session-accept\"');\r\n        },\r\n        error => {\r\n            logger.error(\r\n                'Failed to accept incoming P2P Jingle session', error);\r\n        },\r\n        localTracks);\r\n};\r\n\r\n/**\r\n * Adds remote tracks to the conference associated with the JVB session.\r\n * @private\r\n */\r\nJitsiConference.prototype._addRemoteJVBTracks = function() {\r\n    this._addRemoteTracks(\r\n        'JVB', this.jvbJingleSession.peerconnection.getRemoteTracks());\r\n};\r\n\r\n/**\r\n * Adds remote tracks to the conference associated with the P2P session.\r\n * @private\r\n */\r\nJitsiConference.prototype._addRemoteP2PTracks = function() {\r\n    this._addRemoteTracks(\r\n        'P2P', this.p2pJingleSession.peerconnection.getRemoteTracks());\r\n};\r\n\r\n/**\r\n * Generates fake \"remote track added\" events for given Jingle session.\r\n * @param {string} logName the session's nickname which will appear in log\r\n * messages.\r\n * @param {Array<JitsiRemoteTrack>} remoteTracks the tracks that will be added\r\n * @private\r\n */\r\nJitsiConference.prototype._addRemoteTracks = function(logName, remoteTracks) {\r\n    for (const track of remoteTracks) {\r\n        logger.info(`Adding remote ${logName} track: ${track}`);\r\n        this.rtc.eventEmitter.emit(RTCEvents.REMOTE_TRACK_ADDED, track);\r\n    }\r\n};\r\n\r\n/**\r\n * Called when {@link XMPPEvents.CONNECTION_ESTABLISHED} event is\r\n * triggered for a {@link JingleSessionPC}. Switches the conference to use\r\n * the P2P connection if the event comes from the P2P session.\r\n * @param {JingleSessionPC} jingleSession the session instance.\r\n * @private\r\n */\r\nJitsiConference.prototype._onIceConnectionEstablished = function(\r\n        jingleSession) {\r\n    if (this.p2pJingleSession !== null) {\r\n        // store the establishment time of the p2p session as a field of the\r\n        // JitsiConference because the p2pJingleSession might get disposed (thus\r\n        // the value is lost).\r\n        this.p2pEstablishmentDuration\r\n            = this.p2pJingleSession.establishmentDuration;\r\n    }\r\n\r\n    if (this.jvbJingleSession !== null) {\r\n        this.jvbEstablishmentDuration\r\n            = this.jvbJingleSession.establishmentDuration;\r\n    }\r\n\r\n    let done = false;\r\n    const forceJVB121Ratio = this.options.config.forceJVB121Ratio;\r\n\r\n    // We don't care about the JVB case, there's nothing to be done\r\n    if (!jingleSession.isP2P) {\r\n        done = true;\r\n    } else if (this.p2pJingleSession !== jingleSession) {\r\n        logger.error('CONNECTION_ESTABLISHED - wrong P2P session instance ?!');\r\n\r\n        done = true;\r\n    } else if (!jingleSession.isInitiator\r\n        && typeof forceJVB121Ratio === 'number'\r\n        && Math.random() < forceJVB121Ratio) {\r\n        logger.info(`Forcing JVB 121 mode (ratio=${forceJVB121Ratio})...`);\r\n        Statistics.analytics.addPermanentProperties({ forceJvb121: true });\r\n        this._stopP2PSession('decline', 'force JVB121');\r\n\r\n        done = true;\r\n    }\r\n\r\n    if (!isNaN(this.p2pEstablishmentDuration)\r\n        && !isNaN(this.jvbEstablishmentDuration)) {\r\n        const establishmentDurationDiff\r\n            = this.p2pEstablishmentDuration - this.jvbEstablishmentDuration;\r\n\r\n        Statistics.sendAnalytics(\r\n            ICE_ESTABLISHMENT_DURATION_DIFF,\r\n            { value: establishmentDurationDiff });\r\n    }\r\n\r\n    if (done) {\r\n\r\n        return;\r\n    }\r\n\r\n    // Update P2P status and emit events\r\n    this._setP2PStatus(true);\r\n\r\n    // Remove remote tracks\r\n    if (this.jvbJingleSession) {\r\n        this._removeRemoteJVBTracks();\r\n    } else {\r\n        logger.info('Not removing remote JVB tracks - no session yet');\r\n    }\r\n\r\n    this._addRemoteP2PTracks();\r\n\r\n    // Stop media transfer over the JVB connection\r\n    if (this.jvbJingleSession) {\r\n        this._suspendMediaTransferForJvbConnection();\r\n    }\r\n\r\n    logger.info('Starting remote stats with p2p connection');\r\n    this.statistics.startRemoteStats(this.p2pJingleSession.peerconnection);\r\n\r\n    Statistics.sendAnalyticsAndLog(\r\n        createP2PEvent(\r\n            ACTION_P2P_ESTABLISHED,\r\n            {\r\n                initiator: this.p2pJingleSession.isInitiator\r\n            }));\r\n\r\n};\r\n\r\n/**\r\n * Clears the deferred start P2P task if it has been scheduled.\r\n * @private\r\n */\r\nJitsiConference.prototype._maybeClearDeferredStartP2P = function() {\r\n    if (this.deferredStartP2PTask) {\r\n        logger.info('Cleared deferred start P2P task');\r\n        clearTimeout(this.deferredStartP2PTask);\r\n        this.deferredStartP2PTask = null;\r\n    }\r\n};\r\n\r\n/**\r\n * Removes from the conference remote tracks associated with the JVB\r\n * connection.\r\n * @private\r\n */\r\nJitsiConference.prototype._removeRemoteJVBTracks = function() {\r\n    this._removeRemoteTracks(\r\n        'JVB', this.jvbJingleSession.peerconnection.getRemoteTracks());\r\n};\r\n\r\n/**\r\n * Removes from the conference remote tracks associated with the P2P\r\n * connection.\r\n * @private\r\n */\r\nJitsiConference.prototype._removeRemoteP2PTracks = function() {\r\n    this._removeRemoteTracks(\r\n        'P2P', this.p2pJingleSession.peerconnection.getRemoteTracks());\r\n};\r\n\r\n/**\r\n * Generates fake \"remote track removed\" events for given Jingle session.\r\n * @param {string} sessionNickname the session's nickname which will appear in\r\n * log messages.\r\n * @param {Array<JitsiRemoteTrack>} remoteTracks the tracks that will be removed\r\n * @private\r\n */\r\nJitsiConference.prototype._removeRemoteTracks = function(\r\n        sessionNickname,\r\n        remoteTracks) {\r\n    for (const track of remoteTracks) {\r\n        logger.info(`Removing remote ${sessionNickname} track: ${track}`);\r\n        this.rtc.eventEmitter.emit(RTCEvents.REMOTE_TRACK_REMOVED, track);\r\n    }\r\n};\r\n\r\n/**\r\n * Resumes media transfer over the JVB connection.\r\n * @private\r\n */\r\nJitsiConference.prototype._resumeMediaTransferForJvbConnection = function() {\r\n    logger.info('Resuming media transfer over the JVB connection...');\r\n    this.jvbJingleSession.setMediaTransferActive(true, true).then(\r\n        () => {\r\n            logger.info('Resumed media transfer over the JVB connection!');\r\n        },\r\n        error => {\r\n            logger.error(\r\n                'Failed to resume media transfer over the JVB connection:',\r\n                error);\r\n        });\r\n};\r\n\r\n/**\r\n * Sets new P2P status and updates some events/states hijacked from\r\n * the <tt>JitsiConference</tt>.\r\n * @param {boolean} newStatus the new P2P status value, <tt>true</tt> means that\r\n * P2P is now in use, <tt>false</tt> means that the JVB connection is now in use\r\n * @private\r\n */\r\nJitsiConference.prototype._setP2PStatus = function(newStatus) {\r\n    if (this.p2p === newStatus) {\r\n        logger.debug(`Called _setP2PStatus with the same status: ${newStatus}`);\r\n\r\n        return;\r\n    }\r\n    this.p2p = newStatus;\r\n    if (newStatus) {\r\n        logger.info('Peer to peer connection established!');\r\n\r\n        // When we end up in a valid P2P session need to reset the properties\r\n        // in case they have persisted, after session with another peer.\r\n        Statistics.analytics.addPermanentProperties({\r\n            p2pFailed: false,\r\n            forceJvb121: false\r\n        });\r\n\r\n        // Sync up video transfer active in case p2pJingleSession not existed\r\n        // when the lastN value was being adjusted.\r\n        const isVideoActive = this.rtc.getLastN() !== 0;\r\n\r\n        this.p2pJingleSession\r\n            .setMediaTransferActive(true, isVideoActive)\r\n            .catch(error => {\r\n                logger.error(\r\n                    'Failed to sync up P2P video transfer status'\r\n                        + `(${isVideoActive})`, error);\r\n            });\r\n    } else {\r\n        logger.info('Peer to peer connection closed!');\r\n    }\r\n\r\n    // Put the JVB connection on hold/resume\r\n    if (this.jvbJingleSession) {\r\n        this.statistics.sendConnectionResumeOrHoldEvent(\r\n            this.jvbJingleSession.peerconnection, !newStatus);\r\n    }\r\n\r\n    // Clear dtmfManager, so that it can be recreated with new connection\r\n    this.dtmfManager = null;\r\n\r\n    // Update P2P status\r\n    this.eventEmitter.emit(\r\n        JitsiConferenceEvents.P2P_STATUS,\r\n        this,\r\n        this.p2p);\r\n\r\n    // Refresh connection interrupted/restored\r\n    this.eventEmitter.emit(\r\n        this.isConnectionInterrupted()\r\n            ? JitsiConferenceEvents.CONNECTION_INTERRUPTED\r\n            : JitsiConferenceEvents.CONNECTION_RESTORED);\r\n};\r\n\r\n/**\r\n * Starts new P2P session.\r\n * @param {string} remoteJid the JID of the remote participant\r\n * @private\r\n */\r\nJitsiConference.prototype._startP2PSession = function(remoteJid) {\r\n    this._maybeClearDeferredStartP2P();\r\n    if (this.p2pJingleSession) {\r\n        logger.error('P2P session already started!');\r\n\r\n        return;\r\n    }\r\n\r\n    this.isP2PConnectionInterrupted = false;\r\n    this.p2pJingleSession\r\n        = this.xmpp.connection.jingle.newP2PJingleSession(\r\n            this.room.myroomjid,\r\n            remoteJid);\r\n    logger.info(\r\n        'Created new P2P JingleSession', this.room.myroomjid, remoteJid);\r\n\r\n    this.p2pJingleSession.initialize(true /* initiator */, this.room, this.rtc);\r\n\r\n    logger.info('Starting CallStats for P2P connection...');\r\n\r\n    let remoteID = Strophe.getResourceFromJid(this.p2pJingleSession.remoteJid);\r\n\r\n    if (this.options.config.enableStatsID) {\r\n        const participant = this.participants[remoteID];\r\n\r\n        if (participant) {\r\n            remoteID = participant.getStatsID() || remoteID;\r\n        }\r\n    }\r\n\r\n    this.statistics.startCallStats(\r\n        this.p2pJingleSession.peerconnection,\r\n        remoteID);\r\n\r\n    // NOTE one may consider to start P2P with the local tracks detached,\r\n    // but no data will be sent until ICE succeeds anyway. And we switch\r\n    // immediately once the P2P ICE connects.\r\n    const localTracks = this.getLocalTracks();\r\n\r\n    this.p2pJingleSession.invite(localTracks);\r\n};\r\n\r\n/**\r\n * Suspends media transfer over the JVB connection.\r\n * @private\r\n */\r\nJitsiConference.prototype._suspendMediaTransferForJvbConnection = function() {\r\n    logger.info('Suspending media transfer over the JVB connection...');\r\n    this.jvbJingleSession.setMediaTransferActive(false, false).then(\r\n        () => {\r\n            logger.info('Suspended media transfer over the JVB connection !');\r\n        },\r\n        error => {\r\n            logger.error(\r\n                'Failed to suspend media transfer over the JVB connection:',\r\n                error);\r\n        });\r\n};\r\n\r\n/**\r\n * Method when called will decide whether it's the time to start or stop\r\n * the P2P session.\r\n * @param {boolean} userLeftEvent if <tt>true</tt> it means that the call\r\n * originates from the user left event.\r\n * @private\r\n */\r\nJitsiConference.prototype._maybeStartOrStopP2P = function(userLeftEvent) {\r\n    if (!browser.supportsP2P()\r\n        || !this.isP2PEnabled()\r\n        || this.isP2PTestModeEnabled()) {\r\n        logger.info('Auto P2P disabled');\r\n\r\n        return;\r\n    }\r\n    const peers = this.getParticipants();\r\n    const peerCount = peers.length;\r\n    const isModerator = this.isModerator();\r\n\r\n    // FIXME 1 peer and it must *support* P2P switching\r\n    const shouldBeInP2P = peerCount === 1;\r\n\r\n    logger.debug(\r\n        `P2P? isModerator: ${isModerator}, peerCount: ${peerCount} => ${\r\n            shouldBeInP2P}`);\r\n\r\n    // Clear deferred \"start P2P\" task\r\n    if (!shouldBeInP2P && this.deferredStartP2PTask) {\r\n        this._maybeClearDeferredStartP2P();\r\n    }\r\n\r\n    // Start peer to peer session\r\n    if (isModerator && !this.p2pJingleSession && shouldBeInP2P) {\r\n        const peer = peerCount && peers[0];\r\n\r\n        // Everyone is a moderator ?\r\n        if (isModerator && peer.getRole() === 'moderator') {\r\n            const myId = this.myUserId();\r\n            const peersId = peer.getId();\r\n\r\n            if (myId > peersId) {\r\n                logger.debug(\r\n                    'Everyone\\'s a moderator - '\r\n                    + 'the other peer should start P2P', myId, peersId);\r\n\r\n                return;\r\n            } else if (myId === peersId) {\r\n                logger.error('The same IDs ? ', myId, peersId);\r\n\r\n                return;\r\n            }\r\n        }\r\n        const jid = peer.getJid();\r\n\r\n        if (userLeftEvent) {\r\n            if (this.deferredStartP2PTask) {\r\n                logger.error('Deferred start P2P task\\'s been set already!');\r\n\r\n                return;\r\n            }\r\n            logger.info(\r\n                `Will start P2P with: ${jid} after ${\r\n                    this.backToP2PDelay} seconds...`);\r\n            this.deferredStartP2PTask = setTimeout(\r\n                this._startP2PSession.bind(this, jid),\r\n                this.backToP2PDelay * 1000);\r\n        } else {\r\n            logger.info(`Will start P2P with: ${jid}`);\r\n            this._startP2PSession(jid);\r\n        }\r\n    } else if (this.p2pJingleSession && !shouldBeInP2P) {\r\n        logger.info(`Will stop P2P with: ${this.p2pJingleSession.remoteJid}`);\r\n\r\n        // Log that there will be a switch back to the JVB connection\r\n        if (this.p2pJingleSession.isInitiator && peerCount > 1) {\r\n            Statistics.sendAnalyticsAndLog(\r\n                createP2PEvent(ACTION_P2P_SWITCH_TO_JVB));\r\n        }\r\n        this._stopP2PSession();\r\n    }\r\n};\r\n\r\n/**\r\n * Stops the current P2P session.\r\n * @param {string} [reason=\"success\"] one of the Jingle \"reason\" element\r\n * names as defined by https://xmpp.org/extensions/xep-0166.html#def-reason\r\n * @param {string} [reasonDescription=\"Turing off P2P session\"] text\r\n * description that will be included in the session terminate message\r\n * @private\r\n */\r\nJitsiConference.prototype._stopP2PSession = function(\r\n        reason,\r\n        reasonDescription) {\r\n    if (!this.p2pJingleSession) {\r\n        logger.error('No P2P session to be stopped!');\r\n\r\n        return;\r\n    }\r\n\r\n    const wasP2PEstablished = this.isP2PActive();\r\n\r\n    // Swap remote tracks, but only if the P2P has been fully established\r\n    if (wasP2PEstablished) {\r\n        if (this.jvbJingleSession) {\r\n            this._resumeMediaTransferForJvbConnection();\r\n        }\r\n\r\n        // Remove remote P2P tracks\r\n        this._removeRemoteP2PTracks();\r\n    }\r\n\r\n    // Stop P2P stats\r\n    logger.info('Stopping remote stats for P2P connection');\r\n    this.statistics.stopRemoteStats(this.p2pJingleSession.peerconnection);\r\n    logger.info('Stopping CallStats for P2P connection');\r\n    this.statistics.stopCallStats(this.p2pJingleSession.peerconnection);\r\n\r\n    this.p2pJingleSession.terminate(\r\n        () => {\r\n            logger.info('P2P session terminate RESULT');\r\n        },\r\n        error => {\r\n            // Because both initiator and responder are simultaneously\r\n            // terminating their JingleSessions in case of the 'to JVB switch'\r\n            // when 3rd participant joins, both will dispose their sessions and\r\n            // reply with 'item-not-found' (see strophe.jingle.js). We don't\r\n            // want to log this as an error since it's expected behaviour.\r\n            //\r\n            // We want them both to terminate, because in case of initiator's\r\n            // crash the responder would stay in P2P mode until ICE fails which\r\n            // could take up to 20 seconds.\r\n            //\r\n            // NOTE lack of 'reason' is considered as graceful session terminate\r\n            // where both initiator and responder terminate their sessions\r\n            // simultaneously.\r\n            if (reason) {\r\n                logger.error(\r\n                    'An error occurred while trying to terminate'\r\n                        + ' P2P Jingle session', error);\r\n            }\r\n        }, {\r\n            reason: reason ? reason : 'success',\r\n            reasonDescription: reasonDescription\r\n                ? reasonDescription : 'Turing off P2P session',\r\n            sendSessionTerminate: this.room\r\n                && this.getParticipantById(\r\n                    Strophe.getResourceFromJid(this.p2pJingleSession.remoteJid))\r\n        });\r\n\r\n    this.p2pJingleSession = null;\r\n\r\n    // Update P2P status and other affected events/states\r\n    this._setP2PStatus(false);\r\n\r\n    if (wasP2PEstablished) {\r\n        // Add back remote JVB tracks\r\n        if (this.jvbJingleSession) {\r\n            this._addRemoteJVBTracks();\r\n        } else {\r\n            logger.info('Not adding remote JVB tracks - no session yet');\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * Checks whether or not the conference is currently in the peer to peer mode.\r\n * Being in peer to peer mode means that the direct connection has been\r\n * established and the P2P connection is being used for media transmission.\r\n * @return {boolean} <tt>true</tt> if in P2P mode or <tt>false</tt> otherwise.\r\n */\r\nJitsiConference.prototype.isP2PActive = function() {\r\n    return this.p2p;\r\n};\r\n\r\n/**\r\n * Returns the current ICE state of the P2P connection.\r\n * NOTE: method is used by the jitsi-meet-torture tests.\r\n * @return {string|null} an ICE state or <tt>null</tt> if there's currently\r\n * no P2P connection.\r\n */\r\nJitsiConference.prototype.getP2PConnectionState = function() {\r\n    if (this.isP2PActive()) {\r\n        return this.p2pJingleSession.peerconnection.getConnectionState();\r\n    }\r\n\r\n    return null;\r\n};\r\n\r\n\r\n/**\r\n * Manually starts new P2P session (should be used only in the tests).\r\n */\r\nJitsiConference.prototype.startP2PSession = function() {\r\n    const peers = this.getParticipants();\r\n\r\n    // Start peer to peer session\r\n    if (peers.length === 1) {\r\n        const peerJid = peers[0].getJid();\r\n\r\n        this._startP2PSession(peerJid);\r\n    } else {\r\n        throw new Error(\r\n            'There must be exactly 1 participant to start the P2P session !');\r\n    }\r\n};\r\n\r\n/**\r\n * Manually stops the current P2P session (should be used only in the tests)\r\n */\r\nJitsiConference.prototype.stopP2PSession = function() {\r\n    this._stopP2PSession();\r\n};\r\n\r\n/**\r\n * Get a summary of how long current participants have been the dominant speaker\r\n * @returns {object}\r\n */\r\nJitsiConference.prototype.getSpeakerStats = function() {\r\n    return this.speakerStatsCollector.getStats();\r\n};\r\n\r\n/**\r\n * Sets the maximum video size the local participant should receive from remote\r\n * participants.\r\n *\r\n * @param {number} maxFrameHeightPixels the maximum frame height, in pixels,\r\n * this receiver is willing to receive.\r\n * @returns {void}\r\n */\r\nJitsiConference.prototype.setReceiverVideoConstraint = function(\r\n        maxFrameHeight) {\r\n    this.rtc.setReceiverVideoConstraint(maxFrameHeight);\r\n};\r\n\r\n/**\r\n * Creates a video SIP GW session and returns it if service is enabled. Before\r\n * creating a session one need to check whether video SIP GW service is\r\n * available in the system {@link JitsiConference.isVideoSIPGWAvailable}. Even\r\n * if there are available nodes to serve this request, after creating the\r\n * session those nodes can be taken and the request about using the\r\n * created session can fail.\r\n *\r\n * @param {string} sipAddress - The sip address to be used.\r\n * @param {string} displayName - The display name to be used for this session.\r\n * @returns {JitsiVideoSIPGWSession|Error} Returns null if conference is not\r\n * initialised and there is no room.\r\n */\r\nJitsiConference.prototype.createVideoSIPGWSession\r\n    = function(sipAddress, displayName) {\r\n        if (!this.room) {\r\n            return new Error(VideoSIPGWConstants.ERROR_NO_CONNECTION);\r\n        }\r\n\r\n        return this.videoSIPGWHandler\r\n            .createVideoSIPGWSession(sipAddress, displayName);\r\n    };\r\n\n\n\n// WEBPACK FOOTER //\n// ./JitsiConference.js","/* global __filename */\r\n\r\nimport { createRtpStatsEvent } from '../../service/statistics/AnalyticsEvents';\r\nimport { getLogger } from 'jitsi-meet-logger';\r\nimport * as ConnectionQualityEvents\r\n    from '../../service/connectivity/ConnectionQualityEvents';\r\nimport * as ConferenceEvents from '../../JitsiConferenceEvents';\r\nimport * as MediaType from '../../service/RTC/MediaType';\r\nimport browser from '../browser';\r\nimport Statistics from './statistics';\r\nimport * as VideoType from '../../service/RTC/VideoType';\r\n\r\nconst logger = getLogger(__filename);\r\n\r\n/**\r\n * This will calculate an average for one, named stat and submit it to\r\n * the analytics module when requested. It automatically counts the samples.\r\n */\r\nclass AverageStatReport {\r\n    /**\r\n     * Creates new <tt>AverageStatReport</tt> for given name.\r\n     * @param {string} name that's the name of the event that will be reported\r\n     * to the analytics module.\r\n     */\r\n    constructor(name) {\r\n        this.name = name;\r\n        this.count = 0;\r\n        this.sum = 0;\r\n        this.samples = [];\r\n    }\r\n\r\n    /**\r\n     * Adds the next value that will be included in the average when\r\n     * {@link calculate} is called.\r\n     * @param {number} nextValue\r\n     */\r\n    addNext(nextValue) {\r\n        if (typeof nextValue !== 'number') {\r\n            logger.error(\r\n                `${this.name} - invalid value for idx: ${this.count}`,\r\n                nextValue);\r\n        } else if (!isNaN(nextValue)) {\r\n            this.sum += nextValue;\r\n            this.samples.push(nextValue);\r\n            this.count += 1;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Calculates an average for the samples collected using {@link addNext}.\r\n     * @return {number|NaN} an average of all collected samples or <tt>NaN</tt>\r\n     * if no samples were collected.\r\n     */\r\n    calculate() {\r\n        return this.sum / this.count;\r\n    }\r\n\r\n    /**\r\n     * Appends the report to the analytics \"data\" object. The object will be\r\n     * set under <tt>prefix</tt> + {@link this.name} key.\r\n     * @param {Object} report the analytics \"data\" object\r\n     */\r\n    appendReport(report) {\r\n        report[`${this.name}_avg`] = this.calculate();\r\n        report[`${this.name}_samples`] = JSON.stringify(this.samples);\r\n    }\r\n\r\n    /**\r\n     * Clears all memory of any samples collected, so that new average can be\r\n     * calculated using this instance.\r\n     */\r\n    reset() {\r\n        this.samples = [];\r\n        this.sum = 0;\r\n        this.count = 0;\r\n    }\r\n}\r\n\r\n/**\r\n * Class gathers the stats that are calculated and reported for a\r\n * {@link TraceablePeerConnection} even if it's not currently active. For\r\n * example we want to monitor RTT for the JVB connection while in P2P mode.\r\n */\r\nclass ConnectionAvgStats {\r\n    /**\r\n     * Creates new <tt>ConnectionAvgStats</tt>\r\n     * @param {AvgRTPStatsReporter} avgRtpStatsReporter\r\n     * @param {boolean} isP2P\r\n     * @param {number} n the number of samples, before arithmetic mean is to be\r\n     * calculated and values submitted to the analytics module.\r\n     */\r\n    constructor(avgRtpStatsReporter, isP2P, n) {\r\n        /**\r\n         * Is this instance for JVB or P2P connection ?\r\n         * @type {boolean}\r\n         */\r\n        this.isP2P = isP2P;\r\n\r\n        /**\r\n         * How many samples are to be included in arithmetic mean calculation.\r\n         * @type {number}\r\n         * @private\r\n         */\r\n        this._n = n;\r\n\r\n        /**\r\n         * The current sample index. Starts from 0 and goes up to {@link _n})\r\n         * when analytics report will be submitted.\r\n         * @type {number}\r\n         * @private\r\n         */\r\n        this._sampleIdx = 0;\r\n\r\n        /**\r\n         * Average round trip time reported by the ICE candidate pair.\r\n         * @type {AverageStatReport}\r\n         */\r\n        this._avgRTT = new AverageStatReport('rtt');\r\n\r\n        /**\r\n         * Map stores average RTT to the JVB reported by remote participants.\r\n         * Mapped per participant id {@link JitsiParticipant.getId}.\r\n         *\r\n         * This is used only when {@link ConnectionAvgStats.isP2P} equals to\r\n         * <tt>false</tt>.\r\n         *\r\n         * @type {Map<string,AverageStatReport>}\r\n         * @private\r\n         */\r\n        this._avgRemoteRTTMap = new Map();\r\n\r\n        /**\r\n         * The conference for which stats will be collected and reported.\r\n         * @type {JitsiConference}\r\n         * @private\r\n         */\r\n        this._avgRtpStatsReporter = avgRtpStatsReporter;\r\n\r\n        /**\r\n         * The latest average E2E RTT for the JVB connection only.\r\n         *\r\n         * This is used only when {@link ConnectionAvgStats.isP2P} equals to\r\n         * <tt>false</tt>.\r\n         *\r\n         * @type {number}\r\n         */\r\n        this._avgEnd2EndRTT = undefined;\r\n\r\n        this._onConnectionStats = (tpc, stats) => {\r\n            if (this.isP2P === tpc.isP2P) {\r\n                this._calculateAvgStats(stats);\r\n            }\r\n        };\r\n\r\n        const conference = avgRtpStatsReporter._conference;\r\n\r\n        conference.statistics.addConnectionStatsListener(\r\n            this._onConnectionStats);\r\n\r\n        if (!this.isP2P) {\r\n            this._onUserLeft = id => this._avgRemoteRTTMap.delete(id);\r\n            conference.on(ConferenceEvents.USER_LEFT, this._onUserLeft);\r\n\r\n            this._onRemoteStatsUpdated\r\n                = (id, data) => this._processRemoteStats(id, data);\r\n            conference.on(\r\n                ConnectionQualityEvents.REMOTE_STATS_UPDATED,\r\n                this._onRemoteStatsUpdated);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Processes next batch of stats.\r\n     * @param {go figure} data\r\n     * @private\r\n     */\r\n    _calculateAvgStats(data) {\r\n        if (!data) {\r\n            logger.error('No stats');\r\n\r\n            return;\r\n        }\r\n\r\n        if (browser.supportsRTTStatistics()) {\r\n            if (data.transport && data.transport.length) {\r\n                this._avgRTT.addNext(data.transport[0].rtt);\r\n            }\r\n        }\r\n\r\n        this._sampleIdx += 1;\r\n\r\n        if (this._sampleIdx >= this._n) {\r\n            if (browser.supportsRTTStatistics()) {\r\n                const conference = this._avgRtpStatsReporter._conference;\r\n\r\n                const batchReport = {\r\n                    p2p: this.isP2P,\r\n                    'conference_size': conference.getParticipantCount()\r\n                };\r\n\r\n                if (data.transport && data.transport.length) {\r\n                    Object.assign(batchReport, {\r\n                        'local_candidate_type':\r\n                            data.transport[0].localCandidateType,\r\n                        'remote_candidate_type':\r\n                            data.transport[0].remoteCandidateType,\r\n                        'transport_type': data.transport[0].type\r\n                    });\r\n                }\r\n\r\n                this._avgRTT.appendReport(batchReport);\r\n\r\n                if (this.isP2P) {\r\n                    // Report RTT diff only for P2P.\r\n                    const jvbEnd2EndRTT = this\r\n                        ._avgRtpStatsReporter.jvbStatsMonitor._avgEnd2EndRTT;\r\n\r\n                    if (!isNaN(jvbEnd2EndRTT)) {\r\n                        // eslint-disable-next-line dot-notation\r\n                        batchReport['rtt_diff']\r\n                            = this._avgRTT.calculate() - jvbEnd2EndRTT;\r\n                    }\r\n                } else {\r\n                    // Report end to end RTT only for JVB.\r\n                    const avgRemoteRTT = this._calculateAvgRemoteRTT();\r\n                    const avgLocalRTT = this._avgRTT.calculate();\r\n\r\n                    this._avgEnd2EndRTT = avgLocalRTT + avgRemoteRTT;\r\n\r\n                    if (!isNaN(avgLocalRTT) && !isNaN(avgRemoteRTT)) {\r\n                        // eslint-disable-next-line dot-notation\r\n                        batchReport['end2end_rtt_avg'] = this._avgEnd2EndRTT;\r\n                    }\r\n                }\r\n\r\n                Statistics.sendAnalytics(createRtpStatsEvent(batchReport));\r\n            }\r\n\r\n            this._resetAvgStats();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Calculates arithmetic mean of all RTTs towards the JVB reported by\r\n     * participants.\r\n     * @return {number|NaN} NaN if not available (not enough data)\r\n     * @private\r\n     */\r\n    _calculateAvgRemoteRTT() {\r\n        let count = 0, sum = 0;\r\n\r\n        // FIXME should we ignore RTT for participant\r\n        // who \"is having connectivity issues\" ?\r\n        for (const remoteAvg of this._avgRemoteRTTMap.values()) {\r\n            const avg = remoteAvg.calculate();\r\n\r\n            if (!isNaN(avg)) {\r\n                sum += avg;\r\n                count += 1;\r\n                remoteAvg.reset();\r\n            }\r\n        }\r\n\r\n        return sum / count;\r\n    }\r\n\r\n    /**\r\n     * Processes {@link ConnectionQualityEvents.REMOTE_STATS_UPDATED} to analyse\r\n     * RTT towards the JVB reported by each participant.\r\n     * @param {string} id {@link JitsiParticipant.getId}\r\n     * @param {go figure in ConnectionQuality.js} data\r\n     * @private\r\n     */\r\n    _processRemoteStats(id, data) {\r\n        const validData = typeof data.jvbRTT === 'number';\r\n        let rttAvg = this._avgRemoteRTTMap.get(id);\r\n\r\n        if (!rttAvg && validData) {\r\n            rttAvg = new AverageStatReport(`${id}_stat_rtt`);\r\n            this._avgRemoteRTTMap.set(id, rttAvg);\r\n        }\r\n\r\n        if (validData) {\r\n            rttAvg.addNext(data.jvbRTT);\r\n        } else if (rttAvg) {\r\n            this._avgRemoteRTTMap.delete(id);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Reset cache of all averages and {@link _sampleIdx}.\r\n     * @private\r\n     */\r\n    _resetAvgStats() {\r\n        this._avgRTT.reset();\r\n        if (this._avgRemoteRTTMap) {\r\n            this._avgRemoteRTTMap.clear();\r\n        }\r\n        this._sampleIdx = 0;\r\n    }\r\n\r\n    /**\r\n     *\r\n     */\r\n    dispose() {\r\n\r\n        const conference = this._avgRtpStatsReporter._conference;\r\n\r\n        conference.statistics.removeConnectionStatsListener(\r\n            this._onConnectionStats);\r\n        if (!this.isP2P) {\r\n            conference.off(\r\n                ConnectionQualityEvents.REMOTE_STATS_UPDATED,\r\n                this._onRemoteStatsUpdated);\r\n            conference.off(\r\n                ConferenceEvents.USER_LEFT,\r\n                this._onUserLeft);\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Reports average RTP statistics values (arithmetic mean) to the analytics\r\n * module for things like bit rate, bandwidth, packet loss etc. It keeps track\r\n * of the P2P vs JVB conference modes and submits the values under different\r\n * namespaces (the events for P2P mode have 'p2p.' prefix). Every switch between\r\n * P2P mode resets the data collected so far and averages are calculated from\r\n * scratch.\r\n */\r\nexport default class AvgRTPStatsReporter {\r\n    /**\r\n     * Creates new instance of <tt>AvgRTPStatsReporter</tt>\r\n     * @param {JitsiConference} conference\r\n     * @param {number} n the number of samples, before arithmetic mean is to be\r\n     * calculated and values submitted to the analytics module.\r\n     */\r\n    constructor(conference, n) {\r\n        /**\r\n         * How many {@link ConnectionQualityEvents.LOCAL_STATS_UPDATED} samples\r\n         * are to be included in arithmetic mean calculation.\r\n         * @type {number}\r\n         * @private\r\n         */\r\n        this._n = n;\r\n\r\n        if (n > 0) {\r\n            logger.info(`Avg RTP stats will be calculated every ${n} samples`);\r\n        } else {\r\n            logger.info('Avg RTP stats reports are disabled.');\r\n\r\n            // Do not initialize\r\n            return;\r\n        }\r\n\r\n        /**\r\n         * The current sample index. Starts from 0 and goes up to {@link _n})\r\n         * when analytics report will be submitted.\r\n         * @type {number}\r\n         * @private\r\n         */\r\n        this._sampleIdx = 0;\r\n\r\n        /**\r\n         * The conference for which stats will be collected and reported.\r\n         * @type {JitsiConference}\r\n         * @private\r\n         */\r\n        this._conference = conference;\r\n\r\n        /**\r\n         * Average audio upload bitrate\r\n         * XXX What are the units?\r\n         * @type {AverageStatReport}\r\n         * @private\r\n         */\r\n        this._avgAudioBitrateUp\r\n            = new AverageStatReport('bitrate_audio_upload');\r\n\r\n        /**\r\n         * Average audio download bitrate\r\n         * XXX What are the units?\r\n         * @type {AverageStatReport}\r\n         * @private\r\n         */\r\n        this._avgAudioBitrateDown\r\n            = new AverageStatReport('bitrate_audio_download');\r\n\r\n        /**\r\n         * Average video upload bitrate\r\n         * XXX What are the units?\r\n         * @type {AverageStatReport}\r\n         * @private\r\n         */\r\n        this._avgVideoBitrateUp\r\n            = new AverageStatReport('bitrate_video_upload');\r\n\r\n        /**\r\n         * Average video download bitrate\r\n         * XXX What are the units?\r\n         * @type {AverageStatReport}\r\n         * @private\r\n         */\r\n        this._avgVideoBitrateDown\r\n            = new AverageStatReport('bitrate_video_download');\r\n\r\n        /**\r\n         * Average upload bandwidth\r\n         * XXX What are the units?\r\n         * @type {AverageStatReport}\r\n         * @private\r\n         */\r\n        this._avgBandwidthUp\r\n            = new AverageStatReport('bandwidth_upload');\r\n\r\n        /**\r\n         * Average download bandwidth\r\n         * XXX What are the units?\r\n         * @type {AverageStatReport}\r\n         * @private\r\n         */\r\n        this._avgBandwidthDown\r\n            = new AverageStatReport('bandwidth_download');\r\n\r\n        /**\r\n         * Average total packet loss\r\n         * XXX What are the units?\r\n         * @type {AverageStatReport}\r\n         * @private\r\n         */\r\n        this._avgPacketLossTotal\r\n            = new AverageStatReport('packet_loss_total');\r\n\r\n        /**\r\n         * Average upload packet loss\r\n         * XXX What are the units?\r\n         * @type {AverageStatReport}\r\n         * @private\r\n         */\r\n        this._avgPacketLossUp\r\n            = new AverageStatReport('packet_loss_upload');\r\n\r\n        /**\r\n         * Average download packet loss\r\n         * XXX What are the units?\r\n         * @type {AverageStatReport}\r\n         * @private\r\n         */\r\n        this._avgPacketLossDown\r\n            = new AverageStatReport('packet_loss_download');\r\n\r\n        /**\r\n         * Average FPS for remote videos\r\n         * @type {AverageStatReport}\r\n         * @private\r\n         */\r\n        this._avgRemoteFPS = new AverageStatReport('framerate_remote');\r\n\r\n        /**\r\n         * Average FPS for remote screen streaming videos (reported only if not\r\n         * a <tt>NaN</tt>).\r\n         * @type {AverageStatReport}\r\n         * @private\r\n         */\r\n        this._avgRemoteScreenFPS\r\n            = new AverageStatReport('framerate_screen_remote');\r\n\r\n        /**\r\n         * Average FPS for local video (camera)\r\n         * @type {AverageStatReport}\r\n         * @private\r\n         */\r\n        this._avgLocalFPS = new AverageStatReport('framerate_local');\r\n\r\n        /**\r\n         * Average FPS for local screen streaming video (reported only if not\r\n         * a <tt>NaN</tt>).\r\n         * @type {AverageStatReport}\r\n         * @private\r\n         */\r\n        this._avgLocalScreenFPS\r\n            = new AverageStatReport('framerate_screen_local');\r\n\r\n        /**\r\n         * Average pixels for remote screen streaming videos (reported only if\r\n         * not a <tt>NaN</tt>).\r\n         * @type {AverageStatReport}\r\n         * @private\r\n         */\r\n        this._avgRemoteCameraPixels\r\n            = new AverageStatReport('pixels_remote');\r\n\r\n        /**\r\n         * Average pixels for remote screen streaming videos (reported only if\r\n         * not a <tt>NaN</tt>).\r\n         * @type {AverageStatReport}\r\n         * @private\r\n         */\r\n        this._avgRemoteScreenPixels\r\n            = new AverageStatReport('pixels_screen_remote');\r\n\r\n        /**\r\n         * Average pixels for local video (camera)\r\n         * @type {AverageStatReport}\r\n         * @private\r\n         */\r\n        this._avgLocalCameraPixels\r\n            = new AverageStatReport('pixels_local');\r\n\r\n        /**\r\n         * Average pixels for local screen streaming video (reported only if not\r\n         * a <tt>NaN</tt>).\r\n         * @type {AverageStatReport}\r\n         * @private\r\n         */\r\n        this._avgLocalScreenPixels\r\n            = new AverageStatReport('pixels_screen_local');\r\n\r\n        /**\r\n         * Average connection quality as defined by\r\n         * the {@link ConnectionQuality} module.\r\n         * @type {AverageStatReport}\r\n         * @private\r\n         */\r\n        this._avgCQ = new AverageStatReport('connection_quality');\r\n\r\n        this._onLocalStatsUpdated = data => this._calculateAvgStats(data);\r\n        conference.on(\r\n            ConnectionQualityEvents.LOCAL_STATS_UPDATED,\r\n            this._onLocalStatsUpdated);\r\n\r\n        this._onP2PStatusChanged = () => {\r\n            logger.debug('Resetting average stats calculation');\r\n            this._resetAvgStats();\r\n            this.jvbStatsMonitor._resetAvgStats();\r\n            this.p2pStatsMonitor._resetAvgStats();\r\n        };\r\n        conference.on(\r\n            ConferenceEvents.P2P_STATUS,\r\n            this._onP2PStatusChanged);\r\n\r\n        this._onJvb121StatusChanged = (oldStatus, newStatus) => {\r\n            // We want to reset only on the transition from false => true,\r\n            // because otherwise those stats are resetted on JVB <=> P2P\r\n            // transition.\r\n            if (newStatus === true) {\r\n                logger.info('Resetting JVB avg RTP stats');\r\n                this._resetAvgJvbStats();\r\n            }\r\n        };\r\n        conference.on(\r\n            ConferenceEvents.JVB121_STATUS,\r\n            this._onJvb121StatusChanged);\r\n\r\n        this.jvbStatsMonitor\r\n            = new ConnectionAvgStats(this, false /* JVB */, n);\r\n\r\n        this.p2pStatsMonitor\r\n            = new ConnectionAvgStats(this, true /* P2P */, n);\r\n    }\r\n\r\n    /**\r\n     * Processes next batch of stats reported on\r\n     * {@link ConnectionQualityEvents.LOCAL_STATS_UPDATED}.\r\n     * @param {go figure} data\r\n     * @private\r\n     */\r\n    _calculateAvgStats(data) {\r\n\r\n        if (!data) {\r\n            logger.error('No stats');\r\n\r\n            return;\r\n        }\r\n\r\n        const isP2P = this._conference.isP2PActive();\r\n        const confSize = this._conference.getParticipantCount();\r\n\r\n        if (!isP2P && confSize < 2) {\r\n\r\n            // There's no point in collecting stats for a JVB conference of 1.\r\n            // That happens for short period of time after everyone leaves\r\n            // the room, until Jicofo terminates the session.\r\n            return;\r\n        }\r\n\r\n        /* Uncomment to figure out stats structure\r\n        for (const key in data) {\r\n            if (data.hasOwnProperty(key)) {\r\n                logger.info(`local stat ${key}: `, data[key]);\r\n            }\r\n        } */\r\n\r\n        const bitrate = data.bitrate;\r\n        const bandwidth = data.bandwidth;\r\n        const packetLoss = data.packetLoss;\r\n        const frameRate = data.framerate;\r\n        const resolution = data.resolution;\r\n\r\n        if (!bitrate) {\r\n            logger.error('No \"bitrate\"');\r\n\r\n            return;\r\n        } else if (!bandwidth) {\r\n            logger.error('No \"bandwidth\"');\r\n\r\n            return;\r\n        } else if (!packetLoss) {\r\n            logger.error('No \"packetloss\"');\r\n\r\n            return;\r\n        } else if (!frameRate) {\r\n            logger.error('No \"framerate\"');\r\n\r\n            return;\r\n        } else if (!resolution) {\r\n            logger.error('No resolution');\r\n\r\n            return;\r\n        }\r\n\r\n        this._avgAudioBitrateUp.addNext(bitrate.audio.upload);\r\n        this._avgAudioBitrateDown.addNext(bitrate.audio.download);\r\n\r\n        this._avgVideoBitrateUp.addNext(bitrate.video.upload);\r\n        this._avgVideoBitrateDown.addNext(bitrate.video.download);\r\n\r\n        if (browser.supportsBandwidthStatistics()) {\r\n            this._avgBandwidthUp.addNext(bandwidth.upload);\r\n            this._avgBandwidthDown.addNext(bandwidth.download);\r\n        }\r\n\r\n        this._avgPacketLossUp.addNext(packetLoss.upload);\r\n        this._avgPacketLossDown.addNext(packetLoss.download);\r\n        this._avgPacketLossTotal.addNext(packetLoss.total);\r\n\r\n        this._avgCQ.addNext(data.connectionQuality);\r\n\r\n        if (frameRate) {\r\n            this._avgRemoteFPS.addNext(\r\n                this._calculateAvgVideoFps(\r\n                    frameRate, false /* remote */, VideoType.CAMERA));\r\n            this._avgRemoteScreenFPS.addNext(\r\n                this._calculateAvgVideoFps(\r\n                    frameRate, false /* remote */, VideoType.DESKTOP));\r\n\r\n            this._avgLocalFPS.addNext(\r\n                this._calculateAvgVideoFps(\r\n                    frameRate, true /* local */, VideoType.CAMERA));\r\n            this._avgLocalScreenFPS.addNext(\r\n                this._calculateAvgVideoFps(\r\n                    frameRate, true /* local */, VideoType.DESKTOP));\r\n        }\r\n\r\n        if (resolution) {\r\n            this._avgRemoteCameraPixels.addNext(\r\n                this._calculateAvgVideoPixels(\r\n                    resolution, false /* remote */, VideoType.CAMERA));\r\n\r\n            this._avgRemoteScreenPixels.addNext(\r\n                this._calculateAvgVideoPixels(\r\n                    resolution, false /* remote */, VideoType.DESKTOP));\r\n\r\n            this._avgLocalCameraPixels.addNext(\r\n                this._calculateAvgVideoPixels(\r\n                    resolution, true /* local */, VideoType.CAMERA));\r\n\r\n            this._avgLocalScreenPixels.addNext(\r\n                this._calculateAvgVideoPixels(\r\n                    resolution, true /* local */, VideoType.DESKTOP));\r\n        }\r\n\r\n        this._sampleIdx += 1;\r\n\r\n        if (this._sampleIdx >= this._n) {\r\n\r\n            const batchReport = {\r\n                p2p: isP2P,\r\n                'conference_size': confSize\r\n            };\r\n\r\n            if (data.transport && data.transport.length) {\r\n                Object.assign(batchReport, {\r\n                    'local_candidate_type':\r\n                        data.transport[0].localCandidateType,\r\n                    'remote_candidate_type':\r\n                        data.transport[0].remoteCandidateType,\r\n                    'transport_type': data.transport[0].type\r\n                });\r\n            }\r\n\r\n            this._avgAudioBitrateUp.appendReport(batchReport);\r\n            this._avgAudioBitrateDown.appendReport(batchReport);\r\n\r\n            this._avgVideoBitrateUp.appendReport(batchReport);\r\n            this._avgVideoBitrateDown.appendReport(batchReport);\r\n\r\n            if (browser.supportsBandwidthStatistics()) {\r\n                this._avgBandwidthUp.appendReport(batchReport);\r\n                this._avgBandwidthDown.appendReport(batchReport);\r\n            }\r\n            this._avgPacketLossUp.appendReport(batchReport);\r\n            this._avgPacketLossDown.appendReport(batchReport);\r\n            this._avgPacketLossTotal.appendReport(batchReport);\r\n\r\n            this._avgRemoteFPS.appendReport(batchReport);\r\n            if (!isNaN(this._avgRemoteScreenFPS.calculate())) {\r\n                this._avgRemoteScreenFPS.appendReport(batchReport);\r\n            }\r\n            this._avgLocalFPS.appendReport(batchReport);\r\n            if (!isNaN(this._avgLocalScreenFPS.calculate())) {\r\n                this._avgLocalScreenFPS.appendReport(batchReport);\r\n            }\r\n\r\n            this._avgRemoteCameraPixels.appendReport(batchReport);\r\n            if (!isNaN(this._avgRemoteScreenPixels.calculate())) {\r\n                this._avgRemoteScreenPixels.appendReport(batchReport);\r\n            }\r\n            this._avgLocalCameraPixels.appendReport(batchReport);\r\n            if (!isNaN(this._avgLocalScreenPixels.calculate())) {\r\n                this._avgLocalScreenPixels.appendReport(batchReport);\r\n            }\r\n\r\n            this._avgCQ.appendReport(batchReport);\r\n\r\n            Statistics.sendAnalytics(createRtpStatsEvent(batchReport));\r\n\r\n            this._resetAvgStats();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Calculates average number of pixels for the report\r\n     *\r\n     * @param {map} peerResolutions a map of peer resolutions\r\n     * @param {boolean} isLocal if the average is to be calculated for the local\r\n     * video or <tt>false</tt> if for remote videos.\r\n     * @param {VideoType} videoType\r\n     * @return {number|NaN} average number of pixels or <tt>NaN</tt> if there\r\n     * are no samples.\r\n     * @private\r\n     */\r\n    _calculateAvgVideoPixels(peerResolutions, isLocal, videoType) {\r\n        let peerPixelsSum = 0;\r\n        let peerCount = 0;\r\n        const myID = this._conference.myUserId();\r\n\r\n        for (const peerID of Object.keys(peerResolutions)) {\r\n            if (isLocal ? peerID === myID : peerID !== myID) {\r\n                const participant\r\n                    = isLocal\r\n                        ? null\r\n                        : this._conference.getParticipantById(peerID);\r\n                const videosResolution = peerResolutions[peerID];\r\n\r\n                // Do not continue without participant for non local peerID\r\n                if ((isLocal || participant) && videosResolution) {\r\n                    const peerAvgPixels = this._calculatePeerAvgVideoPixels(\r\n                        videosResolution, participant, videoType);\r\n\r\n                    if (!isNaN(peerAvgPixels)) {\r\n                        peerPixelsSum += peerAvgPixels;\r\n                        peerCount += 1;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return peerPixelsSum / peerCount;\r\n    }\r\n\r\n    /**\r\n     * Calculate average pixels for either remote or local participant\r\n     * @param {object} videos maps resolution per video SSRC\r\n     * @param {JitsiParticipant|null} participant remote participant or\r\n     * <tt>null</tt> for local video pixels calculation.\r\n     * @param {VideoType} videoType the type of the video for which an average\r\n     * will be calculated.\r\n     * @return {number|NaN} average video pixels of all participant's videos or\r\n     * <tt>NaN</tt> if currently not available\r\n     * @private\r\n     */\r\n    _calculatePeerAvgVideoPixels(videos, participant, videoType) {\r\n        let ssrcs = Object.keys(videos).map(ssrc => Number(ssrc));\r\n        let videoTracks = null;\r\n\r\n        // NOTE that this method is supposed to be called for the stats\r\n        // received from the current peerconnection.\r\n        const tpc = this._conference.getActivePeerConnection();\r\n\r\n        if (participant) {\r\n            videoTracks = participant.getTracksByMediaType(MediaType.VIDEO);\r\n            if (videoTracks) {\r\n                ssrcs\r\n                    = ssrcs.filter(\r\n                        ssrc => videoTracks.find(\r\n                            track =>\r\n                                !track.isMuted()\r\n                                    && track.getSSRC() === ssrc\r\n                                    && track.videoType === videoType));\r\n            }\r\n        } else {\r\n            videoTracks = this._conference.getLocalTracks(MediaType.VIDEO);\r\n            ssrcs\r\n                = ssrcs.filter(\r\n                    ssrc => videoTracks.find(\r\n                        track =>\r\n                            !track.isMuted()\r\n                                && tpc.getLocalSSRC(track) === ssrc\r\n                                && track.videoType === videoType));\r\n        }\r\n\r\n        let peerPixelsSum = 0;\r\n        let peerSsrcCount = 0;\r\n\r\n        for (const ssrc of ssrcs) {\r\n            const peerSsrcPixels\r\n                = Number(videos[ssrc].height) * Number(videos[ssrc].width);\r\n\r\n            // FPS is reported as 0 for users with no video\r\n            if (!isNaN(peerSsrcPixels) && peerSsrcPixels > 0) {\r\n                peerPixelsSum += peerSsrcPixels;\r\n                peerSsrcCount += 1;\r\n            }\r\n        }\r\n\r\n        return peerPixelsSum / peerSsrcCount;\r\n    }\r\n\r\n\r\n    /**\r\n     * Calculates average FPS for the report\r\n     * @param {go figure} frameRate\r\n     * @param {boolean} isLocal if the average is to be calculated for the local\r\n     * video or <tt>false</tt> if for remote videos.\r\n     * @param {VideoType} videoType\r\n     * @return {number|NaN} average FPS or <tt>NaN</tt> if there are no samples.\r\n     * @private\r\n     */\r\n    _calculateAvgVideoFps(frameRate, isLocal, videoType) {\r\n        let peerFpsSum = 0;\r\n        let peerCount = 0;\r\n        const myID = this._conference.myUserId();\r\n\r\n        for (const peerID of Object.keys(frameRate)) {\r\n            if (isLocal ? peerID === myID : peerID !== myID) {\r\n                const participant\r\n                    = isLocal\r\n                        ? null : this._conference.getParticipantById(peerID);\r\n                const videosFps = frameRate[peerID];\r\n\r\n                // Do not continue without participant for non local peerID\r\n                if ((isLocal || participant) && videosFps) {\r\n                    const peerAvgFPS\r\n                        = this._calculatePeerAvgVideoFps(\r\n                            videosFps, participant, videoType);\r\n\r\n                    if (!isNaN(peerAvgFPS)) {\r\n                        peerFpsSum += peerAvgFPS;\r\n                        peerCount += 1;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return peerFpsSum / peerCount;\r\n    }\r\n\r\n    /**\r\n     * Calculate average FPS for either remote or local participant\r\n     * @param {object} videos maps FPS per video SSRC\r\n     * @param {JitsiParticipant|null} participant remote participant or\r\n     * <tt>null</tt> for local FPS calculation.\r\n     * @param {VideoType} videoType the type of the video for which an average\r\n     * will be calculated.\r\n     * @return {number|NaN} average FPS of all participant's videos or\r\n     * <tt>NaN</tt> if currently not available\r\n     * @private\r\n     */\r\n    _calculatePeerAvgVideoFps(videos, participant, videoType) {\r\n        let ssrcs = Object.keys(videos).map(ssrc => Number(ssrc));\r\n        let videoTracks = null;\r\n\r\n        // NOTE that this method is supposed to be called for the stats\r\n        // received from the current peerconnection.\r\n        const tpc = this._conference.getActivePeerConnection();\r\n\r\n        if (participant) {\r\n            videoTracks = participant.getTracksByMediaType(MediaType.VIDEO);\r\n            if (videoTracks) {\r\n                ssrcs\r\n                    = ssrcs.filter(\r\n                        ssrc => videoTracks.find(\r\n                            track => !track.isMuted()\r\n                                && track.getSSRC() === ssrc\r\n                                && track.videoType === videoType));\r\n            }\r\n        } else {\r\n            videoTracks = this._conference.getLocalTracks(MediaType.VIDEO);\r\n            ssrcs\r\n                = ssrcs.filter(\r\n                    ssrc => videoTracks.find(\r\n                        track => !track.isMuted()\r\n                            && tpc.getLocalSSRC(track) === ssrc\r\n                            && track.videoType === videoType));\r\n        }\r\n\r\n        let peerFpsSum = 0;\r\n        let peerSsrcCount = 0;\r\n\r\n        for (const ssrc of ssrcs) {\r\n            const peerSsrcFps = Number(videos[ssrc]);\r\n\r\n            // FPS is reported as 0 for users with no video\r\n            if (!isNaN(peerSsrcFps) && peerSsrcFps > 0) {\r\n                peerFpsSum += peerSsrcFps;\r\n                peerSsrcCount += 1;\r\n            }\r\n        }\r\n\r\n        return peerFpsSum / peerSsrcCount;\r\n    }\r\n\r\n    /**\r\n     * Resets the stats related to JVB connection. Must not be called when in\r\n     * P2P mode, because then the {@link AverageStatReport} instances are\r\n     * tracking P2P stats. Note that this should never happen unless something\r\n     * is wrong with the P2P and JVB121 events.\r\n     * @private\r\n     */\r\n    _resetAvgJvbStats() {\r\n        this._resetAvgStats();\r\n        this.jvbStatsMonitor._resetAvgStats();\r\n    }\r\n\r\n    /**\r\n     * Reset cache of all averages and {@link _sampleIdx}.\r\n     * @private\r\n     */\r\n    _resetAvgStats() {\r\n        this._avgAudioBitrateUp.reset();\r\n        this._avgAudioBitrateDown.reset();\r\n\r\n        this._avgVideoBitrateUp.reset();\r\n        this._avgVideoBitrateDown.reset();\r\n\r\n        this._avgBandwidthUp.reset();\r\n        this._avgBandwidthDown.reset();\r\n\r\n        this._avgPacketLossUp.reset();\r\n        this._avgPacketLossDown.reset();\r\n        this._avgPacketLossTotal.reset();\r\n\r\n        this._avgRemoteFPS.reset();\r\n        this._avgRemoteScreenFPS.reset();\r\n        this._avgLocalFPS.reset();\r\n        this._avgLocalScreenFPS.reset();\r\n\r\n        this._avgRemoteCameraPixels.reset();\r\n        this._avgRemoteScreenPixels.reset();\r\n        this._avgLocalCameraPixels.reset();\r\n        this._avgLocalScreenPixels.reset();\r\n\r\n        this._avgCQ.reset();\r\n\r\n        this._sampleIdx = 0;\r\n    }\r\n\r\n    /**\r\n     * Unregisters all event listeners and stops working.\r\n     */\r\n    dispose() {\r\n        this._conference.off(\r\n            ConferenceEvents.P2P_STATUS,\r\n            this._onP2PStatusChanged);\r\n        this._conference.off(\r\n            ConnectionQualityEvents.LOCAL_STATS_UPDATED,\r\n            this._onLocalStatsUpdated);\r\n        this._conference.off(\r\n            ConferenceEvents.JVB121_STATUS,\r\n            this._onJvb121StatusChanged);\r\n        this.jvbStatsMonitor.dispose();\r\n        this.p2pStatsMonitor.dispose();\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/statistics/AvgRTPStatsReporter.js","/* Copyright @ 2016 Atlassian Pty Ltd\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nvar Logger = require('./Logger.js');\r\n\r\n/**\r\n * Creates new <tt>LogCollector</tt>. Class implements <tt>LoggerTransport</tt>\r\n * and thus can be added as global transport in order to capture all the logs.\r\n *\r\n * It captures subsequent log lines created whenever <tt>Logger</tt> logs\r\n * a message and stores them in a queue in order to batch log entries. There are\r\n * time and size limit constraints which determine how often batch entries are\r\n * stored. Whenever one of these limits is exceeded the <tt>LogCollector</tt>\r\n * will use the <tt>logStorage</tt> object given as an argument to save\r\n * the batch log entry.\r\n *\r\n * @param {Object} logStorage an object which allows to store the logs collected\r\n * @param {function(string|object[])} logStorage.storeLogs a method called when\r\n * this <tt>LogCollector</tt> requests log entry storage. The method's argument\r\n * is an array which can contain <tt>string</tt>s and <tt>object</tt>s. If given\r\n * item is an object it means that it's an aggregated message. That is a message\r\n * which is the same as the previous one and it's representation has\r\n * the following format:\r\n * {\r\n *   {string} text: 'the text of some duplicated message'\r\n *   {number} count: 3 // how many times the message appeared in a row\r\n * }\r\n * If a message \"B\" after an aggregated message \"A\" is different, then it breaks\r\n * the sequence of \"A\". Which means that even if the next message \"C\" is\r\n * the same as \"A\" it will start a new aggregated message \"C\".\r\n * @param {function()} logStorage.isReady a method which should return\r\n * a <tt>boolean</tt> to tell the collector that it's ready to store. During the\r\n * time storage is not ready log batches will be cached and stored on the next\r\n * occasion (flush or interval timeout).\r\n *\r\n * @param {Object} options the <tt>LogCollector</tt> configuration options.\r\n * @param {number} options.maxEntryLength the size limit for a single log entry\r\n * to be stored. The <tt>LogCollector</tt> will push the entry as soon as it\r\n * reaches or exceeds this limit given that <tt>logStorage.isReady</tt>\r\n * returns <tt>true</tt>. Otherwise the log entry will be cached until the log\r\n * storage becomes ready. Note that the \"is ready\" condition is checked every\r\n * <tt>options.storeInterval</tt> milliseconds.\r\n * @param {number} options.storeInterval how often the logs should be stored in\r\n * case <tt>maxEntryLength</tt> was not exceeded.\r\n * @param {boolean} options.stringifyObjects indicates whether or not object\r\n * arguments should be \"stringified\" with <tt>JSON.stringify</tt> when a log\r\n * message is composed. Note that objects logged on the error log level are\r\n * always stringified.\r\n *\r\n * @constructor\r\n */\r\nfunction LogCollector(logStorage, options) {\r\n    this.logStorage = logStorage;\r\n    this.stringifyObjects\r\n        = options && options.stringifyObjects\r\n            ? options.stringifyObjects : false;\r\n    this.storeInterval\r\n        = options && options.storeInterval\r\n            ? options.storeInterval: 30000;\r\n    this.maxEntryLength\r\n        = options && options.maxEntryLength\r\n            ? options.maxEntryLength : 10000;\r\n    // Bind the log method for each level to the corresponding method name\r\n    // in order to implement \"global log transport\" object.\r\n    Object.keys(Logger.levels).forEach(\r\n    function (logLevel) {\r\n        var methodName = Logger.levels[logLevel];\r\n        this[methodName] = function (logLevel) {\r\n            this._log.apply(this, arguments);\r\n        }.bind(this, logLevel);\r\n    }.bind(this));\r\n    /**\r\n     * The ID of store logs interval if one is currently scheduled or\r\n     * <tt>null</tt> otherwise.\r\n     * @type {number|null}\r\n     */\r\n    this.storeLogsIntervalID = null;\r\n    /**\r\n     * The log messages that are to be batched into log entry when\r\n     * {@link LogCollector._flush} method is called.\r\n     * @type {string[]}\r\n     */\r\n    this.queue = [];\r\n    /**\r\n     * The total length of all messages currently stored in the {@link queue}.\r\n     * @type {number}\r\n     */\r\n    this.totalLen = 0;\r\n    /**\r\n     * An array used to temporarily store log batches, before the storage gets\r\n     * ready.\r\n     * @type {string[]}\r\n     */\r\n    this.outputCache = [];\r\n}\r\n\r\n/**\r\n * Method called inside of {@link formatLogMessage} in order to covert an\r\n * <tt>Object</tt> argument to string. The conversion will happen when either\r\n * 'stringifyObjects' option is enabled or on the {@link Logger.levels.ERROR}\r\n * log level. The default implementation uses <tt>JSON.stringify</tt> and\r\n * returns \"[object with circular refs?]\" instead of an object if it fails.\r\n *\r\n * @param {object} someObject the <tt>object</tt> to be stringified.\r\n *\r\n * @return {string} the result of <tt>JSON.stringify</tt> or\r\n * \"[object with circular refs?]\" if any error occurs during \"stringification\".\r\n *\r\n * @protected\r\n */\r\nLogCollector.prototype.stringify = function (someObject) {\r\n    try {\r\n        return JSON.stringify(someObject);\r\n    } catch (error) {\r\n        return \"[object with circular refs?]\";\r\n    }\r\n};\r\n\r\n/**\r\n * Formats log entry for the given logging level and arguments passed to the\r\n * <tt>Logger</tt>'s log method. The first argument is log level and the next\r\n * arguments have to be captured using JS built-in 'arguments' variable.\r\n *\r\n * @param {Logger.levels} logLevel provides the logging level of the message to\r\n * be logged.\r\n *\r\n * @return {string|null} a non-empty string representation of the log entry\r\n * crafted from the log arguments. If the return value is <tt>null</tt> then\r\n * the message wil be discarded by this <tt>LogCollector</tt>.\r\n *\r\n * @protected\r\n */\r\nLogCollector.prototype.formatLogMessage\r\n= function (logLevel/*, arg1, arg2, arg3... */) {\r\n    var msg = '';\r\n    for (var i = 1, len = arguments.length; i < len; i++) {\r\n        var arg = arguments[i];\r\n        // objects logged on error level are always converted to JSON\r\n        if ((this.stringifyObjects || logLevel === Logger.levels.ERROR)\r\n            && typeof arg === 'object') {\r\n            arg = this.stringify(arg);\r\n        }\r\n        msg += arg;\r\n        if (i != len - 1) {\r\n            msg += ' ';\r\n        }\r\n    }\r\n    return msg.length ? msg : null;\r\n};\r\n\r\n/**\r\n * The log method bound to each of the logging levels in order to implement\r\n * \"global log transport\" object.\r\n *\r\n * @private\r\n */\r\nLogCollector.prototype._log = function() {\r\n\r\n    // var logLevel = arguments[0]; first argument is the log level\r\n    var msg = this.formatLogMessage.apply(this, arguments);\r\n    if (msg) {\r\n        // The same as the previous message aggregation logic\r\n        var prevMessage\r\n            = this.queue.length ? this.queue[this.queue.length -1] : undefined;\r\n        // NOTE that typeof undefined is 'undefined'\r\n        var prevMessageText\r\n            = typeof prevMessage === 'object' ? prevMessage.text : prevMessage;\r\n        // Is it the same as the previous one ?\r\n        if (prevMessageText == msg) {\r\n            if (typeof prevMessage === 'object') {\r\n                prevMessage.count += 1;\r\n            } else {\r\n                this.queue[this.queue.length-1] = {\r\n                    text: msg,\r\n                    count: 2\r\n                }\r\n            }\r\n        } else {\r\n            this.queue.push(msg);\r\n            this.totalLen += msg.length;\r\n        }\r\n    }\r\n\r\n    if (this.totalLen >= this.maxEntryLength) {\r\n        this._flush(true /* force */, true /* reschedule */);\r\n    }\r\n};\r\n\r\n/**\r\n * Starts periodical \"store logs\" task which will be triggered at the interval\r\n * specified in the constructor options.\r\n */\r\nLogCollector.prototype.start = function () {\r\n    this._reschedulePublishInterval();\r\n};\r\n\r\n/**\r\n * Reschedules the periodical \"store logs\" task which will store the next batch\r\n * log entry in the storage.\r\n * @private\r\n */\r\nLogCollector.prototype._reschedulePublishInterval = function () {\r\n    if (this.storeLogsIntervalID) {\r\n        window.clearTimeout(this.storeLogsIntervalID);\r\n        this.storeLogsIntervalID = null;\r\n    }\r\n    // It's actually a timeout, because it is rescheduled on every flush\r\n    this.storeLogsIntervalID\r\n        = window.setTimeout(\r\n            this._flush.bind(\r\n                this, false /* do not force */, true /* reschedule */),\r\n            this.storeInterval);\r\n};\r\n\r\n/**\r\n * Call this method to flush the log entry buffer and store it in the log\r\n * storage immediately (given that the storage is ready).\r\n */\r\nLogCollector.prototype.flush = function() {\r\n    this._flush(\r\n        false /* do not force, as it will not be stored anyway */,\r\n        true /* reschedule next update */ )\r\n};\r\n\r\n/**\r\n * Stores the next batch log entry in the log storage.\r\n * @param {boolean} force enforce current logs batch to be stored or cached if\r\n * there is anything to be logged, but the storage is not ready yet. One of\r\n * legitimate reasons to force is when the logs length exceeds size limit which\r\n * could result in truncation.\r\n * @param {boolean} reschedule <tt>true</tt> if the next periodic task should be\r\n * scheduled after the log entry is stored. <tt>false</tt> will end the periodic\r\n * task cycle.\r\n * @private\r\n */\r\nLogCollector.prototype._flush = function(force, reschedule) {\r\n    // Publish only if there's anything to be logged\r\n    if (this.totalLen > 0 && (this.logStorage.isReady() || force)) {\r\n        //FIXME avoid truncating\r\n        // right now we don't care if the message size is \"slightly\" exceeded\r\n        if (this.logStorage.isReady()) {\r\n            // Sends all cached logs\r\n            if (this.outputCache.length) {\r\n                this.outputCache.forEach(\r\n                    function (cachedQueue) {\r\n                        this.logStorage.storeLogs(cachedQueue);\r\n                    }.bind(this)\r\n                );\r\n                // Clear the cache\r\n                this.outputCache = [];\r\n            }\r\n            // Send current batch\r\n            this.logStorage.storeLogs(this.queue);\r\n        } else {\r\n            this.outputCache.push(this.queue);\r\n        }\r\n\r\n        this.queue = [];\r\n        this.totalLen = 0;\r\n    }\r\n\r\n    if (reschedule) {\r\n        this._reschedulePublishInterval();\r\n    }\r\n};\r\n\r\n/**\r\n * Stops the periodical \"store logs\" task and immediately stores any pending\r\n * log entries as a batch.\r\n */\r\nLogCollector.prototype.stop = function() {\r\n    // Flush and stop publishing logs\r\n    this._flush(false /* do not force */, false /* do not reschedule */);\r\n};\r\n\r\nmodule.exports = LogCollector;\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/jitsi-meet-logger/lib/LogCollector.js","import bowser from 'bowser';\r\nimport { getLogger } from 'jitsi-meet-logger';\r\n\r\nimport {\r\n    CHROME,\r\n    OPERA,\r\n    FIREFOX,\r\n    INTERNET_EXPLORER,\r\n    EDGE,\r\n    SAFARI,\r\n    NWJS,\r\n    ELECTRON,\r\n    REACT_NATIVE\r\n} from './browsers';\r\n\r\nconst logger = getLogger(__filename);\r\n\r\n/**\r\n * Maps the names of the browsers from bowser to the internal names defined in\r\n * ./browsers.js\r\n */\r\nconst bowserNameToJitsiName = {\r\n    'Chrome': CHROME,\r\n    'Chromium': CHROME,\r\n    'Opera': OPERA,\r\n    'Firefox': FIREFOX,\r\n    'Internet Explorer': INTERNET_EXPLORER,\r\n    'Microsoft Edge': EDGE,\r\n    'Safari': SAFARI\r\n};\r\n\r\n/**\r\n * Detects Electron environment.\r\n *\r\n * @returns {Object} - The name (ELECTRON) and version.\r\n */\r\nfunction _detectElectron() {\r\n    const userAgent = navigator.userAgent;\r\n\r\n    if (userAgent.match(/Electron/)) {\r\n        const version = userAgent.match(/Electron\\/([\\d.]+)/)[1];\r\n\r\n        logger.info(`This appears to be Electron, ver: ${version}`);\r\n\r\n        return {\r\n            name: ELECTRON,\r\n            version\r\n        };\r\n    }\r\n}\r\n\r\n/**\r\n * Detects NWJS environment.\r\n *\r\n * @returns {Object} - The name (NWJS) and version.\r\n */\r\nfunction _detectNWJS() {\r\n    const userAgent = navigator.userAgent;\r\n\r\n    if (userAgent.match(/JitsiMeetNW/)) {\r\n        const version = userAgent.match(/JitsiMeetNW\\/([\\d.]+)/)[1];\r\n\r\n        logger.info(`This appears to be JitsiMeetNW, ver: ${version}`);\r\n\r\n        return {\r\n            name: NWJS,\r\n            version\r\n        };\r\n    }\r\n}\r\n\r\n/**\r\n * Detects React Native environment.\r\n * @returns {Object} - The name (REACT_NATIVE) and version\r\n */\r\nfunction _detectReactNative() {\r\n    const match\r\n        = navigator.userAgent.match(/\\b(react[ \\t_-]*native)(?:\\/(\\S+))?/i);\r\n    let version;\r\n\r\n    // If we're remote debugging a React Native app, it may be treated as\r\n    // Chrome. Check navigator.product as well and always return some version\r\n    // even if we can't get the real one.\r\n\r\n    if (match || navigator.product === 'ReactNative') {\r\n        let name;\r\n\r\n        if (match && match.length > 2) {\r\n            name = match[1];\r\n            version = match[2];\r\n        }\r\n        name || (name = 'react-native');\r\n        version || (version = 'unknown');\r\n        logger.info(`This appears to be ${name}, ver: ${version}`);\r\n\r\n        return {\r\n            name: REACT_NATIVE,\r\n            version\r\n        };\r\n    }\r\n}\r\n\r\n/**\r\n * Returns information about the current browser.\r\n *\r\n * @returns {Object} - The name and version of the browser.\r\n */\r\nfunction _detect() {\r\n    let browserInfo;\r\n    const detectors = [\r\n        _detectReactNative,\r\n        _detectElectron,\r\n        _detectNWJS\r\n    ];\r\n\r\n    // Try all browser detectors\r\n    for (let i = 0; i < detectors.length; i++) {\r\n        browserInfo = detectors[i]();\r\n        if (browserInfo) {\r\n            return browserInfo;\r\n        }\r\n    }\r\n\r\n    const { name, version } = bowser;\r\n\r\n    if (name in bowserNameToJitsiName) {\r\n        logger.info(`This appears to be ${name}, ver: ${version}`);\r\n\r\n        return {\r\n            name: bowserNameToJitsiName[name],\r\n            version\r\n        };\r\n    }\r\n\r\n    logger.warn('Browser type defaults to Safari ver 1');\r\n\r\n    return {\r\n        name: SAFARI,\r\n        version: '1'\r\n    };\r\n}\r\n\r\n/**\r\n * Implements browser detection.\r\n */\r\nexport default class BrowserDetection {\r\n    /**\r\n     * Creates new BrowserDetection instance.\r\n     *\r\n     * @param {Object} [browserInfo] - Information about the browser.\r\n     * @param {string} browserInfo.name - The name of the browser.\r\n     * @param {string} browserInfo.version - The version of the browser.\r\n     */\r\n    constructor(browserInfo = _detect()) {\r\n        const { name, version } = browserInfo;\r\n\r\n        this._name = name;\r\n        this._version = version;\r\n    }\r\n\r\n    /**\r\n     * Gets current browser name.\r\n     * @returns {string}\r\n     */\r\n    getName() {\r\n        return this._name;\r\n    }\r\n\r\n    /**\r\n     * Checks if current browser is Chrome.\r\n     * @returns {boolean}\r\n     */\r\n    isChrome() {\r\n        return this._name === CHROME;\r\n    }\r\n\r\n    /**\r\n     * Checks if current browser is Opera.\r\n     * @returns {boolean}\r\n     */\r\n    isOpera() {\r\n        return this._name === OPERA;\r\n    }\r\n\r\n    /**\r\n     * Checks if current browser is Firefox.\r\n     * @returns {boolean}\r\n     */\r\n    isFirefox() {\r\n        return this._name === FIREFOX;\r\n    }\r\n\r\n    /**\r\n     * Checks if current browser is Internet Explorer.\r\n     * @returns {boolean}\r\n     */\r\n    isIExplorer() {\r\n        return this._name === INTERNET_EXPLORER;\r\n    }\r\n\r\n    /**\r\n     * Checks if current browser is Microsoft Edge.\r\n     * @returns {boolean}\r\n     */\r\n    isEdge() {\r\n        return this._name === EDGE;\r\n    }\r\n\r\n    /**\r\n     * Checks if current browser is Safari.\r\n     * @returns {boolean}\r\n     */\r\n    isSafari() {\r\n        return this._name === SAFARI;\r\n    }\r\n\r\n    /**\r\n     * Checks if current environment is NWJS.\r\n     * @returns {boolean}\r\n     */\r\n    isNWJS() {\r\n        return this._name === NWJS;\r\n    }\r\n\r\n    /**\r\n     * Checks if current environment is Electron.\r\n     * @returns {boolean}\r\n     */\r\n    isElectron() {\r\n        return this._name === ELECTRON;\r\n    }\r\n\r\n    /**\r\n     * Checks if current environment is React Native.\r\n     * @returns {boolean}\r\n     */\r\n    isReactNative() {\r\n        return this._name === REACT_NATIVE;\r\n    }\r\n\r\n    /**\r\n     * Returns the version of the current browser.\r\n     * @returns {string}\r\n     */\r\n    getVersion() {\r\n        return this._version;\r\n    }\r\n\r\n    /**\r\n     * Compares the passed version with the current browser version.\r\n     * {@see https://github.com/lancedikson/bowser}\r\n     */\r\n    static compareVersions = bowser.compareVersions;\r\n\r\n    /**\r\n     * Compares the passed version with the current browser version.\r\n     *\r\n     * @param {string} version - The version to compare with.\r\n     * @returns {number|undefined} - Returns 0 if the version is equal to the\r\n     * current one, 1 if the version is greater than the current one, -1 if the\r\n     * version is lower than the current one and undefined if the current\r\n     * browser version is unknown.\r\n     */\r\n    compareVersion(version) {\r\n        if (this._version) {\r\n            return bowser.compareVersions([ version, this._version ]);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Compares the passed version with the current browser version.\r\n     *\r\n     * @param {string} version - The version to compare with.\r\n     * @returns {boolean|undefined} - Returns true if the current version is\r\n     * greater than the passed version and false otherwise.\r\n     */\r\n    isVersionGreaterThan(version) {\r\n        return this.compareVersion(version) === -1;\r\n    }\r\n\r\n    /**\r\n     * Compares the passed version with the current browser version.\r\n     *\r\n     * @param {string} version - The version to compare with.\r\n     * @returns {boolean|undefined} - Returns true if the current version is\r\n     * lower than the passed version and false otherwise.\r\n     */\r\n    isVersionLessThan(version) {\r\n        return this.compareVersion(version) === 1;\r\n    }\r\n\r\n    /**\r\n     * Compares the passed version with the current browser version.\r\n     *\r\n     * @param {string} version - The version to compare with.\r\n     * @returns {boolean|undefined} - Returns true if the current version is\r\n     * equal to the passed version and false otherwise.\r\n     */\r\n    isVersionEqualTo(version) {\r\n        return this.compareVersion(version) === 0;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/browser/BrowserDetection.js","/*!\n * Bowser - a browser detector\n * https://github.com/ded/bowser\n * MIT License | (c) Dustin Diaz 2015\n */\n\n!function (root, name, definition) {\n  if (typeof module != 'undefined' && module.exports) module.exports = definition()\n  else if (typeof define == 'function' && define.amd) define(name, definition)\n  else root[name] = definition()\n}(this, 'bowser', function () {\n  /**\n    * See useragents.js for examples of navigator.userAgent\n    */\n\n  var t = true\n\n  function detect(ua) {\n\n    function getFirstMatch(regex) {\n      var match = ua.match(regex);\n      return (match && match.length > 1 && match[1]) || '';\n    }\n\n    function getSecondMatch(regex) {\n      var match = ua.match(regex);\n      return (match && match.length > 1 && match[2]) || '';\n    }\n\n    var iosdevice = getFirstMatch(/(ipod|iphone|ipad)/i).toLowerCase()\n      , likeAndroid = /like android/i.test(ua)\n      , android = !likeAndroid && /android/i.test(ua)\n      , nexusMobile = /nexus\\s*[0-6]\\s*/i.test(ua)\n      , nexusTablet = !nexusMobile && /nexus\\s*[0-9]+/i.test(ua)\n      , chromeos = /CrOS/.test(ua)\n      , silk = /silk/i.test(ua)\n      , sailfish = /sailfish/i.test(ua)\n      , tizen = /tizen/i.test(ua)\n      , webos = /(web|hpw)os/i.test(ua)\n      , windowsphone = /windows phone/i.test(ua)\n      , samsungBrowser = /SamsungBrowser/i.test(ua)\n      , windows = !windowsphone && /windows/i.test(ua)\n      , mac = !iosdevice && !silk && /macintosh/i.test(ua)\n      , linux = !android && !sailfish && !tizen && !webos && /linux/i.test(ua)\n      , edgeVersion = getSecondMatch(/edg([ea]|ios)\\/(\\d+(\\.\\d+)?)/i)\n      , versionIdentifier = getFirstMatch(/version\\/(\\d+(\\.\\d+)?)/i)\n      , tablet = /tablet/i.test(ua) && !/tablet pc/i.test(ua)\n      , mobile = !tablet && /[^-]mobi/i.test(ua)\n      , xbox = /xbox/i.test(ua)\n      , result\n\n    if (/opera/i.test(ua)) {\n      //  an old Opera\n      result = {\n        name: 'Opera'\n      , opera: t\n      , version: versionIdentifier || getFirstMatch(/(?:opera|opr|opios)[\\s\\/](\\d+(\\.\\d+)?)/i)\n      }\n    } else if (/opr\\/|opios/i.test(ua)) {\n      // a new Opera\n      result = {\n        name: 'Opera'\n        , opera: t\n        , version: getFirstMatch(/(?:opr|opios)[\\s\\/](\\d+(\\.\\d+)?)/i) || versionIdentifier\n      }\n    }\n    else if (/SamsungBrowser/i.test(ua)) {\n      result = {\n        name: 'Samsung Internet for Android'\n        , samsungBrowser: t\n        , version: versionIdentifier || getFirstMatch(/(?:SamsungBrowser)[\\s\\/](\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (/coast/i.test(ua)) {\n      result = {\n        name: 'Opera Coast'\n        , coast: t\n        , version: versionIdentifier || getFirstMatch(/(?:coast)[\\s\\/](\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (/yabrowser/i.test(ua)) {\n      result = {\n        name: 'Yandex Browser'\n      , yandexbrowser: t\n      , version: versionIdentifier || getFirstMatch(/(?:yabrowser)[\\s\\/](\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (/ucbrowser/i.test(ua)) {\n      result = {\n          name: 'UC Browser'\n        , ucbrowser: t\n        , version: getFirstMatch(/(?:ucbrowser)[\\s\\/](\\d+(?:\\.\\d+)+)/i)\n      }\n    }\n    else if (/mxios/i.test(ua)) {\n      result = {\n        name: 'Maxthon'\n        , maxthon: t\n        , version: getFirstMatch(/(?:mxios)[\\s\\/](\\d+(?:\\.\\d+)+)/i)\n      }\n    }\n    else if (/epiphany/i.test(ua)) {\n      result = {\n        name: 'Epiphany'\n        , epiphany: t\n        , version: getFirstMatch(/(?:epiphany)[\\s\\/](\\d+(?:\\.\\d+)+)/i)\n      }\n    }\n    else if (/puffin/i.test(ua)) {\n      result = {\n        name: 'Puffin'\n        , puffin: t\n        , version: getFirstMatch(/(?:puffin)[\\s\\/](\\d+(?:\\.\\d+)?)/i)\n      }\n    }\n    else if (/sleipnir/i.test(ua)) {\n      result = {\n        name: 'Sleipnir'\n        , sleipnir: t\n        , version: getFirstMatch(/(?:sleipnir)[\\s\\/](\\d+(?:\\.\\d+)+)/i)\n      }\n    }\n    else if (/k-meleon/i.test(ua)) {\n      result = {\n        name: 'K-Meleon'\n        , kMeleon: t\n        , version: getFirstMatch(/(?:k-meleon)[\\s\\/](\\d+(?:\\.\\d+)+)/i)\n      }\n    }\n    else if (windowsphone) {\n      result = {\n        name: 'Windows Phone'\n      , osname: 'Windows Phone'\n      , windowsphone: t\n      }\n      if (edgeVersion) {\n        result.msedge = t\n        result.version = edgeVersion\n      }\n      else {\n        result.msie = t\n        result.version = getFirstMatch(/iemobile\\/(\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (/msie|trident/i.test(ua)) {\n      result = {\n        name: 'Internet Explorer'\n      , msie: t\n      , version: getFirstMatch(/(?:msie |rv:)(\\d+(\\.\\d+)?)/i)\n      }\n    } else if (chromeos) {\n      result = {\n        name: 'Chrome'\n      , osname: 'Chrome OS'\n      , chromeos: t\n      , chromeBook: t\n      , chrome: t\n      , version: getFirstMatch(/(?:chrome|crios|crmo)\\/(\\d+(\\.\\d+)?)/i)\n      }\n    } else if (/edg([ea]|ios)/i.test(ua)) {\n      result = {\n        name: 'Microsoft Edge'\n      , msedge: t\n      , version: edgeVersion\n      }\n    }\n    else if (/vivaldi/i.test(ua)) {\n      result = {\n        name: 'Vivaldi'\n        , vivaldi: t\n        , version: getFirstMatch(/vivaldi\\/(\\d+(\\.\\d+)?)/i) || versionIdentifier\n      }\n    }\n    else if (sailfish) {\n      result = {\n        name: 'Sailfish'\n      , osname: 'Sailfish OS'\n      , sailfish: t\n      , version: getFirstMatch(/sailfish\\s?browser\\/(\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (/seamonkey\\//i.test(ua)) {\n      result = {\n        name: 'SeaMonkey'\n      , seamonkey: t\n      , version: getFirstMatch(/seamonkey\\/(\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (/firefox|iceweasel|fxios/i.test(ua)) {\n      result = {\n        name: 'Firefox'\n      , firefox: t\n      , version: getFirstMatch(/(?:firefox|iceweasel|fxios)[ \\/](\\d+(\\.\\d+)?)/i)\n      }\n      if (/\\((mobile|tablet);[^\\)]*rv:[\\d\\.]+\\)/i.test(ua)) {\n        result.firefoxos = t\n        result.osname = 'Firefox OS'\n      }\n    }\n    else if (silk) {\n      result =  {\n        name: 'Amazon Silk'\n      , silk: t\n      , version : getFirstMatch(/silk\\/(\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (/phantom/i.test(ua)) {\n      result = {\n        name: 'PhantomJS'\n      , phantom: t\n      , version: getFirstMatch(/phantomjs\\/(\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (/slimerjs/i.test(ua)) {\n      result = {\n        name: 'SlimerJS'\n        , slimer: t\n        , version: getFirstMatch(/slimerjs\\/(\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (/blackberry|\\bbb\\d+/i.test(ua) || /rim\\stablet/i.test(ua)) {\n      result = {\n        name: 'BlackBerry'\n      , osname: 'BlackBerry OS'\n      , blackberry: t\n      , version: versionIdentifier || getFirstMatch(/blackberry[\\d]+\\/(\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (webos) {\n      result = {\n        name: 'WebOS'\n      , osname: 'WebOS'\n      , webos: t\n      , version: versionIdentifier || getFirstMatch(/w(?:eb)?osbrowser\\/(\\d+(\\.\\d+)?)/i)\n      };\n      /touchpad\\//i.test(ua) && (result.touchpad = t)\n    }\n    else if (/bada/i.test(ua)) {\n      result = {\n        name: 'Bada'\n      , osname: 'Bada'\n      , bada: t\n      , version: getFirstMatch(/dolfin\\/(\\d+(\\.\\d+)?)/i)\n      };\n    }\n    else if (tizen) {\n      result = {\n        name: 'Tizen'\n      , osname: 'Tizen'\n      , tizen: t\n      , version: getFirstMatch(/(?:tizen\\s?)?browser\\/(\\d+(\\.\\d+)?)/i) || versionIdentifier\n      };\n    }\n    else if (/qupzilla/i.test(ua)) {\n      result = {\n        name: 'QupZilla'\n        , qupzilla: t\n        , version: getFirstMatch(/(?:qupzilla)[\\s\\/](\\d+(?:\\.\\d+)+)/i) || versionIdentifier\n      }\n    }\n    else if (/chromium/i.test(ua)) {\n      result = {\n        name: 'Chromium'\n        , chromium: t\n        , version: getFirstMatch(/(?:chromium)[\\s\\/](\\d+(?:\\.\\d+)?)/i) || versionIdentifier\n      }\n    }\n    else if (/chrome|crios|crmo/i.test(ua)) {\n      result = {\n        name: 'Chrome'\n        , chrome: t\n        , version: getFirstMatch(/(?:chrome|crios|crmo)\\/(\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (android) {\n      result = {\n        name: 'Android'\n        , version: versionIdentifier\n      }\n    }\n    else if (/safari|applewebkit/i.test(ua)) {\n      result = {\n        name: 'Safari'\n      , safari: t\n      }\n      if (versionIdentifier) {\n        result.version = versionIdentifier\n      }\n    }\n    else if (iosdevice) {\n      result = {\n        name : iosdevice == 'iphone' ? 'iPhone' : iosdevice == 'ipad' ? 'iPad' : 'iPod'\n      }\n      // WTF: version is not part of user agent in web apps\n      if (versionIdentifier) {\n        result.version = versionIdentifier\n      }\n    }\n    else if(/googlebot/i.test(ua)) {\n      result = {\n        name: 'Googlebot'\n      , googlebot: t\n      , version: getFirstMatch(/googlebot\\/(\\d+(\\.\\d+))/i) || versionIdentifier\n      }\n    }\n    else {\n      result = {\n        name: getFirstMatch(/^(.*)\\/(.*) /),\n        version: getSecondMatch(/^(.*)\\/(.*) /)\n     };\n   }\n\n    // set webkit or gecko flag for browsers based on these engines\n    if (!result.msedge && /(apple)?webkit/i.test(ua)) {\n      if (/(apple)?webkit\\/537\\.36/i.test(ua)) {\n        result.name = result.name || \"Blink\"\n        result.blink = t\n      } else {\n        result.name = result.name || \"Webkit\"\n        result.webkit = t\n      }\n      if (!result.version && versionIdentifier) {\n        result.version = versionIdentifier\n      }\n    } else if (!result.opera && /gecko\\//i.test(ua)) {\n      result.name = result.name || \"Gecko\"\n      result.gecko = t\n      result.version = result.version || getFirstMatch(/gecko\\/(\\d+(\\.\\d+)?)/i)\n    }\n\n    // set OS flags for platforms that have multiple browsers\n    if (!result.windowsphone && (android || result.silk)) {\n      result.android = t\n      result.osname = 'Android'\n    } else if (!result.windowsphone && iosdevice) {\n      result[iosdevice] = t\n      result.ios = t\n      result.osname = 'iOS'\n    } else if (mac) {\n      result.mac = t\n      result.osname = 'macOS'\n    } else if (xbox) {\n      result.xbox = t\n      result.osname = 'Xbox'\n    } else if (windows) {\n      result.windows = t\n      result.osname = 'Windows'\n    } else if (linux) {\n      result.linux = t\n      result.osname = 'Linux'\n    }\n\n    function getWindowsVersion (s) {\n      switch (s) {\n        case 'NT': return 'NT'\n        case 'XP': return 'XP'\n        case 'NT 5.0': return '2000'\n        case 'NT 5.1': return 'XP'\n        case 'NT 5.2': return '2003'\n        case 'NT 6.0': return 'Vista'\n        case 'NT 6.1': return '7'\n        case 'NT 6.2': return '8'\n        case 'NT 6.3': return '8.1'\n        case 'NT 10.0': return '10'\n        default: return undefined\n      }\n    }\n\n    // OS version extraction\n    var osVersion = '';\n    if (result.windows) {\n      osVersion = getWindowsVersion(getFirstMatch(/Windows ((NT|XP)( \\d\\d?.\\d)?)/i))\n    } else if (result.windowsphone) {\n      osVersion = getFirstMatch(/windows phone (?:os)?\\s?(\\d+(\\.\\d+)*)/i);\n    } else if (result.mac) {\n      osVersion = getFirstMatch(/Mac OS X (\\d+([_\\.\\s]\\d+)*)/i);\n      osVersion = osVersion.replace(/[_\\s]/g, '.');\n    } else if (iosdevice) {\n      osVersion = getFirstMatch(/os (\\d+([_\\s]\\d+)*) like mac os x/i);\n      osVersion = osVersion.replace(/[_\\s]/g, '.');\n    } else if (android) {\n      osVersion = getFirstMatch(/android[ \\/-](\\d+(\\.\\d+)*)/i);\n    } else if (result.webos) {\n      osVersion = getFirstMatch(/(?:web|hpw)os\\/(\\d+(\\.\\d+)*)/i);\n    } else if (result.blackberry) {\n      osVersion = getFirstMatch(/rim\\stablet\\sos\\s(\\d+(\\.\\d+)*)/i);\n    } else if (result.bada) {\n      osVersion = getFirstMatch(/bada\\/(\\d+(\\.\\d+)*)/i);\n    } else if (result.tizen) {\n      osVersion = getFirstMatch(/tizen[\\/\\s](\\d+(\\.\\d+)*)/i);\n    }\n    if (osVersion) {\n      result.osversion = osVersion;\n    }\n\n    // device type extraction\n    var osMajorVersion = !result.windows && osVersion.split('.')[0];\n    if (\n         tablet\n      || nexusTablet\n      || iosdevice == 'ipad'\n      || (android && (osMajorVersion == 3 || (osMajorVersion >= 4 && !mobile)))\n      || result.silk\n    ) {\n      result.tablet = t\n    } else if (\n         mobile\n      || iosdevice == 'iphone'\n      || iosdevice == 'ipod'\n      || android\n      || nexusMobile\n      || result.blackberry\n      || result.webos\n      || result.bada\n    ) {\n      result.mobile = t\n    }\n\n    // Graded Browser Support\n    // http://developer.yahoo.com/yui/articles/gbs\n    if (result.msedge ||\n        (result.msie && result.version >= 10) ||\n        (result.yandexbrowser && result.version >= 15) ||\n\t\t    (result.vivaldi && result.version >= 1.0) ||\n        (result.chrome && result.version >= 20) ||\n        (result.samsungBrowser && result.version >= 4) ||\n        (result.firefox && result.version >= 20.0) ||\n        (result.safari && result.version >= 6) ||\n        (result.opera && result.version >= 10.0) ||\n        (result.ios && result.osversion && result.osversion.split(\".\")[0] >= 6) ||\n        (result.blackberry && result.version >= 10.1)\n        || (result.chromium && result.version >= 20)\n        ) {\n      result.a = t;\n    }\n    else if ((result.msie && result.version < 10) ||\n        (result.chrome && result.version < 20) ||\n        (result.firefox && result.version < 20.0) ||\n        (result.safari && result.version < 6) ||\n        (result.opera && result.version < 10.0) ||\n        (result.ios && result.osversion && result.osversion.split(\".\")[0] < 6)\n        || (result.chromium && result.version < 20)\n        ) {\n      result.c = t\n    } else result.x = t\n\n    return result\n  }\n\n  var bowser = detect(typeof navigator !== 'undefined' ? navigator.userAgent || '' : '')\n\n  bowser.test = function (browserList) {\n    for (var i = 0; i < browserList.length; ++i) {\n      var browserItem = browserList[i];\n      if (typeof browserItem=== 'string') {\n        if (browserItem in bowser) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Get version precisions count\n   *\n   * @example\n   *   getVersionPrecision(\"1.10.3\") // 3\n   *\n   * @param  {string} version\n   * @return {number}\n   */\n  function getVersionPrecision(version) {\n    return version.split(\".\").length;\n  }\n\n  /**\n   * Array::map polyfill\n   *\n   * @param  {Array} arr\n   * @param  {Function} iterator\n   * @return {Array}\n   */\n  function map(arr, iterator) {\n    var result = [], i;\n    if (Array.prototype.map) {\n      return Array.prototype.map.call(arr, iterator);\n    }\n    for (i = 0; i < arr.length; i++) {\n      result.push(iterator(arr[i]));\n    }\n    return result;\n  }\n\n  /**\n   * Calculate browser version weight\n   *\n   * @example\n   *   compareVersions(['1.10.2.1',  '1.8.2.1.90'])    // 1\n   *   compareVersions(['1.010.2.1', '1.09.2.1.90']);  // 1\n   *   compareVersions(['1.10.2.1',  '1.10.2.1']);     // 0\n   *   compareVersions(['1.10.2.1',  '1.0800.2']);     // -1\n   *\n   * @param  {Array<String>} versions versions to compare\n   * @return {Number} comparison result\n   */\n  function compareVersions(versions) {\n    // 1) get common precision for both versions, for example for \"10.0\" and \"9\" it should be 2\n    var precision = Math.max(getVersionPrecision(versions[0]), getVersionPrecision(versions[1]));\n    var chunks = map(versions, function (version) {\n      var delta = precision - getVersionPrecision(version);\n\n      // 2) \"9\" -> \"9.0\" (for precision = 2)\n      version = version + new Array(delta + 1).join(\".0\");\n\n      // 3) \"9.0\" -> [\"000000000\"\", \"000000009\"]\n      return map(version.split(\".\"), function (chunk) {\n        return new Array(20 - chunk.length).join(\"0\") + chunk;\n      }).reverse();\n    });\n\n    // iterate in reverse order by reversed chunks array\n    while (--precision >= 0) {\n      // 4) compare: \"000000009\" > \"000000010\" = false (but \"9\" > \"10\" = true)\n      if (chunks[0][precision] > chunks[1][precision]) {\n        return 1;\n      }\n      else if (chunks[0][precision] === chunks[1][precision]) {\n        if (precision === 0) {\n          // all version chunks are same\n          return 0;\n        }\n      }\n      else {\n        return -1;\n      }\n    }\n  }\n\n  /**\n   * Check if browser is unsupported\n   *\n   * @example\n   *   bowser.isUnsupportedBrowser({\n   *     msie: \"10\",\n   *     firefox: \"23\",\n   *     chrome: \"29\",\n   *     safari: \"5.1\",\n   *     opera: \"16\",\n   *     phantom: \"534\"\n   *   });\n   *\n   * @param  {Object}  minVersions map of minimal version to browser\n   * @param  {Boolean} [strictMode = false] flag to return false if browser wasn't found in map\n   * @param  {String}  [ua] user agent string\n   * @return {Boolean}\n   */\n  function isUnsupportedBrowser(minVersions, strictMode, ua) {\n    var _bowser = bowser;\n\n    // make strictMode param optional with ua param usage\n    if (typeof strictMode === 'string') {\n      ua = strictMode;\n      strictMode = void(0);\n    }\n\n    if (strictMode === void(0)) {\n      strictMode = false;\n    }\n    if (ua) {\n      _bowser = detect(ua);\n    }\n\n    var version = \"\" + _bowser.version;\n    for (var browser in minVersions) {\n      if (minVersions.hasOwnProperty(browser)) {\n        if (_bowser[browser]) {\n          if (typeof minVersions[browser] !== 'string') {\n            throw new Error('Browser version in the minVersion map should be a string: ' + browser + ': ' + String(minVersions));\n          }\n\n          // browser version and min supported version.\n          return compareVersions([version, minVersions[browser]]) < 0;\n        }\n      }\n    }\n\n    return strictMode; // not found\n  }\n\n  /**\n   * Check if browser is supported\n   *\n   * @param  {Object} minVersions map of minimal version to browser\n   * @param  {Boolean} [strictMode = false] flag to return false if browser wasn't found in map\n   * @param  {String}  [ua] user agent string\n   * @return {Boolean}\n   */\n  function check(minVersions, strictMode, ua) {\n    return !isUnsupportedBrowser(minVersions, strictMode, ua);\n  }\n\n  bowser.isUnsupportedBrowser = isUnsupportedBrowser;\n  bowser.compareVersions = compareVersions;\n  bowser.check = check;\n\n  /*\n   * Set our detect method to the main bowser object so we can\n   * reuse it to test other user agents.\n   * This is needed to implement future tests.\n   */\n  bowser._detect = detect;\n\n  /*\n   * Set our detect public method to the main bowser object\n   * This is needed to implement bowser in server side\n   */\n  bowser.detect = detect;\n  return bowser\n});\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/bowser/src/bowser.js","module.exports = function() {\r\n\tthrow new Error(\"define cannot be used indirect\");\r\n};\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/amd-define.js\n// module id = 70\n// module chunks = 0","module.exports = {\"safari\":[{\"version\":\"10.2\"},{\"capabilities\":{\"audioIn\":true,\"audioOut\":true,\"videoIn\":false,\"videoOut\":false,\"screenSharing\":false},\"iframeCapabilities\":{\"isSupported\":false}}],\"chrome\":[{\"version\":\"34\"},{\"capabilities\":{\"audioIn\":true,\"audioOut\":true,\"videoIn\":true,\"videoOut\":true,\"screenSharing\":true}}],\"opera\":[{\"version\":\"22\"},{\"capabilities\":{\"audioIn\":true,\"audioOut\":true,\"videoIn\":true,\"videoOut\":true,\"screenSharing\":false}}],\"firefox\":[{\"version\":\"52.4\"},{\"capabilities\":{\"audioIn\":true,\"audioOut\":true,\"videoIn\":true,\"videoOut\":true,\"screenSharing\":true}}],\"edge\":[{\"capabilities\":{\"audioIn\":true,\"audioOut\":true,\"videoIn\":true,\"videoOut\":true,\"screenSharing\":false}}],\"nwjs\":[{\"capabilities\":{\"audioIn\":true,\"audioOut\":true,\"videoIn\":true,\"videoOut\":true,\"screenSharing\":true}}],\"electron\":[{\"capabilities\":{\"audioIn\":true,\"audioOut\":true,\"videoIn\":true,\"videoOut\":true,\"screenSharing\":true}}],\"react-native\":[{\"capabilities\":{\"audioIn\":true,\"audioOut\":true,\"videoIn\":true,\"videoOut\":true,\"screenSharing\":false}}]}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./modules/browser/capabilities.json\n// module id = 71\n// module chunks = 0","import {\r\n    TYPE_OPERATIONAL,\r\n    TYPE_PAGE,\r\n    TYPE_TRACK,\r\n    TYPE_UI\r\n} from '../../service/statistics/AnalyticsEvents';\r\nimport { getLogger } from 'jitsi-meet-logger';\r\nimport browser from '../browser';\r\nimport Settings from '../settings/Settings';\r\n\r\nconst MAX_CACHE_SIZE = 100;\r\n\r\n// eslist-disable-line no-undef\r\nconst logger = getLogger(__filename);\r\n\r\n/**\r\n * This class provides an API to lib-jitsi-meet and its users for sending\r\n * analytics events. It serves as a bridge to different backend implementations\r\n * (\"analytics handlers\") and a cache for events attempted to be sent before\r\n * the analytics handlers were enabled.\r\n *\r\n * The API is designed to be an easy replacement for the previous version of\r\n * this adapter, and is meant to be extended with more convenience methods.\r\n *\r\n *\r\n * The API calls are translated to objects with the following structure, which\r\n * are then passed to the sendEvent(event) function of the underlying handlers:\r\n *\r\n * {\r\n *    type,\r\n *\r\n *    action,\r\n *    actionSubject,\r\n *    actionSubjectId,\r\n *    attributes,\r\n *    categories,\r\n *    containerId,\r\n *    containerType,\r\n *    name,\r\n *    objectId,\r\n *    objectType,\r\n *    source,\r\n *    tags\r\n * }\r\n *\r\n * The 'type' is one of 'operational', 'page', 'track' or 'ui', and some of the\r\n * other properties are considered required according to the type.\r\n *\r\n * For events with type 'page', the required properties are: name.\r\n *\r\n * For events with type 'operational' and 'ui', the required properties are:\r\n * action, actionSubject, source\r\n *\r\n * For events with type 'page', the required properties are:\r\n * action, actionSubject, source, containerType, containerId, objectType,\r\n * objectId\r\n */\r\nclass AnalyticsAdapter {\r\n    /**\r\n     * Creates new AnalyticsAdapter instance.\r\n     */\r\n    constructor() {\r\n        /**\r\n         * Whether this AnalyticsAdapter has been disposed of or not. Once this\r\n         * is set to true, the AnalyticsAdapter is disabled and does not accept\r\n         * any more events, and it can not be re-enabled.\r\n         * @type {boolean}\r\n         */\r\n        this.disposed = false;\r\n\r\n        /**\r\n         * The set of handlers to which events will be sent.\r\n         * @type {Set<any>}\r\n         */\r\n        this.analyticsHandlers = new Set();\r\n\r\n        /**\r\n         * The cache of events which are not sent yet. The cache is enabled\r\n         * while this field is truthy, and disabled otherwise.\r\n         * @type {Array}\r\n         */\r\n        this.cache = [];\r\n\r\n        /**\r\n         * Map of properties that will be added to every event. Note that the\r\n         * keys will be prefixed with \"permanent.\".\r\n         */\r\n        this.permanentProperties = {};\r\n\r\n        /**\r\n         * The name of the conference that this AnalyticsAdapter is associated\r\n         * with.\r\n         * @type {null}\r\n         */\r\n        this.conferenceName = '';\r\n\r\n        this.addPermanentProperties({\r\n            'callstats_name': Settings.callStatsUserName,\r\n            'user_agent': navigator.userAgent,\r\n            'browser_name': browser.getName()\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Dispose analytics. Clears all handlers.\r\n     */\r\n    dispose() {\r\n        this.setAnalyticsHandlers([]);\r\n        this.disposed = true;\r\n    }\r\n\r\n    /**\r\n     * Sets the handlers that are going to be used to send analytics. Sends any\r\n     * cached events.\r\n     * @param {Array} handlers the handlers\r\n     */\r\n    setAnalyticsHandlers(handlers) {\r\n        if (this.disposed) {\r\n            return;\r\n        }\r\n\r\n        this.analyticsHandlers = new Set(handlers);\r\n\r\n        // Note that we disable the cache even if the set of handlers is empty.\r\n        const cache = this.cache;\r\n\r\n        this.cache = null;\r\n        if (cache) {\r\n            cache.forEach(event => this._sendEvent(event));\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Adds a set of permanent properties to this this AnalyticsAdapter.\r\n     * Permanent properties will be added as \"attributes\" to events sent to\r\n     * the underlying \"analytics handlers\", and their keys will be prefixed\r\n     * by \"permanent_\", i.e. adding a permanent property {key: \"value\"} will\r\n     * result in {\"permanent_key\": \"value\"} object to be added to the\r\n     * \"attributes\" field of events.\r\n     *\r\n     * @param {Object} properties the properties to add\r\n     */\r\n    addPermanentProperties(properties) {\r\n        for (const property in properties) {\r\n            if (properties.hasOwnProperty(property)) {\r\n                this.permanentProperties[`permanent_${property}`]\r\n                    = properties[property];\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Sets the name of the conference that this AnalyticsAdapter is associated\r\n     * with.\r\n     * @param name the name to set.\r\n     */\r\n    setConferenceName(name) {\r\n        this.conferenceName = name;\r\n        this.addPermanentProperties({ 'conference_name': name });\r\n    }\r\n\r\n    /**\r\n     * Sends an event with a given name and given properties. The first\r\n     * parameter is either a string or an object. If it is a string, it is used\r\n     * as the event name and the second parameter is used at the attributes to\r\n     * attach to the event. If it is an object, it represents the whole event,\r\n     * including any desired attributes, and the second parameter is ignored.\r\n     *\r\n     * @param {String|Object} eventName either a string to be used as the name\r\n     * of the event, or an event object. If an event object is passed, the\r\n     * properties parameters is ignored.\r\n     * @param {Object} properties the properties/attributes to attach to the\r\n     * event, if eventName is a string.\r\n     */\r\n    sendEvent(eventName, properties = {}) {\r\n        let event = null;\r\n\r\n        if (typeof eventName === 'string') {\r\n            event = {\r\n                type: TYPE_OPERATIONAL,\r\n                action: eventName,\r\n                actionSubject: eventName,\r\n                source: eventName,\r\n                attributes: properties\r\n            };\r\n        } else if (typeof eventName === 'object') {\r\n            event = eventName;\r\n        }\r\n\r\n        if (!this._verifyRequiredFields(event)) {\r\n            logger.error(\r\n                `Dropping a mis-formatted event: ${JSON.stringify(event)}`);\r\n\r\n            return;\r\n        }\r\n\r\n        this._sendEvent(event);\r\n    }\r\n\r\n    /**\r\n     * Checks whether an event has all of the required fields set, and tries\r\n     * to fill in some of the missing fields with reasonable default values.\r\n     * Returns true if after this operation the event has all of the required\r\n     * fields set, and false otherwise (if some of the required fields were not\r\n     * set and the attempt to fill them in with a default failed).\r\n     *\r\n     * @param event the event object.\r\n     * @return {boolean} true if the event (after the call to this function)\r\n     * contains all of the required fields, and false otherwise.\r\n     * @private\r\n     */\r\n    _verifyRequiredFields(event) {\r\n        if (!event) {\r\n            return false;\r\n        }\r\n\r\n        if (!event.type) {\r\n            event.type = TYPE_OPERATIONAL;\r\n        }\r\n\r\n        const type = event.type;\r\n\r\n        if (type !== TYPE_OPERATIONAL && type !== TYPE_PAGE\r\n            && type !== TYPE_UI && type !== TYPE_TRACK) {\r\n            logger.error(`Unknown event type: ${type}`);\r\n\r\n            return false;\r\n        }\r\n\r\n        if (type === TYPE_PAGE) {\r\n            return Boolean(event.name);\r\n        }\r\n\r\n        // Try to set some reasonable default values in case some of the\r\n        // parameters required by the handler API are missing.\r\n        event.action = event.action || event.name || event.actionSubject;\r\n        event.actionSubject = event.actionSubject || event.name || event.action;\r\n        event.source = event.source || event.name || event.action\r\n            || event.actionSubject;\r\n\r\n        if (!event.action || !event.actionSubject || !event.source) {\r\n            logger.error(\r\n                'Required field missing (action, actionSubject or source)');\r\n\r\n            return false;\r\n        }\r\n\r\n        // Track events have additional required fields.\r\n        if (type === TYPE_TRACK) {\r\n            event.objectType = event.objectType || 'generic-object-type';\r\n            event.containerType = event.containerType || 'conference';\r\n            if (event.containerType === 'conference' && !event.containerId) {\r\n                event.containerId = this.conferenceName;\r\n            }\r\n\r\n\r\n            if (!event.objectType || !event.objectId\r\n                || !event.containerType || !event.containerId) {\r\n                logger.error(\r\n                    'Required field missing (containerId, containerType, '\r\n                        + 'objectId or objectType)');\r\n\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Saves an event to the cache, if the cache is enabled.\r\n     * @param event the event to save.\r\n     * @returns {boolean} true if the event was saved, and false otherwise (i.e.\r\n     * if the cache was disabled).\r\n     * @private\r\n     */\r\n    _maybeCacheEvent(event) {\r\n        if (this.cache) {\r\n            this.cache.push(event);\r\n\r\n            // We limit the size of the cache, in case the user fails to ever\r\n            // set the analytics handlers.\r\n            if (this.cache.length > MAX_CACHE_SIZE) {\r\n                this.cache.splice(0, 1);\r\n            }\r\n\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param event\r\n     * @private\r\n     */\r\n    _sendEvent(event) {\r\n        if (this._maybeCacheEvent(event)) {\r\n            // The event was consumed by the cache.\r\n        } else {\r\n            // We append the permanent properties at the time we send the event,\r\n            // not at the time we receive it.\r\n            this._appendPermanentProperties(event);\r\n\r\n            for (const handler of this.analyticsHandlers) {\r\n                try {\r\n                    handler.sendEvent(event);\r\n                } catch (e) {\r\n                    logger.warn(`Error sending analytics event: ${e}`);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Extends an event object with the configured permanent properties.\r\n     * @param event the event to extend with permanent properties.\r\n     * @private\r\n     */\r\n    _appendPermanentProperties(event) {\r\n        if (!event.attributes) {\r\n            event.attributes = {};\r\n        }\r\n\r\n        event.attributes\r\n            = Object.assign(event.attributes, this.permanentProperties);\r\n    }\r\n\r\n}\r\n\r\nexport default new AnalyticsAdapter();\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/statistics/AnalyticsAdapter.js","const RandomUtil = require('./RandomUtil');\r\n\r\n/**\r\n * from faker.js - Copyright (c) 2014-2015 Matthew Bergman & Marak Squires\r\n * MIT License\r\n * http://github.com/marak/faker.js/\r\n *\r\n * @const\r\n */\r\nconst names = [\r\n    'Aaliyah', 'Aaron', 'Abagail', 'Abbey', 'Abbie', 'Abbigail', 'Abby',\r\n    'Abdiel', 'Abdul', 'Abdullah', 'Abe', 'Abel', 'Abelardo', 'Abigail',\r\n    'Abigale', 'Abigayle', 'Abner', 'Abraham', 'Ada', 'Adah', 'Adalberto',\r\n    'Adaline', 'Adam', 'Adan', 'Addie', 'Addison', 'Adela', 'Adelbert', 'Adele',\r\n    'Adelia', 'Adeline', 'Adell', 'Adella', 'Adelle', 'Aditya', 'Adolf',\r\n    'Adolfo', 'Adolph', 'Adolphus', 'Adonis', 'Adrain', 'Adrian', 'Adriana',\r\n    'Adrianna', 'Adriel', 'Adrien', 'Adrienne', 'Afton', 'Aglae', 'Agnes',\r\n    'Agustin', 'Agustina', 'Ahmad', 'Ahmed', 'Aida', 'Aidan', 'Aiden', 'Aileen',\r\n    'Aisha', 'Aiyana', 'Akeem', 'Al', 'Alaina', 'Alan', 'Alana', 'Alanis',\r\n    'Alanna', 'Alayna', 'Alba', 'Albert', 'Alberta', 'Albertha', 'Alberto',\r\n    'Albin', 'Albina', 'Alda', 'Alden', 'Alec', 'Aleen', 'Alejandra',\r\n    'Alejandrin', 'Alek', 'Alena', 'Alene', 'Alessandra', 'Alessandro',\r\n    'Alessia', 'Aletha', 'Alex', 'Alexa', 'Alexander', 'Alexandra', 'Alexandre',\r\n    'Alexandrea', 'Alexandria', 'Alexandrine', 'Alexandro', 'Alexane',\r\n    'Alexanne', 'Alexie', 'Alexis', 'Alexys', 'Alexzander', 'Alf', 'Alfonso',\r\n    'Alfonzo', 'Alford', 'Alfred', 'Alfreda', 'Alfredo', 'Ali', 'Alia', 'Alice',\r\n    'Alicia', 'Alisa', 'Alisha', 'Alison', 'Alivia', 'Aliya', 'Aliyah', 'Aliza',\r\n    'Alize', 'Allan', 'Allen', 'Allene', 'Allie', 'Allison', 'Ally', 'Alphonso',\r\n    'Alta', 'Althea', 'Alva', 'Alvah', 'Alvena', 'Alvera', 'Alverta', 'Alvina',\r\n    'Alvis', 'Alyce', 'Alycia', 'Alysa', 'Alysha', 'Alyson', 'Alysson',\r\n    'Amalia', 'Amanda', 'Amani', 'Amara', 'Amari', 'Amaya', 'Amber', 'Ambrose',\r\n    'Amelia', 'Amelie', 'Amely', 'America', 'Americo', 'Amie', 'Amina', 'Amir',\r\n    'Amira', 'Amiya', 'Amos', 'Amparo', 'Amy', 'Amya', 'Ana', 'Anabel',\r\n    'Anabelle', 'Anahi', 'Anais', 'Anastacio', 'Anastasia', 'Anderson', 'Andre',\r\n    'Andreane', 'Andreanne', 'Andres', 'Andrew', 'Andy', 'Angel', 'Angela',\r\n    'Angelica', 'Angelina', 'Angeline', 'Angelita', 'Angelo', 'Angie', 'Angus',\r\n    'Anibal', 'Anika', 'Anissa', 'Anita', 'Aniya', 'Aniyah', 'Anjali', 'Anna',\r\n    'Annabel', 'Annabell', 'Annabelle', 'Annalise', 'Annamae', 'Annamarie',\r\n    'Anne', 'Annetta', 'Annette', 'Annie', 'Ansel', 'Ansley', 'Anthony',\r\n    'Antoinette', 'Antone', 'Antonetta', 'Antonette', 'Antonia', 'Antonietta',\r\n    'Antonina', 'Antonio', 'Antwan', 'Antwon', 'Anya', 'April', 'Ara',\r\n    'Araceli', 'Aracely', 'Arch', 'Archibald', 'Ardella', 'Arden', 'Ardith',\r\n    'Arely', 'Ari', 'Ariane', 'Arianna', 'Aric', 'Ariel', 'Arielle', 'Arjun',\r\n    'Arlene', 'Arlie', 'Arlo', 'Armand', 'Armando', 'Armani', 'Arnaldo', 'Arne',\r\n    'Arno', 'Arnold', 'Arnoldo', 'Arnulfo', 'Aron', 'Art', 'Arthur', 'Arturo',\r\n    'Arvel', 'Arvid', 'Arvilla', 'Aryanna', 'Asa', 'Asha', 'Ashlee', 'Ashleigh',\r\n    'Ashley', 'Ashly', 'Ashlynn', 'Ashton', 'Ashtyn', 'Asia', 'Assunta',\r\n    'Astrid', 'Athena', 'Aubree', 'Aubrey', 'Audie', 'Audra', 'Audreanne',\r\n    'Audrey', 'August', 'Augusta', 'Augustine', 'Augustus', 'Aurelia',\r\n    'Aurelie', 'Aurelio', 'Aurore', 'Austen', 'Austin', 'Austyn', 'Autumn',\r\n    'Ava', 'Avery', 'Avis', 'Axel', 'Ayana', 'Ayden', 'Ayla', 'Aylin', 'Baby',\r\n    'Bailee', 'Bailey', 'Barbara', 'Barney', 'Baron', 'Barrett', 'Barry',\r\n    'Bart', 'Bartholome', 'Barton', 'Baylee', 'Beatrice', 'Beau', 'Beaulah',\r\n    'Bell', 'Bella', 'Belle', 'Ben', 'Benedict', 'Benjamin', 'Bennett',\r\n    'Bennie', 'Benny', 'Benton', 'Berenice', 'Bernadette', 'Bernadine',\r\n    'Bernard', 'Bernardo', 'Berneice', 'Bernhard', 'Bernice', 'Bernie',\r\n    'Berniece', 'Bernita', 'Berry', 'Bert', 'Berta', 'Bertha', 'Bertram',\r\n    'Bertrand', 'Beryl', 'Bessie', 'Beth', 'Bethany', 'Bethel', 'Betsy',\r\n    'Bette', 'Bettie', 'Betty', 'Bettye', 'Beulah', 'Beverly', 'Bianka', 'Bill',\r\n    'Billie', 'Billy', 'Birdie', 'Blair', 'Blaise', 'Blake', 'Blanca',\r\n    'Blanche', 'Blaze', 'Bo', 'Bobbie', 'Bobby', 'Bonita', 'Bonnie', 'Boris',\r\n    'Boyd', 'Brad', 'Braden', 'Bradford', 'Bradley', 'Bradly', 'Brady',\r\n    'Braeden', 'Brain', 'Brandi', 'Brando', 'Brandon', 'Brandt', 'Brandy',\r\n    'Brandyn', 'Brannon', 'Branson', 'Brant', 'Braulio', 'Braxton', 'Brayan',\r\n    'Breana', 'Breanna', 'Breanne', 'Brenda', 'Brendan', 'Brenden', 'Brendon',\r\n    'Brenna', 'Brennan', 'Brennon', 'Brent', 'Bret', 'Brett', 'Bria', 'Brian',\r\n    'Briana', 'Brianne', 'Brice', 'Bridget', 'Bridgette', 'Bridie', 'Brielle',\r\n    'Brigitte', 'Brionna', 'Brisa', 'Britney', 'Brittany', 'Brock', 'Broderick',\r\n    'Brody', 'Brook', 'Brooke', 'Brooklyn', 'Brooks', 'Brown', 'Bruce',\r\n    'Bryana', 'Bryce', 'Brycen', 'Bryon', 'Buck', 'Bud', 'Buddy', 'Buford',\r\n    'Bulah', 'Burdette', 'Burley', 'Burnice', 'Buster', 'Cade', 'Caden',\r\n    'Caesar', 'Caitlyn', 'Cale', 'Caleb', 'Caleigh', 'Cali', 'Calista',\r\n    'Callie', 'Camden', 'Cameron', 'Camila', 'Camilla', 'Camille', 'Camren',\r\n    'Camron', 'Camryn', 'Camylle', 'Candace', 'Candelario', 'Candice',\r\n    'Candida', 'Candido', 'Cara', 'Carey', 'Carissa', 'Carlee', 'Carleton',\r\n    'Carley', 'Carli', 'Carlie', 'Carlo', 'Carlos', 'Carlotta', 'Carmel',\r\n    'Carmela', 'Carmella', 'Carmelo', 'Carmen', 'Carmine', 'Carol', 'Carolanne',\r\n    'Carole', 'Carolina', 'Caroline', 'Carolyn', 'Carolyne', 'Carrie',\r\n    'Carroll', 'Carson', 'Carter', 'Cary', 'Casandra', 'Casey', 'Casimer',\r\n    'Casimir', 'Casper', 'Cassandra', 'Cassandre', 'Cassidy', 'Cassie',\r\n    'Catalina', 'Caterina', 'Catharine', 'Catherine', 'Cathrine', 'Cathryn',\r\n    'Cathy', 'Cayla', 'Ceasar', 'Cecelia', 'Cecil', 'Cecile', 'Cecilia',\r\n    'Cedrick', 'Celestine', 'Celestino', 'Celia', 'Celine', 'Cesar', 'Chad',\r\n    'Chadd', 'Chadrick', 'Chaim', 'Chance', 'Chandler', 'Chanel', 'Chanelle',\r\n    'Charity', 'Charlene', 'Charles', 'Charley', 'Charlie', 'Charlotte',\r\n    'Chase', 'Chasity', 'Chauncey', 'Chaya', 'Chaz', 'Chelsea', 'Chelsey',\r\n    'Chelsie', 'Chesley', 'Chester', 'Chet', 'Cheyanne', 'Cheyenne', 'Chloe',\r\n    'Chris', 'Christ', 'Christa', 'Christelle', 'Christian', 'Christiana',\r\n    'Christina', 'Christine', 'Christop', 'Christophe', 'Christopher',\r\n    'Christy', 'Chyna', 'Ciara', 'Cicero', 'Cielo', 'Cierra', 'Cindy',\r\n    'Citlalli', 'Clair', 'Claire', 'Clara', 'Clarabelle', 'Clare', 'Clarissa',\r\n    'Clark', 'Claud', 'Claude', 'Claudia', 'Claudie', 'Claudine', 'Clay',\r\n    'Clemens', 'Clement', 'Clementina', 'Clementine', 'Clemmie', 'Cleo',\r\n    'Cleora', 'Cleta', 'Cletus', 'Cleve', 'Cleveland', 'Clifford', 'Clifton',\r\n    'Clint', 'Clinton', 'Clotilde', 'Clovis', 'Cloyd', 'Clyde', 'Coby', 'Cody',\r\n    'Colby', 'Cole', 'Coleman', 'Colin', 'Colleen', 'Collin', 'Colt', 'Colten',\r\n    'Colton', 'Columbus', 'Concepcion', 'Conner', 'Connie', 'Connor', 'Conor',\r\n    'Conrad', 'Constance', 'Constantin', 'Consuelo', 'Cooper', 'Cora',\r\n    'Coralie', 'Corbin', 'Cordelia', 'Cordell', 'Cordia', 'Cordie', 'Corene',\r\n    'Corine', 'Cornelius', 'Cornell', 'Corrine', 'Cortez', 'Cortney', 'Cory',\r\n    'Coty', 'Courtney', 'Coy', 'Craig', 'Crawford', 'Creola', 'Cristal',\r\n    'Cristian', 'Cristina', 'Cristobal', 'Cristopher', 'Cruz', 'Crystal',\r\n    'Crystel', 'Cullen', 'Curt', 'Curtis', 'Cydney', 'Cynthia', 'Cyril',\r\n    'Cyrus', 'Dagmar', 'Dahlia', 'Daija', 'Daisha', 'Daisy', 'Dakota', 'Dale',\r\n    'Dallas', 'Dallin', 'Dalton', 'Damaris', 'Dameon', 'Damian', 'Damien',\r\n    'Damion', 'Damon', 'Dan', 'Dana', 'Dandre', 'Dane', 'D\\'angelo', 'Dangelo',\r\n    'Danial', 'Daniela', 'Daniella', 'Danielle', 'Danika', 'Dannie', 'Danny',\r\n    'Dante', 'Danyka', 'Daphne', 'Daphnee', 'Daphney', 'Darby', 'Daren',\r\n    'Darian', 'Dariana', 'Darien', 'Dario', 'Darion', 'Darius', 'Darlene',\r\n    'Daron', 'Darrel', 'Darrell', 'Darren', 'Darrick', 'Darrin', 'Darrion',\r\n    'Darron', 'Darryl', 'Darwin', 'Daryl', 'Dashawn', 'Dasia', 'Dave', 'David',\r\n    'Davin', 'Davion', 'Davon', 'Davonte', 'Dawn', 'Dawson', 'Dax', 'Dayana',\r\n    'Dayna', 'Dayne', 'Dayton', 'Dean', 'Deangelo', 'Deanna', 'Deborah',\r\n    'Declan', 'Dedric', 'Dedrick', 'Dee', 'Deion', 'Deja', 'Dejah', 'Dejon',\r\n    'Dejuan', 'Delaney', 'Delbert', 'Delfina', 'Delia', 'Delilah', 'Dell',\r\n    'Della', 'Delmer', 'Delores', 'Delpha', 'Delphia', 'Delphine', 'Delta',\r\n    'Demarco', 'Demarcus', 'Demario', 'Demetris', 'Demetrius', 'Demond', 'Dena',\r\n    'Denis', 'Dennis', 'Deon', 'Deondre', 'Deontae', 'Deonte', 'Dereck',\r\n    'Derek', 'Derick', 'Deron', 'Derrick', 'Deshaun', 'Deshawn', 'Desiree',\r\n    'Desmond', 'Dessie', 'Destany', 'Destin', 'Destinee', 'Destiney', 'Destini',\r\n    'Destiny', 'Devan', 'Devante', 'Deven', 'Devin', 'Devon', 'Devonte',\r\n    'Devyn', 'Dewayne', 'Dewitt', 'Dexter', 'Diamond', 'Diana', 'Dianna',\r\n    'Diego', 'Dillan', 'Dillon', 'Dimitri', 'Dina', 'Dino', 'Dion', 'Dixie',\r\n    'Dock', 'Dolly', 'Dolores', 'Domenic', 'Domenica', 'Domenick', 'Domenico',\r\n    'Domingo', 'Dominic', 'Dominique', 'Don', 'Donald', 'Donato', 'Donavon',\r\n    'Donna', 'Donnell', 'Donnie', 'Donny', 'Dora', 'Dorcas', 'Dorian', 'Doris',\r\n    'Dorothea', 'Dorothy', 'Dorris', 'Dortha', 'Dorthy', 'Doug', 'Douglas',\r\n    'Dovie', 'Doyle', 'Drake', 'Drew', 'Duane', 'Dudley', 'Dulce', 'Duncan',\r\n    'Durward', 'Dustin', 'Dusty', 'Dwight', 'Dylan', 'Earl', 'Earlene',\r\n    'Earline', 'Earnest', 'Earnestine', 'Easter', 'Easton', 'Ebba', 'Ebony',\r\n    'Ed', 'Eda', 'Edd', 'Eddie', 'Eden', 'Edgar', 'Edgardo', 'Edison', 'Edmond',\r\n    'Edmund', 'Edna', 'Eduardo', 'Edward', 'Edwardo', 'Edwin', 'Edwina',\r\n    'Edyth', 'Edythe', 'Effie', 'Efrain', 'Efren', 'Eileen', 'Einar', 'Eino',\r\n    'Eladio', 'Elaina', 'Elbert', 'Elda', 'Eldon', 'Eldora', 'Eldred',\r\n    'Eldridge', 'Eleanora', 'Eleanore', 'Eleazar', 'Electa', 'Elena', 'Elenor',\r\n    'Elenora', 'Eleonore', 'Elfrieda', 'Eli', 'Elian', 'Eliane', 'Elias',\r\n    'Eliezer', 'Elijah', 'Elinor', 'Elinore', 'Elisa', 'Elisabeth', 'Elise',\r\n    'Eliseo', 'Elisha', 'Elissa', 'Eliza', 'Elizabeth', 'Ella', 'Ellen',\r\n    'Ellie', 'Elliot', 'Elliott', 'Ellis', 'Ellsworth', 'Elmer', 'Elmira',\r\n    'Elmo', 'Elmore', 'Elna', 'Elnora', 'Elody', 'Eloisa', 'Eloise', 'Elouise',\r\n    'Eloy', 'Elroy', 'Elsa', 'Else', 'Elsie', 'Elta', 'Elton', 'Elva', 'Elvera',\r\n    'Elvie', 'Elvis', 'Elwin', 'Elwyn', 'Elyse', 'Elyssa', 'Elza', 'Emanuel',\r\n    'Emelia', 'Emelie', 'Emely', 'Emerald', 'Emerson', 'Emery', 'Emie', 'Emil',\r\n    'Emile', 'Emilia', 'Emiliano', 'Emilie', 'Emilio', 'Emily', 'Emma',\r\n    'Emmalee', 'Emmanuel', 'Emmanuelle', 'Emmet', 'Emmett', 'Emmie', 'Emmitt',\r\n    'Emmy', 'Emory', 'Ena', 'Enid', 'Enoch', 'Enola', 'Enos', 'Enrico',\r\n    'Enrique', 'Ephraim', 'Era', 'Eriberto', 'Eric', 'Erica', 'Erich', 'Erick',\r\n    'Ericka', 'Erik', 'Erika', 'Erin', 'Erling', 'Erna', 'Ernest', 'Ernestina',\r\n    'Ernestine', 'Ernesto', 'Ernie', 'Ervin', 'Erwin', 'Eryn', 'Esmeralda',\r\n    'Esperanza', 'Esta', 'Esteban', 'Estefania', 'Estel', 'Estell', 'Estella',\r\n    'Estelle', 'Estevan', 'Esther', 'Estrella', 'Etha', 'Ethan', 'Ethel',\r\n    'Ethelyn', 'Ethyl', 'Ettie', 'Eudora', 'Eugene', 'Eugenia', 'Eula', 'Eulah',\r\n    'Eulalia', 'Euna', 'Eunice', 'Eusebio', 'Eva', 'Evalyn', 'Evan',\r\n    'Evangeline', 'Evans', 'Eve', 'Eveline', 'Evelyn', 'Everardo', 'Everett',\r\n    'Everette', 'Evert', 'Evie', 'Ewald', 'Ewell', 'Ezekiel', 'Ezequiel',\r\n    'Ezra', 'Fabian', 'Fabiola', 'Fae', 'Fannie', 'Fanny', 'Fatima', 'Faustino',\r\n    'Fausto', 'Favian', 'Fay', 'Faye', 'Federico', 'Felicia', 'Felicita',\r\n    'Felicity', 'Felipa', 'Felipe', 'Felix', 'Felton', 'Fermin', 'Fern',\r\n    'Fernando', 'Ferne', 'Fidel', 'Filiberto', 'Filomena', 'Finn', 'Fiona',\r\n    'Flavie', 'Flavio', 'Fleta', 'Fletcher', 'Flo', 'Florence', 'Florencio',\r\n    'Florian', 'Florida', 'Florine', 'Flossie', 'Floy', 'Floyd', 'Ford',\r\n    'Forest', 'Forrest', 'Foster', 'Frances', 'Francesca', 'Francesco',\r\n    'Francis', 'Francisca', 'Francisco', 'Franco', 'Frank', 'Frankie', 'Franz',\r\n    'Fred', 'Freda', 'Freddie', 'Freddy', 'Frederic', 'Frederick', 'Frederik',\r\n    'Frederique', 'Fredrick', 'Fredy', 'Freeda', 'Freeman', 'Freida', 'Frida',\r\n    'Frieda', 'Friedrich', 'Fritz', 'Furman', 'Gabe', 'Gabriel', 'Gabriella',\r\n    'Gabrielle', 'Gaetano', 'Gage', 'Gail', 'Gardner', 'Garett', 'Garfield',\r\n    'Garland', 'Garnet', 'Garnett', 'Garret', 'Garrett', 'Garrick', 'Garrison',\r\n    'Garry', 'Garth', 'Gaston', 'Gavin', 'Gay', 'Gayle', 'Gaylord', 'Gene',\r\n    'General', 'Genesis', 'Genevieve', 'Gennaro', 'Genoveva', 'Geo', 'Geoffrey',\r\n    'George', 'Georgette', 'Georgiana', 'Georgianna', 'Geovanni', 'Geovanny',\r\n    'Geovany', 'Gerald', 'Geraldine', 'Gerard', 'Gerardo', 'Gerda', 'Gerhard',\r\n    'Germaine', 'German', 'Gerry', 'Gerson', 'Gertrude', 'Gia', 'Gianni',\r\n    'Gideon', 'Gilbert', 'Gilberto', 'Gilda', 'Giles', 'Gillian', 'Gina',\r\n    'Gino', 'Giovani', 'Giovanna', 'Giovanni', 'Giovanny', 'Gisselle',\r\n    'Giuseppe', 'Gladyce', 'Gladys', 'Glen', 'Glenda', 'Glenna', 'Glennie',\r\n    'Gloria', 'Godfrey', 'Golda', 'Golden', 'Gonzalo', 'Gordon', 'Grace',\r\n    'Gracie', 'Graciela', 'Grady', 'Graham', 'Grant', 'Granville', 'Grayce',\r\n    'Grayson', 'Green', 'Greg', 'Gregg', 'Gregoria', 'Gregorio', 'Gregory',\r\n    'Greta', 'Gretchen', 'Greyson', 'Griffin', 'Grover', 'Guadalupe', 'Gudrun',\r\n    'Guido', 'Guillermo', 'Guiseppe', 'Gunnar', 'Gunner', 'Gus', 'Gussie',\r\n    'Gust', 'Gustave', 'Guy', 'Gwen', 'Gwendolyn', 'Hadley', 'Hailee', 'Hailey',\r\n    'Hailie', 'Hal', 'Haleigh', 'Haley', 'Halie', 'Halle', 'Hallie', 'Hank',\r\n    'Hanna', 'Hannah', 'Hans', 'Hardy', 'Harley', 'Harmon', 'Harmony', 'Harold',\r\n    'Harrison', 'Harry', 'Harvey', 'Haskell', 'Hassan', 'Hassie', 'Hattie',\r\n    'Haven', 'Hayden', 'Haylee', 'Hayley', 'Haylie', 'Hazel', 'Hazle', 'Heath',\r\n    'Heather', 'Heaven', 'Heber', 'Hector', 'Heidi', 'Helen', 'Helena',\r\n    'Helene', 'Helga', 'Hellen', 'Helmer', 'Heloise', 'Henderson', 'Henri',\r\n    'Henriette', 'Henry', 'Herbert', 'Herman', 'Hermann', 'Hermina', 'Herminia',\r\n    'Herminio', 'Hershel', 'Herta', 'Hertha', 'Hester', 'Hettie', 'Hilario',\r\n    'Hilbert', 'Hilda', 'Hildegard', 'Hillard', 'Hillary', 'Hilma', 'Hilton',\r\n    'Hipolito', 'Hiram', 'Hobart', 'Holden', 'Hollie', 'Hollis', 'Holly',\r\n    'Hope', 'Horace', 'Horacio', 'Hortense', 'Hosea', 'Houston', 'Howard',\r\n    'Howell', 'Hoyt', 'Hubert', 'Hudson', 'Hugh', 'Hulda', 'Humberto', 'Hunter',\r\n    'Hyman', 'Ian', 'Ibrahim', 'Icie', 'Ida', 'Idell', 'Idella', 'Ignacio',\r\n    'Ignatius', 'Ike', 'Ila', 'Ilene', 'Iliana', 'Ima', 'Imani', 'Imelda',\r\n    'Immanuel', 'Imogene', 'Ines', 'Irma', 'Irving', 'Irwin', 'Isaac', 'Isabel',\r\n    'Isabell', 'Isabella', 'Isabelle', 'Isac', 'Isadore', 'Isai', 'Isaiah',\r\n    'Isaias', 'Isidro', 'Ismael', 'Isobel', 'Isom', 'Israel', 'Issac', 'Itzel',\r\n    'Iva', 'Ivah', 'Ivory', 'Ivy', 'Izabella', 'Izaiah', 'Jabari', 'Jace',\r\n    'Jacey', 'Jacinthe', 'Jacinto', 'Jack', 'Jackeline', 'Jackie', 'Jacklyn',\r\n    'Jackson', 'Jacky', 'Jaclyn', 'Jacquelyn', 'Jacques', 'Jacynthe', 'Jada',\r\n    'Jade', 'Jaden', 'Jadon', 'Jadyn', 'Jaeden', 'Jaida', 'Jaiden', 'Jailyn',\r\n    'Jaime', 'Jairo', 'Jakayla', 'Jake', 'Jakob', 'Jaleel', 'Jalen', 'Jalon',\r\n    'Jalyn', 'Jamaal', 'Jamal', 'Jamar', 'Jamarcus', 'Jamel', 'Jameson',\r\n    'Jamey', 'Jamie', 'Jamil', 'Jamir', 'Jamison', 'Jammie', 'Jan', 'Jana',\r\n    'Janae', 'Jane', 'Janelle', 'Janessa', 'Janet', 'Janice', 'Janick', 'Janie',\r\n    'Janis', 'Janiya', 'Jannie', 'Jany', 'Jaquan', 'Jaquelin', 'Jaqueline',\r\n    'Jared', 'Jaren', 'Jarod', 'Jaron', 'Jarred', 'Jarrell', 'Jarret',\r\n    'Jarrett', 'Jarrod', 'Jarvis', 'Jasen', 'Jasmin', 'Jason', 'Jasper',\r\n    'Jaunita', 'Javier', 'Javon', 'Javonte', 'Jay', 'Jayce', 'Jaycee', 'Jayda',\r\n    'Jayde', 'Jayden', 'Jaydon', 'Jaylan', 'Jaylen', 'Jaylin', 'Jaylon',\r\n    'Jayme', 'Jayne', 'Jayson', 'Jazlyn', 'Jazmin', 'Jazmyn', 'Jazmyne', 'Jean',\r\n    'Jeanette', 'Jeanie', 'Jeanne', 'Jed', 'Jedediah', 'Jedidiah', 'Jeff',\r\n    'Jefferey', 'Jeffery', 'Jeffrey', 'Jeffry', 'Jena', 'Jenifer', 'Jennie',\r\n    'Jennifer', 'Jennings', 'Jennyfer', 'Jensen', 'Jerad', 'Jerald', 'Jeramie',\r\n    'Jeramy', 'Jerel', 'Jeremie', 'Jeremy', 'Jermain', 'Jermaine', 'Jermey',\r\n    'Jerod', 'Jerome', 'Jeromy', 'Jerrell', 'Jerrod', 'Jerrold', 'Jerry',\r\n    'Jess', 'Jesse', 'Jessica', 'Jessie', 'Jessika', 'Jessy', 'Jessyca',\r\n    'Jesus', 'Jett', 'Jettie', 'Jevon', 'Jewel', 'Jewell', 'Jillian', 'Jimmie',\r\n    'Jimmy', 'Jo', 'Joan', 'Joana', 'Joanie', 'Joanne', 'Joannie', 'Joanny',\r\n    'Joany', 'Joaquin', 'Jocelyn', 'Jodie', 'Jody', 'Joe', 'Joel', 'Joelle',\r\n    'Joesph', 'Joey', 'Johan', 'Johann', 'Johanna', 'Johathan', 'John',\r\n    'Johnathan', 'Johnathon', 'Johnnie', 'Johnny', 'Johnpaul', 'Johnson',\r\n    'Jolie', 'Jon', 'Jonas', 'Jonatan', 'Jonathan', 'Jonathon', 'Jordan',\r\n    'Jordane', 'Jordi', 'Jordon', 'Jordy', 'Jordyn', 'Jorge', 'Jose', 'Josefa',\r\n    'Josefina', 'Joseph', 'Josephine', 'Josh', 'Joshua', 'Joshuah', 'Josiah',\r\n    'Josiane', 'Josianne', 'Josie', 'Josue', 'Jovan', 'Jovani', 'Jovanny',\r\n    'Jovany', 'Joy', 'Joyce', 'Juana', 'Juanita', 'Judah', 'Judd', 'Jude',\r\n    'Judge', 'Judson', 'Judy', 'Jules', 'Julia', 'Julian', 'Juliana',\r\n    'Julianne', 'Julie', 'Julien', 'Juliet', 'Julio', 'Julius', 'June',\r\n    'Junior', 'Junius', 'Justen', 'Justice', 'Justina', 'Justine', 'Juston',\r\n    'Justus', 'Justyn', 'Juvenal', 'Juwan', 'Kacey', 'Kaci', 'Kacie', 'Kade',\r\n    'Kaden', 'Kadin', 'Kaela', 'Kaelyn', 'Kaia', 'Kailee', 'Kailey', 'Kailyn',\r\n    'Kaitlin', 'Kaitlyn', 'Kale', 'Kaleb', 'Kaleigh', 'Kaley', 'Kali', 'Kallie',\r\n    'Kameron', 'Kamille', 'Kamren', 'Kamron', 'Kamryn', 'Kane', 'Kara',\r\n    'Kareem', 'Karelle', 'Karen', 'Kari', 'Kariane', 'Karianne', 'Karina',\r\n    'Karine', 'Karl', 'Karlee', 'Karley', 'Karli', 'Karlie', 'Karolann',\r\n    'Karson', 'Kasandra', 'Kasey', 'Kassandra', 'Katarina', 'Katelin',\r\n    'Katelyn', 'Katelynn', 'Katharina', 'Katherine', 'Katheryn', 'Kathleen',\r\n    'Kathlyn', 'Kathryn', 'Kathryne', 'Katlyn', 'Katlynn', 'Katrina', 'Katrine',\r\n    'Kattie', 'Kavon', 'Kay', 'Kaya', 'Kaycee', 'Kayden', 'Kayla', 'Kaylah',\r\n    'Kaylee', 'Kayleigh', 'Kayley', 'Kayli', 'Kaylie', 'Kaylin', 'Keagan',\r\n    'Keanu', 'Keara', 'Keaton', 'Keegan', 'Keeley', 'Keely', 'Keenan', 'Keira',\r\n    'Keith', 'Kellen', 'Kelley', 'Kelli', 'Kellie', 'Kelly', 'Kelsi', 'Kelsie',\r\n    'Kelton', 'Kelvin', 'Ken', 'Kendall', 'Kendra', 'Kendrick', 'Kenna',\r\n    'Kennedi', 'Kennedy', 'Kenneth', 'Kennith', 'Kenny', 'Kenton', 'Kenya',\r\n    'Kenyatta', 'Kenyon', 'Keon', 'Keshaun', 'Keshawn', 'Keven', 'Kevin',\r\n    'Kevon', 'Keyon', 'Keyshawn', 'Khalid', 'Khalil', 'Kian', 'Kiana', 'Kianna',\r\n    'Kiara', 'Kiarra', 'Kiel', 'Kiera', 'Kieran', 'Kiley', 'Kim', 'Kimberly',\r\n    'King', 'Kip', 'Kira', 'Kirk', 'Kirsten', 'Kirstin', 'Kitty', 'Kobe',\r\n    'Koby', 'Kody', 'Kolby', 'Kole', 'Korbin', 'Korey', 'Kory', 'Kraig', 'Kris',\r\n    'Krista', 'Kristian', 'Kristin', 'Kristina', 'Kristofer', 'Kristoffer',\r\n    'Kristopher', 'Kristy', 'Krystal', 'Krystel', 'Krystina', 'Kurt', 'Kurtis',\r\n    'Kyla', 'Kyle', 'Kylee', 'Kyleigh', 'Kyler', 'Kylie', 'Kyra', 'Lacey',\r\n    'Lacy', 'Ladarius', 'Lafayette', 'Laila', 'Laisha', 'Lamar', 'Lambert',\r\n    'Lamont', 'Lance', 'Landen', 'Lane', 'Laney', 'Larissa', 'Laron', 'Larry',\r\n    'Larue', 'Laura', 'Laurel', 'Lauren', 'Laurence', 'Lauretta', 'Lauriane',\r\n    'Laurianne', 'Laurie', 'Laurine', 'Laury', 'Lauryn', 'Lavada', 'Lavern',\r\n    'Laverna', 'Laverne', 'Lavina', 'Lavinia', 'Lavon', 'Lavonne', 'Lawrence',\r\n    'Lawson', 'Layla', 'Layne', 'Lazaro', 'Lea', 'Leann', 'Leanna', 'Leanne',\r\n    'Leatha', 'Leda', 'Lee', 'Leif', 'Leila', 'Leilani', 'Lela', 'Lelah',\r\n    'Leland', 'Lelia', 'Lempi', 'Lemuel', 'Lenna', 'Lennie', 'Lenny', 'Lenora',\r\n    'Lenore', 'Leo', 'Leola', 'Leon', 'Leonard', 'Leonardo', 'Leone', 'Leonel',\r\n    'Leonie', 'Leonor', 'Leonora', 'Leopold', 'Leopoldo', 'Leora', 'Lera',\r\n    'Lesley', 'Leslie', 'Lesly', 'Lessie', 'Lester', 'Leta', 'Letha', 'Letitia',\r\n    'Levi', 'Lew', 'Lewis', 'Lexi', 'Lexie', 'Lexus', 'Lia', 'Liam', 'Liana',\r\n    'Libbie', 'Libby', 'Lila', 'Lilian', 'Liliana', 'Liliane', 'Lilla',\r\n    'Lillian', 'Lilliana', 'Lillie', 'Lilly', 'Lily', 'Lilyan', 'Lina',\r\n    'Lincoln', 'Linda', 'Lindsay', 'Lindsey', 'Linnea', 'Linnie', 'Linwood',\r\n    'Lionel', 'Lisa', 'Lisandro', 'Lisette', 'Litzy', 'Liza', 'Lizeth',\r\n    'Lizzie', 'Llewellyn', 'Lloyd', 'Logan', 'Lois', 'Lola', 'Lolita', 'Loma',\r\n    'Lon', 'London', 'Lonie', 'Lonnie', 'Lonny', 'Lonzo', 'Lora', 'Loraine',\r\n    'Loren', 'Lorena', 'Lorenz', 'Lorenza', 'Lorenzo', 'Lori', 'Lorine',\r\n    'Lorna', 'Lottie', 'Lou', 'Louie', 'Louisa', 'Lourdes', 'Louvenia',\r\n    'Lowell', 'Loy', 'Loyal', 'Loyce', 'Lucas', 'Luciano', 'Lucie', 'Lucienne',\r\n    'Lucile', 'Lucinda', 'Lucio', 'Lucious', 'Lucius', 'Lucy', 'Ludie',\r\n    'Ludwig', 'Lue', 'Luella', 'Luigi', 'Luis', 'Luisa', 'Lukas', 'Lula',\r\n    'Lulu', 'Luna', 'Lupe', 'Lura', 'Lurline', 'Luther', 'Luz', 'Lyda', 'Lydia',\r\n    'Lyla', 'Lynn', 'Lyric', 'Lysanne', 'Mabel', 'Mabelle', 'Mable', 'Mac',\r\n    'Macey', 'Maci', 'Macie', 'Mack', 'Mackenzie', 'Macy', 'Madaline',\r\n    'Madalyn', 'Maddison', 'Madeline', 'Madelyn', 'Madelynn', 'Madge', 'Madie',\r\n    'Madilyn', 'Madisen', 'Madison', 'Madisyn', 'Madonna', 'Madyson', 'Mae',\r\n    'Maegan', 'Maeve', 'Mafalda', 'Magali', 'Magdalen', 'Magdalena', 'Maggie',\r\n    'Magnolia', 'Magnus', 'Maia', 'Maida', 'Maiya', 'Major', 'Makayla',\r\n    'Makenna', 'Makenzie', 'Malachi', 'Malcolm', 'Malika', 'Malinda', 'Mallie',\r\n    'Mallory', 'Malvina', 'Mandy', 'Manley', 'Manuel', 'Manuela', 'Mara',\r\n    'Marc', 'Marcel', 'Marcelina', 'Marcelino', 'Marcella', 'Marcelle',\r\n    'Marcellus', 'Marcelo', 'Marcia', 'Marco', 'Marcos', 'Marcus', 'Margaret',\r\n    'Margarete', 'Margarett', 'Margaretta', 'Margarette', 'Margarita', 'Marge',\r\n    'Margie', 'Margot', 'Margret', 'Marguerite', 'Maria', 'Mariah', 'Mariam',\r\n    'Marian', 'Mariana', 'Mariane', 'Marianna', 'Marianne', 'Mariano',\r\n    'Maribel', 'Marie', 'Mariela', 'Marielle', 'Marietta', 'Marilie', 'Marilou',\r\n    'Marilyne', 'Marina', 'Mario', 'Marion', 'Marisa', 'Marisol', 'Maritza',\r\n    'Marjolaine', 'Marjorie', 'Marjory', 'Mark', 'Markus', 'Marlee', 'Marlen',\r\n    'Marlene', 'Marley', 'Marlin', 'Marlon', 'Marques', 'Marquis', 'Marquise',\r\n    'Marshall', 'Marta', 'Martin', 'Martina', 'Martine', 'Marty', 'Marvin',\r\n    'Mary', 'Maryam', 'Maryjane', 'Maryse', 'Mason', 'Mateo', 'Mathew',\r\n    'Mathias', 'Mathilde', 'Matilda', 'Matilde', 'Matt', 'Matteo', 'Mattie',\r\n    'Maud', 'Maude', 'Maudie', 'Maureen', 'Maurice', 'Mauricio', 'Maurine',\r\n    'Maverick', 'Mavis', 'Max', 'Maxie', 'Maxime', 'Maximilian', 'Maximillia',\r\n    'Maximillian', 'Maximo', 'Maximus', 'Maxine', 'Maxwell', 'May', 'Maya',\r\n    'Maybell', 'Maybelle', 'Maye', 'Maymie', 'Maynard', 'Mayra', 'Mazie',\r\n    'Mckayla', 'Mckenna', 'Mckenzie', 'Meagan', 'Meaghan', 'Meda', 'Megane',\r\n    'Meggie', 'Meghan', 'Mekhi', 'Melany', 'Melba', 'Melisa', 'Melissa',\r\n    'Mellie', 'Melody', 'Melvin', 'Melvina', 'Melyna', 'Melyssa', 'Mercedes',\r\n    'Meredith', 'Merl', 'Merle', 'Merlin', 'Merritt', 'Mertie', 'Mervin',\r\n    'Meta', 'Mia', 'Micaela', 'Micah', 'Michael', 'Michaela', 'Michale',\r\n    'Micheal', 'Michel', 'Michele', 'Michelle', 'Miguel', 'Mikayla', 'Mike',\r\n    'Mikel', 'Milan', 'Miles', 'Milford', 'Miller', 'Millie', 'Milo', 'Milton',\r\n    'Mina', 'Minerva', 'Minnie', 'Miracle', 'Mireille', 'Mireya', 'Misael',\r\n    'Missouri', 'Misty', 'Mitchel', 'Mitchell', 'Mittie', 'Modesta', 'Modesto',\r\n    'Mohamed', 'Mohammad', 'Mohammed', 'Moises', 'Mollie', 'Molly', 'Mona',\r\n    'Monica', 'Monique', 'Monroe', 'Monserrat', 'Monserrate', 'Montana',\r\n    'Monte', 'Monty', 'Morgan', 'Moriah', 'Morris', 'Mortimer', 'Morton',\r\n    'Mose', 'Moses', 'Moshe', 'Mossie', 'Mozell', 'Mozelle', 'Muhammad',\r\n    'Muriel', 'Murl', 'Murphy', 'Murray', 'Mustafa', 'Mya', 'Myah', 'Mylene',\r\n    'Myles', 'Myra', 'Myriam', 'Myrl', 'Myrna', 'Myron', 'Myrtice', 'Myrtie',\r\n    'Myrtis', 'Myrtle', 'Nadia', 'Nakia', 'Name', 'Nannie', 'Naomi', 'Naomie',\r\n    'Napoleon', 'Narciso', 'Nash', 'Nasir', 'Nat', 'Natalia', 'Natalie',\r\n    'Natasha', 'Nathan', 'Nathanael', 'Nathanial', 'Nathaniel', 'Nathen',\r\n    'Nayeli', 'Neal', 'Ned', 'Nedra', 'Neha', 'Neil', 'Nelda', 'Nella', 'Nelle',\r\n    'Nellie', 'Nels', 'Nelson', 'Neoma', 'Nestor', 'Nettie', 'Neva', 'Newell',\r\n    'Newton', 'Nia', 'Nicholas', 'Nicholaus', 'Nichole', 'Nick', 'Nicklaus',\r\n    'Nickolas', 'Nico', 'Nicola', 'Nicolas', 'Nicole', 'Nicolette', 'Nigel',\r\n    'Nikita', 'Nikki', 'Nikko', 'Niko', 'Nikolas', 'Nils', 'Nina', 'Noah',\r\n    'Noble', 'Noe', 'Noel', 'Noelia', 'Noemi', 'Noemie', 'Noemy', 'Nola',\r\n    'Nolan', 'Nona', 'Nora', 'Norbert', 'Norberto', 'Norene', 'Norma', 'Norris',\r\n    'Norval', 'Norwood', 'Nova', 'Novella', 'Nya', 'Nyah', 'Nyasia', 'Obie',\r\n    'Oceane', 'Ocie', 'Octavia', 'Oda', 'Odell', 'Odessa', 'Odie', 'Ofelia',\r\n    'Okey', 'Ola', 'Olaf', 'Ole', 'Olen', 'Oleta', 'Olga', 'Olin', 'Oliver',\r\n    'Ollie', 'Oma', 'Omari', 'Omer', 'Ona', 'Onie', 'Opal', 'Ophelia', 'Ora',\r\n    'Oral', 'Oran', 'Oren', 'Orie', 'Orin', 'Orion', 'Orland', 'Orlando',\r\n    'Orlo', 'Orpha', 'Orrin', 'Orval', 'Orville', 'Osbaldo', 'Osborne', 'Oscar',\r\n    'Osvaldo', 'Oswald', 'Oswaldo', 'Otha', 'Otho', 'Otilia', 'Otis', 'Ottilie',\r\n    'Ottis', 'Otto', 'Ova', 'Owen', 'Ozella', 'Pablo', 'Paige', 'Palma',\r\n    'Pamela', 'Pansy', 'Paolo', 'Paris', 'Parker', 'Pascale', 'Pasquale', 'Pat',\r\n    'Patience', 'Patricia', 'Patrick', 'Patsy', 'Pattie', 'Paul', 'Paula',\r\n    'Pauline', 'Paxton', 'Payton', 'Pearl', 'Pearlie', 'Pearline', 'Pedro',\r\n    'Peggie', 'Penelope', 'Percival', 'Percy', 'Perry', 'Pete', 'Peter',\r\n    'Petra', 'Peyton', 'Philip', 'Phoebe', 'Phyllis', 'Pierce', 'Pierre',\r\n    'Pietro', 'Pink', 'Pinkie', 'Piper', 'Polly', 'Porter', 'Precious',\r\n    'Presley', 'Preston', 'Price', 'Prince', 'Princess', 'Priscilla',\r\n    'Providenci', 'Prudence', 'Queen', 'Queenie', 'Quentin', 'Quincy', 'Quinn',\r\n    'Quinten', 'Quinton', 'Rachael', 'Rachel', 'Rachelle', 'Rae', 'Raegan',\r\n    'Rafael', 'Rafaela', 'Raheem', 'Rahsaan', 'Rahul', 'Raina', 'Raleigh',\r\n    'Ralph', 'Ramiro', 'Ramon', 'Ramona', 'Randal', 'Randall', 'Randi', 'Randy',\r\n    'Ransom', 'Raoul', 'Raphael', 'Raphaelle', 'Raquel', 'Rashad', 'Rashawn',\r\n    'Rasheed', 'Raul', 'Raven', 'Ray', 'Raymond', 'Raymundo', 'Reagan',\r\n    'Reanna', 'Reba', 'Rebeca', 'Rebecca', 'Rebeka', 'Rebekah', 'Reece', 'Reed',\r\n    'Reese', 'Regan', 'Reggie', 'Reginald', 'Reid', 'Reilly', 'Reina',\r\n    'Reinhold', 'Remington', 'Rene', 'Renee', 'Ressie', 'Reta', 'Retha',\r\n    'Retta', 'Reuben', 'Reva', 'Rex', 'Rey', 'Reyes', 'Reymundo', 'Reyna',\r\n    'Reynold', 'Rhea', 'Rhett', 'Rhianna', 'Rhiannon', 'Rhoda', 'Ricardo',\r\n    'Richard', 'Richie', 'Richmond', 'Rick', 'Rickey', 'Rickie', 'Ricky',\r\n    'Rico', 'Rigoberto', 'Riley', 'Rita', 'River', 'Robb', 'Robbie', 'Robert',\r\n    'Roberta', 'Roberto', 'Robin', 'Robyn', 'Rocio', 'Rocky', 'Rod', 'Roderick',\r\n    'Rodger', 'Rodolfo', 'Rodrick', 'Rodrigo', 'Roel', 'Rogelio', 'Roger',\r\n    'Rogers', 'Rolando', 'Rollin', 'Roma', 'Romaine', 'Roman', 'Ron', 'Ronaldo',\r\n    'Ronny', 'Roosevelt', 'Rory', 'Rosa', 'Rosalee', 'Rosalia', 'Rosalind',\r\n    'Rosalinda', 'Rosalyn', 'Rosamond', 'Rosanna', 'Rosario', 'Roscoe', 'Rose',\r\n    'Rosella', 'Roselyn', 'Rosemarie', 'Rosemary', 'Rosendo', 'Rosetta',\r\n    'Rosie', 'Rosina', 'Roslyn', 'Ross', 'Rossie', 'Rowan', 'Rowena', 'Rowland',\r\n    'Roxane', 'Roxanne', 'Roy', 'Royal', 'Royce', 'Rozella', 'Ruben', 'Rubie',\r\n    'Ruby', 'Rubye', 'Rudolph', 'Rudy', 'Rupert', 'Russ', 'Russel', 'Russell',\r\n    'Rusty', 'Ruth', 'Ruthe', 'Ruthie', 'Ryan', 'Ryann', 'Ryder', 'Rylan',\r\n    'Rylee', 'Ryleigh', 'Ryley', 'Sabina', 'Sabrina', 'Sabryna', 'Sadie',\r\n    'Sadye', 'Sage', 'Saige', 'Sallie', 'Sally', 'Salma', 'Salvador',\r\n    'Salvatore', 'Sam', 'Samanta', 'Samantha', 'Samara', 'Samir', 'Sammie',\r\n    'Sammy', 'Samson', 'Sandra', 'Sandrine', 'Sandy', 'Sanford', 'Santa',\r\n    'Santiago', 'Santina', 'Santino', 'Santos', 'Sarah', 'Sarai', 'Sarina',\r\n    'Sasha', 'Saul', 'Savanah', 'Savanna', 'Savannah', 'Savion', 'Scarlett',\r\n    'Schuyler', 'Scot', 'Scottie', 'Scotty', 'Seamus', 'Sean', 'Sebastian',\r\n    'Sedrick', 'Selena', 'Selina', 'Selmer', 'Serena', 'Serenity', 'Seth',\r\n    'Shad', 'Shaina', 'Shakira', 'Shana', 'Shane', 'Shanel', 'Shanelle',\r\n    'Shania', 'Shanie', 'Shaniya', 'Shanna', 'Shannon', 'Shanny', 'Shanon',\r\n    'Shany', 'Sharon', 'Shaun', 'Shawn', 'Shawna', 'Shaylee', 'Shayna',\r\n    'Shayne', 'Shea', 'Sheila', 'Sheldon', 'Shemar', 'Sheridan', 'Sherman',\r\n    'Sherwood', 'Shirley', 'Shyann', 'Shyanne', 'Sibyl', 'Sid', 'Sidney',\r\n    'Sienna', 'Sierra', 'Sigmund', 'Sigrid', 'Sigurd', 'Silas', 'Sim', 'Simeon',\r\n    'Simone', 'Sincere', 'Sister', 'Skye', 'Skyla', 'Skylar', 'Sofia',\r\n    'Soledad', 'Solon', 'Sonia', 'Sonny', 'Sonya', 'Sophia', 'Sophie',\r\n    'Spencer', 'Stacey', 'Stacy', 'Stan', 'Stanford', 'Stanley', 'Stanton',\r\n    'Stefan', 'Stefanie', 'Stella', 'Stephan', 'Stephania', 'Stephanie',\r\n    'Stephany', 'Stephen', 'Stephon', 'Sterling', 'Steve', 'Stevie', 'Stewart',\r\n    'Stone', 'Stuart', 'Summer', 'Sunny', 'Susan', 'Susana', 'Susanna', 'Susie',\r\n    'Suzanne', 'Sven', 'Syble', 'Sydnee', 'Sydney', 'Sydni', 'Sydnie', 'Sylvan',\r\n    'Sylvester', 'Sylvia', 'Tabitha', 'Tad', 'Talia', 'Talon', 'Tamara',\r\n    'Tamia', 'Tania', 'Tanner', 'Tanya', 'Tara', 'Taryn', 'Tate', 'Tatum',\r\n    'Tatyana', 'Taurean', 'Tavares', 'Taya', 'Taylor', 'Teagan', 'Ted', 'Telly',\r\n    'Terence', 'Teresa', 'Terrance', 'Terrell', 'Terrence', 'Terrill', 'Terry',\r\n    'Tess', 'Tessie', 'Tevin', 'Thad', 'Thaddeus', 'Thalia', 'Thea', 'Thelma',\r\n    'Theo', 'Theodora', 'Theodore', 'Theresa', 'Therese', 'Theresia', 'Theron',\r\n    'Thomas', 'Thora', 'Thurman', 'Tia', 'Tiana', 'Tianna', 'Tiara', 'Tierra',\r\n    'Tiffany', 'Tillman', 'Timmothy', 'Timmy', 'Timothy', 'Tina', 'Tito',\r\n    'Titus', 'Tobin', 'Toby', 'Tod', 'Tom', 'Tomas', 'Tomasa', 'Tommie',\r\n    'Toney', 'Toni', 'Tony', 'Torey', 'Torrance', 'Torrey', 'Toy', 'Trace',\r\n    'Tracey', 'Tracy', 'Travis', 'Travon', 'Tre', 'Tremaine', 'Tremayne',\r\n    'Trent', 'Trenton', 'Tressa', 'Tressie', 'Treva', 'Trever', 'Trevion',\r\n    'Trevor', 'Trey', 'Trinity', 'Trisha', 'Tristian', 'Tristin', 'Triston',\r\n    'Troy', 'Trudie', 'Trycia', 'Trystan', 'Turner', 'Twila', 'Tyler', 'Tyra',\r\n    'Tyree', 'Tyreek', 'Tyrel', 'Tyrell', 'Tyrese', 'Tyrique', 'Tyshawn',\r\n    'Tyson', 'Ubaldo', 'Ulices', 'Ulises', 'Una', 'Unique', 'Urban', 'Uriah',\r\n    'Uriel', 'Ursula', 'Vada', 'Valentin', 'Valentina', 'Valentine', 'Valerie',\r\n    'Vallie', 'Van', 'Vance', 'Vanessa', 'Vaughn', 'Veda', 'Velda', 'Vella',\r\n    'Velma', 'Velva', 'Vena', 'Verda', 'Verdie', 'Vergie', 'Verla', 'Verlie',\r\n    'Vern', 'Verna', 'Verner', 'Vernice', 'Vernie', 'Vernon', 'Verona',\r\n    'Veronica', 'Vesta', 'Vicenta', 'Vicente', 'Vickie', 'Vicky', 'Victor',\r\n    'Victoria', 'Vida', 'Vidal', 'Vilma', 'Vince', 'Vincent', 'Vincenza',\r\n    'Vincenzo', 'Vinnie', 'Viola', 'Violet', 'Violette', 'Virgie', 'Virgil',\r\n    'Virginia', 'Virginie', 'Vita', 'Vito', 'Viva', 'Vivian', 'Viviane',\r\n    'Vivianne', 'Vivien', 'Vivienne', 'Vladimir', 'Wade', 'Waino', 'Waldo',\r\n    'Walker', 'Wallace', 'Walter', 'Walton', 'Wanda', 'Ward', 'Warren',\r\n    'Watson', 'Wava', 'Waylon', 'Wayne', 'Webster', 'Weldon', 'Wellington',\r\n    'Wendell', 'Wendy', 'Werner', 'Westley', 'Weston', 'Whitney', 'Wilber',\r\n    'Wilbert', 'Wilburn', 'Wiley', 'Wilford', 'Wilfred', 'Wilfredo', 'Wilfrid',\r\n    'Wilhelm', 'Wilhelmine', 'Will', 'Willa', 'Willard', 'William', 'Willie',\r\n    'Willis', 'Willow', 'Willy', 'Wilma', 'Wilmer', 'Wilson', 'Wilton',\r\n    'Winfield', 'Winifred', 'Winnifred', 'Winona', 'Winston', 'Woodrow',\r\n    'Wyatt', 'Wyman', 'Xander', 'Xavier', 'Xzavier', 'Yadira', 'Yasmeen',\r\n    'Yasmin', 'Yasmine', 'Yazmin', 'Yesenia', 'Yessenia', 'Yolanda', 'Yoshiko',\r\n    'Yvette', 'Yvonne', 'Zachariah', 'Zachary', 'Zachery', 'Zack', 'Zackary',\r\n    'Zackery', 'Zakary', 'Zander', 'Zane', 'Zaria', 'Zechariah', 'Zelda',\r\n    'Zella', 'Zelma', 'Zena', 'Zetta', 'Zion', 'Zita', 'Zoe', 'Zoey', 'Zoie',\r\n    'Zoila', 'Zola', 'Zora', 'Zula'\r\n];\r\n\r\n/**\r\n * Generate random username.\r\n * @returns {string} random username\r\n */\r\nfunction generateUsername() {\r\n    const name = RandomUtil.randomElement(names);\r\n    const suffix = RandomUtil.randomAlphanumStr(3);\r\n\r\n    return `${name}-${suffix}`;\r\n}\r\n\r\nmodule.exports = {\r\n    generateUsername\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/util/UsernameGenerator.js","/* global callstats */\r\n\r\nimport browser from '../browser';\r\nimport GlobalOnErrorHandler from '../util/GlobalOnErrorHandler';\r\n\r\nconst logger = require('jitsi-meet-logger').getLogger(__filename);\r\n\r\n/**\r\n * We define enumeration of wrtcFuncNames as we need them before\r\n * callstats is initialized to queue events.\r\n * @const\r\n * @see http://www.callstats.io/api/#enumeration-of-wrtcfuncnames\r\n */\r\nconst wrtcFuncNames = {\r\n    createOffer: 'createOffer',\r\n    createAnswer: 'createAnswer',\r\n    setLocalDescription: 'setLocalDescription',\r\n    setRemoteDescription: 'setRemoteDescription',\r\n    addIceCandidate: 'addIceCandidate',\r\n    getUserMedia: 'getUserMedia',\r\n    iceConnectionFailure: 'iceConnectionFailure',\r\n    signalingError: 'signalingError',\r\n    applicationLog: 'applicationLog'\r\n};\r\n\r\n/**\r\n * We define enumeration of fabricEvent as we need them before\r\n * callstats is initialized to queue events.\r\n * @const\r\n * @see http://www.callstats.io/api/#enumeration-of-fabricevent\r\n */\r\nconst fabricEvent = {\r\n    fabricHold: 'fabricHold',\r\n    fabricResume: 'fabricResume',\r\n    audioMute: 'audioMute',\r\n    audioUnmute: 'audioUnmute',\r\n    videoPause: 'videoPause',\r\n    videoResume: 'videoResume',\r\n    fabricUsageEvent: 'fabricUsageEvent',\r\n    fabricStats: 'fabricStats',\r\n    fabricTerminated: 'fabricTerminated',\r\n    screenShareStart: 'screenShareStart',\r\n    screenShareStop: 'screenShareStop',\r\n    dominantSpeaker: 'dominantSpeaker',\r\n    activeDeviceList: 'activeDeviceList'\r\n};\r\n\r\n/**\r\n * The user id to report to callstats as destination.\r\n * @type {string}\r\n */\r\nconst DEFAULT_REMOTE_USER = 'jitsi';\r\n\r\n/**\r\n * Type of pending reports, can be event or an error.\r\n * @type {{ERROR: string, EVENT: string}}\r\n */\r\nconst reportType = {\r\n    ERROR: 'error',\r\n    EVENT: 'event',\r\n    MST_WITH_USERID: 'mstWithUserID'\r\n};\r\n\r\n/**\r\n * Set of currently existing {@link CallStats} instances.\r\n * @type {Set<CallStats>}\r\n */\r\nlet _fabrics;\r\n\r\n/**\r\n * An instance of this class is a wrapper for the CallStats API fabric. A fabric\r\n * reports one peer connection the the CallStats backend and is allocated with\r\n * {@link callstats.addNewFabric}. It has a bunch of instance methods for\r\n * reporting various events. A fabric is considered disposed when\r\n * {@link CallStats.sendTerminateEvent} is executed.\r\n *\r\n * Currently only one backend instance can be created ever and it's done using\r\n * {@link CallStats.initBackend}. At the time of this writing there is no way to\r\n * explicitly shutdown the backend, but it's supposed to close it's connection\r\n * automatically, after all fabrics have been terminated.\r\n */\r\nexport default class CallStats {\r\n    /**\r\n     * A callback passed to {@link callstats.addNewFabric}.\r\n     * @param {string} error 'success' means ok\r\n     * @param {string} msg some more details\r\n     * @private\r\n     */\r\n    static _addNewFabricCallback(error, msg) {\r\n        if (CallStats.backend && error !== 'success') {\r\n            logger.error(`Monitoring status: ${error} msg: ${msg}`);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Callback passed to {@link callstats.initialize} (backend initialization)\r\n     * @param {string} error 'success' means ok\r\n     * @param {String} msg\r\n     * @private\r\n     */\r\n    static _initCallback(error, msg) {\r\n        logger.log(`CallStats Status: err=${error} msg=${msg}`);\r\n\r\n        // there is no lib, nothing to report to\r\n        if (error !== 'success') {\r\n            return;\r\n        }\r\n\r\n        CallStats.backendInitialized = true;\r\n\r\n        // I hate that\r\n        let atLeastOneFabric = false;\r\n        let defaultInstance = null;\r\n\r\n        for (const callStatsInstance of CallStats.fabrics.values()) {\r\n            if (!callStatsInstance.hasFabric) {\r\n                logger.debug('addNewFabric - initCallback');\r\n                if (callStatsInstance._addNewFabric()) {\r\n                    atLeastOneFabric = true;\r\n                    if (!defaultInstance) {\r\n                        defaultInstance = callStatsInstance;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (!atLeastOneFabric) {\r\n            return;\r\n        }\r\n\r\n        CallStats._emptyReportQueue(defaultInstance);\r\n    }\r\n\r\n    /**\r\n     * Empties report queue.\r\n     *\r\n     * @param {CallStats} csInstance - The callstats instance.\r\n     * @private\r\n     */\r\n    static _emptyReportQueue(csInstance) {\r\n        // There is no conference ID nor a PeerConnection available when some of\r\n        // the events are scheduled on the reportsQueue, so those will be\r\n        // reported on the first initialized fabric.\r\n        const defaultConfID = csInstance.confID;\r\n        const defaultPC = csInstance.peerconnection;\r\n\r\n        // notify callstats about failures if there were any\r\n        for (const report of CallStats.reportsQueue) {\r\n            if (report.type === reportType.ERROR) {\r\n                const errorData = report.data;\r\n\r\n                CallStats._reportError(\r\n                    csInstance,\r\n                    errorData.type,\r\n                    errorData.error,\r\n                    errorData.pc || defaultPC);\r\n            } else if (report.type === reportType.EVENT) {\r\n                // if we have and event to report and we failed to add\r\n                // fabric this event will not be reported anyway, returning\r\n                // an error\r\n                const eventData = report.data;\r\n\r\n                CallStats.backend.sendFabricEvent(\r\n                    report.pc || defaultPC,\r\n                    eventData.event,\r\n                    defaultConfID,\r\n                    eventData.eventData);\r\n            } else if (report.type === reportType.MST_WITH_USERID) {\r\n                const data = report.data;\r\n\r\n                CallStats.backend.associateMstWithUserID(\r\n                    report.pc || defaultPC,\r\n                    data.callStatsId,\r\n                    defaultConfID,\r\n                    data.ssrc,\r\n                    data.usageLabel,\r\n                    data.containerId\r\n                );\r\n            }\r\n        }\r\n        CallStats.reportsQueue.length = 0;\r\n    }\r\n\r\n    /* eslint-disable max-params */\r\n    /**\r\n     * Reports an error to callstats.\r\n     *\r\n     * @param {CallStats} [cs]\r\n     * @param type the type of the error, which will be one of the wrtcFuncNames\r\n     * @param error the error\r\n     * @param pc the peerconnection\r\n     * @private\r\n     */\r\n    static _reportError(cs, type, error, pc) {\r\n        let _error = error;\r\n\r\n        if (!_error) {\r\n            logger.warn('No error is passed!');\r\n            _error = new Error('Unknown error');\r\n        }\r\n        if (CallStats.backendInitialized && cs) {\r\n            CallStats.backend.reportError(pc, cs.confID, type, _error);\r\n        } else {\r\n            CallStats.reportsQueue.push({\r\n                type: reportType.ERROR,\r\n                data: {\r\n                    error: _error,\r\n                    pc,\r\n                    type\r\n                }\r\n            });\r\n        }\r\n\r\n        // else just ignore it\r\n    }\r\n\r\n    /* eslint-enable max-params */\r\n\r\n    /**\r\n     * Reports an error to callstats.\r\n     *\r\n     * @param {CallStats} cs\r\n     * @param event the type of the event, which will be one of the fabricEvent\r\n     * @param eventData additional data to pass to event\r\n     * @private\r\n     */\r\n    static _reportEvent(cs, event, eventData) {\r\n        const pc = cs && cs.peerconnection;\r\n        const confID = cs && cs.confID;\r\n\r\n        if (CallStats.backendInitialized && cs) {\r\n            CallStats.backend.sendFabricEvent(pc, event, confID, eventData);\r\n        } else {\r\n            CallStats.reportsQueue.push({\r\n                confID,\r\n                pc,\r\n                type: reportType.EVENT,\r\n                data: { event,\r\n                    eventData }\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Wraps some of the CallStats API method and logs their calls with\r\n     * arguments on the debug logging level. Also wraps some of the backend\r\n     * methods execution into try catch blocks to not crash the app in case\r\n     * there is a problem with the backend itself.\r\n     * @param {callstats} theBackend\r\n     * @private\r\n     */\r\n    static _traceAndCatchBackendCalls(theBackend) {\r\n        const tryCatchMethods = [\r\n            'associateMstWithUserID',\r\n            'sendFabricEvent',\r\n            'sendUserFeedback'\r\n\r\n            // 'reportError', - this one needs special handling - see code below\r\n        ];\r\n\r\n        for (const methodName of tryCatchMethods) {\r\n            const originalMethod = theBackend[methodName];\r\n\r\n            theBackend[methodName] = function(...theArguments) {\r\n                try {\r\n                    return originalMethod.apply(theBackend, theArguments);\r\n                } catch (e) {\r\n                    GlobalOnErrorHandler.callErrorHandler(e);\r\n                }\r\n            };\r\n        }\r\n        const debugMethods = [\r\n            'associateMstWithUserID',\r\n            'sendFabricEvent',\r\n            'sendUserFeedback'\r\n\r\n            // 'reportError', - this one needs special handling - see code below\r\n        ];\r\n\r\n        for (const methodName of debugMethods) {\r\n            const originalMethod = theBackend[methodName];\r\n\r\n            theBackend[methodName] = function(...theArguments) {\r\n                logger.debug(methodName, theArguments);\r\n                originalMethod.apply(theBackend, theArguments);\r\n            };\r\n        }\r\n        const originalReportError = theBackend.reportError;\r\n\r\n        /* eslint-disable max-params */\r\n        theBackend.reportError = function(pc, cs, type, ...args) {\r\n            // Logs from the logger are submitted on the applicationLog event\r\n            // \"type\". Logging the arguments on the logger will create endless\r\n            // loop, because it will put all the logs to the logger queue again.\r\n            if (type === wrtcFuncNames.applicationLog) {\r\n                // NOTE otherArguments are not logged to the console on purpose\r\n                // to not log the whole log batch\r\n                // FIXME check the current logging level (currently not exposed\r\n                // by the logger implementation)\r\n                // NOTE it is not safe to log whole objects on react-native as\r\n                // those contain too many circular references and may crash\r\n                // the app.\r\n                if (!browser.isReactNative()) {\r\n                    console && console.debug('reportError', pc, cs, type);\r\n                }\r\n            } else {\r\n                logger.debug('reportError', pc, cs, type, ...args);\r\n            }\r\n            try {\r\n                originalReportError.call(theBackend, pc, cs, type, ...args);\r\n            } catch (exception) {\r\n                if (type === wrtcFuncNames.applicationLog) {\r\n                    console && console.error('reportError', exception);\r\n                } else {\r\n                    GlobalOnErrorHandler.callErrorHandler(exception);\r\n                }\r\n            }\r\n        };\r\n\r\n        /* eslint-enable max-params */\r\n    }\r\n\r\n    /**\r\n     * Returns the Set with the currently existing {@link CallStats} instances.\r\n     * Lazily initializes the Set to allow any Set polyfills to be applied.\r\n     * @type {Set<CallStats>}\r\n     */\r\n    static get fabrics() {\r\n        if (!_fabrics) {\r\n            _fabrics = new Set();\r\n        }\r\n\r\n        return _fabrics;\r\n    }\r\n\r\n    /**\r\n     * Initializes the CallStats backend. Should be called only if\r\n     * {@link CallStats.isBackendInitialized} returns <tt>false</tt>.\r\n     * @param {object} options\r\n     * @param {String} options.callStatsID CallStats credentials - ID\r\n     * @param {String} options.callStatsSecret CallStats credentials - secret\r\n     * @param {string} options.aliasName the <tt>aliasName</tt> part of\r\n     * the <tt>userID</tt> aka endpoint ID, see CallStats docs for more info.\r\n     * @param {string} options.userName the <tt>userName</tt> part of\r\n     * the <tt>userID</tt> aka display name, see CallStats docs for more info.\r\n     *\r\n     */\r\n    static initBackend(options) {\r\n        if (CallStats.backend) {\r\n            throw new Error('CallStats backend has been initialized already!');\r\n        }\r\n        try {\r\n            // In react-native we need to import the callstats module, but\r\n            // imports are only allowed at top-level, so we must use require\r\n            // here. Sigh.\r\n            const CallStatsBackend\r\n                = browser.isReactNative()\r\n                    ? require('react-native-callstats/callstats')\r\n                    : callstats;\r\n\r\n            CallStats.backend = new CallStatsBackend();\r\n\r\n            CallStats._traceAndCatchBackendCalls(CallStats.backend);\r\n\r\n            CallStats.userID = {\r\n                aliasName: options.aliasName,\r\n                userName: options.userName\r\n            };\r\n            CallStats.callStatsID = options.callStatsID;\r\n            CallStats.callStatsSecret = options.callStatsSecret;\r\n\r\n            let configParams;\r\n\r\n            if (options.applicationName) {\r\n                configParams = {\r\n                    applicationVersion:\r\n                        `${options.applicationName} (${\r\n                            browser.getName()})`\r\n                };\r\n            }\r\n\r\n            // userID is generated or given by the origin server\r\n            CallStats.backend.initialize(\r\n                CallStats.callStatsID,\r\n                CallStats.callStatsSecret,\r\n                CallStats.userID,\r\n                CallStats._initCallback,\r\n                undefined,\r\n                configParams);\r\n\r\n            const getWiFiStatsMethod = options.getWiFiStatsMethod;\r\n\r\n            if (getWiFiStatsMethod) {\r\n                CallStats.backend.attachWifiStatsHandler(getWiFiStatsMethod);\r\n\r\n                getWiFiStatsMethod().then(result => {\r\n                    if (result) {\r\n                        logger.info('Reported wifi addresses:'\r\n                            , JSON.parse(result).addresses);\r\n                    }\r\n                })\r\n                .catch(() => {});// eslint-disable-line no-empty-function\r\n            }\r\n\r\n            return true;\r\n        } catch (e) {\r\n            // The callstats.io API failed to initialize (e.g. because its\r\n            // download did not succeed in general or on time). Further attempts\r\n            // to utilize it cannot possibly succeed.\r\n            GlobalOnErrorHandler.callErrorHandler(e);\r\n            CallStats.backend = null;\r\n            logger.error(e);\r\n\r\n            return false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Checks if the CallStats backend has been created. It does not mean that\r\n     * it has been initialized, but only that the API instance has been\r\n     * allocated successfully.\r\n     * @return {boolean} <tt>true</tt> if backend exists or <tt>false</tt>\r\n     * otherwise\r\n     */\r\n    static isBackendInitialized() {\r\n        return Boolean(CallStats.backend);\r\n    }\r\n\r\n    /**\r\n     * Notifies CallStats about active device.\r\n     * @param {{deviceList: {String:String}}} devicesData list of devices with\r\n     * their data\r\n     * @param {CallStats} cs callstats instance related to the event\r\n     */\r\n    static sendActiveDeviceListEvent(devicesData, cs) {\r\n        CallStats._reportEvent(cs, fabricEvent.activeDeviceList, devicesData);\r\n    }\r\n\r\n    /**\r\n     * Notifies CallStats that there is a log we want to report.\r\n     *\r\n     * @param {Error} e error to send or {String} message\r\n     * @param {CallStats} cs callstats instance related to the error (optional)\r\n     */\r\n    static sendApplicationLog(e, cs) {\r\n        try {\r\n            CallStats._reportError(\r\n                cs,\r\n                wrtcFuncNames.applicationLog,\r\n                e,\r\n                cs && cs.peerconnection);\r\n        } catch (error) {\r\n            // If sendApplicationLog fails it should not be printed to\r\n            // the logger, because it will try to push the logs again\r\n            // (through sendApplicationLog) and an endless loop is created.\r\n            if (console && (typeof console.error === 'function')) {\r\n                // FIXME send analytics event as well\r\n                console.error('sendApplicationLog failed', error);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Sends the given feedback through CallStats.\r\n     *\r\n     * @param {string} conferenceID the conference ID for which the feedback\r\n     * will be reported.\r\n     * @param overall an integer between 1 and 5 indicating the\r\n     * user feedback\r\n     * @param comment detailed feedback from the user.\r\n     */\r\n    static sendFeedback(conferenceID, overall, comment) {\r\n        if (CallStats.backend) {\r\n            CallStats.backend.sendUserFeedback(\r\n                conferenceID, {\r\n                    userID: CallStats.userID,\r\n                    overall,\r\n                    comment\r\n                });\r\n        } else {\r\n            logger.error('Failed to submit feedback to CallStats - no backend');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Notifies CallStats that getUserMedia failed.\r\n     *\r\n     * @param {Error} e error to send\r\n     * @param {CallStats} cs callstats instance related to the error (optional)\r\n     */\r\n    static sendGetUserMediaFailed(e, cs) {\r\n        CallStats._reportError(cs, wrtcFuncNames.getUserMedia, e, null);\r\n    }\r\n\r\n    /**\r\n     * Notifies CallStats for mute events\r\n     * @param mute {boolean} true for muted and false for not muted\r\n     * @param type {String} \"audio\"/\"video\"\r\n     * @param {CallStats} cs callstats instance related to the event\r\n     */\r\n    static sendMuteEvent(mute, type, cs) {\r\n        let event;\r\n\r\n        if (type === 'video') {\r\n            event = mute ? fabricEvent.videoPause : fabricEvent.videoResume;\r\n        } else {\r\n            event = mute ? fabricEvent.audioMute : fabricEvent.audioUnmute;\r\n        }\r\n\r\n        CallStats._reportEvent(cs, event);\r\n    }\r\n\r\n    /**\r\n     * Creates new CallStats instance that handles all callstats API calls for\r\n     * given {@link TraceablePeerConnection}. Each instance is meant to handle\r\n     * one CallStats fabric added with 'addFabric' API method for the\r\n     * {@link TraceablePeerConnection} instance passed in the constructor.\r\n     * @param {TraceablePeerConnection} tpc\r\n     * @param {Object} options\r\n     * @param {string} options.confID the conference ID that wil be used to\r\n     * report the session.\r\n     * @param {string} [options.remoteUserID='jitsi'] the remote user ID to\r\n     * which given <tt>tpc</tt> is connected.\r\n     */\r\n    constructor(tpc, options) {\r\n        this.confID = options.confID;\r\n        this.tpc = tpc;\r\n        this.peerconnection = tpc.peerconnection;\r\n        this.remoteUserID = options.remoteUserID || DEFAULT_REMOTE_USER;\r\n        this.hasFabric = false;\r\n\r\n        CallStats.fabrics.add(this);\r\n\r\n        if (CallStats.backendInitialized) {\r\n            this._addNewFabric();\r\n\r\n            // if this is the first fabric let's try to empty the\r\n            // report queue. Reports all events that we recorded between\r\n            // backend initialization and receiving the first fabric\r\n            if (CallStats.fabrics.size === 1) {\r\n                CallStats._emptyReportQueue(this);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Initializes CallStats fabric by calling \"addNewFabric\" for\r\n     * the peer connection associated with this instance.\r\n     * @return {boolean} true if the call was successful or false otherwise.\r\n     */\r\n    _addNewFabric() {\r\n        logger.info('addNewFabric', this.remoteUserID);\r\n        try {\r\n            const fabricAttributes = {\r\n                remoteEndpointType:\r\n                    this.tpc.isP2P\r\n                        ? CallStats.backend.endpointType.peer\r\n                        : CallStats.backend.endpointType.server\r\n            };\r\n            const ret\r\n                = CallStats.backend.addNewFabric(\r\n                    this.peerconnection,\r\n                    this.remoteUserID,\r\n                    CallStats.backend.fabricUsage.multiplex,\r\n                    this.confID,\r\n                    fabricAttributes,\r\n                    CallStats._addNewFabricCallback);\r\n\r\n            this.hasFabric = true;\r\n\r\n            const success = ret.status === 'success';\r\n\r\n            if (!success) {\r\n                logger.error('callstats fabric not initilized', ret.message);\r\n            }\r\n\r\n            return success;\r\n\r\n        } catch (error) {\r\n            GlobalOnErrorHandler.callErrorHandler(error);\r\n\r\n            return false;\r\n        }\r\n    }\r\n\r\n    /* eslint-disable max-params */\r\n\r\n    /**\r\n     * Lets CallStats module know where is given SSRC rendered by providing\r\n     * renderer tag ID.\r\n     * If the lib is not initialized yet queue the call for later, when it's\r\n     * ready.\r\n     * @param {number} ssrc the SSRC of the stream\r\n     * @param {boolean} isLocal indicates whether this the stream is local\r\n     * @param {string|null} streamEndpointId if the stream is not local the it\r\n     * needs to contain the stream owner's ID\r\n     * @param {string} usageLabel meaningful usage label of this stream like\r\n     *        'microphone', 'camera' or 'screen'.\r\n     * @param {string} containerId  the id of media 'audio' or 'video' tag which\r\n     *        renders the stream.\r\n     */\r\n    associateStreamWithVideoTag(\r\n            ssrc,\r\n            isLocal,\r\n            streamEndpointId,\r\n            usageLabel,\r\n            containerId) {\r\n        if (!CallStats.backend) {\r\n            return;\r\n        }\r\n\r\n        const callStatsId = isLocal ? CallStats.userID : streamEndpointId;\r\n\r\n        if (CallStats.backendInitialized) {\r\n            CallStats.backend.associateMstWithUserID(\r\n                this.peerconnection,\r\n                callStatsId,\r\n                this.confID,\r\n                ssrc,\r\n                usageLabel,\r\n                containerId);\r\n        } else {\r\n            CallStats.reportsQueue.push({\r\n                type: reportType.MST_WITH_USERID,\r\n                pc: this.peerconnection,\r\n                data: {\r\n                    callStatsId,\r\n                    containerId,\r\n                    ssrc,\r\n                    usageLabel\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    /* eslint-enable max-params */\r\n\r\n    /**\r\n     * Notifies CallStats that we are the new dominant speaker in the\r\n     * conference.\r\n     */\r\n    sendDominantSpeakerEvent() {\r\n        CallStats._reportEvent(this, fabricEvent.dominantSpeaker);\r\n    }\r\n\r\n    /**\r\n     * Notifies CallStats that the fabric for the underlying peerconnection was\r\n     * closed and no evens should be reported, after this call.\r\n     */\r\n    sendTerminateEvent() {\r\n        if (CallStats.backendInitialized) {\r\n            CallStats.backend.sendFabricEvent(\r\n                this.peerconnection,\r\n                CallStats.backend.fabricEvent.fabricTerminated,\r\n                this.confID);\r\n        }\r\n        CallStats.fabrics.delete(this);\r\n    }\r\n\r\n    /**\r\n     * Notifies CallStats for ice connection failed\r\n     */\r\n    sendIceConnectionFailedEvent() {\r\n        CallStats._reportError(\r\n            this,\r\n            wrtcFuncNames.iceConnectionFailure,\r\n            null,\r\n            this.peerconnection);\r\n    }\r\n\r\n    /**\r\n     * Notifies CallStats that peer connection failed to create offer.\r\n     *\r\n     * @param {Error} e error to send\r\n     */\r\n    sendCreateOfferFailed(e) {\r\n        CallStats._reportError(\r\n            this, wrtcFuncNames.createOffer, e, this.peerconnection);\r\n    }\r\n\r\n    /**\r\n     * Notifies CallStats that peer connection failed to create answer.\r\n     *\r\n     * @param {Error} e error to send\r\n     */\r\n    sendCreateAnswerFailed(e) {\r\n        CallStats._reportError(\r\n            this, wrtcFuncNames.createAnswer, e, this.peerconnection);\r\n    }\r\n\r\n    /**\r\n     * Sends either resume or hold event for the fabric associated with\r\n     * the underlying peerconnection.\r\n     * @param {boolean} isResume true to resume or false to hold\r\n     */\r\n    sendResumeOrHoldEvent(isResume) {\r\n        CallStats._reportEvent(\r\n            this,\r\n            isResume ? fabricEvent.fabricResume : fabricEvent.fabricHold);\r\n    }\r\n\r\n    /**\r\n     * Notifies CallStats for screen sharing events\r\n     * @param {boolean} start true for starting screen sharing and\r\n     * false for not stopping\r\n     * @param {string|null} ssrc - optional ssrc value, used only when\r\n     * starting screen sharing.\r\n     */\r\n    sendScreenSharingEvent(start, ssrc) {\r\n        let eventData;\r\n\r\n        if (ssrc) {\r\n            eventData = { ssrc };\r\n        }\r\n\r\n        CallStats._reportEvent(\r\n            this,\r\n            start ? fabricEvent.screenShareStart : fabricEvent.screenShareStop,\r\n            eventData);\r\n    }\r\n\r\n    /**\r\n     * Notifies CallStats that peer connection failed to set local description.\r\n     *\r\n     * @param {Error} e error to send\r\n     */\r\n    sendSetLocalDescFailed(e) {\r\n        CallStats._reportError(\r\n            this, wrtcFuncNames.setLocalDescription, e, this.peerconnection);\r\n    }\r\n\r\n    /**\r\n     * Notifies CallStats that peer connection failed to set remote description.\r\n     *\r\n     * @param {Error} e error to send\r\n     */\r\n    sendSetRemoteDescFailed(e) {\r\n        CallStats._reportError(\r\n            this, wrtcFuncNames.setRemoteDescription, e, this.peerconnection);\r\n    }\r\n\r\n    /**\r\n     * Notifies CallStats that peer connection failed to add ICE candidate.\r\n     *\r\n     * @param {Error} e error to send\r\n     */\r\n    sendAddIceCandidateFailed(e) {\r\n        CallStats._reportError(\r\n            this, wrtcFuncNames.addIceCandidate, e, this.peerconnection);\r\n    }\r\n}\r\n\r\n/**\r\n * The CallStats API backend instance\r\n * @type {callstats}\r\n */\r\nCallStats.backend = null;\r\n\r\n// some errors/events may happen before CallStats init\r\n// in this case we accumulate them in this array\r\n// and send them to callstats on init\r\nCallStats.reportsQueue = [];\r\n\r\n/**\r\n * Whether the library was successfully initialized(the backend) using its\r\n * initialize method.\r\n * @type {boolean}\r\n */\r\nCallStats.backendInitialized = false;\r\n\r\n/**\r\n * Part of the CallStats credentials - application ID\r\n * @type {string}\r\n */\r\nCallStats.callStatsID = null;\r\n\r\n/**\r\n * Part of the CallStats credentials - application secret\r\n * @type {string}\r\n */\r\nCallStats.callStatsSecret = null;\r\n\r\n/**\r\n * Local CallStats user ID structure. Can be set only once when\r\n * {@link backend} is initialized, so it's static for the time being.\r\n * See CallStats API for more info:\r\n * https://www.callstats.io/api/#userid\r\n * @type {object}\r\n */\r\nCallStats.userID = null;\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/statistics/CallStats.js","/*! callstats.js  version = 3.27.0 2017-12-14 */\n\"use strict\";!function(){function a(){function a(){var a=(Math.random()+1).toString(36);return a.substring(2,a.length)}function b(){return window.performance.now?window.performance.now()+window.performance.timing.navigationStart:Date.now()}function c(){var a=b();return a+bb.currentOffset}function d(a){if(!$a||!$a.rtc_rtp_parameters||!$a.rtc_rtp_parameters.encodings)return void a.streams.forEach(function(a){var b=a.data;\"video\"===b.mediaType&&a.streamType===ub.outbound&&(b.csioSCSValidationSampleCount=null,b.csioAvgMaxBitrateDiff=null,b.csioAvgDeltaThroughput=null,b.csioMaxBitrateAboveRatio=null,b.csioCCDrivenRatio=null)});var b=function(a){return Sb[a]?Sb[a]:(Sb[a]={total:0,above:0,ccDriven:0,sumMaxBitrateDiff:0,sumThroughputDiff:0,prevCsioAvgBRKbps:0},Sb[a])},c=function(a,c,d,e,f){var g=b(a.ssrc);a.csioSCSValidationSampleCount=++g.total,g.sumMaxBitrateDiff+=c,a.csioAvgMaxBitrateDiff=g.sumMaxBitrateDiff/g.total,g.sumThroughputDiff+=d,a.csioAvgDeltaThroughput=g.sumThroughputDiff/g.total,e&&(g.above+=1),a.csioMaxBitrateAboveRatio=g.above/g.total,f&&(g.ccDriven+=1),a.csioCCDrivenRatio=g.ccDriven/g.total},d=0;$a.rtc_rtp_parameters.encodings.forEach(function(a){a&&(d=Math.max(d,a.maxBitrate))});var e=0;if(_a){_a.encodings.forEach(function(a){e=Math.max(e,a.maxBitrate)});var f=0,g=0,h=null,i=null;a.streams.forEach(function(a){var j=a.data,k=b(j.ssrc);\"video\"===j.mediaType&&a.streamType===ub.outbound&&(0<e&&.9*e<1e3*j.csioAvgBRKbps?(f=d-e,i=!1):(f=d-1e3*j.csioAvgBRKbps,i=!0),h=0<f,g=j.csioAvgBRKbps-k.prevCsioAvgBRKbps,k.prevCsioAvgBRKbps=j.csioAvgBRKbps,c(j,f,g,h,i))})}}function e(){return window.performance.now?window.performance.now():null}function f(){navigator&&\"function\"==typeof navigator.getBattery&&navigator.getBattery().then(function(a){Xa=a})}function g(){if(Xa)return Xa.level}function h(){if(Xa)return Xa.charging}function i(a,b){return a.sort().toString()===b.sort().toString()}function j(a,b,c){navigator&&navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices&&navigator.mediaDevices.enumerateDevices().then(function(d){la?i(la,d)||(la=d,_b(a,b,c)):(la=d,_b(a,b,c)),setTimeout(function(){j(a,b,c)},sa)}).catch(function(){setTimeout(function(){j(a,b,c)},sa)})}function k(){Z&&Z().then(function(a){ka=JSON.parse(a),setTimeout(function(){k()},ta)}).catch(function(){setTimeout(function(){k()},ta)})}function l(){qa||window&&window.addEventListener&&window.addEventListener(\"beforeunload\",function(a){var b;for(b in ab)ab.hasOwnProperty(b)&&Xb(jb.userLeft,null,b,ab[b].ucID,null,null,null);return cb&&(bb.offsetResults=[],bb.syncHandler=null,cb=!1),\"Are you sure you want to close the call?\"})}function m(a,b,c,d,f){var g=kc(c,d),h=null;g&&(h=e(),Xb(jb.mediaPlaybackStartEvent,b,c,a,{ssrc:f,highResTs:h},g,null))}function n(a,b,c,d,f){var g=kc(c,d),h=null;g&&(h=e(),Xb(jb.mediaSuspendedEvent,b,c,a,{ssrc:f,highResTs:h},g,null))}function o(a,b,c,d){var e,f=document.getElementById(b);f&&(f.oncanplay=function(){e=ab[a].ucID;var b=jc(a,c);b&&m(e,b.remoteUserID,a,c,d)},f.onsuspend=function(){e=ab[a].ucID;var b=jc(a,c);b&&n(e,b.remoteUserID,a,c,d)})}function p(a){var b=Aa.codebase,c=!1;if(null===a)c=!1;else if(b===Fb.firefox){var d=typeof mozRTCPeerConnection,e=typeof RTCPeerConnection;\"undefined\"!==d&&a instanceof mozRTCPeerConnection?c=!0:\"undefined\"!==e&&a instanceof RTCPeerConnection&&(c=!0)}else null!==hb&&a instanceof hb&&(c=!0),\"function\"!=typeof a&&b!==Fb.edge||(c=!0),void 0!==typeof a.createOffer&&(c=!0);return c}function q(a,b){var c;return a&&(b===Fb.chrome?a.googLocalAddress?(c=a.googLocalAddress,c.concat(\":\",a.googRemoteAddress)):a.selectedCandidatePairId&&(c=a.selectedCandidatePairId):b===Fb.firefox&&(a.localAddr?(c=a.localAddr,c.concat(\":\",a.remoteAddr)):a.selectedCandidatePairId&&(c=a.selectedCandidatePairId))),cc(c)}function r(){var a;return a=navigator.onLine===!0?\"online\":\"offline\"}function s(a,b,c){var d=null;c.ssrcMap.hasOwnProperty(a.data.ssrc)&&(c.ssrcMap[a.data.ssrc].mediaType=a.data.mediaType,a.data.googCodecName?d=a.data.googCodecName:a.data.codec&&(d=a.data.codec),c.ssrcMap[a.data.ssrc].codec=d,a.data.codecImplementationName&&(c.ssrcMap[a.data.ssrc].codecImplementationName=a.data.codecImplementationName))}function t(a,b,c){var d,e,f,g,h,i,j,k,l=[];if(void 0!==a.lastStatsSent&&void 0!==a.lastStatsSent.statistics.Transport)for(f=a.lastStatsSent.statistics.Transport,g=a.latestEventSent,h=void 0,d=0;d<b.length;d++){for(h=void 0,e=0;e<f.length;e++)if(b[d].hash===f[e].hash){h=f[e];break}void 0!==h&&(i=parseInt(h.bytesReceived,10),j=parseInt(h.bytesSent,10),k=c-g,k>0&&(b[d].csioReceivedBwKbps=8*(parseInt(b[d].bytesReceived,10)-i)/k,b[d].csioSentBwKbps=8*(parseInt(b[d].bytesSent,10)-j)/k,b[d].csioIntBytesReceived=parseInt(b[d].bytesReceived,10)-i,b[d].csioIntBytesSent=parseInt(b[d].bytesSent,10)-j,void 0!==h.packetsSent&&void 0!==b[d].packetsSent&&(b[d].csioSentPacketRate=(parseInt(b[d].packetsSent,10)-parseInt(h.packetsSent,10))/(k/1e3),b[d].csioIntPacketsSent=parseInt(b[d].packetsSent,10)-parseInt(h.packetsSent,10)),void 0!==h.packetsReceived&&void 0!==b[d].packetsReceived&&(b[d].csioReceivedPacketRate=(parseInt(b[d].packetsReceived,10)-parseInt(h.packetsReceived,10))/(k/1e3),b[d].csioIntPacketsReceived=parseInt(b[d].packetsReceived,10)-parseInt(h.packetsReceived,10))),l.push(b[d]))}return l}function u(a,b,c,d){var e=[];return c===Fb.firefox?e=b:b&&(e=t(a,b,d)),e}function v(a){var b,c,d;for(b in a.streams)if(a.streams.hasOwnProperty(b)){if(a.streams[b].inbound)for(d in a.streams[b].inbound)a.streams[b].inbound.hasOwnProperty(d)&&(c=a.streams[b].inbound[d].mark,c===wb.bad?a.streams[b].inbound[d].mark=2:c===wb.fair?a.streams[b].inbound[d].mark=1:a.streams[b].inbound[d].mark=0);if(a.streams[b].outbound)for(d in a.streams[b].outbound)a.streams[b].outbound.hasOwnProperty(d)&&(c=a.streams[b].outbound[d].mark,c===wb.bad?a.streams[b].outbound[d].mark=2:c===wb.fair?a.streams[b].outbound[d].mark=1:a.streams[b].outbound[d].mark=0)}return a}function w(a){var b={},c=od.getConferenceURL();return a.connectionState&&(b.connectionState=a.connectionState),a.fabricState&&(b.fabricState=a.fabricState),c&&(b.conferenceURL=c),b.streams={},null===a.streams?b:(a.streams.forEach(function(a){var c={cname:a.cname,ssrc:a.ssrc,msid:a.msid,remoteUserID:a.userID,usageLabel:a.usage,associatedVideoTag:a.associatedVideoTag};a.data.hasOwnProperty(\"csioIntFL\")&&(c.fractionLoss=a.data.csioIntFL),a.data.hasOwnProperty(\"csioIntBRKbps\")&&(c.bitrate=a.data.csioIntBRKbps),a.data.hasOwnProperty(\"csioMark\")&&(c.quality=a.data.csioMark),a.data.hasOwnProperty(\"csioMediaType\")&&(c.mediaType=a.data.csioMediaType),a.data.hasOwnProperty(\"googRtt\")&&(c.rtt=a.data.googRtt),a.data.hasOwnProperty(\"mozRtt\")&&(c.rtt=a.data.mozRtt),a.data.hasOwnProperty(\"roundTripTime\")&&(c.rtt=a.data.roundTripTime),a.data.hasOwnProperty(\"jitter\")&&(c.jitter=a.data.jitter),a.data.hasOwnProperty(\"googJitterReceived\")&&(c.jitter=a.data.googJitterReceived),a.data.hasOwnProperty(\"audioOutputLevel\")&&(c.audioOutputLevel=a.data.audioOutputLevel),a.data.hasOwnProperty(\"audioInputLevel\")&&(c.audioInputLevel=a.data.audioInputLevel),a.data.hasOwnProperty(\"audioLevel\")&&(c.audioLevel=a.data.audioLevel),a.data.hasOwnProperty(\"csioAvgRtt\")&&(c.averageRTT=a.data.csioAvgRtt),a.data.hasOwnProperty(\"csioAvgJitter\")&&(c.averageJitter=a.data.csioAvgJitter),a.data.hasOwnProperty(\"csioPktLossPercentage\")&&(c.packetLossPercentage=a.data.csioPktLossPercentage),a.reportType&&\"local\"===a.reportType?a.streamType&&(c.statsType=a.streamType+\"-rtp\"):a.reportType&&\"remote\"===a.reportType&&a.streamType&&(c.statsType=\"remote-\"+a.streamType+\"-rtp\"),b.streams[a.ssrc]=c}),b)}function x(a,b,d,e,f,g){var h=c();a.hasOwnProperty(\"token\")&&a.hasOwnProperty(\"ucID\")&&!cb?(S(kb.processedStats,a,g),b.latestEventSent=h,b.lastFabricState=b.pcState):(a.clockUnsynced=cb,Oa.cacheEvent({channel:kb.processedStats,data:a}))}function y(a,b){for(var c in b)b.hasOwnProperty(c)&&\"id\"!==c&&\"type\"!==c&&\"timestamp\"!==c&&(a[c]=b[c]);return a}function z(a,e,f,i,j){function k(k){if(k){var l=c(),m=b();void 0===i.lastRawStatsSentInterval||null===i.lastRawStatsSentInterval?i.lastRawStatsSentInterval=m-i.statsPollingStart:i.lastRawStatsSentInterval=m-i.rawstatsTS+i.lastRawStatsSentInterval,void 0===i.lastProcessedStatsSentInterval||null===i.lastProcessedStatsSentInterval?i.lastProcessedStatsSentInterval=Fa+1:i.lastProcessedStatsSentInterval=m-i.rawstatsTS+i.lastProcessedStatsSentInterval,i.rawstatsTS=m;var n={},o=Aa.codebase,p=i.conferenceID,t=i.remoteUserID;n.version=da,n.appID=ma,n.conferenceID=encodeURIComponent(p),n.apiTS=l,n.timeShift=0,n.fabricState=i.pcState,n.pcID=i.pcHash,void 0!==f&&(n.ucID=f),Ua.authToken&&(n.token=Ua.authToken),n.localID=encodeURIComponent(e),n.remoteID=t?encodeURIComponent(t):null,n.deviceID=pa;var y,z,A,C,G,H,J,K={streams:[]},L=null,M=!1,N=!1,O={},P={};for(L=nc(k),y=0;y<L.length;++y)if(z=E(L[y]),A=B(z),!F(A))if(A.hasOwnProperty(\"Transport\"))C=\"Transport\",K.hasOwnProperty(C)||(K[C]=[]),o!==Fb.firefox?(parseInt(A[C].bytesReceived,10)>0||parseInt(A[C].bytesSent,10)>0)&&(K[C].push(A[C]),\"true\"!==A[C].googActiveConnection&&A[C].googActiveConnection!==!0||(n.activeConnectionIndex=K[C].length)):(K[C].push(A[C]),\"true\"!==A[C].selected&&A[C].selected!==!0||(n.activeConnectionIndex=K[C].length));else if(A.localCandidate)O[A.localCandidate.id]=A.localCandidate;else if(A.remoteCandidate)P[A.remoteCandidate.id]=A.remoteCandidate;else if(A.bwe)K.bwe=A.bwe;else if(A.trackStats)K.trackStats||(K.trackStats=[]),K.trackStats.push(A.trackStats);else if(A.codec)K.codec||(K.codec=[]),K.codec.push(A.codec);else if(A.candidatePair)K.candidatePair||(K.candidatePair=[]),K.candidatePair.push(A.candidatePair);else{H=Ub(i,A.ssrc),void 0!==H&&H.localStartTime||(J=Wb(t,p,f,i,j,null),J&&(N=!0),H=Ub(i,A.ssrc)),H&&(G=H.remoteUserID),void 0===G&&(G=t);var Q={userID:G,data:A.data,reportType:A.reportType,streamType:A.streamType,ssrc:A.ssrc};void 0!==H&&(Q.cname=H.cname,Q.msid=H.msid,Q.associatedVideoTag=H.associatedVideoTag,Q.usage=H.usageLabel),K.streams.push(Q)}if(n.statistics=K,K.Transport&&(M=D(K.Transport,i)),M&&cd(j,jb.fabricTransportSwitch,p),K.Transport||o!==Fb.firefox||(K.Transport=K.candidatePair.filter(function(a){return!(!a.selected&&\"true\"!==a.selected)})),K.Transport)for(var R=0;R<K.Transport.length;R++)K.Transport[R].hash=q(K.Transport[R],o);i.pcState===xb.disrupted&&I(n),K.trackStats&&(K=hd(K)),K.Transport&&K.candidatePair&&(K=gd(K)),N&&Xb(jb.ssrcMap,t,p,f,Vb(i),i.pcHash),Za&&(Xb(kb.senderConfiguration,t,p,f,$a,i.pcHash),Za=!1);var S={},T={response:null},V={response:null},W={response:null},X=null;if(ja.fire(ja.events.OnPolling,{streams:K.streams,codeBase:o}),ja.fire(ja.events.OnOneWayAudioDisruptionsRequest,V),null!==V.response&&V.response.forEach(function(a){X={mediaType:a.mediaType,ssrc:a.ssrc,disruptionType:a.type},Xb(jb.oneWayMedia,t,p,f,X,i.pcHash)}),ja.fire(ja.events.OnSendingThroughputObservationsRequest,W),null!==W.response&&(X=W.response,Xb(kb.sendingThroughputObservations,t,p,f,X,i.pcHash)),ja.fire(ja.events.OnStatsRequest,T),null!==T.response){if(T.response.streams)for(y=0;y<T.response.streams.length;y++)s(T.response.streams[y],o,i);S.streams=T.response.streams;for(var Y=0<Ma.length,Z=0,$=function(a){a.data.ssrc===Z&&(Y|=\"audio\"===a.mediaType&&a.streamType===ub.inbound)};0<Ma.length;)Z=Ma.shift(),S.streams.forEach($);if(Y){var _={mediaType:\"audio\",ssrc:null,disruptionType:vb.noInboundAudioOnlyFabric};Xb(jb.oneWayMedia,t,p,f,_,i.pcHash)}if(S.fabricState=i.pcState,S.connectionState=r(),K.Transport&&(S.Transport=u(i,K.Transport,o,l)),K.bwe&&(S.bwe=K.bwe),void 0===i.processedStatsTupleArray&&(i.processedStatsTupleArray=[]),Da.stats){var aa=w(S);Da.stats(aa)}S.apiTS=l,S.batteryStatus={},S.batteryStatus.batteryLevel=g(),S.batteryStatus.isBatteryCharging=h(),S.wifiStats=ka,S=v(S),d(S),i.processedStatsTupleArray.push(S),n.processedStatistics=i.processedStatsTupleArray,i.lastStatsSent=n;var ba=U(n);delete ba.statistics,i.lastProcessedStatsSentInterval>=Fa&&(i.processedStatsTupleArray=[],Ra.add(ba,ba.processedStatistics.length),ba.msgStat=Ra.getStat(),x(ba,i,p,t,e,a),i.lastProcessedStatsSentInterval=0)}}}return k}function A(a){var b;return yb.hasOwnProperty(a)?a===yb.createOffer||a===yb.createAnswer||a===yb.setRemoteDescription?b=zb.negotiationFailure:a===yb.setLocalDescription?b=zb.sdpError:a===yb.addIceCandidate?b=zb.sdpError:a===yb.getUserMedia?b=zb.mediaConfigError:a===yb.iceConnectionFailure?b=zb.iceFailure:a===yb.signalingError?b=zb.signalingError:(a===yb.applicationLog||yb.applicationError)&&(b=zb.applicationLog):b=Pb.invalidWebRTCFunctionName,b}function B(a){var b={};if(\"inboundrtp\"===a.type||\"outboundrtp\"===a.type||\"inbound-rtp\"===a.type||\"outbound-rtp\"===a.type){if(b.ssrc=a.ssrc,b.streamType=\"inboundrtp\"===a.type||\"inbound-rtp\"===a.type?\"inbound\":\"outbound\",\"Safari\"===Aa.name&&!a.mediaType){a.id.includes(\"Audio\")?a.mediaType=\"audio\":a.id.includes(\"Video\")&&(a.mediaType=\"video\");var c=a.id.split(\"_\");if(c[1])try{a.ssrc=parseInt(c[1]),b.ssrc=a.ssrc}catch(a){}}b.data=a,void 0!==a.isRemote?b.reportType=\"true\"===a.isRemote||a.isRemote===!0?\"remote\":\"local\":b.reportType=\"local\",a.trackId&&(b.trackId=a.trackId),a.mediaType&&(b.mediaType=a.mediaType)}else\"candidatepair\"===a.type&&a.selected?b.Transport=a:\"localcandidate\"===a.type||\"local-candidate\"===a.type?b.localCandidate=a:\"remotecandidate\"===a.type||\"remote-candidate\"===a.type?b.remoteCandidate=a:\"transport\"===a.type||\"googCandidatePair\"===a.type?b.Transport=a:\"VideoBwe\"===a.type?b.bwe=a:\"track\"===a.type?b.trackStats=a:\"candidate-pair\"===a.type?b.candidatePair=a:\"codec\"===a.type?b.codec=a:\"ssrc\"===a.type&&(b.reportType=\"local\",a.bytesSent?b.streamType=\"outbound\":b.streamType=\"inbound\",b.ssrc=a.ssrc,b.data=a);return b}function C(a){var b=\"None\";switch(a){case 0:b=\"TURN/TLS\";break;case 1:b=\"TURN/TCP\";break;case 2:b=\"TURN/UDP\"}return b}function D(a,b){var c,d,e,f,g,h,i,j,k,l=!1,m=\"None\",n=!1,o=Aa.codebase,p=function(a){if(a.typePreference){var b=a.typePreference>>24;return\"rtp\"===a.protocol&&a.address===c&&(b>=0&&b<=2&&(m=C(b)),!0)}return!1};for(i=0;i<a.length;i++)if(j=a[i],o!==Fb.firefox||\"candidatepair\"!==j.type||\"true\"!==j.selected&&j.selected!==!0?\"googCandidatePair\"!==j.type||\"true\"!==j.googActiveConnection&&j.googActiveConnection!==!0?\"transport\"===j.type&&(n=!0,j.selectedCandidatePairId&&(k=j.selectedCandidatePairId)):(n=!0,c=j.googLocalAddress,d=j.googRemoteAddress,e=j.googLocalCandidateType,f=j.googRemoteCandidateType,g=j.googTransportType):(n=!0,c=j.localAddr,d=j.remoteAddr,e=j.localAddrType,f=j.remoteAddrType,g=j.transportType),n){c&&(h=0===c.indexOf(\"[\")),b.iceCandidates.some(p);break}if(!n)return l;var q=b.transportData;return void 0!==q&&q.localAddr===c&&q.remoteAddr===d&&q.transportType===g&&q.selectedCandidatePairId===k||(b.transportData={localAddr:c,remoteAddr:d,localAddrType:e,remoteAddrType:f,transportType:g,ipv6:h,relayType:m,selectedCandidatePairId:k},l=!0),l}function E(a){var b,c={};a.timestamp instanceof Date&&(c.timestamp=a.timestamp.getTime().toString()),a.type&&(c.type=a.type);var d=0;if(a.names){var e=a.names();for(d=0;d<e.length;++d)c[e[d]]=a.stat(e[d])}else for(b in a)a.hasOwnProperty(b)&&(c[b]=a[b]);if(c.values){for(d=0;d<c.values.length;++d){a=c.values[d];for(b in a)a.hasOwnProperty(b)&&(c[b]=a[b])}delete c.values}return c}function F(a){if(null===a)return!0;if(a.length>0)return!1;if(0===a.length)return!0;var b;for(b in a)if(a.hasOwnProperty(b))return!1;return!0}function G(a){return{magicKey:a,statsSubmissionInterval:Fa,endpoint:Ya,localUserIDObject:oa}}function H(a,b,c){var d=ab[a];void 0===d&&(ab[a]={},ab[a].participants=null,c&&(ab[a].userJoinedSent=!0),b&&(ab[a].refreshPresence=b))}function I(a){var b,c=a.statistics.outbound;if(void 0!==c)for(b in c)c.hasOwnProperty(b)&&(c[b].data.mozRtt?c[b].data.mozRtt=0:c[b].data.googRtt?c[b].data.googRtt=0:c[b].data.rtt?c[b].data.rtt=0:c[b].data.roundTripTime&&(c[b].data.roundTripTime=0))}function J(a){return clearInterval(a),null}function K(){var a;for(a in ab)ab.hasOwnProperty(a)&&(ab[a].refreshPresence=J(ab[a].refreshPresence),delete ab[a].refreshPresence);W()}function L(a){var b=!1;if(!a)return b;var c=ab[a];return void 0!==c&&c.participants&&c.participants.length>0&&(b=!0),b}function M(a,b){var c=ab[a],d=[];if(void 0===c)d.push(b),ab[a]={},ab[a].participants=d;else{var e=c.participants;null===e?(d.push(b),c.participants=d):e.push(b)}}function N(a){var b=!1;if(!ab[a])return{conferenceFinished:b,ucID:null};var c=ab[a].ucID;return 0===ab[a].participants.length&&(J(ab[a].refreshPresence),W(),Oa.sendCachedEvents(Ua,cb),delete ab[a],b=!0),{conferenceFinished:b,ucID:c}}function O(a,b){Xb(jb.userLeft,null,a,b,null,null,null),W(),db=Rb,Rb=null}function P(){var a,b=function(a){return setInterval(function(){ac(a)},Ha)};for(a in ab)if(ab.hasOwnProperty(a)){if(a===ia)return;ac(a),ab[a].refreshPresence=b(a)}X()}function Q(){bb.syncHandler||(Ob(ma,na,\"log\",{msg:\"start clockSync\"}),bb.offsetResults=[],ld(),bb.syncHandler=!0)}function R(a){try{if(window&&window.sessionStorage){var b=JSON.parse(window.sessionStorage.getItem(\"csio_ucid_data\"));if(b&&b[a])return b[a].ucID}}catch(a){return null}return null}function S(a,b,c){var d=b.action,e=b.remoteID,f=b.ucID;b.channel=a,Ua._isTokenValid(Ua.authToken,ma,na)?(f&&!cb&&e||Hb.indexOf(d)!==-1)&&b.conferenceID!==ia?(b.token=Ua.authToken,pd(a,b,c),c&&d&&c(nb.success,d+\" sent to the backend.\")):(b.clockUnsynced=cb,Oa.cacheEvent({channel:a,data:b,callback:c})):Ua.sendAuthenticationRequest(ma,na,function(g,h){g!==nb.success?(g===ob.authOngoing&&(b.clockUnsynced=cb,Oa.cacheEvent({channel:a,data:b,callback:c})),c&&g!==ob.authOngoing&&c(g,h)):g===nb.success&&\"SDK authentication successful.\"===h&&((f&&!cb&&e||Hb.indexOf(d)!==-1)&&b.conferenceID!==ia?(b.token=Ua.authToken,pd(a,b,c),c&&d&&c(nb.success,d+\" sent to the backend.\")):(b.clockUnsynced=cb,Oa.cacheEvent({channel:a,data:b,callback:c})))})}function T(a){a&&a(ob.authOngoing,\"Authentication Ongoing\")}function U(a){var b;if(null===a||\"object\"!=typeof a)return a;if(a instanceof Array){b=[];for(var c=0,d=a.length;c<d;c++)b[c]=U(a[c]);return b}if(a instanceof Object){b={};for(var e in a)a.hasOwnProperty(e)&&(b[e]=U(a[e]));return b}}function V(){var a={};Object.keys(ab).forEach(function(b){var c=ab[b];if(!c)return!0;var d,e,f={ucID:c.ucID,userJoinedSent:c.userJoinedSent},g=[];if(c.participants){var h,i=c.participants;for(d=0;d<i.length;d++)e={},h=i[d],e={pcID:h.pcHash,pcState:h.pcState,iceConnectionState:h.iceConnectionState,iceGatheringState:h.iceGatheringState,iceCandidatesNumber:h.iceCandidates.length,remoteUserID:h.remoteUserID},g.push(e)}f.participants=g,a[b]=f});var b={authStatus:!!Ua.tokenData,clockSync:!cb,stateMachine:a,pageURL:window.location.href,eventType:\"warn\",version:da};b.wsStatus=od.getWSConnectionState(),Ob(ma,na,\"stateMachine\",b)}function W(){eb||(eb=setInterval(function(){V()},fb))}function X(){J(eb),eb=null}function Y(){Array.prototype.find||Object.defineProperty(Array.prototype,\"find\",{value:function(a){if(null===this)throw new TypeError(\"Array.prototype.find called on null or undefined\");if(\"function\"!=typeof a)throw new TypeError(\"predicate must be a function\");for(var b,c=Object(this),d=c.length>>>0,e=arguments[1],f=0;f<d;f++)if(b=c[f],a.call(e,b,f,c))return b}})}var Z,$=require(\"./callstatsUtils\"),_=require(\"./statsReporter\"),aa=require(\"./pcCallbackHandler\"),ba=\"https://collector.callstats.io:443/\",ca=\"https://auth.callstats.io/\",da=\"3.27.0\",ea=\"wss://collector.callstats.io:443/csiows/collectCallStats\",fa=\"https://dashboard.callstats.io/apps/\",ga=\"https://dashboard.callstats.io/api-internal/v1/qmodelthresholds\",ha=\"https://appsettings.callstats.io/v1/apps/\",ia=\"csio-conf-id-tmp\",ja=new _.Reporter,ka=null;window&&(window.csioChromeLegacyGetStats=!0);var la,ma=null,na=null,oa=null,pa=null,qa=!1,ra=!1,sa=1e4,ta=1e4,ua=1e3,va=\"\",wa=function(a,b){var c=\"precalltest error (\"+a+\"): \"+b;console.warn(c),Ob&&Ob(ma,na,\"log\",{msg:c}),va+=\"(error)\"},xa=require(\"precalltest\"),ya=null;try{ya=new xa.PreCallTest}catch(a){wa(\"initializing\",a)}var za,Aa,Ba=[],Ca={create:Date.now()},Da={stats:null,defaultConfig:null,recommendedConfig:null,preCallTest:null},Ea=2e4,Fa=15e3,Ga=!1,Ha=1e4,Ia=5e3,Ja=2e3,Ka=!0,La=!0,Ma=[],Na=function(){function a(a,b){setTimeout(function(){var b=c(),d=b-a.data.apiTS;a.data.timeShift=d,S(a.channel,a.data,a.callback)},b)}this.eventCache=[],this.updateRemoteUserID=function(a,b){for(var c,d=this,e=0;e<d.eventCache.length;e++)c=d.eventCache[e],c.data.pcID===b&&(c.data.remoteID=a)},this.sendCachedEvents=function(b,d,e,f,g,h){var i=this;if(0!==i.eventCache.length){if(!b.authToken)return void b.sendAuthenticationRequest(ma,na);if(!d){var j,k,l,m,n=c(),o=[],p=Math.max(Fa/i.eventCache.length,gb);for(j=0;j<i.eventCache.length;j++)if(l=i.eventCache[j],!l.data.remoteID&&l.data.pcID||l.data.conferenceID===ia)o.push(i.eventCache[j]);else if(l.data.action!==jb.userJoined){if(l.data.token=b.authToken,e&&l.data.apiTS>=n-f||!l.data.ucID)if(m=decodeURIComponent(l.data.conferenceID),ab[m]&&ab[m].ucID)l.data.ucID=ab[m].ucID;else{if(m!==g){o.push(i.eventCache[j]);continue}l.data.ucID=h}if(l.data.clockUnsynced&&(l.data.apiTS+=bb.currentOffset),l.channel===kb.processedStats&&l.data.clockUnsynced&&l.data.processedStatistics&&l.data.processedStatistics.length>0)for(k=0;k<l.data.processedStatistics.length;k++)l.data.processedStatistics[k].apiTS+=bb.currentOffset;delete l.data.clockUnsynced,a(l,p*(j+1))}else o.push(i.eventCache[j]);i.eventCache=o}}},this.sendCachedUserJoinedEvents=function(b){var c=this;if(0!==c.eventCache.length){if(!b.authToken)return void b.sendAuthenticationRequest(ma,na);var d,e,f=[],g=Math.max(Fa/c.eventCache.length,gb);for(d=0;d<c.eventCache.length;d++)e=c.eventCache[d],!e.data.remoteID&&e.data.pcID||e.data.conferenceID===ia?f.push(c.eventCache[d]):e.data.action===jb.userJoined||e.data.action===ib.fabricSetupFailed?(e.data.token=b.authToken,e.data.clockUnsynced&&(e.data.apiTS=e.data.apiTS+bb.currentOffset),e.data.value&&(e.data.value.statsSubmissionInterval=Fa),a(e,g*(d+1))):f.push(c.eventCache[d]);c.eventCache=f}},this.updateConferenceId=function(a){for(var b,c=this,d=0;d<c.eventCache.length;d++)b=c.eventCache[d],b.data.conferenceID===ia&&(b.data.conferenceID=a)},this.cacheEvent=function(a){this.eventCache.push(a)},this.sendCachedFeedback=function(){var a=Jb(\"feedback\"),b=JSON.parse(Jb(\"csio_auth_data\"));if(a&&b){var c=JSON.parse(a),d=b===c.token;d||na!==c.userID||(c.token=b,d=!0),d?S(kb.userFeedback,c):Kb(\"feedback\")}}},Oa=new Na,Pa=function(){this.size_max=0,this.size_ewma=0,this.statNum_max=0,this.statNum_ewma=0,this.msg_num=0,this.maxInterval=0,this.minInterval=0,this.avgInterval=0,this.stdInterval=0},Qa=function(){this.stat=new Pa,this.lastTime=null,this.samplesCount=0,this.add=function(a,c){var d=this.memorySizeOf(a);if(this.stat.size_ewma=.5*this.stat.size_ewma+.5*d,this.stat.size_max<d&&(this.stat.size_max=d),this.stat.statNum_ewma=.5*this.stat.statNum_ewma+.5*c,this.stat.statNum_max<c&&(this.stat.statNum_max=c),this.stat.msg_num+=1,null===this.lastTime)return void(this.lastTime=b());var e=b()-this.lastTime;this.lastTime=b(),(0===this.stat.maxInterval||this.stat.maxInterval<e)&&(this.maxInterval=e),(0===this.stat.minInterval||e<this.stat.minInterval)&&(this.minInterval=e),this.stat.avgInterval=(this.stat.avgInterval*this.samplesCount+e)/(this.samplesCount+c),this.samplesCount+=c,this.stat.stdInterval=(31*this.stat.stdInterval+Math.abs(this.stat.avgInterval-e))/32},this.getStat=function(){return this.stat},this.memorySizeOf=function(a){function b(a){if(null!==a&&void 0!==a)switch(typeof a){case\"number\":c+=8;break;case\"string\":c+=2*a.length;break;case\"boolean\":c+=4;break;case\"object\":var d=Object.prototype.toString.call(a).slice(8,-1);if(\"Object\"===d||\"Array\"===d)for(var e in a)a.hasOwnProperty(e)&&b(a[e]);else c+=2*a.toString().length}return c}var c=0;return b(a)}},Ra=new Qa,Sa={appSecret:\"appSecret\",jwt:\"jwt\"},Ta=function(){var a=this,b=\"urn:x-callstats:auth:errorActions\",d=.9;this.authInProgress=!1,this.tokenData=null,this.authToken=null,this.type=Sa.appSecret,this.tokenGenerator=function(a,b){b(\"Token generator not set\")};var e=null,f=null,g=!1,h=window.atob,i=window.btoa,j=[\"Authentication Internal Error\",\"Invalid Credentials\",\"Invalid Credentials\",\"Invalid Credentials\",\"Invalid Credentials\",\"Origin URL missmatch\",\"Invalid Credentials\",\"Authentication Protocol Error\"],k=function(a){return i(encodeURIComponent(a).replace(/%([0-9A-F]{2})/g,function(a,b){return String.fromCharCode(\"0x\"+b)}))},l=function(a){return i(a).replace(/\\+/g,\"-\").replace(/\\//g,\"_\").replace(/\\=+$/,\"\")},m=function(a){return k(a).replace(/\\+/g,\"-\").replace(/\\//g,\"_\").replace(/\\=+$/,\"\")},n=function(a){for(var b=h(a.replace(/[ \\r\\n]+$/,\"\")),c=[],d=0;d<b.length;++d){var e=b.charCodeAt(d).toString(16);1===e.length&&(e=\"0\"+e),c.push(e)}return c.join(\"\")},o={};o.cryptotype=null,window.crypto&&window.crypto.subtle?(o.cryptotype=\"standard\",o.subtlecrypto=window.crypto.subtle):window.crypto&&!window.crypto.subtle&&window.crypto.webkitSubtle?(o.cryptotype=\"webkit\",o.subtlecrypto=window.crypto.webkitSubtle):window.msCrypto&&window.msCrypto.subtle?(o.cryptotype=\"ie\",o.subtlecrypto=window.msCrypto.subtle):(o.subtlecrypto=null,console.info(\"WebCryptography API not supported in this browser.\")),o.sign=function(a,b,c,d){if(\"HS256\"!==a.alg)return d(\"Use header.alg=HS256\");a=JSON.stringify(a),\"string\"!=typeof b&&(b=JSON.stringify(b));var e=m(a)+\".\"+m(b);if(window.csioReactNative)return void window.csiosign(e,c,function(a,b){return a?(console.log(\"Token sign error\",a),d(a)):d(null,b)});for(var f=new ArrayBuffer(e.length),g=new Uint8Array(f),h=e.length-1;h>=0;h--)g[h]=e.charCodeAt(h);var i=function(a){for(var b=\"\",c=new Uint8Array(a),f=c.byteLength,g=0;g<f;g++)b+=String.fromCharCode(c[g]);return e+=\".\"+l(b),d(null,e)},j=function(a){return d(a)},k={name:\"HMAC\"};\"ie\"!==o.cryptotype&&\"webkit\"!==o.cryptotype||(k.hash={name:\"sha-256\"});var n=o.subtlecrypto.sign(k,c,g);\"ie\"===o.cryptotype?(n.onerror=j,n.oncomplete=function(a){i(a.target.result)}):n.then(i).catch(j)},o.decode=function(a){try{return JSON.parse(h(a.split(\".\")[1]))}catch(a){return console.error(\"Couldn't decode token. \",a),null}},o.importKey=function(a,b,c){if(window.csioReactNative)return void b(a);if(\"webkit\"===o.cryptotype)for(;a.length<32;)a+=\"\\0\";var d={kty:\"oct\",k:l(a),alg:\"HS256\"},e={name:\"HMAC\",hash:{name:\"SHA-256\"}};if(\"ie\"===o.cryptotype?d.extractable=!1:d.ext=!1,\"webkit\"===o.cryptotype&&(e=null,d.use=\"sig\"),\"ie\"===o.cryptotype||\"webkit\"===o.cryptotype){var f=JSON.stringify(d);d=new Uint8Array(f.length);for(var g=0;g<f.length;g++)d[g]=f.charCodeAt(g)}var h=o.subtlecrypto.importKey(\"jwk\",d,e,!1,[\"sign\"]);\"ie\"===o.cryptotype?(h.onerror=c,h.oncomplete=function(a){b(a.target.result)}):h.then(b).catch(c)},this.setAuthType=function(a){this.type=a},this._isTokenValid=function(a,b,d){var e=!1,f=Aa.codebase;if(null===a)return!1;try{var g=o.decode(a);if(null!==g&&g.appID===b&&g.userID===encodeURIComponent(d)){var h=null;if(f===Fb.firefox){var i=g.expiry.split(\" \").join(\"T\");h=Date.parse(i)}else h=new Date(g.expiry);var j=new Date(c());j<h&&(e=!0)}return e}catch(a){}return!1},this.setupAuthToken=function(a){Ib(\"csio_auth_data\",JSON.stringify(a)),this.authToken=a,this.tokenData=o.decode(a),Fa=parseInt(this.tokenData.submissionInterval,10),ja.setSubmissionInterval(Fa),ja.setReportingMode(this.tokenData.adaptiveInterval),Ga=this.tokenData.collectSDP},this.sendAuthenticationRequest=function(c,f,h){if(c&&f){if(a.authInProgress)return void T(h);null!==e&&(clearTimeout(e),e=null),p(),a.authInProgress=!0,a.tokenGenerator(g,function(i,j){if(null!==i)return a.authInProgress=!1,void(h&&h(nb.tokenGenerationError,i.toString()));var k=ca+\"authenticate\",l={client_id:f+\"@\"+ma,code:j,grant_type:\"authorization_code\"};jd(k,l,function(i,j){var k=null;a.authInProgress=!1,Ca.auth=j;try{k=JSON.parse(i.response)}catch(a){console.error(\"Authentication response parse error\")}if(!k)return void(e=setTimeout(a.sendAuthenticationRequest,Ia,c,f,h));if(200===i.status){if(\"bearer\"!==k.token_type)return console.error(\"Authentication was successful, but token type was not bearer. Scheduling retry.\"),void(e=setTimeout(a.sendAuthenticationRequest,Ia,c,f,h));a.setupAuthToken(k.access_token);var l=parseInt(1e3*parseInt(k.expires_in)*d);if(q(l,c,f,h),g=!1,h&&h(nb.success,\"SDK authentication successful.\"),k.iceServers&&!ra&&ya)try{va=k.iceServers[0].username+\" \",ya.start(k.iceServers,gc.bind(this)),Ob(ma,na,\"log\",{msg:\"precalltest started \"+va}),va+=\"(started)\"}catch(a){wa(\"start\",a),ya.crashDisconnect()}ra&&(Ob(ma,na,\"log\",{msg:\"precalltest disabled \"+va}),va+=\"(disabled)\"),hc(),od._isChannelReady()?(Oa.sendCachedUserJoinedEvents(Ua),h&&h(nb.success,\"WebSocket establishment successful.\")):od._setupWebSocketConnection(function(a,b){h&&h(a,b)})}else{if(k[b]&&k[b].length>0)return r(c,f,h,k[b],a.type);console.error(\"Authentication failed, but no error actions were defined in response.\"),e=setTimeout(a.sendAuthenticationRequest,Ia,c,f,h)}})})}};var p=function(){null!==f&&(clearTimeout(f),f=null)},q=function(b,c,d,e){p(),f=setTimeout(function(){a.sendAuthenticationRequest(c,d,e)},b)},r=function(a,b,c,d,e){if(0!==d.length){var f=d.shift();if(f.action===Qb.RETRY)return e===Sa.jwt&&q(f.params.timeout,a,b,c),r(a,b,c,d);if(f.action===Qb.GET_NEW_TOKEN)return g=!0,r(a,b,c,d);if(f.action===Qb.REPORT_ERROR){var h=\"Authentication Error\";return f.params&&f.params.errorCode>=0&&(h=j[f.params.errorCode]),c&&c(nb.authError,h),r(a,b,c,d)}}};this.appSecretTokenGenerator=function(b){var c=null,d=null,e=!1,f=null;b.indexOf(\":\")>-1&&(f=n(b.split(\":\")[0]),b=b.split(\":\")[1]);var g=function(a){b=null,c=a},h=function(a){e=!0,b=null,console.error(\"Couldn't import key\",a)};return o.importKey(b,g,h),function(b,g){if(e)return g(\"appsecret based token generation failed\");if(!b&&null!==d)return g(null,d);if(null===c)return setTimeout(function(){a.tokenGenerator(b,g)},100);var h={userID:na,appID:ma};f&&(h.keyID=f),o.sign({alg:\"HS256\"},h,c,function(a,b){return a?g(a):(d=b,g(null,b))})}}},Ua=new Ta,Va=new $;try{Aa=Va.detectBrowserInfo()}catch(a){console.log(\"detectBrowserInfo: Error\",a)}var Wa;window.csioReactNative||(Wa=Va.measureAppLoadingPerformance(Aa),Ca.loading=Wa);var Xa,Ya={type:\"browser\",name:Aa.name,ver:Aa.ver,os:Aa.os,osVersion:Aa.osVersion,userAgent:Aa.userAgent},Za=!1,$a=null,_a=null,ab={},bb={currentOffset:0,offsetResults:[],syncStartTime:null,syncAttempts:5,syncHandler:null,maxAllowedLatency:6e4},cb=!0,db=null,eb=null,fb=2e4,gb=100,hb=null;\"Firefox\"===Aa.name?hb=mozRTCPeerConnection:\"Chrome\"===Aa.name||\"Opera\"===Aa.name?hb=webkitRTCPeerConnection:\"Safari\"===Aa.name?console.log(\"Browser type Safari\"):\"Edge\"===Aa.name&&(hb=window.RTCPeerConnection);var ib={fabricSetupFailed:\"fabricSetupFailed\",fabricHold:\"fabricHold\",fabricResume:\"fabricResume\",audioMute:\"audioMute\",audioUnmute:\"audioUnmute\",videoPause:\"videoPause\",videoResume:\"videoResume\",fabricUsageEvent:\"fabricUsageEvent\",fabricTerminated:\"fabricTerminated\",screenShareStart:\"screenShareStart\",screenShareStop:\"screenShareStop\",dominantSpeaker:\"dominantSpeaker\",userIDChangedEvent:\"userIDChangedEvent\",activeDeviceList:\"activeDeviceList\",applicationErrorLog:\"applicationErrorLog\"},jb={autoFabricSetup:\"autoFabricSetup\",userJoined:\"userJoined\",userLeft:\"userLeft\",refreshPresence:\"userAlive\",ssrcMap:\"ssrcMap\",mediaPlaybackStartEvent:\"mediaPlaybackStartEvent\",mediaSuspendedEvent:\"mediaSuspendedEvent\",oneWayMedia:\"oneWayMedia\",fabricStateChange:\"fabricStateChange\",iceDisruptionStart:\"iceDisruptionStart\",iceDisruptionEnd:\"iceDisruptionEnd\",fabricTransportSwitch:\"fabricTransportSwitch\",iceConnectionDisruptionStart:\"iceConnectionDisruptionStart\",iceConnectionDisruptionEnd:\"iceConnectionDisruptionEnd\",iceAborted:\"iceAborted\",iceTerminated:\"iceTerminated\",iceFailed:\"iceFailed\",iceRestarted:\"iceRestarted\",fabricDropped:\"fabricDropped\",connectedDevices:\"connectedDevices\",iceCompleted:\"iceCompleted\",iceCandidateFound:\"iceCandidateFound\"},kb={sdpSubmission:\"sdpSubmissionEvent\",rtpStats:\"rtpStats\",processedStats:\"processedStats\",callStatsEvent:\"callStatsEvent\",userFeedback:\"userFeedbackEvent\",clockSync:\"clockSync\",preCallTest:\"preCallTest\",senderConfiguration:\"senderConfiguration\",\nsendingThroughputObservations:\"sendingThroughputObservations\"},lb={results:\"preCallTestResults\",associate:\"preCallTestAssociate\"},mb={success:\"success\",failure:\"failure\"},nb={httpError:\"httpError\",authError:\"authError\",wsChannelFailure:\"wsChannelFailure\",success:\"success\",csProtoError:\"csProtoError\",appConnectivityError:\"appConnectivityError\",tokenGenerationError:\"tokenGenerationError\",ok:\"OK\"},ob={authOngoing:\"authOngoing\"},pb={peer:\"peer\",server:\"server\"},qb={sendonly:\"sendonly\",receiveonly:\"receiveonly\",sendrecv:\"sendrecv\",inactive:\"inactive\"},rb={audio:\"audio\",video:\"video\",data:\"data\",screen:\"screen\",multiplex:\"multiplex\",unbundled:\"unbundled\"},sb={local:\"local\",remote:\"remote\"},tb={excellent:5,good:4,fair:3,poor:2,bad:1},ub={local:\"local\",remote:\"remote\",inbound:\"inbound\",outbound:\"outbound\"},vb={noAudioInMultiplexFabric:\"noAudioInMultiplexFabric\",noOutboundAudioOnlyFabric:\"noOutboundAudioOnlyFabric\",noInboundAudioOnlyFabric:\"noInboundAudioOnlyFabric\"},wb={excellent:\"excellent\",fair:\"fair\",bad:\"bad\"},xb={established:\"established\",initializing:\"initializing\",failed:\"failed\",disrupted:\"disrupted\",checkingDisrupted:\"checkingDisrupted\"},yb={createOffer:\"createOffer\",createAnswer:\"createAnswer\",setLocalDescription:\"setLocalDescription\",setRemoteDescription:\"setRemoteDescription\",addIceCandidate:\"addIceCandidate\",getUserMedia:\"getUserMedia\",iceConnectionFailure:\"iceConnectionFailure\",signalingError:\"signalingError\",applicationError:\"applicationError\",applicationLog:\"applicationLog\"},zb={mediaConfigError:\"MediaConfigError\",negotiationFailure:\"NegotiationFailure\",sdpError:\"SDPGenerationError\",iceFailure:\"IceConnectionFailure\",transportFailure:\"TransportFailure\",signalingError:\"SignalingError\",applicationError:\"ApplicationError\",applicationLog:\"ApplicationLog\"},Ab={video:{gThreshold:1024,rThreshold:256},audio:{gThreshold:30,rThreshold:8}},Bb={video:{gThreshold:.8,rThreshold:.3}},Cb={video:{gThreshold:400,rThreshold:1e3}},Db={video:{gThreshold:10,rThreshold:50},audio:{gThreshold:15,rThreshold:30}},Eb={audio:{gThreshold:240,rThreshold:400}},Fb={chrome:\"Chrome\",firefox:\"Firefox\",edge:\"Edge\"},Gb={signalingState:\"signalingState\",iceConnectionState:\"iceConnectionState\",iceGatheringState:\"iceGatheringState\"},Hb=[jb.userJoined,jb.refreshPresence,ib.fabricSetupFailed],Ib=function(a,b){try{window&&window.localStorage&&window.localStorage.setItem(a,b)}catch(a){return}},Jb=function(a){try{if(window&&window.localStorage)return window.localStorage.getItem(a)}catch(a){return null}return null},Kb=function(a){try{window&&window.localStorage&&window.localStorage.removeItem(a)}catch(a){return}},Lb=function(){if(pa=Jb(\"endpointID\"),null===pa){var a=b(),c=Math.random()*a;Ac(c.toString(),function(a){pa=a,Ib(\"endpointID\",pa)})}},Mb=function(a,c,d,e,f){var g=null,h=null,i=null,j=new XMLHttpRequest;if(\"Microsoft Internet Explorer\"!==Aa.name&&(j.timeout=d),j){j.open(\"GET\",encodeURI(a));for(var k in c)j.setRequestHeader(k,c[k]);g=b(),j.onload=function(){h=b(),i=h-g,e(j,i)},j.ontimeout=f,j.send()}},Nb=function(a,b,c,d){var e=new XMLHttpRequest;if(e){if(e.open(\"POST\",encodeURI(a)),e.setRequestHeader(\"Content-Type\",\"application/json\"),d)for(var f in d)e.setRequestHeader(f,d[f]);e.onload=function(){c(e)},e.send(b)}},Ob=function(a,c,d,e){if(Ka&&a){var f=ba+\"generics\",g={appID:a,timestamp:b(),userID:encodeURIComponent(c),version:da,eventType:d,data:e},h=JSON.stringify(g);za!==h&&(za=h,Nb(f,h,function(a){200===a.status?console.log(\"Got generic response: %o\",a.response):200!==a.status&&console.log(\"Got error for generic request %o, %s\",a,a.status)}))}};window&&window.addEventListener&&window.addEventListener(\"error\",function(a){if(a&&a.filename&&a.filename.indexOf(\"callstats\")>-1){var b,c=!1,d={fileName:a.filename,line:a.lineno,col:a.colno,jsVersion:da,eventType:\"error\",message:a.message,pageURL:window.location.href};for(b in ab)ab.hasOwnProperty(b)&&(d.conferenceID=b,Ob(ma,na,\"onErrorLog\",d),c=!0);c||Ob(ma,na,\"onErrorLog\",d)}});var Pb={invalidWebRTCFunctionName:\"Invalid WebRTC function name\"},Qb={RETRY:0,GET_NEW_TOKEN:1,REPORT_ERROR:2},Rb=a(),Sb=Object.create(null),Tb=function(a,d,e){var f=RegExp.prototype.test.bind(/^([a-z])=(.*)/),g=/^ssrc:(\\d*) ([\\w_]*):(.*)/,h=/^ssrc-group:SIM (\\d*)/;d.split(/(\\r\\n|\\r|\\n)/).filter(f).forEach(function(d){var f=d[0],i=d.slice(2);if(\"a\"===f){if(g.test(i)){var j=i.match(g),k=j[1];void 0===a.ssrcMap[k]&&(a.ssrcMap[k]={}),a.ssrcMap[k][j[2]]=j[3],a.ssrcMap[k].localStartTime=b(),a.ssrcMap[k].syncedStartTime=c(),a.ssrcMap[k].streamType=e}h.test(i)&&(void 0===a.ssrcMap.ssrcGroup&&(a.ssrcMap.ssrcGroup={},a.ssrcMap.ssrcGroup[e]={}),a.ssrcMap.ssrcGroup[e].simulcastGroup=i.match(/\\d+/g))}})},Ub=function(a,b){return a.ssrcMap[b]},Vb=function(a){return a.ssrcMap},Wb=function(a,b,c,d,e,f){if(!e.localDescription||!e.remoteDescription)return!1;var g=e.localDescription.sdp,h=e.remoteDescription.sdp;if(!g||!h||g===d.localSDP&&h===d.remoteSDP)return!1;if(Tb(d,g,ub.outbound),Tb(d,h,ub.inbound),Ga){var i={sdp:{}};i.sdp.localSDP=g!==d.localSDP?g:-1,i.sdp.remoteSDP=h!==d.remoteSDP?h:-1,Zb(a,b,c,i,d.pcHash,f)}return d.localSDP=g,d.remoteSDP=h,!0},Xb=function(a,b,d,e,f,g,h){if(!a)return void console.error(\"sendEvent: Invalid eventType \");var i=c(),j={version:da,apiTS:i,action:a,localID:encodeURIComponent(na),remoteID:b?encodeURIComponent(b):null,conferenceID:encodeURIComponent(d),timeShift:0,appID:ma,ucID:e,pcID:g,deviceID:pa,value:f};return null===d?void Ob(ma,na,\"log\",{msg:\"conferenceID is null in sendEvent for \"+a}):void S(kb.callStatsEvent,j,h)},Yb=function(a,b,d,e){if(!a)return void console.error(\"sendEvent: Invalid eventType \");var f=c(),g={version:da,channel:kb.preCallTest,timestamp:f,apiTS:f,action:a,eventType:a,localID:encodeURIComponent(na),remoteID:encodeURIComponent(na),conferenceID:encodeURIComponent(b),timeShift:0,appID:ma,ucID:d,deviceID:pa,token:Ua.authToken};return a===lb.results&&(g.results=e,null==b)?void pd(kb.preCallTest,g):(a===lb.associate&&(g.ids=e),void(d&&!cb?S(kb.preCallTest,g):(g.clockUnsynced=cb,Oa.cacheEvent({channel:kb.preCallTest,data:g,callback:null}))))},Zb=function(a,b,d,e,f,g){var h=c(),i={version:da,appID:ma,conferenceID:encodeURIComponent(b),ucID:d,apiTS:h,localID:encodeURIComponent(na),remoteID:encodeURIComponent(a),pcID:f,deviceID:pa,sdpPayload:e,action:kb.sdpSubmission};Ua.authToken&&d&&!cb?(i.token=Ua.authToken,S(kb.sdpSubmission,i,g)):(i.clockUnsynced=cb,Oa.cacheEvent({channel:kb.sdpSubmission,data:i,callback:g}),Ua.authToken||Ua.sendAuthenticationRequest(ma,na))},$b=function(a,b,c,d,e,f,g){sc(a,function(a){b.localCandidates=a.localCandidates,b.remoteCandidates=a.remoteCandidates,b.iceCandidatePairs=a.iceCandidatePairs,b.activeIceCandidatePair=Nc(b.iceCandidatePairs),g.currPair=b.activeIceCandidatePair,Xb(jb.fabricStateChange,e,c,d,g,f)})},_b=function(a,b,c){var d={connectedDevices:la},e=ab[a]?ab[a].ucID:null;Xb(jb.connectedDevices,b,a,e,d,c)},ac=function(a){var b={ucID:ab[a].ucID,endpoint:Ya,magicKey:Rb};Xb(jb.refreshPresence,null,a,ab[a].ucID,b,null)},bc=function(a,b){var c={};return c.status=a,b&&(c.message=b),c},cc=function(a,b){var c,d,e,f=0;if(!a)return f;for(c=0,e=a.length;c<e;c++)d=a.charCodeAt(c),f=(f<<5)-f+d,f|=0;return b&&b(f),f},dc=function(a,c,d,e,f,g){if(!a||!d||!c)return console.error(\"initialize: Argument missing/invalid\"),bc(mb.failure,\"initialize: Argument missing/invalid\");if(e&&\"function\"!=typeof e)return console.error(\"initialize: Argument missing/invalid\"),bc(mb.failure,\"initialize: Argument missing/invalid\");if(f&&\"function\"!=typeof f)return console.error(\"initialize: Argument missing/invalid\"),bc(mb.failure,\"initialize: Argument missing/invalid\");if(Ua.setAuthType(Sa.jwt),\"function\"!=typeof c){if(Ua.setAuthType(Sa.appSecret),!(window.crypto&&(window.crypto.subtle||window.crypto.webkitSubtle)||window.msCrypto&&window.msCrypto.subtle||window.csioReactNative))return console.error(\"Browser does not support Web Cryptography API. App secret based authentication requires Web Cryptography API\"),e&&e(nb.tokenGenerationError,\"Browser does not support Web Cryptography API. App secret based authentication requires Web Cryptography API\"),bc(mb.failure,\"Browser does not support Web Cryptography API. App secret based authentication requires Web Cryptography API\");c=Ua.appSecretTokenGenerator(c)}if(\"string\"==typeof a&&(a=parseInt(a,10)),ma=a,isNaN(ma))return bc(mb.failure,\"Invalid Credentials\");if(\"object\"==typeof d?(na=d.aliasName,oa=d):na=d,Ca.initializeSinceCreate=b()-Ca.create,Ob(ma,na,\"log\",{msg:\"callstats initialize in progress\"}),g&&(g.disableBeforeUnloadHandler===!0&&(qa=!0),null!==g.applicationVersion&&void 0!==g.applicationVersion&&(Ya.appVer=uc(g.applicationVersion,30)),g.disablePrecalltest===!0&&(ra=!0)),Ua.tokenGenerator=c,Jb(\"csio_auth_data\"))try{var h=JSON.parse(Jb(\"csio_auth_data\"));Ua._isTokenValid(h,ma,na)&&(e&&e(nb.success,\"SDK authentication successful.\"),Ua.setupAuthToken(h),hc(),od._isChannelReady()||od._setupWebSocketConnection(e))}catch(a){console.log(\"initialize: Error\",a)}l(),f&&(Da.stats=f);try{Ua.sendAuthenticationRequest(ma,na,e)}catch(a){console.log(\"initialize: Error\",a)}return bc(mb.success)},ec=function(){Ca.sent||(Ca.remoteofferSinceCreate&&Ca.config&&Ca.senderConfig||Ca.errorSinceCreate)&&(console.log(\"Send generic event for timing\"),Ob(ma,na,\"timing\",Ca),Ca.sent=!0)},fc=function(a,b){\"function\"==typeof b&&Da.hasOwnProperty(a)&&(Da[a]=b)},gc=function(a){Ob(ma,na,\"log\",{msg:\"precalltest finished \"+va}),va+=\"(finished)\",Da.preCallTest&&Da.preCallTest(a);try{Ba.push(a.id);var b=null,c=null;for(var d in ab)if(ab.hasOwnProperty(d)){b=d,ab[d].ucID&&(c=ab[d].ucID);break}Yb(lb.results,b,c,a)}catch(a){wa(\"send results\",a)}},hc=function(){var a=ha+ma,b={Authorization:\"Bearer \"+Ua.authToken},c=Ja,d=function(a,b){200!==a.status&&setTimeout(function(){f()},100),Ca.config=b,ec();var c=JSON.parse(a.response);if(console.log(\"internal config:\",c),c.submissionInterval&&(Fa=parseInt(c.submissionInterval,10),ja.setSubmissionInterval(Fa)),c.adaptiveStats&&ja.setReportingMode(c.adaptiveStats),c.collectSDP&&(Ga=c.collectSDP),c.qmodelThresholdsAPI){var d=c.qmodelThresholdsAPI;id(\"eModelThreshold\",d,Eb),id(\"throughputThreshold\",d,Ab),id(\"fractionalLossThreshold\",d,Db),id(\"rttThreshold\",d,Cb),id(\"currOverPrevFrameRateThreshold\",d,Bb)}},e=function(a){200!==a.status&&setTimeout(function(){g()},100);var b=JSON.parse(a.response),c=function(a,b){var c={};return b&&(c={peerConnection:null,media:null}),a.peerConnection&&(c.peerConnection=a.peerConnection),a.media&&(c.media=a.media),a.sender&&(c.sender=a.sender),a.confidence&&(c.confidence=a.confidence),c};if(Da.defaultConfig&&b.default){var d=c(b.default,!0);d!=={}&&Da.defaultConfig(d)}if(Da.recommendedConfig&&b.recommended){var e=c(b.recommended,!1);e!=={}&&Da.recommendedConfig(e)}},f=function(){Mb(a+\"/configurations/internal\",b,c,d,f)},g=function(){Mb(a+\"/configurations\",b,c,e,g)};f(),g()},ic=function(a){return function(b){return b.pc===a||(!(!a.callstatsID||b.pcHash!==a.callstatsID)||void 0)}},jc=function(a,b){var c=null,d=null;return ab[a]&&ab[a].participants&&(d=ab[a].participants.filter(ic(b))),c=d&&d.length>0?d[0]:null},kc=function(a,b){var c=null,d=null;return c=jc(a,b),c&&(d=c.pcHash),d},lc=function(a){var b=null,c=null,d=null;for(b in ab)if(ab.hasOwnProperty(b)&&(d=jc(b,a))){c={fabric:d,conferenceID:b};break}return c},mc=function(a,b){var c=0;if(a&&ab[b].participants)for(c=0;c<ab[b].participants.length;c++)if(ab[b].participants[c].pcHash===a.pcHash){ab[b].participants.splice(c,1);break}},nc=function(a){if(a){var b=[],c=0;if(a&&a.result)b=a.result();else if(a&&a.forEach)a.forEach(function(a){b.push(a)});else for(c in a)a.hasOwnProperty(c)&&b.push(a[c]);return b}},oc=function(a){var b,c=null,d=null,e=null,f=[],g=[],h=[],i=0;if(c=nc(a),!c)return{localCandidates:f,remoteCandidates:g};for(i=0;i<c.length;++i)if(d=E(c[i]),e=B(d),e.localCandidate)f.push(e.localCandidate);else if(e.remoteCandidate)g.push(e.remoteCandidate);else if(e.Transport){if(\"transport\"===e.Transport.type){b=e.Transport.selectedCandidatePairId;continue}h.push(e.Transport)}else e.candidatePair&&h.push(e.candidatePair);if(b)for(i=0;i<h.length;i++)h[i].id===b&&(h[i].googActiveConnection=\"true\");return{localCandidates:f,remoteCandidates:g,iceCandidatePairs:h}},pc=function(a){function b(b){var c={};c=oc(b),a(c)}return b},qc=function(a){var b=null;return a&&(b=a.message+\" : \"+a.stack),b},rc=function(a,b,c,d,e,f){var g=Aa.codebase,h=Aa.name;if(g===Fb.firefox)if(La)try{a.getStats().then(c(b,d,e,f,a)).catch(function(h){La=!1,Ob(ma,d,\"log\",{msg:\"### \"+g+\" getStats reports error \"+qc(h)}),a.getStats(null,c(b,d,e,f,a))})}catch(h){La=!1,Ob(ma,d,\"log\",{msg:\"### \"+g+\" getStats reports error \"+qc(h)}),a.getStats(null,c(b,d,e,f,a))}else a.getStats(null,c(b,d,e,f,a),function(a){console.log(\"getstats error \",a)});else if(\"Safari\"===h)a.getStats().then(c(b,d,e,f,a)).catch(function(a){Ob(ma,d,\"log\",{msg:\"### \"+g+\" getStats reports error \"+qc(a)})});else if(g===Fb.chrome)if(window&&window.csioReactNative)a.getStats(null,c(b,d,e,f,a),function(a){Ob(ma,d,\"log\",{msg:\"### \"+g+\" getStats reports error \"+qc(a)})});else if(La)try{a.getStats().then(c(b,d,e,f,a)).catch(function(h){La=!1,Ob(ma,d,\"log\",{msg:\"### \"+g+\" getStats reports error \"+qc(h)}),a.getStats(c(b,d,e,f,a))})}catch(h){La=!1,Ob(ma,d,\"log\",{msg:\"### \"+g+\" getStats reports error \"+qc(h)}),a.getStats(c(b,d,e,f,a))}else a.getStats(c(b,d,e,f,a));else g===Fb.edge&&a.getStats().then(c(b,d,e,f,a)).catch(function(a){Ob(ma,d,\"log\",{msg:\"### \"+g+\" getStats reports error \"+qc(a)})})},sc=function(a,b){try{rc(a,b,pc)}catch(a){console.log(\"csioGetStats: Error\",a)}},tc=function(a,b,c,d){if(c||(c=ia),!a||!b)return console.error(\"sendFabricEvent: Arguments missing/Invalid\"),bc(mb.failure,\"sendFabricEvent: Arguments missing/Invalid\");if(!ma||!na||!ab[c])return console.error(\"sendFabricEvent: SDK is not initialized or no Fabrics added.\"),bc(mb.failure,\"sendFabricEvent: SDK is not initialized or no Fabrics added.\");if(b===ib.fabricSetupFailed)return console.error(\"sendFabricEvent: Unsupported fabricEvent fabricSetupFailed\"),bc(mb.failure,\"sendFabricEvent: Unsupported fabricEvent fabricSetupFailed\");if(!p(a))return console.error(\"sendFabricEvent: Invalid PeerConnection object passed\"),bc(mb.failure,\"sendFabricEvent: Invalid PeerConnection object passed\");if(!ib.hasOwnProperty(b)&&!jb.hasOwnProperty(b))return console.error(\"sendFabricEvent: Invalid fabricEvents value: \",b),bc(mb.failure,\"sendFabricEvent: Invalid fabricEvents value: \"+b);var e={},f=null,g=ab[c],h=null;if(void 0===g)return console.error(\"sendFabricEvent: Conference ID not found!\"),bc(mb.failure,\"sendFabricEvent: Conference ID not found!\");if(h=jc(c,a),null===h)return console.error(\"sendFabricEvent: fabricData is null\"),bc(mb.failure,\"sendFabricEvent: fabricData is null\");if(f=h.remoteUserID,b===ib.activeDeviceList){if(!d||!d.deviceList)return console.error(\"sendFabricEvent: Arguments missing/Invalid\"),bc(mb.failure,\"sendFabricEvent: Arguments missing/Invalid\");if(!(d.deviceList instanceof Array))return console.error(\"sendFabricEvent: DeviceList Invalid\"),bc(mb.failure,\"sendFabricEvent: DeviceList Invalid\");e={magicKey:Rb,endpoint:Ya,activeDevicelist:d.deviceList}}if(b!==ib.screenShareStart&&b!==ib.screenShareStop||(e={magicKey:Rb,endpoint:Ya},d&&(e.ssrc=d.ssrc)),Xb(b,f,c,g.ucID,e,h.pcHash,h.pcCallback),b===ib.fabricTerminated){if(ab[c].participants){h&&(h.statsInterval=J(h.statsInterval),mc(h,c));var i=N(c);i.conferenceFinished&&O(c,i.ucID)}}else b===ib.fabricHold?(h.statsInterval=J(h.statsInterval),h.onHold=!0):b===ib.fabricResume&&(h.onHold=!1,Qc(h,a,c,f));return bc(mb.success)},uc=function(a,b){return a&&\"string\"==typeof a?(a.length>b&&(a=a.substring(0,b)),a):null},vc=function(a){return a&&\"string\"==typeof a?a=uc(a,Ea):a&&\"object\"==typeof a&&a.message&&(a.message=uc(a.message,Ea)),a},wc=function(a,b,c){return b?b:a&&a[c]?a[c].sdp:-1},xc=function(c,d,e,f,g,h){if(d||(d=ia),void 0===c||!e)return console.error(\"reportError: Arguments missing/invalid\"),bc(mb.error,\"reportError: Arguments missing/invalid\");if(!ma||!na)return console.error(\"reportError: SDK is not initialized\"),bc(mb.error,\"reportError: SDK is not initialized\");if(!yb.hasOwnProperty(e))return console.error(\"reportError: Invalid webRTC functionName value: %o\",e),bc(mb.error,\"reportError: Invalid webRTC functionName value: \"+e);void 0===f&&console.warn(\"reportError: Missing dom error parameter\");var i,j,k,l=null,m=b(),n=ab[d],o=null,q=m,r=null,s=null,t=null,u=null;if(t=R(d),j=A(e),e!==yb.getUserMedia&&(u=a()),f)if(window.DOMException&&f instanceof window.DOMException)f={message:f.message,name:f.name};else if(\"object\"==typeof f){var v={};f.message&&(v.message=f.message),f.name&&(v.name=f.name),f.constraintName&&(v.constraintName=f.constraintName),f.stack&&(v.stack=f.stack),f=v}if(f=vc(f),p(c)){n&&(t=n.ucID),o=jc(d,c),o?(i=o.remoteUserID,q=o.startTime,r=o.pcState,s=o.pc.iceConnectionState,u=o.pcHash,k=o.pcCallback):i=na;var w=m-q;if(l={failureDelay:w,reason:j,domError:f,fabricState:r,iceConnectionState:s,function:e,magicKey:Rb,endpoint:Ya},e===yb.applicationLog||e===yb.applicationError?Xb(ib.applicationErrorLog,i,d,t,l,u,k):(Xb(ib.fabricSetupFailed,i,d,t,l,u,k),Ca.errorSinceCreate=b()-Ca.create,ec()),g||h||c&&c.localDescription||c&&c.remoteDescription){var x={sdp:{}};x.sdp.localSDP=wc(c,g,\"localDescription\"),x.sdp.remoteSDP=wc(c,h,\"remoteDescription\"),Zb(i,d,t,x,u)}}else null===Rb&&(Rb=a()),i=na,l={failureDelay:0,reason:j,domError:f,function:e,magicKey:Rb,endpoint:Ya},e===yb.applicationLog||e===yb.applicationError?Xb(ib.applicationErrorLog,i,d,t,l,null,null):Xb(ib.fabricSetupFailed,i,d,t,l,u,null);return bc(mb.success)},yc=function(a){for(var b=[],c=0;c<a.length;c++){var d=a.charCodeAt(c);d<128?b[b.length]=d:d>127&&d<2048?(b[b.length]=d>>6|192,b[b.length]=63&d|128):(b[b.length]=d>>12|224,b[b.length]=d>>6&63|128,b[b.length]=63&d|128)}return new Uint8Array(b).buffer},zc=function(a){for(var b,c=new DataView(a),d=\"\",e=0;e<c.byteLength;e++)b=c.getUint8(e).toString(16),b.length<2&&(b=\"0\"+b),d+=b;return d},Ac=function(a,b){var c={name:\"SHA-256\"};if(window.crypto){var d=window.crypto.subtle||window.crypto.webkitSubtle;if(!d)return void cc(a,b);d.digest(c,yc(a)).then(function(a){b(zc(a))}).catch(function(){cc(a,b)})}else if(window.msCrypto){if(!window.msCrypto.subtle)return void cc(a,b);var e=window.msCrypto.subtle.digest(c,yc(a));e.oncomplete=function(a){a.target&&b(zc(a.target.result))},e.onerror=function(){cc(a,b)}}else cc(a,b)},Bc=function(a,b,c){var d;if(!b||!a)return console.error(\"sendUserFeedback: Arguments missing/Invalid\"),bc(mb.error,\"sendUserFeedback: Arguments missing/Invalid\");if(\"object\"!=typeof b)return console.error(\"sendUserFeedback: Invalid feedback object.\"),bc(mb.error,\"sendUserFeedback: Invalid feedback object.\");if(0===Object.keys(b).length)return console.error(\"sendUserFeedback: Feedback data object must not be empty.\"),bc(mb.error,\"sendUserFeedback: Feedback data object must not be empty.\");var e=ab[a],f=null;void 0!==e&&void 0!==e.ucID&&(f=e.ucID);var g=null;if(g=null===Rb?db:Rb,null===f&&(f=R(a)),null===f)return console.error(\"sendUserFeedback: ucID unavailable\"),bc(mb.error,\"sendUserFeedback: ucID unavailable\");d=\"object\"==typeof b.userID?b.userID.aliasName:b.userID,b&&b.overall<=0&&(b.overall=null);var h={conferenceID:encodeURIComponent(a),magicKey:g,appID:ma,version:da,ucID:f,remoteID:encodeURIComponent(d),userID:encodeURIComponent(d),userQoe:{overall:b.overall}};return b.video&&(h.userQoe.video=b.video),b.audio&&(h.userQoe.audio=b.audio),b.screen&&(h.userQoe.screen=b.screen),b.comment&&(h.userQoe.comment=b.comment),Ua.authToken&&!cb?(h.token=Ua.authToken,Ib(\"feedback\",JSON.stringify(h)),S(kb.userFeedback,h,c)):(h.clockUnsynced=cb,Oa.cacheEvent({channel:kb.userFeedback,data:h,callback:c}),Ua.sendAuthenticationRequest(ma,d)),bc(mb.success)},Cc=function(a){return a?\"function\"!=typeof a?(console.error(\"attachWifiStatsHandler: Arguments Invalid\"),bc(mb.error,\"attachWifiStatsHandler: Arguments Invalid\")):(Z=a,void k()):(console.error(\"attachWifiStatsHandler: Arguments missing\"),bc(mb.error,\"attachWifiStatsHandler: Arguments missing\"))},Dc=function(a,b,c,d,e,f){var g=null;if(g=\"object\"==typeof b?b.aliasName:b,c||(c=ia),!(a&&d&&e&&g))return console.error(\"associateMstWithUserID: Arguments missing\"),bc(mb.error,\"associateMstWithUserID: Arguments missing\");if(!p(a))return console.error(\"associateMstWithUserID: Invalid PeerConnection object passed\"),bc(mb.error,\"associateMstWithUserID: Invalid PeerConnection object passed\");var h=ab[c];if(void 0===h)return console.error(\"associateMstWithUserID: conferenceID doesn't exist\"),bc(mb.error,\"associateMstWithUserID: conferenceID doesn't exist\");var i=null;if(i=jc(c,a),null===i)return console.error(\"associateMstWithUserID: Unknown pcObject passed\"),bc(mb.error,\"associateMstWithUserID: Unknown pcObject passed\");var j=Ub(i,d);return void 0===j&&(i.ssrcMap[d]={},j=Ub(i,d)),j.remoteUserID=g,j.ssrc=d,j.associatedVideoTag=f,j.usageLabel=e,f&&g!==na&&o(c,f,a,d),bc(mb.success)},Ec=function(a){var b=ab[ia];if(b){var c=ab[ia].participants;if(c)for(var d=0;d<c.length;d++)c[d].conferenceID=a}},Fc=function(a){Oa.updateConferenceId(encodeURIComponent(a))},Gc=function(a,b){var c=lc(b);c&&Oa.updateRemoteUserID(a,c.fabric.pcHash)},Hc=function(a,b){var c=null;c=lc(b),c&&(c.fabric.remoteUserID=a)},Ic=function(){Oa.sendCachedUserJoinedEvents(Ua),Oa.sendCachedEvents(Ua,cb)},Jc=function(a,b){return a?(a.conferenceID&&(Ec(a.conferenceID),ab[a.conferenceID]=ab[ia],Fc(a.conferenceID),Ic()),a.remoteUserID&&b&&(Gc(a.remoteUserID,b),Hc(a.remoteUserID,b),Ic()),bc(mb.success)):(console.error(\"setIdentifiers: Arguments missing/Invalid\"),bc(mb.error,\"_setIdentifiers: Arguments missing/Invalid\"))},Kc=function(a){return window&&!window.csioproxy?(console.error(\"setCallstatsURLs: cannot be called if window.csioproxy is false\"),bc(mb.error,\"setCallstatsURLs: cannot be called if window.csioproxy is false\")):a?(a.collectorURL&&(ba=a.collectorURL),a.authServiceURL&&(ca=a.authServiceURL),a.csioInternalAPIURL&&(ga=a.csioInternalAPIURL),a.wsURL&&(ea=a.wsURL),kd(),Q(),W(),bc(mb.success)):(console.error(\"setCallstatsURLs: Arguments missing/Invalid\"),bc(mb.error,\"setCallstatsURLs: Arguments missing/Invalid\"))},Lc=function(c,d,e,f,g,h){var i,k,l=null,m=pb.peer,n=qb.sendrecv,o={authStatus:!!Ua.tokenData,clockSync:!cb,msg:\"addNewFabric called\",eventType:\"warn\",pageURL:window.location.href,conferenceID:f,version:da};if(W(),Ob(ma,na,\"stateMachine\",o),l=d&&\"object\"==typeof d?d.aliasName:d,f||(f=ia),!c||!e)return console.error(\"addNewFabric: Arguments missing/Invalid\"),bc(mb.error,\"addNewFabric: Arguments missing/Invalid\");if(!ma||!na)return console.error(\"addNewFabric: SDK not initialized.\"),bc(mb.error,\"addNewFabric: SDK not initialized\");if(!p(c))return console.error(\"addNewFabric: Invalid PeerConnection object passed\"),bc(mb.error,\"addNewFabric: Invalid PeerConnection object passed\");if(!rb.hasOwnProperty(e)||e instanceof Function)return console.error(\"addNewFabric: Invalid fabricUsage value\"),bc(mb.error,\"addNewFabric: Invalid fabricUsage value\");if(h&&\"function\"==typeof h&&(i=h),g&&\"function\"==typeof g&&(i=g),g&&\"function\"!=typeof g){if(g.remoteEndpointType){if(!pb.hasOwnProperty(g.remoteEndpointType))return console.error(\"addNewFabric: Invalid remoteEndpointType value\"),bc(mb.error,\"addNewFabric: Invalid remoteEndpointType value\");m=g.remoteEndpointType}if(g.fabricTransmissionDirection){if(!qb.hasOwnProperty(g.fabricTransmissionDirection))return console.error(\"addNewFabric: Invalid fabricTransmissionDirection value\"),bc(mb.error,\"addNewFabric: Invalid fabricTransmissionDirection value\");n=g.fabricTransmissionDirection}}var q=b();Ca.addnewfabricSinceCreate=q-Ca.create,ec(),null===Rb&&(Rb=a());var r=null,s=!1;if(!L(f)){var t=G(Rb);Xb(jb.userJoined,null,f,null,t,null,null),s=!0,o={authStatus:!!Ua.tokenData,clockSync:!cb,msg:\"userJoined sent\",pageURL:window.location.href,eventType:\"warn\",conferenceID:f,version:da},Ob(ma,na,\"stateMachine\",o)}if(H(f,r,s),!jc(f,c)){if(c){new aa(c,_c,Zc,Pc,Yc)}k=a();var u={pc:c,remoteUserID:l,fabricUsage:e,magicKey:Rb,startTime:q,pcCallback:h,pcState:xb.initializing,fabricSetupSent:!1,iceCandidates:[],iceConnectionState:c.iceConnectionState,latestEventSent:q,pcHash:k,localSDP:-1,remoteSDP:-1,statsInterval:null,intervalAdaptionPhase:!0,gatheringIceCandidatesDelay:0,connectivityIceStatusDelay:0,numNegotiationNeededCalls:0,currentActivePhaseIndex:0,onHold:!1,ssrcMap:{},conferenceID:f,remoteEndpointType:m,fabricTransmissionDirection:n};Za&&(Xb(kb.senderConfiguration,d,f,null,$a,u.pcHash),Za=!1),\"function\"!=typeof c||c.callstatsID||(c.callstatsID=k),\"connected\"!==c.iceConnectionState&&\"completed\"!==c.iceConnectionState||(u.pcState=xb.established),M(f,u),u.pcState===xb.established&&(bd(c,jb.autoFabricSetup,f),Qc(u,c,f));var v=function(a){var b=0;return Object.keys(a).forEach(function(a){a&&a.mediaType&&(b+=\"audio\"===a.mediaType?1:0)}),0<b},w=function(){return!!u.ssrcMap&&v(u.ssrcMap)},x=function(){return!(!u.ssrcMap||n!==qb.sendonly)&&v(u.ssrcMap)},y=function(){return!!u.ssrcMap&&void Object.keys(u.ssrcMap).forEach(function(a){Ma.push(a)})},z=null;if(e===rb.multiplex&&w()?z={mediaType:\"audio\",ssrc:null,disruptionType:vb.noAudioInMultiplexFabric}:e===rb.audio&&x()?z={mediaType:\"audio\",ssrc:null,disruptionType:vb.noOutboundAudioOnlyFabric}:e===rb.audio&&n===qb.receiveonly&&y(),z){var A=ab[f]?ab[f].ucID:null;Xb(jb.oneWayMedia,l,f,A,z,u.pcHash)}}if(!k){var B=jc(f,c);k=B.pcHash}if(j(f,l,k),ya)try{var C=Ba;Ba=[];var D=null;if(D=ya.getId(),D&&C.push(D),C.length>0){var E=ab[f].ucID;Yb(lb.associate,f,E,C)}}catch(a){wa(\"send associate\",a)}return bc(mb.success)},Mc=function(a,b,c,d){if(!(a&&c&&d&&b))return console.error(\"reportUserIDChange: Arguments missing/Invalid\"),bc(mb.error,\"reportUserIDChange: Arguments missing/Invalid\");if(!ma||!na)return console.error(\"reportUserIDChange: SDK not initialized.\"),bc(mb.error,\"reportUserIDChange: SDK not initialized\");if(\"\"===c||\"\"===b)return console.error(\"reportUserIDChange: id or  conferenceID MUST not be empty\"),bc(mb.error,\"reportUserIDChange: id or  conferenceID MUST not be empty\");if(!p(a))return console.error(\"reportUserIDChange: Invalid PeerConnection object passed\"),bc(mb.error,\"reportUserIDChange: Invalid PeerConnection object passed\");var e,f=null,g=ab[b];if(void 0===g)return console.error(\"reportUserIDChange: Conference ID not found!\"),bc(mb.error,\"reportUserIDChange: Conference ID not found!\");var h=null;if(void 0===g.ucID)return console.error(\"reportUserIDChange: addNewFabric was not called\"),Ob(ma,na,\"log\",{msg:\"### reportUserIDChange: addNewFabric was not called\"}),bc(mb.error,\"reportUserIDChange: addNewFabric was not called\");if(h=g.ucID,f=jc(b,a),null===f)return console.error(\"reportUserIDChange: Invalid pcObject passed as argument\"),bc(mb.error,\"reportUserIDChange: Invalid pcObject passed as argument\");var i={id:c,idType:d};return Xb(ib.userIDChangedEvent,e,b,h,i,null,f.pcCallback),bc(mb.success)},Nc=function(a){var b=null;if(a&&a.length>0){var c=a.filter(function(a){return\"true\"===a.selected||\"true\"===a.googActiveConnection||a.selected===!0||a.googActiveConnection===!0});c.length>0&&(b=c[0])}return b},Oc=function(a){var c=b(),d=function(){Ca.senderConfig=-1,Ca.senderExists=!1,ec()},e=function(a){var d=JSON.parse(a.response);console.log(\"Sender config response:\",a.status,d);var e;d.recommended&&d.recommended.sender&&(e=d.recommended.sender,console.log(\"ConfigService, recommended SENDER info:\",e)),e&&($a=e,Za=!0),Ca.senderConfig=b()-c,Ca.senderExists=!!e,ec()},f=function(a){_a=a;var b=ha+ma+\"/configurations\",c={Authorization:\"Bearer \"+Ua.authToken},d={app_id:ma,local_id:na,rtc_rtp_parameters:a},f=JSON.stringify(d);Nb(b,f,e,c)},g=function(){var a={encodings:[{maxBitrate:0}]};f(a)};if(Object.keys(ab).length>1)return console.warn(\"Multiple PCs found, skipping\"),void d();if(!a.getSenders||\"function\"!=typeof a.getSenders)return console.warn(\"Get senders error\"),void g();var h,i=a.getSenders();for(var j in i){var k=i[j];if(\"object\"!=typeof k||!k.track||\"object\"!=typeof k.track||!k.track.kind)return console.warn(\"Access senders error\"),void d();if(\"video\"===k.track.kind){if(h)return console.warn(\"Multiple video sender, skipping\"),void d();h=k}}if(!h)return console.warn(\"No video sender found\"),void d();if(!h.getParameters||\"function\"!=typeof h.getParameters)return console.warn(\"Sender getParameters error\"),void g();var l=h.getParameters();return\"object\"!=typeof l?void d():(\"encodings\"in l||(l.encodings=[]),0===l.encodings.length&&l.encodings.push({maxBitrate:0}),void f(l))},Pc=function(a,c){if(a){var d,e=null;if(void 0!==c){var f=c.signalingState;if(e=lc(c),e&&e.fabric){d=e.fabric.signalingState,e.fabric.signalingState=f;var g=e.conferenceID,h=e.fabric,i=h.remoteUserID,j=ab[g].ucID,k={changedState:Gb.signalingState,prevState:d,newState:f};$b(c,h,g,j,i,h.pcHash,k),\"closed\"===f&&tc(c,ib.fabricTerminated,e.conferenceID),\"have-local-offer\"!==f&&\"have-local-pranswer\"!==f&&\"stable\"!==f||e.sentSenderConfigRequest||(console.log(f,\".. requesting sender config.\",e.sentSenderConfigRequest),e.sentSenderConfigRequest=!0,Oc(c))}if(\"closed\"===f&&ya)try{ya.callFinished()}catch(a){wa(\"callFinished\",a),ya.crashDisconnect()}if(\"have-remote-offer\"===f||\"stable\"===f){if(Ca.remoteofferSinceCreate=b()-Ca.create,ec(),ya)try{ya.callStarts()}catch(a){wa(\"callStarts\",a),ya.crashDisconnect()}Ob(ma,na,\"log\",{msg:\"precalltest told to stop \"+va}),va+=\"(stopped)\"}}}},Qc=function(a,c,d){if(!a.onHold){var e=c,f=d;null===a.statsInterval&&(a.statsPollingStart=b(),ad(e,f),a.statsInterval=setInterval(function(){ad(e,f)},ua))}},Rc=function(a,b,c,d,e,f){f.localCandidates=b.localCandidates,f.remoteCandidates=b.remoteCandidates,f.iceCandidatePairs=b.iceCandidatePairs,Xb(jb.iceFailed,c,d,e,f,b.pcHash,b.pcCallback)},Sc=function(a,b,c,d){var e=b.iceConnectionState,f=b.remoteUserID,g=ab[c],h={prevIceConnectionState:e,currIceConnectionState:a.iceConnectionState,currPair:b.activeIceCandidatePair,failureDelay:d};b.pcState=xb.failed,\"checking\"===e?Rc(a,b,f,c,g.ucID,h):\"completed\"===e||\"connected\"===e?Xb(jb.fabricDropped,f,c,g.ucID,h,b.pcHash,b.pcCallback):\"disconnected\"===e&&b.established?Xb(jb.fabricDropped,f,c,g.ucID,h,b.pcHash,b.pcCallback):\"disconnected\"===e&&Rc(a,b,f,c,g.ucID,h)},Tc=function(a,c,d,e){var f=c.iceConnectionState,g=c.remoteUserID,h=ab[d],i=b(),j={prevIceConnectionState:f,currIceConnectionState:a.iceConnectionState,prevPair:c.activeIceCandidatePair},k=c.pcState===xb.disrupted,l=\"completed\"===a.iceConnectionState;c.connectivityIceStatusDelay=e,c.established=!0,sc(a,function(a){if(c.localCandidates=a.localCandidates,c.remoteCandidates=a.remoteCandidates,c.iceCandidatePairs=a.iceCandidatePairs,c.activeIceCandidatePair=Nc(c.iceCandidatePairs),j.currPair=c.activeIceCandidatePair,j.disruptionDelay=i-c.disruptedTS,k)Xb(jb.iceDisruptionEnd,g,d,h.ucID,j,c.pcHash);else if(l){var b={};b.iceCandidatePairs=a.iceCandidatePairs,Xb(jb.iceCompleted,g,d,h.ucID,b,c.pcHash)}}),bd(c.pc,jb.autoFabricSetup,d),c.pcState=xb.established,Qc(c,a,d,g)},Uc=function(a,c,d){var e=c.iceConnectionState,f=c.remoteUserID,g=ab[d],h=b(),i={prevIceConnectionState:e,currIceConnectionState:a.iceConnectionState,prevIceConnectionStateTs:c.iceConnectionStateTS,currPair:c.activeIceCandidatePair};c.startTime=h,\"connected\"===e||\"completed\"===e?(c.pcState=xb.disrupted,c.disruptedTS=h,Xb(jb.iceDisruptionStart,f,d,g.ucID,i,c.pcHash,c.pcCallback),c.pcCallback&&c.pcCallback(nb.appConnectivityError,\"Connectivity check for PC object to \"+f+\" failed.\")):\"checking\"===e&&(c.pcState=xb.checkingDisrupted,c.disruptedTS=h,Xb(jb.iceConnectionDisruptionStart,f,d,g.ucID,i,c.pcHash,c.pcCallback),c.pcCallback&&c.pcCallback(nb.appConnectivityError,\"Connectivity check for PC object to \"+f+\" failed.\"))},Vc=function(a,b,c,d){var e=b.iceConnectionState,f=b.remoteUserID,g=ab[c],h={prevIceConnectionState:e,currIceConnectionState:a.iceConnectionState};\"new\"===e||\"checking\"===e?(h.failureDelay=d,Xb(jb.iceAborted,f,c,g.ucID,h,b.pcHash,b.pcCallback)):(h.currPair=b.activeIceCandidatePair,\nXb(jb.iceTerminated,f,c,g.ucID,h,b.pcHash,b.pcCallback))},Wc=function(a,b,c){var d=b.iceConnectionState,e=b.remoteUserID,f=ab[c],g={prevIceConnectionState:d,currIceConnectionState:a.iceConnectionState,prevPair:b.activeIceCandidatePair};\"new\"!==d&&(b.established=!1,Xb(jb.iceRestarted,e,c,f.ucID,g,b.pcHash,b.pcCallback))},Xc=function(a,c,d,e){var f=c.iceConnectionState,g=c.remoteUserID,h=ab[d],i=b(),j={prevIceConnectionState:f,currIceConnectionState:a.iceConnectionState};c.gatheringIceCandidatesDelay=e,\"disconnected\"===f&&c.pcState===xb.checkingDisrupted&&(j.disruptionDelay=i-c.disruptedTS,Xb(jb.iceConnectionDisruptionEnd,g,d,h.ucID,j,c.pcHash,c.pcCallback))},Yc=function(a,b){if(a&&void 0!==b){var c=null;c=lc(b),c&&c.fabric&&c.fabric.numNegotiationNeededCalls++}},Zc=function(a,c){if(a&&void 0!==c){var d,e,f,g,h,i=null,j=null;if(j=lc(c),j&&j.fabric){i=j.fabric,d=j.conferenceID,e=b(),f=e-i.startTime,g=i.iceConnectionState,h=i.iceGatheringState;var k=i.remoteUserID,l=ab[d].ucID,m={changedState:Gb.iceConnectionState,prevState:g,newState:c.iceConnectionState};if($b(c,i,d,l,k,i.pcHash,m),h!==c.iceGatheringState){var n={changedState:Gb.iceGatheringState,prevState:h,newState:c.iceGatheringState};$b(c,i,d,l,k,i.pcHash,n)}\"complete\"===c.iceGatheringState&&\"checking\"===c.iceConnectionState&&Xc(c,i,d,f),\"connected\"===c.iceConnectionState||\"completed\"===c.iceConnectionState?Tc(c,i,d,f):\"failed\"===c.iceConnectionState?Sc(c,i,d,f):\"disconnected\"===c.iceConnectionState?Uc(c,i,d):\"closed\"===c.iceConnectionState?Vc(c,i,d,f):\"new\"===c.iceConnectionState&&Wc(),i.iceConnectionState=c.iceConnectionState,i.iceGatheringState=c.iceGatheringState,i.iceConnectionStateTS=b()}}},$c=function(a,b){var c=lc(a);if(c&&c.fabric){var d=c.fabric,e=d.remoteUserID,f=c.conferenceID,g=ab[f].ucID;Xb(jb.iceCandidateFound,e,f,g,b,d.pcHash)}},_c=function(a,b){var c,d,e;if(void 0!==b){if(null!==a.candidate){var f=a.candidate.candidate;d=f.split(\" \");var g=\"1\"===d[1]?\"rtp\":\"rtcp\";\"0\"!==d[5]&&(e=d[4].indexOf(\":\")!==-1,c={transport:d[2],protocol:g,typePreference:d[3],address:e?\"[\"+d[4]+\"]:\"+d[5]:d[4]+\":\"+d[5],type:d[7],media:a.candidate.sdpMid})}var h=null;h=lc(b),sc(b,function(a){h.localCandidates=a.localCandidates,h.remoteCandidates=a.remoteCandidates,h.iceCandidatePairs=a.iceCandidatePairs,h.activeIceCandidatePair=Nc(h.iceCandidatePairs)}),h&&h.fabric&&(void 0!==c&&h.fabric.iceCandidates.indexOf(c)===-1&&h.fabric.iceCandidates.push(c),c&&h.fabric.fabricSetupSent&&$c(b,c))}},ad=function(a,b){if(!ab.hasOwnProperty(b))return void console.error(\"ConferenceID %o doesn't exist. Can't call getStats for it.\",b);if(\"closed\"===a.signalingState)return tc(a,ib.fabricTerminated,b),!0;var c=jc(b,a);if(c.pcState!==xb.established&&c.lastFabricState===c.pcState&&\"connected\"!==a.iceConnectionState&&\"completed\"!==a.iceConnectionState)return!0;var d=ab[b].ucID;try{rc(a,c.pcCallback,z,na,d,c)}catch(a){console.log(\"csioGetStats: Error\",a)}},bd=function(a,c,d){var e,f=null,g=ab[d],h=null,i=b();if(void 0===g&&console.error(\"sendAutoFabricSetupEvent: Conference ID not found!\"),h=jc(d,a),null===h&&console.error(\"sendAutoFabricSetupEvent: fabricData is null\"),!h.fabricSetupSent){f=h.remoteUserID,e=i-h.startTime;var j={setupDelay:e,iceGatheringDelay:h.gatheringIceCandidatesDelay,iceConnectivityDelay:h.connectivityIceStatusDelay,remoteEndpointType:h.remoteEndpointType,fabricTransmissionDirection:h.fabricTransmissionDirection};cb||(j.clockSyncOffset=bb.currentOffset),sc(a,function(a){j.localCandidates=a.localCandidates,j.remoteCandidates=a.remoteCandidates,j.iceCandidatePairs=a.iceCandidatePairs,h.localCandidates=a.localCandidates,h.remoteCandidates=a.remoteCandidates,h.iceCandidatePairs=a.iceCandidatePairs,h.pcState=xb.established,h.activeIceCandidatePair=Nc(h.iceCandidatePairs),h.fabricSetupSent||(Xb(c,f,d,g.ucID,j,h.pcHash,h.pcCallback),h.fabricSetupSent=!0)})}},cd=function(a,b,c){var d={},e=null,f=ab[c],g=null;void 0===f&&console.error(\"sendFabricTransportSwitchEvent: Conference ID not found!\"),g=jc(c,a),null===g&&console.error(\"sendFabricTransportSwitchEvent: fabricData is null\"),e=g.remoteUserID,d.prevPair=g.activeIceCandidatePair,sc(a,function(a){d.currPair=Nc(a.iceCandidatePairs),g.activeIceCandidatePair=d.currPair,d.switchDelay=null,d.relayType=g.transportData.relayType,Xb(b,e,c,f.ucID,d,g.pcHash,g.pcCallback)})},dd=function(a,b){if(a.trackStats){var c=a.trackStats.filter(function(a){return a.id===b});if(c.length>0)return c[0]}},ed=function(a,b){if(a.codec){var c=a.codec.filter(function(a){return a.id===b});if(c.length>0)return c[0]}},fd=function(a,b){if(a.candidatePair){var c=a.candidatePair.filter(function(a){return a.id===b});if(c.length>0)return c[0]}},gd=function(a){for(var b,c,d=a.Transport.length,e=0;e<d;e++)c=a.Transport[e],c.selectedCandidatePairId&&(b=fd(a,c.selectedCandidatePairId),b&&(a.Transport[e]=y(a.Transport[e],b)));return a},hd=function(a){for(var b,c,d,e=a.streams.length,f=0;f<e;f++)b=a.streams[f],b.data.trackId&&(c=dd(a,b.data.trackId),c&&(a.streams[f].data=y(a.streams[f].data,c))),b.data.codecId&&(d=ed(a,b.data.codecId),d&&(a.streams[f].data=y(a.streams[f].data,d)));return a},id=function(a,b,c){b.hasOwnProperty(a)&&(b[a].hasOwnProperty(\"video\")&&(b[a].video.isGreaterBetter?(c.video.gThreshold=b[a].video.upperThreshold,c.video.rThreshold=b[a].video.lowerThreshold):(c.video.gThreshold=b[a].video.lowerThreshold,c.video.rThreshold=b[a].video.upperThreshold)),b[a].hasOwnProperty(\"audio\")&&(b[a].audio.isGreaterBetter?(c.audio.gThreshold=b[a].audio.upperThreshold,c.audio.rThreshold=b[a].audio.lowerThreshold):(c.audio.gThreshold=b[a].audio.lowerThreshold,c.audio.rThreshold=b[a].audio.upperThreshold)))},jd=function(a,c,d){var e=[],f=null,g=null;for(var h in c)c.hasOwnProperty(h)&&e.push(encodeURIComponent(h)+\"=\"+encodeURIComponent(c[h]));var i=e.join(\"&\"),j=new XMLHttpRequest;j.open(\"POST\",a),j.setRequestHeader(\"Content-Type\",\"application/x-www-form-urlencoded\"),f=b(),j.onload=function(){g=b();var a=g-f;d(j,a)},j.send(i)},kd=function(){Mb(ga,null,5e3,function(a){if(200===a.status)try{var b=JSON.parse(a.responseText);id(\"eModelThreshold\",b,Eb),id(\"throughputThreshold\",b,Ab),id(\"fractionalLossThreshold\",b,Db),id(\"rttThreshold\",b,Cb),id(\"currOverPrevFrameRateThreshold\",b,Bb)}catch(a){return a}},function(){cb&&kd()})},ld=function(){var a=ba+\"clockSync\",c=null,d=null;Mb(a,null,5e3,function(a,e){200===a.status?(c=JSON.parse(a.response),d=b(),md(c,e,d)):cb&&setTimeout(function(){ld()},100)},function(){cb&&ld()})},md=function(a,b,c){if(cb){var d=b/2;if(d>bb.maxAllowedLatency)bb.offsetResults=[],Ob(ma,na,\"log\",{msg:\"clockSync restarting\"});else{var e=a.now+d,f=e-c;bb.offsetResults.push(f),Ob(ma,na,\"log\",{msg:\"clockSync Info serverTime \"+e+\" responseRecvTs \"+c+\" requestExecutionTime \"+b})}if(bb.offsetResults.length>=bb.syncAttempts){var g=bb.offsetResults.reduce(function(a,b){return a+b});bb.currentOffset=g/bb.offsetResults.length,Ob(ma,na,\"log\",{msg:\"clockSync Done \"+bb.currentOffset+\"Length \"+bb.offsetResults.length}),bb.offsetResults=[],cb=!1,Oa.sendCachedUserJoinedEvents(Ua),Oa.sendCachedEvents(Ua,cb)}else cb&&setTimeout(function(){ld()},100)}},nd=function(){var a=this,c=null,d=!1,e=!1,f={},g={initiated:\"initiated\",connected:\"connected\",closed:\"closed\"};this._wsConnectionState=g.closed;var h=function(a,b){try{if(window&&window.sessionStorage){var c=JSON.parse(window.sessionStorage.getItem(\"csio_ucid_data\"));c||(c={}),c[a]||(c[a]={}),c[a].ucID=b,window.sessionStorage.setItem(\"csio_ucid_data\",JSON.stringify(c))}}catch(a){return}f[a]=fa+ma+\"/conferences/\"+encodeURIComponent(a)+\"/\"+b+\"/general\"};this.getConferenceURL=function(){return f},this._setupWebSocketConnection=function(f){return a._wsConnectionState===g.initiated||a._wsConnectionState===g.connected?(Ob(ma,na,\"log\",{msg:\"### _setupWebSocketConnection is called when already connected!\"}),console.log(\"### _setupWebSocketConnection is called when already connected!\"),void(f&&f(nb.success,\"WebSocket establishment successful.\"))):(a._wsConnectionState=g.initiated,c=new WebSocket(ea,\"echo-protocol\"),c.onopen=function(){console.log(\"**** Successfully connected to the backend \",e,na),Ob(ma,na,\"log\",{msg:\"Successfully connected to the backend\"}),a._wsConnectionState=g.connected,d?e=!0:d=!0,Oa.sendCachedUserJoinedEvents(Ua),e&&(P(),Oa.sendCachedEvents(Ua,cb)),e=!1},c.onclose=function(){a._wsConnectionState=g.closed,console.log(\"**** Connection to the server closed.\"),Ob(ma,na,\"log\",{msg:\"Connection to the server closed.\"}),K(),c&&(c=null),f&&f(nb.httpError,\"Connection to the server closed.\")},c.onerror=function(b){a._wsConnectionState=g.closed,Ob(ma,na,\"log\",{msg:\"WebSocket establishment failed.\"}),console.log(\"WebSocket establishment failed.\",b),f&&f(nb.wsChannelFailure,\"WebSocket establishment failed.\",b)},void(c.onmessage=function(a){var c,d=a.data,e=b(),g=JSON.parse(d);if(\"Error\"===g.status)\"Invalid client token.\"===g.reason&&(Ua.tokenData=null,Ua.authToken=null,Ua.sendAuthenticationRequest(ma,na)),f&&f(nb.csProtoError,d.reason);else if(\"200 OK\"===g.status)if(\"feedback\"===g.event)Kb(\"feedback\");else if(g.event===jb.userJoined||g.event===jb.refreshPresence){var i=!1,j=null;c=decodeURIComponent(g.conferenceID);var k=function(a){return setInterval(function(){ac(a)},Ha)};ab.hasOwnProperty(c)&&(ab[c].ucID!==g.ucID&&(i=!0,h(c,g.ucID),j=g.conferenceCreationTS?g.conferenceCreationTS:g.conferenceDuration),g.event!==jb.userJoined||ab[c].refreshPresence||(ab[c].refreshPresence=k(c),X()),ab[c].ucID=g.ucID),Oa.sendCachedFeedback(),Oa.sendCachedEvents(Ua,cb,i,j,c,g.ucID)}else g.event===kb.clockSync?md(g,e):g.event===ib.fabricSetupFailed&&(c=decodeURIComponent(g.conferenceID),g.ucID&&(h(c,g.ucID),Oa.sendCachedFeedback(),Oa.sendCachedEvents(Ua,cb,!0,0,c,g.ucID)))}))},this._isChannelReady=function(){return!(!c||1!==c.readyState)},this.getWSConnectionState=function(){return c?c.readyState:-1},this.send=function(a){c.send(JSON.stringify(a))}},od=new nd,pd=function(a,b,c){if(od._isChannelReady())try{od.send(b)}catch(d){d&&\"InvalidStateError\"===d.name&&Oa.cacheEvent({channel:a,data:b,callback:c})}else Oa.cacheEvent({channel:a,data:b,callback:c}),od._setupWebSocketConnection()};return f(),Lb(),Y(),window&&!window.csioproxy&&(kd(),Q()),window&&window.csioChromeLegacyGetStats&&(La=!1),{version:da,initialize:dc,on:fc,fabricEvent:ib,addNewFabric:Lc,sendFabricEvent:tc,sendUserFeedback:Bc,associateMstWithUserID:Dc,attachWifiStatsHandler:Cc,csError:nb,fabricUsage:rb,qualityRating:tb,webRTCFunctions:yb,reportError:xc,reportUserIDChange:Mc,userIDType:sb,setProxyConfig:Kc,callStatsAPIReturnStatus:mb,setIdentifiers:Jc,transmissionDirection:qb,endpointType:pb}}\"function\"==typeof define&&define.amd?define(\"callstats\",[],a):global.callstats=a,module.exports=a}(\"undefined\"!=typeof window?window:\"undefined\"!=typeof global?global:this);\n\n\n// WEBPACK FOOTER //\n// ./node_modules/react-native-callstats/callstats.js","/*! callstats.js  version = 3.27.0 2017-12-14 */\n\"use strict\";function callstatsUtils(){}callstatsUtils.prototype.measureAppLoadingPerformance=function(a){var b=0,c=Number.MAX_VALUE,d=0,e=\"\",f=\"\",g=window.performance;if(!(\"performance\"in window&&\"timing\"in window.performance&&\"navigation\"in window.performance))return{support:\"none\",total:void 0};var h=g.timing.loadEventEnd-g.timing.navigationStart;if(\"Chrome\"===a.name||\"Opera\"===a.name){var i,j=g.getEntriesByType(\"resource\");for(i=0;i<j.length;i++)j[i].duration>d&&(f=j[i].name.substr(j[i].name.lastIndexOf(\"/\")+1),d=j[i].duration),j[i].duration<c&&(e=j[i].name.substr(j[i].name.lastIndexOf(\"/\")+1),c=j[i].duration),j[i].name.indexOf(\"CALLSTATS_SRC_URLstatic/callstats\")>-1&&(b=j[i].duration);return{support:\"full\",callstats:b,min:{name:e,time:c},max:{name:f,time:d},total:h}}return\"Firefox\"===a.name?{support:\"limited\",total:h}:void 0},callstatsUtils.prototype.detectBrowserInfo=function(){var a=\"Chrome\",b=null,c=null,d=null,e={goog:\"Chrome\",moz:\"Firefox\",plugin:\"Plugin\",edge:\"Edge\"},f=e.goog;if(!window.navigator.userAgent||window.csioReactNative)return console.log(\"Invalid userAgent\"),window&&window.csioGetOsName&&(b=window.csioGetOsName()),window&&window.csioGetOsVer&&(c=window.csioGetOsVer()),window&&window.csioReactNative&&(d=\"react-native\"),{name:a,codebase:f,os:b,osVersion:c,userAgent:d};d=navigator.userAgent;var g,h=d.toLowerCase(),i=navigator.appVersion,j=\"\"+parseFloat(navigator.appVersion);(g=h.indexOf(\"opera\"))!==-1?(a=\"Opera\",j=h.substring(g+6),(g=h.indexOf(\"Version\"))!==-1&&(j=h.substring(g+8)),f=e.goog):(g=h.indexOf(\"opr\"))!==-1?(a=\"Opera\",j=h.substring(g+4),(g=h.indexOf(\"Version\"))!==-1&&(j=h.substring(g+8)),f=e.goog):(g=h.indexOf(\"msie\"))!==-1?(a=\"Microsoft Internet Explorer\",j=h.substring(g+5),f=e.goog):(g=h.indexOf(\"edge\"))!==-1?(a=e.edge,j=h.substring(g+5),f=e.edge):(g=h.indexOf(\"chrome\"))!==-1?(a=e.goog,j=h.substring(g+7),f=e.goog):(g=h.indexOf(\"safari\"))!==-1?(a=\"Safari\",j=h.substring(g+7),(g=h.indexOf(\"version\"))!==-1&&(j=h.substring(g+8)),f=e.goog):(g=h.indexOf(\"firefox\"))!==-1?(a=\"Firefox\",j=h.substring(g+8),f=e.moz):(g=h.indexOf(\"trident\"))!==-1&&(a=\"Microsoft Internet Explorer\",g=h.indexOf(\"rv\"),j=h.substring(g+3,g+7),f=e.goog);var k,l,m=[{s:\"Windows 3.11\",r:/win16/},{s:\"Windows 95\",r:/(windows 95|win95|windows_95)/},{s:\"Windows ME\",r:/(win 9x 4.90|windows me)/},{s:\"Windows 98\",r:/(windows 98|win98)/},{s:\"Windows CE\",r:/windows ce/},{s:\"Windows 2000\",r:/(windows nt 5.0|windows 2000)/},{s:\"Windows XP\",r:/(windows nt 5.1|windows xp)/},{s:\"Windows Server 2003\",r:/windows nt 5.2/},{s:\"Windows Vista\",r:/windows nt 6.0/},{s:\"Windows 7\",r:/(windows 7|windows nt 6.1)/},{s:\"Windows 8.1\",r:/(windows 8.1|windows nt 6.3)/},{s:\"Windows 8\",r:/(windows 8|windows nt 6.2)/},{s:\"Windows 10\",r:/(windows 10|windows nt 10.0)/},{s:\"Windows NT 4.0\",r:/(windows nt 4.0|winnt4.0|winnt|windows nt)/},{s:\"Windows ME\",r:/windows me/},{s:\"Android\",r:/android/},{s:\"Open BSD\",r:/openbsd/},{s:\"Sun OS\",r:/sunos/},{s:\"Linux\",r:/(linux|x11)/},{s:\"iOS\",r:/(iphone|ipad|ipod)/},{s:\"Mac OS X\",r:/mac os x/},{s:\"Mac OS\",r:/(macppc|macintel|mac_powerpc|macintosh)/},{s:\"QNX\",r:/qnx/},{s:\"UNIX\",r:/unix/},{s:\"BeOS\",r:/beos/},{s:\"OS/2\",r:/os\\/2/},{s:\"Search Bot\",r:/(nuhk|googlebot|yammybot|openbot|slurp|msnbot|ask jeeves\\/teoma|ia_archiver)/}];for(k in m)if(l=m[k],l.r.test(h)){b=l.s;break}switch(b&&/Windows/.test(b)&&(c=/Windows (.*)/.exec(b)[1],b=\"Windows\"),b){case\"Mac OS X\":c=/mac os x (10[\\.\\_\\d]+)/.exec(h)[1];break;case\"Android\":c=/android ([\\.\\_\\d]+)/.exec(h)[1];break;case\"iOS\":c=/os (\\d+)_(\\d+)_?(\\d+)?/.exec(i),c=c[1]+\".\"+c[2]+\".\"+(0|c[3])}return{name:a,ver:j.toString(),os:b,osVersion:c,codebase:f,userAgent:d}},module.exports=callstatsUtils;\n\n\n// WEBPACK FOOTER //\n// ./node_modules/react-native-callstats/callstatsUtils.js","/*! callstats.js  version = 3.27.0 2017-12-14 */\nfunction PusherPlug(){this.invoker=null,this.receiver=null}function Notifier(){this.listeners=[]}function SenderGate(a){this.stats=null,this.lastResponsed=(new Date).getTime(),this.onDataSent=a}function Measurement(a){this.ssrc=null,this.direction=void 0,this.mediaType=null,this.resolution=null,this.frameRateReceived=null,this.frameWidth=null,this.rtt=null,this.droppedFramesNum=null,this.packetLosts=null,this.jitter=null,this.bytesReceived=-1,this.packetsReceived=-1,this.packetsDiscarded=-1,this.bytesSent=-1,this.packetsSent=-1,this.stream=a}function NumberComparator(a,b){var c=\"number\"==typeof a?a:parseInt(a),d=\"number\"==typeof b?b:parseInt(b);return c===d?0:c<d?-1:1}function MeasurementRTTComparator(a,b){return NumberComparator(a.rtt,b.rtt)}function MeasurementFrameHeightComparator(a,b){return NumberComparator(a.frameHeight,b.frameHeight)}function MeasurementFrameWidthComparator(a,b){return NumberComparator(a.frameWidth,b.frameWidth)}function MeasurementJitterComparator(a,b){return NumberComparator(a.jitter,b.jitter)}function MeasurementFrameRateReceivedComparator(a,b){var c=parseInt(a.frameRateReceived),d=parseInt(b.frameRateReceived);return c===d?0:c<d?-1:1}function MeasurementMerger(a,b){return a}function Assembler(){this.codeBase=null,this.mediaType={unknown:\"unknown\",audio:\"audio\",video:\"video\"},this.codeBaseType={chrome:\"Chrome\",firefox:\"Firefox\",edge:\"Edge\"}}function SWValueTracker(a){SWPlugin.call(this),this.extractorFnc=a,this.prev=0,this.delta=0,this.first=0,this.actual=0,this.addSignalListener(Reporter.Signals.onDataSent,this.onDataSent,this)}function SWValueHolder(a){SWPlugin.call(this),this.extractorFnc=a,this.prev=null}function FractionLost(a,b){this.intervalPacketsRecv=b,this.intervalLoss=a}function FractionLostComparator(a,b){var c=a.getValue(),d=b.getValue();return c===d?0:c<d?-1:1}function FractionLostMerger(a,b){var c=(a.getIntervalLoss()+b.getIntervalLoss())/2,d=(a.getIntervalPacketsRecv()+b.getIntervalPacketsRecv())/2;return new FractionLost(c,d)}function Monitor(){this.measurements=new SlidingWindow(Reporter.maxItemsNum,Reporter.timeoutInMs),this.packetLostTracker=new SWValueTracker(function(a){return a.packetLosts}),this.measurements.addPlugin(this.packetLostTracker),this.packetsDiscardedTracker=new SWValueTracker(function(a){return a.packetsDiscarded}),this.measurements.addPlugin(this.packetsDiscardedTracker),this.resolutionTracker=new SWValueHolder(function(a){return a.resolution}),this.measurements.addPlugin(this.resolutionTracker),this.jitter95PercentileTracker=new SWPercentileTracker(MeasurementJitterComparator,95,MeasurementMerger),this.measurements.addPlugin(this.jitter95PercentileTracker),this.jitter95PercentileTracker.addFilter(function(a){return void 0!==a.jitter&&null!==a.jitter}),this.rtt95PercentileTracker=new SWPercentileTracker(MeasurementRTTComparator,95,MeasurementMerger),this.measurements.addPlugin(this.rtt95PercentileTracker),this.rtt95PercentileTracker.addFilter(function(a){return void 0!==a.rtt&&null!==a.rtt&&0<a.rtt}),this.frameHeight50PercentileTracker=new SWPercentileTracker(MeasurementFrameHeightComparator,50,MeasurementMerger),this.measurements.addPlugin(this.frameHeight50PercentileTracker),this.frameHeight50PercentileTracker.addFilter(function(a){return void 0!==a.frameHeight&&null!==a.frameHeight&&0<a.frameHeight}),this.frameHeight95PercentileTracker=new SWPercentileTracker(MeasurementFrameHeightComparator,95,MeasurementMerger),this.measurements.addPlugin(this.frameHeight95PercentileTracker),this.frameHeight95PercentileTracker.addFilter(function(a){return void 0!==a.frameHeight&&null!==a.frameHeight&&0<a.frameHeight}),this.frameRate50PercentileTracker=new SWPercentileTracker(MeasurementFrameRateReceivedComparator,50,MeasurementMerger),this.measurements.addPlugin(this.frameRate50PercentileTracker),this.frameRate50PercentileTracker.addFilter(function(a){return void 0!==a.frameRateReceived&&null!==a.frameRateReceived}),this.frameRate95PercentileTracker=new SWPercentileTracker(MeasurementFrameRateReceivedComparator,95,MeasurementMerger),this.measurements.addPlugin(this.frameRate95PercentileTracker),this.frameRate95PercentileTracker.addFilter(function(a){return void 0!==a.frameRateReceived&&null!==a.frameRateReceived}),this.frameWidth50PercentileTracker=new SWPercentileTracker(MeasurementFrameWidthComparator,50,MeasurementMerger),this.measurements.addPlugin(this.frameWidth50PercentileTracker),this.frameWidth50PercentileTracker.addFilter(function(a){return void 0!==a.frameWidth&&null!==a.frameWidth&&0<a.frameWidth}),this.frameWidth95PercentileTracker=new SWPercentileTracker(MeasurementFrameWidthComparator,95,MeasurementMerger),this.measurements.addPlugin(this.frameWidth95PercentileTracker),this.frameWidth95PercentileTracker.addFilter(function(a){return void 0!==a.frameWidth&&null!==a.frameWidth&&0<a.frameWidth}),this.rttAvgRTTracker=new SWAvg(function(a){return a.rtt}),this.measurements.addPlugin(this.rttAvgRTTracker),this.rttAvgRTTracker.addFilter(function(a){return void 0!==a.rtt&&null!==a.rtt&&0<a.rtt}),this.frameRateMeanTracker=new SWAvg(function(a){return a.frameRateReceived}),this.measurements.addPlugin(this.frameRateMeanTracker),this.frameRateMeanTracker.addFilter(function(a){return void 0!==a.frameRateReceived&&null!==a.frameRateReceived&&0<a.frameRateReceived}),this.frameHeightMeanTracker=new SWAvg(function(a){return a.frameHeight}),this.measurements.addPlugin(this.frameHeightMeanTracker),this.frameHeightMeanTracker.addFilter(function(a){return void 0!==a.frameHeight&&null!==a.frameHeight&&0<a.frameHeight}),this.frameWidthMeanTracker=new SWAvg(function(a){return a.frameWidth}),this.measurements.addPlugin(this.frameWidthMeanTracker),this.frameWidthMeanTracker.addFilter(function(a){return void 0!==a.frameHeight&&null!==a.frameWidth&&0<a.frameWidth}),this.jitterAvgTracker=new SWAvg(function(a){return a.jitter}),this.measurements.addPlugin(this.jitterAvgTracker),this.jitterAvgTracker.addFilter(function(a){return void 0!==a.jitter&&null!==a.jitter&&0<a.jitter}),this.intervalFractionLosts=new SlidingWindow(Reporter.maxItemsNum,Reporter.timeoutInMs),this.FLPercentileTracker=new SWPercentileTracker(FractionLostComparator,95,FractionLostMerger),this.intervalFractionLosts.addPlugin(this.FLPercentileTracker),this.lastSent=0,this.firstAdded=0,this.lastAdded=0,this.doSending=!1,this.mediaType=null,this.direction=null,this.lastTraffic=0,this.ssrc=0}function InboundMonitor(){Monitor.call(this),this.bytesReceivedTracker=new SWValueTracker(function(a){return a.bytesReceived}),this.packetsReceivedTracker=new SWValueTracker(function(a){return a.packetsReceived}),this.addPlugin(this.bytesReceivedTracker),this.addPlugin(this.packetsReceivedTracker),this.csioIntBRKbpsCount=0,this.csioIntPRCount=0}function InbAudioMonitor(){InboundMonitor.call(this),this.quality={eModel:0,bandwidth:0},this.direction=Measurement.Direction.inbound,this.mediaType=Measurement.MediaTypes.audio}function InbVideoMonitor(){InboundMonitor.call(this),this.frameRateReceivedTracker=new SWValueTracker(function(a){return a.frameRateReceived}),this.frameRatePercTracker=new SWPercentileTracker(MeasurementFrameRateReceivedComparator,10,MeasurementMerger),this.frameRatePercTracker.addFilter(function(a){return void 0!==a.frameRateReceived&&null!==a.frameRateReceived}),this.frameRatePercTracker.attach(this.setFrameRateReceived10,this),this.frameRateReceived10=null,this.addPlugin(this.frameRatePercTracker),this.addPlugin(this.frameRateReceivedTracker),this.quality={eModel:0,bandwidth:0,frameRate:0},this.direction=Measurement.Direction.inbound,this.mediaType=Measurement.MediaTypes.video}function OutboundMonitor(){Monitor.call(this),this.bytesSentTracker=new SWValueTracker(function(a){return a.bytesSent}),this.packetsSentTracker=new SWValueTracker(function(a){return a.packetsSent}),this.addPlugin(this.bytesSentTracker),this.addPlugin(this.packetsSentTracker),this.csioIntBRKbpsCount=0,this.csioIntPRCount=0}function OutbVideoMonitor(){OutboundMonitor.call(this),this.frameRateReceivedTracker=new SWValueTracker(function(a){return a.frameRateReceived}),this.frameRatePercTracker=new SWPercentileTracker(MeasurementFrameRateReceivedComparator,10,MeasurementMerger),this.frameRatePercTracker.addFilter(function(a){return void 0!==a.frameRateReceived&&null!==a.frameRateReceived}),this.frameRatePercTracker.attach(this.setFrameRateReceived10,this),this.frameRateReceived10=null,this.addPlugin(this.frameRatePercTracker),this.addPlugin(this.frameRateReceivedTracker),this.quality={eModel:0,bandwidth:0,frameRate:0},this.sendingThroughputObservations={ssrc:0,started:0,max:0,maxTs:0,stable:0,stableTs:0,ready:!1,maxVerified:!1,stableVerified:!1},this.direction=Measurement.Direction.outbound,this.mediaType=Measurement.MediaTypes.video}function OutbAudioMonitor(){OutboundMonitor.call(this),this.quality={eModel:0,bandwidth:0},this.direction=Measurement.Direction.outbound,this.mediaType=Measurement.MediaTypes.audio}function Monitors(){this.monitors={},this.assembler=new Assembler,this.sendable=!1,this.inbOneWayAudioDisruption={sent:!1,started:0,hasTrafficTs:0},this.outbOneWayAudioDisruption={sent:!1,started:0,hasTrafficTs:0}}function Analyzer(a){this.monitors=new Monitors,this.output=new PusherPlug,this.lastForwarded=(new Date).getTime(),this.lastInterval=0,this.sentCounter=0,this.nextInterval=0,a.addListener(this.monitors.onDataSent,this.monitors),a.addListener(this.onDataSent,this)}function Reporter(){this.states={Idle:\"Idle\",Run:\"Run\"},this.events={OnPolling:\"OnPolling\",OnStatsRequest:\"OnStatsRequest\",OnStop:\"OnStop\",OnStart:\"OnStart\",OnOneWayAudioDisruptionsRequest:\"OnOneWayAudioDisruptionsRequest\",OnSendingThroughputObservationsRequest:\"OnSendingThroughputObservationsRequest\"},this.onDataSent=new Notifier,this.analyzer=new Analyzer(this.onDataSent),this.senderGate=new SenderGate(this.onDataSent),this.sendingThroughputObservationsSent=!1,this.analyzer.output.connect(this.senderGate.receiver,this.senderGate),this.currentState=this.states.Run}var SlidingWindow=require(\"./slidingWindow\"),SWPlugin=require(\"./swPlugin\"),SWPercentileTracker=require(\"./swPercentileTracker\"),SWAvg=require(\"./swAvg\");Reporter.disruptions=[],Reporter.adaptiveSending=!0,Reporter.minMeasurementsNum=20,Reporter.SendingTimeTresholds={max:3e4,min:1e3,regular:5e3},Reporter.minDeltaTimeInMs=1e3,Reporter.maxItemsNum=1e3,Reporter.timeoutInMs=3e5,Reporter.Signals={onDataSent:\"onDataSent\"},PusherPlug.prototype={constructor:PusherPlug,connect:function(a,b){this.invoker=void 0===b?null:b,this.receiver=a},send:function(a){return null===this.receiver?void console.warn(\"There is no receiver to call\"):null===this.invoker?void this.receiver(a):void this.receiver.call(this.invoker,a)}},Notifier.prototype={constructor:Notifier,addListener:function(a,b){this.listeners.push({callback:a,that:b})},notify:function(){for(var a=0;a<this.listeners.length;++a){var b=this.listeners[a];void 0!==b.callback&&null!==b.callback&&(null===b.that?b.callback():b.callback.call(b.that))}}},SenderGate.prototype={constructor:SenderGate,receiver:function(a){this.stats=a,this.initiate=!1},requestStats:function(){var a=null,b=(new Date).getTime();if(null===this.stats)return null;if(this.initiate&&b-Reporter.SendingTimeTresholds.min<this.lastResponsed)return console.warn(\"Reporter : Too small interval between two sampling to response\"),null;var c=b-this.lastResponsed;return console.log(\"Elapsed time since last report: \"+c),a={streams:this.stats},this.stats=null,this.lastResponsed=b,this.onDataSent.notify(),this.initiate=!0,a}},Measurement.MediaTypes={audio:\"audio\",video:\"video\"},Measurement.Direction={inbound:\"inbound\",outbound:\"outbound\"},Measurement.prototype={constructor:Measurement,toString:function(){return\"Measurement {RTT: \"+this.RTT+\"; }\"}},Assembler.prototype={constructor:Assembler,do:function(a,b){var c=new Measurement(a);if(c.ssrc=a.ssrc,c.mediaType=this.getMediaType(a),c.resolution=this.getResolution(a),c.frameRateReceived=this.getFrameRate(a),c.frameWidth=this.getFrameWidth(a),c.frameHeight=this.getFrameHeight(a),c.rtt=this.getLatencyData(a),c.droppedFramesNum=this.getDroppedFramesNum(a),c.packetLosts=this.getPacketLosts(a),c.jitter=this.getJitter(a),a.streamType===Measurement.Direction.inbound?(c.direction=Measurement.Direction.inbound,c.bytesReceived=this.getBytesReceived(a),c.packetsReceived=this.getPacketsReceived(a),c.packetsDiscarded=this.getPacketsDiscarded(a)):a.streamType===Measurement.Direction.outbound&&(c.direction=Measurement.Direction.outbound,c.bytesSent=this.getBytesSent(a),c.packetsSent=this.getPacketsSent(a)),void 0!==b&&b===!0){c.rawdats={};for(var d in a.data)a.data.hasOwnProperty(d)&&(c.rawdats[d]=a.data[d])}return c},setupCodeBase:function(a){this.codeBase=a},getBytesSent:function(a){if(void 0===a.data.bytesSent)return 0;var b=this.checkForNan(parseInt(a.data.bytesSent,10));return null!==b?b:0},getBytesReceived:function(a){if(void 0===a.data.bytesReceived)return 0;var b=this.checkForNan(parseInt(a.data.bytesReceived,10));return null!==b?b:0},getPacketsReceived:function(a){if(void 0===a.data.packetsReceived)return 0;var b=this.checkForNegativeValue(parseInt(a.data.packetsReceived,10));return null!==b?b:0},getPacketsSent:function(a){if(void 0===a.data.packetsSent)return 0;var b=this.checkForNegativeValue(parseInt(a.data.packetsSent,10));return null!==b?b:0},getPacketsDiscarded:function(a){if(void 0===a.data.discardedPackets)return 0;var b=this.checkForNan(parseInt(a.data.discardedPackets,10));return null!==b?b:0},getPacketLosts:function(a){if(void 0===a.data.packetsLost)return 0;var b=this.checkForNegativeValue(parseInt(a.data.packetsLost,10));return null!==b?b:0},getDroppedFramesNum:function(a){if(void 0===a.data.droppedFrames)return 0;var b=this.checkForNegativeValue(parseInt(a.data.droppedFrames,10));return null!==b?b:0},getFrameRate:function(a){var b;return void 0!==a.data.googFrameRateOutput?b=parseInt(a.data.googFrameRateOutput,10):void 0!==a.data.googFrameRateDecoded?b=parseInt(a.data.googFrameRateDecoded,10):void 0!==a.data.googFrameRateReceived?b=parseInt(a.data.googFrameRateReceived,10):void 0!==a.data.googFrameRateSent?b=parseInt(a.data.googFrameRateSent,10):void 0!==a.data.framerateMean&&(b=parseInt(a.data.framerateMean,10)),void 0!==b&&(b=isNaN(b)||b<0?null:b),b},getFrameHeight:function(a){var b;return void 0!==a.data.googFrameHeightReceived?b=a.data.googFrameHeightReceived:void 0!==a.data.googFrameHeightSent?b=a.data.googFrameHeightSent:void 0!==a.data.frameHeight&&(b=a.data.frameHeight),b},getJitter:function(a){if(void 0!==a){var b;return void 0!==a.data.googJitterReceived?(b=this.checkForNan(parseInt(a.data.googJitterReceived,10)),b?b/1e3:b):this.codeBase===this.codeBaseType.chrome&&void 0!==a.data.jitter?(b=this.checkForNan(parseInt(a.data.jitter,10)),b?b/1e3:b):this.codeBase===this.codeBaseType.firefox&&void 0!==a.data.jitter?this.checkForNan(parseInt(a.data.jitter,10)):void 0}},getResolution:function(a){var b,c,d,e=\"unavailable\";return b=this.getFrameRate(a),d=this.getFrameWidth(a),c=this.getFrameHeight(a),void 0!==b&&void 0!==d&&void 0!==c&&d>0&&c>0&&(e=d.concat(\"x\",c,\"@\",b)),e},getFrameWidth:function(a){var b;return void 0!==a.data.googFrameWidthReceived?b=a.data.googFrameWidthReceived:void 0!==a.data.googFrameWidthSent?b=a.data.googFrameWidthSent:void 0!==a.data.frameWidth&&(b=a.data.frameWidth),b},validateRTT:function(a){var b;return b=isNaN(a)||a<0?null:a},getLatencyData:function(a){return void 0===a?null:void 0!==a.data.googRtt?this.validateRTT(parseInt(a.data.googRtt,10)):void 0!==a.data.roundTripTime?this.validateRTT(parseInt(a.data.roundTripTime,10)):void 0!==a.data.mozRtt?this.validateRTT(parseInt(a.data.mozRtt,10)):null},getMediaType:function(a){var b=this.mediaType.unknown;if(void 0!==a)return a.data&&void 0!==a.data.mediaType?a.data.mediaType:(a.data.mediaType?b=a.data.mediaType:void 0!==a.data.googFrameRateReceived||void 0!==a.data.googFrameRateSent?b=this.mediaType.video:void 0!==a.data.audioInputLevel||void 0!==a.data.audioOutputLevel||void 0!==a.data.audioLevel?b=this.mediaType.audio:void 0!==a.data.framerateMean&&(b=this.mediaType.video),b)},checkForNan:function(a){var b=isNaN(a)?null:a;return b},checkForNegativeValue:function(a){if(a=this.checkForNan(a),null!==a){var b=a<0?null:a;return b}},toString:function(){return\"ToString function is not defined. for this object\"}},SWValueTracker.prototype=Object.create(SWPlugin.prototype),SWValueTracker.prototype.constructor=SWValueTracker,SWValueTracker.prototype.onDataSent=function(){this.prev=this.actual},SWValueTracker.prototype.getActual=function(){return this.actual},SWValueTracker.prototype.getFirst=function(){return this.first},SWValueTracker.prototype.getDelta=function(){return this.delta=this.actual-this.prev,this.delta},SWValueTracker.prototype.getPrevious=function(){return this.prev},SWValueTracker.prototype.add=function(a){var b=this.extractorFnc(a);if(void 0!==b&&null!==b){if(0===this.first)return this.first=b,void(this.actual=b);this.actual=b,this.notify({last:this.prev,delta:this.delta})}},SWValueTracker.prototype.remove=function(){},SWValueHolder.prototype=Object.create(SWPlugin.prototype),SWValueHolder.prototype.constructor=SWValueHolder,SWValueHolder.prototype.add=function(a){void 0!==a&&null!==a&&(this.prev=this.extractorFnc(a))},SWValueHolder.prototype.remove=function(){},SWValueHolder.prototype.getPrevious=function(){return this.prev},FractionLost.prototype={constructor:FractionLost,getIntervalLoss:function(){return this.intervalLoss},getIntervalPacketsRecv:function(){return this.intervalPacketsRecv},getValue:function(){return void 0===this.intervalPacketsRecv||void 0===this.intervalLoss?null:null===this.intervalPacketsRecv||null===this.intervalLoss?null:0===this.intervalLoss&&0===this.intervalPacketsRecv?0:this.intervalLoss/(this.intervalPacketsRecv+this.intervalLoss)}},Monitor.VideoThroughputThresholds={green:1024,red:256},Monitor.AudioThroughputThresholds={green:30,red:8},Monitor.FrameRateRatioTresholds={green:.8,red:.3},Monitor.VideoRTTThresholds={green:400,red:1e3},Monitor.VideoFractionLostTreshdolds={green:10,red:50},Monitor.AudioFractionLostTresholds={green:15,red:30},Monitor.AudioEModelTresholds={green:240,red:400},Monitor.avQualityRating={excellent:3,fair:2,bad:1},Monitor.avQualityRatingString={excellent:\"excellent\",fair:\"fair\",bad:\"bad\"},Monitor.prototype={constructor:Monitor,doStart:function(){return!0},getStartTime:function(){return this.firstAdded},hasTraffic:function(){var a=this.getLastMeasurement();return this.direction===Measurement.Direction.inbound?0<a.bytesReceived:this.direction===Measurement.Direction.outbound&&0<a.bytesSent},getTotalTimeInMs:function(){return 0===this.firstAdded?0:this.lastAdded-this.firstAdded},getDeltaTimeInMs:function(){return 0===this.lastSent?this.lastAdded-this.firstAdded:this.lastAdded-this.lastSent},getLastMeasurement:function(){return this.measurements.getLast()},setSSRC:function(a){this.ssrc=a},getSSRC:function(){return this.ssrc},add:function(a){var b=(new Date).getTime();if(0===this.firstAdded){if(!this.doStart(a))return;this.firstAdded=b}this.lastAdded=b,this.measurements.add(a)},requestSending:function(){this.doSending=!0},setIntBRAndPR:function(a,b,c){var d=this.getDeltaTimeInMs(),e=Math.max(Reporter.minDeltaTimeInMs,d),f=8*a.getDelta()/e,g=b.getDelta()/(e/1e3);c.data.csioIntBRKbps=f,c.data.csioIntPR=g,0<f?this.csioIntBRKbpsCount=10:0<this.csioIntBRKbpsCount&&(--this.csioIntBRKbpsCount,this.requestSendingIf(1e3<d&&this.csioIntPRCount<5,\"OutboundMonitor csioIntBRKbps is 0 and this is the reason for sending\")),0<g?this.csioIntPRCount=10:0<this.csioIntPRCount&&(--this.csioIntPRCount,this.requestSendingIf(1e3<d&&this.csioIntPRCount<5,\"OutboundMonitor csioIntPR is 0 and this is the reason for sending: \"))},requestSendingIf:function(a,b){this.doSending=this.doSending||a},getAvgRTT:function(){return this.rttAvgRTTracker.getResult()},getResolution:function(){return this.resolutionTracker.getPrevious()},percentileTrackerExtractor:function(a,b,c){var d=null,e=a.getResult();return null===e?c:(d=b(e.actual),null===d?c:d)},getRTT95:function(){var a=this.percentileTrackerExtractor(this.rtt95PercentileTracker,function(a){return a.rtt},null),b=this.getLastMeasurement();if(null!==b&&null!==a){var c=Math.max(.1*a,50);this.requestSendingIf(a+c<b.rtt,\"RTT95 the reason of sending \"+a+\" < \"+b.rtt)}return a},getJitter95:function(){var a=this.percentileTrackerExtractor(this.jitter95PercentileTracker,function(a){return a.jitter},null),b=this.getLastMeasurement();if(null!==b){var c=Math.max(.1*a,10);this.requestSendingIf(a+c<b.jitter,\"Jitter95 the reason of sending \"+a+\" < \"+b.jitter)}return this.result},getFrameRateMean:function(){return this.frameRateMeanTracker.getResult()},getFrameWidth50Percentile:function(){return this.percentileTrackerExtractor(this.frameWidth50PercentileTracker,function(a){return a.frameWidth},null)},getFrameWidth95Percentile:function(){return this.percentileTrackerExtractor(this.frameWidth95PercentileTracker,function(a){return a.frameWidth},null)},getFrameHeight50Percentile:function(){return this.percentileTrackerExtractor(this.frameHeight50PercentileTracker,function(a){return a.frameHeight},null)},getFrameHeight95Percentile:function(){return this.percentileTrackerExtractor(this.frameHeight95PercentileTracker,function(a){return a.frameHeight},null)},getFrameRate50Percentile:function(){return this.percentileTrackerExtractor(this.frameRate50PercentileTracker,function(a){return a.frameRateReceived},null)},getFrameRate95Percentile:function(){return this.percentileTrackerExtractor(this.frameRate95PercentileTracker,function(a){return a.frameRateReceived},null)},getFrameHeightMean:function(){return this.frameHeightMeanTracker.getResult()},getFrameWidthMean:function(){return this.frameWidthMeanTracker.getResult()},getAvgJitter:function(){return this.jitterAvgTracker.getResult()},getQualityEvaluation:function(a,b){if(void 0!==a&&void 0!==b){if(null===a||null===a)return null;var c;return c=b.green<=a?Monitor.avQualityRating.excellent:b.red<a&&a<b.green?Monitor.avQualityRating.fair:Monitor.avQualityRating.bad}},getQualityReverseEvaluation:function(a,b){if(void 0!==a&&void 0!==b){if(null===a||null===a)return null;var c;return c=b.red<a?Monitor.avQualityRating.bad:b.green<=a&&a<=b.red?Monitor.avQualityRating.fair:Monitor.avQualityRating.excellent}},hasData:function(){return this.measurements.refresh(),1<this.measurements.getItemsNum()},addPlugin:function(a){this.measurements.addPlugin(a)},setup:function(a){a.data.csioIntBRKbps=0,a.data.csioAvgBRKbps=0,a.data.csioIntFL=void 0,a.data.csioIntMs=Math.max(Reporter.SendingTimeTresholds.regular,this.getDeltaTimeInMs()),a.data.csioIntPR=void 0,a.data.csioPercentileFl=void 0,a.data.csioIntPktLoss=void 0,a.data.csioAvgJitter=this.getAvgJitter(),a.data.csioAvgRtt=this.getAvgRTT(),a.data.csioPercentileJitter=this.getJitter95(),a.data.csioSig2Latency=this.getRTT95(),a.data.csioTimeElapseMs=this.getTotalTimeInMs(),a.data.csioeM=(null!==this.getRTT95()?this.getRTT95():0)+40,a.data.csiores=this.getResolution(),a.data.csioFrameWidth95Percentile=this.getFrameWidth95Percentile(),a.data.csioFrameWidth50Percentile=this.getFrameWidth50Percentile(),a.data.csioFrameHeight95Percentile=this.getFrameHeight95Percentile(),a.data.csioFrameHeight50Percentile=this.getFrameHeight50Percentile(),a.data.csioFrameRate95Percentile=this.getFrameRate95Percentile(),a.data.csioFrameRate50Percentile=this.getFrameRate50Percentile(),a.data.csioFrameWidthMean=this.getFrameWidthMean(),a.data.csioFrameHeightMean=this.getFrameHeightMean(),a.data.csioFrameRateMean=this.getFrameRateMean()},addIntervalFractionLost:function(a){this.intervalFractionLosts.add(a)},getLastFractionLost:function(){return this.intervalFractionLosts.getLast()},getIntervalFractionLost95:function(){var a,b=this.FLPercentileTracker.getResult();if(null===b)return 0;a=b.actual.getValue();var c=this.getLastFractionLost();if(null!==c&&null!==a){var d=Math.max(.05,c.getValue());this.requestSendingIf(c.getValue()+d<a,\"Fraction lost is the reason for sending \"+c.getValue()+\" \"+a)}return a},onDataSent:function(){var a=(new Date).getTime();this.measurements.signalize(Reporter.Signals.onDataSent,null),this.lastSent=a},isValid:function(){for(var a=0;a<arguments.length;a++)if(null===arguments[a]||void 0===arguments[a])return!1;return!0},doSend:function(){if(this.hasData()===!1)return!0;var a=this.doSending;return this.doSending=!1,a},getMediaType:function(){return this.mediaType},getDirection:function(){return this.direction}},InboundMonitor.prototype=Object.create(Monitor.prototype),InboundMonitor.prototype.constructor=InboundMonitor,InboundMonitor.prototype.setRTT95=function(a){Monitor.prototype.setRTT95(a)},InboundMonitor.prototype.setup=function(a){Monitor.prototype.setup.call(this,a);var b=new FractionLost(this.packetLostTracker.getDelta(),this.packetsReceivedTracker.getDelta());this.addIntervalFractionLost(b),a.data.csioIntPktRcv=this.packetsReceivedTracker.getDelta(),this.setIntBRAndPR(this.bytesReceivedTracker,this.packetsReceivedTracker,a),this.getTotalTimeInMs()>0&&(a.data.csioAvgBRKbps=8*this.bytesReceivedTracker.getActual()/this.getTotalTimeInMs()),a.data.csioIntFL=b.getValue(),a.data.csioPercentileFl=this.getIntervalFractionLost95(),a.data.csioeM=(null!==this.getRTT95()?this.getRTT95():0)+40,a.data.csioIntPktLoss=this.packetLostTracker.getDelta(),void 0!==a.data.csioAvgBRKbps&&null!==a.data.csioAvgBRKbps?a.data.csioAvgPacketSize=this.bytesReceivedTracker.getDelta()/this.packetsReceivedTracker.getDelta():a.data.csioAvgPacketSize=null,a.data.csioPktLossPercentage=this.packetLostTracker.getDelta()/this.packetsReceivedTracker.getDelta()*100},InbAudioMonitor.prototype=Object.create(InboundMonitor.prototype),InbAudioMonitor.prototype.constructor=InbAudioMonitor,InbAudioMonitor.prototype.setup=function(a){InboundMonitor.prototype.setup.call(this,a),a.data.csioMediaType=Measurement.MediaTypes.audio,this.quality.eModel=this.getQualityReverseEvaluation(a.data.csioeM,Monitor.AudioEModelTresholds),this.quality.bandwidth=this.getQualityEvaluation(a.data.csioIntBRKbps,Monitor.AudioThroughputThresholds),a.data.csioMark=this.getQuality()},InbAudioMonitor.prototype.getQuality=function(){var a=0,b=.5*this.quality.bandwidth+.5*this.quality.eModel;return b=Math.floor(b),b===Monitor.avQualityRating.excellent?a=Monitor.avQualityRatingString.excellent:b===Monitor.avQualityRating.fair?a=Monitor.avQualityRatingString.fair:b===Monitor.avQualityRating.bad&&(a=Monitor.avQualityRatingString.bad),a},InbVideoMonitor.prototype=Object.create(InboundMonitor.prototype),InbVideoMonitor.prototype.constructor=InbVideoMonitor,InbVideoMonitor.prototype.setFrameRatioQuality=function(){var a=this.frameRateReceivedTracker.getActual(),b=this.frameRateReceivedTracker.getPrevious(),c=0;this.quality.frameRate=0,void 0!==a&&void 0!==b&&null!==a&&null!==b&&0!==b&&(c=a/b,this.quality.frameRate=this.getQualityEvaluation(c,Monitor.FrameRateRatioTresholds))},InbVideoMonitor.prototype.setFrameRateReceived10=function(a){return null===a?void(this.frameRateReceived10=null):void(this.frameRateReceived10=a.actual)},InbVideoMonitor.prototype.setup=function(a){InboundMonitor.prototype.setup.call(this,a),a.data.csioMediaType=Measurement.MediaTypes.video,this.setFrameRatioQuality(),this.quality.eModel=this.getQualityReverseEvaluation(a.data.csioeM,Monitor.AudioEModelTresholds),this.quality.bandwidth=this.getQualityEvaluation(a.data.csioIntBRKbps,Monitor.VideoThroughputThresholds),a.data.csioMark=this.getQuality()},InbVideoMonitor.prototype.getQuality=function(){var a=0,b=.33*this.quality.bandwidth+.33*this.quality.eModel+.33*this.quality.frameRate;return b=Math.floor(b),b===Monitor.avQualityRating.excellent?a=Monitor.avQualityRatingString.excellent:b===Monitor.avQualityRating.fair?a=Monitor.avQualityRatingString.fair:b===Monitor.avQualityRating.bad&&(a=Monitor.avQualityRatingString.bad),a},OutboundMonitor.prototype=Object.create(Monitor.prototype),OutboundMonitor.prototype.constructor=OutboundMonitor,OutboundMonitor.prototype.setup=function(a){Monitor.prototype.setup.call(this,a);var b=new FractionLost(this.packetLostTracker.getDelta(),this.packetsSentTracker.getDelta());this.addIntervalFractionLost(b),this.setIntBRAndPR(this.bytesSentTracker,this.packetsSentTracker,a),this.getTotalTimeInMs()>0&&(a.data.csioAvgBRKbps=8*this.bytesSentTracker.getActual()/this.getTotalTimeInMs()),a.data.csioIntFL=b.getValue(),a.data.csioIntPktRcv=this.packetsSentTracker.getDelta(),a.data.csioPercentileFl=this.getIntervalFractionLost95(),a.data.csioeM=(null!==this.getRTT95()?this.getRTT95():0)+40,a.data.csioIntPktLoss=this.packetLostTracker.getDelta(),void 0!==a.data.csioAvgBRKbps&&null!==a.data.csioAvgBRKbps?a.data.csioAvgPacketSize=this.bytesSentTracker.getDelta()/this.packetsSentTracker.getDelta():a.data.csioAvgPacketSize=null,a.data.csioPktLossPercentage=this.packetLostTracker.getDelta()/this.packetsSentTracker.getDelta()*100},OutbVideoMonitor.verificationElapsedThreshold=1e4,OutbVideoMonitor.initialElapsedThreshold=15e3,OutbVideoMonitor.minStableKBpsSlack=50,OutbVideoMonitor.prototype=Object.create(OutboundMonitor.prototype),OutbVideoMonitor.prototype.constructor=OutbVideoMonitor,OutbVideoMonitor.prototype.setFrameRatioQuality=function(){var a=this.frameRateReceivedTracker.getActual(),b=this.frameRateReceivedTracker.getPrevious(),c=0;this.quality.frameRate=0,void 0!==a&&void 0!==b&&null!==a&&null!==b&&0!==b&&(c=a/b,this.quality.frameRate=this.getQualityEvaluation(c,Monitor.FrameRateRatioTresholds))},OutbVideoMonitor.prototype.setFrameRateReceived10=function(a){return null===a?void(this.frameRateReceived10=null):void(this.frameRateReceived10=a.actual)},OutbVideoMonitor.prototype.getSendingKBitrateObservations=function(){var a=this.sendingThroughputObservations;return a.ready?{ssrc:a.ssrc,maxsendingKBitrate:a.max,timeToMaxSendingKBitrate:a.maxTs-a.started,stablesendingKBitrate:a.stable,timeToStableSendingKBitrate:a.stableTs-a.started}:null},OutbVideoMonitor.prototype.checkSendingKBitrateObservations=function(a){var b=this.sendingThroughputObservations,c=(new Date).getTime();if(b.ready!==!0){if(0===b.started)return b.ssrc=this.getSSRC(),void(b.started=c);var d=a.data.csioIntBRKbps,e=Math.min(OutbVideoMonitor.minStableKBpsSlack,.05*d);b.max<d?(b.max=d,b.maxTs=c):OutbVideoMonitor.verificationElapsedThreshold<c-b.maxTs&&(b.maxVerified=!0),c-b.started<OutbVideoMonitor.initialElapsedThreshold||(d-e<a.data.csioAvgBRKbps&&a.data.csioAvgBRKbps<d+e&&(b.stableTs=c,b.stable=d,b.stableVerified=!0),b.stableVerified&&b.maxVerified&&(b.ready=!0))}},OutbVideoMonitor.prototype.setup=function(a){OutboundMonitor.prototype.setup.call(this,a),a.data.csioMediaType=Measurement.MediaTypes.video,this.setFrameRatioQuality(),this.quality.eModel=this.getQualityReverseEvaluation(a.data.csioeM,Monitor.AudioEModelTresholds),this.quality.bandwidth=this.getQualityEvaluation(a.data.csioIntBRKbps,Monitor.VideoThroughputThresholds),a.data.csioMark=this.getQuality(),this.checkSendingKBitrateObservations(a)},OutbVideoMonitor.prototype.getQuality=function(){var a=0,b=.33*this.quality.bandwidth+.33*this.quality.eModel+.33*this.quality.frameRate;return b=Math.floor(b),b===Monitor.avQualityRating.excellent?a=Monitor.avQualityRatingString.excellent:b===Monitor.avQualityRating.fair?a=Monitor.avQualityRatingString.fair:b===Monitor.avQualityRating.bad&&(a=Monitor.avQualityRatingString.bad),a},OutbAudioMonitor.prototype=Object.create(OutboundMonitor.prototype),OutbAudioMonitor.prototype.constructor=OutbAudioMonitor,OutbAudioMonitor.prototype.setEModelQuality=function(a){a<Monitor.AudioEModelTresholds.green?this.quality.eModel=Monitor.avQualityRating.excellent:a>Monitor.AudioEModelTresholds.green&&a<Monitor.AudioEModelTresholds.red?this.quality.eModel=Monitor.avQualityRating.fair:a>Monitor.AudioEModelTresholds.red&&(this.quality.eModel=Monitor.avQualityRating.bad)},OutbAudioMonitor.prototype.setThroughputQuality=function(a){null!==a&&void 0!==a&&(a>Monitor.AudioThroughputThresholds.green?this.quality.bandwidth=Monitor.avQualityRating.excellent:a>Monitor.AudioThroughputThresholds.red&&a<Monitor.AudioThroughputThresholds.green?this.quality.bandwidth=Monitor.avQualityRating.fair:a<Monitor.AudioThroughputThresholds.red&&(this.quality.bandwidth=Monitor.avQualityRating.bad));\n},OutbAudioMonitor.prototype.setup=function(a){OutboundMonitor.prototype.setup.call(this,a),this.setThroughputQuality(a.data.csioIntBRKbps),this.setEModelQuality(a.data.csioeM),a.data.csioMediaType=Measurement.MediaTypes.audio,a.data.csioMark=this.getQuality()},OutbAudioMonitor.prototype.doSend=function(){return this.hasData()===!1,!1},OutbAudioMonitor.prototype.getQuality=function(){var a=0,b=.5*this.quality.bandwidth+.5*this.quality.eModel;return b=Math.floor(b),b===Monitor.avQualityRating.excellent?a=Monitor.avQualityRatingString.excellent:b===Monitor.avQualityRating.fair?a=Monitor.avQualityRatingString.fair:b===Monitor.avQualityRating.bad&&(a=Monitor.avQualityRatingString.bad),a},Monitors.OneWayAudioDisruptionTimeout=5e3,Monitors.DisruptionsMediaType={audio:\"audio\",video:\"video\",screen:\"screen\"},Monitors.DisruptionsType={inbOneWayAudioDisruption:\"inbOneWayAudioDisruption\",outbOneWayAudioDisruption:\"outbOneWayAudioDisruption\"},Monitors.prototype={constructor:Monitors,getMonitor:function(a){var b;if(this.monitors[a.direction]&&(b=this.monitors[a.direction][a.ssrc]),void 0!==b)return this.monitors[a.direction][a.ssrc];var c=a.direction===Measurement.Direction.inbound,d=a.direction===Measurement.Direction.outbound,e=a.mediaType===Measurement.MediaTypes.audio,f=a.mediaType===Measurement.MediaTypes.video;return b=c&&e?new InbAudioMonitor:d&&e?new OutbAudioMonitor:c&&f?new InbVideoMonitor:d&&f?new OutbVideoMonitor:null,b.setSSRC(a.ssrc),this.monitors[a.direction]||(this.monitors[a.direction]={}),this.monitors[a.direction][a.ssrc]=b,b},setupCodeBase:function(a){this.assembler.setupCodeBase(a)},isSendable:function(){var a=this.sendable;return this.sendable=!1,a},process:function(a){var b=this.assembler.do(a),c=this.getMonitor(b);return null===c||void 0===c?void console.warn(\"For ssrc \"+b.ssrc+\"we do not have monitor\"):(c.doSend(b)&&(this.sendable=!0),c.add(b),void c.setup(a))},checkDistortions:function(){var a,b=[],c=[],d=this.monitors[Measurement.Direction.inbound];d&&Object.keys(d).forEach(function(c){a=d[c],a.getMediaType()===Measurement.MediaTypes.audio&&b.push(a)}),d=this.monitors[Measurement.Direction.outbound],d&&Object.keys(d).forEach(function(b){a=d[b],a.getMediaType()===Measurement.MediaTypes.audio&&c.push(a)}),[this.getInbOneWayAudioDisruption(b,c),this.getOutbOneWayAudioDisruption(b,c)].forEach(function(a){a&&Reporter.disruptions.push(a)})},getSendingThroughputObservations:function(){var a=[],b=null,c=this.monitors[Measurement.Direction.outbound];return c?(Object.keys(c).forEach(function(d){b=c[d],b.getMediaType()===Measurement.MediaTypes.video&&a.push(b.getSendingKBitrateObservations())}),a):null},getInbOneWayAudioDisruption:function(a,b){var c=this.inbOneWayAudioDisruption,d=(new Date).getTime();if(c.sent)return null;var e=b.filter(function(a){return 0===a.getStartTime()}).length<1,f=b.filter(function(a){return!a.hasTraffic()}).length<1;if(!e||f)return null;if(!a.length)return null;var g=a.filter(function(a){return!a.hasTraffic()});if(g.length<1)return c.started=0,null;if(0===c.started)return c.started=d,null;if(d-Monitors.OneWayAudioDisruptionTimeout<c.started)return null;var h=g[0].getSSRC();return c.sent=!0,{mediaType:Monitors.DisruptionsMediaType.audio,type:Monitors.DisruptionsType.inbOneWayAudioDisruption,ssrc:h}},getOutbOneWayAudioDisruption:function(a,b){var c=this.outbOneWayAudioDisruption,d=(new Date).getTime();if(c.sent)return null;var e=a.filter(function(a){return 0===a.getStartTime()}).length<1,f=a.filter(function(a){return!a.hasTraffic()}).length<1;if(!e||!f)return null;if(!b.length)return null;var g=b.filter(function(a){return!a.hasTraffic()});if(g.length<1)return c.started=0,null;if(0===c.started)return c.started=d,null;if(d-Monitors.OneWayAudioDisruptionTimeout<c.started)return null;var h=g[0].getSSRC();return c.sent=!0,{mediaType:Monitors.DisruptionsMediaType.audio,type:Monitors.DisruptionsType.outbOneWayAudioDisruption,ssrc:h}},toString:function(){return\"ToString function is not defined. for this object\"},onDataSent:function(){for(var a in this.monitors)if(this.monitors.hasOwnProperty(a))for(var b in this.monitors[a])if(this.monitors[a].hasOwnProperty(b)){var c=this.monitors[a][b];null!==c?c.onDataSent():console.warn(\"A Monitor with ssrc: \"+b+\" should not be null but it is!\")}}},Analyzer.prototype={constructor:Analyzer,onDataSent:function(){++this.sentCounter},getSendingThroughputObservations:function(){var a=this.monitors.getSendingThroughputObservations();if(!a)return null;var b=a.filter(function(a){return null===a}).length<1;return b?a:null},receive:function(a){var b=(new Date).getTime(),c=a.streams,d=a.codeBase;this.monitors.setupCodeBase(d);for(var e=0;e<c.length;++e){var f=c[e];this.monitors.process(f)}this.monitors.checkDistortions();var g=!1;if(Reporter.adaptiveSending===!1)g=this.lastForwarded+Reporter.SendingTimeTresholds.regular<b,g&&(this.output.send(c),this.lastInterval=b-this.lastForwarded,this.lastForwarded=b);else{var h=this.monitors.isSendable();if(0===this.sentCounter?g=!0:this.sentCounter<5?(g=this.lastForwarded+Reporter.SendingTimeTresholds.regular<b,h=!1):g=this.lastForwarded+Math.min(Reporter.SendingTimeTresholds.max,this.nextInterval)<b,g||h)if(this.output.send(c),this.lastInterval=b-this.lastForwarded,this.lastForwarded=b,h)this.lastInterval=Math.max(Reporter.SendingTimeTresholds.min,this.lastInterval/2);else if(g){var i=Math.random()+1;this.nextInterval=Math.min(Reporter.SendingTimeTresholds.max,this.lastInterval*i)}}}},Reporter.prototype={constructor:Reporter,fire:function(a){var b;switch(this.currentState){case this.states.Idle:switch(a){case this.events.OnStart:this.currentState=this.states.Run;break;default:console.warn(\"Unhandled event \"+a+\" in \"+this.currentState+\" mode\")}break;case this.states.Run:switch(a){case this.events.OnStop:this.currentState=this.states.Idle;break;case this.events.OnPolling:var c=arguments[1];this.analyzer.receive(c);break;case this.events.OnOneWayAudioDisruptionsRequest:if(b=arguments[1],void 0===b){console.warn(\"OnStatsRequest event required a parameter to store the response\");break}0<Reporter.disruptions.length&&(b.response=Reporter.disruptions,Reporter.disruptions=[]);break;case this.events.OnSendingThroughputObservationsRequest:if(b=arguments[1],void 0===b){console.warn(\"OnSendingThroughputObservationsRequest event required a parameter to store the response\");break}this.sendingThroughputObservationsSent===!1&&(b.response=this.analyzer.getSendingThroughputObservations(),this.sendingThroughputObservationsSent=null!==b.response);break;case this.events.OnStatsRequest:if(b=arguments[1],void 0===b){console.warn(\"OnStatsRequest event required a parameter to store the response\");break}b.response=this.senderGate.requestStats();break;default:console.warn(\"Unhandled event \"+a+\" in \"+this.currentState+\" mode\")}break;default:console.error(\"The Reporter machine is in an unkown state: \"+this.currentState)}},toString:function(){return\"Reporter is in \"+this.currentState},setReportingMode:function(a){Reporter.adaptiveSending=a===!0},setSubmissionInterval:function(a){Reporter.SendingTimeTresholds.regular=a,Reporter.adaptiveSending?(Reporter.SendingTimeTresholds.min=1e3,Reporter.SendingTimeTresholds.max=3e4):(Reporter.SendingTimeTresholds.min=a,Reporter.SendingTimeTresholds.max=a)}},module.exports.Reporter=Reporter;\n\n\n// WEBPACK FOOTER //\n// ./node_modules/react-native-callstats/statsReporter.js","/*! callstats.js  version = 3.27.0 2017-12-14 */\nfunction SlidingWindow(a,b){this.items=[],this.plugins=[],this.timeoutInMs=b,this.maxItemsNum=a,this.minItemsNum=0,this.last=null}var SWItem=require(\"./swItem\");SlidingWindow.prototype={constructor:SlidingWindow,signalize:function(a,b){for(var c=0;c<this.plugins.length;++c){var d=this.plugins[c];null!==d.signalize&&void 0!==d.signalize?d.signalize.call(d,a,b):console.warn(d)}},toString:function(){return\"\"}},SlidingWindow.prototype.getLast=function(){return this.last},SlidingWindow.prototype.setMaxItemsNum=function(a){this.maxItemsNum=a},SlidingWindow.prototype.setTimeoutInMs=function(a){this.timeoutInMs=a},SlidingWindow.prototype.setMinItemsNum=function(a){this.minItemsNum=a},SlidingWindow.prototype.refresh=function(){if(!(this.items.length<=this.minItemsNum)){for(;0<this.maxItemsNum&&this.maxItemsNum<=this.items.length;)this.remove();0<this.timeoutInMs&&this.timeoutInMs<this.items[0].getElapsed()&&(this.remove(),this.refresh())}},SlidingWindow.prototype.getItemsNum=function(){return this.items.length},SlidingWindow.prototype.add=function(a){this.refresh(),this.items.push(new SWItem(a));for(var b=0;b<this.plugins.length;b++){var c=this.plugins[b];c.add(a)}this.last=a},SlidingWindow.prototype.map=function(a){for(var b=0;b<this.plugins.length;b++){var c=this.plugins[b];c.map(a)}},SlidingWindow.prototype.remove=function(){for(var a=this.items.shift(),b=0;b<this.plugins.length;b++){var c=this.plugins[b];c.remove(a.value)}},SlidingWindow.prototype.foreach=function(a,b){var c=this.items;void 0!==b&&(c=b(c));for(var d=0;d<c.length;d++){var e=c[d];a(e.value)}},SlidingWindow.prototype.addPlugin=function(a){this.plugins.push(a)},module.exports=SlidingWindow;\n\n\n// WEBPACK FOOTER //\n// ./node_modules/react-native-callstats/slidingWindow.js","/*! callstats.js  version = 3.27.0 2017-12-14 */\nfunction SWItem(a){this.value=a,this.created=(new Date).getTime()}SWItem.prototype={constructor:SWItem,getElapsed:function(){return(new Date).getTime()-this.created},toString:function(){return\"\"}},module.exports=SWItem;\n\n\n// WEBPACK FOOTER //\n// ./node_modules/react-native-callstats/swItem.js","/*! callstats.js  version = 3.27.0 2017-12-14 */\nfunction SWPercentileTracker(a,b,c){if(SWPlugin.call(this),99<b||b<1)throw new RangeError(\"Percentile parameter must be between 1 and 99\");this.comparator=a,this.percentile=b,this.meanCalcer=\"undefined\"==typeof c?function(a,b){return(a+b)/2}:c,this.ratio=b/(100-b),this.maxtree=new BinaryTree(a),this.mintree=new BinaryTree(a),this.ratio<1?this.required=1/this.ratio+1:1<this.ratio?this.required=this.ratio+1:this.required=2,this.maxcounter=this.mincounter=0,this.result=null,this.filter=null}var SWPercentileNotification=require(\"./swPercentileNotification\"),BinaryTree=require(\"./binaryTree\"),SWPlugin=require(\"./swPlugin\");SWPercentileTracker.prototype=Object.create(SWPlugin.prototype),SWPercentileTracker.prototype.constructor=SWPercentileTracker,SWPercentileTracker.prototype.addFilter=function(a,b){this.filter={callback:a,that:b}},SWPercentileTracker.prototype.doFilter=function(a){return null===this.filter||(void 0===this.filter.that||null===this.filter.that?this.filter.callback(a):this.filter.callback.call(this.filter.that,a))},SWPercentileTracker.prototype.getResult=function(){return this.result},SWPercentileTracker.prototype.add=function(a){if(this.doFilter(a)){if(this.maxcounter<1)return this.maxtree.insert(a),void++this.maxcounter;this.comparator(a,this.maxtree.getTopValue())<=0?(this.maxtree.insert(a),++this.maxcounter):(this.mintree.insert(a),++this.mincounter),this.balancing(),this.calculate()}},SWPercentileTracker.prototype.remove=function(a){if(this.doFilter(a)){if(this.maxtree.delete(a))--this.maxcounter;else{if(!this.mintree.delete(a))throw new ReferenceError(\"The requested value \"+a+\" is not found in trees\");--this.mincounter}this.balancing(),this.calculate()}},SWPercentileTracker.prototype.balancing=function(){var a=function(){for(var a=(this.maxcounter+1)/(this.mincounter-1);;a=(this.maxcounter+1)/(this.mincounter-1)){if(this.ratio<a||this.mincounter<1)return;this.maxtree.insertByTop(this.mintree.deleteBottomValue()),++this.maxcounter,--this.mincounter}},b=function(){for(var a=(this.maxcounter-1)/(this.mincounter+1);;a=(this.maxcounter-1)/(this.mincounter+1)){if(a<this.ratio||this.maxcounter<1)return;this.mintree.insertByBottom(this.maxtree.deleteTopValue()),++this.mincounter,--this.maxcounter}};if(!(this.maxcounter+this.mincounter<this.required)){if(this.mincounter<1)return void b.call(this);if(this.maxcounter<1)return void a.call(this);var c=this.maxcounter/this.mincounter;this.ratio<c?b.call(this):a.call(this)}},SWPercentileTracker.prototype.calculate=function(){var a,b,c=new SWPercentileNotification,d=null,e=this.mincounter+this.maxcounter;if(!(e<1)){if(this.mincounter<1?(b=this.maxtree.getTopValue(),a=this.maxtree.getBottomValue()):this.maxcounter<1?(b=this.mintree.getTopValue(),a=this.mintree.getBottomValue()):(b=this.mintree.getTopValue(),a=this.maxtree.getBottomValue()),c.min=a,c.max=b,c.tracked=e,e<this.required||this.mincounter<1)return d=this.ratio<1?a:1<this.ratio?b:this.meanCalcer(a,b),c.actual=d,c.estimated=!0,this.result=c,void this.notify(this.result);var f=this.maxcounter/this.mincounter;d=this.ratio<f?this.maxtree.getTopValue():f<this.ratio?this.mintree.getBottomValue():this.meanCalcer(this.mintree.getBottomValue(),this.maxtree.getTopValue()),c.actual=d,this.result=c,this.notify(this.result)}},SWPercentileTracker.prototype.map=function(a){this.mapping(this.result.actual,a)},module.exports=SWPercentileTracker;\n\n\n// WEBPACK FOOTER //\n// ./node_modules/react-native-callstats/swPercentileTracker.js","/*! callstats.js  version = 3.27.0 2017-12-14 */\nfunction SWPercentileNotification(){this.estimated=!1,this.tracked=0,this.max=this.min=this.actual=null}SWPercentileNotification.prototype={constructor:SWPercentileNotification,toString:function(){return\"Tracked: \"+this.tracked+\" Estimated: \"+this.estimated+\" Min: \"+this.min+\" Max: \"+this.max+\" Actual: \"+this.actual}},module.exports=SWPercentileNotification;\n\n\n// WEBPACK FOOTER //\n// ./node_modules/react-native-callstats/swPercentileNotification.js","/*! callstats.js  version = 3.27.0 2017-12-14 */\nfunction BinaryTreeNode(a){this.value=[],this.value.push(a),this.left=null,this.right=null}function BinaryTree(a){this.root=null,this.top=null,this.bottom=null,this.comparator=a,this.node_counter=0,this.duplicate_counter=0}BinaryTreeNode.prototype={constructor:BinaryTreeNode,toString:function(){return this.value.toString()}},BinaryTree.prototype={constructor:BinaryTree},BinaryTree.prototype.getTop=function(){return this.top},BinaryTree.prototype.getTopValue=function(){return null===this.top?null:this.top.value[0]},BinaryTree.prototype.getBottomValue=function(){return null===this.bottom?null:this.bottom.value[0]},BinaryTree.prototype.getBottom=function(){return this.bottom},BinaryTree.prototype.getDuplicatedCounter=function(){return this.duplicate_counter},BinaryTree.prototype.getNodeCounter=function(){return this.node_counter},BinaryTree.prototype.getSize=function(){return this.duplicate_counter+this.node_counter},BinaryTree.prototype.logTree=function(){function a(b,c,d){if(null!==b){for(var e=\"-\",f=0;f<c;++f)e+=\"--\";console.log(e+\"> (\"+d+\") values: [\"+b.value.toString()+\"]\"),null!==b.left&&a(b.left,c+1,\"Left\"),null!==b.right&&a(b.right,c+1,\"Right\")}}return null===this.root?void console.log(\"This tree is empty\"):(console.log(\"Size of the tree: \"+this.getSize()+\" Node: \"+this.getNodeCounter()+\" Duplicates: \"+this.getDuplicatedCounter()+\" Top: \"+this.getTop().toString()+\" Bottom: \"+this.getBottom().toString()),void a(this.root,0,\"Root\"))},BinaryTree.prototype.insertByTop=function(a){this.inserting(a,this.top)},BinaryTree.prototype.insertByBottom=function(a){this.inserting(a,this.bottom)},BinaryTree.prototype.insert=function(a){this.inserting(a,this.root)},BinaryTree.prototype.inserting=function(a,b){var c=function(){var b=new BinaryTreeNode(a);return(null===this.top||this.comparator(this.top.value[0],b.value[0])<0)&&(this.top=b),(null===this.bottom||this.comparator(b.value[0],this.bottom.value[0])<0)&&(this.bottom=b),b};if(null===this.root)return this.root=c.call(this),void(this.node_counter=1);for(var d=null,e=b,f=0,g=function(b){return b===a};null!==e;){if(f=this.comparator(a,e.value[0]),0===f)return void(e.value.find(g)||(e.value.push(a),++this.duplicate_counter));d=e,e=f<0?e.left:e.right}++this.node_counter,f<0?d.left=c.call(this):d.right=c.call(this)},BinaryTree.prototype.search=function(a){for(var b,c=this.root,d=null,e=function(b){return b===a};null!==c;){if(b=this.comparator(a,c.value[0]),0===b)return c.value.find(e)?(c.parent=d,c):null;d=c,c=b<0?c.left:c.right}return null},BinaryTree.prototype.getRightist=function(a){for(var b=null;null!==a.right;)b=a,a=a.right;return a.parent=b,a},BinaryTree.prototype.getLeftist=function(a){for(var b=null;null!==a.left;)b=a,a=a.left;return a.parent=b,a},BinaryTree.prototype.deleteBottomValue=function(){for(;null===this.bottom;)return null;var a=this.bottom.value[0];return this.delete(a),a},BinaryTree.prototype.deleteTopValue=function(){for(;null===this.top;)return null;var a=this.top.value[0];return this.delete(a),a},BinaryTree.prototype.delete=function(a){var b=null,c=function(a,b,c){null!==b?b.left===a?b.left=c:b.right=c:this.root=c},d=function(a){return null===this.root?void(this.bottom=this.top=null):(0===this.comparator(this.top.value[0],a.value[0])&&(this.top=this.getRightist(this.root)),void(0===this.comparator(this.bottom.value[0],a.value[0])&&(this.bottom=this.getLeftist(this.root))))};if(b=this.search(a),null===b)return!1;if(1<b.value.length)return b.value.splice(b.value.indexOf(a),1),--this.duplicate_counter,!0;if(--this.node_counter,null===b.left&&null===b.right)c.call(this,b,b.parent,null);else if(null===b.left)c.call(this,b,b.parent,b.right);else if(null===b.right)c.call(this,b,b.parent,b.left);else{for(var e=b.left,f=b;null!==e.right;f=e,e=e.right);f===b?f.left=e.left:f.right=e.left,b.value.shift(),b.value=b.value.concat(e.value)}return d.call(this,b),!0},module.exports=BinaryTree;\n\n\n// WEBPACK FOOTER //\n// ./node_modules/react-native-callstats/binaryTree.js","/*! callstats.js  version = 3.27.0 2017-12-14 */\nfunction SWAvg(a){SWPlugin.call(this),this.avg=0,this.sum=0,this.count=0,this.filter=null,void 0===a?this.extractor=function(a){return a}:this.extractor=a}var SWPlugin=require(\"./swPlugin\");SWAvg.prototype=Object.create(SWPlugin.prototype),SWAvg.prototype.constructor=SWAvg,SWAvg.prototype.add=function(a){(null===this.filter||void 0===this.filter||this.filter(a))&&(this.sum+=parseInt(this.extractor(a)),++this.count,this.calc(this))},SWAvg.prototype.addFilter=function(a){this.filter=a},SWAvg.prototype.remove=function(a){(null===this.filter||void 0===this.filter||this.filter(a))&&(this.sum-=parseInt(this.extractor(a)),--this.count,this.calc(this))},SWAvg.prototype.calc=function(){this.count<1||(this.avg=this.sum/this.count,this.notify(this.avg))},SWAvg.prototype.getResult=function(){return this.avg},module.exports=SWAvg;\n\n\n// WEBPACK FOOTER //\n// ./node_modules/react-native-callstats/swAvg.js","/*! callstats.js  version = 3.27.0 2017-12-14 */\nfunction pcCallbackHandler(a,b,c,d,e){this.pc=a,this.onIceCandidateCallback=b,this.onIceConnectionStateChangeCallback=c,this.onPcSignalingStateChangeCallback=d,this.onPcNegotiationNeededCallback=e,a.addEventListener?(this.pc.addEventListener(\"icecandidate\",this.iceCandidateCallback.bind(this),!1),this.pc.addEventListener(\"iceconnectionstatechange\",this.iceConnectionStateChangeCallback.bind(this),!1),this.pc.addEventListener(\"signalingstatechange\",this.pcSignalingStateChangeCallback.bind(this),!1),this.pc.addEventListener(\"negotiationneeded\",this.pcNegotiationNeededCallback.bind(this),!1)):a.attachEvent&&(this.pc.attachEvent(\"onicecandidate\",this.iceCandidateCallback.bind(this)),this.pc.attachEvent(\"oniceconnectionstatechange\",this.iceConnectionStateChangeCallback.bind(this)),this.pc.attachEvent(\"onsignalingstatechange\",this.pcSignalingStateChangeCallback.bind(this)),this.pc.attachEvent(\"onnegotiationneeded\",this.pcNegotiationNeededCallback.bind(this)))}pcCallbackHandler.prototype.iceCandidateCallback=function(a){try{this.onIceCandidateCallback(a,this.pc)}catch(a){console.log(\"onIceCandidateCallback: Error\",a)}},pcCallbackHandler.prototype.iceConnectionStateChangeCallback=function(a){try{this.onIceConnectionStateChangeCallback(a,this.pc)}catch(a){console.log(\"onIceConnectionStateChangeCallback: Error\",a)}},pcCallbackHandler.prototype.pcSignalingStateChangeCallback=function(a){try{this.onPcSignalingStateChangeCallback(a,this.pc)}catch(a){console.log(\"onPcSignalingStateChangeCallback: Error\",a)}},pcCallbackHandler.prototype.pcNegotiationNeededCallback=function(a){try{this.onPcNegotiationNeededCallback(a,this.pc)}catch(a){console.log(\"onPcNegotiationNeededCallback: Error\",a)}},module.exports=pcCallbackHandler;\n\n\n// WEBPACK FOOTER //\n// ./node_modules/react-native-callstats/pcCallbackHandler.js","/*! precalltest  version = 1.1.5 2018-01-11 */\n\n\"use strict\";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.PreCallTest=void 0;var _createClass=function(){function t(t,e){for(var s=0;s<e.length;s++){var n=e[s];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,s,n){return s&&t(e.prototype,s),n&&t(e,n),e}}(),_turnConnection=require(\"./turnConnection\"),_rttTest=require(\"./tests/rttTest\"),_throughputTest=require(\"./tests/throughputTest\"),_resultsHandler=require(\"./utility/resultsHandler\"),_onlineCheck=require(\"./utility/onlineCheck\"),_detectbrowser=require(\"./utility/stats/detectbrowser\"),Promise=require(\"bluebird\"),TEST_NAMES={RTT:\"rtt\",THROUGHPUT:\"throughput\"},FAILURE_RETRIES=10,PreCallTest=function(){function t(){_classCallCheck(this,t),this.browserInfo=(0,_detectbrowser.detect)(),this.turnConnection=new _turnConnection.TurnConnection(this.browserInfo),this.onlineCheck=new _onlineCheck.OnlineCheck,this.callsInProgress=0,this.turnTests=[TEST_NAMES.RTT,TEST_NAMES.THROUGHPUT],this.active=!1,this.rtt=null,this.resultsHandler=null}return _createClass(t,[{key:\"start\",value:function(t,e){if(this.browserInfo.browserName!==_detectbrowser.Constants.browserName.msie&&(!window||!window.csioReactNative)&&(this.iceServers=t,this.callback=e,!this.active&&!(this.callsInProgress>0)&&t)){this.turnTestCounter=0,this.resultsHandler=new _resultsHandler.ResultsHandler;var s={type:\"browser\",os:this.browserInfo.os,osVersion:this.browserInfo.osVersion,buildName:this.browserInfo.browserName,buildVersion:this.browserInfo.browserVersion};this.resultsHandler.add(\"endpointInfo\",s),this.onlineCheck.start(),this.active=!0,this._start()}}},{key:\"_start\",value:function(){var t=this;this.active&&this.turnConnection.connect(this.iceServers).then(function(){t.active&&t.startTurnTests().then(function(){t.stop()},function(e){t.stop()})},function(e){t.resultsHandler.failure(e),t.resultsHandler.getFailureNumber()>=FAILURE_RETRIES?t.stop():(t.turnConnection.disconnect(),setTimeout(function(){t._start()},0))})}},{key:\"stop\",value:function(){var t=this;if(this.browserInfo.browserName!==_detectbrowser.Constants.browserName.msie&&this.active){this.active=!1,this.activeTurnTest&&this.activeTurnTest.forceStop();var e=this.onlineCheck.stop();this.resultsHandler.add(\"onlineStatus\",e),this.turnConnection.getIceResults().then(function(e){t.resultsHandler.add(\"ice\",e),t.turnConnection.disconnect(),t.sendResults()},function(e){t.resultsHandler.failure(e),t.turnConnection.disconnect(),t.sendResults()})}}},{key:\"sendResults\",value:function(){var t=this.resultsHandler.getResults();this.callback&&this.callback(t),this.resultsHandler=null}},{key:\"callStarts\",value:function(){this.callsInProgress+=1,this.stop()}},{key:\"callFinished\",value:function(){this.callsInProgress-=1}},{key:\"getId\",value:function(){return this.resultsHandler?this.resultsHandler.getId():null}},{key:\"crashDisconnect\",value:function(){try{this.turnConnection.disconnect()}catch(t){}}},{key:\"startTurnTests\",value:function(){var t=this;if(this.turnTestCounter>=this.turnTests.length)return new Promise(function(t,e){t()});var e=this.turnTests[this.turnTestCounter],s=null;switch(e){case TEST_NAMES.RTT:s=new _rttTest.RttTest(this.turnConnection);break;case TEST_NAMES.THROUGHPUT:s=new _throughputTest.ThroughputTest(this.turnConnection,this.rtt);break;default:return new Promise(function(t,s){s(new Error(\"Unknown test: \"+e))})}return this.activeTurnTest=s,this.active?s.start().then(function(){return t.handleTestResults(e,s.getResults()),t.turnTestCounter+=1,t.activeTurnTest=null,t.startTurnTests()},function(n){return t.handleTestResults(e,s.getResults(),n),t.turnTestCounter+=1,t.activeTurnTest=null,t.startTurnTests()}):new Promise(function(t,e){e(new Error(\"Test trying to start while testing is not active\"))})}},{key:\"handleTestResults\",value:function(t,e){null==(arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)&&t==TEST_NAMES.RTT&&(this.rtt=e.median),this.resultsHandler&&this.resultsHandler.add(t,e)}}]),t}();exports.PreCallTest=PreCallTest;\n\n\n// WEBPACK FOOTER //\n// ./node_modules/precalltest/dist/main.js","/*! precalltest  version = 1.1.5 2018-01-11 */\n\n\"use strict\";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.TurnConnection=void 0;var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_parsedIceCandidate=require(\"./utility/parsedIceCandidate\"),_getstatshandler=require(\"./utility/stats/getstatshandler\"),_detectbrowser=require(\"./utility/stats/detectbrowser\"),Promise=require(\"bluebird\"),ICE_CHECKING_TIMEOUT=1e4,CONNECTION_TIMEOUT=3e4,TurnConnection=function(){function e(t){_classCallCheck(this,e),this.reset(),this.statshandler=new _getstatshandler.GetStatsHandler(t)}return _createClass(e,[{key:\"reset\",value:function(){this.iceServers=null,this.pctpc1=null,this.pctpc2=null,this.sendChannel=null,this.messageCallback=null,this.errorCallback=null,this.parsedIceResults={}}},{key:\"setMessageCallback\",value:function(e){this.messageCallback=e}},{key:\"setErrorCallback\",value:function(e){this.errorCallback=e}},{key:\"send\",value:function(e){if(this.sendChannel)try{this.sendChannel.send(e)}catch(e){this.raiseSendError(e)}else this.raiseSendError(new Error(\"No send channel\"))}},{key:\"raiseSendError\",value:function(e){this.errorCallback&&this.errorCallback(e)}},{key:\"assignEvent\",value:function(e,t,n){e.addEventListener?e.addEventListener(t,n.bind(this),!1):e.attachEvent&&(t=\"on\"+t,e.attachEvent(t,n.bind(this)))}},{key:\"connect\",value:function(e){var t=this;this.reset();var n=new Promise(function(e,n){t.resolveCb=e,t.rejectCb=n});this.iceServers=e;var r=null;try{if(RTCPeerConnection?r=RTCPeerConnection:webkitRTCPeerConnection?r=webkitRTCPeerConnection:mozRTCPeerConnection?r=mozRTCPeerConnection:window&&window.RTCPeerConnection&&(r=window.RTCPeerConnection),!r)return this.rejectCb(new Error(\"RTCPeerConnection not found\")),n}catch(e){return this.rejectCb(e),n}var c={ordered:!1,maxRetransmits:0},i={iceTransportPolicy:\"all\",iceServers:this.iceServers};try{this.pctpc1=new r(i),this.pctpc2=new r(i)}catch(e){return this.rejectDisconnect(e),n}return this.connectionTimer=setTimeout(function(){delete t.connectionTimer,t.rejectDisconnect(new Error(\"Connection timeout\"))},CONNECTION_TIMEOUT),this.sendChannel=this.pctpc1.createDataChannel(\"precalltest\",c),this.sendChannel.binaryType=\"arraybuffer\",this.assignEvent(this.sendChannel,\"error\",function(e){t.raiseSendError(e),t.rejectDisconnect(e)}),this.assignEvent(this.pctpc2,\"datachannel\",function(e){var n=e.channel;t.assignEvent(n,\"open\",function(e){t.resolveCb&&(t.resolveCb(),t.resolveCb=null)}),t.assignEvent(n,\"close\",function(e){t&&t.disconnect&&t.disconnect()}),t.assignEvent(n,\"message\",function(e){t.messageCallback&&t.messageCallback(e.data)}),t.assignEvent(n,\"error\",function(e){t.errorCallback&&t.errorCallback(e),t.rejectDisconnect(e)})}),this.assignEvent(this.pctpc1,\"icecandidate\",function(e){t.onIceCandidate(t.pctpc1,e)}),this.assignEvent(this.pctpc1,\"iceconnectionstatechange\",function(e){t.onIceStateChange(t.pctpc1,e)}),this.assignEvent(this.pctpc2,\"icecandidate\",function(e){t.onIceCandidate(t.pctpc2,e)}),this.assignEvent(this.pctpc2,\"iceconnectionstatechange\",function(e){t.onIceStateChange(t.pctpc2,e)}),this.pctpc1.createOffer().then(function(e,n){t.onCreateOfferSuccess(e)},function(e){t.onCreateOfferError(t.pctpc1,e)}),n}},{key:\"rejectDisconnect\",value:function(e){this.rejectCb&&(this.rejectCb(e),this.disconnect())}},{key:\"disconnect\",value:function(){if(clearTimeout(this.connectionTimer),clearTimeout(this.iceTimer),this.pctpc1)try{this.pctpc1.close()}catch(e){}if(this.pctpc1=null,this.pctpc2)try{this.pctpc2.close()}catch(e){}this.pctpc2=null,this.resolveCb=null,this.rejectCb=null}},{key:\"getName\",value:function(e){return e===this.pctpc1?\"pctpc1\":\"pctpc2\"}},{key:\"getOtherPc\",value:function(e){return e===this.pctpc1?this.pctpc2:this.pctpc1}},{key:\"onCreateOfferError\",value:function(e,t){this.rejectDisconnect(t)}},{key:\"onCreateAnswerError\",value:function(e,t){this.rejectDisconnect(t)}},{key:\"onCreateOfferSuccess\",value:function(e){var t=this;this.pctpc1.setLocalDescription(e).then(function(){t.onSetLocalSuccess(t.pctpc1)},function(e){t.onSetSessionDescriptionError(t.pctpc1,e)}),this.pctpc2.setRemoteDescription(e).then(function(){t.onSetRemoteSuccess(t.pctpc2)},function(e){t.onSetRemoteSessionDescriptionError(t.pctpc2,e)}),this.pctpc2.createAnswer().then(function(e){t.onCreateAnswerSuccess(e)},function(e){t.onCreateAnswerError(t.pctpc2,e)})}},{key:\"onSetLocalSuccess\",value:function(e){}},{key:\"onSetRemoteSuccess\",value:function(e){}},{key:\"onSetSessionDescriptionError\",value:function(e,t){this.rejectDisconnect(t)}},{key:\"onSetRemoteSessionDescriptionError\",value:function(e,t){this.rejectDisconnect(t)}},{key:\"onCreateAnswerSuccess\",value:function(e){var t=this;this.pctpc2.setLocalDescription(e).then(function(){t.onSetLocalSuccess(t.pctpc2)},function(e){t.onSetSessionDescriptionError(t.pctpc2,e)}),this.pctpc1.setRemoteDescription(e).then(function(){t.onSetRemoteSuccess(t.pctpc1)},function(e){t.onSetRemoteSessionDescriptionError(t.pctpc1,e)})}},{key:\"onIceCandidate\",value:function(e,t){var n=this;if(t.candidate){var r=new _parsedIceCandidate.ParsedIceCandidate(t.candidate);e==this.pctpc1&&this.statshandler.codeBase==_detectbrowser.Constants.codeBaseType.chrome&&(r.isRelay()&&(r.isTypeTransportUdp()&&(this.parsedIceResults.relayUdpGathered=!0),r.isTypeTransportTcp()&&(this.parsedIceResults.relayTcpGathered=!0),r.isTypeTransportTls()&&(this.parsedIceResults.relayTlsGathered=!0)),r.isServerReflexive()&&(this.parsedIceResults.srflxGathered=!0)),r.isRelay()&&this.getOtherPc(e).addIceCandidate(t.candidate).then(function(){n.onAddIceCandidateSuccess(e)},function(t){n.onAddIceCandidateError(e,t,r.isRelay())})}}},{key:\"onAddIceCandidateSuccess\",value:function(e){}},{key:\"onAddIceCandidateError\",value:function(e,t,n){n&&this.rejectDisconnect(t)}},{key:\"onIceStateChange\",value:function(e,t){var n=this,r=\"(?)\";e&&(r=e.iceConnectionState),\"failed\"===r&&this.rejectDisconnect(new Error(\"ICE failure\")),\"checking\"!==r||this.iceTimer||(this.iceTimer=setTimeout(function(){delete n.iceTimer,n.rejectDisconnect(new Error(\"ICE timeout\"))},ICE_CHECKING_TIMEOUT)),\"completed\"!==r&&\"connected\"!==r||(clearTimeout(this.iceTimer),delete this.iceTimer)}},{key:\"getIceResults\",value:function(){var e=this;return new Promise(function(t,n){var r=e.iceServers,c=!0,i=!1,a=void 0;try{for(var s,o=r[Symbol.iterator]();!(c=(s=o.next()).done);c=!0){var l=s.value;r.hasOwnProperty(l)||delete l.credential}}catch(e){i=!0,a=e}finally{try{!c&&o.return&&o.return()}finally{if(i)throw a}}var d={turnIpAddress:\"\",turnIpVersion:\"\",turnTransport:\"\",iceServers:r,ipv6Supported:!1,ipv4Supported:!1,relayTlsGathered:!1,relayTcpGathered:!1,relayUdpGathered:!1,srflxGathered:!1,relayTlsSuccess:!1,relayTcpSuccess:!1,relayUdpSuccess:!1,srflxSuccess:!1};for(var u in e.parsedIceResults)e.parsedIceResults.hasOwnProperty(u)&&(d[u]=e.parsedIceResults[u]);e.pctpc1?e.statshandler.getIceCandidates(e.pctpc1).then(function(e){var n=!0,r=!1,c=void 0;try{for(var i,a=e.iceCandidatePairs[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;if(s.googActiveConnection||s.selected){var o=!0,l=!1,u=void 0;try{for(var p,h=e.localCandidates[Symbol.iterator]();!(o=(p=h.next()).done);o=!0){var f=p.value,v=null;if(v=f.ip?f.ip:f.ipAddress,f.id==s.localCandidateId){d.turnIpAddress=v;var y=-1!==v.indexOf(\":\");d.turnIpVersion=y?\"ipv6\":\"ipv4\",d.turnTransport=f.mozLocalTransport,!0}\"relay\"!==f.candidateType&&\"relayed\"!==f.candidateType||(\"udp\"===f.mozLocalTransport&&(d.relayUdpSuccess=!0),\"tcp\"===f.mozLocalTransport&&(d.relayTcpSuccess=!0),\"tls\"===f.mozLocalTransport&&(d.relayTlsSuccess=!0)),-1!==v.indexOf(\":\")?d.ipv6Supported=!0:d.ipv4Supported=!0}}catch(e){l=!0,u=e}finally{try{!o&&h.return&&h.return()}finally{if(l)throw u}}}}}catch(e){r=!0,c=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw c}}var C=!0,T=!1,S=void 0;try{for(var m,E=e.localCandidates[Symbol.iterator]();!(C=(m=E.next()).done);C=!0){var b=m.value;\"relay\"!==b.candidateType&&\"relayed\"!==b.candidateType||(\"udp\"===b.mozLocalTransport&&(d.relayUdpGathered=!0),\"tcp\"===b.mozLocalTransport&&(d.relayTcpGathered=!0),\"tls\"===b.mozLocalTransport&&(d.relayTlsGathered=!0)),\"srflx\"!==b.candidateType&&\"serverreflexive\"!==b.candidateType||(d.srflxGathered=!0)}}catch(e){T=!0,S=e}finally{try{!C&&E.return&&E.return()}finally{if(T)throw S}}var I=!0,k=!1,w=void 0;try{for(var g,R=e.iceCandidatePairs[Symbol.iterator]();!(I=(g=R.next()).done);I=!0){var D=g.value;if(\"succeeded\"===D.state){var P=!0,x=!1,j=void 0;try{for(var O,_=e.localCandidates[Symbol.iterator]();!(P=(O=_.next()).done);P=!0){var L=O.value;L.id==D.localCandidateId&&(\"relay\"!==L.candidateType&&\"relayed\"!==L.candidateType||(\"udp\"===L.mozLocalTransport&&(d.relayUdpSuccess=!0),\"tcp\"===L.mozLocalTransport&&(d.relayTcpSuccess=!0),\"tls\"===L.mozLocalTransport&&(d.relayTlsSuccess=!0)),\"srflx\"!==L.candidateType&&\"serverreflexive\"!==L.candidateType||(d.srflxSuccess=!0))}}catch(e){x=!0,j=e}finally{try{!P&&_.return&&_.return()}finally{if(x)throw j}}}}}catch(e){k=!0,w=e}finally{try{!I&&R.return&&R.return()}finally{if(k)throw w}}t(d)},function(e){n(e)}):n(new Error(\"PC not available for stats\"))},function(e){reject(e)})}}]),e}();exports.TurnConnection=TurnConnection;\n\n\n// WEBPACK FOOTER //\n// ./node_modules/precalltest/dist/turnConnection.js","/*! precalltest  version = 1.1.5 2018-01-11 */\n\n\"use strict\";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}Object.defineProperty(exports,\"__esModule\",{value:!0});var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),ParsedIceCandidate=function(){function e(t){_classCallCheck(this,e),this.iceCandidateStr=t.candidate,this.parse()}return _createClass(e,[{key:\"parse\",value:function(){var e=this.iceCandidateStr.split(\" \");e.length<8||(this.protocol=\"1\"===e[1]?\"rtp\":\"rtcp\",this.transport=e[2],this.typeTransport=this.extractTypeTransport(e[3]),this.ipv6=-1!==e[4].indexOf(\":\"),this.ipAddress=e[4],this.port=e[5],this.type=e[7])}},{key:\"extractTypeTransport\",value:function(e){var t=\"None\",r=e>>24;if(\"rtp\"===this.protocol&&r>=0&&r<=2)switch(r){case 0:t=\"TLS\";break;case 1:t=\"TCP\";break;case 2:t=\"UDP\"}return t}},{key:\"getString\",value:function(){return this.iceCandidateStr}},{key:\"getType\",value:function(){return this.type}},{key:\"isHost\",value:function(){return\"host\"===this.type.toLowerCase()}},{key:\"isServerReflexive\",value:function(){return\"srflx\"===this.type.toLowerCase()}},{key:\"isPeerReflexive\",value:function(){return\"prflx\"===this.type.toLowerCase()}},{key:\"isRelay\",value:function(){return\"relay\"===this.type.toLowerCase()||\"relayed\"===this.type.toLowerCase()}},{key:\"getTypeTransport\",value:function(){return this.typeTransport}},{key:\"isTypeTransportUdp\",value:function(){return\"UDP\"===this.typeTransport}},{key:\"isTypeTransportTcp\",value:function(){return\"TCP\"===this.typeTransport}},{key:\"isTypeTransportTls\",value:function(){return\"TLS\"===this.typeTransport}},{key:\"getTransport\",value:function(){return this.transport}},{key:\"isUdp\",value:function(){return\"udp\"===this.transport.toLowerCase()}},{key:\"isTcp\",value:function(){return\"tcp\"===this.transport.toLowerCase()}},{key:\"getProtocol\",value:function(){return this.protocol}},{key:\"isRtp\",value:function(){return\"rtp\"===this.protocol}},{key:\"isRtcp\",value:function(){return\"rtcp\"===this.protocol}},{key:\"isIpv6\",value:function(){return this.ipv6}},{key:\"getIpAddress\",value:function(){return this.ipAddress}},{key:\"getPort\",value:function(){return this.port}}]),e}();exports.ParsedIceCandidate=ParsedIceCandidate;\n\n\n// WEBPACK FOOTER //\n// ./node_modules/precalltest/dist/utility/parsedIceCandidate.js","/*! precalltest  version = 1.1.5 2018-01-11 */\n\n\"use strict\";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.GetStatsHandler=void 0;var _createClass=function(){function t(t,e){for(var s=0;s<e.length;s++){var a=e[s];a.enumerable=a.enumerable||!1,a.configurable=!0,\"value\"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,s,a){return s&&t(e.prototype,s),a&&t(e,a),e}}(),_detectbrowser=require(\"./detectbrowser\"),_statsadapter=require(\"./statsadapter\"),Promise=require(\"bluebird\"),GetStatsHandler=function(){function t(e){_classCallCheck(this,t),this.codeBase=e.codeBase,this.browserName=e.browserName,this.adapter=new _statsadapter.StatsAdapter(this.codeBase,this.browserName),this.isPromiseBased=!0}return _createClass(t,[{key:\"getIceCandidates\",value:function(t){var e=this;return new Promise(function(s,a){e.csioGetStats(e.iceCandidatesHandler.bind(e),t,function(t){s(t)})})}},{key:\"iceCandidatesHandler\",value:function(t,e){e(this.adapter.getIceCandidates(t))}},{key:\"csioGetStats\",value:function(t,e,s){var a=_detectbrowser.Constants.codeBaseType.firefox,n=_detectbrowser.Constants.codeBaseType.chrome,i=_detectbrowser.Constants.codeBaseType.edge,r=_detectbrowser.Constants.browserName.safari;e&&(this.codeBase===a?this.getStatsFirefox(t,e,s):this.browserName===r?this.getStatsSafari(t,e,s):this.codeBase===n?this.getStatsChrome(t,e,s):this.codeBase===i&&this.getStatsEdge(t,e,s))}},{key:\"getStatsFirefox\",value:function(t,e,s){var a=this;if(a.isPromiseBased)try{e.getStats().then(function(e){t(e,s)}).catch(function(n){a.isPromiseBased=!1,e.getStats(null,function(e){t(e,s)},function(){})})}catch(n){a.isPromiseBased=!1,e.getStats(null,function(e){t(e,s)},function(){})}else e.getStats(null,function(e){t(e,s)},function(){})}},{key:\"getStatsChrome\",value:function(t,e,s){var a=this;if(window&&window.csioReactNative)e.getStats(null,function(e){t(e,s)},function(t){});else if(a.isPromiseBased)try{e.getStats().then(function(e){t(e,s)}).catch(function(n){a.isPromiseBased=!1,e.getStats(function(e){t(e,s)})})}catch(a){isPromiseBased=!1,e.getStats(function(e){t(e,s)})}else e.getStats(function(e){t(e,s)})}},{key:\"getStatsEdge\",value:function(t,e,s){e.getStats().then(function(e){t(e,s)}).catch(function(t){})}},{key:\"getStatsSafari\",value:function(t,e,s){e.getStats().then(function(e){t(e,s)}).catch(function(t){})}}]),t}();exports.GetStatsHandler=GetStatsHandler;\n\n\n// WEBPACK FOOTER //\n// ./node_modules/precalltest/dist/utility/stats/getstatshandler.js","/*! precalltest  version = 1.1.5 2018-01-11 */\n\n\"use strict\";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.StatsAdapter=void 0;var _createClass=function(){function t(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,a,r){return a&&t(e.prototype,a),r&&t(e,r),e}}(),_detectbrowser=require(\"./detectbrowser\"),StatsAdapter=function(){function t(e,a){_classCallCheck(this,t),this.codeBase=e,this.browser=a}return _createClass(t,[{key:\"getIceCandidates\",value:function(t){if(!t)return null;var e=this.extractRawStats(t);return this.processRawStatsForIceInfo(e)}},{key:\"extractRawStats\",value:function(t){var e=[],a=void 0,r=_detectbrowser.Constants.codeBaseType.firefox,s=_detectbrowser.Constants.codeBaseType.chrome,o=_detectbrowser.Constants.browserName.safari;if(this.codeBase===r&&this.browser!==o)t.forEach(function(t){e.push(t)});else if(this.codeBase===s&&this.browser!==o)t&&t.result?e=t.result():t&&t.forEach&&(e=[],t.forEach(function(t){e.push(t)}));else for(a in t)t.hasOwnProperty(a)&&e.push(t[a]);return e}},{key:\"processRawStatsForIceInfo\",value:function(t){var e=[],a=[],r=[],s=void 0;if(!t)return null;for(var o=0;o<t.length;++o){var n=this.getParsedStats(t[o]),i=this.statsClassifier(n);if(i.candidatePair)r.push(i.candidatePair);else if(i.transportStats){if(\"transport\"===i.transportStats.type){s=i.transportStats.selectedCandidatePairId;continue}r.push(i.transportStats)}else if(i.localCandidate){var c=i.localCandidate;if(\"relay\"==c.candidateType||\"relayed\"==c.candidateType){if(!c.mozLocalTransport){var d=c.priority>>24;c.mozLocalTransport=this.formatRelayType(d)}c.mozLocalTransport=c.mozLocalTransport.toLowerCase()}e.push(c)}else i.remoteCandidate&&a.push(i.remoteCandidate)}if(s)for(var l=0;l<r.length;++l)r[l].id===s&&(r[l].googActiveConnection=\"true\");return{localCandidates:e,remoteCandidates:a,iceCandidatePairs:r}}},{key:\"getParsedStats\",value:function(t){var e={};if(t.timestamp instanceof Date&&(e.timestamp=t.timestamp.getTime().toString()),t.type&&(e.type=t.type),t.names)for(var a=t.names(),r=0;r<a.length;++r)e[a[r]]=t.stat(a[r]);else Object.assign(e,t);if(e.values){var s=!0,o=!1,n=void 0;try{for(var i,c=e.values[Symbol.iterator]();!(s=(i=c.next()).done);s=!0){var d=i.value;Object.assign(e,d)}}catch(t){o=!0,n=t}finally{try{!s&&c.return&&c.return()}finally{if(o)throw n}}delete e.values}return e}},{key:\"statsClassifier\",value:function(t){var e={},a=function(){for(var e=arguments.length,a=Array(e),r=0;r<e;r++)a[r]=arguments[r];var s=!0,o=!1,n=void 0;try{for(var i,c=a[Symbol.iterator]();!(s=(i=c.next()).done);s=!0){var d=i.value;if(t.type===d)return!0}}catch(t){o=!0,n=t}finally{try{!s&&c.return&&c.return()}finally{if(o)throw n}}return!1},r=a(\"inbound-rtp\",\"inboundrtp\"),s=\"true\"===t.isRemote||!0===t.isRemote;return r||a(\"outbound-rtp\",\"outboundrtp\")?(e.tracks={},e.tracks.data=t,e.tracks.ssrc=t.ssrc,e.tracks.streamType=r?\"inbound\":\"outbound\",e.tracks.reportType=\"local\",void 0!==t.isRemote&&(e.tracks.reportType=s?\"remote\":\"local\")):a(\"candidatepair\")&&t.selected?e.transportStats=t:a(\"localcandidate\",\"local-candidate\")?e.localCandidate=t:a(\"remotecandidate\",\"remote-candidate\")?e.remoteCandidate=t:a(\"transport\",\"googCandidatePair\")?e.transportStats=t:a(\"VideoBwe\")?e.bwe=t:a(\"track\")?e.trackStats=t:a(\"candidate-pair\")?e.candidatePair=t:a(\"codec\")?e.codec=t:a(\"ssrc\")&&(e.tracks={},e.tracks.data=t,e.tracks.ssrc=t.ssrc,e.tracks.reportType=\"local\",e.tracks.streamType=t.bytesSent?\"outbound\":\"inbound\"),e}},{key:\"formatRelayType\",value:function(t){var e=\"none\";switch(t){case 0:e=\"tls\";break;case 1:e=\"tcp\";break;case 2:e=\"udp\"}return e}}]),t}();exports.StatsAdapter=StatsAdapter;\n\n\n// WEBPACK FOOTER //\n// ./node_modules/precalltest/dist/utility/stats/statsadapter.js","(function (global, undefined) {\n    \"use strict\";\n\n    if (global.setImmediate) {\n        return;\n    }\n\n    var nextHandle = 1; // Spec says greater than zero\n    var tasksByHandle = {};\n    var currentlyRunningATask = false;\n    var doc = global.document;\n    var registerImmediate;\n\n    function setImmediate(callback) {\n      // Callback can either be a function or a string\n      if (typeof callback !== \"function\") {\n        callback = new Function(\"\" + callback);\n      }\n      // Copy function arguments\n      var args = new Array(arguments.length - 1);\n      for (var i = 0; i < args.length; i++) {\n          args[i] = arguments[i + 1];\n      }\n      // Store and register the task\n      var task = { callback: callback, args: args };\n      tasksByHandle[nextHandle] = task;\n      registerImmediate(nextHandle);\n      return nextHandle++;\n    }\n\n    function clearImmediate(handle) {\n        delete tasksByHandle[handle];\n    }\n\n    function run(task) {\n        var callback = task.callback;\n        var args = task.args;\n        switch (args.length) {\n        case 0:\n            callback();\n            break;\n        case 1:\n            callback(args[0]);\n            break;\n        case 2:\n            callback(args[0], args[1]);\n            break;\n        case 3:\n            callback(args[0], args[1], args[2]);\n            break;\n        default:\n            callback.apply(undefined, args);\n            break;\n        }\n    }\n\n    function runIfPresent(handle) {\n        // From the spec: \"Wait until any invocations of this algorithm started before this one have completed.\"\n        // So if we're currently running a task, we'll need to delay this invocation.\n        if (currentlyRunningATask) {\n            // Delay by doing a setTimeout. setImmediate was tried instead, but in Firefox 7 it generated a\n            // \"too much recursion\" error.\n            setTimeout(runIfPresent, 0, handle);\n        } else {\n            var task = tasksByHandle[handle];\n            if (task) {\n                currentlyRunningATask = true;\n                try {\n                    run(task);\n                } finally {\n                    clearImmediate(handle);\n                    currentlyRunningATask = false;\n                }\n            }\n        }\n    }\n\n    function installNextTickImplementation() {\n        registerImmediate = function(handle) {\n            process.nextTick(function () { runIfPresent(handle); });\n        };\n    }\n\n    function canUsePostMessage() {\n        // The test against `importScripts` prevents this implementation from being installed inside a web worker,\n        // where `global.postMessage` means something completely different and can't be used for this purpose.\n        if (global.postMessage && !global.importScripts) {\n            var postMessageIsAsynchronous = true;\n            var oldOnMessage = global.onmessage;\n            global.onmessage = function() {\n                postMessageIsAsynchronous = false;\n            };\n            global.postMessage(\"\", \"*\");\n            global.onmessage = oldOnMessage;\n            return postMessageIsAsynchronous;\n        }\n    }\n\n    function installPostMessageImplementation() {\n        // Installs an event handler on `global` for the `message` event: see\n        // * https://developer.mozilla.org/en/DOM/window.postMessage\n        // * http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#crossDocumentMessages\n\n        var messagePrefix = \"setImmediate$\" + Math.random() + \"$\";\n        var onGlobalMessage = function(event) {\n            if (event.source === global &&\n                typeof event.data === \"string\" &&\n                event.data.indexOf(messagePrefix) === 0) {\n                runIfPresent(+event.data.slice(messagePrefix.length));\n            }\n        };\n\n        if (global.addEventListener) {\n            global.addEventListener(\"message\", onGlobalMessage, false);\n        } else {\n            global.attachEvent(\"onmessage\", onGlobalMessage);\n        }\n\n        registerImmediate = function(handle) {\n            global.postMessage(messagePrefix + handle, \"*\");\n        };\n    }\n\n    function installMessageChannelImplementation() {\n        var channel = new MessageChannel();\n        channel.port1.onmessage = function(event) {\n            var handle = event.data;\n            runIfPresent(handle);\n        };\n\n        registerImmediate = function(handle) {\n            channel.port2.postMessage(handle);\n        };\n    }\n\n    function installReadyStateChangeImplementation() {\n        var html = doc.documentElement;\n        registerImmediate = function(handle) {\n            // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted\n            // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.\n            var script = doc.createElement(\"script\");\n            script.onreadystatechange = function () {\n                runIfPresent(handle);\n                script.onreadystatechange = null;\n                html.removeChild(script);\n                script = null;\n            };\n            html.appendChild(script);\n        };\n    }\n\n    function installSetTimeoutImplementation() {\n        registerImmediate = function(handle) {\n            setTimeout(runIfPresent, 0, handle);\n        };\n    }\n\n    // If supported, we should attach to the prototype of global, since that is where setTimeout et al. live.\n    var attachTo = Object.getPrototypeOf && Object.getPrototypeOf(global);\n    attachTo = attachTo && attachTo.setTimeout ? attachTo : global;\n\n    // Don't get fooled by e.g. browserify environments.\n    if ({}.toString.call(global.process) === \"[object process]\") {\n        // For Node.js before 0.9\n        installNextTickImplementation();\n\n    } else if (canUsePostMessage()) {\n        // For non-IE10 modern browsers\n        installPostMessageImplementation();\n\n    } else if (global.MessageChannel) {\n        // For web workers, where supported\n        installMessageChannelImplementation();\n\n    } else if (doc && \"onreadystatechange\" in doc.createElement(\"script\")) {\n        // For IE 68\n        installReadyStateChangeImplementation();\n\n    } else {\n        // For older browsers\n        installSetTimeoutImplementation();\n    }\n\n    attachTo.setImmediate = setImmediate;\n    attachTo.clearImmediate = clearImmediate;\n}(typeof self === \"undefined\" ? typeof global === \"undefined\" ? this : global : self));\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/setimmediate/setImmediate.js","/*! precalltest  version = 1.1.5 2018-01-11 */\n\n\"use strict\";function _interopRequireWildcard(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e.default=t,e}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!e||\"object\"!=typeof e&&\"function\"!=typeof e?t:e}function _inherits(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.RttTest=void 0;var _createClass=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}(),_get=function t(e,s,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,s);if(void 0===r){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,s,i)}if(\"value\"in r)return r.value;var u=r.get;if(void 0!==u)return u.call(i)},_timestamps=require(\"../utility/timestamps\"),Timestamps=_interopRequireWildcard(_timestamps),_turnTest=require(\"./turnTest\"),RTTSAMPLES=10,TIMEOUT=100,LAST_TIMEOUT=500,RttTest=function(t){function e(t){_classCallCheck(this,e);var s=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return s.sendTimer=null,s.countSent=0,s.rtts=[],s}return _inherits(e,_turnTest.TurnTest),_createClass(e,[{key:\"initiate\",value:function(){this.results.startTimestamp=Timestamps.getCurrent(),this.sendPing()}},{key:\"handleMessage\",value:function(t){if(this.isActive()){var e=parseInt(t,10),s=this.calculateRtt(e);this.rtts.push(s),this.countSent<RTTSAMPLES?this.sendPing():this.calculateMetrics()}}},{key:\"handleError\",value:function(t){this.fillResults(),this.failed(t)}},{key:\"sendPing\",value:function(){if(this.isActive()){var t=Timestamps.getCurrent();this.send(t.toString()),this.countSent+=1,this.sendTimer&&(clearTimeout(this.sendTimer),this.sendTimer=null),this.countSent<RTTSAMPLES?this.sendTimer=setTimeout(this.sendPing.bind(this),TIMEOUT):this.sendTimer=setTimeout(this.calculateMetrics.bind(this),LAST_TIMEOUT)}}},{key:\"calculateRtt\",value:function(t){return Timestamps.getCurrent()-t}},{key:\"calculateMetrics\",value:function(){this.sendTimer&&(clearTimeout(this.sendTimer),this.sendTimer=null),this.fillResults(),this.finished()}},{key:\"fillResults\",value:function(){this.results.sentMessages=this.countSent,this.results.unAckedMessages=this.countSent-this.rtts.length,this.results.maxMessages=RTTSAMPLES,this.results.forceStopped=this.forceStopped,this.results.median=this.median(),this.results.variance=this.variance(),this.results.endTimestamp=Timestamps.getCurrent()}},{key:\"median\",value:function(){if(0==this.rtts.length)return null;this.rtts.sort();var t=Math.floor(this.rtts.length/2);return this.rtts[t]}},{key:\"variance\",value:function(){if(0==this.rtts.length)return null;var t=0,e=this.median(),s=!0,i=!1,r=void 0;try{for(var n,u=this.rtts[Symbol.iterator]();!(s=(n=u.next()).done);s=!0){var o=n.value;t+=Math.abs(o-e)}}catch(t){i=!0,r=t}finally{try{!s&&u.return&&u.return()}finally{if(i)throw r}}return t/=this.rtts.length}},{key:\"stop\",value:function(){this.isActive()&&(_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),\"stop\",this).call(this),this.fillResults())}}]),e}();exports.RttTest=RttTest;\n\n\n// WEBPACK FOOTER //\n// ./node_modules/precalltest/dist/tests/rttTest.js","/*! precalltest  version = 1.1.5 2018-01-11 */\n\n\"use strict\";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t.default=e,t}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}function _inherits(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.ThroughputTest=void 0;var _createClass=function(){function e(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,s,i){return s&&e(t.prototype,s),i&&e(t,i),t}}(),_get=function e(t,s,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,s);if(void 0===r){var n=Object.getPrototypeOf(t);return null===n?void 0:e(n,s,i)}if(\"value\"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},_timestamps=require(\"../utility/timestamps\"),Timestamps=_interopRequireWildcard(_timestamps),_messageMaker=require(\"../utility/messageMaker\"),_turnTest=require(\"./turnTest\"),ThroughputTest=function(e){function t(e,s){_classCallCheck(this,t);var i=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));if(i.sentBytes=0,i.receivedBytes=0,i.secondHalfBytes=0,i.secondHalfStart=null,i.bufferEmpty=0,i.chunkSize=1200,i.messageMaker=new _messageMaker.MessageMaker(i.chunkSize),i.duration=5e3,null!=s){var r=50*s;i.duration=Math.max(Math.min(r,1e4),1e3)}return i.sendTimer=null,i.lastMessage=null,i.intervals=[],i.intervalStart=0,i.intervalLength=100,i.intervalBytes=0,i}return _inherits(t,_turnTest.TurnTest),_createClass(t,[{key:\"initiate\",value:function(){this.startSend()}},{key:\"handleMessage\",value:function(e){var t=this;if(this.isActive()){this.lastMessage=e,this.receivedBytes+=e.length;var s=Timestamps.getCurrent();if(this.sendTimer||(this.results.startTimestamp=s,this.sendTimer=setTimeout(function(){t.stop(),t.finished()},this.duration)),0==this.intervalStart&&(this.intervalStart=s),this.intervalBytes+=e.length,s-this.intervalStart>=this.intervalLength){var i=s-this.intervalStart,r=this.averageThroughput(this.intervalBytes,i),n=null;try{n=s-JSON.parse(this.lastMessage).timestamp}catch(e){}this.intervals.push({startTimestamp:this.intervalStart,endTimestamp:s,bytesReceived:this.intervalBytes,average:r,rtt:n}),this.intervalStart=s,this.intervalBytes=0}this.results.startTimestamp&&s-this.results.startTimestamp>this.duration/2&&(this.secondHalfStart||(this.secondHalfStart=s),this.secondHalfBytes+=e.length)}}},{key:\"handleError\",value:function(e){this.stop(),this.failed(e)}},{key:\"averageThroughput\",value:function(e,t){return e/(t/1e3)*8/1024}},{key:\"bufferListener\",value:function(){this.sendChannel.removeEventListener(\"bufferedamountlow\",this.bufferListener.bind(this)),this.fillBuffer()}},{key:\"fillBuffer\",value:function(){for(0==this.sendChannel.bufferedAmount&&(this.bufferEmpty+=1);this.isActive();){if(this.sendChannel.bufferedAmount>this.bufferFullThreshold)return void(this.usePolling?setTimeout(this.fillBuffer.bind(this),250):this.sendChannel.addEventListener(\"bufferedamountlow\",this.bufferListener.bind(this)));var e=this.messageMaker.make(this.sentBytes);this.sentBytes+=e.length,this.send(e)}this.sendChannel.removeEventListener(\"bufferedamountlow\",this.bufferListener.bind(this))}},{key:\"startSend\",value:function(){this.isActive()&&(this.bufferFullThreshold=1e3*this.chunkSize,this.sendChannel=this.connection.sendChannel,this.usePolling=!0,\"number\"==typeof this.sendChannel.bufferedAmountLowThreshold&&(this.usePolling=!1,this.sendChannel.bufferedAmountLowThreshold=this.bufferFullThreshold/10),setTimeout(this.fillBuffer.bind(this),0))}},{key:\"fillResults\",value:function(){this.results.endTimestamp=Timestamps.getCurrent(),this.results.maxDuration=this.duration,this.results.forceStopped=this.forceStopped,this.results.bufferEmpty=this.bufferEmpty,this.results.intervals=this.intervals,this.results.bytesPrepared=this.sentBytes,this.results.bytesReceived=this.receivedBytes;var e=0,t=0;this.secondHalfStart&&(e=this.results.endTimestamp-this.secondHalfStart,t=this.averageThroughput(this.secondHalfBytes,e));var s=this.results.endTimestamp-this.results.startTimestamp,i=this.averageThroughput(this.receivedBytes,s);i>t&&(t=i),this.results.average=t;var r=null;try{r=JSON.parse(this.lastMessage)}catch(e){return}if(r){var n=r.sentBytes+this.lastMessage.length;this.results.bytesSent=n,this.results.fractionLostBytes=1-this.receivedBytes/n}else this.results.bytesSent=-1,this.results.fractionLostBytes=-1}},{key:\"stop\",value:function(){this.isActive()&&(clearTimeout(this.sendTimer),this.sendTimer=null,_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),\"stop\",this).call(this),this.fillResults())}}]),t}();exports.ThroughputTest=ThroughputTest;\n\n\n// WEBPACK FOOTER //\n// ./node_modules/precalltest/dist/tests/throughputTest.js","/*! precalltest  version = 1.1.5 2018-01-11 */\n\n\"use strict\";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.ResultsHandler=void 0;var _typeof=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e},_createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,r,s){return r&&e(t.prototype,r),s&&e(t,s),t}}(),_timestamps=require(\"./timestamps\"),Timestamps=_interopRequireWildcard(_timestamps),_messageMaker=require(\"./messageMaker\"),ResultsHandler=function(){function e(){_classCallCheck(this,e),this.start=Timestamps.getCurrent(),this.id=Math.trunc(this.start)+\"-\"+(0,_messageMaker.randomAsciiString)(20),this.version=\"1.1.5\",this.failures=[],this.results={},this.forceStopped=!1}return _createClass(e,[{key:\"getResults\",value:function(){return{id:this.id,version:this.version,forceStopped:this.forceStopped,startTimestamp:this.start,endTimestamp:Timestamps.getCurrent(),failures:this.failures,tests:this.results}}},{key:\"getFailureNumber\",value:function(){return this.failures.length}},{key:\"getId\",value:function(){return this.id}},{key:\"add\",value:function(e,t){this.results[e]=t,t.forceStopped&&!0===t.forceStopped&&(this.forceStopped=!0)}},{key:\"failure\",value:function(e){\"object\"===(void 0===e?\"undefined\":_typeof(e))&&(e=e.toString());var t={timestamp:Timestamps.getCurrent(),reason:e};this.failures.push(t)}}]),e}();exports.ResultsHandler=ResultsHandler;\n\n\n// WEBPACK FOOTER //\n// ./node_modules/precalltest/dist/utility/resultsHandler.js","/*! precalltest  version = 1.1.5 2018-01-11 */\n\n\"use strict\";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t]);return n.default=e,n}function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError(\"Cannot call a class as a function\")}Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.OnlineCheck=void 0;var _createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(n,t,i){return t&&e(n.prototype,t),i&&e(n,i),n}}(),_timestamps=require(\"./timestamps\"),Timestamps=_interopRequireWildcard(_timestamps),OnlineCheck=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:\"start\",value:function(){var e=this;this.onlineCheck=[],window&&window.addEventListener&&\"function\"==typeof window.addEventListener&&(window.addEventListener(\"offline\",function(){e.addEntry()}),window.addEventListener(\"online\",function(){e.addEntry()}),this.addEntry())}},{key:\"addEntry\",value:function(){var e=Timestamps.getCurrent();if(navigator&&navigator.onLine){var n=navigator.onLine;this.onlineCheck.push({timestamp:e,online:n})}}},{key:\"stop\",value:function(){var e=this;return window.removeEventListener(\"offline\",function(){e.addEntry()}),window.removeEventListener(\"online\",function(){e.addEntry()}),this.onlineCheck}}]),e}();exports.OnlineCheck=OnlineCheck;\n\n\n// WEBPACK FOOTER //\n// ./node_modules/precalltest/dist/utility/onlineCheck.js","import browser, { browsers } from '../browser';\r\nimport * as StatisticsEvents from '../../service/statistics/Events';\r\n\r\nconst GlobalOnErrorHandler = require('../util/GlobalOnErrorHandler');\r\nconst logger = require('jitsi-meet-logger').getLogger(__filename);\r\n\r\n/* Whether we support the browser we are running into for logging statistics */\r\nconst browserSupported = browser.isChrome()\r\n        || browser.isOpera() || browser.isFirefox()\r\n        || browser.isNWJS() || browser.isElectron()\r\n        || browser.isTemasysPluginUsed() || browser.isEdge();\r\n\r\n/**\r\n * The lib-jitsi-meet browser-agnostic names of the browser-specific keys\r\n * reported by RTCPeerConnection#getStats mapped by browser.\r\n */\r\nconst KEYS_BY_BROWSER_TYPE = {};\r\n\r\nKEYS_BY_BROWSER_TYPE[browsers.FIREFOX] = {\r\n    'ssrc': 'ssrc',\r\n    'packetsReceived': 'packetsReceived',\r\n    'packetsLost': 'packetsLost',\r\n    'packetsSent': 'packetsSent',\r\n    'bytesReceived': 'bytesReceived',\r\n    'bytesSent': 'bytesSent',\r\n    'framerateMean': 'framerateMean'\r\n};\r\nKEYS_BY_BROWSER_TYPE[browsers.CHROME] = {\r\n    'receiveBandwidth': 'googAvailableReceiveBandwidth',\r\n    'sendBandwidth': 'googAvailableSendBandwidth',\r\n    'remoteAddress': 'googRemoteAddress',\r\n    'transportType': 'googTransportType',\r\n    'localAddress': 'googLocalAddress',\r\n    'activeConnection': 'googActiveConnection',\r\n    'ssrc': 'ssrc',\r\n    'packetsReceived': 'packetsReceived',\r\n    'packetsSent': 'packetsSent',\r\n    'packetsLost': 'packetsLost',\r\n    'bytesReceived': 'bytesReceived',\r\n    'bytesSent': 'bytesSent',\r\n    'googFrameHeightReceived': 'googFrameHeightReceived',\r\n    'googFrameWidthReceived': 'googFrameWidthReceived',\r\n    'googFrameHeightSent': 'googFrameHeightSent',\r\n    'googFrameWidthSent': 'googFrameWidthSent',\r\n    'googFrameRateReceived': 'googFrameRateReceived',\r\n    'googFrameRateSent': 'googFrameRateSent',\r\n    'audioInputLevel': 'audioInputLevel',\r\n    'audioOutputLevel': 'audioOutputLevel',\r\n    'currentRoundTripTime': 'googRtt',\r\n    'remoteCandidateType': 'googRemoteCandidateType',\r\n    'localCandidateType': 'googLocalCandidateType'\r\n};\r\nKEYS_BY_BROWSER_TYPE[browsers.EDGE] = {\r\n    'sendBandwidth': 'googAvailableSendBandwidth',\r\n    'remoteAddress': 'remoteAddress',\r\n    'transportType': 'protocol',\r\n    'localAddress': 'localAddress',\r\n    'activeConnection': 'activeConnection',\r\n    'ssrc': 'ssrc',\r\n    'packetsReceived': 'packetsReceived',\r\n    'packetsSent': 'packetsSent',\r\n    'packetsLost': 'packetsLost',\r\n    'bytesReceived': 'bytesReceived',\r\n    'bytesSent': 'bytesSent',\r\n    'googFrameHeightReceived': 'frameHeight',\r\n    'googFrameWidthReceived': 'frameWidth',\r\n    'googFrameHeightSent': 'frameHeight',\r\n    'googFrameWidthSent': 'frameWidth',\r\n    'googFrameRateReceived': 'framesPerSecond',\r\n    'googFrameRateSent': 'framesPerSecond',\r\n    'audioInputLevel': 'audioLevel',\r\n    'audioOutputLevel': 'audioLevel',\r\n    'currentRoundTripTime': 'roundTripTime'\r\n};\r\nKEYS_BY_BROWSER_TYPE[browsers.OPERA]\r\n    = KEYS_BY_BROWSER_TYPE[browsers.CHROME];\r\nKEYS_BY_BROWSER_TYPE[browsers.NWJS]\r\n    = KEYS_BY_BROWSER_TYPE[browsers.CHROME];\r\nKEYS_BY_BROWSER_TYPE[browsers.ELECTRON]\r\n    = KEYS_BY_BROWSER_TYPE[browsers.CHROME];\r\nKEYS_BY_BROWSER_TYPE[browsers.IEXPLORER]\r\n    = KEYS_BY_BROWSER_TYPE[browsers.CHROME];\r\nKEYS_BY_BROWSER_TYPE[browsers.SAFARI]\r\n    = KEYS_BY_BROWSER_TYPE[browsers.CHROME];\r\nKEYS_BY_BROWSER_TYPE[browsers.REACT_NATIVE]\r\n    = KEYS_BY_BROWSER_TYPE[browsers.CHROME];\r\n\r\n/**\r\n * Calculates packet lost percent using the number of lost packets and the\r\n * number of all packet.\r\n * @param lostPackets the number of lost packets\r\n * @param totalPackets the number of all packets.\r\n * @returns {number} packet loss percent\r\n */\r\nfunction calculatePacketLoss(lostPackets, totalPackets) {\r\n    if (!totalPackets || totalPackets <= 0\r\n            || !lostPackets || lostPackets <= 0) {\r\n        return 0;\r\n    }\r\n\r\n    return Math.round((lostPackets / totalPackets) * 100);\r\n}\r\n\r\n/**\r\n * Holds \"statistics\" for a single SSRC.\r\n * @constructor\r\n */\r\nfunction SsrcStats() {\r\n    this.loss = {};\r\n    this.bitrate = {\r\n        download: 0,\r\n        upload: 0\r\n    };\r\n    this.resolution = {};\r\n    this.framerate = 0;\r\n}\r\n\r\n/**\r\n * Sets the \"loss\" object.\r\n * @param loss the value to set.\r\n */\r\nSsrcStats.prototype.setLoss = function(loss) {\r\n    this.loss = loss || {};\r\n};\r\n\r\n/**\r\n * Sets resolution that belong to the ssrc represented by this instance.\r\n * @param resolution new resolution value to be set.\r\n */\r\nSsrcStats.prototype.setResolution = function(resolution) {\r\n    this.resolution = resolution || {};\r\n};\r\n\r\n/**\r\n * Adds the \"download\" and \"upload\" fields from the \"bitrate\" parameter to\r\n * the respective fields of the \"bitrate\" field of this object.\r\n * @param bitrate an object holding the values to add.\r\n */\r\nSsrcStats.prototype.addBitrate = function(bitrate) {\r\n    this.bitrate.download += bitrate.download;\r\n    this.bitrate.upload += bitrate.upload;\r\n};\r\n\r\n/**\r\n * Resets the bit rate for given <tt>ssrc</tt> that belong to the peer\r\n * represented by this instance.\r\n */\r\nSsrcStats.prototype.resetBitrate = function() {\r\n    this.bitrate.download = 0;\r\n    this.bitrate.upload = 0;\r\n};\r\n\r\n/**\r\n * Sets the \"framerate\".\r\n * @param framerate the value to set.\r\n */\r\nSsrcStats.prototype.setFramerate = function(framerate) {\r\n    this.framerate = framerate || 0;\r\n};\r\n\r\n/**\r\n *\r\n */\r\nfunction ConferenceStats() {\r\n\r\n    /**\r\n     * The bandwidth\r\n     * @type {{}}\r\n     */\r\n    this.bandwidth = {};\r\n\r\n    /**\r\n     * The bit rate\r\n     * @type {{}}\r\n     */\r\n    this.bitrate = {};\r\n\r\n    /**\r\n     * The packet loss rate\r\n     * @type {{}}\r\n     */\r\n    this.packetLoss = null;\r\n\r\n    /**\r\n     * Array with the transport information.\r\n     * @type {Array}\r\n     */\r\n    this.transport = [];\r\n}\r\n\r\n/* eslint-disable max-params */\r\n\r\n/**\r\n * <tt>StatsCollector</tt> registers for stats updates of given\r\n * <tt>peerconnection</tt> in given <tt>interval</tt>. On each update particular\r\n * stats are extracted and put in {@link SsrcStats} objects. Once the processing\r\n * is done <tt>audioLevelsUpdateCallback</tt> is called with <tt>this</tt>\r\n * instance as an event source.\r\n *\r\n * @param peerconnection WebRTC PeerConnection object.\r\n * @param audioLevelsInterval\r\n * @param statsInterval stats refresh interval given in ms.\r\n * @param eventEmitter\r\n * @constructor\r\n */\r\nexport default function StatsCollector(\r\n        peerconnection,\r\n        audioLevelsInterval,\r\n        statsInterval,\r\n        eventEmitter) {\r\n    // StatsCollector depends entirely on the format of the reports returned by\r\n    // RTCPeerConnection#getStats. Given that the value of\r\n    // browser#getName() is very unlikely to change at runtime, it\r\n    // makes sense to discover whether StatsCollector supports the executing\r\n    // browser as soon as possible. Otherwise, (1) getStatValue would have to\r\n    // needlessly check a \"static\" condition multiple times very very often and\r\n    // (2) the lack of support for the executing browser would be discovered and\r\n    // reported multiple times very very often too late in the execution in some\r\n    // totally unrelated callback.\r\n    /**\r\n     * The browser type supported by this StatsCollector. In other words, the\r\n     * type of the browser which initialized this StatsCollector\r\n     * instance.\r\n     * @private\r\n     */\r\n    this._browserType = browser.getName();\r\n    const keys = KEYS_BY_BROWSER_TYPE[this._browserType];\r\n\r\n    if (!keys) {\r\n        // eslint-disable-next-line no-throw-literal\r\n        throw `The browser type '${this._browserType}' isn't supported!`;\r\n    }\r\n\r\n    /**\r\n     * The function which is to be used to retrieve the value associated in a\r\n     * report returned by RTCPeerConnection#getStats with a lib-jitsi-meet\r\n     * browser-agnostic name/key.\r\n     *\r\n     * @function\r\n     * @private\r\n     */\r\n    this._getStatValue = this._defineGetStatValueMethod(keys);\r\n\r\n    this.peerconnection = peerconnection;\r\n    this.baselineAudioLevelsReport = null;\r\n    this.currentAudioLevelsReport = null;\r\n    this.currentStatsReport = null;\r\n    this.previousStatsReport = null;\r\n    this.audioLevelsIntervalId = null;\r\n    this.eventEmitter = eventEmitter;\r\n    this.conferenceStats = new ConferenceStats();\r\n\r\n    // Updates stats interval\r\n    this.audioLevelsIntervalMilis = audioLevelsInterval;\r\n\r\n    this.statsIntervalId = null;\r\n    this.statsIntervalMilis = statsInterval;\r\n\r\n    /**\r\n     * Maps SSRC numbers to {@link SsrcStats}.\r\n     * @type {Map<number,SsrcStats}\r\n     */\r\n    this.ssrc2stats = new Map();\r\n}\r\n\r\n/* eslint-enable max-params */\r\n\r\n/**\r\n * Stops stats updates.\r\n */\r\nStatsCollector.prototype.stop = function() {\r\n    if (this.audioLevelsIntervalId) {\r\n        clearInterval(this.audioLevelsIntervalId);\r\n        this.audioLevelsIntervalId = null;\r\n    }\r\n\r\n    if (this.statsIntervalId) {\r\n        clearInterval(this.statsIntervalId);\r\n        this.statsIntervalId = null;\r\n    }\r\n};\r\n\r\n/**\r\n * Callback passed to <tt>getStats</tt> method.\r\n * @param error an error that occurred on <tt>getStats</tt> call.\r\n */\r\nStatsCollector.prototype.errorCallback = function(error) {\r\n    GlobalOnErrorHandler.callErrorHandler(error);\r\n    logger.error('Get stats error', error);\r\n    this.stop();\r\n};\r\n\r\n/**\r\n * Starts stats updates.\r\n */\r\nStatsCollector.prototype.start = function(startAudioLevelStats) {\r\n    const self = this;\r\n\r\n    if (startAudioLevelStats) {\r\n        this.audioLevelsIntervalId = setInterval(\r\n            () => {\r\n                // Interval updates\r\n                self.peerconnection.getStats(\r\n                    report => {\r\n                        let results = null;\r\n\r\n                        if (!report || !report.result\r\n                            || typeof report.result !== 'function') {\r\n                            results = report;\r\n                        } else {\r\n                            results = report.result();\r\n                        }\r\n                        self.currentAudioLevelsReport = results;\r\n                        self.processAudioLevelReport();\r\n                        self.baselineAudioLevelsReport\r\n                            = self.currentAudioLevelsReport;\r\n                    },\r\n                    self.errorCallback\r\n                );\r\n            },\r\n            self.audioLevelsIntervalMilis\r\n        );\r\n    }\r\n\r\n    if (browserSupported) {\r\n        this.statsIntervalId = setInterval(\r\n            () => {\r\n                // Interval updates\r\n                self.peerconnection.getStats(\r\n                    report => {\r\n                        let results = null;\r\n\r\n                        if (!report || !report.result\r\n                            || typeof report.result !== 'function') {\r\n                            // firefox\r\n                            results = report;\r\n                        } else {\r\n                            // chrome\r\n                            results = report.result();\r\n                        }\r\n\r\n                        self.currentStatsReport = results;\r\n                        try {\r\n                            self.processStatsReport();\r\n                        } catch (e) {\r\n                            GlobalOnErrorHandler.callErrorHandler(e);\r\n                            logger.error(`Unsupported key:${e}`, e);\r\n                        }\r\n\r\n                        self.previousStatsReport = self.currentStatsReport;\r\n                    },\r\n                    self.errorCallback\r\n                );\r\n            },\r\n            self.statsIntervalMilis\r\n        );\r\n    }\r\n};\r\n\r\n/**\r\n * Defines a function which (1) is to be used as a StatsCollector method and (2)\r\n * gets the value from a specific report returned by RTCPeerConnection#getStats\r\n * associated with a lib-jitsi-meet browser-agnostic name.\r\n *\r\n * @param {Object.<string,string>} keys the map of LibJitsi browser-agnostic\r\n * names to RTCPeerConnection#getStats browser-specific keys\r\n */\r\nStatsCollector.prototype._defineGetStatValueMethod = function(keys) {\r\n    // Define the function which converts a lib-jitsi-meet browser-asnostic name\r\n    // to a browser-specific key of a report returned by\r\n    // RTCPeerConnection#getStats.\r\n    const keyFromName = function(name) {\r\n        const key = keys[name];\r\n\r\n        if (key) {\r\n            return key;\r\n        }\r\n\r\n        // eslint-disable-next-line no-throw-literal\r\n        throw `The property '${name}' isn't supported!`;\r\n    };\r\n\r\n    // Define the function which retrieves the value from a specific report\r\n    // returned by RTCPeerConnection#getStats associated with a given\r\n    // browser-specific key.\r\n    let itemStatByKey;\r\n\r\n    switch (this._browserType) {\r\n    case browsers.CHROME:\r\n    case browsers.OPERA:\r\n    case browsers.NWJS:\r\n    case browsers.ELECTRON:\r\n        // TODO What about other types of browser which are based on Chrome such\r\n        // as NW.js? Every time we want to support a new type browser we have to\r\n        // go and add more conditions (here and in multiple other places).\r\n        // Cannot we do a feature detection instead of a browser type check? For\r\n        // example, if item has a stat property of type function, then it's very\r\n        // likely that whoever defined it wanted you to call it in order to\r\n        // retrieve the value associated with a specific key.\r\n        itemStatByKey = (item, key) => item.stat(key);\r\n        break;\r\n    case browsers.REACT_NATIVE:\r\n        // The implementation provided by react-native-webrtc follows the\r\n        // Objective-C WebRTC API: RTCStatsReport has a values property of type\r\n        // Array in which each element is a key-value pair.\r\n        itemStatByKey = function(item, key) {\r\n            let value;\r\n\r\n            item.values.some(pair => {\r\n                if (pair.hasOwnProperty(key)) {\r\n                    value = pair[key];\r\n\r\n                    return true;\r\n                }\r\n\r\n                return false;\r\n\r\n            });\r\n\r\n            return value;\r\n        };\r\n        break;\r\n    case browsers.EDGE:\r\n        itemStatByKey = (item, key) => item[key];\r\n        break;\r\n    default:\r\n        itemStatByKey = (item, key) => item[key];\r\n    }\r\n\r\n    // Compose the 2 functions defined above to get a function which retrieves\r\n    // the value from a specific report returned by RTCPeerConnection#getStats\r\n    // associated with a specific lib-jitsi-meet browser-agnostic name.\r\n    return (item, name) => itemStatByKey(item, keyFromName(name));\r\n};\r\n\r\n/**\r\n * Obtains a stat value from given stat and converts it to a non-negative\r\n * number. If the value is either invalid or negative then 0 will be returned.\r\n * @param report\r\n * @param {string} name\r\n * @return {number}\r\n * @private\r\n */\r\nStatsCollector.prototype.getNonNegativeStat = function(report, name) {\r\n    let value = this._getStatValue(report, name);\r\n\r\n    if (typeof value !== 'number') {\r\n        value = Number(value);\r\n    }\r\n\r\n    if (isNaN(value)) {\r\n        return 0;\r\n    }\r\n\r\n    return Math.max(0, value);\r\n};\r\n\r\n/* eslint-disable no-continue */\r\n\r\n/**\r\n * Stats processing logic.\r\n */\r\nStatsCollector.prototype.processStatsReport = function() {\r\n    if (!this.previousStatsReport) {\r\n        return;\r\n    }\r\n\r\n    const getStatValue = this._getStatValue;\r\n    const byteSentStats = {};\r\n\r\n    for (const idx in this.currentStatsReport) {\r\n        if (!this.currentStatsReport.hasOwnProperty(idx)) {\r\n            continue;\r\n        }\r\n        const now = this.currentStatsReport[idx];\r\n\r\n        // The browser API may return \"undefined\" values in the array\r\n        if (!now) {\r\n            continue;\r\n        }\r\n\r\n        try {\r\n            const receiveBandwidth = getStatValue(now, 'receiveBandwidth');\r\n            const sendBandwidth = getStatValue(now, 'sendBandwidth');\r\n\r\n            if (receiveBandwidth || sendBandwidth) {\r\n                this.conferenceStats.bandwidth = {\r\n                    'download': Math.round(receiveBandwidth / 1000),\r\n                    'upload': Math.round(sendBandwidth / 1000)\r\n                };\r\n            }\r\n        } catch (e) { /* not supported*/ }\r\n\r\n        if (now.type === 'googCandidatePair') {\r\n            let active, ip, localCandidateType, localip,\r\n                remoteCandidateType, rtt, type;\r\n\r\n            try {\r\n                active = getStatValue(now, 'activeConnection');\r\n                if (!active) {\r\n                    continue;\r\n                }\r\n\r\n                ip = getStatValue(now, 'remoteAddress');\r\n                type = getStatValue(now, 'transportType');\r\n                localip = getStatValue(now, 'localAddress');\r\n                localCandidateType = getStatValue(now, 'localCandidateType');\r\n                remoteCandidateType = getStatValue(now, 'remoteCandidateType');\r\n                rtt = this.getNonNegativeStat(now, 'currentRoundTripTime');\r\n            } catch (e) { /* not supported*/ }\r\n            if (!ip || !type || !localip || active !== 'true') {\r\n                continue;\r\n            }\r\n\r\n            // Save the address unless it has been saved already.\r\n            const conferenceStatsTransport = this.conferenceStats.transport;\r\n\r\n            if (!conferenceStatsTransport.some(\r\n                    t =>\r\n                        t.ip === ip\r\n                            && t.type === type\r\n                            && t.localip === localip)) {\r\n                conferenceStatsTransport.push({\r\n                    ip,\r\n                    type,\r\n                    localip,\r\n                    p2p: this.peerconnection.isP2P,\r\n                    localCandidateType,\r\n                    remoteCandidateType,\r\n                    rtt\r\n                });\r\n            }\r\n            continue;\r\n        }\r\n\r\n        if (now.type === 'candidatepair') {\r\n            // we need succeeded and selected pairs only\r\n            if (now.state !== 'succeeded' || !now.selected) {\r\n                continue;\r\n            }\r\n\r\n            const local = this.currentStatsReport[now.localCandidateId];\r\n            const remote = this.currentStatsReport[now.remoteCandidateId];\r\n\r\n            this.conferenceStats.transport.push({\r\n                ip: `${remote.ipAddress}:${remote.portNumber}`,\r\n                type: local.transport,\r\n                localip: `${local.ipAddress}:${local.portNumber}`,\r\n                p2p: this.peerconnection.isP2P,\r\n                localCandidateType: local.candidateType,\r\n                remoteCandidateType: remote.candidateType\r\n            });\r\n        }\r\n\r\n        // NOTE: Edge's proprietary stats via RTCIceTransport.msGetStats().\r\n        if (now.msType === 'transportdiagnostics') {\r\n            this.conferenceStats.transport.push({\r\n                ip: now.remoteAddress,\r\n                type: now.protocol,\r\n                localip: now.localAddress,\r\n                p2p: this.peerconnection.isP2P\r\n            });\r\n        }\r\n\r\n        if (now.type !== 'ssrc' && now.type !== 'outboundrtp'\r\n            && now.type !== 'inboundrtp' && now.type !== 'track') {\r\n            continue;\r\n        }\r\n\r\n        // NOTE: In Edge, stats with type \"inboundrtp\" and \"outboundrtp\" are\r\n        // completely useless, so ignore them.\r\n        if (browser.isEdge()\r\n            && (now.type === 'inboundrtp' || now.type === 'outboundrtp')) {\r\n            continue;\r\n        }\r\n\r\n        const before = this.previousStatsReport[idx];\r\n        let ssrc = this.getNonNegativeStat(now, 'ssrc');\r\n\r\n        // If type=\"track\", take the first SSRC from ssrcIds.\r\n        if (now.type === 'track' && Array.isArray(now.ssrcIds)) {\r\n            ssrc = Number(now.ssrcIds[0]);\r\n        }\r\n\r\n        if (!before || !ssrc) {\r\n            continue;\r\n        }\r\n\r\n        // isRemote is available only in FF and is ignored in case of chrome\r\n        // according to the spec\r\n        // https://www.w3.org/TR/webrtc-stats/#dom-rtcrtpstreamstats-isremote\r\n        // when isRemote is true indicates that the measurements were done at\r\n        // the remote endpoint and reported in an RTCP RR/XR.\r\n        // Fixes a problem where we are calculating local stats wrong adding\r\n        // the sent bytes to the local download bitrate.\r\n        // In new W3 stats spec, type=\"track\" has a remoteSource boolean\r\n        // property.\r\n        // Edge uses the new format, so skip this check.\r\n        if (!browser.isEdge()\r\n                && (now.isRemote === true || now.remoteSource === true)) {\r\n            continue;\r\n        }\r\n\r\n        let ssrcStats = this.ssrc2stats.get(ssrc);\r\n\r\n        if (!ssrcStats) {\r\n            ssrcStats = new SsrcStats();\r\n            this.ssrc2stats.set(ssrc, ssrcStats);\r\n        }\r\n\r\n        let isDownloadStream = true;\r\n        let key = 'packetsReceived';\r\n        let packetsNow = getStatValue(now, key);\r\n\r\n        if (typeof packetsNow === 'undefined'\r\n            || packetsNow === null || packetsNow === '') {\r\n            isDownloadStream = false;\r\n            key = 'packetsSent';\r\n            packetsNow = getStatValue(now, key);\r\n            if (typeof packetsNow === 'undefined' || packetsNow === null) {\r\n                logger.warn('No packetsReceived nor packetsSent stat found');\r\n            }\r\n        }\r\n        if (!packetsNow || packetsNow < 0) {\r\n            packetsNow = 0;\r\n        }\r\n\r\n        const packetsBefore = this.getNonNegativeStat(before, key);\r\n        const packetsDiff = Math.max(0, packetsNow - packetsBefore);\r\n\r\n        const packetsLostNow\r\n            = this.getNonNegativeStat(now, 'packetsLost');\r\n        const packetsLostBefore\r\n            = this.getNonNegativeStat(before, 'packetsLost');\r\n        const packetsLostDiff = Math.max(0, packetsLostNow - packetsLostBefore);\r\n\r\n        ssrcStats.setLoss({\r\n            packetsTotal: packetsDiff + packetsLostDiff,\r\n            packetsLost: packetsLostDiff,\r\n            isDownloadStream\r\n        });\r\n\r\n        const bytesReceivedNow\r\n            = this.getNonNegativeStat(now, 'bytesReceived');\r\n        const bytesReceivedBefore\r\n            = this.getNonNegativeStat(before, 'bytesReceived');\r\n        const bytesReceived\r\n            = Math.max(0, bytesReceivedNow - bytesReceivedBefore);\r\n\r\n        let bytesSent = 0;\r\n\r\n        // TODO: clean this mess up!\r\n        let nowBytesTransmitted = getStatValue(now, 'bytesSent');\r\n\r\n        if (typeof nowBytesTransmitted === 'number'\r\n            || typeof nowBytesTransmitted === 'string') {\r\n            nowBytesTransmitted = Number(nowBytesTransmitted);\r\n            if (!isNaN(nowBytesTransmitted)) {\r\n                byteSentStats[ssrc] = nowBytesTransmitted;\r\n                if (nowBytesTransmitted > 0) {\r\n                    bytesSent = nowBytesTransmitted\r\n                        - getStatValue(before, 'bytesSent');\r\n                }\r\n            }\r\n        }\r\n        bytesSent = Math.max(0, bytesSent);\r\n\r\n        const timeMs = now.timestamp - before.timestamp;\r\n        let bitrateReceivedKbps = 0, bitrateSentKbps = 0;\r\n\r\n        if (timeMs > 0) {\r\n            // TODO is there any reason to round here?\r\n            bitrateReceivedKbps = Math.round((bytesReceived * 8) / timeMs);\r\n            bitrateSentKbps = Math.round((bytesSent * 8) / timeMs);\r\n        }\r\n\r\n        ssrcStats.addBitrate({\r\n            'download': bitrateReceivedKbps,\r\n            'upload': bitrateSentKbps\r\n        });\r\n\r\n        const resolution = {\r\n            height: null,\r\n            width: null\r\n        };\r\n\r\n        try {\r\n            let height, width;\r\n\r\n            if ((height = getStatValue(now, 'googFrameHeightReceived'))\r\n                && (width = getStatValue(now, 'googFrameWidthReceived'))) {\r\n                resolution.height = height;\r\n                resolution.width = width;\r\n            } else if ((height = getStatValue(now, 'googFrameHeightSent'))\r\n                && (width = getStatValue(now, 'googFrameWidthSent'))) {\r\n                resolution.height = height;\r\n                resolution.width = width;\r\n            }\r\n        } catch (e) { /* not supported*/ }\r\n\r\n        // Tries to get frame rate\r\n        let frameRate;\r\n\r\n        try {\r\n            frameRate = getStatValue(now, 'googFrameRateReceived')\r\n                || getStatValue(now, 'googFrameRateSent') || 0;\r\n        } catch (e) {\r\n            // if it fails with previous properties(chrome),\r\n            // let's try with another one (FF)\r\n            try {\r\n                frameRate = this.getNonNegativeStat(now, 'framerateMean');\r\n            } catch (err) { /* not supported*/ }\r\n        }\r\n        ssrcStats.setFramerate(Math.round(frameRate || 0));\r\n\r\n        if (resolution.height && resolution.width) {\r\n            ssrcStats.setResolution(resolution);\r\n        } else {\r\n            ssrcStats.setResolution(null);\r\n        }\r\n    }\r\n\r\n    // process stats\r\n    const totalPackets = {\r\n        download: 0,\r\n        upload: 0\r\n    };\r\n    const lostPackets = {\r\n        download: 0,\r\n        upload: 0\r\n    };\r\n    let bitrateDownload = 0;\r\n    let bitrateUpload = 0;\r\n    const resolutions = {};\r\n    const framerates = {};\r\n    let audioBitrateDownload = 0;\r\n    let audioBitrateUpload = 0;\r\n    let videoBitrateDownload = 0;\r\n    let videoBitrateUpload = 0;\r\n\r\n    for (const [ ssrc, ssrcStats ] of this.ssrc2stats) {\r\n        // process packet loss stats\r\n        const loss = ssrcStats.loss;\r\n        const type = loss.isDownloadStream ? 'download' : 'upload';\r\n\r\n        totalPackets[type] += loss.packetsTotal;\r\n        lostPackets[type] += loss.packetsLost;\r\n\r\n        // process bitrate stats\r\n        bitrateDownload += ssrcStats.bitrate.download;\r\n        bitrateUpload += ssrcStats.bitrate.upload;\r\n\r\n        // collect resolutions and framerates\r\n        const track = this.peerconnection.getTrackBySSRC(ssrc);\r\n\r\n        if (track) {\r\n            if (track.isAudioTrack()) {\r\n                audioBitrateDownload += ssrcStats.bitrate.download;\r\n                audioBitrateUpload += ssrcStats.bitrate.upload;\r\n            } else {\r\n                videoBitrateDownload += ssrcStats.bitrate.download;\r\n                videoBitrateUpload += ssrcStats.bitrate.upload;\r\n            }\r\n\r\n            const participantId = track.getParticipantId();\r\n\r\n            if (participantId) {\r\n                const resolution = ssrcStats.resolution;\r\n\r\n                if (resolution.width\r\n                        && resolution.height\r\n                        && resolution.width !== -1\r\n                        && resolution.height !== -1) {\r\n                    const userResolutions = resolutions[participantId] || {};\r\n\r\n                    userResolutions[ssrc] = resolution;\r\n                    resolutions[participantId] = userResolutions;\r\n                }\r\n                if (ssrcStats.framerate !== 0) {\r\n                    const userFramerates = framerates[participantId] || {};\r\n\r\n                    userFramerates[ssrc] = ssrcStats.framerate;\r\n                    framerates[participantId] = userFramerates;\r\n                }\r\n            } else {\r\n                logger.error(`No participant ID returned by ${track}`);\r\n            }\r\n        } else if (this.peerconnection.isP2P) {\r\n            // NOTE For JVB connection there are JVB tracks reported in\r\n            // the stats, but they do not have corresponding JitsiRemoteTrack\r\n            // instances stored in TPC. It is not trivial to figure out that\r\n            // a SSRC belongs to JVB, so we print this error ony for the P2P\r\n            // connection for the time being.\r\n            //\r\n            // Also there will be reports for tracks removed from the session,\r\n            // for the users who have left the conference.\r\n            logger.error(\r\n                `JitsiTrack not found for SSRC ${ssrc}`\r\n                    + ` in ${this.peerconnection}`);\r\n        }\r\n\r\n        ssrcStats.resetBitrate();\r\n    }\r\n\r\n    this.eventEmitter.emit(\r\n        StatisticsEvents.BYTE_SENT_STATS, this.peerconnection, byteSentStats);\r\n\r\n    this.conferenceStats.bitrate = {\r\n        'upload': bitrateUpload,\r\n        'download': bitrateDownload\r\n    };\r\n\r\n    this.conferenceStats.bitrate.audio = {\r\n        'upload': audioBitrateUpload,\r\n        'download': audioBitrateDownload\r\n    };\r\n\r\n    this.conferenceStats.bitrate.video = {\r\n        'upload': videoBitrateUpload,\r\n        'download': videoBitrateDownload\r\n    };\r\n\r\n    this.conferenceStats.packetLoss = {\r\n        total:\r\n            calculatePacketLoss(\r\n                lostPackets.download + lostPackets.upload,\r\n                totalPackets.download + totalPackets.upload),\r\n        download:\r\n            calculatePacketLoss(lostPackets.download, totalPackets.download),\r\n        upload:\r\n            calculatePacketLoss(lostPackets.upload, totalPackets.upload)\r\n    };\r\n\r\n    this.eventEmitter.emit(\r\n        StatisticsEvents.CONNECTION_STATS,\r\n        this.peerconnection,\r\n        {\r\n            'bandwidth': this.conferenceStats.bandwidth,\r\n            'bitrate': this.conferenceStats.bitrate,\r\n            'packetLoss': this.conferenceStats.packetLoss,\r\n            'resolution': resolutions,\r\n            'framerate': framerates,\r\n            'transport': this.conferenceStats.transport\r\n        });\r\n    this.conferenceStats.transport = [];\r\n};\r\n\r\n/**\r\n * Stats processing logic.\r\n */\r\nStatsCollector.prototype.processAudioLevelReport = function() {\r\n    if (!this.baselineAudioLevelsReport) {\r\n        return;\r\n    }\r\n\r\n    const getStatValue = this._getStatValue;\r\n\r\n    for (const idx in this.currentAudioLevelsReport) {\r\n        if (!this.currentAudioLevelsReport.hasOwnProperty(idx)) {\r\n            continue;\r\n        }\r\n\r\n        const now = this.currentAudioLevelsReport[idx];\r\n\r\n        if (now.type !== 'ssrc' && now.type !== 'track') {\r\n            continue;\r\n        }\r\n\r\n        const before = this.baselineAudioLevelsReport[idx];\r\n        let ssrc = this.getNonNegativeStat(now, 'ssrc');\r\n\r\n        if (!ssrc && Array.isArray(now.ssrcIds)) {\r\n            ssrc = Number(now.ssrcIds[0]);\r\n        }\r\n\r\n        if (!before) {\r\n            logger.warn(`${ssrc} not enough data`);\r\n            continue;\r\n        }\r\n\r\n        if (!ssrc) {\r\n            if ((Date.now() - now.timestamp) < 3000) {\r\n                logger.warn('No ssrc: ');\r\n            }\r\n            continue;\r\n        }\r\n\r\n        // Audio level\r\n        let audioLevel;\r\n\r\n        try {\r\n            audioLevel\r\n                = getStatValue(now, 'audioInputLevel')\r\n                    || getStatValue(now, 'audioOutputLevel');\r\n        } catch (e) { /* not supported*/\r\n            logger.warn('Audio Levels are not available in the statistics.');\r\n            clearInterval(this.audioLevelsIntervalId);\r\n\r\n            return;\r\n        }\r\n\r\n        if (audioLevel) {\r\n            let isLocal;\r\n\r\n            // If type=\"ssrc\" (legacy) check whether they are received packets.\r\n            if (now.type === 'ssrc') {\r\n                isLocal = !getStatValue(now, 'packetsReceived');\r\n\r\n            // If type=\"track\", check remoteSource boolean property.\r\n            } else {\r\n                isLocal = !now.remoteSource;\r\n            }\r\n\r\n            // According to the W3C WebRTC Stats spec, audioLevel should be in\r\n            // 0..1 range (0 == silence). However browsers don't behave that\r\n            // way so we must convert it to 0..1.\r\n            //\r\n            // In Edge the range is -100..0 (-100 == silence) measured in dB,\r\n            // so convert to linear. The levels are set to 0 for remote tracks,\r\n            // so don't convert those, since 0 means \"the maximum\" in Edge.\r\n            if (browser.isEdge()) {\r\n                audioLevel = audioLevel < 0 ? Math.pow(10, audioLevel / 20) : 0;\r\n\r\n            // TODO: Can't find specs about what this value really is, but it\r\n            // seems to vary between 0 and around 32k.\r\n            } else {\r\n                audioLevel = audioLevel / 32767;\r\n            }\r\n\r\n            this.eventEmitter.emit(\r\n                StatisticsEvents.AUDIO_LEVEL,\r\n                this.peerconnection,\r\n                ssrc,\r\n                audioLevel,\r\n                isLocal);\r\n        }\r\n    }\r\n};\r\n\r\n/* eslint-enable no-continue */\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/statistics/RTPStatsCollector.js","/*!\n * currentExecutingScript\n * Get the currently executing script, regardless of its source/trigger/synchronicity. Similar to HTML5's `document.currentScript` but arguably much more useful!\n * Copyright (c) 2015 James M. Greene\n * Licensed MIT\n * https://github.com/JamesMGreene/currentExecutingScript\n * v0.1.3\n */\n(function(root, factory) {\n  if (typeof define === \"function\" && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([], factory);\n  } else if (typeof exports === \"object\") {\n    // CommonJS-like environments that support `module.exports`,\n    // like Node.js. Does not work with strict CommonJS!\n    module.exports = factory();\n  } else {\n    // Browser globals (`root` is `window`)\n    root.currentExecutingScript = factory();\n  }\n}(\n  // Current context/scope\n  this || window,\n\n  // Factory function to return the export\n  function() {\n\nvar scriptReadyRegex = /^(interactive|loaded|complete)$/;\n\n// This page's URL (minus query string and fragment identifer hash, if any)\nvar fullPageUrl = !!window.location ? window.location.href : null;\nvar pageUrl = fullPageUrl ? fullPageUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\") || null : null;\n\n// Live NodeList collection\nvar scripts = document.getElementsByTagName(\"script\");\n\n// Check if the browser supports the `readyState` property on `script` elements\nvar supportsScriptReadyState = \"readyState\" in (scripts[0] || document.createElement(\"script\"));\n\n// Lousy browser detection for [not] Opera\nvar isNotOpera = !window.opera || window.opera.toString() !== \"[object Opera]\";\n\n// Detect if `document.currentScript` is supported\nvar hasNativeCurrentScriptAccessor = \"currentScript\" in document;\n\nvar originalStackDepthConfig;\n// Detect if the V8 Error Stack Trace API is supported\nif (\"stackTraceLimit\" in Error && Error.stackTraceLimit !== Infinity) {\n  originalStackDepthConfig = Error.stackTraceLimit;\n  Error.stackTraceLimit = Infinity;\n}\n\n\n// In some browsers (e.g. Chrome), you can get the current stack from an Error\n// object instance without needing to throw it. Avoiding an unnecessary\n// use of `throw` saves time and performance.\nvar hasStackBeforeThrowing = false,\n    hasStackAfterThrowing = false;\n(function() {\n  try {\n    var err = new Error();\n    hasStackBeforeThrowing = typeof err.stack === \"string\" && !!err.stack;\n    throw err;\n  }\n  catch (thrownErr) {\n    hasStackAfterThrowing = typeof thrownErr.stack === \"string\" && !!thrownErr.stack;\n  }\n})();\n\n\n// Normalize whitespace within a string\nfunction normalizeWhitespace(str) {\n  return str ? str.replace(/^\\s+$|\\s+$/g, \"\").replace(/\\s\\s+/g, \" \") : \"\";\n}\n\n// Get script object based on the `src` URL\nfunction getScriptFromUrl(url, eligibleScripts) {\n  var i,\n      script = null;\n\n  eligibleScripts = eligibleScripts || scripts;\n\n  if (typeof url === \"string\" && url) {\n    for (i = eligibleScripts.length; i--; ) {\n      if (eligibleScripts[i].src === url) {\n        // NOTE: Could check if the same script URL is used by more than one `script` element\n        // here... but let's not. That would yield less useful results in \"loose\" detection. ;)\n        script = eligibleScripts[i];\n        break;\n      }\n    }\n  }\n  return script;\n}\n\n// Get script object based on the caller function's source code body (text)\nfunction getInlineScriptFromCallerSource(callerFnSource, eligibleScripts) {\n  var i, inlineScriptText,\n      script = null,\n      callerSourceText = normalizeWhitespace(callerFnSource);\n\n  eligibleScripts = eligibleScripts || scripts;\n\n  if (callerFnSource && callerSourceText) {\n    for (i = eligibleScripts.length; i--; ) {\n      // Only look at inline scripts\n      if (!eligibleScripts[i].hasAttribute(\"src\")) {\n        inlineScriptText = normalizeWhitespace(eligibleScripts[i].text);\n        if (inlineScriptText.indexOf(callerSourceText) !== -1) {\n          // If more than one match is found, don't return any\n          if (script) {\n            script = null;\n            break;\n          }\n          script = eligibleScripts[i];\n        }\n      }\n    }\n  }\n\n  return script;\n}\n\n// If there is only a single inline script on the page, return it; otherwise `null`\nfunction getSoleInlineScript(eligibleScripts) {\n  var i, len,\n      script = null;\n  eligibleScripts = eligibleScripts || scripts;\n  for (i = 0, len = eligibleScripts.length; i < len; i++) {\n    if (!eligibleScripts[i].hasAttribute(\"src\")) {\n      if (script) {\n        script = null;\n        break;\n      }\n      script = eligibleScripts[i];\n    }\n  }\n  return script;\n}\n\n// Get the currently executing script URL from an Error stack trace\nfunction getScriptUrlFromStack(stack, skipStackDepth) {\n  var matches, remainingStack,\n      url = null,\n      ignoreMessage = typeof skipStackDepth === \"number\";\n  skipStackDepth = ignoreMessage ? Math.round(skipStackDepth) : 0;\n  if (typeof stack === \"string\" && stack) {\n    if (ignoreMessage) {\n      matches = stack.match(/(data:text\\/javascript(?:;[^,]+)?,.+?|(?:|blob:)(?:http[s]?|file):\\/\\/[\\/]?.+?\\/[^:\\)]*?)(?::\\d+)(?::\\d+)?/);\n    }\n    else {\n      matches = stack.match(/^(?:|[^:@]*@|.+\\)@(?=data:text\\/javascript|blob|http[s]?|file)|.+?\\s+(?: at |@)(?:[^:\\(]+ )*[\\(]?)(data:text\\/javascript(?:;[^,]+)?,.+?|(?:|blob:)(?:http[s]?|file):\\/\\/[\\/]?.+?\\/[^:\\)]*?)(?::\\d+)(?::\\d+)?/);\n\n      if (!(matches && matches[1])) {\n        matches = stack.match(/\\)@(data:text\\/javascript(?:;[^,]+)?,.+?|(?:|blob:)(?:http[s]?|file):\\/\\/[\\/]?.+?\\/[^:\\)]*?)(?::\\d+)(?::\\d+)?/);\n      }\n    }\n\n    if (matches && matches[1]) {\n      if (skipStackDepth > 0) {\n        remainingStack = stack.slice(stack.indexOf(matches[0]) + matches[0].length);\n        url = getScriptUrlFromStack(remainingStack, (skipStackDepth - 1));\n      }\n      else {\n        url = matches[1];\n      }\n    }\n\n    // TODO: Handle more edge cases!\n    // Fixes #1\n    // See https://github.com/JamesMGreene/currentExecutingScript/issues/1\n\n    // ???\n\n  }\n  return url;\n}\n\n\n// Get the farthest currently executing (i.e. yes, EXECUTING) `script` DOM\n// element for the caller function, regardless of whether it is that `script`\n// DOM element is currently being evaluated for the first time. The farthest\n// currently executing `script` DOM element would typically be considered the\n// originator of the current execution stack.\nfunction _farthestExecutingScript() {\n  /*jshint noarg:false */\n\n  // TODO: Implement!\n  // Fixes #3\n  // See https://github.com/JamesMGreene/currentExecutingScript/issues/3\n  return null;\n\n/*\n  // Yes, this IS possible, i.e. if a script removes other scripts (or itself)\n  if (scripts.length === 0) {\n    return null;\n  }\n\n  // Guaranteed accurate in IE 6-10.\n  // Not accurate/supported in any other browsers.\n  if (isNotOpera && supportsScriptReadyState) {\n    for (var i = scripts.length; i--; ) {\n      if (scripts[i].readyState === \"interactive\") {\n        return scripts[i];\n      }\n    }\n  }\n\n  var stack,\n      e = new Error();\n  if (hasStackBeforeThrowing) {\n    stack = e.stack;\n  }\n  if (!stack && hasStackAfterThrowing) {\n    try {\n      throw e;\n    }\n    catch (err) {\n      // NOTE: Cannot use `err.sourceURL` or `err.fileName` as they will always be THIS script\n      stack = err.stack;\n    }\n  }\n  if (stack) {\n    var url = getScriptUrlFromStack(stack, skipStackDepth);\n    var script = getScriptFromUrl(url, scripts );\n    if (!script && pageUrl && url === pageUrl) {\n      // Try to find the correct inline script by searching through\n      // inline scripts' text content for the caller function's source\n      // code to be present. If the caller function's source code is\n      // not available, see if there is only one inline script element\n      // in the DOM and return that (even though it may be wrong)\n\n      // TODO: Implement!\n      // Fixes #4 in part\n      // See https://github.com/JamesMGreene/currentExecutingScript/issues/4\n\n      var callerFn = _farthestExecutingScript.caller || null,\n          callerFnStack = [],\n          callerFnSource = null;\n\n      while (callerFn) {\n        callerFnStack.push(callerFn);\n        callerFn = callerFn.caller || null;\n      }\n      callerFn = callerFnStack.slice(-1)[0];\n      callerFnSource = callerFn ? (\"\" + callerFn) : null;\n\n\n      if (callerFnSource) {\n        script = getInlineScriptFromCallerSource(callerFnSource);\n      }\n      else {\n        // NOTE: This is a loose assumption that could be inaccurate!\n        //\n        // Inaccuracies:\n        //  - If the inline script that initiated the call was also removed from the DOM.\n        //  - If the call was initiated by an element's inline event handler,\n        //    e.g. `<a onclick=\"(function() { alert(currentExecutingScript()); }()\">click</a>`\n        script = getSoleInlineScript();\n      }\n    }\n    return script;\n  }\n\n  // NOTE: This is a loose assumption that could be inaccurate!\n  //\n  // Inaccuracies:\n  //  - If a script is created dynamically and appended to some position\n  //    other than the very end of the document.\n  //  - If multiple scripts are created dynamically and all appended to the\n  //    same position within the document (and do not have their `async` attributes\n  //    set to `false`, at least in browsers that support async script evaluation.\n  //    other than the very end of the document.\n  //  - If any scripts are added with the `async` attribute set to `true` in a browser\n  //    that supports it.\n  //  - May get confused by `script` elements within `svg` elements\n  return scripts[scripts.length - 1] || null;\n*/\n}\n\n\n// Get the originating currently executing (i.e. yes, EXECUTING) `script` DOM\n// element or attribute node (e.g. `onclick`) for the caller function,\n// regardless of whether it is that `script` DOM element is currently being\n// evaluated for the first time. The originating currently executing `script`\n// DOM element [or attribute node] is the originator of the current execution stack.\nfunction _originatingExecutingScript() {\n  // TODO: Implement!\n  // Fixes #2\n  // See https://github.com/JamesMGreene/currentExecutingScript/issues/2\n  return null;\n}\n\n// Get the nearest currently executing (i.e. yes, EXECUTING) `script` DOM\n// element for the caller function, regardless of whether it is that `script`\n// DOM element is currently being evaluated for the first time.\nfunction _nearestExecutingScript() {\n  /*jshint noarg:false */\n\n  // Yes, this IS possible, i.e. if a script removes other scripts (or itself)\n  if (scripts.length === 0) {\n    return null;\n  }\n\n  var i, e, stack, url, script,\n      eligibleScripts = [],\n      skipStackDepth = _nearestExecutingScript.skipStackDepth || 1,\n\n      // TODO: Implement!\n      // Fixes #4 in part\n      // See https://github.com/JamesMGreene/currentExecutingScript/issues/4\n      callerFnSource = null;  //(\"\" + (_nearestExecutingScript.caller || \"\")) || null;\n\n  // This part will only help in IE 6-10.\n  for (i = 0; i < scripts.length; i++) {\n    if (isNotOpera && supportsScriptReadyState) {\n      if (scriptReadyRegex.test(scripts[i].readyState)) {\n        eligibleScripts.push(scripts[i]);\n      }\n    }\n    else {\n      eligibleScripts.push(scripts[i]);\n    }\n  }\n\n  e = new Error();\n  if (hasStackBeforeThrowing) {\n    stack = e.stack;\n  }\n  if (!stack && hasStackAfterThrowing) {\n    try {\n      throw e;\n    }\n    catch (err) {\n      // NOTE: Cannot use `err.sourceURL` or `err.fileName` as they will always be THIS script\n      stack = err.stack;\n    }\n  }\n\n  if (stack) {\n    url = getScriptUrlFromStack(stack, skipStackDepth);\n    script = getScriptFromUrl(url, eligibleScripts);\n\n    if (!script && pageUrl && url === pageUrl) {\n      // Try to find the correct inline script by searching through\n      // inline scripts' text content for the caller function's source\n      // code to be present.\n      if (callerFnSource) {\n        script = getInlineScriptFromCallerSource(callerFnSource, eligibleScripts);\n      }\n      // If the caller function's source code is not available, see if\n      // there is only one inline script element in the DOM and return\n      // that (even though it may be wrong)...\n      else {\n        // NOTE: This is a loose assumption that could be inaccurate!\n        //\n        // Inaccuracies:\n        //  - If the inline script that initiated the call was also removed from the DOM.\n        //  - If the call was initiated by an element's inline event handler,\n        //    e.g. `<a onclick=\"(function() { alert(currentExecutingScript()); }()\">click</a>`\n        script = getSoleInlineScript(eligibleScripts);\n      }\n    }\n  }\n\n  //\n  // Welcome to the Island of Inaccurate Assumptions!\n  // NOTE: ALL of the following are loose assumptions that could be inaccurate!\n  //\n\n  if (!script) {\n    // Inaccuracies:\n    //  - If the inline script that initiated the call was also removed from the DOM.\n    //  - If the call was initiated by an element's inline event handler,\n    //    e.g. `<a onclick=\"(function() { alert(currentExecutingScript()); }()\">click</a>`\n    if (eligibleScripts.length === 1) {\n      script = eligibleScripts[0];\n    }\n  }\n\n  if (!script) {\n    // Inaccuracies:\n    //  - If script currently being synchronously evaluated by the parser is the\n    //    originator of this call stack but NOT the source script of the caller/invocation\n    //    e.g.\n    //    ```html\n    //    <script id=\"a\">\n    //    function getCurrentScriptCallerFn() {\n    //      return currentExecutingScript.near();\n    //    }\n    //    </script>\n    //    <script id=\"b\">\n    //    // Should get `script[id=\"a\"]` but will get `script[id=\"b\"]` instead\n    //    getCurrentScriptCallerFn();\n    //    </script>\n    if (hasNativeCurrentScriptAccessor) {\n      script = document.currentScript;\n    }\n  }\n\n  if (!script) {\n    // Inaccuracies:\n    //  - If script currently being synchronously evaluated by the parser is the\n    //    originator of this call stack but NOT the source script of the caller/invocation\n    //    e.g.\n    //    ```html\n    //    <script id=\"a\">\n    //    function getCurrentScriptCallerFn() {\n    //      return currentExecutingScript.near();\n    //    }\n    //    </script>\n    //    <script id=\"b\">\n    //    // Should get `script[id=\"a\"]` but will get `script[id=\"b\"]` instead\n    //    getCurrentScriptCallerFn();\n    //    </script>\n    if (isNotOpera && supportsScriptReadyState) {\n      for (i = eligibleScripts.length; i--; ) {\n        if (eligibleScripts[i].readyState === \"interactive\") {\n          script = eligibleScripts[i];\n          break;\n        }\n      }\n    }\n  }\n\n  if (!script) {\n    // Inaccuracies:\n    //  - If a script is created dynamically and appended to some position\n    //    other than the very end of the document.\n    //  - If multiple scripts are created dynamically and all appended to the\n    //    same position within the document (and do not have their `async` attributes\n    //    set to `false`, at least in browsers that support async script evaluation.\n    //    other than the very end of the document.\n    //  - If any scripts are added with the `async` attribute set to `true` in a browser\n    //    that supports it.\n    //  - May get confused by `script` elements within `svg` elements\n    //  - If script currently being synchronously evaluated by the parser is the\n    //    originator of this call stack but NOT the source script of the caller/invocation\n    //    e.g.\n    //    ```html\n    //    <script id=\"a\">\n    //    function getCurrentScriptCallerFn() {\n    //      return currentExecutingScript.near();\n    //    }\n    //    </script>\n    //    <script id=\"b\">\n    //    // Should get `script[id=\"a\"]` but will get `script[id=\"b\"]` instead\n    //    getCurrentScriptCallerFn();\n    //    </script>\n    //    ```\n    script = eligibleScripts[eligibleScripts.length - 1] || null;\n  }\n\n  return script;\n}\n\n// Default stack depth to skip over when analyzing call stack frames\n_nearestExecutingScript.skipStackDepth = 1;\n\n\n\n    //\n    // Export the API\n    //\n    var currentExecutingScript    = _nearestExecutingScript;      // default\n    currentExecutingScript.near   = _nearestExecutingScript;\n    currentExecutingScript.far    = _farthestExecutingScript;\n    currentExecutingScript.origin = _originatingExecutingScript;\n\n\n    // Just return a value to define the module export.\n    // This example returns an object, but the module\n    // can return a function as the exported value.\n    return currentExecutingScript;\n  })\n);\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/current-executing-script/dist/currentExecutingScript.js","const Constants = {\r\n    LOCAL_JID: 'local'\r\n};\r\n\r\nmodule.exports = Constants;\r\n\n\n\n// WEBPACK FOOTER //\n// ./service/statistics/constants.js","import Statistics from '../statistics/statistics';\r\n\r\nconst logger = require('jitsi-meet-logger').getLogger(__filename);\r\n\r\n/**\r\n * The constant for the name of the focus component.\r\n * @type {string}\r\n */\r\nComponentsVersions.FOCUS_COMPONENT = 'focus';\r\n\r\n/**\r\n * The constant for the name of the videobridge component.\r\n * @type {string}\r\n */\r\nComponentsVersions.VIDEOBRIDGE_COMPONENT = 'videobridge';\r\n\r\n/**\r\n * The constant for the name of the XMPP server component.\r\n * @type {string}\r\n */\r\nComponentsVersions.XMPP_SERVER_COMPONENT = 'xmpp';\r\n\r\n/**\r\n * Creates new instance of <tt>ComponentsVersions</tt> which will be discovering\r\n * the versions of conferencing system components in given\r\n * <tt>JitsiConference</tt>.\r\n * @param conference <tt>JitsiConference</tt> instance which will be used to\r\n *        listen for focus presence updates.\r\n * @constructor\r\n */\r\nexport default function ComponentsVersions(conference) {\r\n\r\n    this.versions = {};\r\n\r\n    this.conference = conference;\r\n    this.conference.addCommandListener(\r\n        'versions', this.processPresence.bind(this));\r\n}\r\n\r\nComponentsVersions.prototype.processPresence\r\n    = function(node, mucResource, mucJid) {\r\n        if (node.attributes.xmlns !== 'http://jitsi.org/jitmeet') {\r\n            logger.warn('Ignored presence versions node - invalid xmlns', node);\r\n\r\n            return;\r\n        }\r\n\r\n        if (!this.conference._isFocus(mucJid)) {\r\n            logger.warn(\r\n                `Received versions not from the focus user: ${node}`,\r\n                mucJid);\r\n\r\n            return;\r\n        }\r\n\r\n        const log = [];\r\n\r\n        node.children.forEach(item => {\r\n\r\n            const componentName = item.attributes.name;\r\n\r\n            if (componentName !== ComponentsVersions.FOCUS_COMPONENT\r\n            && componentName !== ComponentsVersions.XMPP_SERVER_COMPONENT\r\n            && componentName !== ComponentsVersions.VIDEOBRIDGE_COMPONENT) {\r\n                logger.warn(\r\n                    `Received version for not supported component name: ${\r\n                        componentName}`);\r\n\r\n                return;\r\n            }\r\n\r\n            const version = item.value;\r\n\r\n            if (this.versions[componentName] !== version) {\r\n                this.versions[componentName] = version;\r\n                logger.info(`Got ${componentName} version: ${version}`);\r\n\r\n                log.push({\r\n                    id: 'component_version',\r\n                    component: componentName,\r\n                    version\r\n                });\r\n            }\r\n        });\r\n\r\n        // logs versions to stats\r\n        if (log.length > 0) {\r\n            Statistics.sendLog(JSON.stringify(log));\r\n        }\r\n    };\r\n\r\n/**\r\n * Obtains the version of conferencing system component.\r\n * @param componentName the name of the component for which we want to obtain\r\n *        the version.\r\n * @returns {String} which describes the version of the component identified by\r\n *          given <tt>componentName</tt> or <tt>undefined</tt> if not found.\r\n */\r\nComponentsVersions.prototype.getComponentVersion = function(componentName) {\r\n    return this.versions[componentName];\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/version/ComponentsVersions.js","import * as ConnectionQualityEvents\r\n    from '../../service/connectivity/ConnectionQualityEvents';\r\nimport * as ConferenceEvents from '../../JitsiConferenceEvents';\r\nimport { getLogger } from 'jitsi-meet-logger';\r\n\r\nconst XMPPEvents = require('../../service/xmpp/XMPPEvents');\r\nconst VideoType = require('../../service/RTC/VideoType');\r\nconst Resolutions = require('../../service/RTC/Resolutions');\r\n\r\nconst logger = getLogger(__filename);\r\n\r\n/**\r\n * The value to use for the \"type\" field for messages sent by ConnectionQuality\r\n * over the data channel.\r\n */\r\nconst STATS_MESSAGE_TYPE = 'stats';\r\n\r\n/**\r\n * See media/engine/simulcast.ss from webrtc.org\r\n */\r\nconst kSimulcastFormats = [\r\n    { width: 1920,\r\n        height: 1080,\r\n        layers: 3,\r\n        max: 5000,\r\n        target: 4000,\r\n        min: 800 },\r\n    { width: 1280,\r\n        height: 720,\r\n        layers: 3,\r\n        max: 2500,\r\n        target: 2500,\r\n        min: 600 },\r\n    { width: 960,\r\n        height: 540,\r\n        layers: 3,\r\n        max: 900,\r\n        target: 900,\r\n        min: 450 },\r\n    { width: 640,\r\n        height: 360,\r\n        layers: 2,\r\n        max: 700,\r\n        target: 500,\r\n        min: 150 },\r\n    { width: 480,\r\n        height: 270,\r\n        layers: 2,\r\n        max: 450,\r\n        target: 350,\r\n        min: 150 },\r\n    { width: 320,\r\n        height: 180,\r\n        layers: 1,\r\n        max: 200,\r\n        target: 150,\r\n        min: 30 }\r\n];\r\n\r\n/**\r\n * The initial bitrate for video in kbps.\r\n */\r\nlet startBitrate = 800;\r\n\r\n/**\r\n * Gets the expected bitrate (in kbps) in perfect network conditions.\r\n * @param simulcast {boolean} whether simulcast is enabled or not.\r\n * @param resolution {Resolution} the resolution.\r\n * @param millisSinceStart {number} the number of milliseconds since sending\r\n * video started.\r\n */\r\nfunction getTarget(simulcast, resolution, millisSinceStart) {\r\n    // Completely ignore the bitrate in the first 5 seconds, as the first\r\n    // event seems to fire very early and the value is suspicious and causes\r\n    // false positives.\r\n    if (millisSinceStart < 5000) {\r\n        return 1;\r\n    }\r\n\r\n    let target = 0;\r\n    let height = Math.min(resolution.height, resolution.width);\r\n\r\n    if (simulcast) {\r\n        // Find the first format with height no bigger than ours.\r\n        let simulcastFormat = kSimulcastFormats.find(f => f.height <= height);\r\n\r\n        if (simulcastFormat) {\r\n            // Sum the target fields from all simulcast layers for the given\r\n            // resolution (e.g. 720p + 360p + 180p).\r\n            for (height = simulcastFormat.height; height >= 180; height /= 2) {\r\n                const targetHeight = height;\r\n\r\n                simulcastFormat\r\n                    = kSimulcastFormats.find(f => f.height === targetHeight);\r\n                if (simulcastFormat) {\r\n                    target += simulcastFormat.target;\r\n                } else {\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    } else {\r\n        // See GetMaxDefaultVideoBitrateKbps in\r\n        // media/engine/webrtcvideoengine2.cc from webrtc.org\r\n        const pixels = resolution.width * resolution.height;\r\n\r\n        if (pixels <= 320 * 240) {\r\n            target = 600;\r\n        } else if (pixels <= 640 * 480) {\r\n            target = 1700;\r\n        } else if (pixels <= 960 * 540) {\r\n            target = 2000;\r\n        } else {\r\n            target = 2500;\r\n        }\r\n    }\r\n\r\n    // Allow for an additional 1 second for ramp up -- delay any initial drop\r\n    // of connection quality by 1 second.\r\n    return Math.min(target, rampUp(Math.max(0, millisSinceStart - 1000)));\r\n}\r\n\r\n/**\r\n * Gets the bitrate to which GCC would have ramped up in perfect network\r\n * conditions after millisSinceStart milliseconds.\r\n * @param millisSinceStart {number} the number of milliseconds since sending\r\n * video was enabled.\r\n */\r\nfunction rampUp(millisSinceStart) {\r\n    if (millisSinceStart > 60000) {\r\n        return Number.MAX_SAFE_INTEGER;\r\n    }\r\n\r\n    // According to GCC the send side bandwidth estimation grows with at most\r\n    // 8% per second.\r\n    // https://tools.ietf.org/html/draft-ietf-rmcat-gcc-02#section-5.5\r\n    return startBitrate * Math.pow(1.08, millisSinceStart / 1000);\r\n}\r\n\r\n/**\r\n * A class which monitors the local statistics coming from the RTC modules, and\r\n * calculates a \"connection quality\" value, in percent, for the media\r\n * connection. A value of 100% indicates a very good network connection, and a\r\n * value of 0% indicates a poor connection.\r\n */\r\nexport default class ConnectionQuality {\r\n    /**\r\n     *\r\n     * @param conference\r\n     * @param eventEmitter\r\n     * @param options\r\n     */\r\n    constructor(conference, eventEmitter, options) {\r\n        this.eventEmitter = eventEmitter;\r\n\r\n        /**\r\n         * The owning JitsiConference.\r\n         */\r\n        this._conference = conference;\r\n\r\n        /**\r\n         * Holds statistics about the local connection quality.\r\n         */\r\n        this._localStats = {\r\n            connectionQuality: 100,\r\n            jvbRTT: undefined\r\n        };\r\n\r\n        /**\r\n         * The time this._localStats.connectionQuality was last updated.\r\n         */\r\n        this._lastConnectionQualityUpdate = -1;\r\n\r\n        /**\r\n         * Maps a participant ID to an object holding connection quality\r\n         * statistics received from this participant.\r\n         */\r\n        this._remoteStats = {};\r\n\r\n        /**\r\n         * The time that the ICE state last changed to CONNECTED. We use this\r\n         * to calculate how much time we as a sender have had to ramp-up.\r\n         */\r\n        this._timeIceConnected = -1;\r\n\r\n        /**\r\n         * The time that local video was unmuted. We use this to calculate how\r\n         * much time we as a sender have had to ramp-up.\r\n         */\r\n        this._timeVideoUnmuted = -1;\r\n\r\n\r\n        // We assume a global startBitrate value for the sake of simplicity.\r\n        if (options.startBitrate && options.startBitrate > 0) {\r\n            startBitrate = options.startBitrate;\r\n        }\r\n\r\n        // TODO: consider ignoring these events and letting the user of\r\n        // lib-jitsi-meet handle these separately.\r\n        conference.on(\r\n            ConferenceEvents.CONNECTION_INTERRUPTED,\r\n            () => {\r\n                this._updateLocalConnectionQuality(0);\r\n                this.eventEmitter.emit(\r\n                    ConnectionQualityEvents.LOCAL_STATS_UPDATED,\r\n                    this._localStats);\r\n                this._broadcastLocalStats();\r\n            });\r\n\r\n        conference.room.addListener(\r\n            XMPPEvents.ICE_CONNECTION_STATE_CHANGED,\r\n            (jingleSession, newState) => {\r\n                if (!jingleSession.isP2P && newState === 'connected') {\r\n                    this._timeIceConnected = window.performance.now();\r\n                }\r\n            });\r\n\r\n        // Listen to DataChannel message from other participants in the\r\n        // conference, and update the _remoteStats field accordingly.\r\n        conference.on(\r\n            ConferenceEvents.ENDPOINT_MESSAGE_RECEIVED,\r\n            (participant, payload) => {\r\n                if (payload.type === STATS_MESSAGE_TYPE) {\r\n                    this._updateRemoteStats(\r\n                        participant.getId(), payload.values);\r\n                }\r\n            });\r\n\r\n        // Listen to local statistics events originating from the RTC module\r\n        // and update the _localStats field.\r\n        // Oh, and by the way, the resolutions of all remote participants are\r\n        // also piggy-backed in these \"local\" statistics. It's obvious, really,\r\n        // if one carefully reads the *code* (but not the docs) in\r\n        // UI/VideoLayout/VideoLayout.js#updateLocalConnectionStats in\r\n        // jitsi-meet\r\n        // TODO: We should keep track of the remote resolution in _remoteStats,\r\n        // and notify about changes via separate events.\r\n        conference.statistics.addConnectionStatsListener(\r\n            this._updateLocalStats.bind(this));\r\n\r\n        // Save the last time we were unmuted.\r\n        conference.on(\r\n            ConferenceEvents.TRACK_MUTE_CHANGED,\r\n            track => {\r\n                if (track.isVideoTrack()) {\r\n                    if (track.isMuted()) {\r\n                        this._timeVideoUnmuted = -1;\r\n                    } else {\r\n                        this._maybeUpdateUnmuteTime();\r\n                    }\r\n                }\r\n            });\r\n        conference.on(\r\n            ConferenceEvents.TRACK_ADDED,\r\n            track => {\r\n                if (track.isVideoTrack() && !track.isMuted()) {\r\n                    this._maybeUpdateUnmuteTime();\r\n                }\r\n            });\r\n    }\r\n\r\n    /**\r\n     * Sets _timeVideoUnmuted if it was previously unset. If it was already set,\r\n     * doesn't change it.\r\n     */\r\n    _maybeUpdateUnmuteTime() {\r\n        if (this._timeVideoUnmuted < 0) {\r\n            this._timeVideoUnmuted = window.performance.now();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Calculates a new \"connection quality\" value.\r\n     * @param videoType {VideoType} the type of the video source (camera or\r\n     * a screen capture).\r\n     * @param isMuted {boolean} whether the local video is muted.\r\n     * @param resolutionName {Resolution} the input resolution used by the\r\n     * camera.\r\n     * @returns {*} the newly calculated connection quality.\r\n     */\r\n    _calculateConnectionQuality(videoType, isMuted, resolutionName) {\r\n\r\n        // resolutionName is an index into Resolutions (where \"720\" is\r\n        // \"1280x720\" and \"960\" is \"960x720\" ...).\r\n        const resolution = Resolutions[resolutionName];\r\n\r\n        let quality = 100;\r\n        let isSimulcastOn;\r\n        let millisSinceStart;\r\n        let packetLoss;\r\n        let target;\r\n\r\n        // TODO: take into account packet loss for received streams\r\n\r\n        if (this._localStats.packetLoss) {\r\n            packetLoss = this._localStats.packetLoss.upload;\r\n\r\n            // Ugly Hack Alert (UHA):\r\n            // The packet loss for the upload direction is calculated based on\r\n            // incoming RTCP Receiver Reports. Since we don't have RTCP\r\n            // termination for audio, these reports come from the actual\r\n            // receivers in the conference and therefore the reported packet\r\n            // loss includes loss from the bridge to the receiver.\r\n            // When we are sending video this effect is small, because the\r\n            // number of video packets is much larger than the number of audio\r\n            // packets (and our calculation is based on the total number of\r\n            // received and lost packets).\r\n            // When video is muted, however, the effect might be significant,\r\n            // but we don't know what it is. We do know that it is positive, so\r\n            // as a temporary solution, until RTCP termination is implemented\r\n            // for the audio streams, we relax the packet loss checks here.\r\n            if (isMuted) {\r\n                packetLoss *= 0.5;\r\n            }\r\n        }\r\n\r\n        if (isMuted || !resolution || videoType === VideoType.DESKTOP\r\n            || this._timeIceConnected < 0\r\n            || this._timeVideoUnmuted < 0) {\r\n\r\n            // Calculate a value based on packet loss only.\r\n            if (packetLoss === undefined) {\r\n                logger.error('Cannot calculate connection quality, unknown '\r\n                    + 'packet loss.');\r\n                quality = 100;\r\n            } else if (packetLoss <= 2) {\r\n                quality = 100; // Full 5 bars.\r\n            } else if (packetLoss <= 4) {\r\n                quality = 70; // 4 bars\r\n            } else if (packetLoss <= 6) {\r\n                quality = 50; // 3 bars\r\n            } else if (packetLoss <= 8) {\r\n                quality = 30; // 2 bars\r\n            } else if (packetLoss <= 12) {\r\n                quality = 10; // 1 bars\r\n            } else {\r\n                quality = 0; // Still 1 bar, but slower climb-up.\r\n            }\r\n        } else {\r\n            // Calculate a value based on the sending bitrate.\r\n\r\n            // time since sending of video was enabled.\r\n            millisSinceStart = window.performance.now()\r\n                    - Math.max(this._timeVideoUnmuted, this._timeIceConnected);\r\n\r\n            // Figure out if simulcast is in use\r\n            const activeTPC = this._conference.getActivePeerConnection();\r\n\r\n            isSimulcastOn\r\n                = Boolean(activeTPC && activeTPC.isSimulcastOn());\r\n\r\n            // expected sending bitrate in perfect conditions\r\n            target\r\n                = getTarget(isSimulcastOn, resolution, millisSinceStart);\r\n\r\n            target = 0.9 * target;\r\n\r\n            quality = 100 * this._localStats.bitrate.upload / target;\r\n\r\n            // Whatever the bitrate, drop early if there is significant loss\r\n            if (packetLoss && packetLoss >= 10) {\r\n                quality = Math.min(quality, 30);\r\n            }\r\n        }\r\n\r\n        // Make sure that the quality doesn't climb quickly\r\n        if (this._lastConnectionQualityUpdate > 0) {\r\n            const maxIncreasePerSecond = 2;\r\n            const prevConnectionQuality = this._localStats.connectionQuality;\r\n            const diffSeconds\r\n                = (window.performance.now() - this._lastConnectionQualityUpdate)\r\n                    / 1000;\r\n\r\n            quality\r\n                = Math.min(\r\n                    quality,\r\n                    prevConnectionQuality\r\n                        + (diffSeconds * maxIncreasePerSecond));\r\n        }\r\n\r\n        const connectionQuality = Math.min(100, quality);\r\n\r\n        console.debug('calculated connection quality', JSON.stringify({\r\n            connectionQuality,\r\n            isMuted,\r\n            isSimulcastOn,\r\n            lastUpdate: this._lastConnectionQualityUpdate,\r\n            millisSinceStart,\r\n            packetLoss,\r\n            resolution,\r\n            target,\r\n            upload: this._localStats.bitrate\r\n                && this._localStats.bitrate.upload\r\n        }));\r\n\r\n        return connectionQuality;\r\n    }\r\n\r\n    /**\r\n     * Updates the localConnectionQuality value\r\n     * @param values {number} the new value. Should be in [0, 100].\r\n     */\r\n    _updateLocalConnectionQuality(value) {\r\n        this._localStats.connectionQuality = value;\r\n        this._lastConnectionQualityUpdate = window.performance.now();\r\n    }\r\n\r\n    /**\r\n     * Broadcasts the local statistics to all other participants in the\r\n     * conference.\r\n     */\r\n    _broadcastLocalStats() {\r\n        // Send only the data that remote participants care about.\r\n        const data = {\r\n            bitrate: this._localStats.bitrate,\r\n            packetLoss: this._localStats.packetLoss,\r\n            connectionQuality: this._localStats.connectionQuality,\r\n            jvbRTT: this._localStats.jvbRTT\r\n        };\r\n\r\n        try {\r\n            this._conference.broadcastEndpointMessage({\r\n                type: STATS_MESSAGE_TYPE,\r\n                values: data });\r\n        } catch (e) {\r\n            // We often hit this in the beginning of a call, before the data\r\n            // channel is ready. It is not a big problem, because we will\r\n            // send the statistics again after a few seconds, and the error is\r\n            // already logged elsewhere. So just ignore it.\r\n\r\n            // let errorMsg = \"Failed to broadcast local stats\";\r\n            // logger.error(errorMsg, e);\r\n            // GlobalOnErrorHandler.callErrorHandler(\r\n            //    new Error(errorMsg + \": \" + e));\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Updates the local statistics\r\n     * @param {TraceablePeerConnection} tpc the peerconnection which emitted\r\n     * the stats\r\n     * @param data new statistics\r\n     */\r\n    _updateLocalStats(tpc, data) {\r\n        // Update jvbRTT\r\n        if (!tpc.isP2P) {\r\n            const jvbRTT\r\n                = data.transport\r\n                    && data.transport.length && data.transport[0].rtt;\r\n\r\n            this._localStats.jvbRTT = jvbRTT ? jvbRTT : undefined;\r\n        }\r\n\r\n        // Do not continue with processing of other stats if they do not\r\n        // originate from the active peerconnection\r\n        if (tpc !== this._conference.getActivePeerConnection()) {\r\n            return;\r\n        }\r\n\r\n        let key;\r\n        const updateLocalConnectionQuality\r\n            = !this._conference.isConnectionInterrupted();\r\n        const localVideoTrack\r\n            = this._conference.getLocalVideoTrack();\r\n        const videoType\r\n            = localVideoTrack ? localVideoTrack.videoType : undefined;\r\n        const isMuted = localVideoTrack ? localVideoTrack.isMuted() : true;\r\n        const resolution = localVideoTrack ? localVideoTrack.resolution : null;\r\n\r\n        if (!isMuted) {\r\n            this._maybeUpdateUnmuteTime();\r\n        }\r\n\r\n        // Copy the fields already in 'data'.\r\n        for (key in data) {\r\n            if (data.hasOwnProperty(key)) {\r\n                this._localStats[key] = data[key];\r\n            }\r\n        }\r\n\r\n        // And re-calculate the connectionQuality field.\r\n        if (updateLocalConnectionQuality) {\r\n            this._updateLocalConnectionQuality(\r\n                this._calculateConnectionQuality(\r\n                    videoType,\r\n                    isMuted,\r\n                    resolution));\r\n        }\r\n\r\n        this.eventEmitter.emit(\r\n            ConnectionQualityEvents.LOCAL_STATS_UPDATED,\r\n            this._localStats);\r\n        this._broadcastLocalStats();\r\n    }\r\n\r\n    /**\r\n     * Updates remote statistics\r\n     * @param id the id of the remote participant\r\n     * @param data the statistics received\r\n     */\r\n    _updateRemoteStats(id, data) {\r\n        // Use only the fields we need\r\n        this._remoteStats[id] = {\r\n            bitrate: data.bitrate,\r\n            packetLoss: data.packetLoss,\r\n            connectionQuality: data.connectionQuality,\r\n            jvbRTT: data.jvbRTT\r\n        };\r\n\r\n        this.eventEmitter.emit(\r\n            ConnectionQualityEvents.REMOTE_STATS_UPDATED,\r\n            id,\r\n            this._remoteStats[id]);\r\n    }\r\n\r\n    /**\r\n     * Returns the local statistics.\r\n     * Exported only for use in jitsi-meet-torture.\r\n     */\r\n    getStats() {\r\n        return this._localStats;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/connectivity/ConnectionQuality.js","import {\r\n    CONNECTION_DISCONNECTED,\r\n    CONNECTION_ESTABLISHED,\r\n    CONNECTION_FAILED\r\n} from './JitsiConnectionEvents';\r\nimport XMPP from './modules/xmpp/xmpp';\r\n\r\n/**\r\n * @typedef {Object} UpgradeRoleError\r\n *\r\n * @property {JitsiConnectionErrors} [connectionError] - One of\r\n * {@link JitsiConnectionErrors} which occurred when trying to connect to the\r\n * XMPP server.\r\n * @property {String} [authenticationError] - One of XMPP error conditions\r\n * returned by Jicofo on authentication attempt. See\r\n * {@link https://xmpp.org/rfcs/rfc3920.html#streams-error}.\r\n * @property {String} [message] - More details about the error.\r\n * @property {Object} [credentials] - The credentials that failed the\r\n * authentication.\r\n * @property {String} [credentials.jid] - The XMPP ID part of the credentials\r\n * that failed the authentication.\r\n * @property {string} [credentials.password] - The password part of the\r\n * credentials that failed the authentication.\r\n *\r\n * NOTE If neither one of the errors is present, then the operation has been\r\n * canceled.\r\n */\r\n\r\n/* eslint-disable no-invalid-this */\r\n\r\n/**\r\n * Connects to the XMPP server using the specified credentials and contacts\r\n * Jicofo in order to obtain a session ID (which is then stored in the local\r\n * storage). The user's role of the parent conference will be upgraded to\r\n * moderator (by Jicofo). It's also used to join the conference when starting\r\n * from anonymous domain and only authenticated users are allowed to create new\r\n * rooms.\r\n *\r\n * @param {Object} options\r\n * @param {string} options.id - XMPP user's ID to log in. For example,\r\n * user@xmpp-server.com.\r\n * @param {string} options.password - XMPP user's password to log in with.\r\n * @param {string} [options.roomPassword] - The password to join the MUC with.\r\n * @param {Function} [options.onLoginSuccessful] - Callback called when logging\r\n * into the XMPP server was successful. The next step will be to obtain a new\r\n * session ID from Jicofo and join the MUC using it which will effectively\r\n * upgrade the user's role to moderator.\r\n * @returns {Object} A <tt>thenable</tt> which (1) settles when the process of\r\n * authenticating and upgrading the role of the specified XMPP user finishes and\r\n * (2) has a <tt>cancel</tt> method that allows the caller to interrupt the\r\n * process. If the process finishes successfully, the session ID has been stored\r\n * in the settings and the <tt>thenable</tt> is resolved. If the process\r\n * finishes with failure, the <tt>thenable</tt> is rejected with reason of type\r\n * {@link UpgradeRoleError} which will have either <tt>connectionError</tt> or\r\n * <tt>authenticationError</tt> property set depending on which of the steps has\r\n * failed. If <tt>cancel</tt> is called before the process finishes, then the\r\n * thenable will be rejected with an empty object (i.e. no error property will\r\n * be set on the rejection reason).\r\n */\r\nexport default function authenticateAndUpgradeRole({\r\n    // 1. Log the specified XMPP user in.\r\n    id,\r\n    password,\r\n\r\n    // 2. Let the API client/consumer know as soon as the XMPP user has been\r\n    //    successfully logged in.\r\n    onLoginSuccessful,\r\n\r\n    // 3. Join the MUC.\r\n    roomPassword\r\n}) {\r\n    let canceled = false;\r\n    let rejectPromise;\r\n    let xmpp = new XMPP(this.connection.options);\r\n\r\n    const process = new Promise((resolve, reject) => {\r\n        // The process is represented by a Thenable with a cancel method. The\r\n        // Thenable is implemented using Promise and the cancel using the\r\n        // Promise's reject function.\r\n        rejectPromise = reject;\r\n\r\n\r\n        xmpp.addListener(\r\n            CONNECTION_DISCONNECTED,\r\n            () => {\r\n                xmpp = undefined;\r\n            });\r\n        xmpp.addListener(\r\n            CONNECTION_ESTABLISHED,\r\n            () => {\r\n                if (canceled) {\r\n                    return;\r\n                }\r\n\r\n                // Let the caller know that the XMPP login was successful.\r\n                onLoginSuccessful && onLoginSuccessful();\r\n\r\n                // Now authenticate with Jicofo and get a new session ID.\r\n                const room\r\n                    = xmpp.createRoom(this.options.name, this.options.config);\r\n\r\n                room.moderator.authenticate()\r\n                    .then(() => {\r\n                        xmpp && xmpp.disconnect();\r\n\r\n                        if (canceled) {\r\n                            return;\r\n                        }\r\n\r\n                        // At this point we should have the new session ID\r\n                        // stored in the settings. Jicofo will allow to join the\r\n                        // room.\r\n                        this.join(roomPassword);\r\n\r\n                        resolve();\r\n                    })\r\n                    .catch(({ error, message }) => {\r\n                        xmpp.disconnect();\r\n\r\n                        reject({\r\n                            authenticationError: error,\r\n                            message\r\n                        });\r\n                    });\r\n            });\r\n        xmpp.addListener(\r\n            CONNECTION_FAILED,\r\n            (connectionError, message, credentials) => {\r\n                reject({\r\n                    connectionError,\r\n                    credentials,\r\n                    message\r\n                });\r\n                xmpp = undefined;\r\n            });\r\n\r\n        canceled || xmpp.connect(id, password);\r\n    });\r\n\r\n    /**\r\n     * Cancels the process, if it's in progress, of authenticating and upgrading\r\n     * the role of the local participant/user.\r\n     *\r\n     * @public\r\n     * @returns {void}\r\n     */\r\n    process.cancel = () => {\r\n        canceled = true;\r\n        rejectPromise({});\r\n        xmpp && xmpp.disconnect();\r\n    };\r\n\r\n    return process;\r\n}\r\n\r\n/* eslint-enable no-invalid-this */\r\n\n\n\n// WEBPACK FOOTER //\n// ./authenticateAndUpgradeRole.js","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(require('strophe.js')) :\n\ttypeof define === 'function' && define.amd ? define(['strophe.js'], factory) :\n\t(factory(global.window));\n}(this, (function (strophe_js) { 'use strict';\n\nstrophe_js.Strophe.addConnectionPlugin('disco',\n{\n    _connection: null,\n    _identities : [],\n    _features : [],\n    _items : [],\n    /** Function: init\n     * Plugin init\n     *\n     * Parameters:\n     *   (Strophe.Connection) conn - Strophe connection\n     */\n    init: function(conn)\n    {\n    this._connection = conn;\n        this._identities = [];\n        this._features   = [];\n        this._items      = [];\n        // disco info\n        conn.addHandler(this._onDiscoInfo.bind(this), strophe_js.Strophe.NS.DISCO_INFO, 'iq', 'get', null, null);\n        // disco items\n        conn.addHandler(this._onDiscoItems.bind(this), strophe_js.Strophe.NS.DISCO_ITEMS, 'iq', 'get', null, null);\n    },\n    /** Function: addIdentity\n     * See http://xmpp.org/registrar/disco-categories.html\n     * Parameters:\n     *   (String) category - category of identity (like client, automation, etc ...)\n     *   (String) type - type of identity (like pc, web, bot , etc ...)\n     *   (String) name - name of identity in natural language\n     *   (String) lang - lang of name parameter\n     *\n     * Returns:\n     *   Boolean\n     */\n    addIdentity: function(category, type, name, lang)\n    {\n        for (var i=0; i<this._identities.length; i++)\n        {\n            if (this._identities[i].category == category &&\n                this._identities[i].type == type &&\n                this._identities[i].name == name &&\n                this._identities[i].lang == lang)\n            {\n                return false;\n            }\n        }\n        this._identities.push({category: category, type: type, name: name, lang: lang});\n        return true;\n    },\n    /** Function: addFeature\n     *\n     * Parameters:\n     *   (String) var_name - feature name (like jabber:iq:version)\n     *\n     * Returns:\n     *   boolean\n     */\n    addFeature: function(var_name)\n    {\n        for (var i=0; i<this._features.length; i++)\n        {\n             if (this._features[i] == var_name)\n                 return false;\n        }\n        this._features.push(var_name);\n        return true;\n    },\n    /** Function: removeFeature\n     *\n     * Parameters:\n     *   (String) var_name - feature name (like jabber:iq:version)\n     *\n     * Returns:\n     *   boolean\n     */\n    removeFeature: function(var_name)\n    {\n        for (var i=0; i<this._features.length; i++)\n        {\n             if (this._features[i] === var_name){\n                 this._features.splice(i,1);\n                 return true;\n             }\n        }\n        return false;\n    },\n    /** Function: addItem\n     *\n     * Parameters:\n     *   (String) jid\n     *   (String) name\n     *   (String) node\n     *   (Function) call_back\n     *\n     * Returns:\n     *   boolean\n     */\n    addItem: function(jid, name, node, call_back)\n    {\n        if (node && !call_back)\n            return false;\n        this._items.push({jid: jid, name: name, node: node, call_back: call_back});\n        return true;\n    },\n    /** Function: info\n     * Info query\n     *\n     * Parameters:\n     *   (Function) call_back\n     *   (String) jid\n     *   (String) node\n     */\n    info: function(jid, node, success, error, timeout)\n    {\n        var attrs = {xmlns: strophe_js.Strophe.NS.DISCO_INFO};\n        if (node)\n            attrs.node = node;\n\n        var info = strophe_js.$iq({from:this._connection.jid,\n                         to:jid, type:'get'}).c('query', attrs);\n        this._connection.sendIQ(info, success, error, timeout);\n    },\n    /** Function: items\n     * Items query\n     *\n     * Parameters:\n     *   (Function) call_back\n     *   (String) jid\n     *   (String) node\n     */\n    items: function(jid, node, success, error, timeout)\n    {\n        var attrs = {xmlns: strophe_js.Strophe.NS.DISCO_ITEMS};\n        if (node)\n            attrs.node = node;\n\n        var items = strophe_js.$iq({from:this._connection.jid,\n                         to:jid, type:'get'}).c('query', attrs);\n        this._connection.sendIQ(items, success, error, timeout);\n    },\n\n    /** PrivateFunction: _buildIQResult\n     */\n    _buildIQResult: function(stanza, query_attrs)\n    {\n        var id   =  stanza.getAttribute('id');\n        var from = stanza.getAttribute('from');\n        var iqresult = strophe_js.$iq({type: 'result', id: id});\n\n        if (from !== null) {\n            iqresult.attrs({to: from});\n        }\n\n        return iqresult.c('query', query_attrs);\n    },\n\n    /** PrivateFunction: _onDiscoInfo\n     * Called when receive info request\n     */\n    _onDiscoInfo: function(stanza)\n    {\n        var node = stanza.getElementsByTagName('query')[0].getAttribute('node');\n        var attrs = {xmlns: strophe_js.Strophe.NS.DISCO_INFO};\n        var i;\n        if (node)\n        {\n            attrs.node = node;\n        }\n        var iqresult = this._buildIQResult(stanza, attrs);\n        for (i=0; i<this._identities.length; i++)\n        {\n            attrs = {category: this._identities[i].category,\n                         type    : this._identities[i].type};\n            if (this._identities[i].name)\n                attrs.name = this._identities[i].name;\n            if (this._identities[i].lang)\n                attrs['xml:lang'] = this._identities[i].lang;\n            iqresult.c('identity', attrs).up();\n        }\n        for (i=0; i<this._features.length; i++)\n        {\n            iqresult.c('feature', {'var':this._features[i]}).up();\n        }\n        this._connection.send(iqresult.tree());\n        return true;\n    },\n    /** PrivateFunction: _onDiscoItems\n     * Called when receive items request\n     */\n    _onDiscoItems: function(stanza)\n    {\n        var query_attrs = {xmlns: strophe_js.Strophe.NS.DISCO_ITEMS};\n        var node = stanza.getElementsByTagName('query')[0].getAttribute('node');\n        var items, i;\n        if (node)\n        {\n            query_attrs.node = node;\n            items = [];\n            for (i = 0; i < this._items.length; i++)\n            {\n                if (this._items[i].node == node)\n                {\n                    items = this._items[i].call_back(stanza);\n                    break;\n                }\n            }\n        }\n        else\n        {\n            items = this._items;\n        }\n        var iqresult = this._buildIQResult(stanza, query_attrs);\n        for (i = 0; i < items.length; i++)\n        {\n            var attrs = {jid:  items[i].jid};\n            if (items[i].name)\n                attrs.name = items[i].name;\n            if (items[i].node)\n                attrs.node = items[i].node;\n            iqresult.c('item', attrs).up();\n        }\n        this._connection.send(iqresult.tree());\n        return true;\n    }\n});\n\n})));\n//# sourceMappingURL=strophe.disco.js.map\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/strophejs-plugin-disco/lib/strophe.disco.js","/* global $ */\r\n\r\nimport { getLogger } from 'jitsi-meet-logger';\r\nimport { Strophe } from 'strophe.js';\r\n\r\nimport ChatRoom from './ChatRoom';\r\nimport { ConnectionPluginListenable } from './ConnectionPlugin';\r\nimport XMPPEvents from '../../service/xmpp/XMPPEvents';\r\n\r\nconst logger = getLogger(__filename);\r\n\r\n/**\r\n * MUC connection plugin.\r\n */\r\nclass MucConnectionPlugin extends ConnectionPluginListenable {\r\n    /**\r\n     *\r\n     * @param xmpp\r\n     */\r\n    constructor(xmpp) {\r\n        super();\r\n        this.xmpp = xmpp;\r\n        this.rooms = {};\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param connection\r\n     */\r\n    init(connection) {\r\n        super.init(connection);\r\n\r\n        // add handlers (just once)\r\n        this.connection.addHandler(this.onPresence.bind(this), null,\r\n            'presence', null, null, null, null);\r\n        this.connection.addHandler(this.onPresenceUnavailable.bind(this),\r\n            null, 'presence', 'unavailable', null);\r\n        this.connection.addHandler(this.onPresenceError.bind(this), null,\r\n            'presence', 'error', null);\r\n        this.connection.addHandler(this.onMessage.bind(this), null,\r\n            'message', null, null);\r\n        this.connection.addHandler(this.onMute.bind(this),\r\n            'http://jitsi.org/jitmeet/audio', 'iq', 'set', null, null);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param jid\r\n     * @param password\r\n     * @param options\r\n     */\r\n    createRoom(jid, password, options) {\r\n        const roomJid = Strophe.getBareJidFromJid(jid);\r\n\r\n        if (this.rooms[roomJid]) {\r\n            const errmsg = 'You are already in the room!';\r\n\r\n            logger.error(errmsg);\r\n            throw new Error(errmsg);\r\n        }\r\n        this.rooms[roomJid] = new ChatRoom(this.connection, jid,\r\n            password, this.xmpp, options);\r\n        this.eventEmitter.emit(\r\n            XMPPEvents.EMUC_ROOM_ADDED, this.rooms[roomJid]);\r\n\r\n        return this.rooms[roomJid];\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param jid\r\n     */\r\n    doLeave(jid) {\r\n        this.eventEmitter.emit(\r\n            XMPPEvents.EMUC_ROOM_REMOVED, this.rooms[jid]);\r\n        delete this.rooms[jid];\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param pres\r\n     */\r\n    onPresence(pres) {\r\n        const from = pres.getAttribute('from');\r\n\r\n        // What is this for? A workaround for something?\r\n        if (pres.getAttribute('type')) {\r\n            return true;\r\n        }\r\n\r\n        const room = this.rooms[Strophe.getBareJidFromJid(from)];\r\n\r\n        if (!room) {\r\n            return;\r\n        }\r\n\r\n        // Parse status.\r\n        if ($(pres).find('>x[xmlns=\"http://jabber.org/protocol/muc#user\"]'\r\n            + '>status[code=\"201\"]').length) {\r\n            room.createNonAnonymousRoom();\r\n        }\r\n\r\n        room.onPresence(pres);\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param pres\r\n     */\r\n    onPresenceUnavailable(pres) {\r\n        const from = pres.getAttribute('from');\r\n        const room = this.rooms[Strophe.getBareJidFromJid(from)];\r\n\r\n        if (!room) {\r\n            return;\r\n        }\r\n\r\n        room.onPresenceUnavailable(pres, from);\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param pres\r\n     */\r\n    onPresenceError(pres) {\r\n        const from = pres.getAttribute('from');\r\n        const room = this.rooms[Strophe.getBareJidFromJid(from)];\r\n\r\n        if (!room) {\r\n            return;\r\n        }\r\n\r\n        room.onPresenceError(pres, from);\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param msg\r\n     */\r\n    onMessage(msg) {\r\n        // FIXME: this is a hack. but jingle on muc makes nickchanges hard\r\n        const from = msg.getAttribute('from');\r\n        const room = this.rooms[Strophe.getBareJidFromJid(from)];\r\n\r\n        if (!room) {\r\n            return;\r\n        }\r\n\r\n        room.onMessage(msg, from);\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * TODO: Document\r\n     * @param iq\r\n     */\r\n    onMute(iq) {\r\n        const from = iq.getAttribute('from');\r\n        const room = this.rooms[Strophe.getBareJidFromJid(from)];\r\n\r\n        // XXX What are the semantics of the return value? Why is it sometimes\r\n        // undefined and sometimes a boolean?\r\n        if (!room) {\r\n            return;\r\n        }\r\n\r\n        room.onMute(iq);\r\n\r\n        return true;\r\n    }\r\n}\r\n\r\n/**\r\n *\r\n * @param XMPP\r\n */\r\nexport default function(XMPP) {\r\n    Strophe.addConnectionPlugin('emuc', new MucConnectionPlugin(XMPP));\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/xmpp/strophe.emuc.js","/* global $, __filename */\r\n\r\nimport { getLogger } from 'jitsi-meet-logger';\r\nimport { $iq, $msg, $pres, Strophe } from 'strophe.js';\r\n\r\nimport GlobalOnErrorHandler from '../util/GlobalOnErrorHandler';\r\nimport * as JitsiTranscriptionStatus from '../../JitsiTranscriptionStatus';\r\nimport Listenable from '../util/Listenable';\r\nimport Settings from '../settings/Settings';\r\nimport * as MediaType from '../../service/RTC/MediaType';\r\nimport XMPPEvents from '../../service/xmpp/XMPPEvents';\r\n\r\nimport Moderator from './moderator';\r\nimport Recorder from './recording';\r\n\r\nconst logger = getLogger(__filename);\r\n\r\nconst parser = {\r\n    packet2JSON(packet, nodes) {\r\n        const self = this;\r\n\r\n        // eslint-disable-next-line newline-per-chained-call\r\n        $(packet).children().each(function() {\r\n            // eslint-disable-next-line no-invalid-this\r\n            const tagName = $(this).prop('tagName');\r\n            const node = {\r\n                tagName\r\n            };\r\n\r\n            node.attributes = {};\r\n\r\n            // eslint-disable-next-line no-invalid-this\r\n            $($(this)[0].attributes).each((index, attr) => {\r\n                node.attributes[attr.name] = attr.value;\r\n            });\r\n\r\n            // eslint-disable-next-line no-invalid-this\r\n            const text = Strophe.getText($(this)[0]);\r\n\r\n            if (text) {\r\n                node.value = text;\r\n            }\r\n            node.children = [];\r\n            nodes.push(node);\r\n\r\n            // eslint-disable-next-line no-invalid-this\r\n            self.packet2JSON($(this), node.children);\r\n        });\r\n    },\r\n    json2packet(nodes, packet) {\r\n        for (let i = 0; i < nodes.length; i++) {\r\n            const node = nodes[i];\r\n\r\n            if (node) {\r\n                packet.c(node.tagName, node.attributes);\r\n                if (node.value) {\r\n                    packet.t(node.value);\r\n                }\r\n                if (node.children) {\r\n                    this.json2packet(node.children, packet);\r\n                }\r\n                packet.up();\r\n            }\r\n        }\r\n\r\n        // packet.up();\r\n    }\r\n};\r\n\r\n/**\r\n * Returns array of JS objects from the presence JSON associated with the passed\r\n / nodeName\r\n * @param pres the presence JSON\r\n * @param nodeName the name of the node (videomuted, audiomuted, etc)\r\n */\r\nfunction filterNodeFromPresenceJSON(pres, nodeName) {\r\n    const res = [];\r\n\r\n    for (let i = 0; i < pres.length; i++) {\r\n        if (pres[i].tagName === nodeName) {\r\n            res.push(pres[i]);\r\n        }\r\n    }\r\n\r\n    return res;\r\n}\r\n\r\n/**\r\n * Constants used to verify if a given JSON message via the MUC should be\r\n * considered as a ENDPOINT_MESSAGE\r\n */\r\nconst VALID_FIELD_NAMES = [ 'jitsi-meet-muc-msg-topic', 'payload' ];\r\n\r\n/**\r\n * Check if the given argument is a valid JSON ENDPOINT_MESSAGE string by\r\n * parsing it and checking if it has a field called 'jitsi-meet-muc-msg-topic'\r\n * and a field called 'payload'\r\n *\r\n * @param {string} jsonString check if this string is a valid json string\r\n * and contains the special structure\r\n * @returns {boolean, object} if given object is a valid JSON string, return\r\n * the json object. Otherwise, return false;\r\n */\r\nfunction tryParseJSONAndVerify(jsonString) {\r\n    try {\r\n        const json = JSON.parse(jsonString);\r\n\r\n        // Handle non-exception-throwing cases:\r\n        // Neither JSON.parse(false) or JSON.parse(1234) throw errors,\r\n        // hence the type-checking,\r\n        // but... JSON.parse(null) returns null, and\r\n        // typeof null === \"object\",\r\n        // so we must check for that, too.\r\n        // Thankfully, null is falsey, so this suffices:\r\n        if (json && typeof json === 'object') {\r\n            const topic = json[VALID_FIELD_NAMES[0]];\r\n            const payload = json[VALID_FIELD_NAMES[1]];\r\n\r\n            if ((typeof topic === 'string' || topic instanceof String)\r\n                && payload) {\r\n\r\n                return json;\r\n            }\r\n\r\n            logger.debug('parsing valid json but does not have correct '\r\n                + 'structure', 'topic: ', topic, 'payload: ', payload);\r\n        }\r\n    } catch (e) {\r\n\r\n        return false;\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\n// XXX As ChatRoom constructs XMPP stanzas and Strophe is build around the idea\r\n// of chaining function calls, allow long function call chains.\r\n/* eslint-disable newline-per-chained-call */\r\n\r\n/**\r\n *\r\n */\r\nexport default class ChatRoom extends Listenable {\r\n\r\n    /* eslint-disable max-params */\r\n\r\n    /**\r\n     *\r\n     * @param connection\r\n     * @param jid\r\n     * @param password\r\n     * @param XMPP\r\n     * @param options\r\n     */\r\n    constructor(connection, jid, password, XMPP, options) {\r\n        super();\r\n        this.xmpp = XMPP;\r\n        this.connection = connection;\r\n        this.roomjid = Strophe.getBareJidFromJid(jid);\r\n        this.myroomjid = jid;\r\n        this.password = password;\r\n        logger.info(`Joined MUC as ${this.myroomjid}`);\r\n        this.members = {};\r\n        this.presMap = {};\r\n        this.presHandlers = {};\r\n        this.joined = false;\r\n        this.role = null;\r\n        this.focusMucJid = null;\r\n        this.noBridgeAvailable = false;\r\n        this.options = options || {};\r\n        this.moderator\r\n            = new Moderator(this.roomjid, this.xmpp, this.eventEmitter, {\r\n                connection: this.xmpp.options,\r\n                conference: this.options\r\n            });\r\n        this.initPresenceMap(options);\r\n        this.lastPresences = {};\r\n        this.phoneNumber = null;\r\n        this.phonePin = null;\r\n        this.connectionTimes = {};\r\n        this.participantPropertyListener = null;\r\n\r\n        this.locked = false;\r\n        this.transcriptionStatus = JitsiTranscriptionStatus.OFF;\r\n    }\r\n\r\n    /* eslint-enable max-params */\r\n\r\n    /**\r\n     *\r\n     */\r\n    initPresenceMap(options = {}) {\r\n        this.presMap.to = this.myroomjid;\r\n        this.presMap.xns = 'http://jabber.org/protocol/muc';\r\n        this.presMap.nodes = [];\r\n        this.presMap.nodes.push({\r\n            'tagName': 'user-agent',\r\n            'value': navigator.userAgent,\r\n            'attributes': { xmlns: 'http://jitsi.org/jitmeet/user-agent' }\r\n        });\r\n\r\n        if (options.enableStatsID) {\r\n            this.presMap.nodes.push({\r\n                'tagName': 'stats-id',\r\n                'value': Settings.callStatsUserName\r\n            });\r\n        }\r\n\r\n        // We need to broadcast 'videomuted' status from the beginning, cause\r\n        // Jicofo makes decisions based on that. Initialize it with 'false'\r\n        // here.\r\n        this.addVideoInfoToPresence(false);\r\n\r\n        if (options.deploymentInfo && options.deploymentInfo.userRegion) {\r\n            this.presMap.nodes.push({\r\n                'tagName': 'region',\r\n                'attributes': {\r\n                    id: options.deploymentInfo.userRegion,\r\n                    xmlns: 'http://jitsi.org/jitsi-meet'\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param devices\r\n     */\r\n    updateDeviceAvailability(devices) {\r\n        this.presMap.nodes.push({\r\n            'tagName': 'devices',\r\n            'children': [\r\n                {\r\n                    'tagName': 'audio',\r\n                    'value': devices.audio\r\n                },\r\n                {\r\n                    'tagName': 'video',\r\n                    'value': devices.video\r\n                }\r\n            ]\r\n        });\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param password\r\n     */\r\n    join(password) {\r\n        this.password = password;\r\n        this.moderator.allocateConferenceFocus(() => this.sendPresence(true));\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param fromJoin\r\n     */\r\n    sendPresence(fromJoin) {\r\n        const to = this.presMap.to;\r\n\r\n        if (!to || (!this.joined && !fromJoin)) {\r\n            // Too early to send presence - not initialized\r\n            return;\r\n        }\r\n\r\n        const pres = $pres({ to });\r\n\r\n        // xep-0045 defines: \"including in the initial presence stanza an empty\r\n        // <x/> element qualified by the 'http://jabber.org/protocol/muc'\r\n        // namespace\" and subsequent presences should not include that or it can\r\n        // be considered as joining, and server can send us the message history\r\n        // for the room on every presence\r\n        if (fromJoin) {\r\n            pres.c('x', { xmlns: this.presMap.xns });\r\n\r\n            if (this.password) {\r\n                pres.c('password').t(this.password).up();\r\n            }\r\n            pres.up();\r\n        }\r\n\r\n        parser.json2packet(this.presMap.nodes, pres);\r\n        this.connection.send(pres);\r\n        if (fromJoin) {\r\n            // XXX We're pressed for time here because we're beginning a complex\r\n            // and/or lengthy conference-establishment process which supposedly\r\n            // involves multiple RTTs. We don't have the time to wait for\r\n            // Strophe to decide to send our IQ.\r\n            this.connection.flush();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Sends the presence unavailable, signaling the server\r\n     * we want to leave the room.\r\n     */\r\n    doLeave() {\r\n        logger.log('do leave', this.myroomjid);\r\n        const pres = $pres({ to: this.myroomjid,\r\n            type: 'unavailable' });\r\n\r\n        this.presMap.length = 0;\r\n\r\n        // XXX Strophe is asynchronously sending by default. Unfortunately, that\r\n        // means that there may not be enough time to send the unavailable\r\n        // presence. Switching Strophe to synchronous sending is not much of an\r\n        // option because it may lead to a noticeable delay in navigating away\r\n        // from the current location. As a compromise, we will try to increase\r\n        // the chances of sending the unavailable presence within the short time\r\n        // span that we have upon unloading by invoking flush() on the\r\n        // connection. We flush() once before sending/queuing the unavailable\r\n        // presence in order to attemtp to have the unavailable presence at the\r\n        // top of the send queue. We flush() once more after sending/queuing the\r\n        // unavailable presence in order to attempt to have it sent as soon as\r\n        // possible.\r\n        this.connection.flush();\r\n        this.connection.send(pres);\r\n        this.connection.flush();\r\n    }\r\n\r\n    /**\r\n     *\r\n     */\r\n    discoRoomInfo() {\r\n        // https://xmpp.org/extensions/xep-0045.html#disco-roominfo\r\n\r\n        const getInfo\r\n            = $iq({\r\n                type: 'get',\r\n                to: this.roomjid\r\n            })\r\n                .c('query', { xmlns: Strophe.NS.DISCO_INFO });\r\n\r\n        this.connection.sendIQ(getInfo, result => {\r\n            const locked\r\n                = $(result).find('>query>feature[var=\"muc_passwordprotected\"]')\r\n                    .length\r\n                    === 1;\r\n\r\n            if (locked !== this.locked) {\r\n                this.eventEmitter.emit(XMPPEvents.MUC_LOCK_CHANGED, locked);\r\n                this.locked = locked;\r\n            }\r\n        }, error => {\r\n            GlobalOnErrorHandler.callErrorHandler(error);\r\n            logger.error('Error getting room info: ', error);\r\n        });\r\n    }\r\n\r\n    /**\r\n     *\r\n     */\r\n    createNonAnonymousRoom() {\r\n        // http://xmpp.org/extensions/xep-0045.html#createroom-reserved\r\n\r\n        const getForm = $iq({ type: 'get',\r\n            to: this.roomjid })\r\n            .c('query', { xmlns: 'http://jabber.org/protocol/muc#owner' })\r\n            .c('x', { xmlns: 'jabber:x:data',\r\n                type: 'submit' });\r\n\r\n        const self = this;\r\n\r\n        this.connection.sendIQ(getForm, form => {\r\n            if (!$(form).find(\r\n                    '>query>x[xmlns=\"jabber:x:data\"]'\r\n                    + '>field[var=\"muc#roomconfig_whois\"]').length) {\r\n                const errmsg = 'non-anonymous rooms not supported';\r\n\r\n                GlobalOnErrorHandler.callErrorHandler(new Error(errmsg));\r\n                logger.error(errmsg);\r\n\r\n                return;\r\n            }\r\n\r\n            const formSubmit = $iq({ to: self.roomjid,\r\n                type: 'set' })\r\n                .c('query', { xmlns: 'http://jabber.org/protocol/muc#owner' });\r\n\r\n            formSubmit.c('x', { xmlns: 'jabber:x:data',\r\n                type: 'submit' });\r\n\r\n            formSubmit.c('field', { 'var': 'FORM_TYPE' })\r\n                .c('value')\r\n                .t('http://jabber.org/protocol/muc#roomconfig').up().up();\r\n\r\n            formSubmit.c('field', { 'var': 'muc#roomconfig_whois' })\r\n                .c('value').t('anyone').up().up();\r\n\r\n            self.connection.sendIQ(formSubmit);\r\n\r\n        }, error => {\r\n            GlobalOnErrorHandler.callErrorHandler(error);\r\n            logger.error('Error getting room configuration form: ', error);\r\n        });\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param pres\r\n     */\r\n    onPresence(pres) {\r\n        const from = pres.getAttribute('from');\r\n\r\n        // Parse roles.\r\n        const member = {};\r\n\r\n        member.show = $(pres).find('>show').text();\r\n        const $statusNode = $(pres).find('>status');\r\n        const hasStatus = $statusNode.length;\r\n\r\n        if (hasStatus) {\r\n            member.status = $statusNode.text();\r\n        }\r\n        let hasStatusUpdate = false;\r\n\r\n        const mucUserItem\r\n            = $(pres).find(\r\n                '>x[xmlns=\"http://jabber.org/protocol/muc#user\"]>item');\r\n\r\n        member.affiliation = mucUserItem.attr('affiliation');\r\n        member.role = mucUserItem.attr('role');\r\n\r\n        // Focus recognition\r\n        const jid = mucUserItem.attr('jid');\r\n\r\n        member.jid = jid;\r\n        member.isFocus\r\n            = jid && jid.indexOf(`${this.moderator.getFocusUserJid()}/`) === 0;\r\n        member.isHiddenDomain\r\n            = jid && jid.indexOf('@') > 0\r\n                && this.options.hiddenDomain\r\n                    === jid.substring(jid.indexOf('@') + 1, jid.indexOf('/'));\r\n\r\n        $(pres).find('>x').remove();\r\n        const nodes = [];\r\n\r\n        parser.packet2JSON(pres, nodes);\r\n        this.lastPresences[from] = nodes;\r\n        let jibri = null;\r\n\r\n        // process nodes to extract data needed for MUC_JOINED and\r\n        // MUC_MEMBER_JOINED events\r\n\r\n        for (let i = 0; i < nodes.length; i++) {\r\n            const node = nodes[i];\r\n\r\n            switch (node.tagName) {\r\n            case 'nick':\r\n                member.nick = node.value;\r\n                break;\r\n            case 'userId':\r\n                member.id = node.value;\r\n                break;\r\n            case 'stats-id':\r\n                member.statsID = node.value;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (from === this.myroomjid) {\r\n            const newRole\r\n                = member.affiliation === 'owner' ? member.role : 'none';\r\n\r\n            if (this.role !== newRole) {\r\n                this.role = newRole;\r\n                this.eventEmitter.emit(\r\n                    XMPPEvents.LOCAL_ROLE_CHANGED,\r\n                    this.role);\r\n            }\r\n            if (!this.joined) {\r\n                this.joined = true;\r\n                const now = this.connectionTimes['muc.joined']\r\n                    = window.performance.now();\r\n\r\n                logger.log('(TIME) MUC joined:\\t', now);\r\n\r\n                // set correct initial state of locked\r\n                if (this.password) {\r\n                    this.locked = true;\r\n                }\r\n\r\n                this.eventEmitter.emit(XMPPEvents.MUC_JOINED);\r\n            }\r\n        } else if (this.members[from] === undefined) {\r\n            // new participant\r\n            this.members[from] = member;\r\n            logger.log('entered', from, member);\r\n            hasStatusUpdate = member.status !== undefined;\r\n            if (member.isFocus) {\r\n                this._initFocus(from, jid);\r\n            } else {\r\n                this.eventEmitter.emit(\r\n                    XMPPEvents.MUC_MEMBER_JOINED,\r\n                    from,\r\n                    member.nick,\r\n                    member.role,\r\n                    member.isHiddenDomain,\r\n                    member.statsID,\r\n                    member.status);\r\n\r\n                // we are reporting the status with the join\r\n                // so we do not want a second event about status update\r\n                hasStatusUpdate = false;\r\n            }\r\n        } else {\r\n            // Presence update for existing participant\r\n            // Watch role change:\r\n            const memberOfThis = this.members[from];\r\n\r\n            if (memberOfThis.role !== member.role) {\r\n                memberOfThis.role = member.role;\r\n                this.eventEmitter.emit(\r\n                    XMPPEvents.MUC_ROLE_CHANGED, from, member.role);\r\n            }\r\n\r\n            if (member.isFocus) {\r\n                // From time to time first few presences of the focus are not\r\n                // containing it's jid. That way we can mark later the focus\r\n                // member instead of not marking it at all and not starting the\r\n                // conference.\r\n                // FIXME: Maybe there is a better way to handle this issue. It\r\n                // seems there is some period of time in prosody that the\r\n                // configuration form is received but not applied. And if any\r\n                // participant joins during that period of time the first\r\n                // presence from the focus won't conain <item jid=\"focus...\" />.\r\n                memberOfThis.isFocus = true;\r\n                this._initFocus(from, jid);\r\n            }\r\n\r\n            // store the new display name\r\n            if (member.displayName) {\r\n                memberOfThis.displayName = member.displayName;\r\n            }\r\n\r\n            // update stored status message to be able to detect changes\r\n            if (memberOfThis.status !== member.status) {\r\n                hasStatusUpdate = true;\r\n                memberOfThis.status = member.status;\r\n            }\r\n        }\r\n\r\n        // after we had fired member or room joined events, lets fire events\r\n        // for the rest info we got in presence\r\n        for (let i = 0; i < nodes.length; i++) {\r\n            const node = nodes[i];\r\n\r\n            switch (node.tagName) {\r\n            case 'nick':\r\n                if (!member.isFocus) {\r\n                    const displayName\r\n                        = this.xmpp.options.displayJids\r\n                            ? Strophe.getResourceFromJid(from)\r\n                            : member.nick;\r\n\r\n                    if (displayName && displayName.length > 0) {\r\n                        this.eventEmitter.emit(\r\n                            XMPPEvents.DISPLAY_NAME_CHANGED,\r\n                            from,\r\n                            displayName);\r\n                    }\r\n                }\r\n                break;\r\n            case 'bridgeNotAvailable':\r\n                if (member.isFocus && !this.noBridgeAvailable) {\r\n                    this.noBridgeAvailable = true;\r\n                    this.eventEmitter.emit(XMPPEvents.BRIDGE_DOWN);\r\n                }\r\n                break;\r\n            case 'jibri-recording-status':\r\n                jibri = node;\r\n                break;\r\n            case 'transcription-status': {\r\n                const { attributes } = node;\r\n\r\n                if (!attributes) {\r\n                    break;\r\n                }\r\n\r\n                const { status } = attributes;\r\n\r\n                if (status && status !== this.transcriptionStatus) {\r\n                    this.transcriptionStatus = status;\r\n                    this.eventEmitter.emit(\r\n                        XMPPEvents.TRANSCRIPTION_STATUS_CHANGED,\r\n                        status\r\n                    );\r\n                }\r\n\r\n\r\n                break;\r\n            }\r\n            case 'call-control': {\r\n                const att = node.attributes;\r\n\r\n                if (!att) {\r\n                    break;\r\n                }\r\n                this.phoneNumber = att.phone || null;\r\n                this.phonePin = att.pin || null;\r\n                this.eventEmitter.emit(XMPPEvents.PHONE_NUMBER_CHANGED);\r\n                break;\r\n            }\r\n            default:\r\n                this.processNode(node, from);\r\n            }\r\n        }\r\n\r\n        // Trigger status message update if necessary\r\n        if (hasStatusUpdate) {\r\n            this.eventEmitter.emit(\r\n                XMPPEvents.PRESENCE_STATUS,\r\n                from,\r\n                member.status);\r\n        }\r\n\r\n        if (jibri) {\r\n            this.lastJibri = jibri;\r\n            if (this.recording) {\r\n                this.recording.handleJibriPresence(jibri);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Initialize some properties when the focus participant is verified.\r\n     * @param from jid of the focus\r\n     * @param mucJid the jid of the focus in the muc\r\n     */\r\n    _initFocus(from, mucJid) {\r\n        this.focusMucJid = from;\r\n        if (!this.recording) {\r\n            this.recording = new Recorder(this.options.recordingType,\r\n                this.eventEmitter, this.connection, this.focusMucJid,\r\n                this.options.jirecon, this.roomjid);\r\n            if (this.lastJibri) {\r\n                this.recording.handleJibriPresence(this.lastJibri);\r\n            }\r\n        }\r\n        logger.info(`Ignore focus: ${from}, real JID: ${mucJid}`);\r\n    }\r\n\r\n    /**\r\n     * Sets the special listener to be used for \"command\"s whose name starts\r\n     * with \"jitsi_participant_\".\r\n     */\r\n    setParticipantPropertyListener(listener) {\r\n        this.participantPropertyListener = listener;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param node\r\n     * @param from\r\n     */\r\n    processNode(node, from) {\r\n        // make sure we catch all errors coming from any handler\r\n        // otherwise we can remove the presence handler from strophe\r\n        try {\r\n            let tagHandlers = this.presHandlers[node.tagName];\r\n\r\n            if (node.tagName.startsWith('jitsi_participant_')) {\r\n                tagHandlers = [ this.participantPropertyListener ];\r\n            }\r\n\r\n            if (tagHandlers) {\r\n                tagHandlers.forEach(handler => {\r\n                    handler(node, Strophe.getResourceFromJid(from), from);\r\n                });\r\n            }\r\n        } catch (e) {\r\n            GlobalOnErrorHandler.callErrorHandler(e);\r\n            logger.error(`Error processing:${node.tagName} node.`, e);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Send text message to the other participants in the conference\r\n     * @param body\r\n     * @param nickname\r\n     */\r\n    sendMessage(body, nickname) {\r\n        const msg = $msg({ to: this.roomjid,\r\n            type: 'groupchat' });\r\n\r\n        msg.c('body', body).up();\r\n        if (nickname) {\r\n            msg.c('nick', { xmlns: 'http://jabber.org/protocol/nick' })\r\n                .t(nickname)\r\n                .up()\r\n                .up();\r\n        }\r\n        this.connection.send(msg);\r\n        this.eventEmitter.emit(XMPPEvents.SENDING_CHAT_MESSAGE, body);\r\n    }\r\n\r\n    /**\r\n     * Send private text message to another participant of the conference\r\n     * @param id id/muc resource of the receiver\r\n     * @param body\r\n     * @param nickname\r\n     */\r\n    sendPrivateMessage(id, body, nickname) {\r\n        const msg = $msg({ to: `${this.roomjid}/${id}`,\r\n            type: 'chat' });\r\n\r\n        msg.c('body', body).up();\r\n        if (nickname) {\r\n            msg.c('nick', { xmlns: 'http://jabber.org/protocol/nick' })\r\n                .t(nickname)\r\n                .up()\r\n                .up();\r\n        }\r\n\r\n        this.connection.send(msg);\r\n        this.eventEmitter.emit(XMPPEvents.SENDING_PRIVATE_CHAT_MESSAGE, body);\r\n    }\r\n\r\n\r\n    /**\r\n     *\r\n     * @param subject\r\n     */\r\n    setSubject(subject) {\r\n        const msg = $msg({ to: this.roomjid,\r\n            type: 'groupchat' });\r\n\r\n        msg.c('subject', subject);\r\n        this.connection.send(msg);\r\n    }\r\n\r\n    /**\r\n     * Called when participant leaves.\r\n     * @param jid the jid of the participant that leaves\r\n     * @param skipEvents optional params to skip any events, including check\r\n     * whether this is the focus that left\r\n     */\r\n    onParticipantLeft(jid, skipEvents) {\r\n\r\n        delete this.lastPresences[jid];\r\n\r\n        if (skipEvents) {\r\n            return;\r\n        }\r\n\r\n        this.eventEmitter.emit(XMPPEvents.MUC_MEMBER_LEFT, jid);\r\n\r\n        this.moderator.onMucMemberLeft(jid);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param pres\r\n     * @param from\r\n     */\r\n    onPresenceUnavailable(pres, from) {\r\n        // ignore presence\r\n        if ($(pres).find('>ignore[xmlns=\"http://jitsi.org/jitmeet/\"]').length) {\r\n            return true;\r\n        }\r\n\r\n        // room destroyed ?\r\n        if ($(pres).find('>x[xmlns=\"http://jabber.org/protocol/muc#user\"]'\r\n            + '>destroy').length) {\r\n            let reason;\r\n            const reasonSelect\r\n                = $(pres).find(\r\n                    '>x[xmlns=\"http://jabber.org/protocol/muc#user\"]'\r\n                        + '>destroy>reason');\r\n\r\n            if (reasonSelect.length) {\r\n                reason = reasonSelect.text();\r\n            }\r\n\r\n            this.eventEmitter.emit(XMPPEvents.MUC_DESTROYED, reason);\r\n            this.connection.emuc.doLeave(this.roomjid);\r\n\r\n            return true;\r\n        }\r\n\r\n        // Status code 110 indicates that this notification is \"self-presence\".\r\n        const isSelfPresence\r\n            = $(pres)\r\n                .find(\r\n                    '>x[xmlns=\"http://jabber.org/protocol/muc#user\"]>'\r\n                        + 'status[code=\"110\"]')\r\n                .length;\r\n        const isKick\r\n            = $(pres)\r\n                .find(\r\n                    '>x[xmlns=\"http://jabber.org/protocol/muc#user\"]'\r\n                        + '>status[code=\"307\"]')\r\n                .length;\r\n        const membersKeys = Object.keys(this.members);\r\n\r\n        if (!isSelfPresence) {\r\n            delete this.members[from];\r\n            this.onParticipantLeft(from, false);\r\n        } else if (membersKeys.length > 0) {\r\n            // If the status code is 110 this means we're leaving and we would\r\n            // like to remove everyone else from our view, so we trigger the\r\n            // event.\r\n            membersKeys.forEach(jid => {\r\n                const member = this.members[jid];\r\n\r\n                delete this.members[jid];\r\n                this.onParticipantLeft(jid, member.isFocus);\r\n            });\r\n            this.connection.emuc.doLeave(this.roomjid);\r\n\r\n            // we fire muc_left only if this is not a kick,\r\n            // kick has both statuses 110 and 307.\r\n            if (!isKick) {\r\n                this.eventEmitter.emit(XMPPEvents.MUC_LEFT);\r\n            }\r\n        }\r\n\r\n        if (isKick && this.myroomjid === from) {\r\n            this.eventEmitter.emit(XMPPEvents.KICKED);\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param msg\r\n     * @param from\r\n     */\r\n    onMessage(msg, from) {\r\n        const nick\r\n            = $(msg).find('>nick[xmlns=\"http://jabber.org/protocol/nick\"]')\r\n                .text()\r\n            || Strophe.getResourceFromJid(from);\r\n\r\n        const txt = $(msg).find('>body').text();\r\n        const type = msg.getAttribute('type');\r\n\r\n        if (type === 'error') {\r\n            this.eventEmitter.emit(XMPPEvents.CHAT_ERROR_RECEIVED,\r\n                $(msg).find('>text').text(), txt);\r\n\r\n            return true;\r\n        }\r\n\r\n        const subject = $(msg).find('>subject');\r\n\r\n        if (subject.length) {\r\n            const subjectText = subject.text();\r\n\r\n            if (subjectText || subjectText === '') {\r\n                this.eventEmitter.emit(XMPPEvents.SUBJECT_CHANGED, subjectText);\r\n                logger.log(`Subject is changed to ${subjectText}`);\r\n            }\r\n        }\r\n\r\n        // xep-0203 delay\r\n        let stamp = $(msg).find('>delay').attr('stamp');\r\n\r\n        if (!stamp) {\r\n            // or xep-0091 delay, UTC timestamp\r\n            stamp = $(msg).find('>[xmlns=\"jabber:x:delay\"]').attr('stamp');\r\n\r\n            if (stamp) {\r\n                // the format is CCYYMMDDThh:mm:ss\r\n                const dateParts\r\n                    = stamp.match(/(\\d{4})(\\d{2})(\\d{2}T\\d{2}:\\d{2}:\\d{2})/);\r\n\r\n                stamp = `${dateParts[1]}-${dateParts[2]}-${dateParts[3]}Z`;\r\n            }\r\n        }\r\n\r\n        if (from === this.roomjid\r\n                && $(msg)\r\n                    .find(\r\n                        '>x[xmlns=\"http://jabber.org/protocol/muc#user\"]'\r\n                            + '>status[code=\"104\"]')\r\n                    .length) {\r\n            this.discoRoomInfo();\r\n        }\r\n\r\n        const json = tryParseJSONAndVerify(txt);\r\n\r\n        if (json) {\r\n            this.eventEmitter.emit(XMPPEvents.JSON_MESSAGE_RECEIVED,\r\n                from, json);\r\n\r\n            return;\r\n        }\r\n\r\n        if (txt) {\r\n            if (type === 'chat') {\r\n                logger.log('privatechat', nick, txt);\r\n                this.eventEmitter.emit(XMPPEvents.PRIVATE_MESSAGE_RECEIVED,\r\n                        from, nick, txt, this.myroomjid, stamp);\r\n            }\r\n            if (type === 'groupchat') {\r\n                logger.log('chat', nick, txt);\r\n                this.eventEmitter.emit(XMPPEvents.MESSAGE_RECEIVED,\r\n                        from, nick, txt, this.myroomjid, stamp);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param pres\r\n     * @param from\r\n     */\r\n    onPresenceError(pres, from) {\r\n        if ($(pres)\r\n                .find(\r\n                    '>error[type=\"auth\"]'\r\n                        + '>not-authorized['\r\n                        + 'xmlns=\"urn:ietf:params:xml:ns:xmpp-stanzas\"]')\r\n                .length) {\r\n            logger.log('on password required', from);\r\n            this.eventEmitter.emit(XMPPEvents.PASSWORD_REQUIRED);\r\n        } else if ($(pres)\r\n                .find(\r\n                    '>error[type=\"cancel\"]'\r\n                        + '>not-allowed['\r\n                        + 'xmlns=\"urn:ietf:params:xml:ns:xmpp-stanzas\"]')\r\n                .length) {\r\n            const toDomain = Strophe.getDomainFromJid(pres.getAttribute('to'));\r\n\r\n            if (toDomain === this.xmpp.options.hosts.anonymousdomain) {\r\n                // enter the room by replying with 'not-authorized'. This would\r\n                // result in reconnection from authorized domain.\r\n                // We're either missing Jicofo/Prosody config for anonymous\r\n                // domains or something is wrong.\r\n                this.eventEmitter.emit(XMPPEvents.ROOM_JOIN_ERROR);\r\n\r\n            } else {\r\n                logger.warn('onPresError ', pres);\r\n                this.eventEmitter.emit(\r\n                    XMPPEvents.ROOM_CONNECT_NOT_ALLOWED_ERROR);\r\n            }\r\n        } else if ($(pres).find('>error>service-unavailable').length) {\r\n            logger.warn('Maximum users limit for the room has been reached',\r\n                pres);\r\n            this.eventEmitter.emit(XMPPEvents.ROOM_MAX_USERS_ERROR);\r\n        } else {\r\n            logger.warn('onPresError ', pres);\r\n            this.eventEmitter.emit(XMPPEvents.ROOM_CONNECT_ERROR);\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param jid\r\n     */\r\n    kick(jid) {\r\n        const kickIQ = $iq({ to: this.roomjid,\r\n            type: 'set' })\r\n            .c('query', { xmlns: 'http://jabber.org/protocol/muc#admin' })\r\n            .c('item', { nick: Strophe.getResourceFromJid(jid),\r\n                role: 'none' })\r\n            .c('reason').t('You have been kicked.').up().up().up();\r\n\r\n        this.connection.sendIQ(\r\n            kickIQ,\r\n            result => logger.log('Kick participant with jid: ', jid, result),\r\n            error => logger.log('Kick participant error: ', error));\r\n    }\r\n\r\n    /* eslint-disable max-params */\r\n\r\n    /**\r\n     *\r\n     * @param key\r\n     * @param onSuccess\r\n     * @param onError\r\n     * @param onNotSupported\r\n     */\r\n    lockRoom(key, onSuccess, onError, onNotSupported) {\r\n        // http://xmpp.org/extensions/xep-0045.html#roomconfig\r\n        this.connection.sendIQ(\r\n            $iq({\r\n                to: this.roomjid,\r\n                type: 'get'\r\n            })\r\n                .c('query', { xmlns: 'http://jabber.org/protocol/muc#owner' }),\r\n            res => {\r\n                if ($(res)\r\n                        .find(\r\n                            '>query>x[xmlns=\"jabber:x:data\"]'\r\n                                + '>field[var=\"muc#roomconfig_roomsecret\"]')\r\n                        .length) {\r\n                    const formsubmit\r\n                        = $iq({\r\n                            to: this.roomjid,\r\n                            type: 'set'\r\n                        })\r\n                            .c('query', {\r\n                                xmlns: 'http://jabber.org/protocol/muc#owner'\r\n                            });\r\n\r\n                    formsubmit.c('x', {\r\n                        xmlns: 'jabber:x:data',\r\n                        type: 'submit'\r\n                    });\r\n                    formsubmit\r\n                        .c('field', { 'var': 'FORM_TYPE' })\r\n                        .c('value')\r\n                        .t('http://jabber.org/protocol/muc#roomconfig')\r\n                        .up()\r\n                        .up();\r\n                    formsubmit\r\n                        .c('field', { 'var': 'muc#roomconfig_roomsecret' })\r\n                        .c('value')\r\n                        .t(key)\r\n                        .up()\r\n                        .up();\r\n\r\n                    // Fixes a bug in prosody 0.9.+\r\n                    // https://code.google.com/p/lxmppd/issues/detail?id=373\r\n                    formsubmit\r\n                        .c('field', { 'var': 'muc#roomconfig_whois' })\r\n                        .c('value')\r\n                        .t('anyone')\r\n                        .up()\r\n                        .up();\r\n\r\n                    // FIXME: is muc#roomconfig_passwordprotectedroom required?\r\n                    this.connection.sendIQ(formsubmit, onSuccess, onError);\r\n                } else {\r\n                    onNotSupported();\r\n                }\r\n            },\r\n            onError);\r\n    }\r\n\r\n    /* eslint-enable max-params */\r\n\r\n    /**\r\n     *\r\n     * @param key\r\n     * @param values\r\n     */\r\n    addToPresence(key, values) {\r\n        values.tagName = key;\r\n        this.removeFromPresence(key);\r\n        this.presMap.nodes.push(values);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param key\r\n     */\r\n    removeFromPresence(key) {\r\n        const nodes = this.presMap.nodes.filter(node => key !== node.tagName);\r\n\r\n        this.presMap.nodes = nodes;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param name\r\n     * @param handler\r\n     */\r\n    addPresenceListener(name, handler) {\r\n        if (typeof handler !== 'function') {\r\n            throw new Error('\"handler\" is not a function');\r\n        }\r\n        let tagHandlers = this.presHandlers[name];\r\n\r\n        if (!tagHandlers) {\r\n            this.presHandlers[name] = tagHandlers = [];\r\n        }\r\n        if (tagHandlers.indexOf(handler) === -1) {\r\n            tagHandlers.push(handler);\r\n        } else {\r\n            logger.warn(\r\n                `Trying to add the same handler more than once for: ${name}`);\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param name\r\n     * @param handler\r\n     */\r\n    removePresenceListener(name, handler) {\r\n        const tagHandlers = this.presHandlers[name];\r\n        const handlerIdx = tagHandlers ? tagHandlers.indexOf(handler) : -1;\r\n\r\n        // eslint-disable-next-line no-negated-condition\r\n        if (handlerIdx !== -1) {\r\n            tagHandlers.splice(handlerIdx, 1);\r\n        } else {\r\n            logger.warn(`Handler for: ${name} was not registered`);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Checks if the user identified by given <tt>mucJid</tt> is the conference\r\n     * focus.\r\n     * @param mucJid the full MUC address of the user to be checked.\r\n     * @returns {boolean|null} <tt>true</tt> if MUC user is the conference focus\r\n     * or <tt>false</tt> if is not. When given <tt>mucJid</tt> does not exist in\r\n     * the MUC then <tt>null</tt> is returned.\r\n     */\r\n    isFocus(mucJid) {\r\n        const member = this.members[mucJid];\r\n\r\n        if (member) {\r\n            return member.isFocus;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     *\r\n     */\r\n    isModerator() {\r\n        return this.role === 'moderator';\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param peerJid\r\n     */\r\n    getMemberRole(peerJid) {\r\n        if (this.members[peerJid]) {\r\n            return this.members[peerJid].role;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param mute\r\n     * @param callback\r\n     */\r\n    setVideoMute(mute, callback) {\r\n        this.sendVideoInfoPresence(mute);\r\n        if (callback) {\r\n            callback(mute);\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param mute\r\n     * @param callback\r\n     */\r\n    setAudioMute(mute, callback) {\r\n        return this.sendAudioInfoPresence(mute, callback);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param mute\r\n     */\r\n    addAudioInfoToPresence(mute) {\r\n        this.removeFromPresence('audiomuted');\r\n        this.addToPresence(\r\n            'audiomuted',\r\n            {\r\n                attributes: { 'xmlns': 'http://jitsi.org/jitmeet/audio' },\r\n                value: mute.toString()\r\n            });\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param mute\r\n     * @param callback\r\n     */\r\n    sendAudioInfoPresence(mute, callback) {\r\n        this.addAudioInfoToPresence(mute);\r\n        if (this.connection) {\r\n            this.sendPresence();\r\n        }\r\n        if (callback) {\r\n            callback();\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param mute\r\n     */\r\n    addVideoInfoToPresence(mute) {\r\n        this.removeFromPresence('videomuted');\r\n        this.addToPresence(\r\n            'videomuted',\r\n            {\r\n                attributes: { 'xmlns': 'http://jitsi.org/jitmeet/video' },\r\n                value: mute.toString()\r\n            });\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param mute\r\n     */\r\n    sendVideoInfoPresence(mute) {\r\n        this.addVideoInfoToPresence(mute);\r\n        if (!this.connection) {\r\n            return;\r\n        }\r\n        this.sendPresence();\r\n    }\r\n\r\n    /**\r\n     * Obtains the info about given media advertised in the MUC presence of\r\n     * the participant identified by the given endpoint JID.\r\n     * @param {string} endpointId the endpoint ID mapped to the participant\r\n     * which corresponds to MUC nickname.\r\n     * @param {MediaType} mediaType the type of the media for which presence\r\n     * info will be obtained.\r\n     * @return {PeerMediaInfo} presenceInfo an object with media presence\r\n     * info or <tt>null</tt> either if there is no presence available or if\r\n     * the media type given is invalid.\r\n     */\r\n    getMediaPresenceInfo(endpointId, mediaType) {\r\n        // Will figure out current muted status by looking up owner's presence\r\n        const pres = this.lastPresences[`${this.roomjid}/${endpointId}`];\r\n\r\n        if (!pres) {\r\n            // No presence available\r\n            return null;\r\n        }\r\n        const data = {\r\n            muted: false, // unmuted by default\r\n            videoType: undefined // no video type by default\r\n        };\r\n        let mutedNode = null;\r\n\r\n        if (mediaType === MediaType.AUDIO) {\r\n            mutedNode = filterNodeFromPresenceJSON(pres, 'audiomuted');\r\n        } else if (mediaType === MediaType.VIDEO) {\r\n            mutedNode = filterNodeFromPresenceJSON(pres, 'videomuted');\r\n            const videoTypeNode = filterNodeFromPresenceJSON(pres, 'videoType');\r\n\r\n            if (videoTypeNode.length > 0) {\r\n                data.videoType = videoTypeNode[0].value;\r\n            }\r\n        } else {\r\n            logger.error(`Unsupported media type: ${mediaType}`);\r\n\r\n            return null;\r\n        }\r\n\r\n        data.muted = mutedNode.length > 0 && mutedNode[0].value === 'true';\r\n\r\n        return data;\r\n    }\r\n\r\n    /**\r\n     * Returns true if the recording is supproted and false if not.\r\n     */\r\n    isRecordingSupported() {\r\n        if (this.recording) {\r\n            return this.recording.isSupported();\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Returns null if the recording is not supported, \"on\" if the recording\r\n     * started and \"off\" if the recording is not started.\r\n     */\r\n    getRecordingState() {\r\n        return this.recording ? this.recording.getState() : undefined;\r\n    }\r\n\r\n    /**\r\n     * Returns the url of the recorded video.\r\n     */\r\n    getRecordingURL() {\r\n        return this.recording ? this.recording.getURL() : null;\r\n    }\r\n\r\n    /**\r\n     * Starts/stops the recording\r\n     * @param token token for authentication\r\n     * @param statusChangeHandler {function} receives the new status as\r\n     * argument.\r\n     */\r\n    toggleRecording(options, statusChangeHandler) {\r\n        if (this.recording) {\r\n            return this.recording.toggleRecording(options, statusChangeHandler);\r\n        }\r\n\r\n        return statusChangeHandler('error',\r\n            new Error('The conference is not created yet!'));\r\n    }\r\n\r\n    /**\r\n     * Returns true if the SIP calls are supported and false otherwise\r\n     */\r\n    isSIPCallingSupported() {\r\n        if (this.moderator) {\r\n            return this.moderator.isSipGatewayEnabled();\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Dials a number.\r\n     * @param number the number\r\n     */\r\n    dial(number) {\r\n        return this.connection.rayo.dial(number, 'fromnumber',\r\n            Strophe.getBareJidFromJid(this.myroomjid), this.password,\r\n            this.focusMucJid);\r\n    }\r\n\r\n    /**\r\n     * Hangup an existing call\r\n     */\r\n    hangup() {\r\n        return this.connection.rayo.hangup();\r\n    }\r\n\r\n    /**\r\n     * Returns the phone number for joining the conference.\r\n     */\r\n    getPhoneNumber() {\r\n        return this.phoneNumber;\r\n    }\r\n\r\n    /**\r\n     * Returns the pin for joining the conference with phone.\r\n     */\r\n    getPhonePin() {\r\n        return this.phonePin;\r\n    }\r\n\r\n    /**\r\n     * Mutes remote participant.\r\n     * @param jid of the participant\r\n     * @param mute\r\n     */\r\n    muteParticipant(jid, mute) {\r\n        logger.info('set mute', mute);\r\n        const iqToFocus = $iq(\r\n            { to: this.focusMucJid,\r\n                type: 'set' })\r\n            .c('mute', {\r\n                xmlns: 'http://jitsi.org/jitmeet/audio',\r\n                jid\r\n            })\r\n            .t(mute.toString())\r\n            .up();\r\n\r\n        this.connection.sendIQ(\r\n            iqToFocus,\r\n            result => logger.log('set mute', result),\r\n            error => logger.log('set mute error', error));\r\n    }\r\n\r\n    /**\r\n     * TODO: Document\r\n     * @param iq\r\n     */\r\n    onMute(iq) {\r\n        const from = iq.getAttribute('from');\r\n\r\n        if (from !== this.focusMucJid) {\r\n            logger.warn('Ignored mute from non focus peer');\r\n\r\n            return;\r\n        }\r\n        const mute = $(iq).find('mute');\r\n\r\n        if (mute.length && mute.text() === 'true') {\r\n            this.eventEmitter.emit(XMPPEvents.AUDIO_MUTED_BY_FOCUS);\r\n        } else {\r\n            // XXX Why do we support anything but muting? Why do we encode the\r\n            // value in the text of the element? Why do we use a separate XML\r\n            // namespace?\r\n            logger.warn('Ignoring a mute request which does not explicitly '\r\n                + 'specify a positive mute command.');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Leaves the room. Closes the jingle session.\r\n     * @returns {Promise} which is resolved if XMPPEvents.MUC_LEFT is received\r\n     * less than 5s after sending presence unavailable. Otherwise the promise is\r\n     * rejected.\r\n     */\r\n    leave() {\r\n        return new Promise((resolve, reject) => {\r\n            const timeout = setTimeout(() => onMucLeft(true), 5000);\r\n            const eventEmitter = this.eventEmitter;\r\n\r\n            /**\r\n             *\r\n             * @param doReject\r\n             */\r\n            function onMucLeft(doReject = false) {\r\n                eventEmitter.removeListener(XMPPEvents.MUC_LEFT, onMucLeft);\r\n                clearTimeout(timeout);\r\n                if (doReject) {\r\n                    // the timeout expired\r\n                    reject(new Error('The timeout for the confirmation about '\r\n                        + 'leaving the room expired.'));\r\n                } else {\r\n                    resolve();\r\n                }\r\n            }\r\n            eventEmitter.on(XMPPEvents.MUC_LEFT, onMucLeft);\r\n            this.doLeave();\r\n        });\r\n    }\r\n}\r\n\r\n/* eslint-enable newline-per-chained-call */\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/xmpp/ChatRoom.js","/* global $, Promise */\r\n\r\nconst logger = require('jitsi-meet-logger').getLogger(__filename);\r\n\r\nimport { $iq, Strophe } from 'strophe.js';\r\n\r\nconst XMPPEvents = require('../../service/xmpp/XMPPEvents');\r\nconst AuthenticationEvents\r\n    = require('../../service/authentication/AuthenticationEvents');\r\nconst GlobalOnErrorHandler = require('../util/GlobalOnErrorHandler');\r\n\r\nimport browser from '../browser';\r\nimport Settings from '../settings/Settings';\r\n\r\n/**\r\n *\r\n * @param step\r\n */\r\nfunction createExpBackoffTimer(step) {\r\n    let count = 1;\r\n\r\n    return function(reset) {\r\n        // Reset call\r\n        if (reset) {\r\n            count = 1;\r\n\r\n            return;\r\n        }\r\n\r\n        // Calculate next timeout\r\n        const timeout = Math.pow(2, count - 1);\r\n\r\n        count += 1;\r\n\r\n        return timeout * step;\r\n    };\r\n}\r\n\r\n/* eslint-disable max-params */\r\n\r\n/**\r\n *\r\n * @param roomName\r\n * @param xmpp\r\n * @param emitter\r\n * @param options\r\n */\r\nexport default function Moderator(roomName, xmpp, emitter, options) {\r\n    this.roomName = roomName;\r\n    this.xmppService = xmpp;\r\n    this.getNextTimeout = createExpBackoffTimer(1000);\r\n    this.getNextErrorTimeout = createExpBackoffTimer(1000);\r\n\r\n    // External authentication stuff\r\n    this.externalAuthEnabled = false;\r\n    this.options = options;\r\n\r\n    // Sip gateway can be enabled by configuring Jigasi host in config.js or\r\n    // it will be enabled automatically if focus detects the component through\r\n    // service discovery.\r\n    this.sipGatewayEnabled\r\n        = this.options.connection.hosts\r\n            && this.options.connection.hosts.call_control !== undefined;\r\n\r\n    this.eventEmitter = emitter;\r\n\r\n    this.connection = this.xmppService.connection;\r\n\r\n    // FIXME: Message listener that talks to POPUP window\r\n    /**\r\n     *\r\n     * @param event\r\n     */\r\n    function listener(event) {\r\n        if (event.data && event.data.sessionId) {\r\n            if (event.origin !== window.location.origin) {\r\n                logger.warn(\r\n                    `Ignoring sessionId from different origin: ${\r\n                        event.origin}`);\r\n\r\n                return;\r\n            }\r\n            Settings.sessionId = event.data.sessionId;\r\n\r\n            // After popup is closed we will authenticate\r\n        }\r\n    }\r\n\r\n    // Register\r\n    if (window.addEventListener) {\r\n        window.addEventListener('message', listener, false);\r\n    } else {\r\n        window.attachEvent('onmessage', listener);\r\n    }\r\n}\r\n\r\n/* eslint-enable max-params */\r\n\r\nModerator.prototype.isExternalAuthEnabled = function() {\r\n    return this.externalAuthEnabled;\r\n};\r\n\r\nModerator.prototype.isSipGatewayEnabled = function() {\r\n    return this.sipGatewayEnabled;\r\n};\r\n\r\nModerator.prototype.onMucMemberLeft = function(jid) {\r\n    logger.info(`Someone left is it focus ? ${jid}`);\r\n    const resource = Strophe.getResourceFromJid(jid);\r\n\r\n    if (resource === 'focus') {\r\n        logger.info(\r\n            'Focus has left the room - leaving conference');\r\n        this.eventEmitter.emit(XMPPEvents.FOCUS_LEFT);\r\n    }\r\n};\r\n\r\nModerator.prototype.setFocusUserJid = function(focusJid) {\r\n    if (!this.focusUserJid) {\r\n        this.focusUserJid = focusJid;\r\n        logger.info(`Focus jid set to:  ${this.focusUserJid}`);\r\n    }\r\n};\r\n\r\nModerator.prototype.getFocusUserJid = function() {\r\n    return this.focusUserJid;\r\n};\r\n\r\nModerator.prototype.getFocusComponent = function() {\r\n    // Get focus component address\r\n    let focusComponent = this.options.connection.hosts.focus;\r\n\r\n    // If not specified use default:  'focus.domain'\r\n\r\n    if (!focusComponent) {\r\n        focusComponent = `focus.${this.options.connection.hosts.domain}`;\r\n    }\r\n\r\n    return focusComponent;\r\n};\r\n\r\nModerator.prototype.createConferenceIq = function() {\r\n    // Generate create conference IQ\r\n    const elem = $iq({ to: this.getFocusComponent(),\r\n        type: 'set' });\r\n\r\n    // Session Id used for authentication\r\n    const { sessionId } = Settings;\r\n    const machineUID = Settings.machineId;\r\n\r\n    logger.info(`Session ID: ${sessionId} machine UID: ${machineUID}`);\r\n\r\n    elem.c('conference', {\r\n        xmlns: 'http://jitsi.org/protocol/focus',\r\n        room: this.roomName,\r\n        'machine-uid': machineUID\r\n    });\r\n\r\n    if (sessionId) {\r\n        elem.attrs({ 'session-id': sessionId });\r\n    }\r\n    if (this.options.connection.enforcedBridge !== undefined) {\r\n        elem.c(\r\n            'property', {\r\n                name: 'enforcedBridge',\r\n                value: this.options.connection.enforcedBridge\r\n            }).up();\r\n    }\r\n\r\n    // Tell the focus we have Jigasi configured\r\n    if (this.options.connection.hosts !== undefined\r\n        && this.options.connection.hosts.call_control !== undefined) {\r\n        elem.c(\r\n            'property', {\r\n                name: 'call_control',\r\n                value: this.options.connection.hosts.call_control\r\n            }).up();\r\n    }\r\n    if (this.options.conference.channelLastN !== undefined) {\r\n        elem.c(\r\n            'property', {\r\n                name: 'channelLastN',\r\n                value: this.options.conference.channelLastN\r\n            }).up();\r\n    }\r\n    elem.c(\r\n        'property', {\r\n            name: 'disableRtx',\r\n            value: Boolean(this.options.conference.disableRtx)\r\n        }).up();\r\n    elem.c(\r\n        'property', {\r\n            name: 'enableLipSync',\r\n            value: this.options.connection.enableLipSync !== false\r\n        }).up();\r\n    if (this.options.conference.audioPacketDelay !== undefined) {\r\n        elem.c(\r\n            'property', {\r\n                name: 'audioPacketDelay',\r\n                value: this.options.conference.audioPacketDelay\r\n            }).up();\r\n    }\r\n    if (this.options.conference.startBitrate) {\r\n        elem.c(\r\n            'property', {\r\n                name: 'startBitrate',\r\n                value: this.options.conference.startBitrate\r\n            }).up();\r\n    }\r\n    if (this.options.conference.minBitrate) {\r\n        elem.c(\r\n            'property', {\r\n                name: 'minBitrate',\r\n                value: this.options.conference.minBitrate\r\n            }).up();\r\n    }\r\n\r\n    let openSctp;\r\n\r\n    switch (this.options.conference.openBridgeChannel) {\r\n    case 'datachannel':\r\n    case true:\r\n    case undefined:\r\n        openSctp = true;\r\n        break;\r\n    case 'websocket':\r\n        openSctp = false;\r\n        break;\r\n    }\r\n\r\n    if (openSctp && !browser.supportsDataChannels()) {\r\n        openSctp = false;\r\n    }\r\n\r\n    elem.c(\r\n        'property', {\r\n            name: 'openSctp',\r\n            value: openSctp\r\n        }).up();\r\n\r\n    if (this.options.conference.startAudioMuted !== undefined) {\r\n        elem.c(\r\n            'property', {\r\n                name: 'startAudioMuted',\r\n                value: this.options.conference.startAudioMuted\r\n            }).up();\r\n    }\r\n    if (this.options.conference.startVideoMuted !== undefined) {\r\n        elem.c(\r\n            'property', {\r\n                name: 'startVideoMuted',\r\n                value: this.options.conference.startVideoMuted\r\n            }).up();\r\n    }\r\n    if (this.options.conference.stereo !== undefined) {\r\n        elem.c(\r\n            'property', {\r\n                name: 'stereo',\r\n                value: this.options.conference.stereo\r\n            }).up();\r\n    }\r\n    if (this.options.conference.useRoomAsSharedDocumentName !== undefined) {\r\n        elem.c(\r\n            'property', {\r\n                name: 'useRoomAsSharedDocumentName',\r\n                value: this.options.conference.useRoomAsSharedDocumentName\r\n            }).up();\r\n    }\r\n    elem.up();\r\n\r\n    return elem;\r\n};\r\n\r\n\r\nModerator.prototype.parseSessionId = function(resultIq) {\r\n    // eslint-disable-next-line newline-per-chained-call\r\n    const sessionId = $(resultIq).find('conference').attr('session-id');\r\n\r\n    if (sessionId) {\r\n        logger.info(`Received sessionId:  ${sessionId}`);\r\n        Settings.sessionId = sessionId;\r\n    }\r\n};\r\n\r\nModerator.prototype.parseConfigOptions = function(resultIq) {\r\n    // eslint-disable-next-line newline-per-chained-call\r\n    this.setFocusUserJid($(resultIq).find('conference').attr('focusjid'));\r\n\r\n    const authenticationEnabled\r\n        = $(resultIq).find(\r\n            '>conference>property'\r\n            + '[name=\\'authentication\\'][value=\\'true\\']').length > 0;\r\n\r\n    logger.info(`Authentication enabled: ${authenticationEnabled}`);\r\n\r\n    this.externalAuthEnabled = $(resultIq).find(\r\n        '>conference>property'\r\n            + '[name=\\'externalAuth\\'][value=\\'true\\']').length > 0;\r\n\r\n    logger.info(\r\n        `External authentication enabled: ${this.externalAuthEnabled}`);\r\n\r\n    if (!this.externalAuthEnabled) {\r\n        // We expect to receive sessionId in 'internal' authentication mode\r\n        this.parseSessionId(resultIq);\r\n    }\r\n\r\n    // eslint-disable-next-line newline-per-chained-call\r\n    const authIdentity = $(resultIq).find('>conference').attr('identity');\r\n\r\n    this.eventEmitter.emit(AuthenticationEvents.IDENTITY_UPDATED,\r\n        authenticationEnabled, authIdentity);\r\n\r\n    // Check if focus has auto-detected Jigasi component(this will be also\r\n    // included if we have passed our host from the config)\r\n    if ($(resultIq).find(\r\n        '>conference>property'\r\n        + '[name=\\'sipGatewayEnabled\\'][value=\\'true\\']').length) {\r\n        this.sipGatewayEnabled = true;\r\n    }\r\n\r\n    logger.info(`Sip gateway enabled:  ${this.sipGatewayEnabled}`);\r\n};\r\n\r\n// FIXME We need to show the fact that we're waiting for the focus to the user\r\n// (or that the focus is not available)\r\n/**\r\n * Allocates the conference focus.\r\n *\r\n * @param {Function} callback - the function to be called back upon the\r\n * successful allocation of the conference focus\r\n */\r\nModerator.prototype.allocateConferenceFocus = function(callback) {\r\n    // Try to use focus user JID from the config\r\n    this.setFocusUserJid(this.options.connection.focusUserJid);\r\n\r\n    // Send create conference IQ\r\n    this.connection.sendIQ(\r\n        this.createConferenceIq(),\r\n        result => this._allocateConferenceFocusSuccess(result, callback),\r\n        error => this._allocateConferenceFocusError(error, callback));\r\n\r\n    // XXX We're pressed for time here because we're beginning a complex and/or\r\n    // lengthy conference-establishment process which supposedly involves\r\n    // multiple RTTs. We don't have the time to wait for Strophe to decide to\r\n    // send our IQ.\r\n    this.connection.flush();\r\n};\r\n\r\n/**\r\n * Invoked by {@link #allocateConferenceFocus} upon its request receiving an\r\n * error result.\r\n *\r\n * @param error - the error result of the request that\r\n * {@link #allocateConferenceFocus} sent\r\n * @param {Function} callback - the function to be called back upon the\r\n * successful allocation of the conference focus\r\n */\r\nModerator.prototype._allocateConferenceFocusError = function(error, callback) {\r\n    // If the session is invalid, remove and try again without session ID to get\r\n    // a new one\r\n    const invalidSession\r\n        = $(error).find('>error>session-invalid').length\r\n            || $(error).find('>error>not-acceptable').length;\r\n\r\n    if (invalidSession) {\r\n        logger.info('Session expired! - removing');\r\n        Settings.sessionId = undefined;\r\n    }\r\n    if ($(error).find('>error>graceful-shutdown').length) {\r\n        this.eventEmitter.emit(XMPPEvents.GRACEFUL_SHUTDOWN);\r\n\r\n        return;\r\n    }\r\n\r\n    // Check for error returned by the reservation system\r\n    const reservationErr = $(error).find('>error>reservation-error');\r\n\r\n    if (reservationErr.length) {\r\n        // Trigger error event\r\n        const errorCode = reservationErr.attr('error-code');\r\n        const errorTextNode = $(error).find('>error>text');\r\n        let errorMsg;\r\n\r\n        if (errorTextNode) {\r\n            errorMsg = errorTextNode.text();\r\n        }\r\n        this.eventEmitter.emit(\r\n            XMPPEvents.RESERVATION_ERROR,\r\n            errorCode,\r\n            errorMsg);\r\n\r\n        return;\r\n    }\r\n\r\n    // Not authorized to create new room\r\n    if ($(error).find('>error>not-authorized').length) {\r\n        logger.warn('Unauthorized to start the conference', error);\r\n        const toDomain = Strophe.getDomainFromJid(error.getAttribute('to'));\r\n\r\n        if (toDomain !== this.options.connection.hosts.anonymousdomain) {\r\n            // FIXME \"is external\" should come either from the focus or\r\n            // config.js\r\n            this.externalAuthEnabled = true;\r\n        }\r\n        this.eventEmitter.emit(XMPPEvents.AUTHENTICATION_REQUIRED);\r\n\r\n        return;\r\n    }\r\n    const waitMs = this.getNextErrorTimeout();\r\n    const errmsg = `Focus error, retry after ${waitMs}`;\r\n\r\n    GlobalOnErrorHandler.callErrorHandler(new Error(errmsg));\r\n    logger.error(errmsg, error);\r\n\r\n    // Show message\r\n    const focusComponent = this.getFocusComponent();\r\n    const retrySec = waitMs / 1000;\r\n\r\n    // FIXME: message is duplicated ? Do not show in case of session invalid\r\n    // which means just a retry\r\n\r\n    if (!invalidSession) {\r\n        this.eventEmitter.emit(\r\n            XMPPEvents.FOCUS_DISCONNECTED,\r\n            focusComponent,\r\n            retrySec);\r\n    }\r\n\r\n    // Reset response timeout\r\n    this.getNextTimeout(true);\r\n    window.setTimeout(() => this.allocateConferenceFocus(callback), waitMs);\r\n};\r\n\r\n/**\r\n * Invoked by {@link #allocateConferenceFocus} upon its request receiving a\r\n * success (i.e. non-error) result.\r\n *\r\n * @param result - the success (i.e. non-error) result of the request that\r\n * {@link #allocateConferenceFocus} sent\r\n * @param {Function} callback - the function to be called back upon the\r\n * successful allocation of the conference focus\r\n */\r\nModerator.prototype._allocateConferenceFocusSuccess = function(\r\n        result,\r\n        callback) {\r\n    // Setup config options\r\n    this.parseConfigOptions(result);\r\n\r\n    // Reset the error timeout (because we haven't failed here).\r\n    this.getNextErrorTimeout(true);\r\n\r\n    // eslint-disable-next-line newline-per-chained-call\r\n    if ($(result).find('conference').attr('ready') === 'true') {\r\n        // Reset the non-error timeout (because we've succeeded here).\r\n        this.getNextTimeout(true);\r\n\r\n        // Exec callback\r\n        callback();\r\n    } else {\r\n        const waitMs = this.getNextTimeout();\r\n\r\n        logger.info(`Waiting for the focus... ${waitMs}`);\r\n        window.setTimeout(() => this.allocateConferenceFocus(callback),\r\n            waitMs);\r\n    }\r\n};\r\n\r\nModerator.prototype.authenticate = function() {\r\n    return new Promise((resolve, reject) => {\r\n        this.connection.sendIQ(\r\n            this.createConferenceIq(),\r\n            result => {\r\n                this.parseSessionId(result);\r\n                resolve();\r\n            },\r\n            errorIq => reject({\r\n                error: $(errorIq).find('iq>error :first')\r\n                    .prop('tagName'),\r\n                message: $(errorIq).find('iq>error>text')\r\n                    .text()\r\n            })\r\n        );\r\n    });\r\n};\r\n\r\nModerator.prototype.getLoginUrl = function(urlCallback, failureCallback) {\r\n    this._getLoginUrl(/* popup */ false, urlCallback, failureCallback);\r\n};\r\n\r\n/**\r\n *\r\n * @param {boolean} popup false for {@link Moderator#getLoginUrl} or true for\r\n * {@link Moderator#getPopupLoginUrl}\r\n * @param urlCb\r\n * @param failureCb\r\n */\r\nModerator.prototype._getLoginUrl = function(popup, urlCb, failureCb) {\r\n    const iq = $iq({ to: this.getFocusComponent(),\r\n        type: 'get' });\r\n    const attrs = {\r\n        xmlns: 'http://jitsi.org/protocol/focus',\r\n        room: this.roomName,\r\n        'machine-uid': Settings.machineId\r\n    };\r\n    let str = 'auth url'; // for logger\r\n\r\n    if (popup) {\r\n        attrs.popup = true;\r\n        str = `POPUP ${str}`;\r\n    }\r\n    iq.c('login-url', attrs);\r\n\r\n    /**\r\n     * Implements a failure callback which reports an error message and an error\r\n     * through (1) GlobalOnErrorHandler, (2) logger, and (3) failureCb.\r\n     *\r\n     * @param {string} errmsg the error messsage to report\r\n     * @param {*} error the error to report (in addition to errmsg)\r\n     */\r\n    function reportError(errmsg, err) {\r\n        GlobalOnErrorHandler.callErrorHandler(new Error(errmsg));\r\n        logger.error(errmsg, err);\r\n        failureCb(err);\r\n    }\r\n    this.connection.sendIQ(\r\n        iq,\r\n        result => {\r\n            // eslint-disable-next-line newline-per-chained-call\r\n            let url = $(result).find('login-url').attr('url');\r\n\r\n            url = decodeURIComponent(url);\r\n            if (url) {\r\n                logger.info(`Got ${str}: ${url}`);\r\n                urlCb(url);\r\n            } else {\r\n                reportError(`Failed to get ${str} from the focus`, result);\r\n            }\r\n        },\r\n        reportError.bind(undefined, `Get ${str} error`)\r\n    );\r\n};\r\n\r\nModerator.prototype.getPopupLoginUrl = function(urlCallback, failureCallback) {\r\n    this._getLoginUrl(/* popup */ true, urlCallback, failureCallback);\r\n};\r\n\r\nModerator.prototype.logout = function(callback) {\r\n    const iq = $iq({ to: this.getFocusComponent(),\r\n        type: 'set' });\r\n    const { sessionId } = Settings;\r\n\r\n    if (!sessionId) {\r\n        callback();\r\n\r\n        return;\r\n    }\r\n    iq.c('logout', {\r\n        xmlns: 'http://jitsi.org/protocol/focus',\r\n        'session-id': sessionId\r\n    });\r\n    this.connection.sendIQ(\r\n        iq,\r\n        result => {\r\n            // eslint-disable-next-line newline-per-chained-call\r\n            let logoutUrl = $(result).find('logout').attr('logout-url');\r\n\r\n            if (logoutUrl) {\r\n                logoutUrl = decodeURIComponent(logoutUrl);\r\n            }\r\n            logger.info(`Log out OK, url: ${logoutUrl}`, result);\r\n            Settings.sessionId = undefined;\r\n            callback(logoutUrl);\r\n        },\r\n        error => {\r\n            const errmsg = 'Logout error';\r\n\r\n            GlobalOnErrorHandler.callErrorHandler(new Error(errmsg));\r\n            logger.error(errmsg, error);\r\n        }\r\n    );\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/xmpp/moderator.js","/* global $, __filename */\r\n\r\nimport {\r\n    ACTION_JINGLE_TR_RECEIVED,\r\n    ACTION_JINGLE_TR_SUCCESS,\r\n    createJingleEvent\r\n} from '../../service/statistics/AnalyticsEvents';\r\nimport { getLogger } from 'jitsi-meet-logger';\r\nimport { $iq, Strophe } from 'strophe.js';\r\n\r\nimport XMPPEvents from '../../service/xmpp/XMPPEvents';\r\nimport GlobalOnErrorHandler from '../util/GlobalOnErrorHandler';\r\nimport RandomUtil from '../util/RandomUtil';\r\nimport Statistics from '../statistics/statistics';\r\n\r\nimport JingleSessionPC from './JingleSessionPC';\r\nimport ConnectionPlugin from './ConnectionPlugin';\r\n\r\nconst logger = getLogger(__filename);\r\n\r\n// XXX Strophe is build around the idea of chaining function calls so allow long\r\n// function call chains.\r\n/* eslint-disable newline-per-chained-call */\r\n\r\n/**\r\n *\r\n */\r\nclass JingleConnectionPlugin extends ConnectionPlugin {\r\n    /**\r\n     * Creates new <tt>JingleConnectionPlugin</tt>\r\n     * @param {XMPP} xmpp\r\n     * @param {EventEmitter} eventEmitter\r\n     * @param {Object} iceConfig an object that holds the iceConfig to be passed\r\n     * to the p2p and the jvb <tt>PeerConnection</tt>.\r\n     */\r\n    constructor(xmpp, eventEmitter, iceConfig) {\r\n        super();\r\n        this.xmpp = xmpp;\r\n        this.eventEmitter = eventEmitter;\r\n        this.sessions = {};\r\n        this.jvbIceConfig = iceConfig.jvb;\r\n        this.p2pIceConfig = iceConfig.p2p;\r\n        this.mediaConstraints = {\r\n            mandatory: {\r\n                'OfferToReceiveAudio': true,\r\n                'OfferToReceiveVideo': true\r\n            }\r\n\r\n            // MozDontOfferDataChannel: true when this is firefox\r\n        };\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param connection\r\n     */\r\n    init(connection) {\r\n        super.init(connection);\r\n        this.connection.addHandler(this.onJingle.bind(this),\r\n            'urn:xmpp:jingle:1', 'iq', 'set', null, null);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param iq\r\n     */\r\n    onJingle(iq) {\r\n        const sid = $(iq).find('jingle').attr('sid');\r\n        const action = $(iq).find('jingle').attr('action');\r\n        const fromJid = iq.getAttribute('from');\r\n\r\n        // send ack first\r\n        const ack = $iq({ type: 'result',\r\n            to: fromJid,\r\n            id: iq.getAttribute('id')\r\n        });\r\n\r\n        logger.log(`on jingle ${action} from ${fromJid}`, iq);\r\n        let sess = this.sessions[sid];\r\n\r\n        if (action !== 'session-initiate') {\r\n            if (!sess) {\r\n                ack.attrs({ type: 'error' });\r\n                ack.c('error', { type: 'cancel' })\r\n                    .c('item-not-found', {\r\n                        xmlns: 'urn:ietf:params:xml:ns:xmpp-stanzas'\r\n                    })\r\n                    .up()\r\n                    .c('unknown-session', {\r\n                        xmlns: 'urn:xmpp:jingle:errors:1'\r\n                    });\r\n                logger.warn('invalid session id', iq);\r\n                this.connection.send(ack);\r\n\r\n                return true;\r\n            }\r\n\r\n            // local jid is not checked\r\n            if (fromJid !== sess.remoteJid) {\r\n                logger.warn(\r\n                    'jid mismatch for session id', sid, sess.remoteJid, iq);\r\n                ack.attrs({ type: 'error' });\r\n                ack.c('error', { type: 'cancel' })\r\n                    .c('item-not-found', {\r\n                        xmlns: 'urn:ietf:params:xml:ns:xmpp-stanzas'\r\n                    })\r\n                    .up()\r\n                    .c('unknown-session', {\r\n                        xmlns: 'urn:xmpp:jingle:errors:1'\r\n                    });\r\n                this.connection.send(ack);\r\n\r\n                return true;\r\n            }\r\n        } else if (sess !== undefined) {\r\n            // Existing session with same session id. This might be out-of-order\r\n            // if the sess.remoteJid is the same as from.\r\n            ack.attrs({ type: 'error' });\r\n            ack.c('error', { type: 'cancel' })\r\n                .c('service-unavailable', {\r\n                    xmlns: 'urn:ietf:params:xml:ns:xmpp-stanzas'\r\n                })\r\n                .up();\r\n            logger.warn('duplicate session id', sid, iq);\r\n            this.connection.send(ack);\r\n\r\n            return true;\r\n        }\r\n        const now = window.performance.now();\r\n\r\n        // FIXME that should work most of the time, but we'd have to\r\n        // think how secure it is to assume that user with \"focus\"\r\n        // nickname is Jicofo.\r\n        const isP2P = Strophe.getResourceFromJid(fromJid) !== 'focus';\r\n\r\n        // see http://xmpp.org/extensions/xep-0166.html#concepts-session\r\n\r\n        switch (action) {\r\n        case 'session-initiate': {\r\n            logger.log('(TIME) received session-initiate:\\t', now);\r\n            const startMuted = $(iq).find('jingle>startmuted');\r\n\r\n            if (startMuted && startMuted.length > 0) {\r\n                const audioMuted = startMuted.attr('audio');\r\n                const videoMuted = startMuted.attr('video');\r\n\r\n                this.eventEmitter.emit(\r\n                    XMPPEvents.START_MUTED_FROM_FOCUS,\r\n                    audioMuted === 'true',\r\n                    videoMuted === 'true');\r\n            }\r\n\r\n            logger.info(\r\n                `Marking session from ${fromJid\r\n                } as ${isP2P ? '' : '*not*'} P2P`);\r\n            sess\r\n                = new JingleSessionPC(\r\n                    $(iq).find('jingle').attr('sid'),\r\n                    $(iq).attr('to'),\r\n                    fromJid,\r\n                    this.connection,\r\n                    this.mediaConstraints,\r\n                    isP2P ? this.p2pIceConfig : this.jvbIceConfig,\r\n                    isP2P,\r\n                    /* initiator */ false,\r\n                    this.xmpp.options);\r\n\r\n            this.sessions[sess.sid] = sess;\r\n\r\n            this.eventEmitter.emit(XMPPEvents.CALL_INCOMING,\r\n                sess, $(iq).find('>jingle'), now);\r\n            break;\r\n        }\r\n        case 'session-accept': {\r\n            this.eventEmitter.emit(\r\n                XMPPEvents.CALL_ACCEPTED, sess, $(iq).find('>jingle'));\r\n            break;\r\n        }\r\n        case 'content-modify': {\r\n            sess.modifyContents($(iq).find('>jingle'));\r\n            break;\r\n        }\r\n        case 'transport-info': {\r\n            this.eventEmitter.emit(\r\n                XMPPEvents.TRANSPORT_INFO, sess, $(iq).find('>jingle'));\r\n            break;\r\n        }\r\n        case 'session-terminate': {\r\n            logger.log('terminating...', sess.sid);\r\n            let reasonCondition = null;\r\n            let reasonText = null;\r\n\r\n            if ($(iq).find('>jingle>reason').length) {\r\n                reasonCondition\r\n                    = $(iq).find('>jingle>reason>:first')[0].tagName;\r\n                reasonText = $(iq).find('>jingle>reason>text').text();\r\n            }\r\n            this.terminate(sess.sid, reasonCondition, reasonText);\r\n            this.eventEmitter.emit(XMPPEvents.CALL_ENDED,\r\n                sess, reasonCondition, reasonText);\r\n            break;\r\n        }\r\n        case 'transport-replace':\r\n            logger.info('(TIME) Start transport replace', now);\r\n            Statistics.sendAnalytics(createJingleEvent(\r\n                ACTION_JINGLE_TR_RECEIVED,\r\n                {\r\n                    p2p: isP2P,\r\n                    value: now\r\n                }));\r\n\r\n            sess.replaceTransport($(iq).find('>jingle'), () => {\r\n                const successTime = window.performance.now();\r\n\r\n                logger.info('(TIME) Transport replace success!', successTime);\r\n                Statistics.sendAnalytics(createJingleEvent(\r\n                    ACTION_JINGLE_TR_SUCCESS,\r\n                    {\r\n                        p2p: isP2P,\r\n                        value: successTime\r\n                    }));\r\n            }, error => {\r\n                GlobalOnErrorHandler.callErrorHandler(error);\r\n                logger.error('Transport replace failed', error);\r\n                sess.sendTransportReject();\r\n            });\r\n            break;\r\n        case 'addsource': // FIXME: proprietary, un-jingleish\r\n        case 'source-add': // FIXME: proprietary\r\n            sess.addRemoteStream($(iq).find('>jingle>content'));\r\n            break;\r\n        case 'removesource': // FIXME: proprietary, un-jingleish\r\n        case 'source-remove': // FIXME: proprietary\r\n            sess.removeRemoteStream($(iq).find('>jingle>content'));\r\n            break;\r\n        default:\r\n            logger.warn('jingle action not implemented', action);\r\n            ack.attrs({ type: 'error' });\r\n            ack.c('error', { type: 'cancel' })\r\n                .c('bad-request',\r\n                    { xmlns: 'urn:ietf:params:xml:ns:xmpp-stanzas' })\r\n                .up();\r\n            break;\r\n        }\r\n        this.connection.send(ack);\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Creates new <tt>JingleSessionPC</tt> meant to be used in a direct P2P\r\n     * connection, configured as 'initiator'.\r\n     * @param {string} me our JID\r\n     * @param {string} peer remote participant's JID\r\n     * @return {JingleSessionPC}\r\n     */\r\n    newP2PJingleSession(me, peer) {\r\n        const sess\r\n            = new JingleSessionPC(\r\n                RandomUtil.randomHexString(12),\r\n                me,\r\n                peer,\r\n                this.connection,\r\n                this.mediaConstraints,\r\n                this.p2pIceConfig,\r\n                /* P2P */ true,\r\n                /* initiator */ true,\r\n                this.xmpp.options);\r\n\r\n        this.sessions[sess.sid] = sess;\r\n\r\n        return sess;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param sid\r\n     * @param reasonCondition\r\n     * @param reasonText\r\n     */\r\n    terminate(sid, reasonCondition, reasonText) {\r\n        if (this.sessions.hasOwnProperty(sid)) {\r\n            if (this.sessions[sid].state !== 'ended') {\r\n                this.sessions[sid].onTerminated(reasonCondition, reasonText);\r\n            }\r\n            delete this.sessions[sid];\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     */\r\n    getStunAndTurnCredentials() {\r\n        // get stun and turn configuration from server via xep-0215\r\n        // uses time-limited credentials as described in\r\n        // http://tools.ietf.org/html/draft-uberti-behave-turn-rest-00\r\n        //\r\n        // See https://code.google.com/p/prosody-modules/source/browse/\r\n        // mod_turncredentials/mod_turncredentials.lua\r\n        // for a prosody module which implements this.\r\n        //\r\n        // Currently, this doesn't work with updateIce and therefore credentials\r\n        // with a long validity have to be fetched before creating the\r\n        // peerconnection.\r\n        // TODO: implement refresh via updateIce as described in\r\n        //      https://code.google.com/p/webrtc/issues/detail?id=1650\r\n        this.connection.sendIQ(\r\n            $iq({ type: 'get',\r\n                to: this.connection.domain })\r\n                .c('services', { xmlns: 'urn:xmpp:extdisco:1' })\r\n                .c('service', { host: `turn.${this.connection.domain}` }),\r\n            res => {\r\n                const iceservers = [];\r\n\r\n                $(res).find('>services>service').each((idx, el) => {\r\n                    // eslint-disable-next-line no-param-reassign\r\n                    el = $(el);\r\n                    const dict = {};\r\n                    const type = el.attr('type');\r\n\r\n                    switch (type) {\r\n                    case 'stun':\r\n                        dict.url = `stun:${el.attr('host')}`;\r\n                        if (el.attr('port')) {\r\n                            dict.url += `:${el.attr('port')}`;\r\n                        }\r\n                        iceservers.push(dict);\r\n                        break;\r\n                    case 'turn':\r\n                    case 'turns': {\r\n                        dict.url = `${type}:`;\r\n                        const username = el.attr('username');\r\n\r\n                        // https://code.google.com/p/webrtc/issues/detail\r\n                        // ?id=1508\r\n\r\n                        if (username) {\r\n                            const match\r\n                                = navigator.userAgent.match(\r\n                                    /Chrom(e|ium)\\/([0-9]+)\\./);\r\n\r\n                            if (match && parseInt(match[2], 10) < 28) {\r\n                                dict.url += `${username}@`;\r\n                            } else {\r\n                                // only works in M28\r\n                                dict.username = username;\r\n                            }\r\n                        }\r\n                        dict.url += el.attr('host');\r\n                        const port = el.attr('port');\r\n\r\n                        if (port && port !== '3478') {\r\n                            dict.url += `:${el.attr('port')}`;\r\n                        }\r\n                        const transport = el.attr('transport');\r\n\r\n                        if (transport && transport !== 'udp') {\r\n                            dict.url += `?transport=${transport}`;\r\n                        }\r\n\r\n                        dict.credential = el.attr('password')\r\n                                || dict.credential;\r\n                        iceservers.push(dict);\r\n                        break;\r\n                    }\r\n                    }\r\n                });\r\n\r\n                const options = this.xmpp.options;\r\n\r\n                if (options.useStunTurn) {\r\n                    this.jvbIceConfig.iceServers = iceservers;\r\n                }\r\n\r\n                if (options.p2p && options.p2p.useStunTurn) {\r\n                    this.p2pIceConfig.iceServers = iceservers;\r\n                }\r\n\r\n            }, err => {\r\n                logger.warn('getting turn credentials failed', err);\r\n                logger.warn('is mod_turncredentials or similar installed?');\r\n            });\r\n\r\n        // implement push?\r\n    }\r\n\r\n    /**\r\n     * Returns the data saved in 'updateLog' in a format to be logged.\r\n     */\r\n    getLog() {\r\n        const data = {};\r\n\r\n        Object.keys(this.sessions).forEach(sid => {\r\n            const session = this.sessions[sid];\r\n            const pc = session.peerconnection;\r\n\r\n            if (pc && pc.updateLog) {\r\n                // FIXME: should probably be a .dump call\r\n                data[`jingle_${sid}`] = {\r\n                    updateLog: pc.updateLog,\r\n                    stats: pc.stats,\r\n                    url: window.location.href\r\n                };\r\n            }\r\n        });\r\n\r\n        return data;\r\n    }\r\n}\r\n\r\n/* eslint-enable newline-per-chained-call */\r\n\r\n/**\r\n *\r\n * @param XMPP\r\n * @param eventEmitter\r\n * @param iceConfig\r\n */\r\nexport default function initJingle(XMPP, eventEmitter, iceConfig) {\r\n    Strophe.addConnectionPlugin(\r\n        'jingle',\r\n        new JingleConnectionPlugin(XMPP, eventEmitter, iceConfig));\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/xmpp/strophe.jingle.js","/* global __filename, $ */\r\n\r\nimport {\r\n    ICE_DURATION,\r\n    ICE_STATE_CHANGED\r\n} from '../../service/statistics/AnalyticsEvents';\r\nimport async from 'async';\r\nimport { getLogger } from 'jitsi-meet-logger';\r\nimport { $iq, Strophe } from 'strophe.js';\r\nimport { integerHash } from '../util/StringUtils';\r\n\r\nimport JingleSession from './JingleSession';\r\nimport * as JingleSessionState from './JingleSessionState';\r\nimport SDP from './SDP';\r\nimport SDPDiffer from './SDPDiffer';\r\nimport SDPUtil from './SDPUtil';\r\nimport SignalingLayerImpl from './SignalingLayerImpl';\r\n\r\nimport Statistics from '../statistics/statistics';\r\nimport XMPPEvents from '../../service/xmpp/XMPPEvents';\r\nimport GlobalOnErrorHandler from '../util/GlobalOnErrorHandler';\r\n\r\nconst logger = getLogger(__filename);\r\n\r\n/**\r\n * Constant tells how long we're going to wait for IQ response, before timeout\r\n * error is  triggered.\r\n * @type {number}\r\n */\r\nconst IQ_TIMEOUT = 10000;\r\n\r\n/**\r\n *\r\n */\r\nexport default class JingleSessionPC extends JingleSession {\r\n    /**\r\n     * Parses 'senders' attribute of the video content.\r\n     * @param {jQuery} jingleContents\r\n     * @return {string|null} one of the values of content \"senders\" attribute\r\n     * defined by Jingle. If there is no \"senders\" attribute or if the value is\r\n     * invalid then <tt>null</tt> will be returned.\r\n     * @private\r\n     */\r\n    static parseVideoSenders(jingleContents) {\r\n        const videoContents = jingleContents.find('>content[name=\"video\"]');\r\n\r\n        if (videoContents.length) {\r\n            const senders = videoContents[0].getAttribute('senders');\r\n\r\n            if (senders === 'both'\r\n                || senders === 'initiator'\r\n                || senders === 'responder'\r\n                || senders === 'none') {\r\n                return senders;\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    /* eslint-disable max-params */\r\n\r\n    /**\r\n     * Creates new <tt>JingleSessionPC</tt>\r\n     * @param {string} sid the Jingle Session ID - random string which\r\n     * identifies the session\r\n     * @param {string} localJid our JID\r\n     * @param {string} remoteJid remote peer JID\r\n     * @param {Strophe.Connection} connection Strophe XMPP connection instance\r\n     * used to send packets.\r\n     * @param mediaConstraints the media constraints object passed to\r\n     * createOffer/Answer, as defined by the WebRTC standard\r\n     * @param iceConfig the ICE servers config object as defined by the WebRTC\r\n     * standard.\r\n     * @param {boolean} isP2P indicates whether this instance is\r\n     * meant to be used in a direct, peer to peer connection or <tt>false</tt>\r\n     * if it's a JVB connection.\r\n     * @param {boolean} isInitiator indicates whether or not we are the side\r\n     * which sends the 'session-initiate'.\r\n     * @param {object} options a set of config options\r\n     * @param {boolean} options.webrtcIceUdpDisable <tt>true</tt> to block UDP\r\n     * candidates.\r\n     * @param {boolean} options.webrtcIceTcpDisable <tt>true</tt> to block TCP\r\n     * candidates.\r\n     * @param {boolean} options.failICE it's an option used in the tests. Set to\r\n     * <tt>true</tt> to block any real candidates and make the ICE fail.\r\n     *\r\n     * @constructor\r\n     *\r\n     * @implements {SignalingLayer}\r\n     */\r\n    constructor(\r\n            sid,\r\n            localJid,\r\n            remoteJid,\r\n            connection,\r\n            mediaConstraints,\r\n            iceConfig,\r\n            isP2P,\r\n            isInitiator,\r\n            options) {\r\n        super(\r\n            sid, localJid, remoteJid, connection, mediaConstraints, iceConfig);\r\n\r\n        /**\r\n         * Stores result of {@link window.performance.now()} at the time when\r\n         * ICE enters 'checking' state.\r\n         * @type {number|null} null if no value has been stored yet\r\n         * @private\r\n         */\r\n        this._iceCheckingStartedTimestamp = null;\r\n\r\n        /**\r\n         * Stores result of {@link window.performance.now()} at the time when\r\n         * first ICE candidate is spawned by the peerconnection to mark when\r\n         * ICE gathering started. That's, because ICE gathering state changed\r\n         * events are not supported by most of the browsers, so we try something\r\n         * that will work everywhere. It may not be as accurate, but given that\r\n         * 'host' candidate usually comes first, the delay should be minimal.\r\n         * @type {number|null} null if no value has been stored yet\r\n         * @private\r\n         */\r\n        this._gatheringStartedTimestamp = null;\r\n\r\n        /**\r\n         * Indicates whether or not this session is willing to send/receive\r\n         * video media. When set to <tt>false</tt> the underlying peer\r\n         * connection will disable local video transfer and the remote peer will\r\n         * be will be asked to stop sending video via 'content-modify' IQ\r\n         * (the senders attribute of video contents will be adjusted\r\n         * accordingly). Note that this notification is sent only in P2P\r\n         * session, because Jicofo does not support it yet. Obviously when\r\n         * the value is changed from <tt>false</tt> to <tt>true</tt> another\r\n         * notification will be sent to resume video transfer on the remote\r\n         * side.\r\n         * @type {boolean}\r\n         * @private\r\n         */\r\n        this._localVideoActive = true;\r\n\r\n        /**\r\n         * Indicates whether or not the remote peer has video transfer active.\r\n         * When set to <tt>true</tt> it means that remote peer is neither\r\n         * sending nor willing to receive video. In such case we'll ask\r\n         * our peerconnection to stop sending video by calling\r\n         * {@link TraceablePeerConnection.setVideoTransferActive} with\r\n         * <tt>false</tt>.\r\n         * @type {boolean}\r\n         * @private\r\n         */\r\n        this._remoteVideoActive = true;\r\n\r\n        /**\r\n         * Marks that ICE gathering duration has been reported already. That\r\n         * prevents reporting it again, after eventual 'transport-replace' (JVB\r\n         * conference migration/ICE restart).\r\n         * @type {boolean}\r\n         * @private\r\n         */\r\n        this._gatheringReported = false;\r\n\r\n        this.lasticecandidate = false;\r\n        this.closed = false;\r\n\r\n        /**\r\n         * Indicates whether this instance is an initiator or an answerer of\r\n         * the Jingle session.\r\n         * @type {boolean}\r\n         */\r\n        this.isInitiator = isInitiator;\r\n\r\n        /**\r\n         * Indicates whether or not this <tt>JingleSessionPC</tt> is used in\r\n         * a peer to peer type of session.\r\n         * @type {boolean} <tt>true</tt> if it's a peer to peer\r\n         * session or <tt>false</tt> if it's a JVB session\r\n         */\r\n        this.isP2P = isP2P;\r\n\r\n        /**\r\n         * The signaling layer implementation.\r\n         * @type {SignalingLayerImpl}\r\n         */\r\n        this.signalingLayer = new SignalingLayerImpl();\r\n\r\n        this.webrtcIceUdpDisable = Boolean(options.webrtcIceUdpDisable);\r\n        this.webrtcIceTcpDisable = Boolean(options.webrtcIceTcpDisable);\r\n\r\n        /**\r\n         * Flag used to enforce ICE failure through the URL parameter for\r\n         * the automatic testing purpose.\r\n         * @type {boolean}\r\n         */\r\n        this.failICE = Boolean(options.failICE);\r\n\r\n        this.modificationQueue\r\n            = async.queue(this._processQueueTasks.bind(this), 1);\r\n\r\n        /**\r\n         * Flag used to guarantee that the connection established event is\r\n         * triggered just once.\r\n         * @type {boolean}\r\n         */\r\n        this.wasConnected = false;\r\n\r\n        /**\r\n         * Keeps track of how long (in ms) it took from ICE start to ICE\r\n         * connect.\r\n         *\r\n         * @type {number}\r\n         */\r\n        this.establishmentDuration = undefined;\r\n    }\r\n\r\n    /* eslint-enable max-params */\r\n\r\n    /**\r\n     * Checks whether or not this session instance has been ended and eventually\r\n     * logs a message which mentions that given <tt>actionName</tt> was\r\n     * cancelled.\r\n     * @param {string} actionName\r\n     * @return {boolean} <tt>true</tt> if this {@link JingleSessionPC} has\r\n     * entered {@link JingleSessionState.ENDED} or <tt>false</tt> otherwise.\r\n     * @private\r\n     */\r\n    _assertNotEnded(actionName) {\r\n        if (this.state === JingleSessionState.ENDED) {\r\n            logger.log(\r\n                `The session has ended - cancelling action: ${actionName}`);\r\n\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     *\r\n     */\r\n    doInitialize() {\r\n        this.lasticecandidate = false;\r\n\r\n        // True if reconnect is in progress\r\n        this.isReconnect = false;\r\n\r\n        // Set to true if the connection was ever stable\r\n        this.wasstable = false;\r\n\r\n        const pcOptions = { disableRtx: this.room.options.disableRtx };\r\n\r\n        if (this.isP2P) {\r\n            // simulcast needs to be disabled for P2P (121) calls\r\n            pcOptions.disableSimulcast = true;\r\n            pcOptions.disableH264\r\n                = this.room.options.p2p && this.room.options.p2p.disableH264;\r\n            pcOptions.preferH264\r\n                = this.room.options.p2p && this.room.options.p2p.preferH264;\r\n\r\n            const abtestSuspendVideo = this._abtestSuspendVideoEnabled();\r\n\r\n            if (typeof abtestSuspendVideo !== 'undefined') {\r\n                pcOptions.abtestSuspendVideo = abtestSuspendVideo;\r\n            }\r\n        } else {\r\n            // H264 does not support simulcast, so it needs to be disabled.\r\n            pcOptions.disableSimulcast\r\n                = this.room.options.disableSimulcast\r\n                    || (this.room.options.preferH264\r\n                            && !this.room.options.disableH264);\r\n            pcOptions.preferH264 = this.room.options.preferH264;\r\n            pcOptions.enableFirefoxSimulcast\r\n                = this.room.options.testing\r\n                    && this.room.options.testing.enableFirefoxSimulcast;\r\n        }\r\n\r\n        this.peerconnection\r\n            = this.rtc.createPeerConnection(\r\n                    this.signalingLayer,\r\n                    this.iceConfig,\r\n                    this.isP2P,\r\n                    pcOptions);\r\n\r\n        this.peerconnection.onicecandidate = ev => {\r\n            if (!ev) {\r\n                // There was an incomplete check for ev before which left\r\n                // the last line of the function unprotected from a potential\r\n                // throw of an exception. Consequently, it may be argued that\r\n                // the check is unnecessary. Anyway, I'm leaving it and making\r\n                // the check complete.\r\n                return;\r\n            }\r\n\r\n            // XXX this is broken, candidate is not parsed.\r\n            const candidate = ev.candidate;\r\n            const now = window.performance.now();\r\n\r\n            if (candidate) {\r\n                if (this._gatheringStartedTimestamp === null) {\r\n                    this._gatheringStartedTimestamp = now;\r\n                }\r\n\r\n                // Discard candidates of disabled protocols.\r\n                let protocol = candidate.protocol;\r\n\r\n                if (typeof protocol === 'string') {\r\n                    protocol = protocol.toLowerCase();\r\n                    if (protocol === 'tcp' || protocol === 'ssltcp') {\r\n                        if (this.webrtcIceTcpDisable) {\r\n                            return;\r\n                        }\r\n                    } else if (protocol === 'udp') {\r\n                        if (this.webrtcIceUdpDisable) {\r\n                            return;\r\n                        }\r\n                    }\r\n                }\r\n            } else if (!this._gatheringReported) {\r\n                // End of gathering\r\n                Statistics.sendAnalytics(\r\n                    ICE_DURATION,\r\n                    {\r\n                        phase: 'gathering',\r\n                        value: now - this._gatheringStartedTimestamp,\r\n                        p2p: this.isP2P,\r\n                        initiator: this.isInitiator\r\n                    });\r\n                this._gatheringReported = true;\r\n            }\r\n            this.sendIceCandidate(candidate);\r\n        };\r\n\r\n        // Note there is a change in the spec about closed:\r\n        // This value moved into the RTCPeerConnectionState enum in\r\n        // the May 13, 2016 draft of the specification, as it reflects the state\r\n        // of the RTCPeerConnection, not the signaling connection. You now\r\n        // detect a closed connection by checking for connectionState to be\r\n        // \"closed\" instead.\r\n        // I suppose at some point this will be moved to onconnectionstatechange\r\n        this.peerconnection.onsignalingstatechange = () => {\r\n            if (!this.peerconnection) {\r\n                return;\r\n            }\r\n            if (this.peerconnection.signalingState === 'stable') {\r\n                this.wasstable = true;\r\n            } else if (\r\n                (this.peerconnection.signalingState === 'closed'\r\n                || this.peerconnection.connectionState === 'closed')\r\n                && !this.closed) {\r\n                this.room.eventEmitter.emit(XMPPEvents.SUSPEND_DETECTED, this);\r\n            }\r\n        };\r\n\r\n        /**\r\n         * The oniceconnectionstatechange event handler contains the code to\r\n         * execute when the iceconnectionstatechange event, of type Event,\r\n         * is received by this RTCPeerConnection. Such an event is sent when\r\n         * the value of RTCPeerConnection.iceConnectionState changes.\r\n         */\r\n        this.peerconnection.oniceconnectionstatechange = () => {\r\n            if (!this.peerconnection\r\n                    || !this._assertNotEnded('oniceconnectionstatechange')) {\r\n                return;\r\n            }\r\n            const now = window.performance.now();\r\n\r\n            if (!this.isP2P) {\r\n                this.room.connectionTimes[\r\n                    `ice.state.${this.peerconnection.iceConnectionState}`]\r\n                    = now;\r\n            }\r\n            logger.log(\r\n                `(TIME) ICE ${this.peerconnection.iceConnectionState}`\r\n                    + ` P2P? ${this.isP2P}:\\t`,\r\n                now);\r\n\r\n            Statistics.sendAnalytics(\r\n                ICE_STATE_CHANGED,\r\n                {\r\n                    p2p: this.isP2P,\r\n                    state: this.peerconnection.iceConnectionState,\r\n                    'signaling_state': this.peerconnection.signalingState,\r\n                    reconnect: this.isReconnect,\r\n                    value: now\r\n                });\r\n\r\n            this.room.eventEmitter.emit(\r\n                XMPPEvents.ICE_CONNECTION_STATE_CHANGED,\r\n                this,\r\n                this.peerconnection.iceConnectionState);\r\n            switch (this.peerconnection.iceConnectionState) {\r\n            case 'checking':\r\n                this._iceCheckingStartedTimestamp = now;\r\n                break;\r\n            case 'connected':\r\n                // Informs interested parties that the connection has been\r\n                // restored.\r\n                if (this.peerconnection.signalingState === 'stable') {\r\n                    if (this.isReconnect) {\r\n                        this.room.eventEmitter.emit(\r\n                            XMPPEvents.CONNECTION_RESTORED, this);\r\n                    }\r\n                }\r\n\r\n                if (!this.wasConnected && this.wasstable) {\r\n\r\n                    Statistics.sendAnalytics(\r\n                        ICE_DURATION,\r\n                        {\r\n                            phase: 'checking',\r\n                            value: now - this._iceCheckingStartedTimestamp,\r\n                            p2p: this.isP2P,\r\n                            initiator: this.isInitiator\r\n                        });\r\n\r\n                    // Switch between ICE gathering and ICE checking whichever\r\n                    // started first (scenarios are different for initiator\r\n                    // vs responder)\r\n                    const iceStarted\r\n                        = Math.min(\r\n                            this._iceCheckingStartedTimestamp,\r\n                            this._gatheringStartedTimestamp);\r\n\r\n                    this.establishmentDuration = now - iceStarted;\r\n\r\n                    Statistics.sendAnalytics(\r\n                        ICE_DURATION,\r\n                        {\r\n                            phase: 'establishment',\r\n                            value: this.establishmentDuration,\r\n                            p2p: this.isP2P,\r\n                            initiator: this.isInitiator\r\n                        });\r\n\r\n                    this.wasConnected = true;\r\n                    this.room.eventEmitter.emit(\r\n                        XMPPEvents.CONNECTION_ESTABLISHED, this);\r\n                }\r\n                this.isReconnect = false;\r\n                break;\r\n            case 'disconnected':\r\n                if (this.closed) {\r\n                    break;\r\n                }\r\n                this.isReconnect = true;\r\n\r\n                // Informs interested parties that the connection has been\r\n                // interrupted.\r\n                if (this.wasstable) {\r\n                    this.room.eventEmitter.emit(\r\n                        XMPPEvents.CONNECTION_INTERRUPTED, this);\r\n                }\r\n                break;\r\n            case 'failed':\r\n                this.room.eventEmitter.emit(\r\n                    XMPPEvents.CONNECTION_ICE_FAILED, this);\r\n                this.room.eventEmitter.emit(\r\n                    XMPPEvents.CONFERENCE_SETUP_FAILED,\r\n                    this,\r\n                    new Error('ICE fail'));\r\n                break;\r\n            }\r\n        };\r\n        this.peerconnection.onnegotiationneeded = () => {\r\n            this.room.eventEmitter.emit(XMPPEvents.PEERCONNECTION_READY, this);\r\n        };\r\n\r\n        // The signaling layer will bind it's listeners at this point\r\n        this.signalingLayer.setChatRoom(this.room);\r\n    }\r\n\r\n    /**\r\n     * Sends given candidate in Jingle 'transport-info' message.\r\n     * @param {RTCIceCandidate} candidate the WebRTC ICE candidate instance\r\n     * @private\r\n     */\r\n    sendIceCandidate(candidate) {\r\n        const localSDP = new SDP(this.peerconnection.localDescription.sdp);\r\n\r\n        if (candidate && !this.lasticecandidate) {\r\n            const ice\r\n                = SDPUtil.iceparams(\r\n                    localSDP.media[candidate.sdpMLineIndex], localSDP.session);\r\n            const jcand = SDPUtil.candidateToJingle(candidate.candidate);\r\n\r\n            if (!(ice && jcand)) {\r\n                const errorMesssage = 'failed to get ice && jcand';\r\n\r\n                GlobalOnErrorHandler.callErrorHandler(new Error(errorMesssage));\r\n                logger.error(errorMesssage);\r\n\r\n                return;\r\n            }\r\n            ice.xmlns = 'urn:xmpp:jingle:transports:ice-udp:1';\r\n\r\n            if (this.usedrip) {\r\n                if (this.dripContainer.length === 0) {\r\n                    // start 20ms callout\r\n                    setTimeout(() => {\r\n                        if (this.dripContainer.length === 0) {\r\n                            return;\r\n                        }\r\n                        this.sendIceCandidates(this.dripContainer);\r\n                        this.dripContainer = [];\r\n                    }, 20);\r\n                }\r\n                this.dripContainer.push(candidate);\r\n            } else {\r\n                this.sendIceCandidates([ candidate ]);\r\n            }\r\n        } else {\r\n            logger.log('sendIceCandidate: last candidate.');\r\n\r\n            // FIXME: remember to re-think in ICE-restart\r\n            this.lasticecandidate = true;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Sends given candidates in Jingle 'transport-info' message.\r\n     * @param {Array<RTCIceCandidate>} candidates an array of the WebRTC ICE\r\n     * candidate instances\r\n     * @private\r\n     */\r\n    sendIceCandidates(candidates) {\r\n        if (!this._assertNotEnded('sendIceCandidates')) {\r\n\r\n            return;\r\n        }\r\n\r\n        logger.log('sendIceCandidates', candidates);\r\n        const cand = $iq({ to: this.remoteJid,\r\n            type: 'set' })\r\n            .c('jingle', { xmlns: 'urn:xmpp:jingle:1',\r\n                action: 'transport-info',\r\n                initiator: this.initiator,\r\n                sid: this.sid });\r\n\r\n        const localSDP = new SDP(this.peerconnection.localDescription.sdp);\r\n\r\n        for (let mid = 0; mid < localSDP.media.length; mid++) {\r\n            const cands = candidates.filter(el => el.sdpMLineIndex === mid);\r\n            const mline\r\n                = SDPUtil.parseMLine(localSDP.media[mid].split('\\r\\n')[0]);\r\n\r\n            if (cands.length > 0) {\r\n                const ice\r\n                    = SDPUtil.iceparams(localSDP.media[mid], localSDP.session);\r\n\r\n                ice.xmlns = 'urn:xmpp:jingle:transports:ice-udp:1';\r\n                cand.c('content', {\r\n                    creator: this.initiator === this.localJid\r\n                        ? 'initiator' : 'responder',\r\n                    name: cands[0].sdpMid ? cands[0].sdpMid : mline.media\r\n                }).c('transport', ice);\r\n                for (let i = 0; i < cands.length; i++) {\r\n                    const candidate\r\n                        = SDPUtil.candidateToJingle(cands[i].candidate);\r\n\r\n                    // Mangle ICE candidate if 'failICE' test option is enabled\r\n\r\n                    if (this.failICE) {\r\n                        candidate.ip = '1.1.1.1';\r\n                    }\r\n                    cand.c('candidate', candidate).up();\r\n                }\r\n\r\n                // add fingerprint\r\n                const fingerprintLine\r\n                    = SDPUtil.findLine(\r\n                        localSDP.media[mid],\r\n                        'a=fingerprint:', localSDP.session);\r\n\r\n                if (fingerprintLine) {\r\n                    const tmp = SDPUtil.parseFingerprint(fingerprintLine);\r\n\r\n                    tmp.required = true;\r\n                    cand.c(\r\n                        'fingerprint',\r\n                        { xmlns: 'urn:xmpp:jingle:apps:dtls:0' })\r\n                        .t(tmp.fingerprint);\r\n                    delete tmp.fingerprint;\r\n                    cand.attrs(tmp);\r\n                    cand.up();\r\n                }\r\n                cand.up(); // transport\r\n                cand.up(); // content\r\n            }\r\n        }\r\n\r\n        // might merge last-candidate notification into this, but it is called\r\n        // a lot later. See webrtc issue #2340\r\n        // logger.log('was this the last candidate', this.lasticecandidate);\r\n        this.connection.sendIQ(\r\n            cand, null, this.newJingleErrorHandler(cand), IQ_TIMEOUT);\r\n    }\r\n\r\n    /**\r\n     * {@inheritDoc}\r\n     */\r\n    addIceCandidates(elem) {\r\n        if (this.peerconnection.signalingState === 'closed') {\r\n            logger.warn('Ignored add ICE candidate when in closed state');\r\n\r\n            return;\r\n        }\r\n\r\n        const iceCandidates = [];\r\n\r\n        elem.find('>content>transport>candidate')\r\n            .each((idx, candidate) => {\r\n                let line = SDPUtil.candidateFromJingle(candidate);\r\n\r\n                line = line.replace('\\r\\n', '').replace('a=', '');\r\n\r\n                // FIXME this code does not care to handle\r\n                // non-bundle transport\r\n                const rtcCandidate = new RTCIceCandidate({\r\n                    sdpMLineIndex: 0,\r\n\r\n                    // FF comes up with more complex names like audio-23423,\r\n                    // Given that it works on both Chrome and FF without\r\n                    // providing it, let's leave it like this for the time\r\n                    // being...\r\n                    // sdpMid: 'audio',\r\n                    sdpMid: '',\r\n                    candidate: line\r\n                });\r\n\r\n                iceCandidates.push(rtcCandidate);\r\n            });\r\n\r\n        if (!iceCandidates.length) {\r\n            logger.error(\r\n                'No ICE candidates to add ?', elem[0] && elem[0].outerHTML);\r\n\r\n            return;\r\n        }\r\n\r\n        // We want to have this task queued, so that we know it is executed,\r\n        // after the initial sRD/sLD offer/answer cycle was done (based on\r\n        // the assumption that candidates are spawned after the offer/answer\r\n        // and XMPP preserves order).\r\n        const workFunction = finishedCallback => {\r\n            for (const iceCandidate of iceCandidates) {\r\n                this.peerconnection.addIceCandidate(\r\n                    iceCandidate,\r\n                    () => {\r\n                        logger.debug('addIceCandidate ok!');\r\n                    },\r\n                    error => {\r\n                        logger.error('addIceCandidate failed!', error);\r\n                    });\r\n            }\r\n\r\n            finishedCallback();\r\n        };\r\n\r\n        logger.debug(\r\n            `Queued add (${iceCandidates.length}) ICE candidates task...`);\r\n        this.modificationQueue.push(workFunction);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param contents\r\n     */\r\n    readSsrcInfo(contents) {\r\n        const ssrcs\r\n            = $(contents).find(\r\n                '>description>'\r\n                    + 'source[xmlns=\"urn:xmpp:jingle:apps:rtp:ssma:0\"]');\r\n\r\n        ssrcs.each((i, ssrcElement) => {\r\n            const ssrc = Number(ssrcElement.getAttribute('ssrc'));\r\n\r\n            if (this.isP2P) {\r\n                // In P2P all SSRCs are owner by the remote peer\r\n                this.signalingLayer.setSSRCOwner(\r\n                    ssrc, Strophe.getResourceFromJid(this.remoteJid));\r\n            } else {\r\n                $(ssrcElement)\r\n                    .find('>ssrc-info[xmlns=\"http://jitsi.org/jitmeet\"]')\r\n                    .each((i3, ssrcInfoElement) => {\r\n                        const owner = ssrcInfoElement.getAttribute('owner');\r\n\r\n                        if (owner && owner.length) {\r\n                            if (isNaN(ssrc) || ssrc < 0) {\r\n                                logger.warn(\r\n                                    `Invalid SSRC ${ssrc} value received`\r\n                                        + ` for ${owner}`);\r\n                            } else {\r\n                                this.signalingLayer.setSSRCOwner(\r\n                                    ssrc,\r\n                                    Strophe.getResourceFromJid(owner));\r\n                            }\r\n                        }\r\n                    });\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Makes the underlying TraceablePeerConnection generate new SSRC for\r\n     * the recvonly video stream.\r\n     * @deprecated\r\n     */\r\n    generateRecvonlySsrc() {\r\n        if (this.peerconnection) {\r\n            this.peerconnection.generateRecvonlySsrc();\r\n        } else {\r\n            logger.error(\r\n                'Unable to generate recvonly SSRC - no peerconnection');\r\n        }\r\n    }\r\n\r\n    /* eslint-disable max-params */\r\n    /**\r\n     * Accepts incoming Jingle 'session-initiate' and should send\r\n     * 'session-accept' in result.\r\n     * @param jingleOffer jQuery selector pointing to the jingle element of\r\n     * the offer IQ\r\n     * @param success callback called when we accept incoming session\r\n     * successfully and receive RESULT packet to 'session-accept' sent.\r\n     * @param failure function(error) called if for any reason we fail to accept\r\n     * the incoming offer. 'error' argument can be used to log some details\r\n     * about the error.\r\n     * @param {Array<JitsiLocalTrack>} [localTracks] the optional list of\r\n     * the local tracks that will be added, before the offer/answer cycle\r\n     * executes. We allow the localTracks to optionally be passed in so that\r\n     * the addition of the local tracks and the processing of the initial offer\r\n     * can all be done atomically. We want to make sure that any other\r\n     * operations which originate in the XMPP Jingle messages related with\r\n     * this session to be executed with an assumption that the initial\r\n     * offer/answer cycle has been executed already.\r\n     */\r\n    acceptOffer(jingleOffer, success, failure, localTracks) {\r\n        this.setOfferAnswerCycle(\r\n            jingleOffer,\r\n            () => {\r\n                // FIXME we may not care about RESULT packet for session-accept\r\n                // then we should either call 'success' here immediately or\r\n                // modify sendSessionAccept method to do that\r\n                this.sendSessionAccept(success, failure);\r\n            },\r\n            failure,\r\n            localTracks);\r\n    }\r\n\r\n    /* eslint-enable max-params */\r\n\r\n    /**\r\n     * Creates an offer and sends Jingle 'session-initiate' to the remote peer.\r\n     * @param {Array<JitsiLocalTrack>} localTracks the local tracks that will be\r\n     * added, before the offer/answer cycle executes (for the local track\r\n     * addition to be an atomic operation together with the offer/answer).\r\n     */\r\n    invite(localTracks) {\r\n        if (!this.isInitiator) {\r\n            throw new Error('Trying to invite from the responder session');\r\n        }\r\n        const workFunction = finishedCallback => {\r\n            for (const localTrack of localTracks) {\r\n                this.peerconnection.addTrack(localTrack);\r\n            }\r\n            this.peerconnection.createOffer(\r\n                offerSdp => {\r\n                    this.peerconnection.setLocalDescription(\r\n                        offerSdp,\r\n                        () => {\r\n                            // NOTE that the offer is obtained from\r\n                            // the localDescription getter as it needs to go\r\n                            // though the transformation chain.\r\n                            this.sendSessionInitiate(\r\n                                this.peerconnection.localDescription.sdp);\r\n                            finishedCallback();\r\n                        },\r\n                        error => {\r\n                            logger.error(\r\n                                'Failed to set local SDP', error, offerSdp);\r\n                            finishedCallback(error);\r\n                        });\r\n                },\r\n                error => {\r\n                    logger.error(\r\n                        'Failed to create an offer',\r\n                        error,\r\n                        this.mediaConstraints);\r\n                    finishedCallback(error);\r\n                },\r\n                this.mediaConstraints);\r\n        };\r\n\r\n        this.modificationQueue.push(\r\n            workFunction,\r\n            error => {\r\n                if (error) {\r\n                    logger.error('invite error', error);\r\n                } else {\r\n                    logger.debug('invite executed - OK');\r\n                }\r\n            });\r\n    }\r\n\r\n    /**\r\n     * Sends 'session-initiate' to the remote peer.\r\n     *\r\n     * NOTE this method is synchronous and we're not waiting for the RESULT\r\n     * response which would delay the startup process.\r\n     *\r\n     * @param {string} offerSdp  - The local session description which will be\r\n     * used to generate an offer.\r\n     * @private\r\n     */\r\n    sendSessionInitiate(offerSdp) {\r\n        let init = $iq({\r\n            to: this.remoteJid,\r\n            type: 'set'\r\n        }).c('jingle', {\r\n            xmlns: 'urn:xmpp:jingle:1',\r\n            action: 'session-initiate',\r\n            initiator: this.initiator,\r\n            sid: this.sid\r\n        });\r\n\r\n        new SDP(offerSdp).toJingle(\r\n            init,\r\n            this.initiator === this.me ? 'initiator' : 'responder');\r\n        init = init.tree();\r\n        logger.info('Session-initiate: ', init);\r\n        this.connection.sendIQ(init,\r\n            () => {\r\n                logger.info('Got RESULT for \"session-initiate\"');\r\n            },\r\n            error => {\r\n                logger.error('\"session-initiate\" error', error);\r\n            },\r\n            IQ_TIMEOUT);\r\n    }\r\n\r\n    /**\r\n     * Sets the answer received from the remote peer.\r\n     * @param jingleAnswer\r\n     */\r\n    setAnswer(jingleAnswer) {\r\n        if (!this.isInitiator) {\r\n            throw new Error('Trying to set an answer on the responder session');\r\n        }\r\n        this.setOfferAnswerCycle(\r\n            jingleAnswer,\r\n            () => {\r\n                logger.info('setAnswer - succeeded');\r\n            },\r\n            error => {\r\n                logger.error('setAnswer failed: ', error);\r\n            });\r\n    }\r\n\r\n    /* eslint-disable max-params */\r\n    /**\r\n     * This is a setRemoteDescription/setLocalDescription cycle which starts at\r\n     * converting Strophe Jingle IQ into remote offer SDP. Once converted\r\n     * setRemoteDescription, createAnswer and setLocalDescription calls follow.\r\n     * @param jingleOfferAnswerIq jQuery selector pointing to the jingle element\r\n     *        of the offer (or answer) IQ\r\n     * @param success callback called when sRD/sLD cycle finishes successfully.\r\n     * @param failure callback called with an error object as an argument if we\r\n     *        fail at any point during setRD, createAnswer, setLD.\r\n     * @param {Array<JitsiLocalTrack>} [localTracks] the optional list of\r\n     * the local tracks that will be added, before the offer/answer cycle\r\n     * executes (for the local track addition to be an atomic operation together\r\n     * with the offer/answer).\r\n     */\r\n    setOfferAnswerCycle(jingleOfferAnswerIq, success, failure, localTracks) {\r\n        const workFunction = finishedCallback => {\r\n\r\n            if (localTracks) {\r\n                for (const track of localTracks) {\r\n                    this.peerconnection.addTrack(track);\r\n                }\r\n            }\r\n\r\n            const newRemoteSdp\r\n                = this._processNewJingleOfferIq(jingleOfferAnswerIq);\r\n            const oldLocalSdp\r\n                = this.peerconnection.localDescription.sdp;\r\n\r\n            this._renegotiate(newRemoteSdp.raw)\r\n                .then(() => {\r\n                    if (this.state === JingleSessionState.PENDING) {\r\n                        this.state = JingleSessionState.ACTIVE;\r\n\r\n                        // Sync up video transfer active/inactive only after\r\n                        // the initial O/A cycle. We want to adjust the video\r\n                        // media direction only in the local SDP and the Jingle\r\n                        // contents direction included in the initial\r\n                        // offer/answer is mapped to the remote SDP. Jingle\r\n                        // 'content-modify' IQ is processed in a way that it\r\n                        // will only modify local SDP when remote peer is no\r\n                        // longer interested in receiving video content.\r\n                        // Changing media direction in the remote SDP will mess\r\n                        // up our SDP translation chain (simulcast, video mute,\r\n                        // RTX etc.)\r\n                        if (this.isP2P && !this._localVideoActive) {\r\n                            this.sendContentModify(this._localVideoActive);\r\n                        }\r\n                    }\r\n\r\n                    // Old local SDP will be available when we're setting answer\r\n                    // for the first time, but not when offer and it's fine\r\n                    // since we're generating an answer now it will contain all\r\n                    // our SSRCs\r\n                    if (oldLocalSdp) {\r\n                        const newLocalSdp\r\n                            = new SDP(this.peerconnection.localDescription.sdp);\r\n\r\n                        this.notifyMySSRCUpdate(\r\n                            new SDP(oldLocalSdp), newLocalSdp);\r\n                    }\r\n\r\n                    finishedCallback();\r\n                }, error => {\r\n                    logger.error(\r\n                        `Error renegotiating after setting new remote ${\r\n                            this.isInitiator ? 'answer: ' : 'offer: '}${error}`,\r\n                        newRemoteSdp);\r\n                    JingleSessionPC.onJingleFatalError(this, error);\r\n                    finishedCallback(error);\r\n                });\r\n        };\r\n\r\n        this.modificationQueue.push(\r\n            workFunction,\r\n            error => {\r\n                error ? failure(error) : success();\r\n            });\r\n    }\r\n\r\n    /* eslint-enable max-params */\r\n\r\n    /**\r\n     * Although it states \"replace transport\" it does accept full Jingle offer\r\n     * which should contain new ICE transport details.\r\n     * @param jingleOfferElem an element Jingle IQ that contains new offer and\r\n     *        transport info.\r\n     * @param success callback called when we succeed to accept new offer.\r\n     * @param failure function(error) called when we fail to accept new offer.\r\n     */\r\n    replaceTransport(jingleOfferElem, success, failure) {\r\n\r\n        // We need to first set an offer without the 'data' section to have the\r\n        // SCTP stack cleaned up. After that the original offer is set to have\r\n        // the SCTP connection established with the new bridge.\r\n        this.room.eventEmitter.emit(XMPPEvents.ICE_RESTARTING, this);\r\n        const originalOffer = jingleOfferElem.clone();\r\n\r\n        jingleOfferElem.find('>content[name=\\'data\\']').remove();\r\n\r\n        // First set an offer without the 'data' section\r\n        this.setOfferAnswerCycle(\r\n            jingleOfferElem,\r\n            () => {\r\n                // Now set the original offer(with the 'data' section)\r\n                this.setOfferAnswerCycle(\r\n                    originalOffer,\r\n                    () => {\r\n                        const localSDP\r\n                            = new SDP(this.peerconnection.localDescription.sdp);\r\n\r\n                        this.sendTransportAccept(localSDP, success, failure);\r\n                    },\r\n                    failure);\r\n            },\r\n            failure\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Sends Jingle 'session-accept' message.\r\n     * @param {function()} success callback called when we receive 'RESULT'\r\n     *        packet for the 'session-accept'\r\n     * @param {function(error)} failure called when we receive an error response\r\n     *        or when the request has timed out.\r\n     * @private\r\n     */\r\n    sendSessionAccept(success, failure) {\r\n        // NOTE: since we're just reading from it, we don't need to be within\r\n        //  the modification queue to access the local description\r\n        const localSDP = new SDP(this.peerconnection.localDescription.sdp);\r\n        let accept = $iq({ to: this.remoteJid,\r\n            type: 'set' })\r\n            .c('jingle', { xmlns: 'urn:xmpp:jingle:1',\r\n                action: 'session-accept',\r\n                initiator: this.initiator,\r\n                responder: this.responder,\r\n                sid: this.sid });\r\n\r\n        if (this.webrtcIceTcpDisable) {\r\n            localSDP.removeTcpCandidates = true;\r\n        }\r\n        if (this.webrtcIceUdpDisable) {\r\n            localSDP.removeUdpCandidates = true;\r\n        }\r\n        if (this.failICE) {\r\n            localSDP.failICE = true;\r\n        }\r\n        localSDP.toJingle(\r\n            accept,\r\n            this.initiator === this.localJid ? 'initiator' : 'responder',\r\n            null);\r\n\r\n        // Calling tree() to print something useful\r\n        accept = accept.tree();\r\n        logger.info('Sending session-accept', accept);\r\n        this.connection.sendIQ(accept,\r\n            success,\r\n            this.newJingleErrorHandler(accept, error => {\r\n                failure(error);\r\n\r\n                // 'session-accept' is a critical timeout and we'll\r\n                // have to restart\r\n                this.room.eventEmitter.emit(\r\n                    XMPPEvents.SESSION_ACCEPT_TIMEOUT, this);\r\n            }),\r\n            IQ_TIMEOUT);\r\n\r\n        // XXX Videobridge needs WebRTC's answer (ICE ufrag and pwd, DTLS\r\n        // fingerprint and setup) ASAP in order to start the connection\r\n        // establishment.\r\n        //\r\n        // FIXME Flushing the connection at this point triggers an issue with\r\n        // BOSH request handling in Prosody on slow connections.\r\n        //\r\n        // The problem is that this request will be quite large and it may take\r\n        // time before it reaches Prosody. In the meantime Strophe may decide\r\n        // to send the next one. And it was observed that a small request with\r\n        // 'transport-info' usually follows this one. It does reach Prosody\r\n        // before the previous one was completely received. 'rid' on the server\r\n        // is increased and Prosody ignores the request with 'session-accept'.\r\n        // It will never reach Jicofo and everything in the request table is\r\n        // lost. Removing the flush does not guarantee it will never happen, but\r\n        // makes it much less likely('transport-info' is bundled with\r\n        // 'session-accept' and any immediate requests).\r\n        //\r\n        // this.connection.flush();\r\n    }\r\n\r\n    /**\r\n     * Will send 'content-modify' IQ in order to ask the remote peer to\r\n     * either stop or resume sending video media.\r\n     * @param {boolean} videoTransferActive <tt>false</tt> to let the other peer\r\n     * know that we're not sending nor interested in receiving video contents.\r\n     * When set to <tt>true</tt> remote peer will be asked to resume video\r\n     * transfer.\r\n     * @private\r\n     */\r\n    sendContentModify(videoTransferActive) {\r\n        const newSendersValue = videoTransferActive ? 'both' : 'none';\r\n\r\n        const sessionModify\r\n            = $iq({\r\n                to: this.remoteJid,\r\n                type: 'set'\r\n            })\r\n                .c('jingle', {\r\n                    xmlns: 'urn:xmpp:jingle:1',\r\n                    action: 'content-modify',\r\n                    initiator: this.initiator,\r\n                    sid: this.sid\r\n                })\r\n                .c('content', {\r\n                    name: 'video',\r\n                    senders: newSendersValue\r\n                });\r\n\r\n        logger.info(\r\n            `Sending content-modify, video senders: ${newSendersValue}`);\r\n\r\n        this.connection.sendIQ(\r\n            sessionModify,\r\n            null,\r\n            this.newJingleErrorHandler(sessionModify),\r\n            IQ_TIMEOUT);\r\n    }\r\n\r\n    /**\r\n     * Sends Jingle 'transport-accept' message which is a response to\r\n     * 'transport-replace'.\r\n     * @param localSDP the 'SDP' object with local session description\r\n     * @param success callback called when we receive 'RESULT' packet for\r\n     *        'transport-replace'\r\n     * @param failure function(error) called when we receive an error response\r\n     *        or when the request has timed out.\r\n     * @private\r\n     */\r\n    sendTransportAccept(localSDP, success, failure) {\r\n        let transportAccept = $iq({ to: this.remoteJid,\r\n            type: 'set' })\r\n            .c('jingle', {\r\n                xmlns: 'urn:xmpp:jingle:1',\r\n                action: 'transport-accept',\r\n                initiator: this.initiator,\r\n                sid: this.sid\r\n            });\r\n\r\n        localSDP.media.forEach((medialines, idx) => {\r\n            const mline = SDPUtil.parseMLine(medialines.split('\\r\\n')[0]);\r\n\r\n            transportAccept.c('content',\r\n                {\r\n                    creator:\r\n                        this.initiator === this.localJid\r\n                            ? 'initiator'\r\n                            : 'responder',\r\n                    name: mline.media\r\n                }\r\n            );\r\n            localSDP.transportToJingle(idx, transportAccept);\r\n            transportAccept.up();\r\n        });\r\n\r\n        // Calling tree() to print something useful to the logger\r\n        transportAccept = transportAccept.tree();\r\n        logger.info('Sending transport-accept: ', transportAccept);\r\n\r\n        this.connection.sendIQ(transportAccept,\r\n            success,\r\n            this.newJingleErrorHandler(transportAccept, failure),\r\n            IQ_TIMEOUT);\r\n    }\r\n\r\n    /**\r\n     * Sends Jingle 'transport-reject' message which is a response to\r\n     * 'transport-replace'.\r\n     * @param success callback called when we receive 'RESULT' packet for\r\n     *        'transport-replace'\r\n     * @param failure function(error) called when we receive an error response\r\n     *        or when the request has timed out.\r\n     *\r\n     * FIXME method should be marked as private, but there's some spaghetti that\r\n     *       needs to be fixed prior doing that\r\n     */\r\n    sendTransportReject(success, failure) {\r\n        // Send 'transport-reject', so that the focus will\r\n        // know that we've failed\r\n        let transportReject = $iq({ to: this.remoteJid,\r\n            type: 'set' })\r\n            .c('jingle', {\r\n                xmlns: 'urn:xmpp:jingle:1',\r\n                action: 'transport-reject',\r\n                initiator: this.initiator,\r\n                sid: this.sid\r\n            });\r\n\r\n        transportReject = transportReject.tree();\r\n        logger.info('Sending \\'transport-reject', transportReject);\r\n\r\n        this.connection.sendIQ(transportReject,\r\n            success,\r\n            this.newJingleErrorHandler(transportReject, failure),\r\n            IQ_TIMEOUT);\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     */\r\n    terminate(success, failure, options) {\r\n        if (this.state === JingleSessionState.ENDED) {\r\n            return;\r\n        }\r\n\r\n        if (!options || Boolean(options.sendSessionTerminate)) {\r\n            let sessionTerminate\r\n                = $iq({\r\n                    to: this.remoteJid,\r\n                    type: 'set'\r\n                })\r\n                    .c('jingle', {\r\n                        xmlns: 'urn:xmpp:jingle:1',\r\n                        action: 'session-terminate',\r\n                        initiator: this.initiator,\r\n                        sid: this.sid\r\n                    })\r\n                    .c('reason')\r\n                    .c((options && options.reason) || 'success');\r\n\r\n            if (options && options.reasonDescription) {\r\n                sessionTerminate.up()\r\n                    .c('text')\r\n                    .t(options.reasonDescription);\r\n            }\r\n\r\n            // Calling tree() to print something useful\r\n            sessionTerminate = sessionTerminate.tree();\r\n            logger.info('Sending session-terminate', sessionTerminate);\r\n            this.connection.sendIQ(\r\n                sessionTerminate,\r\n                success,\r\n                this.newJingleErrorHandler(sessionTerminate, failure),\r\n                IQ_TIMEOUT);\r\n        } else {\r\n            logger.info(`Skipped sending session-terminate for ${this}`);\r\n        }\r\n\r\n        // this should result in 'onTerminated' being called by strope.jingle.js\r\n        this.connection.jingle.terminate(this.sid);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param reasonCondition\r\n     * @param reasonText\r\n     */\r\n    onTerminated(reasonCondition, reasonText) {\r\n        this.state = JingleSessionState.ENDED;\r\n        this.establishmentDuration = undefined;\r\n\r\n        // Do something with reason and reasonCondition when we start to care\r\n        // this.reasonCondition = reasonCondition;\r\n        // this.reasonText = reasonText;\r\n        logger.info(`Session terminated ${this}`, reasonCondition, reasonText);\r\n\r\n        this.close();\r\n    }\r\n\r\n    /**\r\n     * Parse the information from the xml sourceAddElem and translate it\r\n     *  into sdp lines\r\n     * @param {jquery xml element} sourceAddElem the source-add\r\n     *  element from jingle\r\n     * @param {SDP object} currentRemoteSdp the current remote\r\n     *  sdp (as of this new source-add)\r\n     * @returns {list} a list of SDP line strings that should\r\n     *  be added to the remote SDP\r\n     */\r\n    _parseSsrcInfoFromSourceAdd(sourceAddElem, currentRemoteSdp) {\r\n        const addSsrcInfo = [];\r\n\r\n        $(sourceAddElem).each((i1, content) => {\r\n            const name = $(content).attr('name');\r\n            let lines = '';\r\n\r\n            $(content)\r\n                .find('ssrc-group[xmlns=\"urn:xmpp:jingle:apps:rtp:ssma:0\"]')\r\n                .each(function() {\r\n                    // eslint-disable-next-line no-invalid-this\r\n                    const semantics = this.getAttribute('semantics');\r\n                    const ssrcs\r\n                        = $(this) // eslint-disable-line no-invalid-this\r\n                            .find('>source')\r\n                            .map(function() {\r\n                                // eslint-disable-next-line no-invalid-this\r\n                                return this.getAttribute('ssrc');\r\n                            })\r\n                            .get();\r\n\r\n                    if (ssrcs.length) {\r\n                        lines\r\n                            += `a=ssrc-group:${semantics} ${\r\n                                ssrcs.join(' ')}\\r\\n`;\r\n                    }\r\n                });\r\n\r\n            // handles both >source and >description>source\r\n            const tmp\r\n                = $(content).find(\r\n                    'source[xmlns=\"urn:xmpp:jingle:apps:rtp:ssma:0\"]');\r\n\r\n            /* eslint-disable no-invalid-this */\r\n            tmp.each(function() {\r\n                const ssrc = $(this).attr('ssrc');\r\n\r\n                if (currentRemoteSdp.containsSSRC(ssrc)) {\r\n                    logger.warn(\r\n                        `Source-add request for existing SSRC: ${ssrc}`);\r\n\r\n                    return;\r\n                }\r\n\r\n                // eslint-disable-next-line newline-per-chained-call\r\n                $(this).find('>parameter').each(function() {\r\n                    lines += `a=ssrc:${ssrc} ${$(this).attr('name')}`;\r\n                    if ($(this).attr('value') && $(this).attr('value').length) {\r\n                        lines += `:${$(this).attr('value')}`;\r\n                    }\r\n                    lines += '\\r\\n';\r\n                });\r\n            });\r\n\r\n            /* eslint-enable no-invalid-this */\r\n            currentRemoteSdp.media.forEach((media, i2) => {\r\n                if (!SDPUtil.findLine(media, `a=mid:${name}`)) {\r\n                    return;\r\n                }\r\n                if (!addSsrcInfo[i2]) {\r\n                    addSsrcInfo[i2] = '';\r\n                }\r\n                addSsrcInfo[i2] += lines;\r\n            });\r\n        });\r\n\r\n        return addSsrcInfo;\r\n    }\r\n\r\n    /**\r\n     * Handles a Jingle source-add message for this Jingle session.\r\n     * @param elem An array of Jingle \"content\" elements.\r\n     */\r\n    addRemoteStream(elem) {\r\n        this._addOrRemoveRemoteStream(true /* add */, elem);\r\n    }\r\n\r\n    /**\r\n     * Handles a Jingle source-remove message for this Jingle session.\r\n     * @param elem An array of Jingle \"content\" elements.\r\n     */\r\n    removeRemoteStream(elem) {\r\n        this._addOrRemoveRemoteStream(false /* remove */, elem);\r\n    }\r\n\r\n    /**\r\n     * Handles either Jingle 'source-add' or 'source-remove' message for this\r\n     * Jingle session.\r\n     * @param {boolean} isAdd <tt>true</tt> for 'source-add' or <tt>false</tt>\r\n     * otherwise.\r\n     * @param {Array<Element>} elem an array of Jingle \"content\" elements.\r\n     * @private\r\n     */\r\n    _addOrRemoveRemoteStream(isAdd, elem) {\r\n        const logPrefix = isAdd ? 'addRemoteStream' : 'removeRemoteStream';\r\n\r\n        if (isAdd) {\r\n            this.readSsrcInfo(elem);\r\n        }\r\n\r\n        const workFunction = finishedCallback => {\r\n            if (!this.peerconnection.localDescription\r\n                || !this.peerconnection.localDescription.sdp) {\r\n                const errMsg = `${logPrefix} - localDescription not ready yet`;\r\n\r\n                logger.error(errMsg);\r\n                finishedCallback(errMsg);\r\n\r\n                return;\r\n            }\r\n\r\n            logger.log(`Processing ${logPrefix}`);\r\n            logger.log(\r\n                'ICE connection state: ',\r\n                this.peerconnection.iceConnectionState);\r\n\r\n            const oldLocalSdp\r\n                = new SDP(this.peerconnection.localDescription.sdp);\r\n            const sdp = new SDP(this.peerconnection.remoteDescription.sdp);\r\n            const addOrRemoveSsrcInfo\r\n                = isAdd\r\n                    ? this._parseSsrcInfoFromSourceAdd(elem, sdp)\r\n                    : this._parseSsrcInfoFromSourceRemove(elem, sdp);\r\n            const newRemoteSdp\r\n                = isAdd\r\n                    ? this._processRemoteAddSource(addOrRemoveSsrcInfo)\r\n                    : this._processRemoteRemoveSource(addOrRemoveSsrcInfo);\r\n\r\n            this._renegotiate(newRemoteSdp.raw)\r\n                .then(() => {\r\n                    const newLocalSdp\r\n                        = new SDP(this.peerconnection.localDescription.sdp);\r\n\r\n                    logger.log(\r\n                        `${logPrefix} - OK, SDPs: `, oldLocalSdp, newLocalSdp);\r\n                    this.notifyMySSRCUpdate(oldLocalSdp, newLocalSdp);\r\n                    finishedCallback();\r\n                }, error => {\r\n                    logger.error(`${logPrefix} failed:`, error);\r\n                    finishedCallback(error);\r\n                });\r\n        };\r\n\r\n        // Queue and execute\r\n        this.modificationQueue.push(workFunction);\r\n    }\r\n\r\n    /**\r\n     * The 'task' function will be given a callback it MUST call with either:\r\n     *  1) No arguments if it was successful or\r\n     *  2) An error argument if there was an error\r\n     * If the task wants to process the success or failure of the task, it\r\n     * should pass a handler to the .push function, e.g.:\r\n     * queue.push(task, (err) => {\r\n     *     if (err) {\r\n     *         // error handling\r\n     *     } else {\r\n     *         // success handling\r\n     *     }\r\n     * });\r\n     */\r\n    _processQueueTasks(task, finishedCallback) {\r\n        task(finishedCallback);\r\n    }\r\n\r\n    /**\r\n     * Takes in a jingle offer iq, returns the new sdp offer\r\n     * @param {jquery xml element} offerIq the incoming offer\r\n     * @returns {SDP object} the jingle offer translated to SDP\r\n     */\r\n    _processNewJingleOfferIq(offerIq) {\r\n        const remoteSdp = new SDP('');\r\n\r\n        if (this.webrtcIceTcpDisable) {\r\n            remoteSdp.removeTcpCandidates = true;\r\n        }\r\n        if (this.webrtcIceUdpDisable) {\r\n            remoteSdp.removeUdpCandidates = true;\r\n        }\r\n        if (this.failICE) {\r\n            remoteSdp.failICE = true;\r\n        }\r\n\r\n        remoteSdp.fromJingle(offerIq);\r\n        this.readSsrcInfo($(offerIq).find('>content'));\r\n\r\n        return remoteSdp;\r\n    }\r\n\r\n    /**\r\n     * Remove the given ssrc lines from the current remote sdp\r\n     * @param {list} removeSsrcInfo a list of SDP line strings that\r\n     *  should be removed from the remote SDP\r\n     * @returns type {SDP Object} the new remote SDP (after removing the lines\r\n     *  in removeSsrcInfo\r\n     */\r\n    _processRemoteRemoveSource(removeSsrcInfo) {\r\n        const remoteSdp = new SDP(this.peerconnection.remoteDescription.sdp);\r\n\r\n        removeSsrcInfo.forEach((lines, idx) => {\r\n            // eslint-disable-next-line no-param-reassign\r\n            lines = lines.split('\\r\\n');\r\n            lines.pop(); // remove empty last element;\r\n            lines.forEach(line => {\r\n                remoteSdp.media[idx]\r\n                    = remoteSdp.media[idx].replace(`${line}\\r\\n`, '');\r\n            });\r\n        });\r\n        remoteSdp.raw = remoteSdp.session + remoteSdp.media.join('');\r\n\r\n        return remoteSdp;\r\n    }\r\n\r\n    /**\r\n     * Add the given ssrc lines to the current remote sdp\r\n     * @param {list} addSsrcInfo a list of SDP line strings that\r\n     *  should be added to the remote SDP\r\n     * @returns type {SDP Object} the new remote SDP (after removing the lines\r\n     *  in removeSsrcInfo\r\n     */\r\n    _processRemoteAddSource(addSsrcInfo) {\r\n        const remoteSdp = new SDP(this.peerconnection.remoteDescription.sdp);\r\n\r\n        addSsrcInfo.forEach((lines, idx) => {\r\n            remoteSdp.media[idx] += lines;\r\n        });\r\n        remoteSdp.raw = remoteSdp.session + remoteSdp.media.join('');\r\n\r\n        return remoteSdp;\r\n    }\r\n\r\n    /**\r\n     * Do a new o/a flow using the existing remote description\r\n     * @param {string} [optionalRemoteSdp] optional, raw remote sdp\r\n     *  to use.  If not provided, the remote sdp from the\r\n     *  peerconnection will be used\r\n     * @returns {Promise} promise which resolves when the\r\n     *  o/a flow is complete with no arguments or\r\n     *  rejects with an error {string}\r\n     */\r\n    _renegotiate(optionalRemoteSdp) {\r\n        const remoteSdp\r\n            = optionalRemoteSdp || this.peerconnection.remoteDescription.sdp;\r\n\r\n        if (!remoteSdp) {\r\n            return Promise.reject(\r\n                'Can not renegotiate without remote description,'\r\n                    + `- current state: ${this.state}`);\r\n        }\r\n\r\n        const remoteDescription = new RTCSessionDescription({\r\n            type: this.isInitiator ? 'answer' : 'offer',\r\n            sdp: remoteSdp\r\n        });\r\n\r\n        return new Promise((resolve, reject) => {\r\n            if (this.peerconnection.signalingState === 'closed') {\r\n                reject('Attempted to renegotiate in state closed');\r\n\r\n                return;\r\n            }\r\n            if (this.isInitiator) {\r\n                this._initiatorRenegotiate(remoteDescription, resolve, reject);\r\n            } else {\r\n                this._responderRenegotiate(remoteDescription, resolve, reject);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Renegotiate cycle implementation for the responder case.\r\n     * @param {object} remoteDescription the SDP object as defined by the WebRTC\r\n     * which will be used as remote description in the cycle.\r\n     * @param {function} resolve the success callback\r\n     * @param {function} reject the failure callback\r\n     * @private\r\n     */\r\n    _responderRenegotiate(remoteDescription, resolve, reject) {\r\n        // FIXME use WebRTC promise API to simplify things\r\n        logger.debug('Renegotiate: setting remote description');\r\n        this.peerconnection.setRemoteDescription(\r\n            remoteDescription,\r\n            () => {\r\n                logger.debug('Renegotiate: creating answer');\r\n                this.peerconnection.createAnswer(\r\n                    answer => {\r\n                        logger.debug('Renegotiate: setting local description');\r\n                        this.peerconnection.setLocalDescription(\r\n                            answer,\r\n                            () => {\r\n                                resolve();\r\n                            },\r\n                            error => {\r\n                                reject(\r\n                                    `setLocalDescription failed: ${error}`);\r\n                            }\r\n                        );\r\n                    },\r\n                    error => reject(`createAnswer failed: ${error}`),\r\n                    this.mediaConstraints\r\n                );\r\n            },\r\n            error => reject(`setRemoteDescription failed: ${error}`)\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Renegotiate cycle implementation for the initiator's case.\r\n     * @param {object} remoteDescription the SDP object as defined by the WebRTC\r\n     * which will be used as remote description in the cycle.\r\n     * @param {function} resolve the success callback\r\n     * @param {function} reject the failure callback\r\n     * @private\r\n     */\r\n    _initiatorRenegotiate(remoteDescription, resolve, reject) {\r\n        // FIXME use WebRTC promise API to simplify things\r\n        if (this.peerconnection.signalingState === 'have-local-offer') {\r\n\r\n            // Skip createOffer and setLocalDescription or FF will fail\r\n            logger.debug(\r\n                'Renegotiate: setting remote description');\r\n            this.peerconnection.setRemoteDescription(\r\n                remoteDescription,\r\n                () => {\r\n                    // In case when the answer is being set for the first time,\r\n                    // full sRD/sLD cycle is required to have the local\r\n                    // description updated and SSRCs synchronized correctly.\r\n                    // Otherwise SSRCs for streams added after invite, but\r\n                    // before the answer was accepted will not be detected.\r\n                    // The reason for that is that renegotiate can not be called\r\n                    // when adding tracks and they will not be reflected in\r\n                    // the local SDP.\r\n                    this._initiatorRenegotiate(\r\n                        remoteDescription, resolve, reject);\r\n                },\r\n                error => reject(`setRemoteDescription failed: ${error}`)\r\n            );\r\n        } else {\r\n            logger.debug('Renegotiate: creating offer');\r\n            this.peerconnection.createOffer(\r\n                offer => {\r\n                    logger.debug('Renegotiate: setting local description');\r\n                    this.peerconnection.setLocalDescription(offer,\r\n                        () => {\r\n                            logger.debug(\r\n                                'Renegotiate: setting remote description');\r\n                            this.peerconnection.setRemoteDescription(\r\n                                remoteDescription,\r\n                                () => {\r\n                                    resolve();\r\n                                },\r\n                                error => reject(\r\n                                    `setRemoteDescription failed: ${error}`)\r\n                            );\r\n                        },\r\n                        error => {\r\n                            reject('setLocalDescription failed: ', error);\r\n                        });\r\n                },\r\n                error => reject(`createOffer failed: ${error}`),\r\n                this.mediaConstraints);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Replaces <tt>oldTrack</tt> with <tt>newTrack</tt> and performs a single\r\n     * offer/answer cycle after both operations are done. Either\r\n     * <tt>oldTrack</tt> or <tt>newTrack</tt> can be null; replacing a valid\r\n     * <tt>oldTrack</tt> with a null <tt>newTrack</tt> effectively just removes\r\n     * <tt>oldTrack</tt>\r\n     * @param {JitsiLocalTrack|null} oldTrack the current track in use to be\r\n     * replaced\r\n     * @param {JitsiLocalTrack|null} newTrack the new track to use\r\n     * @returns {Promise} which resolves once the replacement is complete\r\n     *  with no arguments or rejects with an error {string}\r\n     */\r\n    replaceTrack(oldTrack, newTrack) {\r\n        const workFunction = finishedCallback => {\r\n            // Check if the connection was closed and pretend everything is OK.\r\n            // This can happen if a track removal is scheduled but takes place\r\n            // after the connection is closed.\r\n            if (this.peerconnection.signalingState === 'closed'\r\n                || this.peerconnection.connectionState === 'closed'\r\n                || this.closed) {\r\n\r\n                finishedCallback();\r\n\r\n                return;\r\n            }\r\n\r\n            const oldLocalSdp = this.peerconnection.localDescription.sdp;\r\n\r\n            // NOTE the code below assumes that no more than 1 video track\r\n            // can be added to the peer connection.\r\n            // Transition from no video to video (possibly screen sharing)\r\n            if (!oldTrack && newTrack && newTrack.isVideoTrack()) {\r\n                // Clearing current primary SSRC will make\r\n                // the SdpConsistency generate a new one which will result\r\n                // with:\r\n                // 1. source-remove for the recvonly\r\n                // 2. source-add for the new video stream\r\n                this.peerconnection.clearRecvonlySsrc();\r\n\r\n            // Transition from video to no video\r\n            } else if (oldTrack && oldTrack.isVideoTrack() && !newTrack) {\r\n                // Clearing current primary SSRC and generating the recvonly\r\n                // will result in:\r\n                // 1. source-remove for the old video stream\r\n                // 2. source-add for the recvonly stream\r\n                this.peerconnection.clearRecvonlySsrc();\r\n                this.peerconnection.generateRecvonlySsrc();\r\n            }\r\n            if (oldTrack) {\r\n                this.peerconnection.removeTrack(oldTrack);\r\n            }\r\n            if (newTrack) {\r\n                this.peerconnection.addTrack(newTrack);\r\n            }\r\n\r\n            if ((oldTrack || newTrack)\r\n                && this.state === JingleSessionState.ACTIVE) {\r\n                this._renegotiate()\r\n                    .then(() => {\r\n                        const newLocalSDP\r\n                            = new SDP(\r\n                                this.peerconnection.localDescription.sdp);\r\n\r\n                        this.notifyMySSRCUpdate(\r\n                            new SDP(oldLocalSdp), newLocalSDP);\r\n                        finishedCallback();\r\n                    },\r\n                    finishedCallback /* will be called with en error */);\r\n            } else {\r\n                finishedCallback();\r\n            }\r\n        };\r\n\r\n        this.modificationQueue.push(\r\n            workFunction,\r\n            error => {\r\n                if (error) {\r\n                    logger.error('Replace track error:', error);\r\n                } else {\r\n                    logger.info('Replace track done!');\r\n                }\r\n            });\r\n    }\r\n\r\n    /**\r\n     * Parse the information from the xml sourceRemoveElem and translate it\r\n     *  into sdp lines\r\n     * @param {jquery xml element} sourceRemoveElem the source-remove\r\n     *  element from jingle\r\n     * @param {SDP object} currentRemoteSdp the current remote\r\n     *  sdp (as of this new source-remove)\r\n     * @returns {list} a list of SDP line strings that should\r\n     *  be removed from the remote SDP\r\n     */\r\n    _parseSsrcInfoFromSourceRemove(sourceRemoveElem, currentRemoteSdp) {\r\n        const removeSsrcInfo = [];\r\n\r\n        $(sourceRemoveElem).each((i1, content) => {\r\n            const name = $(content).attr('name');\r\n            let lines = '';\r\n\r\n            $(content)\r\n                .find('ssrc-group[xmlns=\"urn:xmpp:jingle:apps:rtp:ssma:0\"]')\r\n                .each(function() {\r\n                    /* eslint-disable no-invalid-this */\r\n                    const semantics = this.getAttribute('semantics');\r\n                    const ssrcs\r\n                        = $(this)\r\n                            .find('>source')\r\n                            .map(function() {\r\n                                return this.getAttribute('ssrc');\r\n                            })\r\n                            .get();\r\n\r\n                    if (ssrcs.length) {\r\n                        lines\r\n                            += `a=ssrc-group:${semantics} ${\r\n                                ssrcs.join(' ')}\\r\\n`;\r\n                    }\r\n\r\n                    /* eslint-enable no-invalid-this */\r\n                });\r\n            const ssrcs = [];\r\n\r\n            // handles both >source and >description>source versions\r\n            const tmp\r\n                = $(content).find(\r\n                    'source[xmlns=\"urn:xmpp:jingle:apps:rtp:ssma:0\"]');\r\n\r\n            tmp.each(function() {\r\n                // eslint-disable-next-line no-invalid-this\r\n                const ssrc = $(this).attr('ssrc');\r\n\r\n                ssrcs.push(ssrc);\r\n            });\r\n            currentRemoteSdp.media.forEach((media, i2) => {\r\n                if (!SDPUtil.findLine(media, `a=mid:${name}`)) {\r\n                    return;\r\n                }\r\n                if (!removeSsrcInfo[i2]) {\r\n                    removeSsrcInfo[i2] = '';\r\n                }\r\n                ssrcs.forEach(ssrc => {\r\n                    const ssrcLines\r\n                        = SDPUtil.findLines(media, `a=ssrc:${ssrc}`);\r\n\r\n                    if (ssrcLines.length) {\r\n                        removeSsrcInfo[i2] += `${ssrcLines.join('\\r\\n')}\\r\\n`;\r\n                    }\r\n                });\r\n                removeSsrcInfo[i2] += lines;\r\n            });\r\n        });\r\n\r\n        return removeSsrcInfo;\r\n    }\r\n\r\n    /**\r\n     * Will print an error if there is any difference, between the SSRCs given\r\n     * in the <tt>oldSDP</tt> and the ones currently described in\r\n     * the peerconnection's local description.\r\n     * @param {string} operationName the operation's name which will be printed\r\n     * in the error message.\r\n     * @param {SDP} oldSDP the old local SDP which will be compared with\r\n     * the current one.\r\n     * @return {boolean} <tt>true</tt> if there was any change or <tt>false</tt>\r\n     * otherwise.\r\n     * @private\r\n     */\r\n    _verifyNoSSRCChanged(operationName, oldSDP) {\r\n        const currentLocalSDP\r\n            = new SDP(this.peerconnection.localDescription.sdp);\r\n        let sdpDiff = new SDPDiffer(oldSDP, currentLocalSDP);\r\n        const addedMedia = sdpDiff.getNewMedia();\r\n\r\n        if (Object.keys(addedMedia).length) {\r\n            logger.error(\r\n                `${this} - some SSRC were added on ${operationName}`,\r\n                addedMedia);\r\n\r\n            return false;\r\n        }\r\n\r\n        sdpDiff = new SDPDiffer(currentLocalSDP, oldSDP);\r\n        const removedMedia = sdpDiff.getNewMedia();\r\n\r\n        if (Object.keys(removedMedia).length) {\r\n            logger.error(\r\n                `${this} - some SSRCs were removed on ${operationName}`,\r\n                removedMedia);\r\n\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Adds local track back to this session, as part of the unmute operation.\r\n     * @param {JitsiLocalTrack} track\r\n     * @return {Promise} a promise that will resolve once the local track is\r\n     * added back to this session and renegotiation succeeds. Will be rejected\r\n     * with a <tt>string</tt> that provides some error details in case something\r\n     * goes wrong.\r\n     */\r\n    addTrackAsUnmute(track) {\r\n        return this._addRemoveTrackAsMuteUnmute(\r\n            false /* add as unmute */, track);\r\n    }\r\n\r\n    /**\r\n     * Remove local track as part of the mute operation.\r\n     * @param {JitsiLocalTrack} track the local track to be removed\r\n     * @return {Promise} a promise which will be resolved once the local track\r\n     * is removed from this session and the renegotiation is performed.\r\n     * The promise will be rejected with a <tt>string</tt> that the describes\r\n     * the error if anything goes wrong.\r\n     */\r\n    removeTrackAsMute(track) {\r\n        return this._addRemoveTrackAsMuteUnmute(\r\n            true /* remove as mute */, track);\r\n    }\r\n\r\n    /**\r\n     * See {@link addTrackAsUnmute} and {@link removeTrackAsMute}.\r\n     * @param {boolean} isMute <tt>true</tt> for \"remove as mute\" or\r\n     * <tt>false</tt> for \"add as unmute\".\r\n     * @param {JitsiLocalTrack} track the track that will be added/removed\r\n     * @private\r\n     */\r\n    _addRemoveTrackAsMuteUnmute(isMute, track) {\r\n        if (!track) {\r\n            return Promise.reject('invalid \"track\" argument value');\r\n        }\r\n        const operationName = isMute ? 'removeTrackMute' : 'addTrackUnmute';\r\n        const workFunction = finishedCallback => {\r\n            const tpc = this.peerconnection;\r\n\r\n            if (!tpc) {\r\n                finishedCallback(\r\n                    `Error:  tried ${operationName} track with no active peer`\r\n                        + 'connection');\r\n\r\n                return;\r\n            }\r\n            const oldLocalSDP = tpc.localDescription.sdp;\r\n            const tpcOperation\r\n                = isMute\r\n                    ? tpc.removeTrackMute.bind(tpc, track)\r\n                    : tpc.addTrackUnmute.bind(tpc, track);\r\n\r\n            if (!tpcOperation()) {\r\n                finishedCallback(`${operationName} failed!`);\r\n            } else if (!oldLocalSDP || !tpc.remoteDescription.sdp) {\r\n                finishedCallback();\r\n            } else {\r\n                this._renegotiate()\r\n                    .then(() => {\r\n                        // The results are ignored, as this check failure is not\r\n                        // enough to fail the whole operation. It will log\r\n                        // an error inside.\r\n                        this._verifyNoSSRCChanged(\r\n                            operationName, new SDP(oldLocalSDP));\r\n                        finishedCallback();\r\n                    },\r\n                    finishedCallback /* will be called with an error */);\r\n            }\r\n        };\r\n\r\n        return new Promise((resolve, reject) => {\r\n            this.modificationQueue.push(\r\n                workFunction,\r\n                error => {\r\n                    if (error) {\r\n                        reject(error);\r\n                    } else {\r\n                        resolve();\r\n                    }\r\n                });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Resumes or suspends media transfer over the underlying peer connection.\r\n     * @param {boolean} audioActive <tt>true</tt> to enable audio media\r\n     * transfer or <tt>false</tt> to suspend audio media transmission.\r\n     * @param {boolean} videoActive <tt>true</tt> to enable video media\r\n     * transfer or <tt>false</tt> to suspend video media transmission.\r\n     * @return {Promise} a <tt>Promise</tt> which will resolve once\r\n     * the operation is done. It will be rejected with an error description as\r\n     * a string in case anything goes wrong.\r\n     */\r\n    setMediaTransferActive(audioActive, videoActive) {\r\n        if (!this.peerconnection) {\r\n            return Promise.reject(\r\n                'Can not modify transfer active state,'\r\n                    + ' before \"initialize\" is called');\r\n        }\r\n\r\n        const logAudioStr = audioActive ? 'audio active' : 'audio inactive';\r\n        const logVideoStr = videoActive ? 'video active' : 'video inactive';\r\n\r\n        logger.info(`Queued make ${logVideoStr}, ${logAudioStr} task...`);\r\n\r\n        const workFunction = finishedCallback => {\r\n            const isSessionActive = this.state === JingleSessionState.ACTIVE;\r\n\r\n            // Because the value is modified on the queue it's impossible to\r\n            // check it's final value reliably prior to submitting the task.\r\n            // The rule here is that the last submitted state counts.\r\n            // Check the values here to avoid unnecessary renegotiation cycle.\r\n            const audioActiveChanged\r\n                = this.peerconnection.setAudioTransferActive(audioActive);\r\n\r\n            if (this._localVideoActive !== videoActive) {\r\n                this._localVideoActive = videoActive;\r\n\r\n                // Do only for P2P - Jicofo will reply with 'bad-request'\r\n                // We don't want to send 'content-modify', before the initial\r\n                // O/A (state === JingleSessionState.ACTIVE), because that will\r\n                // mess up video media direction in the remote SDP.\r\n                // 'content-modify' when processed only affects the media\r\n                // direction in the local SDP. We're doing that, because setting\r\n                // 'inactive' on video media in remote SDP will mess up our SDP\r\n                // translation chain (simulcast, RTX, video mute etc.).\r\n                if (this.isP2P && isSessionActive) {\r\n                    this.sendContentModify(videoActive);\r\n                }\r\n            }\r\n\r\n            const pcVideoActiveChanged\r\n                = this.peerconnection.setVideoTransferActive(\r\n                    this._localVideoActive && this._remoteVideoActive);\r\n\r\n            // Will do the sRD/sLD cycle to update SDPs and adjust the media\r\n            // direction\r\n            if (isSessionActive\r\n                    && (audioActiveChanged || pcVideoActiveChanged)) {\r\n                this._renegotiate()\r\n                    .then(\r\n                        finishedCallback,\r\n                        finishedCallback /* will be called with an error */);\r\n            } else {\r\n                finishedCallback();\r\n            }\r\n        };\r\n\r\n        return new Promise((resolve, reject) => {\r\n            this.modificationQueue.push(\r\n                workFunction,\r\n                error => {\r\n                    if (error) {\r\n                        reject(error);\r\n                    } else {\r\n                        resolve();\r\n                    }\r\n                });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Will put and execute on the queue a session modify task. Currently it\r\n     * only checks the senders attribute of the video content in order to figure\r\n     * out if the remote peer has video in the inactive state (stored locally\r\n     * in {@link _remoteVideoActive} - see field description for more info).\r\n     * @param {jQuery} jingleContents jQuery selector pointing to the jingle\r\n     * element of the session modify IQ.\r\n     * @see {@link _remoteVideoActive}\r\n     * @see {@link _localVideoActive}\r\n     */\r\n    modifyContents(jingleContents) {\r\n        const newVideoSenders\r\n            = JingleSessionPC.parseVideoSenders(jingleContents);\r\n\r\n        if (newVideoSenders === null) {\r\n            logger.error(\r\n                `${this} - failed to parse video \"senders\" attribute in`\r\n                    + '\"content-modify\" action');\r\n\r\n            return;\r\n        }\r\n\r\n        const workFunction = finishedCallback => {\r\n            if (this._assertNotEnded('content-modify')\r\n                    && this._modifyRemoteVideoActive(newVideoSenders)) {\r\n                // Will do the sRD/sLD cycle to update SDPs and adjust\r\n                // the media direction\r\n                this._renegotiate()\r\n                    .then(finishedCallback, finishedCallback /* (error) */);\r\n            } else {\r\n                finishedCallback();\r\n            }\r\n        };\r\n\r\n        logger.debug(\r\n            `${this} queued \"content-modify\" task`\r\n                + `(video senders=\"${newVideoSenders}\")`);\r\n\r\n        this.modificationQueue.push(\r\n            workFunction,\r\n            error => {\r\n                if (error) {\r\n                    logger.error('\"content-modify\" failed', error);\r\n                }\r\n            });\r\n    }\r\n\r\n    /**\r\n     * Processes new value of remote video \"senders\" Jingle attribute and tries\r\n     * to apply it for {@link _remoteVideoActive}.\r\n     * @param {string} remoteVideoSenders the value of \"senders\" attribute of\r\n     * Jingle video content element advertised by remote peer.\r\n     * @return {boolean} <tt>true</tt> if the change affected state of\r\n     * the underlying peerconnection and renegotiation is required for\r\n     * the changes to take effect.\r\n     * @private\r\n     */\r\n    _modifyRemoteVideoActive(remoteVideoSenders) {\r\n        const isRemoteVideoActive\r\n            = remoteVideoSenders === 'both'\r\n                || (remoteVideoSenders === 'initiator' && this.isInitiator)\r\n                || (remoteVideoSenders === 'responder' && !this.isInitiator);\r\n\r\n        if (isRemoteVideoActive !== this._remoteVideoActive) {\r\n            logger.debug(\r\n                `${this} new remote video active: ${isRemoteVideoActive}`);\r\n            this._remoteVideoActive = isRemoteVideoActive;\r\n        }\r\n\r\n        return this.peerconnection.setVideoTransferActive(\r\n            this._localVideoActive && this._remoteVideoActive);\r\n    }\r\n\r\n    /**\r\n     * Figures out added/removed ssrcs and send update IQs.\r\n     * @param oldSDP SDP object for old description.\r\n     * @param newSDP SDP object for new description.\r\n     */\r\n    notifyMySSRCUpdate(oldSDP, newSDP) {\r\n\r\n        if (this.state !== JingleSessionState.ACTIVE) {\r\n            logger.warn(`Skipping SSRC update in '${this.state} ' state.`);\r\n\r\n            return;\r\n        }\r\n\r\n        // send source-remove IQ.\r\n        let sdpDiffer = new SDPDiffer(newSDP, oldSDP);\r\n        const remove = $iq({ to: this.remoteJid,\r\n            type: 'set' })\r\n            .c('jingle', {\r\n                xmlns: 'urn:xmpp:jingle:1',\r\n                action: 'source-remove',\r\n                initiator: this.initiator,\r\n                sid: this.sid\r\n            }\r\n            );\r\n        const removedAnySSRCs = sdpDiffer.toJingle(remove);\r\n\r\n        if (removedAnySSRCs) {\r\n            logger.info('Sending source-remove', remove.tree());\r\n            this.connection.sendIQ(\r\n                remove, null,\r\n                this.newJingleErrorHandler(remove), IQ_TIMEOUT);\r\n        } else {\r\n            logger.log('removal not necessary');\r\n        }\r\n\r\n        // send source-add IQ.\r\n        sdpDiffer = new SDPDiffer(oldSDP, newSDP);\r\n        const add = $iq({ to: this.remoteJid,\r\n            type: 'set' })\r\n            .c('jingle', {\r\n                xmlns: 'urn:xmpp:jingle:1',\r\n                action: 'source-add',\r\n                initiator: this.initiator,\r\n                sid: this.sid\r\n            }\r\n            );\r\n\r\n        const containsNewSSRCs = sdpDiffer.toJingle(add);\r\n\r\n        if (containsNewSSRCs) {\r\n            logger.info('Sending source-add', add.tree());\r\n            this.connection.sendIQ(\r\n                add, null, this.newJingleErrorHandler(add), IQ_TIMEOUT);\r\n        } else {\r\n            logger.log('addition not necessary');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Method returns function(errorResponse) which is a callback to be passed\r\n     * to Strophe connection.sendIQ method. An 'error' structure is created that\r\n     * is passed as 1st argument to given <tt>failureCb</tt>. The format of this\r\n     * structure is as follows:\r\n     * {\r\n     *  code: {XMPP error response code}\r\n     *  reason: {the name of XMPP error reason element or 'timeout' if the\r\n      *          request has timed out within <tt>IQ_TIMEOUT</tt> milliseconds}\r\n     *  source: {request.tree() that provides original request}\r\n     *  session: {this JingleSessionPC.toString()}\r\n     * }\r\n     * @param request Strophe IQ instance which is the request to be dumped into\r\n     *        the error structure\r\n     * @param failureCb function(error) called when error response was returned\r\n     *        or when a timeout has occurred.\r\n     * @returns {function(this:JingleSessionPC)}\r\n     */\r\n    newJingleErrorHandler(request, failureCb) {\r\n        return errResponse => {\r\n\r\n            const error = {};\r\n\r\n            // Get XMPP error code and condition(reason)\r\n            const errorElSel = $(errResponse).find('error');\r\n\r\n            if (errorElSel.length) {\r\n                error.code = errorElSel.attr('code');\r\n                const errorReasonSel = $(errResponse).find('error :first');\r\n\r\n                if (errorReasonSel.length) {\r\n                    error.reason = errorReasonSel[0].tagName;\r\n                }\r\n\r\n                const errorMsgSel = errorElSel.find('>text');\r\n\r\n                if (errorMsgSel.length) {\r\n                    error.msg = errorMsgSel.text();\r\n                }\r\n            }\r\n\r\n            if (!errResponse) {\r\n                error.reason = 'timeout';\r\n            }\r\n\r\n            error.session = this.toString();\r\n\r\n            if (failureCb) {\r\n                failureCb(error);\r\n            } else if (this.state === JingleSessionState.ENDED\r\n                        && error.reason === 'item-not-found') {\r\n                // When remote peer decides to terminate the session, but it\r\n                // still have few messages on the queue for processing,\r\n                // it will first send us 'session-terminate' (we enter ENDED)\r\n                // and then follow with 'item-not-found' for the queued requests\r\n                // We don't want to have that logged on error level.\r\n                logger.debug(`Jingle error: ${JSON.stringify(error)}`);\r\n            } else {\r\n                GlobalOnErrorHandler.callErrorHandler(\r\n                    new Error(\r\n                        `Jingle error: ${JSON.stringify(error)}`));\r\n            }\r\n        };\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param session\r\n     * @param error\r\n     */\r\n    static onJingleFatalError(session, error) {\r\n        if (this.room) {\r\n            this.room.eventEmitter.emit(\r\n                XMPPEvents.CONFERENCE_SETUP_FAILED, session, error);\r\n            this.room.eventEmitter.emit(\r\n                XMPPEvents.JINGLE_FATAL_ERROR, session, error);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns the ice connection state for the peer connection.\r\n     * @returns the ice connection state for the peer connection.\r\n     */\r\n    getIceConnectionState() {\r\n        return this.peerconnection.iceConnectionState;\r\n    }\r\n\r\n    /**\r\n     * Closes the peerconnection.\r\n     */\r\n    close() {\r\n        this.closed = true;\r\n\r\n        // The signaling layer will remove it's listeners\r\n        this.signalingLayer.setChatRoom(null);\r\n\r\n        // do not try to close if already closed.\r\n        this.peerconnection\r\n            && ((this.peerconnection.signalingState\r\n                    && this.peerconnection.signalingState !== 'closed')\r\n                || (this.peerconnection.connectionState\r\n                    && this.peerconnection.connectionState !== 'closed'))\r\n            && this.peerconnection.close();\r\n    }\r\n\r\n    /**\r\n     * Converts to string with minor summary.\r\n     * @return {string}\r\n     */\r\n    toString() {\r\n        return `JingleSessionPC[p2p=${this.isP2P},`\r\n                    + `initiator=${this.isInitiator},sid=${this.sid}]`;\r\n    }\r\n\r\n    /**\r\n     * If the A/B test for suspend video is disabled according to the room's\r\n     * configuration, returns undefined. Otherwise returns a boolean which\r\n     * indicates whether the suspend video option should be enabled or disabled.\r\n     */\r\n    _abtestSuspendVideoEnabled() {\r\n        if (!this.room.options.abTesting\r\n            || !this.room.options.abTesting.enableSuspendVideoTest) {\r\n            return;\r\n        }\r\n\r\n        // We want the two participants in a P2P call to agree on the value of\r\n        // the \"suspend\" option. We use the JID of the initiator, because it is\r\n        // both randomly selected and agreed upon by both participants.\r\n        const jid = this._getInitiatorJid();\r\n\r\n        return integerHash(jid) % 2 === 0;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/xmpp/JingleSessionPC.js","/*!\n * async\n * https://github.com/caolan/async\n *\n * Copyright 2010-2014 Caolan McMahon\n * Released under the MIT license\n */\n/*jshint onevar: false, indent:4 */\n/*global setImmediate: false, setTimeout: false, console: false */\n(function () {\n\n    var async = {};\n\n    // global on the server, window in the browser\n    var root, previous_async;\n\n    root = this;\n    if (root != null) {\n      previous_async = root.async;\n    }\n\n    async.noConflict = function () {\n        root.async = previous_async;\n        return async;\n    };\n\n    function only_once(fn) {\n        var called = false;\n        return function() {\n            if (called) throw new Error(\"Callback was already called.\");\n            called = true;\n            fn.apply(root, arguments);\n        }\n    }\n\n    //// cross-browser compatiblity functions ////\n\n    var _toString = Object.prototype.toString;\n\n    var _isArray = Array.isArray || function (obj) {\n        return _toString.call(obj) === '[object Array]';\n    };\n\n    var _each = function (arr, iterator) {\n        if (arr.forEach) {\n            return arr.forEach(iterator);\n        }\n        for (var i = 0; i < arr.length; i += 1) {\n            iterator(arr[i], i, arr);\n        }\n    };\n\n    var _map = function (arr, iterator) {\n        if (arr.map) {\n            return arr.map(iterator);\n        }\n        var results = [];\n        _each(arr, function (x, i, a) {\n            results.push(iterator(x, i, a));\n        });\n        return results;\n    };\n\n    var _reduce = function (arr, iterator, memo) {\n        if (arr.reduce) {\n            return arr.reduce(iterator, memo);\n        }\n        _each(arr, function (x, i, a) {\n            memo = iterator(memo, x, i, a);\n        });\n        return memo;\n    };\n\n    var _keys = function (obj) {\n        if (Object.keys) {\n            return Object.keys(obj);\n        }\n        var keys = [];\n        for (var k in obj) {\n            if (obj.hasOwnProperty(k)) {\n                keys.push(k);\n            }\n        }\n        return keys;\n    };\n\n    //// exported async module functions ////\n\n    //// nextTick implementation with browser-compatible fallback ////\n    if (typeof process === 'undefined' || !(process.nextTick)) {\n        if (typeof setImmediate === 'function') {\n            async.nextTick = function (fn) {\n                // not a direct alias for IE10 compatibility\n                setImmediate(fn);\n            };\n            async.setImmediate = async.nextTick;\n        }\n        else {\n            async.nextTick = function (fn) {\n                setTimeout(fn, 0);\n            };\n            async.setImmediate = async.nextTick;\n        }\n    }\n    else {\n        async.nextTick = process.nextTick;\n        if (typeof setImmediate !== 'undefined') {\n            async.setImmediate = function (fn) {\n              // not a direct alias for IE10 compatibility\n              setImmediate(fn);\n            };\n        }\n        else {\n            async.setImmediate = async.nextTick;\n        }\n    }\n\n    async.each = function (arr, iterator, callback) {\n        callback = callback || function () {};\n        if (!arr.length) {\n            return callback();\n        }\n        var completed = 0;\n        _each(arr, function (x) {\n            iterator(x, only_once(done) );\n        });\n        function done(err) {\n          if (err) {\n              callback(err);\n              callback = function () {};\n          }\n          else {\n              completed += 1;\n              if (completed >= arr.length) {\n                  callback();\n              }\n          }\n        }\n    };\n    async.forEach = async.each;\n\n    async.eachSeries = function (arr, iterator, callback) {\n        callback = callback || function () {};\n        if (!arr.length) {\n            return callback();\n        }\n        var completed = 0;\n        var iterate = function () {\n            iterator(arr[completed], function (err) {\n                if (err) {\n                    callback(err);\n                    callback = function () {};\n                }\n                else {\n                    completed += 1;\n                    if (completed >= arr.length) {\n                        callback();\n                    }\n                    else {\n                        iterate();\n                    }\n                }\n            });\n        };\n        iterate();\n    };\n    async.forEachSeries = async.eachSeries;\n\n    async.eachLimit = function (arr, limit, iterator, callback) {\n        var fn = _eachLimit(limit);\n        fn.apply(null, [arr, iterator, callback]);\n    };\n    async.forEachLimit = async.eachLimit;\n\n    var _eachLimit = function (limit) {\n\n        return function (arr, iterator, callback) {\n            callback = callback || function () {};\n            if (!arr.length || limit <= 0) {\n                return callback();\n            }\n            var completed = 0;\n            var started = 0;\n            var running = 0;\n\n            (function replenish () {\n                if (completed >= arr.length) {\n                    return callback();\n                }\n\n                while (running < limit && started < arr.length) {\n                    started += 1;\n                    running += 1;\n                    iterator(arr[started - 1], function (err) {\n                        if (err) {\n                            callback(err);\n                            callback = function () {};\n                        }\n                        else {\n                            completed += 1;\n                            running -= 1;\n                            if (completed >= arr.length) {\n                                callback();\n                            }\n                            else {\n                                replenish();\n                            }\n                        }\n                    });\n                }\n            })();\n        };\n    };\n\n\n    var doParallel = function (fn) {\n        return function () {\n            var args = Array.prototype.slice.call(arguments);\n            return fn.apply(null, [async.each].concat(args));\n        };\n    };\n    var doParallelLimit = function(limit, fn) {\n        return function () {\n            var args = Array.prototype.slice.call(arguments);\n            return fn.apply(null, [_eachLimit(limit)].concat(args));\n        };\n    };\n    var doSeries = function (fn) {\n        return function () {\n            var args = Array.prototype.slice.call(arguments);\n            return fn.apply(null, [async.eachSeries].concat(args));\n        };\n    };\n\n\n    var _asyncMap = function (eachfn, arr, iterator, callback) {\n        arr = _map(arr, function (x, i) {\n            return {index: i, value: x};\n        });\n        if (!callback) {\n            eachfn(arr, function (x, callback) {\n                iterator(x.value, function (err) {\n                    callback(err);\n                });\n            });\n        } else {\n            var results = [];\n            eachfn(arr, function (x, callback) {\n                iterator(x.value, function (err, v) {\n                    results[x.index] = v;\n                    callback(err);\n                });\n            }, function (err) {\n                callback(err, results);\n            });\n        }\n    };\n    async.map = doParallel(_asyncMap);\n    async.mapSeries = doSeries(_asyncMap);\n    async.mapLimit = function (arr, limit, iterator, callback) {\n        return _mapLimit(limit)(arr, iterator, callback);\n    };\n\n    var _mapLimit = function(limit) {\n        return doParallelLimit(limit, _asyncMap);\n    };\n\n    // reduce only has a series version, as doing reduce in parallel won't\n    // work in many situations.\n    async.reduce = function (arr, memo, iterator, callback) {\n        async.eachSeries(arr, function (x, callback) {\n            iterator(memo, x, function (err, v) {\n                memo = v;\n                callback(err);\n            });\n        }, function (err) {\n            callback(err, memo);\n        });\n    };\n    // inject alias\n    async.inject = async.reduce;\n    // foldl alias\n    async.foldl = async.reduce;\n\n    async.reduceRight = function (arr, memo, iterator, callback) {\n        var reversed = _map(arr, function (x) {\n            return x;\n        }).reverse();\n        async.reduce(reversed, memo, iterator, callback);\n    };\n    // foldr alias\n    async.foldr = async.reduceRight;\n\n    var _filter = function (eachfn, arr, iterator, callback) {\n        var results = [];\n        arr = _map(arr, function (x, i) {\n            return {index: i, value: x};\n        });\n        eachfn(arr, function (x, callback) {\n            iterator(x.value, function (v) {\n                if (v) {\n                    results.push(x);\n                }\n                callback();\n            });\n        }, function (err) {\n            callback(_map(results.sort(function (a, b) {\n                return a.index - b.index;\n            }), function (x) {\n                return x.value;\n            }));\n        });\n    };\n    async.filter = doParallel(_filter);\n    async.filterSeries = doSeries(_filter);\n    // select alias\n    async.select = async.filter;\n    async.selectSeries = async.filterSeries;\n\n    var _reject = function (eachfn, arr, iterator, callback) {\n        var results = [];\n        arr = _map(arr, function (x, i) {\n            return {index: i, value: x};\n        });\n        eachfn(arr, function (x, callback) {\n            iterator(x.value, function (v) {\n                if (!v) {\n                    results.push(x);\n                }\n                callback();\n            });\n        }, function (err) {\n            callback(_map(results.sort(function (a, b) {\n                return a.index - b.index;\n            }), function (x) {\n                return x.value;\n            }));\n        });\n    };\n    async.reject = doParallel(_reject);\n    async.rejectSeries = doSeries(_reject);\n\n    var _detect = function (eachfn, arr, iterator, main_callback) {\n        eachfn(arr, function (x, callback) {\n            iterator(x, function (result) {\n                if (result) {\n                    main_callback(x);\n                    main_callback = function () {};\n                }\n                else {\n                    callback();\n                }\n            });\n        }, function (err) {\n            main_callback();\n        });\n    };\n    async.detect = doParallel(_detect);\n    async.detectSeries = doSeries(_detect);\n\n    async.some = function (arr, iterator, main_callback) {\n        async.each(arr, function (x, callback) {\n            iterator(x, function (v) {\n                if (v) {\n                    main_callback(true);\n                    main_callback = function () {};\n                }\n                callback();\n            });\n        }, function (err) {\n            main_callback(false);\n        });\n    };\n    // any alias\n    async.any = async.some;\n\n    async.every = function (arr, iterator, main_callback) {\n        async.each(arr, function (x, callback) {\n            iterator(x, function (v) {\n                if (!v) {\n                    main_callback(false);\n                    main_callback = function () {};\n                }\n                callback();\n            });\n        }, function (err) {\n            main_callback(true);\n        });\n    };\n    // all alias\n    async.all = async.every;\n\n    async.sortBy = function (arr, iterator, callback) {\n        async.map(arr, function (x, callback) {\n            iterator(x, function (err, criteria) {\n                if (err) {\n                    callback(err);\n                }\n                else {\n                    callback(null, {value: x, criteria: criteria});\n                }\n            });\n        }, function (err, results) {\n            if (err) {\n                return callback(err);\n            }\n            else {\n                var fn = function (left, right) {\n                    var a = left.criteria, b = right.criteria;\n                    return a < b ? -1 : a > b ? 1 : 0;\n                };\n                callback(null, _map(results.sort(fn), function (x) {\n                    return x.value;\n                }));\n            }\n        });\n    };\n\n    async.auto = function (tasks, callback) {\n        callback = callback || function () {};\n        var keys = _keys(tasks);\n        var remainingTasks = keys.length\n        if (!remainingTasks) {\n            return callback();\n        }\n\n        var results = {};\n\n        var listeners = [];\n        var addListener = function (fn) {\n            listeners.unshift(fn);\n        };\n        var removeListener = function (fn) {\n            for (var i = 0; i < listeners.length; i += 1) {\n                if (listeners[i] === fn) {\n                    listeners.splice(i, 1);\n                    return;\n                }\n            }\n        };\n        var taskComplete = function () {\n            remainingTasks--\n            _each(listeners.slice(0), function (fn) {\n                fn();\n            });\n        };\n\n        addListener(function () {\n            if (!remainingTasks) {\n                var theCallback = callback;\n                // prevent final callback from calling itself if it errors\n                callback = function () {};\n\n                theCallback(null, results);\n            }\n        });\n\n        _each(keys, function (k) {\n            var task = _isArray(tasks[k]) ? tasks[k]: [tasks[k]];\n            var taskCallback = function (err) {\n                var args = Array.prototype.slice.call(arguments, 1);\n                if (args.length <= 1) {\n                    args = args[0];\n                }\n                if (err) {\n                    var safeResults = {};\n                    _each(_keys(results), function(rkey) {\n                        safeResults[rkey] = results[rkey];\n                    });\n                    safeResults[k] = args;\n                    callback(err, safeResults);\n                    // stop subsequent errors hitting callback multiple times\n                    callback = function () {};\n                }\n                else {\n                    results[k] = args;\n                    async.setImmediate(taskComplete);\n                }\n            };\n            var requires = task.slice(0, Math.abs(task.length - 1)) || [];\n            var ready = function () {\n                return _reduce(requires, function (a, x) {\n                    return (a && results.hasOwnProperty(x));\n                }, true) && !results.hasOwnProperty(k);\n            };\n            if (ready()) {\n                task[task.length - 1](taskCallback, results);\n            }\n            else {\n                var listener = function () {\n                    if (ready()) {\n                        removeListener(listener);\n                        task[task.length - 1](taskCallback, results);\n                    }\n                };\n                addListener(listener);\n            }\n        });\n    };\n\n    async.retry = function(times, task, callback) {\n        var DEFAULT_TIMES = 5;\n        var attempts = [];\n        // Use defaults if times not passed\n        if (typeof times === 'function') {\n            callback = task;\n            task = times;\n            times = DEFAULT_TIMES;\n        }\n        // Make sure times is a number\n        times = parseInt(times, 10) || DEFAULT_TIMES;\n        var wrappedTask = function(wrappedCallback, wrappedResults) {\n            var retryAttempt = function(task, finalAttempt) {\n                return function(seriesCallback) {\n                    task(function(err, result){\n                        seriesCallback(!err || finalAttempt, {err: err, result: result});\n                    }, wrappedResults);\n                };\n            };\n            while (times) {\n                attempts.push(retryAttempt(task, !(times-=1)));\n            }\n            async.series(attempts, function(done, data){\n                data = data[data.length - 1];\n                (wrappedCallback || callback)(data.err, data.result);\n            });\n        }\n        // If a callback is passed, run this as a controll flow\n        return callback ? wrappedTask() : wrappedTask\n    };\n\n    async.waterfall = function (tasks, callback) {\n        callback = callback || function () {};\n        if (!_isArray(tasks)) {\n          var err = new Error('First argument to waterfall must be an array of functions');\n          return callback(err);\n        }\n        if (!tasks.length) {\n            return callback();\n        }\n        var wrapIterator = function (iterator) {\n            return function (err) {\n                if (err) {\n                    callback.apply(null, arguments);\n                    callback = function () {};\n                }\n                else {\n                    var args = Array.prototype.slice.call(arguments, 1);\n                    var next = iterator.next();\n                    if (next) {\n                        args.push(wrapIterator(next));\n                    }\n                    else {\n                        args.push(callback);\n                    }\n                    async.setImmediate(function () {\n                        iterator.apply(null, args);\n                    });\n                }\n            };\n        };\n        wrapIterator(async.iterator(tasks))();\n    };\n\n    var _parallel = function(eachfn, tasks, callback) {\n        callback = callback || function () {};\n        if (_isArray(tasks)) {\n            eachfn.map(tasks, function (fn, callback) {\n                if (fn) {\n                    fn(function (err) {\n                        var args = Array.prototype.slice.call(arguments, 1);\n                        if (args.length <= 1) {\n                            args = args[0];\n                        }\n                        callback.call(null, err, args);\n                    });\n                }\n            }, callback);\n        }\n        else {\n            var results = {};\n            eachfn.each(_keys(tasks), function (k, callback) {\n                tasks[k](function (err) {\n                    var args = Array.prototype.slice.call(arguments, 1);\n                    if (args.length <= 1) {\n                        args = args[0];\n                    }\n                    results[k] = args;\n                    callback(err);\n                });\n            }, function (err) {\n                callback(err, results);\n            });\n        }\n    };\n\n    async.parallel = function (tasks, callback) {\n        _parallel({ map: async.map, each: async.each }, tasks, callback);\n    };\n\n    async.parallelLimit = function(tasks, limit, callback) {\n        _parallel({ map: _mapLimit(limit), each: _eachLimit(limit) }, tasks, callback);\n    };\n\n    async.series = function (tasks, callback) {\n        callback = callback || function () {};\n        if (_isArray(tasks)) {\n            async.mapSeries(tasks, function (fn, callback) {\n                if (fn) {\n                    fn(function (err) {\n                        var args = Array.prototype.slice.call(arguments, 1);\n                        if (args.length <= 1) {\n                            args = args[0];\n                        }\n                        callback.call(null, err, args);\n                    });\n                }\n            }, callback);\n        }\n        else {\n            var results = {};\n            async.eachSeries(_keys(tasks), function (k, callback) {\n                tasks[k](function (err) {\n                    var args = Array.prototype.slice.call(arguments, 1);\n                    if (args.length <= 1) {\n                        args = args[0];\n                    }\n                    results[k] = args;\n                    callback(err);\n                });\n            }, function (err) {\n                callback(err, results);\n            });\n        }\n    };\n\n    async.iterator = function (tasks) {\n        var makeCallback = function (index) {\n            var fn = function () {\n                if (tasks.length) {\n                    tasks[index].apply(null, arguments);\n                }\n                return fn.next();\n            };\n            fn.next = function () {\n                return (index < tasks.length - 1) ? makeCallback(index + 1): null;\n            };\n            return fn;\n        };\n        return makeCallback(0);\n    };\n\n    async.apply = function (fn) {\n        var args = Array.prototype.slice.call(arguments, 1);\n        return function () {\n            return fn.apply(\n                null, args.concat(Array.prototype.slice.call(arguments))\n            );\n        };\n    };\n\n    var _concat = function (eachfn, arr, fn, callback) {\n        var r = [];\n        eachfn(arr, function (x, cb) {\n            fn(x, function (err, y) {\n                r = r.concat(y || []);\n                cb(err);\n            });\n        }, function (err) {\n            callback(err, r);\n        });\n    };\n    async.concat = doParallel(_concat);\n    async.concatSeries = doSeries(_concat);\n\n    async.whilst = function (test, iterator, callback) {\n        if (test()) {\n            iterator(function (err) {\n                if (err) {\n                    return callback(err);\n                }\n                async.whilst(test, iterator, callback);\n            });\n        }\n        else {\n            callback();\n        }\n    };\n\n    async.doWhilst = function (iterator, test, callback) {\n        iterator(function (err) {\n            if (err) {\n                return callback(err);\n            }\n            var args = Array.prototype.slice.call(arguments, 1);\n            if (test.apply(null, args)) {\n                async.doWhilst(iterator, test, callback);\n            }\n            else {\n                callback();\n            }\n        });\n    };\n\n    async.until = function (test, iterator, callback) {\n        if (!test()) {\n            iterator(function (err) {\n                if (err) {\n                    return callback(err);\n                }\n                async.until(test, iterator, callback);\n            });\n        }\n        else {\n            callback();\n        }\n    };\n\n    async.doUntil = function (iterator, test, callback) {\n        iterator(function (err) {\n            if (err) {\n                return callback(err);\n            }\n            var args = Array.prototype.slice.call(arguments, 1);\n            if (!test.apply(null, args)) {\n                async.doUntil(iterator, test, callback);\n            }\n            else {\n                callback();\n            }\n        });\n    };\n\n    async.queue = function (worker, concurrency) {\n        if (concurrency === undefined) {\n            concurrency = 1;\n        }\n        function _insert(q, data, pos, callback) {\n          if (!q.started){\n            q.started = true;\n          }\n          if (!_isArray(data)) {\n              data = [data];\n          }\n          if(data.length == 0) {\n             // call drain immediately if there are no tasks\n             return async.setImmediate(function() {\n                 if (q.drain) {\n                     q.drain();\n                 }\n             });\n          }\n          _each(data, function(task) {\n              var item = {\n                  data: task,\n                  callback: typeof callback === 'function' ? callback : null\n              };\n\n              if (pos) {\n                q.tasks.unshift(item);\n              } else {\n                q.tasks.push(item);\n              }\n\n              if (q.saturated && q.tasks.length === q.concurrency) {\n                  q.saturated();\n              }\n              async.setImmediate(q.process);\n          });\n        }\n\n        var workers = 0;\n        var q = {\n            tasks: [],\n            concurrency: concurrency,\n            saturated: null,\n            empty: null,\n            drain: null,\n            started: false,\n            paused: false,\n            push: function (data, callback) {\n              _insert(q, data, false, callback);\n            },\n            kill: function () {\n              q.drain = null;\n              q.tasks = [];\n            },\n            unshift: function (data, callback) {\n              _insert(q, data, true, callback);\n            },\n            process: function () {\n                if (!q.paused && workers < q.concurrency && q.tasks.length) {\n                    var task = q.tasks.shift();\n                    if (q.empty && q.tasks.length === 0) {\n                        q.empty();\n                    }\n                    workers += 1;\n                    var next = function () {\n                        workers -= 1;\n                        if (task.callback) {\n                            task.callback.apply(task, arguments);\n                        }\n                        if (q.drain && q.tasks.length + workers === 0) {\n                            q.drain();\n                        }\n                        q.process();\n                    };\n                    var cb = only_once(next);\n                    worker(task.data, cb);\n                }\n            },\n            length: function () {\n                return q.tasks.length;\n            },\n            running: function () {\n                return workers;\n            },\n            idle: function() {\n                return q.tasks.length + workers === 0;\n            },\n            pause: function () {\n                if (q.paused === true) { return; }\n                q.paused = true;\n                q.process();\n            },\n            resume: function () {\n                if (q.paused === false) { return; }\n                q.paused = false;\n                q.process();\n            }\n        };\n        return q;\n    };\n    \n    async.priorityQueue = function (worker, concurrency) {\n        \n        function _compareTasks(a, b){\n          return a.priority - b.priority;\n        };\n        \n        function _binarySearch(sequence, item, compare) {\n          var beg = -1,\n              end = sequence.length - 1;\n          while (beg < end) {\n            var mid = beg + ((end - beg + 1) >>> 1);\n            if (compare(item, sequence[mid]) >= 0) {\n              beg = mid;\n            } else {\n              end = mid - 1;\n            }\n          }\n          return beg;\n        }\n        \n        function _insert(q, data, priority, callback) {\n          if (!q.started){\n            q.started = true;\n          }\n          if (!_isArray(data)) {\n              data = [data];\n          }\n          if(data.length == 0) {\n             // call drain immediately if there are no tasks\n             return async.setImmediate(function() {\n                 if (q.drain) {\n                     q.drain();\n                 }\n             });\n          }\n          _each(data, function(task) {\n              var item = {\n                  data: task,\n                  priority: priority,\n                  callback: typeof callback === 'function' ? callback : null\n              };\n              \n              q.tasks.splice(_binarySearch(q.tasks, item, _compareTasks) + 1, 0, item);\n\n              if (q.saturated && q.tasks.length === q.concurrency) {\n                  q.saturated();\n              }\n              async.setImmediate(q.process);\n          });\n        }\n        \n        // Start with a normal queue\n        var q = async.queue(worker, concurrency);\n        \n        // Override push to accept second parameter representing priority\n        q.push = function (data, priority, callback) {\n          _insert(q, data, priority, callback);\n        };\n        \n        // Remove unshift function\n        delete q.unshift;\n\n        return q;\n    };\n\n    async.cargo = function (worker, payload) {\n        var working     = false,\n            tasks       = [];\n\n        var cargo = {\n            tasks: tasks,\n            payload: payload,\n            saturated: null,\n            empty: null,\n            drain: null,\n            drained: true,\n            push: function (data, callback) {\n                if (!_isArray(data)) {\n                    data = [data];\n                }\n                _each(data, function(task) {\n                    tasks.push({\n                        data: task,\n                        callback: typeof callback === 'function' ? callback : null\n                    });\n                    cargo.drained = false;\n                    if (cargo.saturated && tasks.length === payload) {\n                        cargo.saturated();\n                    }\n                });\n                async.setImmediate(cargo.process);\n            },\n            process: function process() {\n                if (working) return;\n                if (tasks.length === 0) {\n                    if(cargo.drain && !cargo.drained) cargo.drain();\n                    cargo.drained = true;\n                    return;\n                }\n\n                var ts = typeof payload === 'number'\n                            ? tasks.splice(0, payload)\n                            : tasks.splice(0, tasks.length);\n\n                var ds = _map(ts, function (task) {\n                    return task.data;\n                });\n\n                if(cargo.empty) cargo.empty();\n                working = true;\n                worker(ds, function () {\n                    working = false;\n\n                    var args = arguments;\n                    _each(ts, function (data) {\n                        if (data.callback) {\n                            data.callback.apply(null, args);\n                        }\n                    });\n\n                    process();\n                });\n            },\n            length: function () {\n                return tasks.length;\n            },\n            running: function () {\n                return working;\n            }\n        };\n        return cargo;\n    };\n\n    var _console_fn = function (name) {\n        return function (fn) {\n            var args = Array.prototype.slice.call(arguments, 1);\n            fn.apply(null, args.concat([function (err) {\n                var args = Array.prototype.slice.call(arguments, 1);\n                if (typeof console !== 'undefined') {\n                    if (err) {\n                        if (console.error) {\n                            console.error(err);\n                        }\n                    }\n                    else if (console[name]) {\n                        _each(args, function (x) {\n                            console[name](x);\n                        });\n                    }\n                }\n            }]));\n        };\n    };\n    async.log = _console_fn('log');\n    async.dir = _console_fn('dir');\n    /*async.info = _console_fn('info');\n    async.warn = _console_fn('warn');\n    async.error = _console_fn('error');*/\n\n    async.memoize = function (fn, hasher) {\n        var memo = {};\n        var queues = {};\n        hasher = hasher || function (x) {\n            return x;\n        };\n        var memoized = function () {\n            var args = Array.prototype.slice.call(arguments);\n            var callback = args.pop();\n            var key = hasher.apply(null, args);\n            if (key in memo) {\n                async.nextTick(function () {\n                    callback.apply(null, memo[key]);\n                });\n            }\n            else if (key in queues) {\n                queues[key].push(callback);\n            }\n            else {\n                queues[key] = [callback];\n                fn.apply(null, args.concat([function () {\n                    memo[key] = arguments;\n                    var q = queues[key];\n                    delete queues[key];\n                    for (var i = 0, l = q.length; i < l; i++) {\n                      q[i].apply(null, arguments);\n                    }\n                }]));\n            }\n        };\n        memoized.memo = memo;\n        memoized.unmemoized = fn;\n        return memoized;\n    };\n\n    async.unmemoize = function (fn) {\n      return function () {\n        return (fn.unmemoized || fn).apply(null, arguments);\n      };\n    };\n\n    async.times = function (count, iterator, callback) {\n        var counter = [];\n        for (var i = 0; i < count; i++) {\n            counter.push(i);\n        }\n        return async.map(counter, iterator, callback);\n    };\n\n    async.timesSeries = function (count, iterator, callback) {\n        var counter = [];\n        for (var i = 0; i < count; i++) {\n            counter.push(i);\n        }\n        return async.mapSeries(counter, iterator, callback);\n    };\n\n    async.seq = function (/* functions... */) {\n        var fns = arguments;\n        return function () {\n            var that = this;\n            var args = Array.prototype.slice.call(arguments);\n            var callback = args.pop();\n            async.reduce(fns, args, function (newargs, fn, cb) {\n                fn.apply(that, newargs.concat([function () {\n                    var err = arguments[0];\n                    var nextargs = Array.prototype.slice.call(arguments, 1);\n                    cb(err, nextargs);\n                }]))\n            },\n            function (err, results) {\n                callback.apply(that, [err].concat(results));\n            });\n        };\n    };\n\n    async.compose = function (/* functions... */) {\n      return async.seq.apply(null, Array.prototype.reverse.call(arguments));\n    };\n\n    var _applyEach = function (eachfn, fns /*args...*/) {\n        var go = function () {\n            var that = this;\n            var args = Array.prototype.slice.call(arguments);\n            var callback = args.pop();\n            return eachfn(fns, function (fn, cb) {\n                fn.apply(that, args.concat([cb]));\n            },\n            callback);\n        };\n        if (arguments.length > 2) {\n            var args = Array.prototype.slice.call(arguments, 2);\n            return go.apply(this, args);\n        }\n        else {\n            return go;\n        }\n    };\n    async.applyEach = doParallel(_applyEach);\n    async.applyEachSeries = doSeries(_applyEach);\n\n    async.forever = function (fn, callback) {\n        function next(err) {\n            if (err) {\n                if (callback) {\n                    return callback(err);\n                }\n                throw err;\n            }\n            fn(next);\n        }\n        next();\n    };\n\n    // Node.js\n    if (typeof module !== 'undefined' && module.exports) {\n        module.exports = async;\n    }\n    // AMD / RequireJS\n    else if (typeof define !== 'undefined' && define.amd) {\n        define([], function () {\n            return async;\n        });\n    }\n    // included directly via <script> tag\n    else {\n        root.async = async;\n    }\n\n}());\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/async/lib/async.js","/**\r\n * Implements a simple hash code for a string (see\r\n * https://en.wikipedia.org/wiki/Java_hashCode()).\r\n *\r\n * @param {string} The string to return a hash of.\r\n * @return {Number} the integer hash code of the string.\r\n */\r\nfunction integerHash(string) {\r\n    if (!string) {\r\n        return 0;\r\n    }\r\n\r\n    let char, hash = 0, i;\r\n\r\n    for (i = 0; i < string.length; i++) {\r\n        char = string.charCodeAt(i);\r\n        hash += char * Math.pow(31, string.length - 1 - i);\r\n        hash = Math.abs(hash | 0); // eslint-disable-line no-bitwise\r\n    }\r\n\r\n    return hash;\r\n}\r\n\r\nmodule.exports = { integerHash };\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/util/StringUtils.js","/* global __filename */\r\nimport { getLogger } from 'jitsi-meet-logger';\r\nimport * as JingleSessionState from './JingleSessionState';\r\n\r\nconst logger = getLogger(__filename);\r\n\r\n/**\r\n * JingleSession provides an API to manage a single Jingle session. We will\r\n * have different implementations depending on the underlying interface used\r\n * (i.e. WebRTC and ORTC) and here we hold the code common to all of them.\r\n */\r\nexport default class JingleSession {\r\n\r\n    /* eslint-disable max-params */\r\n\r\n    /**\r\n     * Creates new <tt>JingleSession</tt>.\r\n     * @param {string} sid the Jingle session identifier\r\n     * @param {string} localJid our JID\r\n     * @param {string} remoteJid the JID of the remote peer\r\n     * @param {Strophe.Connection} connection the XMPP connection\r\n     * @param {Object} mediaConstraints the media constraints object passed to\r\n     * the PeerConnection onCreateAnswer/Offer as defined by the WebRTC.\r\n     * @param {Object} iceConfig the ICE servers config object as defined by\r\n     * the WebRTC. Passed to the PeerConnection's constructor.\r\n     */\r\n    constructor(\r\n            sid,\r\n            localJid,\r\n            remoteJid,\r\n            connection,\r\n            mediaConstraints,\r\n            iceConfig) {\r\n        this.sid = sid;\r\n        this.localJid = localJid;\r\n        this.remoteJid = remoteJid;\r\n        this.connection = connection;\r\n        this.mediaConstraints = mediaConstraints;\r\n        this.iceConfig = iceConfig;\r\n\r\n        /**\r\n         * Whether to use dripping or not. Dripping is sending trickle\r\n         * candidates not one-by-one.\r\n         */\r\n        this.usedrip = true;\r\n\r\n        /**\r\n         *  When dripping is used, stores ICE candidates which are to be sent.\r\n         */\r\n        this.dripContainer = [];\r\n\r\n        /**\r\n         * The chat room instance associated with the session.\r\n         * @type {ChatRoom}\r\n         */\r\n        this.room = null;\r\n\r\n        /**\r\n         * Jingle session state - uninitialized until {@link initialize} is\r\n         * called @type {JingleSessionState}\r\n         */\r\n        this.state = null;\r\n\r\n        /**\r\n         * The RTC service instance\r\n         * @type {RTC}\r\n         */\r\n        this.rtc = null;\r\n    }\r\n\r\n    /* eslint-enable max-params */\r\n\r\n    /**\r\n     * Prepares this object to initiate a session.\r\n     * @param {boolean} isInitiator whether we will be the Jingle initiator.\r\n     * @param {ChatRoom} room the chat room for the conference associated with\r\n     * this session\r\n     * @param {RTC} rtc the RTC service instance\r\n     */\r\n    initialize(isInitiator, room, rtc) {\r\n        if (this.state !== null) {\r\n            const errmsg\r\n                = `attempt to initiate on session ${this.sid}\r\n                   in state ${this.state}`;\r\n\r\n            logger.error(errmsg);\r\n            throw new Error(errmsg);\r\n        }\r\n        this.room = room;\r\n        this.rtc = rtc;\r\n        this.state = JingleSessionState.PENDING;\r\n        this.initiator = isInitiator ? this.localJid : this.remoteJid;\r\n        this.responder = isInitiator ? this.remoteJid : this.localJid;\r\n        this.doInitialize();\r\n    }\r\n\r\n    /**\r\n     * The implementing class finishes initialization here. Called at the end of\r\n     * {@link initialize}.\r\n     * @protected\r\n     */\r\n    doInitialize() {} // eslint-disable-line no-empty-function\r\n\r\n    /* eslint-disable no-unused-vars, no-empty-function */\r\n\r\n    /**\r\n     * Adds the ICE candidates found in the 'contents' array as remote\r\n     * candidates?\r\n     * Note: currently only used on transport-info\r\n     *\r\n     * @param contents\r\n     */\r\n    addIceCandidates(contents) {}\r\n\r\n    /* eslint-enable no-unused-vars, no-empty-function */\r\n\r\n    /**\r\n     * Returns current state of this <tt>JingleSession</tt> instance.\r\n     * @returns {JingleSessionState} the current state of this session instance.\r\n     */\r\n    getState() {\r\n        return this.state;\r\n    }\r\n\r\n    /* eslint-disable no-unused-vars, no-empty-function */\r\n\r\n    /**\r\n     * Handles an 'add-source' event.\r\n     *\r\n     * @param contents an array of Jingle 'content' elements.\r\n     */\r\n    addSources(contents) {}\r\n\r\n    /**\r\n     * Handles a 'remove-source' event.\r\n     *\r\n     * @param contents an array of Jingle 'content' elements.\r\n     */\r\n    removeSources(contents) {}\r\n\r\n    /**\r\n     * Terminates this Jingle session by sending session-terminate\r\n     * @param success a callback called once the 'session-terminate' packet has\r\n     * been acknowledged with RESULT.\r\n     * @param failure a callback called when either timeout occurs or ERROR\r\n     * response is received.\r\n     * @param {Object} options\r\n     * @param {string} [options.reason] XMPP Jingle error condition\r\n     * @param {string} [options.reasonDescription] some meaningful error message\r\n     * @param {boolean} [options.sendSessionTerminate=true] set to false to skip\r\n     * sending session-terminate. It may not make sense to send it if the XMPP\r\n     * connection has been closed already or if the remote peer has disconnected\r\n     */\r\n    terminate(success, failure, options) {}\r\n\r\n    /**\r\n     * Handles an offer from the remote peer (prepares to accept a session).\r\n     * @param jingle the 'jingle' XML element.\r\n     * @param success callback called when we the incoming session has been\r\n     * accepted\r\n     * @param failure callback called when we fail for any reason, will supply\r\n     * error object with details(which is meant more to be printed to the logger\r\n     * than analysed in the code, as the error is unrecoverable anyway)\r\n     */\r\n    acceptOffer(jingle, success, failure) {}\r\n\r\n    /**\r\n     * Returns the JID of the initiator of the jingle session.\r\n     */\r\n    _getInitiatorJid() {\r\n        return this.isInitiator ? this.localJid : this.remoteJid;\r\n    }\r\n\r\n    /* eslint-enable no-unused-vars, no-empty-function */\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/xmpp/JingleSession.js","import SDPUtil from './SDPUtil';\r\n\r\n// this could be useful in Array.prototype.\r\n/**\r\n *\r\n * @param array1\r\n * @param array2\r\n */\r\nfunction arrayEquals(array1, array2) {\r\n    // if the other array is a falsy value, return\r\n    if (!array2) {\r\n        return false;\r\n    }\r\n\r\n    // compare lengths - can save a lot of time\r\n    if (array1.length !== array2.length) {\r\n        return false;\r\n    }\r\n\r\n    for (let i = 0, l = array1.length; i < l; i++) {\r\n        // Check if we have nested arrays\r\n        if (array1[i] instanceof Array && array2[i] instanceof Array) {\r\n            // recurse into the nested arrays\r\n            if (!array1[i].equals(array2[i])) {\r\n                return false;\r\n            }\r\n        } else if (array1[i] !== array2[i]) {\r\n            // Warning - two different object instances will never be\r\n            // equal: {x:20} != {x:20}\r\n            return false;\r\n        }\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\n/**\r\n *\r\n * @param mySDP\r\n * @param otherSDP\r\n */\r\nexport default function SDPDiffer(mySDP, otherSDP) {\r\n    this.mySDP = mySDP;\r\n    this.otherSDP = otherSDP;\r\n    if (!mySDP) {\r\n        throw new Error('\"mySDP\" is undefined!');\r\n    } else if (!otherSDP) {\r\n        throw new Error('\"otherSDP\" is undefined!');\r\n    }\r\n}\r\n\r\n/**\r\n * Returns map of MediaChannel that contains media contained in\r\n * 'mySDP', but not contained in 'otherSdp'. Mapped by channel idx.\r\n */\r\nSDPDiffer.prototype.getNewMedia = function() {\r\n\r\n    const myMedias = this.mySDP.getMediaSsrcMap();\r\n    const othersMedias = this.otherSDP.getMediaSsrcMap();\r\n    const newMedia = {};\r\n\r\n    Object.keys(othersMedias).forEach(othersMediaIdx => {\r\n        const myMedia = myMedias[othersMediaIdx];\r\n        const othersMedia = othersMedias[othersMediaIdx];\r\n\r\n        if (!myMedia && othersMedia) {\r\n            // Add whole channel\r\n            newMedia[othersMediaIdx] = othersMedia;\r\n\r\n            return;\r\n        }\r\n\r\n        // Look for new ssrcs across the channel\r\n        Object.keys(othersMedia.ssrcs).forEach(ssrc => {\r\n            if (Object.keys(myMedia.ssrcs).indexOf(ssrc) === -1) {\r\n                // Allocate channel if we've found ssrc that doesn't exist in\r\n                // our channel\r\n                if (!newMedia[othersMediaIdx]) {\r\n                    newMedia[othersMediaIdx] = {\r\n                        mediaindex: othersMedia.mediaindex,\r\n                        mid: othersMedia.mid,\r\n                        ssrcs: {},\r\n                        ssrcGroups: []\r\n                    };\r\n                }\r\n                newMedia[othersMediaIdx].ssrcs[ssrc] = othersMedia.ssrcs[ssrc];\r\n            }\r\n        });\r\n\r\n        // Look for new ssrc groups across the channels\r\n        othersMedia.ssrcGroups.forEach(otherSsrcGroup => {\r\n\r\n            // try to match the other ssrc-group with an ssrc-group of ours\r\n            let matched = false;\r\n\r\n            for (let i = 0; i < myMedia.ssrcGroups.length; i++) {\r\n                const mySsrcGroup = myMedia.ssrcGroups[i];\r\n\r\n                if (otherSsrcGroup.semantics === mySsrcGroup.semantics\r\n                    && arrayEquals(otherSsrcGroup.ssrcs, mySsrcGroup.ssrcs)) {\r\n\r\n                    matched = true;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (!matched) {\r\n                // Allocate channel if we've found an ssrc-group that doesn't\r\n                // exist in our channel\r\n\r\n                if (!newMedia[othersMediaIdx]) {\r\n                    newMedia[othersMediaIdx] = {\r\n                        mediaindex: othersMedia.mediaindex,\r\n                        mid: othersMedia.mid,\r\n                        ssrcs: {},\r\n                        ssrcGroups: []\r\n                    };\r\n                }\r\n                newMedia[othersMediaIdx].ssrcGroups.push(otherSsrcGroup);\r\n            }\r\n        });\r\n    });\r\n\r\n    return newMedia;\r\n};\r\n\r\n/**\r\n * TODO: document!\r\n */\r\nSDPDiffer.prototype.toJingle = function(modify) {\r\n    const sdpMediaSsrcs = this.getNewMedia();\r\n\r\n    let modified = false;\r\n\r\n    Object.keys(sdpMediaSsrcs).forEach(mediaindex => {\r\n        modified = true;\r\n        const media = sdpMediaSsrcs[mediaindex];\r\n\r\n        modify.c('content', { name: media.mid });\r\n\r\n        modify.c('description',\r\n            { xmlns: 'urn:xmpp:jingle:apps:rtp:1',\r\n                media: media.mid });\r\n\r\n        // FIXME: not completely sure this operates on blocks and / or handles\r\n        // different ssrcs correctly\r\n        // generate sources from lines\r\n        Object.keys(media.ssrcs).forEach(ssrcNum => {\r\n            const mediaSsrc = media.ssrcs[ssrcNum];\r\n\r\n            modify.c('source', { xmlns: 'urn:xmpp:jingle:apps:rtp:ssma:0' });\r\n            modify.attrs({ ssrc: mediaSsrc.ssrc });\r\n\r\n            // iterate over ssrc lines\r\n            mediaSsrc.lines.forEach(line => {\r\n                const idx = line.indexOf(' ');\r\n                const kv = line.substr(idx + 1);\r\n\r\n                modify.c('parameter');\r\n                if (kv.indexOf(':') === -1) {\r\n                    modify.attrs({ name: kv });\r\n                } else {\r\n                    const nv = kv.split(':', 2);\r\n                    const name = nv[0];\r\n                    const value = SDPUtil.filterSpecialChars(nv[1]);\r\n\r\n                    modify.attrs({ name });\r\n                    modify.attrs({ value });\r\n                }\r\n                modify.up(); // end of parameter\r\n            });\r\n            modify.up(); // end of source\r\n        });\r\n\r\n        // generate source groups from lines\r\n        media.ssrcGroups.forEach(ssrcGroup => {\r\n            if (ssrcGroup.ssrcs.length) {\r\n\r\n                modify.c('ssrc-group', {\r\n                    semantics: ssrcGroup.semantics,\r\n                    xmlns: 'urn:xmpp:jingle:apps:rtp:ssma:0'\r\n                });\r\n\r\n                ssrcGroup.ssrcs.forEach(ssrc => {\r\n                    modify.c('source', { ssrc })\r\n                        .up(); // end of source\r\n                });\r\n                modify.up(); // end of ssrc-group\r\n            }\r\n        });\r\n\r\n        modify.up(); // end of description\r\n        modify.up(); // end of content\r\n    });\r\n\r\n    return modified;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/xmpp/SDPDiffer.js","/* global __filename */\r\n\r\nimport { getLogger } from 'jitsi-meet-logger';\r\nimport * as MediaType from '../../service/RTC/MediaType';\r\nimport * as SignalingEvents from '../../service/RTC/SignalingEvents';\r\nimport SignalingLayer from '../../service/RTC/SignalingLayer';\r\n\r\nconst logger = getLogger(__filename);\r\n\r\n/**\r\n * Default XMPP implementation of the {@link SignalingLayer} interface. Obtains\r\n * the data from the MUC presence.\r\n */\r\nexport default class SignalingLayerImpl extends SignalingLayer {\r\n    /**\r\n     * Creates new instance.\r\n     */\r\n    constructor() {\r\n        super();\r\n\r\n        /**\r\n         * A map that stores SSRCs of remote streams. And is used only locally\r\n         * We store the mapping when jingle is received, and later is used\r\n         * onaddstream webrtc event where we have only the ssrc\r\n         * FIXME: This map got filled and never cleaned and can grow during long\r\n         * conference\r\n         * @type {Map<number, string>} maps SSRC number to jid\r\n         */\r\n        this.ssrcOwners = new Map();\r\n\r\n        /**\r\n         *\r\n         * @type {ChatRoom|null}\r\n         */\r\n        this.chatRoom = null;\r\n    }\r\n\r\n    /**\r\n     * Sets the <tt>ChatRoom</tt> instance used and binds presence listeners.\r\n     * @param {ChatRoom} room\r\n     */\r\n    setChatRoom(room) {\r\n        const oldChatRoom = this.chatRoom;\r\n\r\n        this.chatRoom = room;\r\n        if (oldChatRoom) {\r\n            oldChatRoom.removePresenceListener(\r\n                'audiomuted', this._audioMuteHandler);\r\n            oldChatRoom.removePresenceListener(\r\n                'videomuted', this._videoMuteHandler);\r\n            oldChatRoom.removePresenceListener(\r\n                'videoType', this._videoTypeHandler);\r\n        }\r\n        if (room) {\r\n            // SignalingEvents\r\n            this._audioMuteHandler = (node, from) => {\r\n                this.eventEmitter.emit(\r\n                    SignalingEvents.PEER_MUTED_CHANGED,\r\n                    from, MediaType.AUDIO, node.value === 'true');\r\n            };\r\n            room.addPresenceListener('audiomuted', this._audioMuteHandler);\r\n\r\n            this._videoMuteHandler = (node, from) => {\r\n                this.eventEmitter.emit(\r\n                    SignalingEvents.PEER_MUTED_CHANGED,\r\n                    from, MediaType.VIDEO, node.value === 'true');\r\n            };\r\n            room.addPresenceListener('videomuted', this._videoMuteHandler);\r\n\r\n            this._videoTypeHandler = (node, from) => {\r\n                this.eventEmitter.emit(\r\n                    SignalingEvents.PEER_VIDEO_TYPE_CHANGED,\r\n                    from, node.value);\r\n            };\r\n            room.addPresenceListener('videoType', this._videoTypeHandler);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     */\r\n    getPeerMediaInfo(owner, mediaType) {\r\n        if (this.chatRoom) {\r\n            return this.chatRoom.getMediaPresenceInfo(owner, mediaType);\r\n        }\r\n        logger.error('Requested peer media info, before room was set');\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     */\r\n    getSSRCOwner(ssrc) {\r\n        return this.ssrcOwners.get(ssrc);\r\n    }\r\n\r\n    /**\r\n     * Set an SSRC owner.\r\n     * @param {number} ssrc an SSRC to be owned\r\n     * @param {string} endpointId owner's ID (MUC nickname)\r\n     * @throws TypeError if <tt>ssrc</tt> is not a number\r\n     */\r\n    setSSRCOwner(ssrc, endpointId) {\r\n        if (typeof ssrc !== 'number') {\r\n            throw new TypeError(`SSRC(${ssrc}) must be a number`);\r\n        }\r\n        this.ssrcOwners.set(ssrc, endpointId);\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/xmpp/SignalingLayerImpl.js","\r\nimport Listenable from '../../modules/util/Listenable';\r\n\r\n/**\r\n * An object that carries the info about specific media type advertised by\r\n * participant in the signaling channel.\r\n * @typedef {Object} PeerMediaInfo\r\n * @property {boolean} muted indicates if the media is currently muted\r\n * @property {VideoType|undefined} videoType the type of the video if applicable\r\n */\r\n\r\n/**\r\n * Interface used to expose the information carried over the signaling channel\r\n * which is not available to the RTC module in the media SDP.\r\n *\r\n * @interface SignalingLayer\r\n */\r\nexport default class SignalingLayer extends Listenable {\r\n\r\n    /**\r\n     * Obtains the endpoint ID for given SSRC.\r\n     * @param {number} ssrc the SSRC number.\r\n     * @return {string|null} the endpoint ID for given media SSRC.\r\n     */\r\n    getSSRCOwner(ssrc) { // eslint-disable-line no-unused-vars\r\n        throw new Error('not implemented');\r\n    }\r\n\r\n    /**\r\n     * Obtains the info about given media advertised in the MUC presence of\r\n     * the participant identified by the given MUC JID.\r\n     * @param {string} owner the MUC jid of the participant for whom\r\n     * {@link PeerMediaInfo} will be obtained.\r\n     * @param {MediaType} mediaType the type of the media for which presence\r\n     * info will be obtained.\r\n     * @return {PeerMediaInfo|null} presenceInfo an object with media presence\r\n     * info or <tt>null</tt> either if there is no presence available for given\r\n     * JID or if the media type given is invalid.\r\n     */\r\n    getPeerMediaInfo(owner, mediaType) { // eslint-disable-line no-unused-vars\r\n        throw new Error('not implemented');\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./service/RTC/SignalingLayer.js","/* global __filename */\r\n/**\r\n * Strophe logger implementation. Logs from level WARN and above.\r\n */\r\nimport { getLogger } from 'jitsi-meet-logger';\r\nimport { Strophe } from 'strophe.js';\r\n\r\nimport GlobalOnErrorHandler from '../util/GlobalOnErrorHandler';\r\n\r\nconst logger = getLogger(__filename);\r\n\r\n/**\r\n * This is the last HTTP error status captured from Strophe debug logs.\r\n * The purpose of storing it is to distinguish between the network and\r\n * infrastructure reason for connection being dropped (see connectionHandler in\r\n * xmpp.js). The value will be cleared (-1) if the subsequent request succeeds\r\n * which means that the failure could be transient.\r\n *\r\n * FIXME in the latest Strophe (not released on npm) there is API to handle\r\n * particular HTTP errors, but there is no way to learn if the subsequent\r\n * request succeeded in order to tell if the error was one time incident or if\r\n * it was the reason for dropping the connection by Strophe (the connection is\r\n * dropped after 5 subsequent failures). Ideally Strophe should provide more\r\n * details about the reason on why the connection stopped.\r\n *\r\n * @type {number}\r\n */\r\nlet lastErrorStatus = -1;\r\n\r\n/**\r\n * A regular expression used to catch Strophe's log message indicating that the\r\n * last BOSH request was successful. When there is such message seen the\r\n * {@link lastErrorStatus} will be set back to '-1'.\r\n * @type {RegExp}\r\n */\r\nconst resetLastErrorStatusRegExpr = /request id \\d+.\\d+ got 200/;\r\n\r\n/**\r\n * A regular expression used to capture the current value of the BOSH request\r\n * error status (HTTP error code or '0' or something else).\r\n * @type {RegExp}\r\n */\r\nconst lastErrorStatusRegExpr\r\n    = /request errored, status: (\\d+), number of errors: \\d+/;\r\n\r\n/**\r\n *\r\n */\r\nexport default function() {\r\n\r\n    Strophe.log = function(level, msg) {\r\n        // Our global handler reports uncaught errors to the stats which may\r\n        // interpret those as partial call failure.\r\n        // Strophe log entry about secondary request timeout does not mean that\r\n        // it's a final failure(the request will be restarted), so we lower it's\r\n        // level here to a warning.\r\n        logger.trace('Strophe', level, msg);\r\n        if (typeof msg === 'string'\r\n                && msg.indexOf('Request ') !== -1\r\n                && msg.indexOf('timed out (secondary), restarting') !== -1) {\r\n            // eslint-disable-next-line no-param-reassign\r\n            level = Strophe.LogLevel.WARN;\r\n        }\r\n\r\n        /* eslint-disable no-case-declarations */\r\n        switch (level) {\r\n        case Strophe.LogLevel.DEBUG:\r\n            // The log message which reports successful status is logged on\r\n            // Strophe's DEBUG level.\r\n            if (lastErrorStatus !== -1\r\n                    && resetLastErrorStatusRegExpr.test(msg)) {\r\n                logger.debug('Reset lastErrorStatus');\r\n                lastErrorStatus = -1;\r\n            }\r\n            break;\r\n        case Strophe.LogLevel.WARN:\r\n            logger.warn(`Strophe: ${msg}`);\r\n            const errStatusCapture = lastErrorStatusRegExpr.exec(msg);\r\n\r\n            if (errStatusCapture && errStatusCapture.length === 2) {\r\n                lastErrorStatus = parseInt(errStatusCapture[1], 10);\r\n                logger.debug(`lastErrorStatus set to: ${lastErrorStatus}`);\r\n            }\r\n            break;\r\n        case Strophe.LogLevel.ERROR:\r\n        case Strophe.LogLevel.FATAL:\r\n            // eslint-disable-next-line no-param-reassign\r\n            msg = `Strophe: ${msg}`;\r\n            GlobalOnErrorHandler.callErrorHandler(new Error(msg));\r\n            logger.error(msg);\r\n            break;\r\n        }\r\n\r\n        /* eslint-enable no-case-declarations */\r\n    };\r\n\r\n    /**\r\n     * Returns error status (HTTP error code) of the last BOSH request.\r\n     *\r\n     * @return {number} HTTP error code, '0' for unknown or \"god knows what\"\r\n     * (this is a hack).\r\n     */\r\n    Strophe.getLastErrorStatus = function() {\r\n        return lastErrorStatus;\r\n    };\r\n\r\n    Strophe.getStatusString = function(status) {\r\n        switch (status) {\r\n        case Strophe.Status.ERROR:\r\n            return 'ERROR';\r\n        case Strophe.Status.CONNECTING:\r\n            return 'CONNECTING';\r\n        case Strophe.Status.CONNFAIL:\r\n            return 'CONNFAIL';\r\n        case Strophe.Status.AUTHENTICATING:\r\n            return 'AUTHENTICATING';\r\n        case Strophe.Status.AUTHFAIL:\r\n            return 'AUTHFAIL';\r\n        case Strophe.Status.CONNECTED:\r\n            return 'CONNECTED';\r\n        case Strophe.Status.DISCONNECTED:\r\n            return 'DISCONNECTED';\r\n        case Strophe.Status.DISCONNECTING:\r\n            return 'DISCONNECTING';\r\n        case Strophe.Status.ATTACHED:\r\n            return 'ATTACHED';\r\n        default:\r\n            return 'unknown';\r\n        }\r\n    };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/xmpp/strophe.util.js","import { getLogger } from 'jitsi-meet-logger';\r\nimport { $iq, Strophe } from 'strophe.js';\r\n\r\nimport GlobalOnErrorHandler from '../util/GlobalOnErrorHandler';\r\n\r\nimport ConnectionPlugin from './ConnectionPlugin';\r\n\r\n\r\nconst logger = getLogger(__filename);\r\n\r\n/**\r\n * Ping every 10 sec\r\n */\r\nconst PING_INTERVAL = 10000;\r\n\r\n/**\r\n * Ping timeout error after 15 sec of waiting.\r\n */\r\nconst PING_TIMEOUT = 15000;\r\n\r\n/**\r\n * Will close the connection after 3 consecutive ping errors.\r\n */\r\nconst PING_THRESHOLD = 3;\r\n\r\n/**\r\n * The number of timestamps of send pings to keep.\r\n * The current value is 2 minutes.\r\n * @type {number} number of timestamps.\r\n */\r\nconst PING_TIMESTAMPS_TO_KEEP = 120000 / PING_INTERVAL;\r\n\r\n/**\r\n * XEP-0199 ping plugin.\r\n *\r\n * Registers \"urn:xmpp:ping\" namespace under Strophe.NS.PING.\r\n */\r\nclass PingConnectionPlugin extends ConnectionPlugin {\r\n    /**\r\n     * Contructs new object\r\n     * @param {XMPP} xmpp the xmpp module.\r\n     * @constructor\r\n     */\r\n    constructor(xmpp) {\r\n        super();\r\n        this.failedPings = 0;\r\n        this.xmpp = xmpp;\r\n        this.pingExecIntervals = new Array(PING_TIMESTAMPS_TO_KEEP);\r\n    }\r\n\r\n    /**\r\n     * Initializes the plugin. Method called by Strophe.\r\n     * @param connection Strophe connection instance.\r\n     */\r\n    init(connection) {\r\n        super.init(connection);\r\n        Strophe.addNamespace('PING', 'urn:xmpp:ping');\r\n    }\r\n\r\n    /* eslint-disable max-params */\r\n\r\n    /**\r\n     * Sends \"ping\" to given <tt>jid</tt>\r\n     * @param jid the JID to which ping request will be sent.\r\n     * @param success callback called on success.\r\n     * @param error callback called on error.\r\n     * @param timeout ms how long are we going to wait for the response. On\r\n     * timeout <tt>error<//t> callback is called with undefined error argument.\r\n     */\r\n    ping(jid, success, error, timeout) {\r\n        this._addPingExecutionTimestamp();\r\n\r\n        const iq = $iq({\r\n            type: 'get',\r\n            to: jid\r\n        });\r\n\r\n        iq.c('ping', { xmlns: Strophe.NS.PING });\r\n        this.connection.sendIQ(iq, success, error, timeout);\r\n    }\r\n\r\n    /* eslint-enable max-params */\r\n\r\n    /**\r\n     * Checks if given <tt>jid</tt> has XEP-0199 ping support.\r\n     * @param jid the JID to be checked for ping support.\r\n     * @param callback function with boolean argument which will be\r\n     * <tt>true</tt> if XEP-0199 ping is supported by given <tt>jid</tt>\r\n     */\r\n    hasPingSupport(jid, callback) {\r\n        this.xmpp.caps.getFeatures(jid).then(features =>\r\n            callback(features.has('urn:xmpp:ping')), error => {\r\n            const errmsg = 'Ping feature discovery error';\r\n\r\n            GlobalOnErrorHandler.callErrorHandler(\r\n                new Error(`${errmsg}: ${error}`));\r\n            logger.error(errmsg, error);\r\n            callback(false);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Starts to send ping in given interval to specified remote JID.\r\n     * This plugin supports only one such task and <tt>stopInterval</tt>\r\n     * must be called before starting a new one.\r\n     * @param remoteJid remote JID to which ping requests will be sent to.\r\n     * @param interval task interval in ms.\r\n     */\r\n    startInterval(remoteJid, interval = PING_INTERVAL) {\r\n        if (this.intervalId) {\r\n            const errmsg = 'Ping task scheduled already';\r\n\r\n            GlobalOnErrorHandler.callErrorHandler(new Error(errmsg));\r\n            logger.error(errmsg);\r\n\r\n            return;\r\n        }\r\n        this.intervalId = window.setInterval(() => {\r\n            this.ping(remoteJid, () => {\r\n                this.failedPings = 0;\r\n            }, error => {\r\n                this.failedPings += 1;\r\n                const errmsg = `Ping ${error ? 'error' : 'timeout'}`;\r\n\r\n                if (this.failedPings >= PING_THRESHOLD) {\r\n                    GlobalOnErrorHandler.callErrorHandler(new Error(errmsg));\r\n                    logger.error(errmsg, error);\r\n\r\n                    // FIXME it doesn't help to disconnect when 3rd PING\r\n                    // times out, it only stops Strophe from retrying.\r\n                    // Not really sure what's the right thing to do in that\r\n                    // situation, but just closing the connection makes no\r\n                    // sense.\r\n                    // self.connection.disconnect();\r\n                } else {\r\n                    logger.warn(errmsg, error);\r\n                }\r\n            }, PING_TIMEOUT);\r\n        }, interval);\r\n        logger.info(`XMPP pings will be sent every ${interval} ms`);\r\n    }\r\n\r\n    /**\r\n     * Stops current \"ping\"  interval task.\r\n     */\r\n    stopInterval() {\r\n        if (this.intervalId) {\r\n            window.clearInterval(this.intervalId);\r\n            this.intervalId = null;\r\n            this.failedPings = 0;\r\n            logger.info('Ping interval cleared');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Adds the current time to the array of send ping timestamps.\r\n     * @private\r\n     */\r\n    _addPingExecutionTimestamp() {\r\n        this.pingExecIntervals.push(new Date().getTime());\r\n\r\n        // keep array length to PING_TIMESTAMPS_TO_KEEP\r\n        if (this.pingExecIntervals.length > PING_TIMESTAMPS_TO_KEEP) {\r\n            this.pingExecIntervals.shift();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns the maximum time between the recent sent pings, if there is a\r\n     * big value it means the computer was inactive for some time(suspended).\r\n     * Checks the maximum gap between sending pings, considering and the\r\n     * current time. Trying to detect computer inactivity (sleep).\r\n     *\r\n     * @returns {int} the time ping was suspended, if it was not 0 is returned.\r\n     */\r\n    getPingSuspendTime() {\r\n        const pingIntervals = this.pingExecIntervals.slice();\r\n\r\n        // we need current time, as if ping was sent now\r\n        // if computer sleeps we will get correct interval after next\r\n        // scheduled ping, bet we sometimes need that interval before waiting\r\n        // for the next ping, on closing the connection on error.\r\n        pingIntervals.push(new Date().getTime());\r\n\r\n        let maxInterval = 0;\r\n        let previousTS = pingIntervals[0];\r\n\r\n        pingIntervals.forEach(e => {\r\n            const currentInterval = e - previousTS;\r\n\r\n            if (currentInterval > maxInterval) {\r\n                maxInterval = currentInterval;\r\n            }\r\n\r\n            previousTS = e;\r\n        });\r\n\r\n        // remove the interval between the ping sent\r\n        // this way in normal execution there is no suspend and the return\r\n        // will be 0 or close to 0.\r\n        maxInterval -= PING_INTERVAL;\r\n\r\n        // make sure we do not return less than 0\r\n        return Math.max(maxInterval, 0);\r\n    }\r\n}\r\n\r\n/**\r\n *\r\n * @param xmpp\r\n */\r\nexport default function(xmpp) {\r\n    Strophe.addConnectionPlugin('ping', new PingConnectionPlugin(xmpp));\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/xmpp/strophe.ping.js","/* global $ */\r\n\r\nimport { getLogger } from 'jitsi-meet-logger';\r\nimport { $iq, Strophe } from 'strophe.js';\r\n\r\nimport ConnectionPlugin from './ConnectionPlugin';\r\n\r\nconst logger = getLogger(__filename);\r\n\r\nconst RAYO_XMLNS = 'urn:xmpp:rayo:1';\r\n\r\n/**\r\n *\r\n */\r\nclass RayoConnectionPlugin extends ConnectionPlugin {\r\n    /**\r\n     *\r\n     * @param connection\r\n     */\r\n    init(connection) {\r\n        super.init(connection);\r\n\r\n        this.connection.addHandler(\r\n            this.onRayo.bind(this), RAYO_XMLNS, 'iq', 'set', null, null);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param iq\r\n     */\r\n    onRayo(iq) {\r\n        logger.info('Rayo IQ', iq);\r\n    }\r\n\r\n    /* eslint-disable max-params */\r\n\r\n    /**\r\n     *\r\n     * @param to\r\n     * @param from\r\n     * @param roomName\r\n     * @param roomPass\r\n     * @param focusMucJid\r\n     */\r\n    dial(to, from, roomName, roomPass, focusMucJid) {\r\n        return new Promise((resolve, reject) => {\r\n            if (!focusMucJid) {\r\n                reject(new Error('Internal error!'));\r\n\r\n                return;\r\n            }\r\n            const req = $iq({\r\n                type: 'set',\r\n                to: focusMucJid\r\n            });\r\n\r\n            req.c('dial', {\r\n                xmlns: RAYO_XMLNS,\r\n                to,\r\n                from\r\n            });\r\n            req.c('header', {\r\n                name: 'JvbRoomName',\r\n                value: roomName\r\n            }).up();\r\n\r\n            if (roomPass && roomPass.length) {\r\n                req.c('header', {\r\n                    name: 'JvbRoomPassword',\r\n                    value: roomPass\r\n                }).up();\r\n            }\r\n\r\n            this.connection.sendIQ(\r\n                req,\r\n                result => {\r\n                    logger.info('Dial result ', result);\r\n\r\n                    // eslint-disable-next-line newline-per-chained-call\r\n                    const resource = $(result).find('ref').attr('uri');\r\n\r\n                    this.callResource = resource.substr('xmpp:'.length);\r\n                    logger.info(`Received call resource: ${this.callResource}`);\r\n                    resolve();\r\n                },\r\n                error => {\r\n                    logger.info('Dial error ', error);\r\n                    reject(error);\r\n                });\r\n        });\r\n    }\r\n\r\n    /* eslint-enable max-params */\r\n\r\n    /**\r\n     *\r\n     */\r\n    hangup() {\r\n        return new Promise((resolve, reject) => {\r\n            if (!this.callResource) {\r\n                reject(new Error('No call in progress'));\r\n                logger.warn('No call in progress');\r\n\r\n                return;\r\n            }\r\n\r\n            const req = $iq({\r\n                type: 'set',\r\n                to: this.callResource\r\n            });\r\n\r\n            req.c('hangup', {\r\n                xmlns: RAYO_XMLNS\r\n            });\r\n\r\n            this.connection.sendIQ(req, result => {\r\n                logger.info('Hangup result ', result);\r\n                this.callResource = null;\r\n                resolve();\r\n            }, error => {\r\n                logger.info('Hangup error ', error);\r\n                this.callResource = null;\r\n                reject(new Error('Hangup error '));\r\n            });\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n *\r\n */\r\nexport default function() {\r\n    Strophe.addConnectionPlugin('rayo', new RayoConnectionPlugin());\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/xmpp/strophe.rayo.js","import { Strophe } from 'strophe.js';\r\n\r\nimport ConnectionPlugin from './ConnectionPlugin';\r\n\r\n/**\r\n *  Logs raw stanzas and makes them available for download as JSON\r\n */\r\nclass StropheLogger extends ConnectionPlugin {\r\n    /**\r\n     *\r\n     */\r\n    constructor() {\r\n        super();\r\n        this.log = [];\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param connection\r\n     */\r\n    init(connection) {\r\n        super.init(connection);\r\n        this.connection.rawInput = this.logIncoming.bind(this);\r\n        this.connection.rawOutput = this.logOutgoing.bind(this);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param stanza\r\n     */\r\n    logIncoming(stanza) {\r\n        this.log.push([ new Date().getTime(), 'incoming', stanza ]);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param stanza\r\n     */\r\n    logOutgoing(stanza) {\r\n        this.log.push([ new Date().getTime(), 'outgoing', stanza ]);\r\n    }\r\n}\r\n\r\n/**\r\n *\r\n */\r\nexport default function() {\r\n    Strophe.addConnectionPlugin('logger', new StropheLogger());\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/xmpp/strophe.logger.js","/* global $ */\r\n\r\nimport { b64_sha1, Strophe } from 'strophe.js'; // eslint-disable-line camelcase\r\n\r\nimport XMPPEvents from '../../service/xmpp/XMPPEvents';\r\nimport Listenable from '../util/Listenable';\r\n\r\n/**\r\n * The property\r\n */\r\nconst IDENTITY_PROPERTIES = [ 'category', 'type', 'lang', 'name' ];\r\nconst IDENTITY_PROPERTIES_FOR_COMPARE = [ 'category', 'type', 'lang' ];\r\nconst HASH = 'sha-1';\r\n\r\n/**\r\n *\r\n * @param a\r\n * @param b\r\n */\r\nfunction compareIdentities(a, b) {\r\n    let res = 0;\r\n\r\n    IDENTITY_PROPERTIES_FOR_COMPARE.some(key =>\r\n        (res = ((a[key] > b[key]) && 1) || ((a[key] < b[key]) && -1)) !== 0\r\n    );\r\n\r\n    return res;\r\n}\r\n\r\n/**\r\n * Implements xep-0115 ( http://xmpp.org/extensions/xep-0115.html )\r\n */\r\nexport default class Caps extends Listenable {\r\n    /**\r\n     * Constructs new Caps instance.\r\n     * @param {Strophe.Connection} connection the strophe connection object\r\n     * @param {String} node the value of the node attribute of the \"c\" xml node\r\n     * that will be sent to the other participants\r\n     */\r\n    constructor(connection = {}, node = 'http://jitsi.org/jitsimeet') {\r\n        super();\r\n        this.node = node;\r\n        this.disco = connection.disco;\r\n        if (!this.disco) {\r\n            throw new Error(\r\n                'Missing strophe-plugins '\r\n                + '(disco plugin is required)!');\r\n        }\r\n\r\n        this.versionToCapabilities = Object.create(null);\r\n        this.jidToVersion = Object.create(null);\r\n        this.version = '';\r\n        this.rooms = new Set();\r\n\r\n        const emuc = connection.emuc;\r\n\r\n        emuc.addListener(XMPPEvents.EMUC_ROOM_ADDED,\r\n            room => this._addChatRoom(room));\r\n        emuc.addListener(XMPPEvents.EMUC_ROOM_REMOVED,\r\n            room => this._removeChatRoom(room));\r\n        Object.keys(emuc.rooms).forEach(jid => {\r\n            this._addChatRoom(emuc.rooms[jid]);\r\n        });\r\n\r\n        Strophe.addNamespace('CAPS', 'http://jabber.org/protocol/caps');\r\n        this.disco.addFeature(Strophe.NS.CAPS);\r\n        connection.addHandler(this._handleCaps.bind(this), Strophe.NS.CAPS);\r\n\r\n        this._onMucMemberLeft = this._removeJidToVersionEntry.bind(this);\r\n    }\r\n\r\n    /**\r\n     * Adds new feature to the list of supported features for the local\r\n     * participant\r\n     * @param {String} feature the name of the feature.\r\n     * @param {boolean} submit if true - new presence with updated \"c\" node\r\n     * will be sent.\r\n     */\r\n    addFeature(feature, submit = false) {\r\n        this.disco.addFeature(feature);\r\n        this._generateVersion();\r\n        if (submit) {\r\n            this.submit();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Removes a feature from the list of supported features for the local\r\n     * participant\r\n     * @param {String} feature the name of the feature.\r\n     * @param {boolean} submit if true - new presence with updated \"c\" node\r\n     * will be sent.\r\n     */\r\n    removeFeature(feature, submit = false) {\r\n        this.disco.removeFeature(feature);\r\n        this._generateVersion();\r\n        if (submit) {\r\n            this.submit();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Sends new presence stanza for every room from the list of rooms.\r\n     */\r\n    submit() {\r\n        this.rooms.forEach(room => room.sendPresence());\r\n    }\r\n\r\n    /**\r\n     * Returns a set with the features for a participant.\r\n     * @param {String} jid the jid of the participant\r\n     * @param {int} timeout the timeout in ms for reply from the participant.\r\n     * @returns {Promise<Set<String>, Error>}\r\n     */\r\n    getFeatures(jid, timeout = 5000) {\r\n        const user\r\n            = jid in this.jidToVersion ? this.jidToVersion[jid] : null;\r\n\r\n        if (!user || !(user.version in this.versionToCapabilities)) {\r\n            const node = user ? `${user.node}#${user.version}` : null;\r\n\r\n\r\n            return new Promise((resolve, reject) =>\r\n                this.disco.info(jid, node, response => {\r\n                    const features = new Set();\r\n\r\n                    $(response)\r\n                        .find('>query>feature')\r\n                        .each(\r\n                            (idx, el) => features.add(el.getAttribute('var')));\r\n                    if (user) {\r\n                        // TODO: Maybe use the version + node + hash as keys?\r\n                        this.versionToCapabilities[user.version] = features;\r\n                    }\r\n                    resolve(features);\r\n                }, reject, timeout)\r\n            );\r\n        }\r\n\r\n        return Promise.resolve(this.versionToCapabilities[user.version]);\r\n    }\r\n\r\n    /**\r\n     * Adds ChatRoom instance to the list of rooms. Adds listeners to the room\r\n     * and adds \"c\" element to the presences of the room.\r\n     * @param {ChatRoom} room the room.\r\n     */\r\n    _addChatRoom(room) {\r\n        this.rooms.add(room);\r\n        room.addListener(XMPPEvents.MUC_MEMBER_LEFT, this._onMucMemberLeft);\r\n        this._fixChatRoomPresenceMap(room);\r\n    }\r\n\r\n    /**\r\n     * Removes ChatRoom instance from the list of rooms. Removes listeners\r\n     * added from the Caps class.\r\n     * @param {ChatRoom} room the room.\r\n     */\r\n    _removeChatRoom(room) {\r\n        this.rooms.delete(room);\r\n        room.removeListener(XMPPEvents.MUC_MEMBER_LEFT, this._onMucMemberLeft);\r\n    }\r\n\r\n    /**\r\n     * Creates/updates the \"c\" xml node into the presence of the passed room.\r\n     * @param {ChatRoom} room the room.\r\n     */\r\n    _fixChatRoomPresenceMap(room) {\r\n        room.addToPresence('c', {\r\n            attributes: {\r\n                xmlns: Strophe.NS.CAPS,\r\n                hash: HASH,\r\n                node: this.node,\r\n                ver: this.version\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Handles this.version changes.\r\n     */\r\n    _notifyVersionChanged() {\r\n        // update the version for all rooms\r\n        this.rooms.forEach(room => this._fixChatRoomPresenceMap(room));\r\n        this.submit();\r\n    }\r\n\r\n    /**\r\n     * Generates the value for the \"ver\" attribute.\r\n     */\r\n    _generateVersion() {\r\n        const identities\r\n          = this.disco._identities.sort(compareIdentities).reduce(\r\n              (accumulatedValue, identity) =>\r\n                  `${\r\n                      IDENTITY_PROPERTIES.reduce(\r\n                          (tmp, key, idx) =>\r\n                              tmp\r\n                                  + (idx === 0 ? '' : '/')\r\n                                  + identity[key],\r\n                          '')\r\n                  }<`,\r\n              '');\r\n        const features\r\n            = this.disco._features.sort().reduce(\r\n                (tmp, feature) => `${tmp + feature}<`, '');\r\n\r\n        this.version = b64_sha1(identities + features);\r\n        this._notifyVersionChanged();\r\n    }\r\n\r\n    /**\r\n     * Parses the \"c\" xml node from presence.\r\n     * @param {DOMElement} stanza the presence packet\r\n     */\r\n    _handleCaps(stanza) {\r\n        const from = stanza.getAttribute('from');\r\n        const caps = stanza.querySelector('c');\r\n        const version = caps.getAttribute('ver');\r\n        const node = caps.getAttribute('node');\r\n        const oldVersion = this.jidToVersion[from];\r\n\r\n        this.jidToVersion[from] = { version,\r\n            node };\r\n        if (oldVersion && oldVersion.version !== version) {\r\n            this.eventEmitter.emit(XMPPEvents.PARTCIPANT_FEATURES_CHANGED,\r\n                from);\r\n        }\r\n\r\n        // return true to not remove the handler from Strophe\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Removes entry from this.jidToVersion map.\r\n     * @param {String} jid the jid to be removed.\r\n     */\r\n    _removeJidToVersionEntry(jid) {\r\n        if (jid in this.jidToVersion) {\r\n            delete this.jidToVersion[jid];\r\n        }\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/xmpp/Caps.js","/* global __filename */\r\nimport { Strophe } from 'strophe.js';\r\n\r\nimport {\r\n    ACTION_JINGLE_SA_TIMEOUT,\r\n    createBridgeDownEvent,\r\n    createConnectionStageReachedEvent,\r\n    createFocusLeftEvent,\r\n    createJingleEvent,\r\n    createRemotelyMutedEvent\r\n} from './service/statistics/AnalyticsEvents';\r\nimport AuthenticationEvents\r\n    from './service/authentication/AuthenticationEvents';\r\nimport EventEmitterForwarder from './modules/util/EventEmitterForwarder';\r\nimport { getLogger } from 'jitsi-meet-logger';\r\nimport * as JitsiConferenceErrors from './JitsiConferenceErrors';\r\nimport * as JitsiConferenceEvents from './JitsiConferenceEvents';\r\nimport * as MediaType from './service/RTC/MediaType';\r\nimport RTCEvents from './service/RTC/RTCEvents';\r\nimport VideoType from './service/RTC/VideoType';\r\nimport Statistics from './modules/statistics/statistics';\r\nimport XMPPEvents from './service/xmpp/XMPPEvents';\r\n\r\nconst logger = getLogger(__filename);\r\n\r\n/**\r\n * Setups all event listeners related to conference\r\n * @param conference {JitsiConference} the conference\r\n */\r\nexport default function JitsiConferenceEventManager(conference) {\r\n    this.conference = conference;\r\n\r\n    // Listeners related to the conference only\r\n    conference.on(JitsiConferenceEvents.TRACK_MUTE_CHANGED,\r\n        track => {\r\n            if (!track.isLocal() || !conference.statistics) {\r\n                return;\r\n            }\r\n            const session\r\n                = track.isP2P\r\n                    ? conference.p2pJingleSession : conference.jvbJingleSession;\r\n\r\n            // TPC will be null, before the conference starts, but the event\r\n            // still should be queued\r\n            const tpc = (session && session.peerconnection) || null;\r\n\r\n            conference.statistics.sendMuteEvent(\r\n                tpc,\r\n                track.isMuted(),\r\n                track.getType());\r\n        });\r\n}\r\n\r\n/**\r\n * Setups event listeners related to conference.chatRoom\r\n */\r\nJitsiConferenceEventManager.prototype.setupChatRoomListeners = function() {\r\n    const conference = this.conference;\r\n    const chatRoom = conference.room;\r\n\r\n    this.chatRoomForwarder = new EventEmitterForwarder(chatRoom,\r\n        this.conference.eventEmitter);\r\n\r\n    chatRoom.addListener(XMPPEvents.ICE_RESTARTING, jingleSession => {\r\n        if (!jingleSession.isP2P) {\r\n            // If using DataChannel as bridge channel, it must be closed\r\n            // before ICE restart, otherwise Chrome will not trigger \"opened\"\r\n            // event for the channel established with the new bridge.\r\n            // TODO: This may be bypassed when using a WebSocket as bridge\r\n            // channel.\r\n            conference.rtc.closeBridgeChannel();\r\n        }\r\n\r\n        // else: there are no DataChannels in P2P session (at least for now)\r\n    });\r\n\r\n    chatRoom.addListener(XMPPEvents.AUDIO_MUTED_BY_FOCUS,\r\n        () => {\r\n            // TODO: Add a way to differentiate between commands which caused\r\n            // us to mute and those that did not change our state (i.e. we were\r\n            // already muted).\r\n            Statistics.sendAnalytics(createRemotelyMutedEvent());\r\n\r\n            // set isMutedByFocus when setAudioMute Promise ends\r\n            conference.rtc.setAudioMute(true).then(\r\n                () => {\r\n                    conference.isMutedByFocus = true;\r\n                },\r\n                () =>\r\n                    logger.warn(\r\n                        'Error while audio muting due to focus request'));\r\n        }\r\n    );\r\n\r\n    this.chatRoomForwarder.forward(XMPPEvents.SUBJECT_CHANGED,\r\n        JitsiConferenceEvents.SUBJECT_CHANGED);\r\n\r\n    this.chatRoomForwarder.forward(XMPPEvents.MUC_JOINED,\r\n        JitsiConferenceEvents.CONFERENCE_JOINED);\r\n\r\n    // send some analytics events\r\n    chatRoom.addListener(XMPPEvents.MUC_JOINED,\r\n        () => {\r\n            this.conference.isJvbConnectionInterrupted = false;\r\n\r\n            // TODO: Move all of the 'connectionTimes' logic to its own module.\r\n            Object.keys(chatRoom.connectionTimes).forEach(key => {\r\n                const event\r\n                    = createConnectionStageReachedEvent(\r\n                        `conference_${key}`,\r\n                        { value: chatRoom.connectionTimes[key] });\r\n\r\n                Statistics.sendAnalytics(event);\r\n            });\r\n\r\n            // TODO: Move all of the 'connectionTimes' logic to its own module.\r\n            Object.keys(chatRoom.xmpp.connectionTimes).forEach(key => {\r\n                const event\r\n                    = createConnectionStageReachedEvent(\r\n                        `xmpp_${key}`,\r\n                        { value: chatRoom.xmpp.connectionTimes[key] });\r\n\r\n                Statistics.sendAnalytics(event);\r\n            });\r\n        });\r\n\r\n    this.chatRoomForwarder.forward(XMPPEvents.ROOM_JOIN_ERROR,\r\n        JitsiConferenceEvents.CONFERENCE_FAILED,\r\n        JitsiConferenceErrors.CONNECTION_ERROR);\r\n\r\n    this.chatRoomForwarder.forward(XMPPEvents.ROOM_CONNECT_ERROR,\r\n        JitsiConferenceEvents.CONFERENCE_FAILED,\r\n        JitsiConferenceErrors.CONNECTION_ERROR);\r\n    this.chatRoomForwarder.forward(XMPPEvents.ROOM_CONNECT_NOT_ALLOWED_ERROR,\r\n        JitsiConferenceEvents.CONFERENCE_FAILED,\r\n        JitsiConferenceErrors.NOT_ALLOWED_ERROR);\r\n\r\n    this.chatRoomForwarder.forward(XMPPEvents.ROOM_MAX_USERS_ERROR,\r\n        JitsiConferenceEvents.CONFERENCE_FAILED,\r\n        JitsiConferenceErrors.CONFERENCE_MAX_USERS);\r\n\r\n    this.chatRoomForwarder.forward(XMPPEvents.PASSWORD_REQUIRED,\r\n        JitsiConferenceEvents.CONFERENCE_FAILED,\r\n        JitsiConferenceErrors.PASSWORD_REQUIRED);\r\n\r\n    this.chatRoomForwarder.forward(XMPPEvents.AUTHENTICATION_REQUIRED,\r\n        JitsiConferenceEvents.CONFERENCE_FAILED,\r\n        JitsiConferenceErrors.AUTHENTICATION_REQUIRED);\r\n\r\n    this.chatRoomForwarder.forward(XMPPEvents.BRIDGE_DOWN,\r\n        JitsiConferenceEvents.CONFERENCE_FAILED,\r\n        JitsiConferenceErrors.VIDEOBRIDGE_NOT_AVAILABLE);\r\n    chatRoom.addListener(\r\n        XMPPEvents.BRIDGE_DOWN,\r\n        () => Statistics.sendAnalytics(createBridgeDownEvent()));\r\n\r\n    this.chatRoomForwarder.forward(XMPPEvents.RESERVATION_ERROR,\r\n        JitsiConferenceEvents.CONFERENCE_FAILED,\r\n        JitsiConferenceErrors.RESERVATION_ERROR);\r\n\r\n    this.chatRoomForwarder.forward(XMPPEvents.GRACEFUL_SHUTDOWN,\r\n        JitsiConferenceEvents.CONFERENCE_FAILED,\r\n        JitsiConferenceErrors.GRACEFUL_SHUTDOWN);\r\n\r\n    chatRoom.addListener(XMPPEvents.JINGLE_FATAL_ERROR,\r\n        (session, error) => {\r\n            if (!session.isP2P) {\r\n                conference.eventEmitter.emit(\r\n                    JitsiConferenceEvents.CONFERENCE_FAILED,\r\n                    JitsiConferenceErrors.JINGLE_FATAL_ERROR, error);\r\n            }\r\n        });\r\n\r\n    chatRoom.addListener(XMPPEvents.CONNECTION_ICE_FAILED,\r\n        jingleSession => {\r\n            conference._onIceConnectionFailed(jingleSession);\r\n        });\r\n\r\n    this.chatRoomForwarder.forward(XMPPEvents.MUC_DESTROYED,\r\n        JitsiConferenceEvents.CONFERENCE_FAILED,\r\n        JitsiConferenceErrors.CONFERENCE_DESTROYED);\r\n\r\n    this.chatRoomForwarder.forward(XMPPEvents.CHAT_ERROR_RECEIVED,\r\n        JitsiConferenceEvents.CONFERENCE_ERROR,\r\n        JitsiConferenceErrors.CHAT_ERROR);\r\n\r\n    this.chatRoomForwarder.forward(XMPPEvents.FOCUS_DISCONNECTED,\r\n        JitsiConferenceEvents.CONFERENCE_FAILED,\r\n        JitsiConferenceErrors.FOCUS_DISCONNECTED);\r\n\r\n    chatRoom.addListener(XMPPEvents.FOCUS_LEFT,\r\n        () => {\r\n            Statistics.sendAnalytics(createFocusLeftEvent());\r\n            conference.eventEmitter.emit(\r\n                JitsiConferenceEvents.CONFERENCE_FAILED,\r\n                JitsiConferenceErrors.FOCUS_LEFT);\r\n        });\r\n\r\n    chatRoom.addListener(XMPPEvents.SESSION_ACCEPT_TIMEOUT,\r\n        jingleSession => {\r\n            Statistics.sendAnalyticsAndLog(\r\n                createJingleEvent(\r\n                    ACTION_JINGLE_SA_TIMEOUT,\r\n                    { p2p: jingleSession.isP2P }));\r\n        });\r\n\r\n    this.chatRoomForwarder.forward(XMPPEvents.RECORDER_STATE_CHANGED,\r\n        JitsiConferenceEvents.RECORDER_STATE_CHANGED);\r\n\r\n    this.chatRoomForwarder.forward(XMPPEvents.TRANSCRIPTION_STATUS_CHANGED,\r\n        JitsiConferenceEvents.TRANSCRIPTION_STATUS_CHANGED);\r\n\r\n    this.chatRoomForwarder.forward(XMPPEvents.VIDEO_SIP_GW_AVAILABILITY_CHANGED,\r\n        JitsiConferenceEvents.VIDEO_SIP_GW_AVAILABILITY_CHANGED);\r\n\r\n    this.chatRoomForwarder.forward(\r\n        XMPPEvents.VIDEO_SIP_GW_SESSION_STATE_CHANGED,\r\n        JitsiConferenceEvents.VIDEO_SIP_GW_SESSION_STATE_CHANGED);\r\n\r\n    this.chatRoomForwarder.forward(XMPPEvents.PHONE_NUMBER_CHANGED,\r\n        JitsiConferenceEvents.PHONE_NUMBER_CHANGED);\r\n\r\n    chatRoom.addListener(\r\n        XMPPEvents.CONFERENCE_SETUP_FAILED,\r\n        (jingleSession, error) => {\r\n            if (!jingleSession.isP2P) {\r\n                conference.eventEmitter.emit(\r\n                    JitsiConferenceEvents.CONFERENCE_FAILED,\r\n                    JitsiConferenceErrors.SETUP_FAILED,\r\n                    error);\r\n            }\r\n        });\r\n\r\n    chatRoom.setParticipantPropertyListener((node, from) => {\r\n        const participant = conference.getParticipantById(from);\r\n\r\n        if (!participant) {\r\n            return;\r\n        }\r\n\r\n        participant.setProperty(\r\n            node.tagName.substring('jitsi_participant_'.length),\r\n            node.value);\r\n    });\r\n\r\n    this.chatRoomForwarder.forward(XMPPEvents.KICKED,\r\n        JitsiConferenceEvents.KICKED);\r\n    chatRoom.addListener(XMPPEvents.KICKED,\r\n        () => {\r\n            conference.room = null;\r\n            conference.leave();\r\n        });\r\n    chatRoom.addListener(XMPPEvents.SUSPEND_DETECTED,\r\n        conference.onSuspendDetected.bind(conference));\r\n\r\n    this.chatRoomForwarder.forward(XMPPEvents.MUC_LOCK_CHANGED,\r\n        JitsiConferenceEvents.LOCK_STATE_CHANGED);\r\n\r\n    chatRoom.addListener(XMPPEvents.MUC_MEMBER_JOINED,\r\n        conference.onMemberJoined.bind(conference));\r\n    chatRoom.addListener(XMPPEvents.MUC_MEMBER_LEFT,\r\n        conference.onMemberLeft.bind(conference));\r\n    this.chatRoomForwarder.forward(XMPPEvents.MUC_LEFT,\r\n        JitsiConferenceEvents.CONFERENCE_LEFT);\r\n\r\n    chatRoom.addListener(XMPPEvents.DISPLAY_NAME_CHANGED,\r\n        conference.onDisplayNameChanged.bind(conference));\r\n\r\n    chatRoom.addListener(XMPPEvents.LOCAL_ROLE_CHANGED, role => {\r\n        conference.onLocalRoleChanged(role);\r\n\r\n        // log all events for the recorder operated by the moderator\r\n        if (conference.statistics && conference.isModerator()) {\r\n            conference.on(JitsiConferenceEvents.RECORDER_STATE_CHANGED,\r\n                (status, error) => {\r\n                    const logObject = {\r\n                        id: 'recorder_status',\r\n                        status\r\n                    };\r\n\r\n                    if (error) {\r\n                        logObject.error = error;\r\n                    }\r\n                    Statistics.sendLog(JSON.stringify(logObject));\r\n                });\r\n        }\r\n    });\r\n\r\n    chatRoom.addListener(XMPPEvents.MUC_ROLE_CHANGED,\r\n        conference.onUserRoleChanged.bind(conference));\r\n\r\n    chatRoom.addListener(AuthenticationEvents.IDENTITY_UPDATED,\r\n        (authEnabled, authIdentity) => {\r\n            conference.authEnabled = authEnabled;\r\n            conference.authIdentity = authIdentity;\r\n            conference.eventEmitter.emit(\r\n                JitsiConferenceEvents.AUTH_STATUS_CHANGED, authEnabled,\r\n                authIdentity);\r\n        });\r\n\r\n    chatRoom.addListener(\r\n        XMPPEvents.MESSAGE_RECEIVED,\r\n\r\n        // eslint-disable-next-line max-params\r\n        (jid, displayName, txt, myJid, ts) => {\r\n            const id = Strophe.getResourceFromJid(jid);\r\n\r\n            conference.eventEmitter.emit(\r\n                JitsiConferenceEvents.MESSAGE_RECEIVED,\r\n                id, txt, ts);\r\n        });\r\n\r\n    chatRoom.addListener(\r\n        XMPPEvents.PRIVATE_MESSAGE_RECEIVED,\r\n\r\n        // eslint-disable-next-line max-params\r\n        (jid, displayName, txt, myJid, ts) => {\r\n            const id = Strophe.getResourceFromJid(jid);\r\n\r\n            conference.eventEmitter.emit(\r\n                JitsiConferenceEvents.PRIVATE_MESSAGE_RECEIVED,\r\n                id, txt, ts);\r\n        });\r\n\r\n    chatRoom.addListener(XMPPEvents.PRESENCE_STATUS,\r\n        (jid, status) => {\r\n            const id = Strophe.getResourceFromJid(jid);\r\n            const participant = conference.getParticipantById(id);\r\n\r\n            if (!participant || participant._status === status) {\r\n                return;\r\n            }\r\n            participant._status = status;\r\n            conference.eventEmitter.emit(\r\n                JitsiConferenceEvents.USER_STATUS_CHANGED, id, status);\r\n        });\r\n\r\n    chatRoom.addListener(XMPPEvents.JSON_MESSAGE_RECEIVED,\r\n        (from, payload) => {\r\n            const id = Strophe.getResourceFromJid(from);\r\n            const participant = conference.getParticipantById(id);\r\n\r\n            if (participant) {\r\n                conference.eventEmitter.emit(\r\n                    JitsiConferenceEvents.ENDPOINT_MESSAGE_RECEIVED,\r\n                    participant, payload);\r\n            } else {\r\n                logger.warn(\r\n                    'Ignored XMPPEvents.JSON_MESSAGE_RECEIVED for not existing '\r\n                    + `participant: ${from}`,\r\n                    payload);\r\n            }\r\n        });\r\n\r\n    chatRoom.addPresenceListener('startmuted', (data, from) => {\r\n        let isModerator = false;\r\n\r\n        if (conference.myUserId() === from && conference.isModerator()) {\r\n            isModerator = true;\r\n        } else {\r\n            const participant = conference.getParticipantById(from);\r\n\r\n            if (participant && participant.isModerator()) {\r\n                isModerator = true;\r\n            }\r\n        }\r\n\r\n        if (!isModerator) {\r\n            return;\r\n        }\r\n\r\n        const startAudioMuted = data.attributes.audio === 'true';\r\n        const startVideoMuted = data.attributes.video === 'true';\r\n\r\n        let updated = false;\r\n\r\n        if (startAudioMuted !== conference.startMutedPolicy.audio) {\r\n            conference.startMutedPolicy.audio = startAudioMuted;\r\n            updated = true;\r\n        }\r\n\r\n        if (startVideoMuted !== conference.startMutedPolicy.video) {\r\n            conference.startMutedPolicy.video = startVideoMuted;\r\n            updated = true;\r\n        }\r\n\r\n        if (updated) {\r\n            conference.eventEmitter.emit(\r\n                JitsiConferenceEvents.START_MUTED_POLICY_CHANGED,\r\n                conference.startMutedPolicy\r\n            );\r\n        }\r\n    });\r\n\r\n    chatRoom.addPresenceListener('devices', (data, from) => {\r\n        let isAudioAvailable = false;\r\n        let isVideoAvailable = false;\r\n\r\n        data.children.forEach(config => {\r\n            if (config.tagName === 'audio') {\r\n                isAudioAvailable = config.value === 'true';\r\n            }\r\n            if (config.tagName === 'video') {\r\n                isVideoAvailable = config.value === 'true';\r\n            }\r\n        });\r\n\r\n        let availableDevices;\r\n\r\n        if (conference.myUserId() === from) {\r\n            availableDevices = conference.availableDevices;\r\n        } else {\r\n            const participant = conference.getParticipantById(from);\r\n\r\n            if (!participant) {\r\n                return;\r\n            }\r\n\r\n            availableDevices = participant._availableDevices;\r\n        }\r\n\r\n        let updated = false;\r\n\r\n        if (availableDevices.audio !== isAudioAvailable) {\r\n            updated = true;\r\n            availableDevices.audio = isAudioAvailable;\r\n        }\r\n\r\n        if (availableDevices.video !== isVideoAvailable) {\r\n            updated = true;\r\n            availableDevices.video = isVideoAvailable;\r\n        }\r\n\r\n        if (updated) {\r\n            conference.eventEmitter.emit(\r\n                JitsiConferenceEvents.AVAILABLE_DEVICES_CHANGED,\r\n                from, availableDevices);\r\n        }\r\n    });\r\n\r\n    if (conference.statistics) {\r\n        // FIXME ICE related events should end up in RTCEvents eventually\r\n        chatRoom.addListener(XMPPEvents.CONNECTION_ICE_FAILED,\r\n            session => {\r\n                conference.statistics.sendIceConnectionFailedEvent(\r\n                    session.peerconnection);\r\n            });\r\n\r\n        // FIXME XMPPEvents.ADD_ICE_CANDIDATE_FAILED is never emitted\r\n        chatRoom.addListener(XMPPEvents.ADD_ICE_CANDIDATE_FAILED,\r\n            (e, pc) => {\r\n                conference.statistics.sendAddIceCandidateFailed(e, pc);\r\n            });\r\n    }\r\n};\r\n\r\n/**\r\n * Setups event listeners related to conference.rtc\r\n */\r\nJitsiConferenceEventManager.prototype.setupRTCListeners = function() {\r\n    const conference = this.conference;\r\n    const rtc = conference.rtc;\r\n\r\n    rtc.addListener(\r\n        RTCEvents.REMOTE_TRACK_ADDED,\r\n        conference.onRemoteTrackAdded.bind(conference));\r\n\r\n    rtc.addListener(\r\n        RTCEvents.REMOTE_TRACK_REMOVED,\r\n        conference.onRemoteTrackRemoved.bind(conference));\r\n\r\n    rtc.addListener(RTCEvents.DOMINANT_SPEAKER_CHANGED,\r\n        id => {\r\n            if (conference.lastDominantSpeaker !== id && conference.room) {\r\n                conference.lastDominantSpeaker = id;\r\n                conference.eventEmitter.emit(\r\n                    JitsiConferenceEvents.DOMINANT_SPEAKER_CHANGED, id);\r\n            }\r\n            if (conference.statistics && conference.myUserId() === id) {\r\n                // We are the new dominant speaker.\r\n                conference.statistics.sendDominantSpeakerEvent();\r\n            }\r\n        });\r\n\r\n    rtc.addListener(RTCEvents.DATA_CHANNEL_OPEN, () => {\r\n        const now = window.performance.now();\r\n        const key = 'data.channel.opened';\r\n\r\n        // TODO: Move all of the 'connectionTimes' logic to its own module.\r\n        logger.log(`(TIME) ${key}`, now);\r\n        conference.room.connectionTimes[key] = now;\r\n        Statistics.sendAnalytics(\r\n            createConnectionStageReachedEvent(key, { value: now }));\r\n\r\n        conference.eventEmitter.emit(JitsiConferenceEvents.DATA_CHANNEL_OPENED);\r\n    });\r\n\r\n    rtc.addListener(\r\n        RTCEvents.AVAILABLE_DEVICES_CHANGED,\r\n        devices => conference.room.updateDeviceAvailability(devices));\r\n\r\n    rtc.addListener(RTCEvents.ENDPOINT_MESSAGE_RECEIVED,\r\n        (from, payload) => {\r\n            const participant = conference.getParticipantById(from);\r\n\r\n            if (participant) {\r\n                conference.eventEmitter.emit(\r\n                    JitsiConferenceEvents.ENDPOINT_MESSAGE_RECEIVED,\r\n                    participant, payload);\r\n            } else {\r\n                logger.warn(\r\n                    'Ignored ENDPOINT_MESSAGE_RECEIVED for not existing '\r\n                        + `participant: ${from}`,\r\n                    payload);\r\n            }\r\n        });\r\n\r\n    rtc.addListener(RTCEvents.LOCAL_UFRAG_CHANGED,\r\n        (tpc, ufrag) => {\r\n            if (!tpc.isP2P) {\r\n                Statistics.sendLog(\r\n                    JSON.stringify({\r\n                        id: 'local_ufrag',\r\n                        value: ufrag\r\n                    }));\r\n            }\r\n        });\r\n    rtc.addListener(RTCEvents.REMOTE_UFRAG_CHANGED,\r\n        (tpc, ufrag) => {\r\n            if (!tpc.isP2P) {\r\n                Statistics.sendLog(\r\n                    JSON.stringify({\r\n                        id: 'remote_ufrag',\r\n                        value: ufrag\r\n                    }));\r\n            }\r\n        });\r\n\r\n    rtc.addListener(RTCEvents.CREATE_ANSWER_FAILED,\r\n        (e, tpc) => {\r\n            conference.statistics.sendCreateAnswerFailed(e, tpc);\r\n        });\r\n\r\n    rtc.addListener(RTCEvents.CREATE_OFFER_FAILED,\r\n        (e, tpc) => {\r\n            conference.statistics.sendCreateOfferFailed(e, tpc);\r\n        });\r\n\r\n    rtc.addListener(RTCEvents.SET_LOCAL_DESCRIPTION_FAILED,\r\n        (e, tpc) => {\r\n            conference.statistics.sendSetLocalDescFailed(e, tpc);\r\n        });\r\n\r\n    rtc.addListener(RTCEvents.SET_REMOTE_DESCRIPTION_FAILED,\r\n        (e, tpc) => {\r\n            conference.statistics.sendSetRemoteDescFailed(e, tpc);\r\n        });\r\n\r\n    rtc.addListener(RTCEvents.LOCAL_TRACK_SSRC_UPDATED,\r\n        (track, ssrc) => {\r\n            // when starting screen sharing, the track is created and when\r\n            // we do set local description and we process the ssrc we\r\n            // will be notified for it and we will report it with the event\r\n            // for screen sharing\r\n            if (track.isVideoTrack() && track.videoType === VideoType.DESKTOP) {\r\n                conference.statistics.sendScreenSharingEvent(true, ssrc);\r\n            }\r\n        });\r\n};\r\n\r\n/**\r\n * Setups event listeners related to conference.xmpp\r\n */\r\nJitsiConferenceEventManager.prototype.setupXMPPListeners = function() {\r\n    const conference = this.conference;\r\n\r\n    conference.xmpp.caps.addListener(XMPPEvents.PARTCIPANT_FEATURES_CHANGED,\r\n        from => {\r\n            const participant\r\n                = conference.getParticipantById(\r\n                    Strophe.getResourceFromJid(from));\r\n\r\n            if (participant) {\r\n                conference.eventEmitter.emit(\r\n                    JitsiConferenceEvents.PARTCIPANT_FEATURES_CHANGED,\r\n                    participant);\r\n            }\r\n        });\r\n    conference.xmpp.addListener(\r\n        XMPPEvents.CALL_INCOMING,\r\n        conference.onIncomingCall.bind(conference));\r\n    conference.xmpp.addListener(\r\n        XMPPEvents.CALL_ACCEPTED,\r\n        conference.onCallAccepted.bind(conference));\r\n    conference.xmpp.addListener(\r\n        XMPPEvents.TRANSPORT_INFO,\r\n        conference.onTransportInfo.bind(conference));\r\n    conference.xmpp.addListener(\r\n        XMPPEvents.CALL_ENDED,\r\n        conference.onCallEnded.bind(conference));\r\n\r\n    conference.xmpp.addListener(XMPPEvents.START_MUTED_FROM_FOCUS,\r\n        (audioMuted, videoMuted) => {\r\n            if (conference.options.config.ignoreStartMuted) {\r\n                return;\r\n            }\r\n\r\n            conference.startAudioMuted = audioMuted;\r\n            conference.startVideoMuted = videoMuted;\r\n\r\n            // mute existing local tracks because this is initial mute from\r\n            // Jicofo\r\n            conference.getLocalTracks().forEach(track => {\r\n                switch (track.getType()) {\r\n                case MediaType.AUDIO:\r\n                    conference.startAudioMuted && track.mute();\r\n                    break;\r\n                case MediaType.VIDEO:\r\n                    conference.startVideoMuted && track.mute();\r\n                    break;\r\n                }\r\n            });\r\n\r\n            conference.eventEmitter.emit(JitsiConferenceEvents.STARTED_MUTED);\r\n        });\r\n};\r\n\r\n/**\r\n * Setups event listeners related to conference.statistics\r\n */\r\nJitsiConferenceEventManager.prototype.setupStatisticsListeners = function() {\r\n    const conference = this.conference;\r\n\r\n    if (!conference.statistics) {\r\n        return;\r\n    }\r\n\r\n    /* eslint-disable max-params */\r\n    conference.statistics.addAudioLevelListener((tpc, ssrc, level, isLocal) => {\r\n        conference.rtc.setAudioLevel(tpc, ssrc, level, isLocal);\r\n    });\r\n\r\n    /* eslint-enable max-params */\r\n\r\n    // Forward the \"before stats disposed\" event\r\n    conference.statistics.addBeforeDisposedListener(() => {\r\n        conference.eventEmitter.emit(\r\n            JitsiConferenceEvents.BEFORE_STATISTICS_DISPOSED);\r\n    });\r\n    conference.statistics.addByteSentStatsListener((tpc, stats) => {\r\n        conference.getLocalTracks(MediaType.AUDIO).forEach(track => {\r\n            const ssrc = tpc.getLocalSSRC(track);\r\n\r\n            if (!ssrc || !stats.hasOwnProperty(ssrc)) {\r\n                return;\r\n            }\r\n\r\n            track._onByteSentStatsReceived(tpc, stats[ssrc]);\r\n        });\r\n    });\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./JitsiConferenceEventManager.js","/**\r\n * Implements utility to forward events from one eventEmitter to another.\r\n * @param src {object} instance of EventEmitter or another class that implements\r\n * addListener method which will register listener to EventEmitter instance.\r\n * @param dest {object} instance of EventEmitter or another class that\r\n * implements emit method which will emit an event.\r\n */\r\nfunction EventEmitterForwarder(src, dest) {\r\n    if (!src || !dest || typeof src.addListener !== 'function'\r\n        || typeof dest.emit !== 'function') {\r\n        throw new Error('Invalid arguments passed to EventEmitterForwarder');\r\n    }\r\n    this.src = src;\r\n    this.dest = dest;\r\n}\r\n\r\n/**\r\n * Adds event to be forwarded from src to dest.\r\n * @param srcEvent {string} the event that EventEmitterForwarder is listening\r\n * for.\r\n * @param dstEvent {string} the event that will be fired from dest.\r\n * @param arguments all other passed arguments are going to be fired with\r\n * dstEvent.\r\n */\r\nEventEmitterForwarder.prototype.forward = function(...args) {\r\n    const srcEvent = args[0];\r\n\r\n    // This will be the \"this\" value for emit function.\r\n\r\n    args[0] = this.dest;\r\n\r\n    // Using bind.apply to pass the arguments as Array-like object (\"arguments\")\r\n    this.src.addListener(\r\n        srcEvent,\r\n        Function.prototype.bind.apply(this.dest.emit, args));\r\n};\r\n\r\nmodule.exports = EventEmitterForwarder;\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/util/EventEmitterForwarder.js","const logger = require('jitsi-meet-logger').getLogger(__filename);\r\n\r\n/**\r\n *\r\n * @param localAudio\r\n * @param peerConnection\r\n */\r\nfunction JitsiDTMFManager(localAudio, peerConnection) {\r\n    const audioTrack = localAudio.getTrack();\r\n\r\n    if (!audioTrack) {\r\n        throw new Error('Failed to initialize DTMFSender: no audio track.');\r\n    }\r\n    this.dtmfSender\r\n        = peerConnection.peerconnection.createDTMFSender(audioTrack);\r\n    logger.debug('Initialized DTMFSender');\r\n}\r\n\r\nJitsiDTMFManager.prototype.sendTones = function(tones, duration, pause) {\r\n    this.dtmfSender.insertDTMF(tones, duration || 200, pause || 200);\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/DTMF/JitsiDTMFManager.js","\r\nimport { Strophe } from 'strophe.js';\r\n\r\nimport * as JitsiConferenceEvents from './JitsiConferenceEvents';\r\nimport { ParticipantConnectionStatus }\r\n    from './modules/connectivity/ParticipantConnectionStatus';\r\nimport * as MediaType from './service/RTC/MediaType';\r\n\r\n/**\r\n * Represents a participant in (i.e. a member of) a conference.\r\n */\r\nexport default class JitsiParticipant {\r\n\r\n    /* eslint-disable max-params */\r\n\r\n    /**\r\n     * Initializes a new JitsiParticipant instance.\r\n     *\r\n     * @constructor\r\n     * @param jid the conference XMPP jid\r\n     * @param conference\r\n     * @param displayName\r\n     * @param {Boolean} hidden - True if the new JitsiParticipant instance is to\r\n     * represent a hidden participant; otherwise, false.\r\n     * @param {string} statsID - optional participant statsID\r\n     * @param {string} status - the initial status if any.\r\n     */\r\n    constructor(jid, conference, displayName, hidden, statsID, status) {\r\n        this._jid = jid;\r\n        this._id = Strophe.getResourceFromJid(jid);\r\n        this._conference = conference;\r\n        this._displayName = displayName;\r\n        this._supportsDTMF = false;\r\n        this._tracks = [];\r\n        this._role = 'none';\r\n        this._status = status;\r\n        this._availableDevices = {\r\n            audio: undefined,\r\n            video: undefined\r\n        };\r\n        this._hidden = hidden;\r\n        this._statsID = statsID;\r\n        this._connectionStatus = ParticipantConnectionStatus.ACTIVE;\r\n        this._properties = {};\r\n    }\r\n\r\n    /* eslint-enable max-params */\r\n\r\n    /**\r\n     * @returns {JitsiConference} The conference that this participant belongs\r\n     * to.\r\n     */\r\n    getConference() {\r\n        return this._conference;\r\n    }\r\n\r\n    /**\r\n     * Gets the value of a property of this participant.\r\n     */\r\n    getProperty(name) {\r\n        return this._properties[name];\r\n    }\r\n\r\n    /**\r\n     * Checks whether this <tt>JitsiParticipant</tt> has any video tracks which\r\n     * are muted according to their underlying WebRTC <tt>MediaStreamTrack</tt>\r\n     * muted status.\r\n     * @return {boolean} <tt>true</tt> if this <tt>participant</tt> contains any\r\n     * video <tt>JitsiTrack</tt>s which are muted as defined in\r\n     * {@link JitsiTrack.isWebRTCTrackMuted}.\r\n     */\r\n    hasAnyVideoTrackWebRTCMuted() {\r\n        return (\r\n            this.getTracks().some(\r\n                jitsiTrack =>\r\n                    jitsiTrack.getType() === MediaType.VIDEO\r\n                        && jitsiTrack.isWebRTCTrackMuted()));\r\n    }\r\n\r\n    /**\r\n     * Updates participant's connection status.\r\n     * @param {string} state the current participant connection state.\r\n     * {@link ParticipantConnectionStatus}.\r\n     * @private\r\n     */\r\n    _setConnectionStatus(status) {\r\n        this._connectionStatus = status;\r\n    }\r\n\r\n    /**\r\n     * Return participant's connectivity status.\r\n     *\r\n     * @returns {string} the connection status\r\n     * <tt>ParticipantConnectionStatus</tt> of the user.\r\n     * {@link ParticipantConnectionStatus}.\r\n     */\r\n    getConnectionStatus() {\r\n        return this._connectionStatus;\r\n    }\r\n\r\n    /**\r\n     * Sets the value of a property of this participant, and fires an event if\r\n     * the value has changed.\r\n     * @name the name of the property.\r\n     * @value the value to set.\r\n     */\r\n    setProperty(name, value) {\r\n        const oldValue = this._properties[name];\r\n\r\n        if (value !== oldValue) {\r\n            this._properties[name] = value;\r\n            this._conference.eventEmitter.emit(\r\n                JitsiConferenceEvents.PARTICIPANT_PROPERTY_CHANGED,\r\n                this,\r\n                name,\r\n                oldValue,\r\n                value);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @returns {Array.<JitsiTrack>} The list of media tracks for this\r\n     * participant.\r\n     */\r\n    getTracks() {\r\n        return this._tracks.slice();\r\n    }\r\n\r\n    /**\r\n     * @param {MediaType} mediaType\r\n     * @returns {Array.<JitsiTrack>} an array of media tracks for this\r\n     * participant, for given media type.\r\n     */\r\n    getTracksByMediaType(mediaType) {\r\n        return this.getTracks().filter(track => track.getType() === mediaType);\r\n    }\r\n\r\n    /**\r\n     * @returns {String} The ID of this participant.\r\n     */\r\n    getId() {\r\n        return this._id;\r\n    }\r\n\r\n    /**\r\n     * @returns {String} The JID of this participant.\r\n     */\r\n    getJid() {\r\n        return this._jid;\r\n    }\r\n\r\n    /**\r\n     * @returns {String} The human-readable display name of this participant.\r\n     */\r\n    getDisplayName() {\r\n        return this._displayName;\r\n    }\r\n\r\n    /**\r\n     * @returns {String} The stats ID of this participant.\r\n     */\r\n    getStatsID() {\r\n        return this._statsID;\r\n    }\r\n\r\n    /**\r\n     * @returns {String} The status of the participant.\r\n     */\r\n    getStatus() {\r\n        return this._status;\r\n    }\r\n\r\n    /**\r\n     * @returns {Boolean} Whether this participant is a moderator or not.\r\n     */\r\n    isModerator() {\r\n        return this._role === 'moderator';\r\n    }\r\n\r\n    /**\r\n     * @returns {Boolean} Whether this participant is a hidden participant. Some\r\n     * special system participants may want to join hidden (like for example the\r\n     * recorder).\r\n     */\r\n    isHidden() {\r\n        return this._hidden;\r\n    }\r\n\r\n    // Gets a link to an etherpad instance advertised by the participant?\r\n    // getEtherpad() {\r\n    // }\r\n\r\n    /**\r\n     * @returns {Boolean} Whether this participant has muted their audio.\r\n     */\r\n    isAudioMuted() {\r\n        return this._isMediaTypeMuted(MediaType.AUDIO);\r\n    }\r\n\r\n    /**\r\n     * Determines whether all JitsiTracks which are of a specific MediaType and\r\n     * which belong to this JitsiParticipant are muted.\r\n     *\r\n     * @param {MediaType} mediaType - The MediaType of the JitsiTracks to be\r\n     * checked.\r\n     * @private\r\n     * @returns {Boolean} True if all JitsiTracks which are of the specified\r\n     * mediaType and which belong to this JitsiParticipant are muted; otherwise,\r\n     * false.\r\n     */\r\n    _isMediaTypeMuted(mediaType) {\r\n        return this.getTracks().reduce(\r\n            (muted, track) =>\r\n                muted && (track.getType() !== mediaType || track.isMuted()),\r\n            true);\r\n    }\r\n\r\n    /**\r\n     * @returns {Boolean} Whether this participant has muted their video.\r\n     */\r\n    isVideoMuted() {\r\n        return this._isMediaTypeMuted(MediaType.VIDEO);\r\n    }\r\n\r\n    /**\r\n     * @returns {String} The role of this participant.\r\n     */\r\n    getRole() {\r\n        return this._role;\r\n    }\r\n\r\n    /**\r\n     *\r\n     */\r\n    supportsDTMF() {\r\n        return this._supportsDTMF;\r\n    }\r\n\r\n    /**\r\n     * Returns a set with the features for the participant.\r\n     * @param {int} timeout the timeout in ms for reply from the participant.\r\n     * @returns {Promise<Set<String>, Error>}\r\n     */\r\n    getFeatures(timeout = 5000) {\r\n        return this._conference.xmpp.caps.getFeatures(this._jid, timeout);\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./JitsiParticipant.js","/* global __filename */\r\n\r\nimport { getLogger } from 'jitsi-meet-logger';\r\nimport * as JitsiConferenceEvents from '../../JitsiConferenceEvents';\r\n\r\nconst logger = getLogger(__filename);\r\n\r\n/**\r\n * Emits {@link JitsiConferenceEvents.JVB121_STATUS} events based on the current\r\n * P2P status and the conference participants count. See the event description\r\n * for more info.\r\n */\r\nexport default class Jvb121EventGenerator {\r\n    /**\r\n     * Creates new <tt>Jvb121EventGenerator</tt> for the given conference.\r\n     * @param {JitsiConference} conference\r\n     */\r\n    constructor(conference) {\r\n        this._conference = conference;\r\n\r\n        /**\r\n         * Indicates whether it's a one to one JVB conference (<tt>true</tt>)\r\n         * or a multiparty (<tt>false</tt>). Will be also <tt>false</tt> if\r\n         * the conference is currently in the P2P mode.\r\n         * @type {boolean}\r\n         * @private\r\n         */\r\n        this._jvb121 = true;\r\n\r\n        this._conference.addEventListener(\r\n            JitsiConferenceEvents.USER_JOINED, () => this.evaluateStatus());\r\n        this._conference.addEventListener(\r\n            JitsiConferenceEvents.USER_LEFT, () => this.evaluateStatus());\r\n        this._conference.addEventListener(\r\n            JitsiConferenceEvents.P2P_STATUS, () => this.evaluateStatus());\r\n    }\r\n\r\n    /**\r\n     * Checks whether the JVB121 value should be updated and a new event\r\n     * emitted.\r\n     */\r\n    evaluateStatus() {\r\n        const oldStatus = this._jvb121;\r\n        const newStatus\r\n            = !this._conference.isP2PActive()\r\n                && this._conference.getParticipantCount() <= 2;\r\n\r\n        if (oldStatus !== newStatus) {\r\n            this._jvb121 = newStatus;\r\n            logger.debug(`JVB121 status ${oldStatus} => ${newStatus}`);\r\n            this._conference.eventEmitter.emit(\r\n                JitsiConferenceEvents.JVB121_STATUS, oldStatus, newStatus);\r\n        }\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/event/Jvb121EventGenerator.js","import * as JitsiConferenceEvents from '../JitsiConferenceEvents';\r\n\r\n/**\r\n * The value which we use to say, every sound over this threshold\r\n * is talking on the mic.\r\n * @type {number}\r\n */\r\nconst SPEECH_DETECT_THRESHOLD = 0.6;\r\n\r\n/**\r\n * The <tt>P2PDominantSpeakerDetection</tt> is activated only when p2p is\r\n * currently used.\r\n * Listens for changes in the audio level changes of the local p2p audio track\r\n * or remote p2p one and fires dominant speaker events to be able to use\r\n * features depending on those events (speaker stats), to make them work without\r\n * the video bridge.\r\n */\r\nexport default class P2PDominantSpeakerDetection {\r\n    /**\r\n     * Creates P2PDominantSpeakerDetection\r\n     * @param conference the JitsiConference instance that created us.\r\n     * @constructor\r\n     */\r\n    constructor(conference) {\r\n        this.conference = conference;\r\n\r\n        conference.addEventListener(\r\n            JitsiConferenceEvents.TRACK_AUDIO_LEVEL_CHANGED,\r\n            this._audioLevel.bind(this));\r\n\r\n        this.myUserID = this.conference.myUserId();\r\n    }\r\n\r\n    /**\r\n     * Receives audio level events for all streams in the conference.\r\n     *\r\n     * @param {String} id - The participant id\r\n     * @param {number} audioLevel - The audio level.\r\n     */\r\n    _audioLevel(id, audioLevel) {\r\n\r\n        // we do not process if p2p is not active\r\n        // or audio level is under certain threshold\r\n        // or if the audio level is for local audio track which is muted\r\n        if (!this.conference.isP2PActive()\r\n            || audioLevel <= SPEECH_DETECT_THRESHOLD\r\n            || (id === this.myUserID\r\n                    && this.conference.getLocalAudioTrack().isMuted())) {\r\n            return;\r\n        }\r\n\r\n        this.conference.eventEmitter.emit(\r\n            JitsiConferenceEvents.DOMINANT_SPEAKER_CHANGED,\r\n            id);\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/P2PDominantSpeakerDetection.js","import { getLogger } from 'jitsi-meet-logger';\r\n\r\nimport RTCEvents from '../../service/RTC/RTCEvents';\r\nimport GlobalOnErrorHandler from '../util/GlobalOnErrorHandler';\r\n\r\nconst logger = getLogger(__filename);\r\n\r\n/**\r\n * Handles a WebRTC RTCPeerConnection or a WebSocket instance to communicate\r\n * with the videobridge.\r\n */\r\nexport default class BridgeChannel {\r\n    /**\r\n     * Binds \"ondatachannel\" event listener on the given RTCPeerConnection\r\n     * instance, or creates a WebSocket connection with the videobridge.\r\n     * At least one of both, peerconnection or wsUrl parameters, must be\r\n     * given.\r\n     * @param {RTCPeerConnection} [peerconnection] WebRTC peer connection\r\n     * instance.\r\n     * @param {string} [wsUrl] WebSocket URL.\r\n     * @param {EventEmitter} eventEmitter EventEmitter instance.\r\n     */\r\n    constructor(peerconnection, wsUrl, emitter) {\r\n        if (!peerconnection && !wsUrl) {\r\n            throw new TypeError(\r\n                'At least peerconnection or wsUrl must be given');\r\n        } else if (peerconnection && wsUrl) {\r\n            throw new TypeError(\r\n                'Just one of peerconnection or wsUrl must be given');\r\n        }\r\n\r\n        if (peerconnection) {\r\n            logger.debug('constructor() with peerconnection');\r\n        } else {\r\n            logger.debug(`constructor() with wsUrl:\"${wsUrl}\"`);\r\n        }\r\n\r\n        // The underlying WebRTC RTCDataChannel or WebSocket instance.\r\n        // @type {RTCDataChannel|WebSocket}\r\n        this._channel = null;\r\n\r\n        // @type {EventEmitter}\r\n        this._eventEmitter = emitter;\r\n\r\n        // Whether a RTCDataChannel or WebSocket is internally used.\r\n        // @type {string} \"datachannel\" / \"websocket\"\r\n        this._mode = null;\r\n\r\n        // If a RTCPeerConnection is given, listen for new RTCDataChannel\r\n        // event.\r\n        if (peerconnection) {\r\n            peerconnection.ondatachannel = event => {\r\n                // NOTE: We assume that the \"onDataChannel\" event just fires\r\n                // once.\r\n\r\n                const datachannel = event.channel;\r\n\r\n                // Handle the RTCDataChannel.\r\n                this._handleChannel(datachannel);\r\n                this._mode = 'datachannel';\r\n            };\r\n\r\n        // Otherwise create a WebSocket connection.\r\n        } else if (wsUrl) {\r\n            // Create a WebSocket instance.\r\n            const ws = new WebSocket(wsUrl);\r\n\r\n            // Handle the WebSocket.\r\n            this._handleChannel(ws);\r\n            this._mode = 'websocket';\r\n        }\r\n    }\r\n\r\n    /**\r\n     * The channel mode.\r\n     * @return {string} \"datachannel\" or \"websocket\" (or null if not yet set).\r\n     */\r\n    get mode() {\r\n        return this._mode;\r\n    }\r\n\r\n    /**\r\n     * Closes the currently opened channel.\r\n     */\r\n    close() {\r\n        if (this._channel) {\r\n            try {\r\n                this._channel.close();\r\n            } catch (error) {} // eslint-disable-line no-empty\r\n\r\n            this._channel = null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Whether there is an underlying RTCDataChannel or WebSocket and it's\r\n     * open.\r\n     * @return {boolean}\r\n     */\r\n    isOpen() {\r\n        return this._channel && (this._channel.readyState === 'open'\r\n            || this._channel.readyState === WebSocket.OPEN);\r\n    }\r\n\r\n    /**\r\n     * Sends message via the channel.\r\n     * @param {string} to The id of the endpoint that should receive the\r\n     * message. If \"\" the message will be sent to all participants.\r\n     * @param  {object} payload The payload of the message.\r\n     * @throws NetworkError or InvalidStateError from RTCDataChannel#send (@see\r\n     * {@link https://developer.mozilla.org/docs/Web/API/RTCDataChannel/send})\r\n     * or from WebSocket#send or Error with \"No opened channel\" message.\r\n     */\r\n    sendMessage(to, payload) {\r\n        this._send({\r\n            colibriClass: 'EndpointMessage',\r\n            msgPayload: payload,\r\n            to\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Sends a \"lastN value changed\" message via the channel.\r\n     * @param {number} value The new value for lastN. -1 means unlimited.\r\n     */\r\n    sendSetLastNMessage(value) {\r\n        const jsonObject = {\r\n            colibriClass: 'LastNChangedEvent',\r\n            lastN: value\r\n        };\r\n\r\n        this._send(jsonObject);\r\n        logger.log(`Channel lastN set to: ${value}`);\r\n    }\r\n\r\n    /**\r\n     * Sends a \"pinned endpoint changed\" message via the channel.\r\n     * @param {string} endpointId The id of the pinned endpoint.\r\n     * @throws NetworkError or InvalidStateError from RTCDataChannel#send (@see\r\n     * {@link https://developer.mozilla.org/docs/Web/API/RTCDataChannel/send})\r\n     * or from WebSocket#send or Error with \"No opened channel\" message.\r\n     */\r\n    sendPinnedEndpointMessage(endpointId) {\r\n        logger.log(\r\n            'sending pinned changed notification to the bridge for endpoint ',\r\n            endpointId);\r\n\r\n        this._send({\r\n            colibriClass: 'PinnedEndpointChangedEvent',\r\n            pinnedEndpoint: endpointId || null\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Sends a \"selected endpoint changed\" message via the channel.\r\n     * @param {string} endpointId The id of the selected endpoint.\r\n     * @throws NetworkError or InvalidStateError from RTCDataChannel#send (@see\r\n     * {@link https://developer.mozilla.org/docs/Web/API/RTCDataChannel/send})\r\n     * or from WebSocket#send or Error with \"No opened channel\" message.\r\n     */\r\n    sendSelectedEndpointMessage(endpointId) {\r\n        logger.log(\r\n            'sending selected changed notification to the bridge for endpoint ',\r\n            endpointId);\r\n\r\n        this._send({\r\n            colibriClass: 'SelectedEndpointChangedEvent',\r\n            selectedEndpoint: endpointId || null\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Sends a \"receiver video constraint\" message via the channel.\r\n     * @param {Number} maxFrameHeightPixels the maximum frame height,\r\n     * in pixels, this receiver is willing to receive\r\n     */\r\n    sendReceiverVideoConstraintMessage(maxFrameHeightPixels) {\r\n        logger.log('sending a ReceiverVideoConstraint message with '\r\n            + `a maxFrameHeight of ${maxFrameHeightPixels} pixels`);\r\n        this._send({\r\n            colibriClass: 'ReceiverVideoConstraint',\r\n            maxFrameHeight: maxFrameHeightPixels\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Set events on the given RTCDataChannel or WebSocket instance.\r\n     */\r\n    _handleChannel(channel) {\r\n        const emitter = this._eventEmitter;\r\n\r\n        channel.onopen = () => {\r\n            logger.info(`${this._mode} channel opened`);\r\n\r\n            // Code sample for sending string and/or binary data.\r\n            // Sends string message to the bridge:\r\n            //     channel.send(\"Hello bridge!\");\r\n            // Sends 12 bytes binary message to the bridge:\r\n            //     channel.send(new ArrayBuffer(12));\r\n\r\n            emitter.emit(RTCEvents.DATA_CHANNEL_OPEN);\r\n        };\r\n\r\n        channel.onerror = error => {\r\n            logger.error('Channel error:', error);\r\n        };\r\n\r\n        channel.onmessage = ({ data }) => {\r\n            // JSON object.\r\n            let obj;\r\n\r\n            try {\r\n                obj = JSON.parse(data);\r\n            } catch (error) {\r\n                GlobalOnErrorHandler.callErrorHandler(error);\r\n                logger.error(\r\n                    'Failed to parse channel message as JSON: ',\r\n                    data, error);\r\n\r\n                return;\r\n            }\r\n\r\n            const colibriClass = obj.colibriClass;\r\n\r\n            switch (colibriClass) {\r\n            case 'DominantSpeakerEndpointChangeEvent': {\r\n                // Endpoint ID from the Videobridge.\r\n                const dominantSpeakerEndpoint = obj.dominantSpeakerEndpoint;\r\n\r\n                logger.info(\r\n                    'Channel new dominant speaker event: ',\r\n                    dominantSpeakerEndpoint);\r\n                emitter.emit(\r\n                    RTCEvents.DOMINANT_SPEAKER_CHANGED,\r\n                    dominantSpeakerEndpoint);\r\n                break;\r\n            }\r\n            case 'EndpointConnectivityStatusChangeEvent': {\r\n                const endpoint = obj.endpoint;\r\n                const isActive = obj.active === 'true';\r\n\r\n                logger.info(\r\n                    `Endpoint connection status changed: ${endpoint} active ? ${\r\n                        isActive}`);\r\n                emitter.emit(RTCEvents.ENDPOINT_CONN_STATUS_CHANGED,\r\n                    endpoint, isActive);\r\n\r\n                break;\r\n            }\r\n            case 'EndpointMessage': {\r\n                emitter.emit(\r\n                    RTCEvents.ENDPOINT_MESSAGE_RECEIVED, obj.from,\r\n                    obj.msgPayload);\r\n\r\n                break;\r\n            }\r\n            case 'LastNEndpointsChangeEvent': {\r\n                // The new/latest list of last-n endpoint IDs.\r\n                const lastNEndpoints = obj.lastNEndpoints;\r\n\r\n                logger.info('Channel new last-n event: ',\r\n                    lastNEndpoints, obj);\r\n                emitter.emit(RTCEvents.LASTN_ENDPOINT_CHANGED,\r\n                    lastNEndpoints, obj);\r\n\r\n                break;\r\n            }\r\n            default: {\r\n                logger.debug('Channel JSON-formatted message: ', obj);\r\n\r\n                // The received message appears to be appropriately formatted\r\n                // (i.e. is a JSON object which assigns a value to the\r\n                // mandatory property colibriClass) so don't just swallow it,\r\n                // expose it to public consumption.\r\n                emitter.emit(`rtc.datachannel.${colibriClass}`, obj);\r\n            }\r\n            }\r\n        };\r\n\r\n        channel.onclose = () => {\r\n            logger.info('Channel closed');\r\n\r\n            // Remove the channel.\r\n            this._channel = null;\r\n        };\r\n\r\n        // Store the channel.\r\n        this._channel = channel;\r\n    }\r\n\r\n    /**\r\n     * Sends passed object via the channel.\r\n     * @param {object} jsonObject The object that will be sent.\r\n     * @throws NetworkError or InvalidStateError from RTCDataChannel#send (@see\r\n     * {@link https://developer.mozilla.org/docs/Web/API/RTCDataChannel/send})\r\n     * or from WebSocket#send or Error with \"No opened channel\" message.\r\n     */\r\n    _send(jsonObject) {\r\n        const channel = this._channel;\r\n\r\n        if (!this.isOpen()) {\r\n            throw new Error('No opened channel');\r\n        }\r\n\r\n        channel.send(JSON.stringify(jsonObject));\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/RTC/BridgeChannel.js","/* global __filename, Promise */\r\n\r\nimport { getLogger } from 'jitsi-meet-logger';\r\nimport JitsiTrack from './JitsiTrack';\r\nimport JitsiTrackError from '../../JitsiTrackError';\r\nimport {\r\n    TRACK_IS_DISPOSED,\r\n    TRACK_NO_STREAM_FOUND\r\n} from '../../JitsiTrackErrors';\r\nimport {\r\n    LOCAL_TRACK_STOPPED,\r\n    NO_DATA_FROM_SOURCE,\r\n    TRACK_MUTE_CHANGED\r\n} from '../../JitsiTrackEvents';\r\nimport browser from '../browser';\r\nimport RTCUtils from './RTCUtils';\r\nimport CameraFacingMode from '../../service/RTC/CameraFacingMode';\r\nimport * as MediaType from '../../service/RTC/MediaType';\r\nimport RTCEvents from '../../service/RTC/RTCEvents';\r\nimport VideoType from '../../service/RTC/VideoType';\r\nimport {\r\n    TRACK_UNMUTED,\r\n    createNoDataFromSourceEvent\r\n} from '../../service/statistics/AnalyticsEvents';\r\nimport Statistics from '../statistics/statistics';\r\n\r\nconst logger = getLogger(__filename);\r\n\r\n/**\r\n * Represents a single media track(either audio or video).\r\n * One <tt>JitsiLocalTrack</tt> corresponds to one WebRTC MediaStreamTrack.\r\n */\r\nexport default class JitsiLocalTrack extends JitsiTrack {\r\n    /**\r\n     * Constructs new JitsiLocalTrack instance.\r\n     *\r\n     * @constructor\r\n     * @param {Object} trackInfo\r\n     * @param {number} trackInfo.rtcId the ID assigned by the RTC module\r\n     * @param trackInfo.stream WebRTC MediaStream, parent of the track\r\n     * @param trackInfo.track underlying WebRTC MediaStreamTrack for new\r\n     * JitsiRemoteTrack\r\n     * @param trackInfo.mediaType the MediaType of the JitsiRemoteTrack\r\n     * @param trackInfo.videoType the VideoType of the JitsiRemoteTrack\r\n     * @param trackInfo.resolution the video resolution if it's a video track\r\n     * @param trackInfo.deviceId the ID of the local device for this track\r\n     * @param trackInfo.facingMode the camera facing mode used in getUserMedia\r\n     * call\r\n     * @param {sourceId} trackInfo.sourceId - The id of the desktop sharing\r\n     * source. NOTE: defined for desktop sharing tracks only.\r\n     */\r\n    constructor({\r\n        deviceId,\r\n        facingMode,\r\n        mediaType,\r\n        resolution,\r\n        rtcId,\r\n        sourceId,\r\n        sourceType,\r\n        stream,\r\n        track,\r\n        videoType\r\n    }) {\r\n        super(\r\n            /* conference */ null,\r\n            stream,\r\n            track,\r\n            /* streamInactiveHandler */ () => this.emit(LOCAL_TRACK_STOPPED),\r\n            mediaType,\r\n            videoType);\r\n\r\n        /**\r\n         * The ID assigned by the RTC module on instance creation.\r\n         *\r\n         * @type {number}\r\n         */\r\n        this.rtcId = rtcId;\r\n        this.sourceId = sourceId;\r\n        this.sourceType = sourceType;\r\n\r\n        if (browser.usesNewGumFlow()) {\r\n            // Get the resolution from the track itself because it cannot be\r\n            // certain which resolution webrtc has fallen back to using.\r\n            this.resolution = track.getSettings().height;\r\n\r\n            // Cache the constraints of the track in case of any this track\r\n            // model needs to call getUserMedia again, such as when unmuting.\r\n            this._constraints = track.getConstraints();\r\n        } else {\r\n            // FIXME Currently, Firefox is ignoring our constraints about\r\n            // resolutions so we do not store it, to avoid wrong reporting of\r\n            // local track resolution.\r\n            this.resolution = browser.isFirefox() ? null : resolution;\r\n        }\r\n\r\n        this.deviceId = deviceId;\r\n\r\n        /**\r\n         * The <tt>Promise</tt> which represents the progress of a previously\r\n         * queued/scheduled {@link _setMuted} (from the point of view of\r\n         * {@link _queueSetMuted}).\r\n         *\r\n         * @private\r\n         * @type {Promise}\r\n         */\r\n        this._prevSetMuted = Promise.resolve();\r\n\r\n        /**\r\n         * The facing mode of the camera from which this JitsiLocalTrack\r\n         * instance was obtained.\r\n         *\r\n         * @private\r\n         * @type {CameraFacingMode|undefined}\r\n         */\r\n        this._facingMode = facingMode;\r\n\r\n        // Currently there is no way to know the MediaStreamTrack ended due to\r\n        // to device disconnect in Firefox through e.g. \"readyState\" property.\r\n        // Instead we will compare current track's label with device labels from\r\n        // enumerateDevices() list.\r\n        this._trackEnded = false;\r\n\r\n        /**\r\n         * Indicates whether data has been sent or not.\r\n         */\r\n        this._hasSentData = false;\r\n\r\n        /**\r\n         * Used only for detection of audio problems. We want to check only once\r\n         * whether the track is sending data ot not. This flag is set to false\r\n         * after the check.\r\n         */\r\n        this._testDataSent = true;\r\n\r\n        // Currently there is no way to determine with what device track was\r\n        // created (until getConstraints() support), however we can associate\r\n        // tracks with real devices obtained from enumerateDevices() call as\r\n        // soon as it's called.\r\n        this._realDeviceId = this.deviceId === '' ? undefined : this.deviceId;\r\n\r\n        /**\r\n         * On mute event we are waiting for 3s to check if the stream is going\r\n         * to be still muted before firing the event for camera issue detected\r\n         * (NO_DATA_FROM_SOURCE).\r\n         */\r\n        this._noDataFromSourceTimeout = null;\r\n\r\n        this._onDeviceListChanged = devices => {\r\n            this._setRealDeviceIdFromDeviceList(devices);\r\n\r\n            // Mark track as ended for those browsers that do not support\r\n            // \"readyState\" property. We do not touch tracks created with\r\n            // default device ID \"\".\r\n            if (typeof this.getTrack().readyState === 'undefined'\r\n                    && typeof this._realDeviceId !== 'undefined'\r\n                    && !devices.find(d => d.deviceId === this._realDeviceId)) {\r\n                this._trackEnded = true;\r\n            }\r\n        };\r\n\r\n        // Subscribe each created local audio track to\r\n        // RTCEvents.AUDIO_OUTPUT_DEVICE_CHANGED event. This is different from\r\n        // handling this event for remote tracks (which are handled in RTC.js),\r\n        // because there might be local tracks not attached to a conference.\r\n        if (this.isAudioTrack() && RTCUtils.isDeviceChangeAvailable('output')) {\r\n            this._onAudioOutputDeviceChanged = this.setAudioOutput.bind(this);\r\n            RTCUtils.addListener(\r\n                RTCEvents.AUDIO_OUTPUT_DEVICE_CHANGED,\r\n                this._onAudioOutputDeviceChanged);\r\n        }\r\n\r\n        RTCUtils.addListener(\r\n            RTCEvents.DEVICE_LIST_CHANGED,\r\n            this._onDeviceListChanged);\r\n\r\n        this._initNoDataFromSourceHandlers();\r\n    }\r\n\r\n    /**\r\n     * Returns if associated MediaStreamTrack is in the 'ended' state\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    isEnded() {\r\n        return this.getTrack().readyState === 'ended' || this._trackEnded;\r\n    }\r\n\r\n    /**\r\n     * Sets handlers to the MediaStreamTrack object that will detect camera\r\n     * issues.\r\n     */\r\n    _initNoDataFromSourceHandlers() {\r\n        if (this.isVideoTrack() && this.videoType === VideoType.CAMERA) {\r\n            const _onNoDataFromSourceError\r\n                = this._onNoDataFromSourceError.bind(this);\r\n\r\n            this._setHandler('track_mute', () => {\r\n                if (this._checkForCameraIssues()) {\r\n                    const now = window.performance.now();\r\n\r\n                    this._noDataFromSourceTimeout\r\n                        = setTimeout(_onNoDataFromSourceError, 3000);\r\n                    this._setHandler('track_unmute', () => {\r\n                        this._clearNoDataFromSourceMuteResources();\r\n                        Statistics.sendAnalyticsAndLog(\r\n                            TRACK_UNMUTED,\r\n                            {\r\n                                'media_type': this.getType(),\r\n                                'track_type': 'local',\r\n                                value: window.performance.now() - now\r\n                            });\r\n                    });\r\n                }\r\n            });\r\n            this._setHandler('track_ended', _onNoDataFromSourceError);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Clears all timeouts and handlers set on MediaStreamTrack mute event.\r\n     * FIXME: Change the name of the method with better one.\r\n     */\r\n    _clearNoDataFromSourceMuteResources() {\r\n        if (this._noDataFromSourceTimeout) {\r\n            clearTimeout(this._noDataFromSourceTimeout);\r\n            this._noDataFromSourceTimeout = null;\r\n        }\r\n        this._setHandler('track_unmute', undefined);\r\n    }\r\n\r\n    /**\r\n     * Called when potential camera issue is detected. Clears the handlers and\r\n     * timeouts set on MediaStreamTrack muted event. Verifies that the camera\r\n     * issue persists and fires NO_DATA_FROM_SOURCE event.\r\n     */\r\n    _onNoDataFromSourceError() {\r\n        this._clearNoDataFromSourceMuteResources();\r\n        if (this._checkForCameraIssues()) {\r\n            this._fireNoDataFromSourceEvent();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Fires NO_DATA_FROM_SOURCE event and logs it to analytics and callstats.\r\n     */\r\n    _fireNoDataFromSourceEvent() {\r\n        this.emit(NO_DATA_FROM_SOURCE);\r\n\r\n        Statistics.sendAnalytics(createNoDataFromSourceEvent(this.getType()));\r\n        const log = { name: NO_DATA_FROM_SOURCE };\r\n\r\n        if (this.isAudioTrack()) {\r\n            log.isReceivingData = this._isReceivingData();\r\n        }\r\n        Statistics.sendLog(JSON.stringify(log));\r\n    }\r\n\r\n    /**\r\n     * Sets real device ID by comparing track information with device\r\n     * information. This is temporary solution until getConstraints() method\r\n     * will be implemented in browsers.\r\n     *\r\n     * @param {MediaDeviceInfo[]} devices - list of devices obtained from\r\n     * enumerateDevices() call\r\n     */\r\n    _setRealDeviceIdFromDeviceList(devices) {\r\n        const track = this.getTrack();\r\n\r\n        // FIXME for temasys video track, label refers to id not the actual\r\n        // device\r\n        const device = devices.find(\r\n            d => d.kind === `${track.kind}input` && d.label === track.label);\r\n\r\n        if (device) {\r\n            this._realDeviceId = device.deviceId;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Sets the stream property of JitsiLocalTrack object and sets all stored\r\n     * handlers to it.\r\n     *\r\n     * @param {MediaStream} stream the new stream.\r\n     * @protected\r\n     */\r\n    _setStream(stream) {\r\n        super._setStream(stream);\r\n\r\n        if (stream) {\r\n            // Store the MSID for video mute/unmute purposes.\r\n            this.storedMSID = this.getMSID();\r\n            logger.debug(`Setting new MSID: ${this.storedMSID} on ${this}`);\r\n        } else {\r\n            logger.debug(`Setting 'null' stream on ${this}`);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Asynchronously mutes this track.\r\n     *\r\n     * @returns {Promise}\r\n     */\r\n    mute() {\r\n        return this._queueSetMuted(true);\r\n    }\r\n\r\n    /**\r\n     * Asynchronously unmutes this track.\r\n     *\r\n     * @returns {Promise}\r\n     */\r\n    unmute() {\r\n        return this._queueSetMuted(false);\r\n    }\r\n\r\n    /**\r\n     * Initializes a new Promise to execute {@link #_setMuted}. May be called\r\n     * multiple times in a row and the invocations of {@link #_setMuted} and,\r\n     * consequently, {@link #mute} and/or {@link #unmute} will be resolved in a\r\n     * serialized fashion.\r\n     *\r\n     * @param {boolean} muted - The value to invoke <tt>_setMuted</tt> with.\r\n     * @returns {Promise}\r\n     */\r\n    _queueSetMuted(muted) {\r\n        const setMuted = this._setMuted.bind(this, muted);\r\n\r\n        this._prevSetMuted = this._prevSetMuted.then(setMuted, setMuted);\r\n\r\n        return this._prevSetMuted;\r\n    }\r\n\r\n    /**\r\n     * Mutes / unmutes this track.\r\n     *\r\n     * @param {boolean} muted - If <tt>true</tt>, this track will be muted;\r\n     * otherwise, this track will be unmuted.\r\n     * @private\r\n     * @returns {Promise}\r\n     */\r\n    _setMuted(muted) {\r\n        if (this.isMuted() === muted) {\r\n            return Promise.resolve();\r\n        }\r\n\r\n        if (this.disposed) {\r\n            return Promise.reject(new JitsiTrackError(TRACK_IS_DISPOSED));\r\n        }\r\n\r\n        let promise = Promise.resolve();\r\n\r\n        // A function that will print info about muted status transition\r\n        const logMuteInfo = () => logger.info(`Mute ${this}: ${muted}`);\r\n\r\n        if (this.isAudioTrack()\r\n                || this.videoType === VideoType.DESKTOP\r\n                || !browser.doesVideoMuteByStreamRemove()) {\r\n            logMuteInfo();\r\n            if (this.track) {\r\n                this.track.enabled = !muted;\r\n            }\r\n        } else if (muted) {\r\n            promise = new Promise((resolve, reject) => {\r\n                logMuteInfo();\r\n                this._removeStreamFromConferenceAsMute(\r\n                    () => {\r\n                        // FIXME: Maybe here we should set the SRC for the\r\n                        // containers to something\r\n                        // We don't want any events to be fired on this stream\r\n                        this._unregisterHandlers();\r\n                        this._stopStream();\r\n                        this._setStream(null);\r\n                        resolve();\r\n                    },\r\n                    reject);\r\n            });\r\n        } else {\r\n            logMuteInfo();\r\n\r\n            // This path is only for camera.\r\n            const streamOptions = {\r\n                cameraDeviceId: this.getDeviceId(),\r\n                devices: [ MediaType.VIDEO ],\r\n                facingMode: this.getCameraFacingMode()\r\n            };\r\n\r\n            if (browser.usesNewGumFlow()) {\r\n                promise\r\n                    = RTCUtils.newObtainAudioAndVideoPermissions(Object.assign(\r\n                        {},\r\n                        streamOptions,\r\n                        { constraints: { video: this._constraints } }));\r\n            } else {\r\n                if (this.resolution) {\r\n                    streamOptions.resolution = this.resolution;\r\n                }\r\n\r\n                promise\r\n                    = RTCUtils.obtainAudioAndVideoPermissions(streamOptions);\r\n            }\r\n\r\n            promise.then(streamsInfo => {\r\n                const mediaType = this.getType();\r\n                const streamInfo\r\n                    = browser.usesNewGumFlow()\r\n                        ? streamsInfo.find(\r\n                            info => info.track.kind === mediaType)\r\n                        : streamsInfo.find(\r\n                            info => info.mediaType === mediaType);\r\n\r\n                if (streamInfo) {\r\n                    this._setStream(streamInfo.stream);\r\n                    this.track = streamInfo.track;\r\n\r\n                    // This is not good when video type changes after\r\n                    // unmute, but let's not crash here\r\n                    if (this.videoType !== streamInfo.videoType) {\r\n                        logger.warn(\r\n                            `${this}: video type has changed after unmute!`,\r\n                            this.videoType, streamInfo.videoType);\r\n                        this.videoType = streamInfo.videoType;\r\n                    }\r\n                } else {\r\n                    throw new JitsiTrackError(TRACK_NO_STREAM_FOUND);\r\n                }\r\n\r\n                this.containers = this.containers.map(\r\n                    cont => RTCUtils.attachMediaStream(cont, this.stream));\r\n\r\n                return this._addStreamToConferenceAsUnmute();\r\n            });\r\n        }\r\n\r\n        return promise\r\n            .then(() => this._sendMuteStatus(muted))\r\n            .then(() => this.emit(TRACK_MUTE_CHANGED, this));\r\n    }\r\n\r\n    /**\r\n     * Adds stream to conference and marks it as \"unmute\" operation.\r\n     *\r\n     * @private\r\n     * @returns {Promise}\r\n     */\r\n    _addStreamToConferenceAsUnmute() {\r\n        if (!this.conference) {\r\n            return Promise.resolve();\r\n        }\r\n\r\n        // FIXME it would be good to not included conference as part of this\r\n        // process. Only TraceablePeerConnections to which the track is attached\r\n        // should care about this action. The TPCs to which the track is not\r\n        // attached can sync up when track is re-attached.\r\n        // A problem with that is that the \"modify sources\" queue is part of\r\n        // the JingleSessionPC and it would be excluded from the process. One\r\n        // solution would be to extract class between TPC and JingleSessionPC\r\n        // which would contain the queue and would notify the signaling layer\r\n        // when local SSRCs are changed. This would help to separate XMPP from\r\n        // the RTC module.\r\n        return new Promise((resolve, reject) => {\r\n            this.conference._addLocalTrackAsUnmute(this)\r\n                .then(resolve, error => reject(new Error(error)));\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Removes stream from conference and marks it as \"mute\" operation.\r\n     *\r\n     * @param {Function} successCallback will be called on success\r\n     * @param {Function} errorCallback will be called on error\r\n     * @private\r\n     */\r\n    _removeStreamFromConferenceAsMute(successCallback, errorCallback) {\r\n        if (!this.conference) {\r\n            successCallback();\r\n\r\n            return;\r\n        }\r\n        this.conference._removeLocalTrackAsMute(this).then(\r\n            successCallback,\r\n            error => errorCallback(new Error(error)));\r\n    }\r\n\r\n    /**\r\n     * Sends mute status for a track to conference if any.\r\n     *\r\n     * @param {boolean} mute - If track is muted.\r\n     * @private\r\n     * @returns {Promise}\r\n     */\r\n    _sendMuteStatus(mute) {\r\n        if (!this.conference || !this.conference.room) {\r\n            return Promise.resolve();\r\n        }\r\n\r\n        return new Promise(resolve => {\r\n            this.conference.room[\r\n                this.isAudioTrack()\r\n                    ? 'setAudioMute'\r\n                    : 'setVideoMute'](mute, resolve);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     *\r\n     * Stops sending the media track. And removes it from the HTML.\r\n     * NOTE: Works for local tracks only.\r\n     *\r\n     * @extends JitsiTrack#dispose\r\n     * @returns {Promise}\r\n     */\r\n    dispose() {\r\n        let promise = Promise.resolve();\r\n\r\n        if (this.conference) {\r\n            promise = this.conference.removeTrack(this);\r\n        }\r\n\r\n        if (this.stream) {\r\n            this._stopStream();\r\n            this.detach();\r\n        }\r\n\r\n        RTCUtils.removeListener(RTCEvents.DEVICE_LIST_CHANGED,\r\n            this._onDeviceListChanged);\r\n\r\n        if (this._onAudioOutputDeviceChanged) {\r\n            RTCUtils.removeListener(RTCEvents.AUDIO_OUTPUT_DEVICE_CHANGED,\r\n                this._onAudioOutputDeviceChanged);\r\n        }\r\n\r\n        return promise.then(() => super.dispose());\r\n    }\r\n\r\n    /**\r\n     * Returns <tt>true</tt> - if the stream is muted and <tt>false</tt>\r\n     * otherwise.\r\n     *\r\n     * @returns {boolean} <tt>true</tt> - if the stream is muted and\r\n     * <tt>false</tt> otherwise.\r\n     */\r\n    isMuted() {\r\n        // this.stream will be null when we mute local video on Chrome\r\n        if (!this.stream) {\r\n            return true;\r\n        }\r\n        if (this.isVideoTrack() && !this.isActive()) {\r\n            return true;\r\n        }\r\n\r\n        return !this.track || !this.track.enabled;\r\n    }\r\n\r\n    /**\r\n     * Sets the JitsiConference object associated with the track. This is temp\r\n     * solution.\r\n     *\r\n     * @param conference the JitsiConference object\r\n     */\r\n    _setConference(conference) {\r\n        this.conference = conference;\r\n\r\n        // We want to keep up with postponed events which should have been fired\r\n        // on \"attach\" call, but for local track we not always have the\r\n        // conference before attaching. However this may result in duplicated\r\n        // events if they have been triggered on \"attach\" already.\r\n        for (let i = 0; i < this.containers.length; i++) {\r\n            this._maybeFireTrackAttached(this.containers[i]);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns <tt>true</tt>.\r\n     *\r\n     * @returns {boolean} <tt>true</tt>\r\n     */\r\n    isLocal() {\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Returns device id associated with track.\r\n     *\r\n     * @returns {string}\r\n     */\r\n    getDeviceId() {\r\n        return this._realDeviceId || this.deviceId;\r\n    }\r\n\r\n    /**\r\n     * Returns the participant id which owns the track.\r\n     *\r\n     * @returns {string} the id of the participants. It corresponds to the\r\n     * Colibri endpoint id/MUC nickname in case of Jitsi-meet.\r\n     */\r\n    getParticipantId() {\r\n        return this.conference && this.conference.myUserId();\r\n    }\r\n\r\n    /**\r\n     * Handles bytes sent statistics.\r\n     *\r\n     * @param {TraceablePeerConnection} tpc the source of the \"bytes sent\" stat\r\n     * @param {number} bytesSent the new value\r\n     * NOTE: used only for audio tracks to detect audio issues.\r\n     */\r\n    _onByteSentStatsReceived(tpc, bytesSent) {\r\n        if (bytesSent > 0) {\r\n            this._hasSentData = true;\r\n        }\r\n        const iceConnectionState = tpc.getConnectionState();\r\n\r\n        if (this._testDataSent && iceConnectionState === 'connected') {\r\n            setTimeout(() => {\r\n                if (!this._hasSentData) {\r\n                    logger.warn(`${this} 'bytes sent' <= 0: \\\r\n                        ${this._bytesSent}`);\r\n\r\n                    // we are not receiving anything from the microphone\r\n                    this._fireNoDataFromSourceEvent();\r\n                }\r\n            }, 3000);\r\n            this._testDataSent = false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns facing mode for video track from camera. For other cases (e.g.\r\n     * audio track or 'desktop' video track) returns undefined.\r\n     *\r\n     * @returns {CameraFacingMode|undefined}\r\n     */\r\n    getCameraFacingMode() {\r\n        if (this.isVideoTrack() && this.videoType === VideoType.CAMERA) {\r\n            // MediaStreamTrack#getSettings() is not implemented in many\r\n            // browsers, so we need feature checking here. Progress on the\r\n            // respective browser's implementation can be tracked at\r\n            // https://bugs.chromium.org/p/webrtc/issues/detail?id=2481 for\r\n            // Chromium and https://bugzilla.mozilla.org/show_bug.cgi?id=1213517\r\n            // for Firefox. Even if a browser implements getSettings() already,\r\n            // it might still not return anything for 'facingMode'.\r\n            let trackSettings;\r\n\r\n            try {\r\n                trackSettings = this.track.getSettings();\r\n            } catch (e) {\r\n                // XXX React-native-webrtc, for example, defines\r\n                // MediaStreamTrack#getSettings() but the implementation throws\r\n                // a \"Not implemented\" Error.\r\n            }\r\n            if (trackSettings && 'facingMode' in trackSettings) {\r\n                return trackSettings.facingMode;\r\n            }\r\n\r\n            if (typeof this._facingMode !== 'undefined') {\r\n                return this._facingMode;\r\n            }\r\n\r\n            // In most cases we are showing a webcam. So if we've gotten here,\r\n            // it should be relatively safe to assume that we are probably\r\n            // showing the user-facing camera.\r\n            return CameraFacingMode.USER;\r\n        }\r\n\r\n        return undefined;\r\n    }\r\n\r\n    /**\r\n     * Stops the associated MediaStream.\r\n     */\r\n    _stopStream() {\r\n\r\n        /**\r\n         * Indicates that we are executing {@link #_stopStream} i.e.\r\n         * {@link RTCUtils#stopMediaStream} for the <tt>MediaStream</tt>\r\n         * associated with this <tt>JitsiTrack</tt> instance.\r\n         *\r\n         * @private\r\n         * @type {boolean}\r\n         */\r\n        this._stopStreamInProgress = true;\r\n\r\n        try {\r\n            RTCUtils.stopMediaStream(this.stream);\r\n        } finally {\r\n            this._stopStreamInProgress = false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Switches the camera facing mode if the WebRTC implementation supports the\r\n     * custom MediaStreamTrack._switchCamera method. Currently, the method in\r\n     * question is implemented in react-native-webrtc only. When such a WebRTC\r\n     * implementation is executing, the method is the preferred way to switch\r\n     * between the front/user-facing and the back/environment-facing cameras\r\n     * because it will likely be (as is the case of react-native-webrtc)\r\n     * noticeably faster that creating a new MediaStreamTrack via a new\r\n     * getUserMedia call with the switched facingMode constraint value.\r\n     * Moreover, the approach with a new getUserMedia call may not even work:\r\n     * WebRTC on Android and iOS is either very slow to open the camera a second\r\n     * time or plainly freezes attempting to do that.\r\n     */\r\n    _switchCamera() {\r\n        if (this.isVideoTrack()\r\n                && this.videoType === VideoType.CAMERA\r\n                && typeof this.track._switchCamera === 'function') {\r\n            this.track._switchCamera();\r\n\r\n            this._facingMode\r\n                = this._facingMode === CameraFacingMode.ENVIRONMENT\r\n                    ? CameraFacingMode.USER\r\n                    : CameraFacingMode.ENVIRONMENT;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Detects camera issues, i.e. returns true if we expect this track to be\r\n     * receiving data from its source, but it isn't receiving data.\r\n     *\r\n     * @returns {boolean} true if an issue is detected and false otherwise\r\n     */\r\n    _checkForCameraIssues() {\r\n        if (!this.isVideoTrack()\r\n                || this._stopStreamInProgress\r\n                || this.videoType === VideoType.DESKTOP) {\r\n            return false;\r\n        }\r\n\r\n        return !this._isReceivingData();\r\n    }\r\n\r\n    /**\r\n     * Checks whether the attached MediaStream is receiving data from source or\r\n     * not. If the stream property is null(because of mute or another reason)\r\n     * this method will return false.\r\n     * NOTE: This method doesn't indicate problem with the streams directly.\r\n     * For example in case of video mute the method will return false or if the\r\n     * user has disposed the track.\r\n     *\r\n     * @returns {boolean} true if the stream is receiving data and false\r\n     * this otherwise.\r\n     */\r\n    _isReceivingData() {\r\n        if (!this.stream) {\r\n            return false;\r\n        }\r\n\r\n        // In older version of the spec there is no muted property and\r\n        // readyState can have value muted. In the latest versions\r\n        // readyState can have values \"live\" and \"ended\" and there is\r\n        // muted boolean property. If the stream is muted that means that\r\n        // we aren't receiving any data from the source. We want to notify\r\n        // the users for error if the stream is muted or ended on it's\r\n        // creation.\r\n        return this.stream.getTracks().some(track =>\r\n            (!('readyState' in track) || track.readyState === 'live')\r\n                && (!('muted' in track) || track.muted !== true));\r\n    }\r\n\r\n    /**\r\n     * Creates a text representation of this local track instance.\r\n     *\r\n     * @return {string}\r\n     */\r\n    toString() {\r\n        return `LocalTrack[${this.rtcId},${this.getType()}]`;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/RTC/JitsiLocalTrack.js","/* global __filename, RTCIceGatherer, RTCIceTransport, RTCDtlsTransport,\r\nRTCRtpSender, RTCRtpReceiver */\r\n\r\nimport { getLogger } from 'jitsi-meet-logger';\r\nimport yaeti from 'yaeti';\r\n\r\nimport RTCSessionDescription from './RTCSessionDescription';\r\nimport * as utils from './utils';\r\nimport { InvalidStateError } from './errors';\r\nimport RandomUtil from '../../util/RandomUtil';\r\nimport SDPUtil from '../../xmpp/SDPUtil';\r\n\r\nconst logger = getLogger(__filename);\r\n\r\nconst RTCSignalingState = {\r\n    stable: 'stable',\r\n    haveLocalOffer: 'have-local-offer',\r\n    haveRemoteOffer: 'have-remote-offer',\r\n    closed: 'closed'\r\n};\r\n\r\nconst RTCIceGatheringState = {\r\n    new: 'new',\r\n    gathering: 'gathering',\r\n    complete: 'complete'\r\n};\r\n\r\nconst CNAME = `jitsi-ortc-cname-${RandomUtil.randomInt(10000, 99999)}`;\r\n\r\n/**\r\n * RTCPeerConnection shim for ORTC based endpoints (such as Edge).\r\n *\r\n * The interface is based on the W3C specification of 2015, which matches\r\n * the implementation of Chrome nowadays:\r\n *\r\n *   https://www.w3.org/TR/2015/WD-webrtc-20150210/\r\n *\r\n * It also implements Plan-B for multi-stream, and assumes single BUNDLEd\r\n * transport and rtcp-mux.\r\n */\r\nexport default class ortcRTCPeerConnection extends yaeti.EventTarget {\r\n    /**\r\n     */\r\n    constructor(pcConfig) {\r\n        super();\r\n\r\n        logger.debug('constructor() pcConfig:', pcConfig);\r\n\r\n        // Buffered local ICE candidates (in WebRTC format).\r\n        // @type {sequence<RTCIceCandidate>}\r\n        this._bufferedIceCandidates = [];\r\n\r\n        // Closed flag.\r\n        // @type {Boolean}\r\n        this._closed = false;\r\n\r\n        // RTCDtlsTransport.\r\n        // @type {RTCDtlsTransport}\r\n        this._dtlsTransport = null;\r\n\r\n        // RTCIceGatherer.\r\n        // @type {RTCIceGatherer}\r\n        this._iceGatherer = null;\r\n\r\n        // RTCPeerConnection iceGatheringState.\r\n        // NOTE: This should not be needed, but Edge does not implement\r\n        // iceGatherer.state.\r\n        // @type {RTCIceGatheringState}\r\n        this._iceGatheringState = RTCIceGatheringState.new;\r\n\r\n        // RTCIceTransport.\r\n        // @type {RTCIceTransport}\r\n        this._iceTransport = null;\r\n\r\n        // Local RTP capabilities (filtered with remote ones).\r\n        // @type {RTCRtpCapabilities}\r\n        this._localCapabilities = null;\r\n\r\n        // Local RTCSessionDescription.\r\n        // @type {RTCSessionDescription}\r\n        this._localDescription = null;\r\n\r\n        // Map with info regarding local media.\r\n        // - index: MediaStreamTrack.id\r\n        // - value: Object\r\n        //   - rtpSender: Associated RTCRtpSender instance\r\n        //   - stream: Associated MediaStream instance\r\n        //   - ssrc: Provisional or definitive SSRC\r\n        //   - rtxSsrc: Provisional or definitive SSRC for RTX\r\n        //   - sending: Boolean indicating whether rtpSender.send() was called.\r\n        this._localTrackInfos = new Map();\r\n\r\n        // Ordered Map with MID as key and kind as value.\r\n        // @type {map<String, String>}\r\n        this._mids = new Map();\r\n\r\n        // Remote RTCSessionDescription.\r\n        // @type {RTCSessionDescription}\r\n        this._remoteDescription = null;\r\n\r\n        // Map of remote streams.\r\n        // - index: MediaStream.jitsiRemoteId (as signaled in remote SDP)\r\n        // - value: MediaStream (locally generated so id does not match)\r\n        // @type {map<Number, MediaStream>}\r\n        this._remoteStreams = new Map();\r\n\r\n        // Map with info about receiving media.\r\n        // - index: Media SSRC\r\n        // - value: Object\r\n        //   - kind: 'audio' / 'video'\r\n        //   - ssrc: Media SSRC\r\n        //   - rtxSsrc: RTX SSRC (may be unset)\r\n        //   - streamId: MediaStream.jitsiRemoteId\r\n        //   - trackId: MediaStreamTrack.jitsiRemoteId\r\n        //   - cname: CNAME\r\n        //   - stream: MediaStream\r\n        //   - track: MediaStreamTrack\r\n        //   - rtpReceiver: Associated RTCRtpReceiver instance\r\n        // @type {map<Number, Object>}\r\n        this._remoteTrackInfos = new Map();\r\n\r\n        // Local SDP global fields.\r\n        this._sdpGlobalFields = {\r\n            id: SDPUtil.generateSsrc(),\r\n            version: 0\r\n        };\r\n\r\n        // RTCPeerConnection signalingState.\r\n        // @type {RTCSignalingState}\r\n        this._signalingState = RTCSignalingState.stable;\r\n\r\n        // Create the RTCIceGatherer.\r\n        this._setIceGatherer(pcConfig);\r\n\r\n        // Create the RTCIceTransport.\r\n        this._setIceTransport(this._iceGatherer);\r\n\r\n        // Create the RTCDtlsTransport.\r\n        this._setDtlsTransport(this._iceTransport);\r\n    }\r\n\r\n    /**\r\n     * Current ICE+DTLS connection state.\r\n     * @return {RTCPeerConnectionState}\r\n     */\r\n    get connectionState() {\r\n        return this._dtlsTransport.state;\r\n    }\r\n\r\n    /**\r\n     * Current ICE connection state.\r\n     * @return {RTCIceConnectionState}\r\n     */\r\n    get iceConnectionState() {\r\n        return this._iceTransport.state;\r\n    }\r\n\r\n    /**\r\n     * Current ICE gathering state.\r\n     * @return {RTCIceGatheringState}\r\n     */\r\n    get iceGatheringState() {\r\n        return this._iceGatheringState;\r\n    }\r\n\r\n    /**\r\n     * Gets the local description.\r\n     * @return {RTCSessionDescription}\r\n     */\r\n    get localDescription() {\r\n        return this._localDescription;\r\n    }\r\n\r\n    /**\r\n     * Gets the remote description.\r\n     * @return {RTCSessionDescription}\r\n     */\r\n    get remoteDescription() {\r\n        return this._remoteDescription;\r\n    }\r\n\r\n    /**\r\n     * Current signaling state.\r\n     * @return {RTCSignalingState}\r\n     */\r\n    get signalingState() {\r\n        return this._signalingState;\r\n    }\r\n\r\n    /**\r\n     * Adds a remote ICE candidate. Implements both the old callbacks based\r\n     * signature and the new Promise based style.\r\n     *\r\n     * Arguments in Promise mode:\r\n     * @param {RTCIceCandidate} candidate\r\n     *\r\n     * Arguments in callbacks mode:\r\n     * @param {RTCIceCandidate} candidate\r\n     * @param {function()} callback\r\n     * @param {function(error)} errback\r\n     */\r\n    addIceCandidate(candidate, ...args) {\r\n        let usePromise;\r\n        let callback;\r\n        let errback;\r\n\r\n        if (!candidate) {\r\n            throw new TypeError('candidate missing');\r\n        }\r\n\r\n        if (args.length === 0) {\r\n            usePromise = true;\r\n        } else {\r\n            usePromise = false;\r\n            callback = args[0];\r\n            errback = args[1];\r\n\r\n            if (typeof callback !== 'function') {\r\n                throw new TypeError('callback missing');\r\n            }\r\n\r\n            if (typeof errback !== 'function') {\r\n                throw new TypeError('errback missing');\r\n            }\r\n        }\r\n\r\n        logger.debug('addIceCandidate() candidate:', candidate);\r\n\r\n        if (usePromise) {\r\n            return this._addIceCandidate(candidate);\r\n        }\r\n\r\n        this._addIceCandidate(candidate)\r\n            .then(() => callback())\r\n            .catch(error => errback(error));\r\n    }\r\n\r\n    /**\r\n     * Adds a local MediaStream.\r\n     * @param {MediaStream} stream.\r\n     * NOTE: Deprecated API.\r\n     */\r\n    addStream(stream) {\r\n        logger.debug('addStream()');\r\n\r\n        this._addStream(stream);\r\n    }\r\n\r\n    /**\r\n     * Closes the RTCPeerConnection and all the underlying ORTC objects.\r\n     */\r\n    close() {\r\n        if (this._closed) {\r\n            return;\r\n        }\r\n\r\n        this._closed = true;\r\n\r\n        logger.debug('close()');\r\n\r\n        this._updateAndEmitSignalingStateChange(RTCSignalingState.closed);\r\n\r\n        // Close RTCIceGatherer.\r\n        // NOTE: Not yet implemented by Edge.\r\n        try {\r\n            this._iceGatherer.close();\r\n        } catch (error) {\r\n            logger.warn(`iceGatherer.close() failed:${error}`);\r\n        }\r\n\r\n        // Close RTCIceTransport.\r\n        try {\r\n            this._iceTransport.stop();\r\n        } catch (error) {\r\n            logger.warn(`iceTransport.stop() failed:${error}`);\r\n        }\r\n\r\n        // Close RTCDtlsTransport.\r\n        try {\r\n            this._dtlsTransport.stop();\r\n        } catch (error) {\r\n            logger.warn(`dtlsTransport.stop() failed:${error}`);\r\n        }\r\n\r\n        // Close and clear RTCRtpSenders.\r\n        for (const info of this._localTrackInfos.values()) {\r\n            const rtpSender = info.rtpSender;\r\n\r\n            try {\r\n                rtpSender.stop();\r\n            } catch (error) {\r\n                logger.warn(`rtpSender.stop() failed:${error}`);\r\n            }\r\n        }\r\n\r\n        this._localTrackInfos.clear();\r\n\r\n        // Close and clear RTCRtpReceivers.\r\n        for (const info of this._remoteTrackInfos.values()) {\r\n            const rtpReceiver = info.rtpReceiver;\r\n\r\n            try {\r\n                rtpReceiver.stop();\r\n            } catch (error) {\r\n                logger.warn(`rtpReceiver.stop() failed:${error}`);\r\n            }\r\n        }\r\n\r\n        this._remoteTrackInfos.clear();\r\n\r\n        // Clear remote streams.\r\n        this._remoteStreams.clear();\r\n    }\r\n\r\n    /**\r\n     * Creates a local answer. Implements both the old callbacks based signature\r\n     * and the new Promise based style.\r\n     *\r\n     * Arguments in Promise mode:\r\n     * @param {RTCOfferOptions} [options]\r\n     *\r\n     * Arguments in callbacks mode:\r\n     * @param {function(desc)} callback\r\n     * @param {function(error)} errback\r\n     * @param {MediaConstraints} [constraints]\r\n     */\r\n    createAnswer(...args) {\r\n        let usePromise;\r\n        let options;\r\n        let callback;\r\n        let errback;\r\n\r\n        if (args.length <= 1) {\r\n            usePromise = true;\r\n            options = args[0];\r\n        } else {\r\n            usePromise = false;\r\n            callback = args[0];\r\n            errback = args[1];\r\n            options = args[2];\r\n\r\n            if (typeof callback !== 'function') {\r\n                throw new TypeError('callback missing');\r\n            }\r\n\r\n            if (typeof errback !== 'function') {\r\n                throw new TypeError('errback missing');\r\n            }\r\n        }\r\n\r\n        logger.debug('createAnswer() options:', options);\r\n\r\n        if (usePromise) {\r\n            return this._createAnswer(options);\r\n        }\r\n\r\n        this._createAnswer(options)\r\n            .then(desc => callback(desc))\r\n            .catch(error => errback(error));\r\n    }\r\n\r\n    /**\r\n     * Creates a RTCDataChannel.\r\n     */\r\n    createDataChannel() {\r\n        logger.debug('createDataChannel()');\r\n\r\n        // NOTE: DataChannels not implemented in Edge.\r\n        throw new Error('createDataChannel() not supported in Edge');\r\n    }\r\n\r\n    /**\r\n     * Creates a local offer. Implements both the old callbacks based signature\r\n     * and the new Promise based style.\r\n     *\r\n     * Arguments in Promise mode:\r\n     * @param {RTCOfferOptions} [options]\r\n     *\r\n     * Arguments in callbacks mode:\r\n     * @param {function(desc)} callback\r\n     * @param {function(error)} errback\r\n     * @param {MediaConstraints} [constraints]\r\n     */\r\n    createOffer(...args) {\r\n        let usePromise;\r\n        let options;\r\n        let callback;\r\n        let errback;\r\n\r\n        if (args.length <= 1) {\r\n            usePromise = true;\r\n            options = args[0];\r\n        } else {\r\n            usePromise = false;\r\n            callback = args[0];\r\n            errback = args[1];\r\n            options = args[2];\r\n\r\n            if (typeof callback !== 'function') {\r\n                throw new TypeError('callback missing');\r\n            }\r\n\r\n            if (typeof errback !== 'function') {\r\n                throw new TypeError('errback missing');\r\n            }\r\n        }\r\n\r\n        logger.debug('createOffer() options:', options);\r\n\r\n        if (usePromise) {\r\n            return this._createOffer(options);\r\n        }\r\n\r\n        this._createOffer(options)\r\n            .then(desc => callback(desc))\r\n            .catch(error => errback(error));\r\n    }\r\n\r\n    /**\r\n     * Gets a sequence of local MediaStreams.\r\n     * @return {sequence<MediaStream>}\r\n     */\r\n    getLocalStreams() {\r\n        return Array.from(this._localTrackInfos.values())\r\n            .map(info => info.stream)\r\n            .filter((elem, pos, arr) => arr.indexOf(elem) === pos);\r\n    }\r\n\r\n    /**\r\n     * Gets a sequence of remote MediaStreams.\r\n     * @return {sequence<MediaStream>}\r\n     */\r\n    getRemoteStreams() {\r\n        return Array.from(this._remoteStreams.values());\r\n    }\r\n\r\n    /**\r\n     * Get RTP statistics. Implements both the old callbacks based signature\r\n     * and the new Promise based style.\r\n     *\r\n     * Arguments in Promise mode:\r\n     * @param {MediaStreamTrack} [selector]\r\n     *\r\n     * Arguments in callbacks mode:\r\n     * @param {MediaStreamTrack} [selector]\r\n     * @param {function(desc)} callback\r\n     * @param {function(error)} errback\r\n     */\r\n    getStats(...args) {\r\n        let usePromise;\r\n        let selector;\r\n        let callback;\r\n        let errback;\r\n\r\n        if (typeof args[0] === 'function') {\r\n            usePromise = false;\r\n            callback = args[0];\r\n            errback = args[1];\r\n        } else if (typeof args[1] === 'function') {\r\n            usePromise = false;\r\n            selector = args[0];\r\n            callback = args[1];\r\n            errback = args[2];\r\n        } else {\r\n            usePromise = true;\r\n            selector = args[0];\r\n        }\r\n\r\n        if (!usePromise && !errback) {\r\n            errback = error => {\r\n                logger.error(`getStats() failed: ${error}`);\r\n                logger.error(error.stack);\r\n            };\r\n        }\r\n\r\n        if (usePromise) {\r\n            return this._getStats(selector);\r\n        }\r\n\r\n        this._getStats(selector)\r\n            .then(stats => callback(stats))\r\n            .catch(error => errback(error));\r\n    }\r\n\r\n    /**\r\n     * Removes a local MediaStream.\r\n     * @param {MediaStream} stream.\r\n     * NOTE: Deprecated API.\r\n     */\r\n    removeStream(stream) {\r\n        logger.debug('removeStream()');\r\n\r\n        this._removeStream(stream);\r\n    }\r\n\r\n    /**\r\n     * Applies a local description. Implements both the old callbacks based\r\n     * signature and the new Promise based style.\r\n     *\r\n     * Arguments in Promise mode:\r\n     * @param {RTCSessionDescriptionInit} desc\r\n     *\r\n     * Arguments in callbacks mode:\r\n     * @param {RTCSessionDescription} desc\r\n     * @param {function()} callback\r\n     * @param {function(error)} errback\r\n     */\r\n    setLocalDescription(desc, ...args) {\r\n        let usePromise;\r\n        let callback;\r\n        let errback;\r\n\r\n        if (!desc) {\r\n            throw new TypeError('description missing');\r\n        }\r\n\r\n        if (args.length === 0) {\r\n            usePromise = true;\r\n        } else {\r\n            usePromise = false;\r\n            callback = args[0];\r\n            errback = args[1];\r\n\r\n            if (typeof callback !== 'function') {\r\n                throw new TypeError('callback missing');\r\n            }\r\n\r\n            if (typeof errback !== 'function') {\r\n                throw new TypeError('errback missing');\r\n            }\r\n        }\r\n\r\n        logger.debug('setLocalDescription() desc:', desc);\r\n\r\n        if (usePromise) {\r\n            return this._setLocalDescription(desc);\r\n        }\r\n\r\n        this._setLocalDescription(desc)\r\n            .then(() => callback())\r\n            .catch(error => errback(error));\r\n    }\r\n\r\n    /**\r\n     * Applies a remote description. Implements both the old callbacks based\r\n     * signature and the new Promise based style.\r\n     *\r\n     * Arguments in Promise mode:\r\n     * @param {RTCSessionDescriptionInit} desc\r\n     *\r\n     * Arguments in callbacks mode:\r\n     * @param {RTCSessionDescription} desc\r\n     * @param {function()} callback\r\n     * @param {function(error)} errback\r\n     */\r\n    setRemoteDescription(desc, ...args) {\r\n        let usePromise;\r\n        let callback;\r\n        let errback;\r\n\r\n        if (!desc) {\r\n            throw new TypeError('description missing');\r\n        }\r\n\r\n        if (args.length === 0) {\r\n            usePromise = true;\r\n        } else {\r\n            usePromise = false;\r\n            callback = args[0];\r\n            errback = args[1];\r\n\r\n            if (typeof callback !== 'function') {\r\n                throw new TypeError('callback missing');\r\n            }\r\n\r\n            if (typeof errback !== 'function') {\r\n                throw new TypeError('errback missing');\r\n            }\r\n        }\r\n\r\n        logger.debug('setRemoteDescription() desc:', desc);\r\n\r\n        if (usePromise) {\r\n            return this._setRemoteDescription(desc);\r\n        }\r\n\r\n        this._setRemoteDescription(desc)\r\n            .then(() => callback())\r\n            .catch(error => errback(error));\r\n    }\r\n\r\n    /**\r\n     * Promise based implementation for addIceCandidate().\r\n     * @return {Promise}\r\n     * @private\r\n     */\r\n    _addIceCandidate(candidate) { // eslint-disable-line no-unused-vars\r\n        if (this._closed) {\r\n            return Promise.reject(\r\n                new InvalidStateError('RTCPeerConnection closed'));\r\n        }\r\n\r\n        // NOTE: Edge does not support Trickle-ICE so just candidates in the\r\n        // remote SDP are applied. Candidates given later would be just\r\n        // ignored, so notify the called about that.\r\n        return Promise.reject(new Error('addIceCandidate() not supported'));\r\n    }\r\n\r\n    /**\r\n     * Implementation for addStream().\r\n     * @private\r\n     */\r\n    _addStream(stream) {\r\n        if (this._closed) {\r\n            throw new InvalidStateError('RTCPeerConnection closed');\r\n        }\r\n\r\n        // Create a RTCRtpSender for each track.\r\n        for (const track of stream.getTracks()) {\r\n            // Ignore if ended.\r\n            if (track.readyState === 'ended') {\r\n                logger.warn('ignoring ended MediaStreamTrack');\r\n\r\n                continue; // eslint-disable-line no-continue\r\n            }\r\n\r\n            // Ignore if track is already present.\r\n            if (this._localTrackInfos.has(track.id)) {\r\n                logger.warn('ignoring already handled MediaStreamTrack');\r\n\r\n                continue; // eslint-disable-line no-continue\r\n            }\r\n\r\n            const rtpSender = new RTCRtpSender(track, this._dtlsTransport);\r\n\r\n            // Store it in the map.\r\n            this._localTrackInfos.set(track.id, {\r\n                rtpSender,\r\n                stream\r\n            });\r\n        }\r\n\r\n        // Check for local tracks removal.\r\n        for (const [ trackId, info ] of this._localTrackInfos) {\r\n            const track = info.rtpSender.track;\r\n\r\n            // Check if any of the local tracks has been stopped.\r\n            if (track.readyState === 'ended') {\r\n                logger.warn(\r\n                    '_addStream() an already handled track was stopped, '\r\n                    + `track.id:${track.id}`);\r\n\r\n                try {\r\n                    info.rtpSender.stop();\r\n                } catch (error) {\r\n                    logger.warn(`rtpSender.stop() failed:${error}`);\r\n                }\r\n\r\n                // Remove from the map.\r\n                this._localTrackInfos.delete(track.id);\r\n\r\n            // Also, if the stream was already handled, check whether tracks\r\n            // have been removed via stream.removeTrack() and, if so, stop\r\n            // their RtpSenders.\r\n            } else if (info.stream === stream\r\n                && !stream.getTrackById(trackId)) {\r\n                logger.warn(\r\n                    '_addStream() a track in this stream was removed, '\r\n                    + `track.id:${trackId}`);\r\n\r\n                try {\r\n                    info.rtpSender.stop();\r\n                } catch (error) {\r\n                    logger.warn(`rtpSender.stop() failed:${error}`);\r\n                }\r\n\r\n                // Remove from the map.\r\n                this._localTrackInfos.delete(track.id);\r\n            }\r\n        }\r\n\r\n        // It may need to renegotiate.\r\n        this._emitNegotiationNeeded();\r\n    }\r\n\r\n    /**\r\n     * Promise based implementation for createAnswer().\r\n     * @returns {Promise}\r\n     * @private\r\n     */\r\n    _createAnswer(options) { // eslint-disable-line no-unused-vars\r\n        if (this._closed) {\r\n            return Promise.reject(\r\n                new InvalidStateError('RTCPeerConnection closed'));\r\n        }\r\n\r\n        if (this.signalingState !== RTCSignalingState.haveRemoteOffer) {\r\n            return Promise.reject(new InvalidStateError(\r\n                `invalid signalingState \"${this.signalingState}\"`));\r\n        }\r\n\r\n        // Create an answer.\r\n        const localDescription = this._createLocalDescription('answer');\r\n\r\n        // Resolve with it.\r\n        return Promise.resolve(localDescription);\r\n    }\r\n\r\n    /**\r\n     * Creates the local RTCSessionDescription.\r\n     * @param {String} type - 'offer' / 'answer'.\r\n     * @return {RTCSessionDescription}\r\n     */\r\n    _createLocalDescription(type) {\r\n        const sdpObject = {};\r\n        const localIceParameters = this._iceGatherer.getLocalParameters();\r\n        const localIceCandidates = this._iceGatherer.getLocalCandidates();\r\n        const localDtlsParameters = this._dtlsTransport.getLocalParameters();\r\n        const remoteDtlsParameters = this._dtlsTransport.getRemoteParameters();\r\n        const localCapabilities = this._localCapabilities;\r\n        const localTrackInfos = this._localTrackInfos;\r\n\r\n        // Increase SDP version if an offer.\r\n        if (type === 'offer') {\r\n            this._sdpGlobalFields.version++;\r\n        }\r\n\r\n        // SDP global fields.\r\n        sdpObject.version = 0;\r\n        sdpObject.origin = {\r\n            address: '127.0.0.1',\r\n            ipVer: 4,\r\n            netType: 'IN',\r\n            sessionId: this._sdpGlobalFields.id,\r\n            sessionVersion: this._sdpGlobalFields.version,\r\n            username: 'jitsi-ortc-webrtc-shim'\r\n        };\r\n        sdpObject.name = '-';\r\n        sdpObject.timing = {\r\n            start: 0,\r\n            stop: 0\r\n        };\r\n        sdpObject.msidSemantic = {\r\n            semantic: 'WMS',\r\n            token: '*'\r\n        };\r\n        sdpObject.groups = [\r\n            {\r\n                mids: Array.from(this._mids.keys()).join(' '),\r\n                type: 'BUNDLE'\r\n            }\r\n        ];\r\n        sdpObject.media = [];\r\n\r\n        // DTLS fingerprint.\r\n        sdpObject.fingerprint = {\r\n            hash: localDtlsParameters.fingerprints[0].value,\r\n            type: localDtlsParameters.fingerprints[0].algorithm\r\n        };\r\n\r\n        // Let's check whether there is video RTX.\r\n        let hasVideoRtx = false;\r\n\r\n        for (const codec of localCapabilities.codecs) {\r\n            if (codec.kind === 'video' && codec.name === 'rtx') {\r\n                hasVideoRtx = true;\r\n                break;\r\n            }\r\n        }\r\n\r\n        // Add m= sections.\r\n        for (const [ mid, kind ] of this._mids) {\r\n            addMediaSection.call(this, mid, kind);\r\n        }\r\n\r\n        // Create a RTCSessionDescription.\r\n        const localDescription = new RTCSessionDescription({\r\n            type,\r\n            _sdpObject: sdpObject\r\n        });\r\n\r\n        logger.debug('_createLocalDescription():', localDescription);\r\n\r\n        return localDescription;\r\n\r\n        /**\r\n         * Add a m= section.\r\n         */\r\n        function addMediaSection(mid, kind) {\r\n            const mediaObject = {};\r\n\r\n            // m= line.\r\n            mediaObject.type = kind;\r\n\r\n            switch (kind) {\r\n            case 'audio':\r\n            case 'video':\r\n                mediaObject.protocol = 'RTP/SAVPF';\r\n                mediaObject.port = 9;\r\n                mediaObject.direction = 'sendrecv';\r\n                break;\r\n            case 'application':\r\n                mediaObject.protocol = 'DTLS/SCTP';\r\n                mediaObject.port = 0; // Reject m section.\r\n                mediaObject.payloads = '0'; // Just put something.\r\n                mediaObject.direction = 'inactive';\r\n                break;\r\n            }\r\n\r\n            // c= line.\r\n            mediaObject.connection = {\r\n                ip: '127.0.0.1',\r\n                version: 4\r\n            };\r\n\r\n            // a=mid attribute.\r\n            mediaObject.mid = mid;\r\n\r\n            // ICE.\r\n            mediaObject.iceUfrag = localIceParameters.usernameFragment;\r\n            mediaObject.icePwd = localIceParameters.password;\r\n            mediaObject.candidates = [];\r\n\r\n            for (const candidate of localIceCandidates) {\r\n                const candidateObject = {};\r\n\r\n                // rtcp-mux is assumed, so component is always 1 (RTP).\r\n                candidateObject.component = 1;\r\n                candidateObject.foundation = candidate.foundation;\r\n                candidateObject.ip = candidate.ip;\r\n                candidateObject.port = candidate.port;\r\n                candidateObject.priority = candidate.priority;\r\n                candidateObject.transport\r\n                    = candidate.protocol.toLowerCase();\r\n                candidateObject.type = candidate.type;\r\n                if (candidateObject.transport === 'tcp') {\r\n                    candidateObject.tcptype = candidate.tcpType;\r\n                }\r\n\r\n                mediaObject.candidates.push(candidateObject);\r\n            }\r\n\r\n            mediaObject.endOfCandidates = 'end-of-candidates';\r\n\r\n            // DTLS.\r\n            // If 'offer' always use 'actpass'.\r\n            if (type === 'offer') {\r\n                mediaObject.setup = 'actpass';\r\n            } else {\r\n                mediaObject.setup = remoteDtlsParameters.role === 'server'\r\n                    ? 'active' : 'passive';\r\n            }\r\n\r\n            if (kind === 'audio' || kind === 'video') {\r\n                mediaObject.rtp = [];\r\n                mediaObject.rtcpFb = [];\r\n                mediaObject.fmtp = [];\r\n\r\n                // Array of payload types.\r\n                const payloads = [];\r\n\r\n                // Add codecs.\r\n                for (const codec of localCapabilities.codecs) {\r\n                    if (codec.kind && codec.kind !== kind) {\r\n                        continue; // eslint-disable-line no-continue\r\n                    }\r\n\r\n                    payloads.push(codec.preferredPayloadType);\r\n\r\n                    const rtpObject = {\r\n                        codec: codec.name,\r\n                        payload: codec.preferredPayloadType,\r\n                        rate: codec.clockRate\r\n                    };\r\n\r\n                    if (codec.numChannels > 1) {\r\n                        rtpObject.encoding = codec.numChannels;\r\n                    }\r\n\r\n                    mediaObject.rtp.push(rtpObject);\r\n\r\n                    // If codec has parameters add them into a=fmtp attributes.\r\n                    if (codec.parameters) {\r\n                        const paramFmtp = {\r\n                            config: '',\r\n                            payload: codec.preferredPayloadType\r\n                        };\r\n\r\n                        for (const name of Object.keys(codec.parameters)) {\r\n                            /* eslint-disable max-depth */\r\n                            if (paramFmtp.config) {\r\n                                paramFmtp.config += ';';\r\n                            }\r\n                            /* eslint-enable max-depth */\r\n\r\n                            paramFmtp.config\r\n                                += `${name}=${codec.parameters[name]}`;\r\n                        }\r\n\r\n                        if (paramFmtp.config) {\r\n                            mediaObject.fmtp.push(paramFmtp);\r\n                        }\r\n                    }\r\n\r\n                    // Set RTCP feedback.\r\n                    for (const fb of codec.rtcpFeedback || []) {\r\n                        mediaObject.rtcpFb.push({\r\n                            payload: codec.preferredPayloadType,\r\n                            subtype: fb.parameter || undefined,\r\n                            type: fb.type\r\n                        });\r\n                    }\r\n                }\r\n\r\n                // If there are no codecs, set this m section as unavailable.\r\n                if (payloads.length === 0) {\r\n                    mediaObject.payloads = '9'; // Just put something.\r\n                    mediaObject.port = 0;\r\n                    mediaObject.direction = 'inactive';\r\n                } else {\r\n                    mediaObject.payloads = payloads.join(' ');\r\n                }\r\n\r\n                // SSRCs.\r\n                mediaObject.ssrcs = [];\r\n                mediaObject.ssrcGroups = [];\r\n\r\n                // Add RTP sending stuff.\r\n                for (const info of localTrackInfos.values()) {\r\n                    const rtpSender = info.rtpSender;\r\n                    const streamId = info.stream.id;\r\n                    const track = rtpSender.track;\r\n\r\n                    // Ignore if ended.\r\n                    if (track.readyState === 'ended') {\r\n                        continue; // eslint-disable-line no-continue\r\n                    }\r\n\r\n                    if (track.kind !== kind) {\r\n                        continue; // eslint-disable-line no-continue\r\n                    }\r\n\r\n                    // Set a random provisional SSRC if not set.\r\n                    if (!info.ssrc) {\r\n                        info.ssrc = SDPUtil.generateSsrc();\r\n                    }\r\n\r\n                    // Whether RTX should be enabled.\r\n                    const enableRtx = hasVideoRtx && track.kind === 'video';\r\n\r\n                    // Set a random provisional RTX SSRC if not set.\r\n                    if (enableRtx && !info.rtxSsrc) {\r\n                        info.rtxSsrc = info.ssrc + 1;\r\n                    }\r\n\r\n                    mediaObject.ssrcs.push({\r\n                        attribute: 'cname',\r\n                        id: info.ssrc,\r\n                        value: CNAME\r\n                    });\r\n\r\n                    mediaObject.ssrcs.push({\r\n                        attribute: 'msid',\r\n                        id: info.ssrc,\r\n                        value: `${streamId} ${track.id}`\r\n                    });\r\n\r\n                    mediaObject.ssrcs.push({\r\n                        attribute: 'mslabel',\r\n                        id: info.ssrc,\r\n                        value: streamId\r\n                    });\r\n\r\n                    mediaObject.ssrcs.push({\r\n                        attribute: 'label',\r\n                        id: info.ssrc,\r\n                        value: track.id\r\n                    });\r\n\r\n                    if (enableRtx) {\r\n                        mediaObject.ssrcs.push({\r\n                            attribute: 'cname',\r\n                            id: info.rtxSsrc,\r\n                            value: CNAME\r\n                        });\r\n\r\n                        mediaObject.ssrcs.push({\r\n                            attribute: 'msid',\r\n                            id: info.rtxSsrc,\r\n                            value: `${streamId} ${track.id}`\r\n                        });\r\n\r\n                        mediaObject.ssrcs.push({\r\n                            attribute: 'mslabel',\r\n                            id: info.rtxSsrc,\r\n                            value: streamId\r\n                        });\r\n\r\n                        mediaObject.ssrcs.push({\r\n                            attribute: 'label',\r\n                            id: info.rtxSsrc,\r\n                            value: track.id\r\n                        });\r\n\r\n                        mediaObject.ssrcGroups.push({\r\n                            semantics: 'FID',\r\n                            ssrcs: `${info.ssrc} ${info.rtxSsrc}`\r\n                        });\r\n                    }\r\n                }\r\n\r\n                // RTP header extensions.\r\n                mediaObject.ext = [];\r\n\r\n                for (const extension of localCapabilities.headerExtensions) {\r\n                    if (extension.kind && extension.kind !== kind) {\r\n                        continue; // eslint-disable-line no-continue\r\n                    }\r\n\r\n                    mediaObject.ext.push({\r\n                        value: extension.preferredId,\r\n                        uri: extension.uri\r\n                    });\r\n                }\r\n\r\n                // a=rtcp-mux attribute.\r\n                mediaObject.rtcpMux = 'rtcp-mux';\r\n\r\n                // a=rtcp-rsize.\r\n                mediaObject.rtcpRsize = 'rtcp-rsize';\r\n            }\r\n\r\n            // Add the media section.\r\n            sdpObject.media.push(mediaObject);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Promise based implementation for createOffer().\r\n     * @returns {Promise}\r\n     * @private\r\n     */\r\n    _createOffer(options) { // eslint-disable-line no-unused-vars\r\n        if (this._closed) {\r\n            return Promise.reject(\r\n                new InvalidStateError('RTCPeerConnection closed'));\r\n        }\r\n\r\n        if (this.signalingState !== RTCSignalingState.stable) {\r\n            return Promise.reject(new InvalidStateError(\r\n                `invalid signalingState \"${this.signalingState}\"`));\r\n        }\r\n\r\n        // NOTE: P2P mode not yet supported, so createOffer() should never be\r\n        // called.\r\n        return Promise.reject(new Error('createoOffer() not yet supported'));\r\n    }\r\n\r\n    /**\r\n     * Emit 'addstream' event.\r\n     * @private\r\n     */\r\n    _emitAddStream(stream) {\r\n        if (this._closed) {\r\n            return;\r\n        }\r\n\r\n        logger.debug('emitting \"addstream\"');\r\n\r\n        const event = new yaeti.Event('addstream');\r\n\r\n        event.stream = stream;\r\n        this.dispatchEvent(event);\r\n    }\r\n\r\n    /**\r\n     * May emit buffered ICE candidates.\r\n     * @private\r\n     */\r\n    _emitBufferedIceCandidates() {\r\n        if (this._closed) {\r\n            return;\r\n        }\r\n\r\n        for (const sdpCandidate of this._bufferedIceCandidates) {\r\n            if (!sdpCandidate) {\r\n                continue; // eslint-disable-line no-continue\r\n            }\r\n\r\n            // Now we have set the MID values of the SDP O/A, so let's fill the\r\n            // sdpMIndex of the candidate.\r\n            sdpCandidate.sdpMIndex = this._mids.keys().next().value;\r\n\r\n            logger.debug(\r\n                'emitting buffered \"icecandidate\", candidate:', sdpCandidate);\r\n\r\n            const event = new yaeti.Event('icecandidate');\r\n\r\n            event.candidate = sdpCandidate;\r\n            this.dispatchEvent(event);\r\n        }\r\n\r\n        this._bufferedIceCandidates = [];\r\n    }\r\n\r\n    /**\r\n     * May emit 'connectionstatechange' event.\r\n     * @private\r\n     */\r\n    _emitConnectionStateChange() {\r\n        if (this._closed && this.connectionState !== 'closed') {\r\n            return;\r\n        }\r\n\r\n        logger.debug(\r\n            'emitting \"connectionstatechange\", connectionState:',\r\n            this.connectionState);\r\n\r\n        const event = new yaeti.Event('connectionstatechange');\r\n\r\n        this.dispatchEvent(event);\r\n    }\r\n\r\n    /**\r\n     * May emit 'icecandidate' event.\r\n     * @private\r\n     */\r\n    _emitIceCandidate(candidate) {\r\n        if (this._closed) {\r\n            return;\r\n        }\r\n\r\n        let sdpCandidate = null;\r\n\r\n        if (candidate) {\r\n            // NOTE: We assume BUNDLE so let's just emit candidates for the\r\n            // first m= section.\r\n            const sdpMIndex = this._mids.keys().next().value;\r\n            const sdpMLineIndex = 0;\r\n            let sdpAttribute\r\n                = `candidate:${candidate.foundation} 1 ${candidate.protocol}`\r\n                + ` ${candidate.priority} ${candidate.ip} ${candidate.port}`\r\n                + ` typ ${candidate.type}`;\r\n\r\n            if (candidate.relatedAddress) {\r\n                sdpAttribute += ` raddr ${candidate.relatedAddress}`;\r\n            }\r\n            if (candidate.relatedPort) {\r\n                sdpAttribute += ` rport ${candidate.relatedPort}`;\r\n            }\r\n            if (candidate.protocol === 'tcp') {\r\n                sdpAttribute += ` tcptype ${candidate.tcpType}`;\r\n            }\r\n\r\n            sdpCandidate = {\r\n                candidate: sdpAttribute,\r\n                component: 1, // rtcp-mux assumed, so always 1 (RTP).\r\n                foundation: candidate.foundation,\r\n                ip: candidate.ip,\r\n                port: candidate.port,\r\n                priority: candidate.priority,\r\n                protocol: candidate.protocol,\r\n                type: candidate.type,\r\n                sdpMIndex,\r\n                sdpMLineIndex\r\n            };\r\n\r\n            if (candidate.protocol === 'tcp') {\r\n                sdpCandidate.tcptype = candidate.tcpType;\r\n            }\r\n            if (candidate.relatedAddress) {\r\n                sdpCandidate.relatedAddress = candidate.relatedAddress;\r\n            }\r\n            if (candidate.relatedPort) {\r\n                sdpCandidate.relatedPort = candidate.relatedPort;\r\n            }\r\n        }\r\n\r\n        // If we don't have yet a local description, buffer the candidate.\r\n        if (this._localDescription) {\r\n            logger.debug(\r\n                'emitting \"icecandidate\", candidate:', sdpCandidate);\r\n\r\n            const event = new yaeti.Event('icecandidate');\r\n\r\n            event.candidate = sdpCandidate;\r\n            this.dispatchEvent(event);\r\n        } else {\r\n            logger.debug(\r\n                'buffering gathered ICE candidate:', sdpCandidate);\r\n\r\n            this._bufferedIceCandidates.push(sdpCandidate);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * May emit 'iceconnectionstatechange' event.\r\n     * @private\r\n     */\r\n    _emitIceConnectionStateChange() {\r\n        if (this._closed && this.iceConnectionState !== 'closed') {\r\n            return;\r\n        }\r\n\r\n        logger.debug(\r\n            'emitting \"iceconnectionstatechange\", iceConnectionState:',\r\n            this.iceConnectionState);\r\n\r\n        const event = new yaeti.Event('iceconnectionstatechange');\r\n\r\n        this.dispatchEvent(event);\r\n    }\r\n\r\n    /**\r\n     * May emit 'negotiationneeded' event.\r\n     * @private\r\n     */\r\n    _emitNegotiationNeeded() {\r\n        // Ignore if signalingState is not 'stable'.\r\n        if (this.signalingState !== RTCSignalingState.stable) {\r\n            return;\r\n        }\r\n\r\n        logger.debug('emitting \"negotiationneeded\"');\r\n\r\n        const event = new yaeti.Event('negotiationneeded');\r\n\r\n        this.dispatchEvent(event);\r\n    }\r\n\r\n    /**\r\n     * Emit 'removestream' event.\r\n     * @private\r\n     */\r\n    _emitRemoveStream(stream) {\r\n        if (this._closed) {\r\n            return;\r\n        }\r\n\r\n        logger.debug('emitting \"removestream\"');\r\n\r\n        const event = new yaeti.Event('removestream');\r\n\r\n        event.stream = stream;\r\n        this.dispatchEvent(event);\r\n    }\r\n\r\n    /**\r\n     * Get RTP parameters for a RTCRtpReceiver.\r\n     * @private\r\n     * @return {RTCRtpParameters}\r\n     */\r\n    _getParametersForRtpReceiver(kind, data) {\r\n        const ssrc = data.ssrc;\r\n        const rtxSsrc = data.rtxSsrc;\r\n        const cname = data.cname;\r\n        const localCapabilities = this._localCapabilities;\r\n        const parameters = {\r\n            codecs: [],\r\n            degradationPreference: 'balanced',\r\n            encodings: [],\r\n            headerExtensions: [],\r\n            muxId: '',\r\n            rtcp: {\r\n                cname,\r\n                compound: true, // NOTE: Implemented in Edge.\r\n                mux: true,\r\n                reducedSize: true // NOTE: Not yet implemented in Edge.\r\n            }\r\n        };\r\n\r\n        const codecs = [];\r\n        let codecPayloadType;\r\n\r\n        for (const codecCapability of localCapabilities.codecs) {\r\n            if (codecCapability.kind !== kind\r\n                || codecCapability.name === 'rtx') {\r\n                continue; // eslint-disable-line no-continue\r\n            }\r\n\r\n            codecPayloadType = codecCapability.preferredPayloadType;\r\n            codecs.push({\r\n                clockRate: codecCapability.clockRate,\r\n                maxptime: codecCapability.maxptime,\r\n                mimeType: codecCapability.mimeType,\r\n                name: codecCapability.name,\r\n                numChannels: codecCapability.numChannels,\r\n                parameters: codecCapability.parameters,\r\n                payloadType: codecCapability.preferredPayloadType,\r\n                ptime: codecCapability.ptime,\r\n                rtcpFeedback: codecCapability.rtcpFeedback\r\n            });\r\n\r\n            break;\r\n        }\r\n\r\n        if (rtxSsrc) {\r\n            for (const codecCapability of localCapabilities.codecs) {\r\n                if (codecCapability.kind !== kind\r\n                    || codecCapability.name !== 'rtx') {\r\n                    continue; // eslint-disable-line no-continue\r\n                }\r\n\r\n                codecs.push({\r\n                    clockRate: codecCapability.clockRate,\r\n                    mimeType: codecCapability.mimeType,\r\n                    name: 'rtx',\r\n                    parameters: codecCapability.parameters,\r\n                    payloadType: codecCapability.preferredPayloadType,\r\n                    rtcpFeedback: codecCapability.rtcpFeedback\r\n                });\r\n\r\n                break;\r\n            }\r\n        }\r\n\r\n        parameters.codecs = codecs;\r\n\r\n        const encoding = {\r\n            active: true,\r\n            codecPayloadType,\r\n            ssrc\r\n        };\r\n\r\n        if (rtxSsrc) {\r\n            encoding.rtx = {\r\n                ssrc: rtxSsrc\r\n            };\r\n        }\r\n\r\n        parameters.encodings.push(encoding);\r\n\r\n        for (const extension of localCapabilities.headerExtensions) {\r\n            if (extension.kind !== kind) {\r\n                continue; // eslint-disable-line no-continue\r\n            }\r\n\r\n            parameters.headerExtensions.push({\r\n                encrypt: extension.preferredEncrypt,\r\n                id: extension.preferredId,\r\n                uri: extension.uri\r\n            });\r\n        }\r\n\r\n        return parameters;\r\n    }\r\n\r\n    /**\r\n     * Get RTP parameters for a RTCRtpSender.\r\n     * @private\r\n     * @return {RTCRtpParameters}\r\n     */\r\n    _getParametersForRtpSender(kind, data) {\r\n        const ssrc = data.ssrc;\r\n        const rtxSsrc = data.rtxSsrc;\r\n        const cname = CNAME;\r\n        const localCapabilities = this._localCapabilities;\r\n        const parameters = {\r\n            codecs: [],\r\n            degradationPreference: 'balanced',\r\n            encodings: [],\r\n            headerExtensions: [],\r\n            muxId: '',\r\n            rtcp: {\r\n                cname,\r\n                compound: true, // NOTE: Implemented in Edge.\r\n                mux: true,\r\n                reducedSize: true // NOTE: Not yet implemented in Edge.\r\n            }\r\n        };\r\n\r\n        const codecs = [];\r\n        let codecPayloadType;\r\n\r\n        for (const codecCapability of localCapabilities.codecs) {\r\n            if (codecCapability.kind !== kind\r\n                || codecCapability.name === 'rtx') {\r\n                continue; // eslint-disable-line no-continue\r\n            }\r\n\r\n            codecPayloadType = codecCapability.preferredPayloadType;\r\n            codecs.push({\r\n                clockRate: codecCapability.clockRate,\r\n                maxptime: codecCapability.maxptime,\r\n                mimeType: codecCapability.mimeType,\r\n                name: codecCapability.name,\r\n                numChannels: codecCapability.numChannels,\r\n                parameters: codecCapability.parameters,\r\n                payloadType: codecCapability.preferredPayloadType,\r\n                ptime: codecCapability.ptime,\r\n                rtcpFeedback: codecCapability.rtcpFeedback\r\n            });\r\n\r\n            break;\r\n        }\r\n\r\n        if (rtxSsrc) {\r\n            for (const codecCapability of localCapabilities.codecs) {\r\n                if (codecCapability.kind !== kind\r\n                    || codecCapability.name !== 'rtx') {\r\n                    continue; // eslint-disable-line no-continue\r\n                }\r\n\r\n                codecs.push({\r\n                    clockRate: codecCapability.clockRate,\r\n                    mimeType: codecCapability.mimeType,\r\n                    name: 'rtx',\r\n                    parameters: codecCapability.parameters,\r\n                    payloadType: codecCapability.preferredPayloadType,\r\n                    rtcpFeedback: codecCapability.rtcpFeedback\r\n                });\r\n\r\n                break;\r\n            }\r\n        }\r\n\r\n        parameters.codecs = codecs;\r\n\r\n        const encoding = {\r\n            active: true,\r\n            codecPayloadType,\r\n            ssrc\r\n        };\r\n\r\n        if (rtxSsrc) {\r\n            encoding.rtx = {\r\n                ssrc: rtxSsrc\r\n            };\r\n        }\r\n\r\n        parameters.encodings.push(encoding);\r\n\r\n        for (const extension of localCapabilities.headerExtensions) {\r\n            if (extension.kind !== kind) {\r\n                continue; // eslint-disable-line no-continue\r\n            }\r\n\r\n            parameters.headerExtensions.push({\r\n                encrypt: extension.preferredEncrypt,\r\n                id: extension.preferredId,\r\n                uri: extension.uri\r\n            });\r\n        }\r\n\r\n        return parameters;\r\n    }\r\n\r\n    /**\r\n     * Promise based implementation for getStats().\r\n     * @return {Promise} RTCStats dictionary.\r\n     * @private\r\n     */\r\n    _getStats(selector) { // eslint-disable-line no-unused-vars\r\n        if (this._closed) {\r\n            return Promise.reject(\r\n                new InvalidStateError('RTCPeerConnection closed'));\r\n        }\r\n\r\n        const iceGatherer = this._iceGatherer;\r\n        const iceTransport = this._iceTransport;\r\n        const rtpSenders = [];\r\n        const rtpReceivers = [];\r\n        const promises = [];\r\n\r\n        // Get RtpSenders.\r\n        for (const info of this._localTrackInfos.values()) {\r\n            const { rtpSender, sending } = info;\r\n\r\n            if (sending) {\r\n                rtpSenders.push(rtpSender);\r\n            }\r\n        }\r\n\r\n        // Get RtpReceivers.\r\n        for (const info of this._remoteTrackInfos.values()) {\r\n            const { rtpReceiver } = info;\r\n\r\n            rtpReceivers.push(rtpReceiver);\r\n        }\r\n\r\n        // Collect all the stats.\r\n\r\n        if (iceGatherer) {\r\n            promises.push(\r\n                iceGatherer.getStats()\r\n                    .catch(() => null));\r\n        }\r\n\r\n        if (iceTransport) {\r\n            promises.push(\r\n                iceTransport.getStats()\r\n                    .catch(() => null));\r\n\r\n            // NOTE: Proprietary stuff in Edge.\r\n            if (typeof iceTransport.msGetStats === 'function') {\r\n                promises.push(\r\n                    iceTransport.msGetStats()\r\n                        .catch(() => null));\r\n            }\r\n        }\r\n\r\n        for (const rtpSender of rtpSenders) {\r\n            const isAudio = rtpSender.track.kind === 'audio';\r\n\r\n            promises.push(rtpSender.getStats()\r\n                .then(data => {\r\n                    // Remove audioLevel from type=\"track\" stats if this is\r\n                    // not an audio sender.\r\n                    if (!isAudio) {\r\n                        for (const key of Object.keys(data)) {\r\n                            const stat = data[key];\r\n\r\n                            if (stat.type === 'track') {\r\n                                delete stat.audioLevel;\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    return data;\r\n                })\r\n                .catch(() => null));\r\n        }\r\n\r\n        for (const rtpReceiver of rtpReceivers) {\r\n            const isAudio = rtpReceiver.track.kind === 'audio';\r\n\r\n            promises.push(rtpReceiver.getStats()\r\n                .then(data => {\r\n                    // Remove audioLevel from type=\"track\" stats if this is\r\n                    // not an audio receiver.\r\n                    if (!isAudio) {\r\n                        for (const key of Object.keys(data)) {\r\n                            const stat = data[key];\r\n\r\n                            if (stat.type === 'track') {\r\n                                delete stat.audioLevel;\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    return data;\r\n                })\r\n                .catch(() => null));\r\n        }\r\n\r\n        return Promise.all(promises)\r\n            .then(datas => {\r\n                const stats = {};\r\n\r\n                for (const data of datas) {\r\n                    if (!data) {\r\n                        continue; // eslint-disable-line no-continue\r\n                    }\r\n\r\n                    for (const key of Object.keys(data)) {\r\n                        stats[key] = data[key];\r\n                    }\r\n                }\r\n\r\n                return stats;\r\n            });\r\n    }\r\n\r\n    /**\r\n     * Handles the local initial answer.\r\n     * @return {Promise}\r\n     * @private\r\n     */\r\n    _handleLocalInitialAnswer(desc) {\r\n        logger.debug('_handleLocalInitialAnswer(), desc:', desc);\r\n\r\n        const sdpObject = desc.sdpObject;\r\n\r\n        // Update local capabilities as decided by the app.\r\n        this._localCapabilities = utils.extractCapabilities(sdpObject);\r\n\r\n        logger.debug('local capabilities:', this._localCapabilities);\r\n\r\n        // NOTE: We assume that the answer given by the app does not change\r\n        // SSRC or PT values. If so, things won't work as expected.\r\n    }\r\n\r\n    /**\r\n     * Handles a local re-answer.\r\n     * @return {Promise}\r\n     * @private\r\n     */\r\n    _handleLocalReAnswer(desc) {\r\n        logger.debug('_handleLocalReAnswer(), desc:', desc);\r\n\r\n        const sdpObject = desc.sdpObject;\r\n\r\n        // Update local capabilities as decided by the app.\r\n        this._localCapabilities = utils.extractCapabilities(sdpObject);\r\n\r\n        logger.debug('local capabilities:', this._localCapabilities);\r\n\r\n        // NOTE: We assume that the answer given by the app does not change\r\n        // SSRC or PT values. If so, things won't work as expected.\r\n    }\r\n\r\n    /**\r\n     * Handles the remote initial offer.\r\n     * @return {Promise}\r\n     * @private\r\n     */\r\n    _handleRemoteInitialOffer(desc) {\r\n        logger.debug('_handleRemoteInitialOffer(), desc:', desc);\r\n\r\n        const sdpObject = desc.sdpObject;\r\n\r\n        // Set MID values.\r\n        this._mids = utils.extractMids(sdpObject);\r\n\r\n        // Get remote RTP capabilities.\r\n        const remoteCapabilities = utils.extractCapabilities(sdpObject);\r\n\r\n        logger.debug('remote capabilities:', remoteCapabilities);\r\n\r\n        // Get local RTP capabilities (filter them with remote capabilities).\r\n        this._localCapabilities\r\n            = utils.getLocalCapabilities(remoteCapabilities);\r\n\r\n        // Start ICE and DTLS.\r\n        this._startIceAndDtls(desc);\r\n    }\r\n\r\n    /**\r\n     * Handles a remote re-offer.\r\n     * @return {Promise}\r\n     * @private\r\n     */\r\n    _handleRemoteReOffer(desc) {\r\n        logger.debug('_handleRemoteReOffer(), desc:', desc);\r\n\r\n        const sdpObject = desc.sdpObject;\r\n\r\n        // Update MID values (just in case).\r\n        this._mids = utils.extractMids(sdpObject);\r\n\r\n        // Get remote RTP capabilities (filter them with remote capabilities).\r\n        const remoteCapabilities = utils.extractCapabilities(sdpObject);\r\n\r\n        logger.debug('remote capabilities:', remoteCapabilities);\r\n\r\n        // Update local RTP capabilities (just in case).\r\n        this._localCapabilities\r\n            = utils.getLocalCapabilities(remoteCapabilities);\r\n    }\r\n\r\n    /**\r\n     * Start receiving remote media.\r\n     */\r\n    _receiveMedia() {\r\n        logger.debug('_receiveMedia()');\r\n\r\n        const currentRemoteSsrcs = new Set(this._remoteTrackInfos.keys());\r\n        const newRemoteTrackInfos\r\n            = utils.extractTrackInfos(this._remoteDescription.sdpObject);\r\n\r\n        // Map of new remote MediaStream indexed by MediaStream.jitsiRemoteId.\r\n        const addedRemoteStreams = new Map();\r\n\r\n        // Map of remote MediaStream indexed by added MediaStreamTrack.\r\n        // NOTE: Just filled for already existing streams.\r\n        const addedRemoteTracks = new Map();\r\n\r\n        // Map of remote MediaStream indexed by removed MediaStreamTrack.\r\n        const removedRemoteTracks = new Map();\r\n\r\n        logger.debug(\r\n            '_receiveMedia() remote track infos:', newRemoteTrackInfos);\r\n\r\n        // Check new tracks.\r\n        for (const [ ssrc, info ] of newRemoteTrackInfos) {\r\n            // If already handled, ignore it.\r\n            if (currentRemoteSsrcs.has(ssrc)) {\r\n                continue; // eslint-disable-line no-continue\r\n            }\r\n\r\n            logger.debug(`_receiveMedia() new remote track, ssrc:${ssrc}`);\r\n\r\n            // Otherwise append to the map.\r\n            this._remoteTrackInfos.set(ssrc, info);\r\n\r\n            const kind = info.kind;\r\n            const rtxSsrc = info.rtxSsrc;\r\n            const streamRemoteId = info.streamId;\r\n            const trackRemoteId = info.trackId;\r\n            const cname = info.cname;\r\n            const isNewStream = !this._remoteStreams.has(streamRemoteId);\r\n            let stream;\r\n\r\n            if (isNewStream) {\r\n                logger.debug(\r\n                    `_receiveMedia() new remote stream, id:${streamRemoteId}`);\r\n\r\n                // Create a new MediaStream.\r\n                stream = new MediaStream();\r\n\r\n                // Set custom property with the remote id.\r\n                stream.jitsiRemoteId = streamRemoteId;\r\n\r\n                addedRemoteStreams.set(streamRemoteId, stream);\r\n                this._remoteStreams.set(streamRemoteId, stream);\r\n            } else {\r\n                stream = this._remoteStreams.get(streamRemoteId);\r\n            }\r\n\r\n            const rtpReceiver = new RTCRtpReceiver(this._dtlsTransport, kind);\r\n            const parameters = this._getParametersForRtpReceiver(kind, {\r\n                ssrc,\r\n                rtxSsrc,\r\n                cname\r\n            });\r\n\r\n            // Store the track into the info object.\r\n            // NOTE: This should not be needed, but Edge has a bug:\r\n            //   https://developer.microsoft.com/en-us/microsoft-edge/platform/\r\n            //   issues/12399497/\r\n            info.track = rtpReceiver.track;\r\n\r\n            // Set error handler.\r\n            rtpReceiver.onerror = ev => {\r\n                logger.error('rtpReceiver \"error\" event, event:');\r\n                logger.error(ev);\r\n            };\r\n\r\n            // Fill the info with the stream and rtpReceiver.\r\n            info.stream = stream;\r\n            info.rtpReceiver = rtpReceiver;\r\n\r\n            logger.debug(\r\n                'calling rtpReceiver.receive(), parameters:', parameters);\r\n\r\n            // Start receiving media.\r\n            try {\r\n                rtpReceiver.receive(parameters);\r\n\r\n                // Get the associated MediaStreamTrack.\r\n                const track = info.track;\r\n\r\n                // Set custom property with the remote id.\r\n                track.jitsiRemoteId = trackRemoteId;\r\n\r\n                // Add the track to the stream.\r\n                stream.addTrack(track);\r\n\r\n                if (!addedRemoteStreams.has(streamRemoteId)) {\r\n                    addedRemoteTracks.set(track, stream);\r\n                }\r\n            } catch (error) {\r\n                logger.error(`rtpReceiver.receive() failed:${error.message}`);\r\n                logger.error(error);\r\n            }\r\n        }\r\n\r\n        // Check track removal.\r\n        for (const ssrc of currentRemoteSsrcs) {\r\n            if (newRemoteTrackInfos.has(ssrc)) {\r\n                continue; // eslint-disable-line no-continue\r\n            }\r\n\r\n            logger.debug(`_receiveMedia() remote track removed, ssrc:${ssrc}`);\r\n\r\n            const info = this._remoteTrackInfos.get(ssrc);\r\n            const stream = info.stream;\r\n            const track = info.track;\r\n            const rtpReceiver = info.rtpReceiver;\r\n\r\n            try {\r\n                rtpReceiver.stop();\r\n            } catch (error) {\r\n                logger.warn(`rtpReceiver.stop() failed:${error}`);\r\n            }\r\n\r\n            removedRemoteTracks.set(track, stream);\r\n            stream.removeTrack(track);\r\n            this._remoteTrackInfos.delete(ssrc);\r\n        }\r\n\r\n        // Emit MediaStream 'addtrack' for new tracks in already existing\r\n        // streams.\r\n        for (const [ track, stream ] of addedRemoteTracks) {\r\n            const event = new Event('addtrack');\r\n\r\n            event.track = track;\r\n            stream.dispatchEvent(event);\r\n        }\r\n\r\n        // Emit MediaStream 'removetrack' for removed tracks.\r\n        for (const [ track, stream ] of removedRemoteTracks) {\r\n            const event = new Event('removetrack');\r\n\r\n            event.track = track;\r\n            stream.dispatchEvent(event);\r\n        }\r\n\r\n        // Emit RTCPeerConnection 'addstream' for new remote streams.\r\n        for (const stream of addedRemoteStreams.values()) {\r\n            // Check whether at least a track was added, otherwise ignore it.\r\n            if (stream.getTracks().length === 0) {\r\n                logger.warn(\r\n                    'ignoring new stream for which no track could be added');\r\n\r\n                addedRemoteStreams.delete(stream.jitsiRemoteId);\r\n                this._remoteStreams.delete(stream.jitsiRemoteId);\r\n            } else {\r\n                this._emitAddStream(stream);\r\n            }\r\n        }\r\n\r\n        // Emit RTCPeerConnection 'removestream' for removed remote streams.\r\n        for (const [ streamRemoteId, stream ] of this._remoteStreams) {\r\n            if (stream.getTracks().length > 0) {\r\n                continue; // eslint-disable-line no-continue\r\n            }\r\n\r\n            this._remoteStreams.delete(streamRemoteId);\r\n            this._emitRemoveStream(stream);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Implementation for removeStream().\r\n     * @private\r\n     */\r\n    _removeStream(stream) {\r\n        if (this._closed) {\r\n            throw new InvalidStateError('RTCPeerConnection closed');\r\n        }\r\n\r\n        // Stop and remove the RTCRtpSender associated to each track.\r\n        for (const track of stream.getTracks()) {\r\n            // Ignore if track not present.\r\n            if (!this._localTrackInfos.has(track.id)) {\r\n                continue; // eslint-disable-line no-continue\r\n            }\r\n\r\n            const rtpSender = this._localTrackInfos.get(track.id).rtpSender;\r\n\r\n            try {\r\n                rtpSender.stop();\r\n            } catch (error) {\r\n                logger.warn(`rtpSender.stop() failed:${error}`);\r\n            }\r\n\r\n            // Remove from the map.\r\n            this._localTrackInfos.delete(track.id);\r\n        }\r\n\r\n        // It may need to renegotiate.\r\n        this._emitNegotiationNeeded();\r\n    }\r\n\r\n    /**\r\n     * Start sending our media to the remote.\r\n     */\r\n    _sendMedia() {\r\n        logger.debug('_sendMedia()');\r\n\r\n        for (const info of this._localTrackInfos.values()) {\r\n            // Ignore if already sending.\r\n            if (info.sending) {\r\n                continue; // eslint-disable-line no-continue\r\n            }\r\n\r\n            const rtpSender = info.rtpSender;\r\n            const ssrc = info.ssrc;\r\n            const rtxSsrc = info.rtxSsrc;\r\n            const track = rtpSender.track;\r\n            const kind = track.kind;\r\n\r\n            const parameters = this._getParametersForRtpSender(kind, {\r\n                ssrc,\r\n                rtxSsrc\r\n            });\r\n\r\n            logger.debug(\r\n                'calling rtpSender.send(), parameters:', parameters);\r\n\r\n            // Start sending media.\r\n            try {\r\n                rtpSender.send(parameters);\r\n\r\n                // Update sending field.\r\n                info.sending = true;\r\n            } catch (error) {\r\n                logger.error(`rtpSender.send() failed:${error.message}`);\r\n                logger.error(error);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Creates the RTCDtlsTransport.\r\n     * @private\r\n     */\r\n    _setDtlsTransport(iceTransport) {\r\n        const dtlsTransport = new RTCDtlsTransport(iceTransport);\r\n\r\n        // NOTE: Not yet implemented by Edge.\r\n        dtlsTransport.onstatechange = () => {\r\n            logger.debug(\r\n                'dtlsTransport \"statechange\" event, '\r\n                + `state:${dtlsTransport.state}`);\r\n\r\n            this._emitConnectionStateChange();\r\n        };\r\n\r\n        // NOTE: Not standard, but implemented by Edge.\r\n        dtlsTransport.ondtlsstatechange = () => {\r\n            logger.debug(\r\n                'dtlsTransport \"dtlsstatechange\" event, '\r\n                + `state:${dtlsTransport.state}`);\r\n\r\n            this._emitConnectionStateChange();\r\n        };\r\n\r\n        dtlsTransport.onerror = ev => {\r\n            let message;\r\n\r\n            if (ev.message) {\r\n                message = ev.message;\r\n            } else if (ev.error) {\r\n                message = ev.error.message;\r\n            }\r\n\r\n            logger.error(`dtlsTransport \"error\" event, message:${message}`);\r\n\r\n            // TODO: Edge does not set state to 'failed' on error. We may\r\n            // hack it.\r\n\r\n            this._emitConnectionStateChange();\r\n        };\r\n\r\n        this._dtlsTransport = dtlsTransport;\r\n    }\r\n\r\n    /**\r\n     * Creates the RTCIceGatherer.\r\n     * @private\r\n     */\r\n    _setIceGatherer(pcConfig) {\r\n        const iceGatherOptions = {\r\n            gatherPolicy: pcConfig.iceTransportPolicy || 'all',\r\n            iceServers: pcConfig.iceServers || []\r\n        };\r\n        const iceGatherer = new RTCIceGatherer(iceGatherOptions);\r\n\r\n        // NOTE: Not yet implemented by Edge.\r\n        iceGatherer.onstatechange = () => {\r\n            logger.debug(\r\n                `iceGatherer \"statechange\" event, state:${iceGatherer.state}`);\r\n\r\n            this._updateAndEmitIceGatheringStateChange(iceGatherer.state);\r\n        };\r\n\r\n        iceGatherer.onlocalcandidate = ev => {\r\n            let candidate = ev.candidate;\r\n\r\n            // NOTE: Not yet implemented by Edge.\r\n            const complete = ev.complete;\r\n\r\n            logger.debug(\r\n                'iceGatherer \"localcandidate\" event, candidate:', candidate);\r\n\r\n            // NOTE: Instead of null candidate or complete:true, current Edge\r\n            // signals end of gathering with an empty candidate object.\r\n            if (complete\r\n                || !candidate\r\n                || Object.keys(candidate).length === 0) {\r\n\r\n                candidate = null;\r\n\r\n                this._updateAndEmitIceGatheringStateChange(\r\n                    RTCIceGatheringState.complete);\r\n                this._emitIceCandidate(null);\r\n            } else {\r\n                this._emitIceCandidate(candidate);\r\n            }\r\n        };\r\n\r\n        iceGatherer.onerror = ev => {\r\n            const errorCode = ev.errorCode;\r\n            const errorText = ev.errorText;\r\n\r\n            logger.error(\r\n                `iceGatherer \"error\" event, errorCode:${errorCode}, `\r\n                + `errorText:${errorText}`);\r\n        };\r\n\r\n        // NOTE: Not yet implemented by Edge, which starts gathering\r\n        // automatically.\r\n        try {\r\n            iceGatherer.gather();\r\n        } catch (error) {\r\n            logger.warn(`iceGatherer.gather() failed:${error}`);\r\n        }\r\n\r\n        this._iceGatherer = iceGatherer;\r\n    }\r\n\r\n    /**\r\n     * Creates the RTCIceTransport.\r\n     * @private\r\n     */\r\n    _setIceTransport(iceGatherer) {\r\n        const iceTransport = new RTCIceTransport(iceGatherer);\r\n\r\n        // NOTE: Not yet implemented by Edge.\r\n        iceTransport.onstatechange = () => {\r\n            logger.debug(\r\n                'iceTransport \"statechange\" event, '\r\n                + `state:${iceTransport.state}`);\r\n\r\n            this._emitIceConnectionStateChange();\r\n        };\r\n\r\n        // NOTE: Not standard, but implemented by Edge.\r\n        iceTransport.onicestatechange = () => {\r\n            logger.debug(\r\n                'iceTransport \"icestatechange\" event, '\r\n                + `state:${iceTransport.state}`);\r\n\r\n            if (iceTransport.state === 'completed') {\r\n                logger.debug(\r\n                    'nominated candidate pair:',\r\n                    iceTransport.getNominatedCandidatePair());\r\n            }\r\n\r\n            this._emitIceConnectionStateChange();\r\n        };\r\n\r\n        iceTransport.oncandidatepairchange = ev => {\r\n            logger.debug(\r\n                'iceTransport \"candidatepairchange\" event, '\r\n                + `pair:${ev.pair}`);\r\n        };\r\n\r\n        this._iceTransport = iceTransport;\r\n    }\r\n\r\n    /**\r\n     * Promise based implementation for setLocalDescription().\r\n     * @returns {Promise}\r\n     * @private\r\n     */\r\n    _setLocalDescription(desc) {\r\n        if (this._closed) {\r\n            return Promise.reject(\r\n                new InvalidStateError('RTCPeerConnection closed'));\r\n        }\r\n\r\n        let localDescription;\r\n\r\n        try {\r\n            localDescription = new RTCSessionDescription(desc);\r\n        } catch (error) {\r\n            return Promise.reject(new TypeError(\r\n                `invalid RTCSessionDescriptionInit: ${error}`));\r\n        }\r\n\r\n        switch (desc.type) {\r\n        case 'offer': {\r\n            if (this.signalingState !== RTCSignalingState.stable) {\r\n                return Promise.reject(new InvalidStateError(\r\n                    `invalid signalingState \"${this.signalingState}\"`));\r\n            }\r\n\r\n            // NOTE: P2P mode not yet supported, so createOffer() should never\r\n            // has been called, neither setLocalDescription() with an offer.\r\n            return Promise.reject(new TypeError(\r\n                'setLocalDescription() with type \"offer\" not supported'));\r\n        }\r\n        case 'answer': {\r\n            if (this.signalingState !== RTCSignalingState.haveRemoteOffer) {\r\n                return Promise.reject(new InvalidStateError(\r\n                    `invalid signalingState \"${this.signalingState}\"`));\r\n            }\r\n\r\n            const isLocalInitialAnswer = Boolean(!this._localDescription);\r\n\r\n            return Promise.resolve()\r\n                .then(() => {\r\n                    // Different handling for initial answer and re-answer.\r\n                    if (isLocalInitialAnswer) {\r\n                        return this._handleLocalInitialAnswer(localDescription);\r\n                    } else { // eslint-disable-line no-else-return\r\n                        return this._handleLocalReAnswer(localDescription);\r\n                    }\r\n                })\r\n                .then(() => {\r\n                    logger.debug('setLocalDescription() succeed');\r\n\r\n                    // Update local description.\r\n                    this._localDescription = localDescription;\r\n\r\n                    // Update signaling state.\r\n                    this._updateAndEmitSignalingStateChange(\r\n                        RTCSignalingState.stable);\r\n\r\n                    // If initial answer, emit buffered ICE candidates.\r\n                    if (isLocalInitialAnswer) {\r\n                        this._emitBufferedIceCandidates();\r\n                    }\r\n\r\n                    // Send our RTP.\r\n                    this._sendMedia();\r\n\r\n                    // Receive remote RTP.\r\n                    this._receiveMedia();\r\n                })\r\n                .catch(error => {\r\n                    logger.error(\r\n                        `setLocalDescription() failed: ${error.message}`);\r\n                    logger.error(error);\r\n\r\n                    throw error;\r\n                });\r\n        }\r\n        default:\r\n            return Promise.reject(new TypeError(\r\n                `unsupported description.type \"${desc.type}\"`));\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Promise based implementation for setRemoteDescription().\r\n     * @returns {Promise}\r\n     * @private\r\n     */\r\n    _setRemoteDescription(desc) {\r\n        if (this._closed) {\r\n            return Promise.reject(\r\n                new InvalidStateError('RTCPeerConnection closed'));\r\n        }\r\n\r\n        let remoteDescription;\r\n\r\n        try {\r\n            remoteDescription = new RTCSessionDescription(desc);\r\n        } catch (error) {\r\n            return Promise.reject(new TypeError(\r\n                `invalid RTCSessionDescriptionInit: ${error}`));\r\n        }\r\n\r\n        switch (desc.type) {\r\n        case 'offer': {\r\n            if (this.signalingState !== RTCSignalingState.stable) {\r\n                return Promise.reject(new InvalidStateError(\r\n                    `invalid signalingState \"${this.signalingState}\"`));\r\n            }\r\n\r\n            const isRemoteInitialOffer = Boolean(!this._remoteDescription);\r\n\r\n            return Promise.resolve()\r\n                .then(() => {\r\n                    // Different handling for initial answer and re-answer.\r\n                    if (isRemoteInitialOffer) {\r\n                        return this._handleRemoteInitialOffer(\r\n                            remoteDescription);\r\n                    } else { // eslint-disable-line no-else-return\r\n                        return this._handleRemoteReOffer(remoteDescription);\r\n                    }\r\n                })\r\n                .then(() => {\r\n                    logger.debug('setRemoteDescription() succeed');\r\n\r\n                    // Update remote description.\r\n                    this._remoteDescription = remoteDescription;\r\n\r\n                    // Update signaling state.\r\n                    this._updateAndEmitSignalingStateChange(\r\n                        RTCSignalingState.haveRemoteOffer);\r\n                })\r\n                .catch(error => {\r\n                    logger.error(`setRemoteDescription() failed: ${error}`);\r\n\r\n                    throw error;\r\n                });\r\n        }\r\n        case 'answer': {\r\n            if (this.signalingState !== RTCSignalingState.haveLocalOffer) {\r\n                return Promise.reject(new InvalidStateError(\r\n                    `invalid signalingState \"${this.signalingState}\"`));\r\n            }\r\n\r\n            // NOTE: P2P mode not yet supported, so createOffer() should never\r\n            // has been called, neither setRemoteDescription() with an answer.\r\n            return Promise.reject(new TypeError(\r\n                'setRemoteDescription() with type \"answer\" not supported'));\r\n        }\r\n        default:\r\n            return Promise.reject(new TypeError(\r\n                `unsupported description.type \"${desc.type}\"`));\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Start ICE and DTLS connection procedures.\r\n     * @param {RTCSessionDescription} desc - Remote description.\r\n     */\r\n    _startIceAndDtls(desc) {\r\n        const sdpObject = desc.sdpObject;\r\n        const remoteIceParameters\r\n            = utils.extractIceParameters(sdpObject);\r\n        const remoteIceCandidates\r\n            = utils.extractIceCandidates(sdpObject);\r\n        const remoteDtlsParameters\r\n            = utils.extractDtlsParameters(sdpObject);\r\n\r\n        // Start the RTCIceTransport.\r\n        switch (desc.type) {\r\n        case 'offer':\r\n            this._iceTransport.start(\r\n                this._iceGatherer, remoteIceParameters, 'controlled');\r\n            break;\r\n        case 'answer':\r\n            this._iceTransport.start(\r\n                this._iceGatherer, remoteIceParameters, 'controlling');\r\n            break;\r\n        }\r\n\r\n        // Add remote ICE candidates.\r\n        // NOTE: Remove candidates that Edge doesn't like.\r\n        for (const candidate of remoteIceCandidates) {\r\n            if (candidate.port === 0 || candidate.port === 9) {\r\n                continue; // eslint-disable-line no-continue\r\n            }\r\n\r\n            this._iceTransport.addRemoteCandidate(candidate);\r\n        }\r\n\r\n        // Also signal a 'complete' candidate as per spec.\r\n        // NOTE: It should be {complete: true} but Edge prefers {}.\r\n        // NOTE: We know that addCandidate() is never used so we need to signal\r\n        // end of candidates (otherwise the RTCIceTransport never enters the\r\n        // 'completed' state).\r\n        this._iceTransport.addRemoteCandidate({});\r\n\r\n        // Set desired remote DTLS role (as we receive the offer).\r\n        switch (desc.type) {\r\n        case 'offer':\r\n            remoteDtlsParameters.role = 'server';\r\n            break;\r\n        case 'answer':\r\n            remoteDtlsParameters.role = 'client';\r\n            break;\r\n        }\r\n\r\n        // Start RTCDtlsTransport.\r\n        this._dtlsTransport.start(remoteDtlsParameters);\r\n    }\r\n\r\n    /**\r\n     * May update iceGatheringState and emit 'icegatheringstatechange' event.\r\n     * @private\r\n     */\r\n    _updateAndEmitIceGatheringStateChange(state) {\r\n        if (this._closed || state === this.iceGatheringState) {\r\n            return;\r\n        }\r\n\r\n        this._iceGatheringState = state;\r\n\r\n        logger.debug(\r\n            'emitting \"icegatheringstatechange\", iceGatheringState:',\r\n            this.iceGatheringState);\r\n\r\n        const event = new yaeti.Event('icegatheringstatechange');\r\n\r\n        this.dispatchEvent(event);\r\n    }\r\n\r\n    /**\r\n     * May update signalingState and emit 'signalingstatechange' event.\r\n     * @private\r\n     */\r\n    _updateAndEmitSignalingStateChange(state) {\r\n        if (state === this.signalingState) {\r\n            return;\r\n        }\r\n\r\n        this._signalingState = state;\r\n\r\n        logger.debug(\r\n            'emitting \"signalingstatechange\", signalingState:',\r\n            this.signalingState);\r\n\r\n        const event = new yaeti.Event('signalingstatechange');\r\n\r\n        this.dispatchEvent(event);\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/RTC/ortc/RTCPeerConnection.js","module.exports =\n{\n\tEventTarget : require('./lib/EventTarget'),\n\tEvent       : require('./lib/Event')\n};\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/yaeti/index.js","function yaetiEventTarget()\n{\n\tthis._listeners = {};\n}\n\nObject.defineProperties(yaetiEventTarget.prototype,\n\t{\n\t\tlisteners:\n\t\t{\n\t\t\tget: function()\n\t\t\t{\n\t\t\t\treturn this._listeners;\n\t\t\t}\n\t\t}\n\t});\n\nyaetiEventTarget.prototype.addEventListener = function(type, newListener)\n{\n\tvar listenersType;\n\tvar i;\n\tvar listener;\n\n\tif (!type || !newListener)\n\t\treturn;\n\n\tlistenersType = this._listeners[type];\n\n\tif (listenersType === undefined)\n\t\tthis._listeners[type] = listenersType = [];\n\n\tfor (i = 0; !!(listener = listenersType[i]); i++)\n\t{\n\t\tif (listener === newListener)\n\t\t\treturn;\n\t}\n\n\tlistenersType.push(newListener);\n};\n\nyaetiEventTarget.prototype.removeEventListener = function(type, oldListener)\n{\n\tvar listenersType;\n\tvar i;\n\tvar listener;\n\n\tif (!type || !oldListener)\n\t\treturn;\n\n\tlistenersType = this._listeners[type];\n\n\tif (listenersType === undefined)\n\t\treturn;\n\n\tfor (i = 0; !!(listener = listenersType[i]); i++)\n\t{\n\t\tif (listener === oldListener)\n\t\t{\n\t\t\tlistenersType.splice(i, 1);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (listenersType.length === 0)\n\t\tdelete this._listeners[type];\n};\n\nyaetiEventTarget.prototype.dispatchEvent = function(event)\n{\n\tvar type;\n\tvar listenersType;\n\tvar dummyListener;\n\tvar stopImmediatePropagation = false;\n\tvar i;\n\tvar listener;\n\n\tif (!event || typeof event.type !== 'string')\n\t\tthrow new Error('`event` must have a valid `type` property');\n\n\t// Do some stuff to emulate DOM Event behavior (just if this is not a\n\t// DOM Event object).\n\tif (event._yaeti)\n\t{\n\t\tevent.target = this;\n\t\tevent.cancelable = true;\n\t}\n\n\t// Attempt to override the stopImmediatePropagation() method.\n\ttry\n\t{\n\t\tevent.stopImmediatePropagation = function()\n\t\t{\n\t\t\tstopImmediatePropagation = true;\n\t\t};\n\t}\n\tcatch (error)\n\t{}\n\n\ttype = event.type;\n\tlistenersType = (this._listeners[type] || []);\n\n\tdummyListener = this['on' + type];\n\n\tif (typeof dummyListener === 'function')\n\t{\n\t\ttry\n\t\t{\n\t\t\tdummyListener.call(this, event);\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tconsole.error(error);\n\t\t}\n\t}\n\n\tfor (i = 0; !!(listener = listenersType[i]); i++)\n\t{\n\t\tif (stopImmediatePropagation)\n\t\t\tbreak;\n\n\t\ttry\n\t\t{\n\t\t\tlistener.call(this, event);\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tconsole.error(error);\n\t\t}\n\t}\n\n\treturn !event.defaultPrevented;\n};\n\nmodule.exports = yaetiEventTarget;\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/yaeti/lib/EventTarget.js","/**\n * In browsers export the native Event interface.\n */\n\nmodule.exports = global.Event;\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/yaeti/lib/Event.browser.js","import sdpTransform from 'sdp-transform';\r\n\r\n/**\r\n * RTCSessionDescription implementation.\r\n */\r\nexport default class RTCSessionDescription {\r\n    /**\r\n     * RTCSessionDescription constructor.\r\n     * @param {Object} [data]\r\n     * @param {String} [data.type] - 'offer' / 'answer'.\r\n     * @param {String} [data.sdp] - SDP string.\r\n     * @param {Object} [data._sdpObject] - SDP object generated by the\r\n     * sdp-transform library.\r\n     */\r\n    constructor(data) {\r\n        // @type {String}\r\n        this._sdp = null;\r\n\r\n        // @type {Object}\r\n        this._sdpObject = null;\r\n\r\n        // @type {String}\r\n        this._type = null;\r\n\r\n        switch (data.type) {\r\n        case 'offer':\r\n            break;\r\n        case 'answer':\r\n            break;\r\n        default:\r\n            throw new TypeError(`invalid type \"${data.type}\"`);\r\n        }\r\n\r\n        this._type = data.type;\r\n\r\n        if (typeof data.sdp === 'string') {\r\n            this._sdp = data.sdp;\r\n            try {\r\n                this._sdpObject = sdpTransform.parse(data.sdp);\r\n            } catch (error) {\r\n                throw new Error(`invalid sdp: ${error}`);\r\n            }\r\n        } else if (typeof data._sdpObject === 'object') {\r\n            this._sdpObject = data._sdpObject;\r\n            try {\r\n                this._sdp = sdpTransform.write(data._sdpObject);\r\n            } catch (error) {\r\n                throw new Error(`invalid sdp object: ${error}`);\r\n            }\r\n        } else {\r\n            throw new TypeError('invalid sdp or _sdpObject');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get sdp field.\r\n     * @return {String}\r\n     */\r\n    get sdp() {\r\n        return this._sdp;\r\n    }\r\n\r\n    /**\r\n     * Set sdp field.\r\n     * NOTE: This is not allowed per spec, but lib-jitsi-meet uses it.\r\n     * @param {String} sdp\r\n     */\r\n    set sdp(sdp) {\r\n        try {\r\n            this._sdpObject = sdpTransform.parse(sdp);\r\n        } catch (error) {\r\n            throw new Error(`invalid sdp: ${error}`);\r\n        }\r\n\r\n        this._sdp = sdp;\r\n    }\r\n\r\n    /**\r\n     * Gets the internal sdp object.\r\n     * @return {Object}\r\n     * @private\r\n     */\r\n    get sdpObject() {\r\n        return this._sdpObject;\r\n    }\r\n\r\n    /**\r\n     * Get type field.\r\n     * @return {String}\r\n     */\r\n    get type() {\r\n        return this._type;\r\n    }\r\n\r\n    /**\r\n     * Returns an object with type and sdp fields.\r\n     * @return {Object}\r\n     */\r\n    toJSON() {\r\n        return {\r\n            sdp: this._sdp,\r\n            type: this._type\r\n        };\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/RTC/ortc/RTCSessionDescription.js","var toIntIfInt = function (v) {\n  return String(Number(v)) === v ? Number(v) : v;\n};\n\nvar attachProperties = function (match, location, names, rawName) {\n  if (rawName && !names) {\n    location[rawName] = toIntIfInt(match[1]);\n  }\n  else {\n    for (var i = 0; i < names.length; i += 1) {\n      if (match[i+1] != null) {\n        location[names[i]] = toIntIfInt(match[i+1]);\n      }\n    }\n  }\n};\n\nvar parseReg = function (obj, location, content) {\n  var needsBlank = obj.name && obj.names;\n  if (obj.push && !location[obj.push]) {\n    location[obj.push] = [];\n  }\n  else if (needsBlank && !location[obj.name]) {\n    location[obj.name] = {};\n  }\n  var keyLocation = obj.push ?\n    {} :  // blank object that will be pushed\n    needsBlank ? location[obj.name] : location; // otherwise, named location or root\n\n  attachProperties(content.match(obj.reg), keyLocation, obj.names, obj.name);\n\n  if (obj.push) {\n    location[obj.push].push(keyLocation);\n  }\n};\n\nvar grammar = require('./grammar');\nvar validLine = RegExp.prototype.test.bind(/^([a-z])=(.*)/);\n\nexports.parse = function (sdp) {\n  var session = {}\n    , media = []\n    , location = session; // points at where properties go under (one of the above)\n\n  // parse lines we understand\n  sdp.split(/(\\r\\n|\\r|\\n)/).filter(validLine).forEach(function (l) {\n    var type = l[0];\n    var content = l.slice(2);\n    if (type === 'm') {\n      media.push({rtp: [], fmtp: []});\n      location = media[media.length-1]; // point at latest media line\n    }\n\n    for (var j = 0; j < (grammar[type] || []).length; j += 1) {\n      var obj = grammar[type][j];\n      if (obj.reg.test(content)) {\n        return parseReg(obj, location, content);\n      }\n    }\n  });\n\n  session.media = media; // link it up\n  return session;\n};\n\nvar paramReducer = function (acc, expr) {\n  var s = expr.split(/=(.+)/, 2);\n  if (s.length === 2) {\n    acc[s[0]] = toIntIfInt(s[1]);\n  }\n  return acc;\n};\n\nexports.parseParams = function (str) {\n  return str.split(/\\;\\s?/).reduce(paramReducer, {});\n};\n\n// For backward compatibility - alias will be removed in 3.0.0\nexports.parseFmtpConfig = exports.parseParams;\n\nexports.parsePayloads = function (str) {\n  return str.split(' ').map(Number);\n};\n\nexports.parseRemoteCandidates = function (str) {\n  var candidates = [];\n  var parts = str.split(' ').map(toIntIfInt);\n  for (var i = 0; i < parts.length; i += 3) {\n    candidates.push({\n      component: parts[i],\n      ip: parts[i + 1],\n      port: parts[i + 2]\n    });\n  }\n  return candidates;\n};\n\nexports.parseImageAttributes = function (str) {\n  return str.split(' ').map(function (item) {\n    return item.substring(1, item.length-1).split(',').reduce(paramReducer, {});\n  });\n};\n\nexports.parseSimulcastStreamList = function (str) {\n  return str.split(';').map(function (stream) {\n    return stream.split(',').map(function (format) {\n      var scid, paused = false;\n\n      if (format[0] !== '~') {\n        scid = toIntIfInt(format);\n      } else {\n        scid = toIntIfInt(format.substring(1, format.length));\n        paused = true;\n      }\n\n      return {\n        scid: scid,\n        paused: paused\n      };\n    });\n  });\n};\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/sdp-transform/lib/parser.js","var grammar = require('./grammar');\n\n// customized util.format - discards excess arguments and can void middle ones\nvar formatRegExp = /%[sdv%]/g;\nvar format = function (formatStr) {\n  var i = 1;\n  var args = arguments;\n  var len = args.length;\n  return formatStr.replace(formatRegExp, function (x) {\n    if (i >= len) {\n      return x; // missing argument\n    }\n    var arg = args[i];\n    i += 1;\n    switch (x) {\n    case '%%':\n      return '%';\n    case '%s':\n      return String(arg);\n    case '%d':\n      return Number(arg);\n    case '%v':\n      return '';\n    }\n  });\n  // NB: we discard excess arguments - they are typically undefined from makeLine\n};\n\nvar makeLine = function (type, obj, location) {\n  var str = obj.format instanceof Function ?\n    (obj.format(obj.push ? location : location[obj.name])) :\n    obj.format;\n\n  var args = [type + '=' + str];\n  if (obj.names) {\n    for (var i = 0; i < obj.names.length; i += 1) {\n      var n = obj.names[i];\n      if (obj.name) {\n        args.push(location[obj.name][n]);\n      }\n      else { // for mLine and push attributes\n        args.push(location[obj.names[i]]);\n      }\n    }\n  }\n  else {\n    args.push(location[obj.name]);\n  }\n  return format.apply(null, args);\n};\n\n// RFC specified order\n// TODO: extend this with all the rest\nvar defaultOuterOrder = [\n  'v', 'o', 's', 'i',\n  'u', 'e', 'p', 'c',\n  'b', 't', 'r', 'z', 'a'\n];\nvar defaultInnerOrder = ['i', 'c', 'b', 'a'];\n\n\nmodule.exports = function (session, opts) {\n  opts = opts || {};\n  // ensure certain properties exist\n  if (session.version == null) {\n    session.version = 0; // 'v=0' must be there (only defined version atm)\n  }\n  if (session.name == null) {\n    session.name = ' '; // 's= ' must be there if no meaningful name set\n  }\n  session.media.forEach(function (mLine) {\n    if (mLine.payloads == null) {\n      mLine.payloads = '';\n    }\n  });\n\n  var outerOrder = opts.outerOrder || defaultOuterOrder;\n  var innerOrder = opts.innerOrder || defaultInnerOrder;\n  var sdp = [];\n\n  // loop through outerOrder for matching properties on session\n  outerOrder.forEach(function (type) {\n    grammar[type].forEach(function (obj) {\n      if (obj.name in session && session[obj.name] != null) {\n        sdp.push(makeLine(type, obj, session));\n      }\n      else if (obj.push in session && session[obj.push] != null) {\n        session[obj.push].forEach(function (el) {\n          sdp.push(makeLine(type, obj, el));\n        });\n      }\n    });\n  });\n\n  // then for each media line, follow the innerOrder\n  session.media.forEach(function (mLine) {\n    sdp.push(makeLine('m', grammar.m[0], mLine));\n\n    innerOrder.forEach(function (type) {\n      grammar[type].forEach(function (obj) {\n        if (obj.name in mLine && mLine[obj.name] != null) {\n          sdp.push(makeLine(type, obj, mLine));\n        }\n        else if (obj.push in mLine && mLine[obj.push] != null) {\n          mLine[obj.push].forEach(function (el) {\n            sdp.push(makeLine(type, obj, el));\n          });\n        }\n      });\n    });\n  });\n\n  return sdp.join('\\r\\n') + '\\r\\n';\n};\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/sdp-transform/lib/writer.js","/* global RTCRtpReceiver */\r\n\r\nimport sdpTransform from 'sdp-transform';\r\n\r\n/**\r\n * Extract RTP capabilities from remote description.\r\n * @param {Object} sdpObject - Remote SDP object generated by sdp-transform.\r\n * @return {RTCRtpCapabilities}\r\n */\r\nexport function extractCapabilities(sdpObject) {\r\n    // Map of RtpCodecParameters indexed by payload type.\r\n    const codecsMap = new Map();\r\n\r\n    // Array of RtpHeaderExtensions.\r\n    const headerExtensions = [];\r\n\r\n    for (const m of sdpObject.media) {\r\n        // Media kind.\r\n        const kind = m.type;\r\n\r\n        if (kind !== 'audio' && kind !== 'video') {\r\n            continue; // eslint-disable-line no-continue\r\n        }\r\n\r\n        // Get codecs.\r\n        for (const rtp of m.rtp) {\r\n            const codec = {\r\n                clockRate: rtp.rate,\r\n                kind,\r\n                mimeType: `${kind}/${rtp.codec}`,\r\n                name: rtp.codec,\r\n                numChannels: rtp.encoding || 1,\r\n                parameters: {},\r\n                preferredPayloadType: rtp.payload,\r\n                rtcpFeedback: []\r\n            };\r\n\r\n            codecsMap.set(codec.preferredPayloadType, codec);\r\n        }\r\n\r\n        // Get codec parameters.\r\n        for (const fmtp of m.fmtp || []) {\r\n            const parameters = sdpTransform.parseFmtpConfig(fmtp.config);\r\n            const codec = codecsMap.get(fmtp.payload);\r\n\r\n            if (!codec) {\r\n                continue; // eslint-disable-line no-continue\r\n            }\r\n\r\n            codec.parameters = parameters;\r\n        }\r\n\r\n        // Get RTCP feedback for each codec.\r\n        for (const fb of m.rtcpFb || []) {\r\n            const codec = codecsMap.get(fb.payload);\r\n\r\n            if (!codec) {\r\n                continue; // eslint-disable-line no-continue\r\n            }\r\n\r\n            codec.rtcpFeedback.push({\r\n                parameter: fb.subtype || '',\r\n                type: fb.type\r\n            });\r\n        }\r\n\r\n        // Get RTP header extensions.\r\n        for (const ext of m.ext || []) {\r\n            const preferredId = ext.value;\r\n            const uri = ext.uri;\r\n            const headerExtension = {\r\n                kind,\r\n                uri,\r\n                preferredId\r\n            };\r\n\r\n            // Check if already present.\r\n            const duplicated = headerExtensions.find(savedHeaderExtension =>\r\n                headerExtension.kind === savedHeaderExtension.kind\r\n                    && headerExtension.uri === savedHeaderExtension.uri\r\n            );\r\n\r\n            if (!duplicated) {\r\n                headerExtensions.push(headerExtension);\r\n            }\r\n        }\r\n    }\r\n\r\n    return {\r\n        codecs: Array.from(codecsMap.values()),\r\n        fecMechanisms: [], // TODO\r\n        headerExtensions\r\n    };\r\n}\r\n\r\n/**\r\n * Extract DTLS parameters from remote description.\r\n * @param {Object} sdpObject - Remote SDP object generated by sdp-transform.\r\n * @return {RTCDtlsParameters}\r\n */\r\nexport function extractDtlsParameters(sdpObject) {\r\n    const media = getFirstActiveMediaSection(sdpObject);\r\n    const fingerprint = media.fingerprint || sdpObject.fingerprint;\r\n    let role;\r\n\r\n    switch (media.setup) {\r\n    case 'active':\r\n        role = 'client';\r\n        break;\r\n    case 'passive':\r\n        role = 'server';\r\n        break;\r\n    case 'actpass':\r\n        role = 'auto';\r\n        break;\r\n    }\r\n\r\n    return {\r\n        role,\r\n        fingerprints: [\r\n            {\r\n                algorithm: fingerprint.type,\r\n                value: fingerprint.hash\r\n            }\r\n        ]\r\n    };\r\n}\r\n\r\n/**\r\n * Extract ICE candidates from remote description.\r\n * NOTE: This implementation assumes a single BUNDLEd transport and rtcp-mux.\r\n * @param {Object} sdpObject - Remote SDP object generated by sdp-transform.\r\n * @return {sequence<RTCIceCandidate>}\r\n */\r\nexport function extractIceCandidates(sdpObject) {\r\n    const media = getFirstActiveMediaSection(sdpObject);\r\n    const candidates = [];\r\n\r\n    for (const c of media.candidates) {\r\n        // Ignore RTCP candidates (we assume rtcp-mux).\r\n        if (c.component !== 1) {\r\n            continue; // eslint-disable-line no-continue\r\n        }\r\n\r\n        const candidate = {\r\n            foundation: c.foundation,\r\n            ip: c.ip,\r\n            port: c.port,\r\n            priority: c.priority,\r\n            protocol: c.transport.toLowerCase(),\r\n            type: c.type\r\n        };\r\n\r\n        candidates.push(candidate);\r\n    }\r\n\r\n    return candidates;\r\n}\r\n\r\n/**\r\n * Extract ICE parameters from remote description.\r\n * NOTE: This implementation assumes a single BUNDLEd transport.\r\n * @param {Object} sdpObject - Remote SDP object generated by sdp-transform.\r\n * @return {RTCIceParameters}\r\n */\r\nexport function extractIceParameters(sdpObject) {\r\n    const media = getFirstActiveMediaSection(sdpObject);\r\n    const usernameFragment = media.iceUfrag;\r\n    const password = media.icePwd;\r\n    const icelite = sdpObject.icelite === 'ice-lite';\r\n\r\n    return {\r\n        icelite,\r\n        password,\r\n        usernameFragment\r\n    };\r\n}\r\n\r\n/**\r\n * Extract MID values from remote description.\r\n * @param {Object} sdpObject - Remote SDP object generated by sdp-transform.\r\n * @return {map<String, String>} Ordered Map with MID as key and kind as value.\r\n */\r\nexport function extractMids(sdpObject) {\r\n    const midToKind = new Map();\r\n\r\n    // Ignore disabled media sections.\r\n    for (const m of sdpObject.media) {\r\n        midToKind.set(m.mid, m.type);\r\n    }\r\n\r\n    return midToKind;\r\n}\r\n\r\n/**\r\n * Extract tracks information.\r\n * @param {Object} sdpObject - Remote SDP object generated by sdp-transform.\r\n * @return {Map}\r\n */\r\nexport function extractTrackInfos(sdpObject) {\r\n    // Map with info about receiving media.\r\n    // - index: Media SSRC\r\n    // - value: Object\r\n    //   - kind: 'audio' / 'video'\r\n    //   - ssrc: Media SSRC\r\n    //   - rtxSsrc: RTX SSRC (may be unset)\r\n    //   - streamId: MediaStream.jitsiRemoteId\r\n    //   - trackId: MediaStreamTrack.jitsiRemoteId\r\n    //   - cname: CNAME\r\n    // @type {map<Number, Object>}\r\n    const infos = new Map();\r\n\r\n    // Map with stream SSRC as index and associated RTX SSRC as value.\r\n    // @type {map<Number, Number>}\r\n    const rtxMap = new Map();\r\n\r\n    // Set of RTX SSRC values.\r\n    const rtxSet = new Set();\r\n\r\n    for (const m of sdpObject.media) {\r\n        const kind = m.type;\r\n\r\n        if (kind !== 'audio' && kind !== 'video') {\r\n            continue; // eslint-disable-line no-continue\r\n        }\r\n\r\n        // Get RTX information.\r\n        for (const ssrcGroup of m.ssrcGroups || []) {\r\n            // Just consider FID.\r\n            if (ssrcGroup.semantics !== 'FID') {\r\n                continue; // eslint-disable-line no-continue\r\n            }\r\n\r\n            const ssrcs\r\n                = ssrcGroup.ssrcs.split(' ').map(ssrc => Number(ssrc));\r\n            const ssrc = ssrcs[0];\r\n            const rtxSsrc = ssrcs[1];\r\n\r\n            rtxMap.set(ssrc, rtxSsrc);\r\n            rtxSet.add(rtxSsrc);\r\n        }\r\n\r\n        for (const ssrcObject of m.ssrcs || []) {\r\n            const ssrc = ssrcObject.id;\r\n\r\n            // Ignore RTX.\r\n            if (rtxSet.has(ssrc)) {\r\n                continue; // eslint-disable-line no-continue\r\n            }\r\n\r\n            let info = infos.get(ssrc);\r\n\r\n            if (!info) {\r\n                info = {\r\n                    kind,\r\n                    rtxSsrc: rtxMap.get(ssrc),\r\n                    ssrc\r\n                };\r\n\r\n                infos.set(ssrc, info);\r\n            }\r\n\r\n            switch (ssrcObject.attribute) {\r\n            case 'cname': {\r\n                info.cname = ssrcObject.value;\r\n                break;\r\n            }\r\n            case 'msid': {\r\n                const values = ssrcObject.value.split(' ');\r\n                const streamId = values[0];\r\n                const trackId = values[1];\r\n\r\n                info.streamId = streamId;\r\n                info.trackId = trackId;\r\n                break;\r\n            }\r\n            case 'mslabel': {\r\n                const streamId = ssrcObject.value;\r\n\r\n                info.streamId = streamId;\r\n                break;\r\n            }\r\n            case 'label': {\r\n                const trackId = ssrcObject.value;\r\n\r\n                info.trackId = trackId;\r\n                break;\r\n            }\r\n            }\r\n        }\r\n    }\r\n\r\n    return infos;\r\n}\r\n\r\n/**\r\n * Get local ORTC RTP capabilities filtered and adapted to the given remote RTP\r\n * capabilities.\r\n * @param {RTCRtpCapabilities} filterWithCapabilities - RTP capabilities to\r\n * filter with.\r\n * @return {RTCRtpCapabilities}\r\n */\r\nexport function getLocalCapabilities(filterWithCapabilities) {\r\n    const localFullCapabilities = RTCRtpReceiver.getCapabilities();\r\n    const localCapabilities = {\r\n        codecs: [],\r\n        fecMechanisms: [],\r\n        headerExtensions: []\r\n    };\r\n\r\n    // Map of RTX and codec payloads.\r\n    // - index: Codec payloadType\r\n    // - value: Associated RTX payloadType\r\n    // @type {map<Number, Number>}\r\n    const remoteRtxMap = new Map();\r\n\r\n    // Set codecs.\r\n    for (const remoteCodec of filterWithCapabilities.codecs) {\r\n        const remoteCodecName = remoteCodec.name.toLowerCase();\r\n\r\n        if (remoteCodecName === 'rtx') {\r\n            remoteRtxMap.set(\r\n                remoteCodec.parameters.apt, remoteCodec.preferredPayloadType);\r\n\r\n            continue; // eslint-disable-line no-continue\r\n        }\r\n\r\n        const localCodec = localFullCapabilities.codecs.find(codec =>\r\n            codec.name.toLowerCase() === remoteCodecName\r\n                && codec.kind === remoteCodec.kind\r\n                && codec.clockRate === remoteCodec.clockRate\r\n        );\r\n\r\n        if (!localCodec) {\r\n            continue; // eslint-disable-line no-continue\r\n        }\r\n\r\n        const codec = {\r\n            clockRate: localCodec.clockRate,\r\n            kind: localCodec.kind,\r\n            mimeType: `${localCodec.kind}/${localCodec.name}`,\r\n            name: localCodec.name,\r\n            numChannels: localCodec.numChannels || 1,\r\n            parameters: {},\r\n            preferredPayloadType: remoteCodec.preferredPayloadType,\r\n            rtcpFeedback: []\r\n        };\r\n\r\n        for (const remoteParamName of Object.keys(remoteCodec.parameters)) {\r\n            const remoteParamValue\r\n                = remoteCodec.parameters[remoteParamName];\r\n\r\n            for (const localParamName of Object.keys(localCodec.parameters)) {\r\n                const localParamValue\r\n                    = localCodec.parameters[localParamName];\r\n\r\n                if (localParamName !== remoteParamName) {\r\n                    continue; // eslint-disable-line no-continue\r\n                }\r\n\r\n                // TODO: We should consider much more cases here, but Edge\r\n                // does not support many codec parameters.\r\n                if (localParamValue === remoteParamValue) {\r\n                    // Use this RTP parameter.\r\n                    codec.parameters[localParamName] = localParamValue;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        for (const remoteFb of remoteCodec.rtcpFeedback) {\r\n            const localFb = localCodec.rtcpFeedback.find(fb =>\r\n                fb.type === remoteFb.type\r\n                    && fb.parameter === remoteFb.parameter\r\n            );\r\n\r\n            if (localFb) {\r\n                // Use this RTCP feedback.\r\n                codec.rtcpFeedback.push(localFb);\r\n            }\r\n        }\r\n\r\n        // Use this codec.\r\n        localCapabilities.codecs.push(codec);\r\n    }\r\n\r\n    // Add RTX for video codecs.\r\n    for (const codec of localCapabilities.codecs) {\r\n        const payloadType = codec.preferredPayloadType;\r\n\r\n        if (!remoteRtxMap.has(payloadType)) {\r\n            continue; // eslint-disable-line no-continue\r\n        }\r\n\r\n        const rtxCodec = {\r\n            clockRate: codec.clockRate,\r\n            kind: codec.kind,\r\n            mimeType: `${codec.kind}/rtx`,\r\n            name: 'rtx',\r\n            parameters: {\r\n                apt: payloadType\r\n            },\r\n            preferredPayloadType: remoteRtxMap.get(payloadType),\r\n            rtcpFeedback: []\r\n        };\r\n\r\n        // Add RTX codec.\r\n        localCapabilities.codecs.push(rtxCodec);\r\n    }\r\n\r\n    // Add RTP header extensions.\r\n    for (const remoteExtension of filterWithCapabilities.headerExtensions) {\r\n        const localExtension\r\n            = localFullCapabilities.headerExtensions.find(extension =>\r\n                extension.kind === remoteExtension.kind\r\n                    && extension.uri === remoteExtension.uri\r\n            );\r\n\r\n        if (localExtension) {\r\n            const extension = {\r\n                kind: localExtension.kind,\r\n                preferredEncrypt: Boolean(remoteExtension.preferredEncrypt),\r\n                preferredId: remoteExtension.preferredId,\r\n                uri: localExtension.uri\r\n            };\r\n\r\n            // Use this RTP header extension.\r\n            localCapabilities.headerExtensions.push(extension);\r\n        }\r\n    }\r\n\r\n    // Add FEC mechanisms.\r\n    // NOTE: We don't support FEC yet and, in fact, neither does Edge.\r\n    for (const remoteFecMechanism of filterWithCapabilities.fecMechanisms) {\r\n        const localFecMechanism\r\n            = localFullCapabilities.fecMechanisms.find(fec =>\r\n                fec === remoteFecMechanism\r\n            );\r\n\r\n        if (localFecMechanism) {\r\n            // Use this FEC mechanism.\r\n            localCapabilities.fecMechanisms.push(localFecMechanism);\r\n        }\r\n    }\r\n\r\n    return localCapabilities;\r\n}\r\n\r\n/**\r\n * Get the first acive media section.\r\n * @param {Object} sdpObject - SDP object generated by sdp-transform.\r\n * @return {Object} SDP media section as parsed by sdp-transform.\r\n */\r\nfunction getFirstActiveMediaSection(sdpObject) {\r\n    return sdpObject.media.find(m =>\r\n        m.iceUfrag && m.port !== 0\r\n    );\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/RTC/ortc/utils.js","/**\r\n * Create a class inheriting from Error.\r\n */\r\nfunction createErrorClass(name) {\r\n    const klass = class extends Error {\r\n        /**\r\n         * Custom error class constructor.\r\n         * @param {string} message\r\n         */\r\n        constructor(message) {\r\n            super(message);\r\n\r\n            // Override `name` property value and make it non enumerable.\r\n            Object.defineProperty(this, 'name', { value: name });\r\n        }\r\n    };\r\n\r\n    return klass;\r\n}\r\n\r\nexport const InvalidStateError = createErrorClass('InvalidStateError');\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/RTC/ortc/errors.js","/* global chrome, $, alert */\r\n\r\nimport JitsiTrackError from '../../JitsiTrackError';\r\nimport * as JitsiTrackErrors from '../../JitsiTrackErrors';\r\nimport browser from '../browser';\r\n\r\nconst logger = require('jitsi-meet-logger').getLogger(__filename);\r\nconst GlobalOnErrorHandler = require('../util/GlobalOnErrorHandler');\r\n\r\n/**\r\n * Indicates whether the Chrome desktop sharing extension is installed.\r\n * @type {boolean}\r\n */\r\nlet chromeExtInstalled = false;\r\n\r\n/**\r\n * Indicates whether an update of the Chrome desktop sharing extension is\r\n * required.\r\n * @type {boolean}\r\n */\r\nlet chromeExtUpdateRequired = false;\r\n\r\n/**\r\n * Whether the jidesha extension for firefox is installed for the domain on\r\n * which we are running. Null designates an unknown value.\r\n * @type {null}\r\n */\r\nlet firefoxExtInstalled = null;\r\n\r\n/**\r\n * If set to true, detection of an installed firefox extension will be started\r\n * again the next time obtainScreenOnFirefox is called (e.g. next time the\r\n * user tries to enable screen sharing).\r\n */\r\nlet reDetectFirefoxExtension = false;\r\n\r\nlet gumFunction = null;\r\n\r\n/**\r\n * The error returned by chrome when trying to start inline installation from\r\n * popup.\r\n */\r\nconst CHROME_EXTENSION_POPUP_ERROR\r\n    = 'Inline installs can not be initiated from pop-up windows.';\r\n\r\n/**\r\n * The error returned by chrome when trying to start inline installation from\r\n * iframe.\r\n */\r\nconst CHROME_EXTENSION_IFRAME_ERROR\r\n    = 'Chrome Web Store installations can only be started by the top frame.';\r\n\r\n/**\r\n * The error returned by chrome when trying to start inline installation\r\n * not from the \"main\" whitelisted site.\r\n * @type {string}\r\n */\r\nconst CHROME_EXTENSION_INLINE_ERROR\r\n    = 'Installs can only be initiated by one of'\r\n        + ' the Chrome Web Store item\\'s verified sites.';\r\n\r\n/**\r\n * The error returned by chrome when trying to start inline installation\r\n * with extension that doesn't support inline installation.\r\n *\r\n * @type {string}\r\n */\r\nconst CHROME_EXTENSION_INLINE_NOT_SUPPORTED_ERROR\r\n    = 'Inline installation is not supported for this item. '\r\n        + 'The user will be redirected to the Chrome Web Store.';\r\n\r\n/**\r\n * The error message returned by chrome when the extension is installed.\r\n */\r\nconst CHROME_NO_EXTENSION_ERROR_MSG // eslint-disable-line no-unused-vars\r\n    = 'Could not establish connection. Receiving end does not exist.';\r\n\r\n/**\r\n * The error message returned by chrome when the extension install action needs\r\n * to be initiated by a user gesture.\r\n * @type {string}\r\n */\r\nconst CHROME_USER_GESTURE_REQ_ERROR\r\n    = 'Chrome Web Store installations can only be initated by a user gesture.';\r\n\r\n/**\r\n * Handles obtaining a stream from a screen capture on different browsers.\r\n */\r\nconst ScreenObtainer = {\r\n    /**\r\n     * If not <tt>null</tt> it means that the initialization process is still in\r\n     * progress. It is used to make desktop stream request wait and continue\r\n     * after it's done.\r\n     * {@type Promise|null}\r\n     */\r\n    intChromeExtPromise: null,\r\n\r\n    obtainStream: null,\r\n\r\n    /**\r\n     * Initializes the function used to obtain a screen capture\r\n     * (this.obtainStream).\r\n     *\r\n     * @param {object} options\r\n     * @param {boolean} [options.disableDesktopSharing]\r\n     * @param {boolean} [options.desktopSharingChromeDisabled]\r\n     * @param {boolean} [options.desktopSharingChromeExtId]\r\n     * @param {boolean} [options.desktopSharingFirefoxDisabled]\r\n     * @param {boolean} [options.desktopSharingFirefoxExtId] (deprecated)\r\n     * @param {Function} gum GUM method\r\n     */\r\n    init(options = {\r\n        disableDesktopSharing: false,\r\n        desktopSharingChromeDisabled: false,\r\n        desktopSharingChromeExtId: null,\r\n        desktopSharingFirefoxDisabled: false,\r\n        desktopSharingFirefoxExtId: null\r\n    }, gum) {\r\n        // eslint-disable-next-line no-param-reassign\r\n        this.options = options = options || {};\r\n        gumFunction = gum;\r\n\r\n        this.obtainStream\r\n            = this.options.disableDesktopSharing\r\n                ? null : this._createObtainStreamMethod(options);\r\n\r\n        if (!this.obtainStream) {\r\n            logger.info('Desktop sharing disabled');\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Returns a method which will be used to obtain the screen sharing stream\r\n     * (based on the browser type).\r\n     *\r\n     * @param {object} options passed from {@link init} - check description\r\n     * there\r\n     * @returns {Function}\r\n     * @private\r\n     */\r\n    _createObtainStreamMethod(options) {\r\n        if (browser.isNWJS()) {\r\n            return (_, onSuccess, onFailure) => {\r\n                window.JitsiMeetNW.obtainDesktopStream(\r\n                    onSuccess,\r\n                    (error, constraints) => {\r\n                        let jitsiError;\r\n\r\n                        // FIXME:\r\n                        // This is very very dirty fix for recognising that the\r\n                        // user have clicked the cancel button from the Desktop\r\n                        // sharing pick window. The proper solution would be to\r\n                        // detect this in the NWJS application by checking the\r\n                        // streamId === \"\". Even better solution would be to\r\n                        // stop calling GUM from the NWJS app and just pass the\r\n                        // streamId to lib-jitsi-meet. This way the desktop\r\n                        // sharing implementation for NWJS and chrome extension\r\n                        // will be the same and lib-jitsi-meet will be able to\r\n                        // control the constraints, check the streamId, etc.\r\n                        //\r\n                        // I cannot find documentation about \"InvalidStateError\"\r\n                        // but this is what we are receiving from GUM when the\r\n                        // streamId for the desktop sharing is \"\".\r\n\r\n                        if (error && error.name === 'InvalidStateError') {\r\n                            jitsiError = new JitsiTrackError(\r\n                                JitsiTrackErrors.CHROME_EXTENSION_USER_CANCELED\r\n                            );\r\n                        } else {\r\n                            jitsiError = new JitsiTrackError(\r\n                                error, constraints, [ 'desktop' ]);\r\n                        }\r\n                        (typeof onFailure === 'function')\r\n                            && onFailure(jitsiError);\r\n                    });\r\n            };\r\n        } else if (browser.isElectron()) {\r\n            return this.obtainScreenOnElectron;\r\n        } else if (browser.isTemasysPluginUsed()) {\r\n            // XXX Don't require Temasys unless it's to be used because it\r\n            // doesn't run on React Native, for example.\r\n            const plugin\r\n                = require('./adapter.screenshare').WebRTCPlugin.plugin;\r\n\r\n            if (!plugin.HasScreensharingFeature) {\r\n                logger.warn(\r\n                    'Screensharing not supported by this plugin version');\r\n\r\n                return null;\r\n            } else if (!plugin.isScreensharingAvailable) {\r\n                logger.warn(\r\n                    'Screensharing not available with Temasys plugin on'\r\n                        + ' this site');\r\n\r\n                return null;\r\n            }\r\n\r\n            logger.info('Using Temasys plugin for desktop sharing');\r\n\r\n            return obtainWebRTCScreen;\r\n        } else if (browser.isChrome() || browser.isOpera()) {\r\n            if (browser.isVersionLessThan('34')) {\r\n                logger.info('Chrome extension not supported until ver 34');\r\n\r\n                return null;\r\n            } else if (options.desktopSharingChromeDisabled\r\n                || options.desktopSharingChromeMethod === false\r\n                || !options.desktopSharingChromeExtId) {\r\n\r\n                // TODO: desktopSharingChromeMethod is deprecated, remove.\r\n                return null;\r\n            }\r\n\r\n            logger.info('Using Chrome extension for desktop sharing');\r\n            this.intChromeExtPromise\r\n                = initChromeExtension(options).then(() => {\r\n                    this.intChromeExtPromise = null;\r\n                });\r\n\r\n            return this.obtainScreenFromExtension;\r\n        } else if (browser.isFirefox()) {\r\n            if (options.desktopSharingFirefoxDisabled) {\r\n                return null;\r\n            } else if (window.location.protocol === 'http:') {\r\n                logger.log('Screen sharing is not supported over HTTP. '\r\n                    + 'Use of HTTPS is required.');\r\n\r\n                return null;\r\n            }\r\n\r\n            initFirefoxExtensionDetection(options);\r\n\r\n            return this.obtainScreenOnFirefox;\r\n        }\r\n\r\n        logger.log(\r\n            'Screen sharing not supported by the current browser: ',\r\n            browser.getName());\r\n\r\n        return null;\r\n    },\r\n\r\n    /**\r\n     * Checks whether obtaining a screen capture is supported in the current\r\n     * environment.\r\n     * @returns {boolean}\r\n     */\r\n    isSupported() {\r\n        return this.obtainStream !== null;\r\n    },\r\n\r\n    /**\r\n     * Obtains a screen capture stream on Firefox.\r\n     * @param callback\r\n     * @param errorCallback\r\n     */\r\n    obtainScreenOnFirefox(options, callback, errorCallback) {\r\n        let extensionRequired = false;\r\n        const { desktopSharingFirefoxMaxVersionExtRequired } = this.options;\r\n        let maxVersion = desktopSharingFirefoxMaxVersionExtRequired;\r\n\r\n        if (typeof maxVersion === 'number') {\r\n            extensionRequired = maxVersion === -1;\r\n            if (maxVersion >= 0) {\r\n                maxVersion = String(maxVersion);\r\n            }\r\n        }\r\n\r\n        if (typeof maxVersion === 'string') {\r\n            extensionRequired = !browser.isVersionGreaterThan(maxVersion);\r\n        }\r\n\r\n        if (extensionRequired) {\r\n            logger.log(\r\n                `Jidesha extension required on firefox version ${\r\n                    browser.getVersion()}`);\r\n        }\r\n\r\n        if (!extensionRequired || firefoxExtInstalled === true) {\r\n            obtainWebRTCScreen(options, callback, errorCallback);\r\n\r\n            return;\r\n        }\r\n\r\n        if (reDetectFirefoxExtension) {\r\n            reDetectFirefoxExtension = false;\r\n            initFirefoxExtensionDetection(this.options);\r\n        }\r\n\r\n        // Give it some (more) time to initialize, and assume lack of\r\n        // extension if it hasn't.\r\n        if (firefoxExtInstalled === null) {\r\n            window.setTimeout(\r\n                () => {\r\n                    if (firefoxExtInstalled === null) {\r\n                        firefoxExtInstalled = false;\r\n                    }\r\n                    this.obtainScreenOnFirefox(callback, errorCallback);\r\n                },\r\n                300);\r\n            logger.log(\r\n                'Waiting for detection of jidesha on firefox to finish.');\r\n\r\n            return;\r\n        }\r\n\r\n        // We need an extension and it isn't installed.\r\n\r\n        // Make sure we check for the extension when the user clicks again.\r\n        firefoxExtInstalled = null;\r\n        reDetectFirefoxExtension = true;\r\n\r\n        // Make sure desktopsharing knows that we failed, so that it doesn't get\r\n        // stuck in 'switching' mode.\r\n        errorCallback(\r\n            new JitsiTrackError(JitsiTrackErrors.FIREFOX_EXTENSION_NEEDED));\r\n    },\r\n\r\n    /**\r\n     * Obtains a screen capture stream on Electron.\r\n     *\r\n     * @param {Object} [options] - Screen sharing options.\r\n     * @param {Array<string>} [options.desktopSharingSources] - Array with the\r\n     * sources that have to be displayed in the desktop picker window ('screen',\r\n     * 'window', etc.).\r\n     * @param onSuccess - Success callback.\r\n     * @param onFailure - Failure callback.\r\n     */\r\n    obtainScreenOnElectron(options = {}, onSuccess, onFailure) {\r\n        if (window.JitsiMeetScreenObtainer\r\n            && window.JitsiMeetScreenObtainer.openDesktopPicker) {\r\n            window.JitsiMeetScreenObtainer.openDesktopPicker(\r\n                {\r\n                    desktopSharingSources:\r\n                        options.desktopSharingSources\r\n                            || this.options.desktopSharingChromeSources\r\n                },\r\n                (streamId, streamType) =>\r\n                    onGetStreamResponse(\r\n                        {\r\n                            streamId,\r\n                            streamType\r\n                        },\r\n                        onSuccess,\r\n                        onFailure\r\n                    ),\r\n                err => onFailure(new JitsiTrackError(\r\n                    JitsiTrackErrors.ELECTRON_DESKTOP_PICKER_ERROR,\r\n                    err\r\n                ))\r\n            );\r\n        } else {\r\n            onFailure(new JitsiTrackError(\r\n                JitsiTrackErrors.ELECTRON_DESKTOP_PICKER_NOT_FOUND));\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Asks Chrome extension to call chooseDesktopMedia and gets chrome\r\n     * 'desktop' stream for returned stream token.\r\n     */\r\n    obtainScreenFromExtension(options, streamCallback, failCallback) {\r\n        if (this.intChromeExtPromise !== null) {\r\n            this.intChromeExtPromise.then(() => {\r\n                this.obtainScreenFromExtension(\r\n                    options, streamCallback, failCallback);\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        const {\r\n            desktopSharingChromeExtId,\r\n            desktopSharingChromeSources\r\n        } = this.options;\r\n\r\n        const gumOptions = {\r\n            desktopSharingChromeExtId,\r\n            desktopSharingChromeSources:\r\n                options.desktopSharingSources\r\n                    || desktopSharingChromeSources\r\n        };\r\n\r\n        if (chromeExtInstalled) {\r\n            doGetStreamFromExtension(\r\n                gumOptions,\r\n                streamCallback,\r\n                failCallback);\r\n        } else {\r\n            if (chromeExtUpdateRequired) {\r\n                /* eslint-disable no-alert */\r\n                alert(\r\n                    'Jitsi Desktop Streamer requires update. '\r\n                    + 'Changes will take effect after next Chrome restart.');\r\n\r\n                /* eslint-enable no-alert */\r\n            }\r\n\r\n            // for opera there is no inline install\r\n            // extension \"Download Chrome Extension\" allows us to open\r\n            // the chrome webstore and install from there and then activate our\r\n            // extension\r\n            if (browser.isOpera()) {\r\n                this.handleExternalInstall(options, streamCallback,\r\n                    failCallback);\r\n\r\n                return;\r\n            }\r\n\r\n            try {\r\n                chrome.webstore.install(\r\n                    getWebStoreInstallUrl(this.options),\r\n                    arg => {\r\n                        logger.log('Extension installed successfully', arg);\r\n                        chromeExtInstalled = true;\r\n\r\n                        // We need to give a moment to the endpoint to become\r\n                        // available.\r\n                        waitForExtensionAfterInstall(this.options, 200, 10)\r\n                            .then(() => {\r\n                                doGetStreamFromExtension(\r\n                                    gumOptions,\r\n                                    streamCallback,\r\n                                    failCallback);\r\n                            })\r\n                            .catch(() => {\r\n                                this.handleExtensionInstallationError(options,\r\n                                    streamCallback, failCallback);\r\n                            });\r\n                    },\r\n                    this.handleExtensionInstallationError.bind(this,\r\n                        options, streamCallback, failCallback)\r\n                );\r\n            } catch (e) {\r\n                this.handleExtensionInstallationError(options, streamCallback,\r\n                    failCallback, e);\r\n            }\r\n        }\r\n    },\r\n\r\n    /* eslint-disable max-params */\r\n\r\n    handleExternalInstall(options, streamCallback, failCallback, e) {\r\n        const webStoreInstallUrl = getWebStoreInstallUrl(this.options);\r\n\r\n        options.listener('waitingForExtension', webStoreInstallUrl);\r\n        this.checkForChromeExtensionOnInterval(options, streamCallback,\r\n            failCallback, e);\r\n    },\r\n\r\n    handleExtensionInstallationError(options, streamCallback, failCallback, e) {\r\n        const webStoreInstallUrl = getWebStoreInstallUrl(this.options);\r\n\r\n        if ((CHROME_EXTENSION_POPUP_ERROR === e\r\n             || CHROME_EXTENSION_IFRAME_ERROR === e\r\n             || CHROME_EXTENSION_INLINE_ERROR === e\r\n             || CHROME_EXTENSION_INLINE_NOT_SUPPORTED_ERROR === e)\r\n                && options.interval > 0\r\n                && typeof options.checkAgain === 'function'\r\n                && typeof options.listener === 'function') {\r\n            this.handleExternalInstall(options, streamCallback,\r\n                failCallback, e);\r\n\r\n            return;\r\n        }\r\n\r\n        const msg\r\n            = `Failed to install the extension from ${webStoreInstallUrl}`;\r\n\r\n        logger.log(msg, e);\r\n\r\n        const error\r\n            = e === CHROME_USER_GESTURE_REQ_ERROR\r\n                ? JitsiTrackErrors.CHROME_EXTENSION_USER_GESTURE_REQUIRED\r\n                : JitsiTrackErrors.CHROME_EXTENSION_INSTALLATION_ERROR;\r\n\r\n        failCallback(new JitsiTrackError(error, msg));\r\n    },\r\n\r\n    /* eslint-enable max-params */\r\n\r\n    checkForChromeExtensionOnInterval(options, streamCallback, failCallback) {\r\n        if (options.checkAgain() === false) {\r\n            failCallback(new JitsiTrackError(\r\n                JitsiTrackErrors.CHROME_EXTENSION_INSTALLATION_ERROR));\r\n\r\n            return;\r\n        }\r\n        waitForExtensionAfterInstall(this.options, options.interval, 1)\r\n            .then(() => {\r\n                chromeExtInstalled = true;\r\n                options.listener('extensionFound');\r\n                this.obtainScreenFromExtension(options,\r\n                    streamCallback, failCallback);\r\n            })\r\n            .catch(() => {\r\n                this.checkForChromeExtensionOnInterval(options,\r\n                    streamCallback, failCallback);\r\n            });\r\n    }\r\n};\r\n\r\n/**\r\n * Obtains a desktop stream using getUserMedia.\r\n * For this to work on Chrome, the\r\n * 'chrome://flags/#enable-usermedia-screen-capture' flag must be enabled.\r\n *\r\n * On firefox, the document's domain must be white-listed in the\r\n * 'media.getusermedia.screensharing.allowed_domains' preference in\r\n * 'about:config'.\r\n */\r\nfunction obtainWebRTCScreen(options, streamCallback, failCallback) {\r\n    gumFunction(\r\n        [ 'screen' ],\r\n        stream => streamCallback({ stream }),\r\n        failCallback\r\n    );\r\n}\r\n\r\n/**\r\n * Constructs inline install URL for Chrome desktop streaming extension.\r\n * The 'chromeExtensionId' must be defined in options parameter.\r\n * @param options supports \"desktopSharingChromeExtId\"\r\n * @returns {string}\r\n */\r\nfunction getWebStoreInstallUrl(options) {\r\n    return (\r\n        `https://chrome.google.com/webstore/detail/${\r\n            options.desktopSharingChromeExtId}`);\r\n}\r\n\r\n/**\r\n * Checks whether an update of the Chrome extension is required.\r\n * @param minVersion minimal required version\r\n * @param extVersion current extension version\r\n * @returns {boolean}\r\n */\r\nfunction isUpdateRequired(minVersion, extVersion) {\r\n    try {\r\n        const s1 = minVersion.split('.');\r\n        const s2 = extVersion.split('.');\r\n\r\n        const len = Math.max(s1.length, s2.length);\r\n\r\n        for (let i = 0; i < len; i++) {\r\n            let n1 = 0,\r\n                n2 = 0;\r\n\r\n            if (i < s1.length) {\r\n                n1 = parseInt(s1[i], 10);\r\n            }\r\n            if (i < s2.length) {\r\n                n2 = parseInt(s2[i], 10);\r\n            }\r\n\r\n            if (isNaN(n1) || isNaN(n2)) {\r\n                return true;\r\n            } else if (n1 !== n2) {\r\n                return n1 > n2;\r\n            }\r\n        }\r\n\r\n        // will happen if both versions have identical numbers in\r\n        // their components (even if one of them is longer, has more components)\r\n        return false;\r\n    } catch (e) {\r\n        GlobalOnErrorHandler.callErrorHandler(e);\r\n        logger.error('Failed to parse extension version', e);\r\n\r\n        return true;\r\n    }\r\n}\r\n\r\n/**\r\n *\r\n * @param callback\r\n * @param options\r\n */\r\nfunction checkChromeExtInstalled(callback, options) {\r\n    if (typeof chrome === 'undefined' || !chrome || !chrome.runtime) {\r\n        // No API, so no extension for sure\r\n        callback(false, false);\r\n\r\n        return;\r\n    }\r\n    chrome.runtime.sendMessage(\r\n        options.desktopSharingChromeExtId,\r\n        { getVersion: true },\r\n        response => {\r\n            if (!response || !response.version) {\r\n                // Communication failure - assume that no endpoint exists\r\n                logger.warn(\r\n                    'Extension not installed?: ', chrome.runtime.lastError);\r\n                callback(false, false);\r\n\r\n                return;\r\n            }\r\n\r\n            // Check installed extension version\r\n            const extVersion = response.version;\r\n\r\n            logger.log(`Extension version is: ${extVersion}`);\r\n            const updateRequired\r\n                = isUpdateRequired(\r\n                    options.desktopSharingChromeMinExtVersion,\r\n                    extVersion);\r\n\r\n            callback(!updateRequired, updateRequired);\r\n        }\r\n    );\r\n}\r\n\r\n/**\r\n *\r\n * @param options\r\n * @param streamCallback\r\n * @param failCallback\r\n */\r\nfunction doGetStreamFromExtension(options, streamCallback, failCallback) {\r\n    // Sends 'getStream' msg to the extension.\r\n    // Extension id must be defined in the config.\r\n    chrome.runtime.sendMessage(\r\n        options.desktopSharingChromeExtId,\r\n        {\r\n            getStream: true,\r\n            sources: options.desktopSharingChromeSources\r\n        },\r\n        response => {\r\n            if (!response) {\r\n                // possibly re-wraping error message to make code consistent\r\n                const lastError = chrome.runtime.lastError;\r\n\r\n                failCallback(lastError instanceof Error\r\n                    ? lastError\r\n                    : new JitsiTrackError(\r\n                        JitsiTrackErrors.CHROME_EXTENSION_GENERIC_ERROR,\r\n                        lastError));\r\n\r\n                return;\r\n            }\r\n            logger.log('Response from extension: ', response);\r\n            //streamCallback(response); //webrecs\r\n            onGetStreamResponse(response, streamCallback, failCallback);\r\n        }\r\n    );\r\n}\r\n\r\n/**\r\n * Initializes <link rel=chrome-webstore-item /> with extension id set in\r\n * config.js to support inline installs. Host site must be selected as main\r\n * website of published extension.\r\n * @param options supports \"desktopSharingChromeExtId\"\r\n */\r\nfunction initInlineInstalls(options) {\r\n    if ($('link[rel=chrome-webstore-item]').length === 0) {\r\n        $('head').append('<link rel=\"chrome-webstore-item\">');\r\n    }\r\n    $('link[rel=chrome-webstore-item]').attr('href',\r\n        getWebStoreInstallUrl(options));\r\n}\r\n\r\n/**\r\n *\r\n * @param options\r\n *\r\n * @return {Promise} - a Promise resolved once the initialization process is\r\n * finished.\r\n */\r\nfunction initChromeExtension(options) {\r\n    // Initialize Chrome extension inline installs\r\n    initInlineInstalls(options);\r\n\r\n    return new Promise(resolve => {\r\n        // Check if extension is installed\r\n        checkChromeExtInstalled((installed, updateRequired) => {\r\n            chromeExtInstalled = installed;\r\n            chromeExtUpdateRequired = updateRequired;\r\n            logger.info(\r\n                `Chrome extension installed: ${\r\n                    chromeExtInstalled} updateRequired: ${\r\n                    chromeExtUpdateRequired}`);\r\n            resolve();\r\n        }, options);\r\n    });\r\n}\r\n\r\n/**\r\n * Checks \"retries\" times on every \"waitInterval\"ms whether the ext is alive.\r\n * @param {Object} options the options passed to ScreanObtainer.obtainStream\r\n * @param {int} waitInterval the number of ms between retries\r\n * @param {int} retries the number of retries\r\n * @returns {Promise} returns promise that will be resolved when the extension\r\n * is alive and rejected if the extension is not alive even after \"retries\"\r\n * checks\r\n */\r\nfunction waitForExtensionAfterInstall(options, waitInterval, retries) {\r\n    if (retries === 0) {\r\n        return Promise.reject();\r\n    }\r\n\r\n    return new Promise((resolve, reject) => {\r\n        let currentRetries = retries;\r\n        const interval = window.setInterval(() => {\r\n            checkChromeExtInstalled(installed => {\r\n                if (installed) {\r\n                    window.clearInterval(interval);\r\n                    resolve();\r\n                } else {\r\n                    currentRetries--;\r\n                    if (currentRetries === 0) {\r\n                        reject();\r\n                        window.clearInterval(interval);\r\n                    }\r\n                }\r\n            }, options);\r\n        }, waitInterval);\r\n    });\r\n}\r\n\r\n/**\r\n * Handles response from external application / extension and calls GUM to\r\n * receive the desktop streams or reports error.\r\n * @param {object} response\r\n * @param {string} response.streamId - the streamId for the desktop stream\r\n * @param {string} response.error - error to be reported.\r\n * @param {Function} onSuccess - callback for success.\r\n * @param {Function} onFailure - callback for failure.\r\n */\r\nfunction onGetStreamResponse(\r\n        { streamId, streamType, error },\r\n        onSuccess,\r\n        onFailure) {\r\n    if (streamId) {\r\n        gumFunction(\r\n            [ 'desktop' ], //webrecs \r\n            stream => onSuccess({\r\n                stream,\r\n                sourceId: streamId,\r\n                sourceType: streamType\r\n            }),\r\n            onFailure,\r\n            { desktopStream: streamId });\r\n    } else {\r\n        // As noted in Chrome Desktop Capture API:\r\n        // If user didn't select any source (i.e. canceled the prompt)\r\n        // then the callback is called with an empty streamId.\r\n        if (streamId === '') {\r\n            onFailure(new JitsiTrackError(\r\n                JitsiTrackErrors.CHROME_EXTENSION_USER_CANCELED));\r\n\r\n            return;\r\n        }\r\n\r\n        onFailure(new JitsiTrackError(\r\n            JitsiTrackErrors.CHROME_EXTENSION_GENERIC_ERROR,\r\n            error));\r\n    }\r\n}\r\n\r\n/**\r\n * Starts the detection of an installed jidesha extension for firefox.\r\n * @param options supports \"desktopSharingFirefoxDisabled\",\r\n * \"desktopSharingFirefoxExtId\"\r\n */\r\nfunction initFirefoxExtensionDetection(options) {\r\n    if (options.desktopSharingFirefoxDisabled) {\r\n        return;\r\n    }\r\n    if (firefoxExtInstalled === false || firefoxExtInstalled === true) {\r\n        return;\r\n    }\r\n    if (!options.desktopSharingFirefoxExtId) {\r\n        firefoxExtInstalled = false;\r\n\r\n        return;\r\n    }\r\n\r\n    const img = document.createElement('img');\r\n\r\n    img.onload = () => {\r\n        logger.log('Detected firefox screen sharing extension.');\r\n        firefoxExtInstalled = true;\r\n    };\r\n    img.onerror = () => {\r\n        logger.log('Detected lack of firefox screen sharing extension.');\r\n        firefoxExtInstalled = false;\r\n    };\r\n\r\n    // The jidesha extension exposes an empty image file under the url:\r\n    // \"chrome://EXT_ID/content/DOMAIN.png\"\r\n    // Where EXT_ID is the ID of the extension with \"@\" replaced by \".\", and\r\n    // DOMAIN is a domain whitelisted by the extension.\r\n    const extId = options.desktopSharingFirefoxExtId.replace('@', '.');\r\n    const domain = document.location.hostname;\r\n    const src = `chrome://${extId}/content/${domain}.png`;\r\n\r\n    img.setAttribute('src', src);\r\n}\r\n\r\nexport default ScreenObtainer;\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/RTC/ScreenObtainer.js","/*\r\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\r\n *\r\n *  Use of this source code is governed by a BSD-style license\r\n *  that can be found in the LICENSE file in the root of the source\r\n *  tree.\r\n */\r\n /* eslint-env node */\r\n\r\n'use strict';\r\n\r\nvar adapterFactory = require('./adapter_factory.js');\r\nmodule.exports = adapterFactory({window: global.window});\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/webrtc-adapter/src/js/adapter_core.js","/*\r\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\r\n *\r\n *  Use of this source code is governed by a BSD-style license\r\n *  that can be found in the LICENSE file in the root of the source\r\n *  tree.\r\n */\r\n /* eslint-env node */\r\n\r\n'use strict';\r\n\r\nvar utils = require('./utils');\r\n// Shimming starts here.\r\nmodule.exports = function(dependencies, opts) {\r\n  var window = dependencies && dependencies.window;\r\n\r\n  var options = {\r\n    shimChrome: true,\r\n    shimFirefox: true,\r\n    shimEdge: true,\r\n    shimSafari: true,\r\n  };\r\n\r\n  for (var key in opts) {\r\n    if (hasOwnProperty.call(opts, key)) {\r\n      options[key] = opts[key];\r\n    }\r\n  }\r\n\r\n  // Utils.\r\n  var logging = utils.log;\r\n  var browserDetails = utils.detectBrowser(window);\r\n\r\n  // Export to the adapter global object visible in the browser.\r\n  var adapter = {\r\n    browserDetails: browserDetails,\r\n    extractVersion: utils.extractVersion,\r\n    disableLog: utils.disableLog,\r\n    disableWarnings: utils.disableWarnings\r\n  };\r\n\r\n  // Uncomment the line below if you want logging to occur, including logging\r\n  // for the switch statement below. Can also be turned on in the browser via\r\n  // adapter.disableLog(false), but then logging from the switch statement below\r\n  // will not appear.\r\n  // require('./utils').disableLog(false);\r\n\r\n  // Browser shims.\r\n  var chromeShim = require('./chrome/chrome_shim') || null;\r\n  var edgeShim = require('./edge/edge_shim') || null;\r\n  var firefoxShim = require('./firefox/firefox_shim') || null;\r\n  var safariShim = require('./safari/safari_shim') || null;\r\n  var commonShim = require('./common_shim') || null;\r\n\r\n  // Shim browser if found.\r\n  switch (browserDetails.browser) {\r\n    case 'chrome':\r\n      if (!chromeShim || !chromeShim.shimPeerConnection ||\r\n          !options.shimChrome) {\r\n        logging('Chrome shim is not included in this adapter release.');\r\n        return adapter;\r\n      }\r\n      logging('adapter.js shimming chrome.');\r\n      // Export to the adapter global object visible in the browser.\r\n      adapter.browserShim = chromeShim;\r\n      commonShim.shimCreateObjectURL(window);\r\n\r\n      chromeShim.shimGetUserMedia(window);\r\n      chromeShim.shimMediaStream(window);\r\n      chromeShim.shimSourceObject(window);\r\n      chromeShim.shimPeerConnection(window);\r\n      chromeShim.shimOnTrack(window);\r\n      chromeShim.shimAddTrackRemoveTrack(window);\r\n      chromeShim.shimGetSendersWithDtmf(window);\r\n\r\n      commonShim.shimRTCIceCandidate(window);\r\n      break;\r\n    case 'firefox':\r\n      if (!firefoxShim || !firefoxShim.shimPeerConnection ||\r\n          !options.shimFirefox) {\r\n        logging('Firefox shim is not included in this adapter release.');\r\n        return adapter;\r\n      }\r\n      logging('adapter.js shimming firefox.');\r\n      // Export to the adapter global object visible in the browser.\r\n      adapter.browserShim = firefoxShim;\r\n      commonShim.shimCreateObjectURL(window);\r\n\r\n      firefoxShim.shimGetUserMedia(window);\r\n      firefoxShim.shimSourceObject(window);\r\n      firefoxShim.shimPeerConnection(window);\r\n      firefoxShim.shimOnTrack(window);\r\n\r\n      commonShim.shimRTCIceCandidate(window);\r\n      break;\r\n    case 'edge':\r\n      if (!edgeShim || !edgeShim.shimPeerConnection || !options.shimEdge) {\r\n        logging('MS edge shim is not included in this adapter release.');\r\n        return adapter;\r\n      }\r\n      logging('adapter.js shimming edge.');\r\n      // Export to the adapter global object visible in the browser.\r\n      adapter.browserShim = edgeShim;\r\n      commonShim.shimCreateObjectURL(window);\r\n\r\n      edgeShim.shimGetUserMedia(window);\r\n      edgeShim.shimPeerConnection(window);\r\n      edgeShim.shimReplaceTrack(window);\r\n\r\n      // the edge shim implements the full RTCIceCandidate object.\r\n      break;\r\n    case 'safari':\r\n      if (!safariShim || !options.shimSafari) {\r\n        logging('Safari shim is not included in this adapter release.');\r\n        return adapter;\r\n      }\r\n      logging('adapter.js shimming safari.');\r\n      // Export to the adapter global object visible in the browser.\r\n      adapter.browserShim = safariShim;\r\n      commonShim.shimCreateObjectURL(window);\r\n\r\n      safariShim.shimRTCIceServerUrls(window);\r\n      safariShim.shimCallbacksAPI(window);\r\n      safariShim.shimLocalStreamsAPI(window);\r\n      safariShim.shimRemoteStreamsAPI(window);\r\n      safariShim.shimTrackEventTransceiver(window);\r\n      safariShim.shimGetUserMedia(window);\r\n      safariShim.shimCreateOfferLegacy(window);\r\n\r\n      commonShim.shimRTCIceCandidate(window);\r\n      break;\r\n    default:\r\n      logging('Unsupported browser!');\r\n      break;\r\n  }\r\n\r\n  return adapter;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/webrtc-adapter/src/js/adapter_factory.js","\r\n/*\r\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\r\n *\r\n *  Use of this source code is governed by a BSD-style license\r\n *  that can be found in the LICENSE file in the root of the source\r\n *  tree.\r\n */\r\n /* eslint-env node */\r\n'use strict';\r\nvar utils = require('../utils.js');\r\nvar logging = utils.log;\r\n\r\nvar chromeShim = {\r\n  shimMediaStream: function(window) {\r\n    window.MediaStream = window.MediaStream || window.webkitMediaStream;\r\n  },\r\n\r\n  shimOnTrack: function(window) {\r\n    if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in\r\n        window.RTCPeerConnection.prototype)) {\r\n      Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\r\n        get: function() {\r\n          return this._ontrack;\r\n        },\r\n        set: function(f) {\r\n          if (this._ontrack) {\r\n            this.removeEventListener('track', this._ontrack);\r\n          }\r\n          this.addEventListener('track', this._ontrack = f);\r\n        }\r\n      });\r\n      var origSetRemoteDescription =\r\n          window.RTCPeerConnection.prototype.setRemoteDescription;\r\n      window.RTCPeerConnection.prototype.setRemoteDescription = function() {\r\n        var pc = this;\r\n        if (!pc._ontrackpoly) {\r\n          pc._ontrackpoly = function(e) {\r\n            // onaddstream does not fire when a track is added to an existing\r\n            // stream. But stream.onaddtrack is implemented so we use that.\r\n            e.stream.addEventListener('addtrack', function(te) {\r\n              var receiver;\r\n              if (window.RTCPeerConnection.prototype.getReceivers) {\r\n                receiver = pc.getReceivers().find(function(r) {\r\n                  return r.track && r.track.id === te.track.id;\r\n                });\r\n              } else {\r\n                receiver = {track: te.track};\r\n              }\r\n\r\n              var event = new Event('track');\r\n              event.track = te.track;\r\n              event.receiver = receiver;\r\n              event.transceiver = {receiver: receiver};\r\n              event.streams = [e.stream];\r\n              pc.dispatchEvent(event);\r\n            });\r\n            e.stream.getTracks().forEach(function(track) {\r\n              var receiver;\r\n              if (window.RTCPeerConnection.prototype.getReceivers) {\r\n                receiver = pc.getReceivers().find(function(r) {\r\n                  return r.track && r.track.id === track.id;\r\n                });\r\n              } else {\r\n                receiver = {track: track};\r\n              }\r\n              var event = new Event('track');\r\n              event.track = track;\r\n              event.receiver = receiver;\r\n              event.transceiver = {receiver: receiver};\r\n              event.streams = [e.stream];\r\n              pc.dispatchEvent(event);\r\n            });\r\n          };\r\n          pc.addEventListener('addstream', pc._ontrackpoly);\r\n        }\r\n        return origSetRemoteDescription.apply(pc, arguments);\r\n      };\r\n    }\r\n  },\r\n\r\n  shimGetSendersWithDtmf: function(window) {\r\n    // Overrides addTrack/removeTrack, depends on shimAddTrackRemoveTrack.\r\n    if (typeof window === 'object' && window.RTCPeerConnection &&\r\n        !('getSenders' in window.RTCPeerConnection.prototype) &&\r\n        'createDTMFSender' in window.RTCPeerConnection.prototype) {\r\n      var shimSenderWithDtmf = function(pc, track) {\r\n        return {\r\n          track: track,\r\n          get dtmf() {\r\n            if (this._dtmf === undefined) {\r\n              if (track.kind === 'audio') {\r\n                this._dtmf = pc.createDTMFSender(track);\r\n              } else {\r\n                this._dtmf = null;\r\n              }\r\n            }\r\n            return this._dtmf;\r\n          },\r\n          _pc: pc\r\n        };\r\n      };\r\n\r\n      // augment addTrack when getSenders is not available.\r\n      if (!window.RTCPeerConnection.prototype.getSenders) {\r\n        window.RTCPeerConnection.prototype.getSenders = function() {\r\n          this._senders = this._senders || [];\r\n          return this._senders.slice(); // return a copy of the internal state.\r\n        };\r\n        var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\r\n        window.RTCPeerConnection.prototype.addTrack = function(track, stream) {\r\n          var pc = this;\r\n          var sender = origAddTrack.apply(pc, arguments);\r\n          if (!sender) {\r\n            sender = shimSenderWithDtmf(pc, track);\r\n            pc._senders.push(sender);\r\n          }\r\n          return sender;\r\n        };\r\n\r\n        var origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\r\n        window.RTCPeerConnection.prototype.removeTrack = function(sender) {\r\n          var pc = this;\r\n          origRemoveTrack.apply(pc, arguments);\r\n          var idx = pc._senders.indexOf(sender);\r\n          if (idx !== -1) {\r\n            pc._senders.splice(idx, 1);\r\n          }\r\n        };\r\n      }\r\n      var origAddStream = window.RTCPeerConnection.prototype.addStream;\r\n      window.RTCPeerConnection.prototype.addStream = function(stream) {\r\n        var pc = this;\r\n        pc._senders = pc._senders || [];\r\n        origAddStream.apply(pc, [stream]);\r\n        stream.getTracks().forEach(function(track) {\r\n          pc._senders.push(shimSenderWithDtmf(pc, track));\r\n        });\r\n      };\r\n\r\n      var origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\r\n      window.RTCPeerConnection.prototype.removeStream = function(stream) {\r\n        var pc = this;\r\n        pc._senders = pc._senders || [];\r\n        origRemoveStream.apply(pc, [stream]);\r\n\r\n        stream.getTracks().forEach(function(track) {\r\n          var sender = pc._senders.find(function(s) {\r\n            return s.track === track;\r\n          });\r\n          if (sender) {\r\n            pc._senders.splice(pc._senders.indexOf(sender), 1); // remove sender\r\n          }\r\n        });\r\n      };\r\n    } else if (typeof window === 'object' && window.RTCPeerConnection &&\r\n               'getSenders' in window.RTCPeerConnection.prototype &&\r\n               'createDTMFSender' in window.RTCPeerConnection.prototype &&\r\n               window.RTCRtpSender &&\r\n               !('dtmf' in window.RTCRtpSender.prototype)) {\r\n      var origGetSenders = window.RTCPeerConnection.prototype.getSenders;\r\n      window.RTCPeerConnection.prototype.getSenders = function() {\r\n        var pc = this;\r\n        var senders = origGetSenders.apply(pc, []);\r\n        senders.forEach(function(sender) {\r\n          sender._pc = pc;\r\n        });\r\n        return senders;\r\n      };\r\n\r\n      Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\r\n        get: function() {\r\n          if (this._dtmf === undefined) {\r\n            if (this.track.kind === 'audio') {\r\n              this._dtmf = this._pc.createDTMFSender(this.track);\r\n            } else {\r\n              this._dtmf = null;\r\n            }\r\n          }\r\n          return this._dtmf;\r\n        }\r\n      });\r\n    }\r\n  },\r\n\r\n  shimSourceObject: function(window) {\r\n    var URL = window && window.URL;\r\n\r\n    if (typeof window === 'object') {\r\n      if (window.HTMLMediaElement &&\r\n        !('srcObject' in window.HTMLMediaElement.prototype)) {\r\n        // Shim the srcObject property, once, when HTMLMediaElement is found.\r\n        Object.defineProperty(window.HTMLMediaElement.prototype, 'srcObject', {\r\n          get: function() {\r\n            return this._srcObject;\r\n          },\r\n          set: function(stream) {\r\n            var self = this;\r\n            // Use _srcObject as a private property for this shim\r\n            this._srcObject = stream;\r\n            if (this.src) {\r\n              URL.revokeObjectURL(this.src);\r\n            }\r\n\r\n            if (!stream) {\r\n              this.src = '';\r\n              return undefined;\r\n            }\r\n            this.src = URL.createObjectURL(stream);\r\n            // We need to recreate the blob url when a track is added or\r\n            // removed. Doing it manually since we want to avoid a recursion.\r\n            stream.addEventListener('addtrack', function() {\r\n              if (self.src) {\r\n                URL.revokeObjectURL(self.src);\r\n              }\r\n              self.src = URL.createObjectURL(stream);\r\n            });\r\n            stream.addEventListener('removetrack', function() {\r\n              if (self.src) {\r\n                URL.revokeObjectURL(self.src);\r\n              }\r\n              self.src = URL.createObjectURL(stream);\r\n            });\r\n          }\r\n        });\r\n      }\r\n    }\r\n  },\r\n\r\n  shimAddTrackRemoveTrack: function(window) {\r\n    var browserDetails = utils.detectBrowser(window);\r\n    // shim addTrack and removeTrack.\r\n    if (window.RTCPeerConnection.prototype.addTrack &&\r\n        browserDetails.version >= 63) {\r\n      return;\r\n    }\r\n\r\n    // also shim pc.getLocalStreams when addTrack is shimmed\r\n    // to return the original streams.\r\n    var origGetLocalStreams = window.RTCPeerConnection.prototype\r\n        .getLocalStreams;\r\n    window.RTCPeerConnection.prototype.getLocalStreams = function() {\r\n      var self = this;\r\n      var nativeStreams = origGetLocalStreams.apply(this);\r\n      self._reverseStreams = self._reverseStreams || {};\r\n      return nativeStreams.map(function(stream) {\r\n        return self._reverseStreams[stream.id];\r\n      });\r\n    };\r\n\r\n    var origAddStream = window.RTCPeerConnection.prototype.addStream;\r\n    window.RTCPeerConnection.prototype.addStream = function(stream) {\r\n      var pc = this;\r\n      pc._streams = pc._streams || {};\r\n      pc._reverseStreams = pc._reverseStreams || {};\r\n\r\n      stream.getTracks().forEach(function(track) {\r\n        var alreadyExists = pc.getSenders().find(function(s) {\r\n          return s.track === track;\r\n        });\r\n        if (alreadyExists) {\r\n          throw new DOMException('Track already exists.',\r\n              'InvalidAccessError');\r\n        }\r\n      });\r\n      // Add identity mapping for consistency with addTrack.\r\n      // Unless this is being used with a stream from addTrack.\r\n      if (!pc._reverseStreams[stream.id]) {\r\n        var newStream = new window.MediaStream(stream.getTracks());\r\n        pc._streams[stream.id] = newStream;\r\n        pc._reverseStreams[newStream.id] = stream;\r\n        stream = newStream;\r\n      }\r\n      origAddStream.apply(pc, [stream]);\r\n    };\r\n\r\n    var origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\r\n    window.RTCPeerConnection.prototype.removeStream = function(stream) {\r\n      var pc = this;\r\n      pc._streams = pc._streams || {};\r\n      pc._reverseStreams = pc._reverseStreams || {};\r\n\r\n      origRemoveStream.apply(pc, [(pc._streams[stream.id] || stream)]);\r\n      delete pc._reverseStreams[(pc._streams[stream.id] ?\r\n          pc._streams[stream.id].id : stream.id)];\r\n      delete pc._streams[stream.id];\r\n    };\r\n\r\n    window.RTCPeerConnection.prototype.addTrack = function(track, stream) {\r\n      var pc = this;\r\n      if (pc.signalingState === 'closed') {\r\n        throw new DOMException(\r\n          'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\r\n          'InvalidStateError');\r\n      }\r\n      var streams = [].slice.call(arguments, 1);\r\n      if (streams.length !== 1 ||\r\n          !streams[0].getTracks().find(function(t) {\r\n            return t === track;\r\n          })) {\r\n        // this is not fully correct but all we can manage without\r\n        // [[associated MediaStreams]] internal slot.\r\n        throw new DOMException(\r\n          'The adapter.js addTrack polyfill only supports a single ' +\r\n          ' stream which is associated with the specified track.',\r\n          'NotSupportedError');\r\n      }\r\n\r\n      var alreadyExists = pc.getSenders().find(function(s) {\r\n        return s.track === track;\r\n      });\r\n      if (alreadyExists) {\r\n        throw new DOMException('Track already exists.',\r\n            'InvalidAccessError');\r\n      }\r\n\r\n      pc._streams = pc._streams || {};\r\n      pc._reverseStreams = pc._reverseStreams || {};\r\n      var oldStream = pc._streams[stream.id];\r\n      if (oldStream) {\r\n        // this is using odd Chrome behaviour, use with caution:\r\n        // https://bugs.chromium.org/p/webrtc/issues/detail?id=7815\r\n        // Note: we rely on the high-level addTrack/dtmf shim to\r\n        // create the sender with a dtmf sender.\r\n        oldStream.addTrack(track);\r\n\r\n        // Trigger ONN async.\r\n        Promise.resolve().then(function() {\r\n          pc.dispatchEvent(new Event('negotiationneeded'));\r\n        });\r\n      } else {\r\n        var newStream = new window.MediaStream([track]);\r\n        pc._streams[stream.id] = newStream;\r\n        pc._reverseStreams[newStream.id] = stream;\r\n        pc.addStream(newStream);\r\n      }\r\n      return pc.getSenders().find(function(s) {\r\n        return s.track === track;\r\n      });\r\n    };\r\n\r\n    // replace the internal stream id with the external one and\r\n    // vice versa.\r\n    function replaceInternalStreamId(pc, description) {\r\n      var sdp = description.sdp;\r\n      Object.keys(pc._reverseStreams || []).forEach(function(internalId) {\r\n        var externalStream = pc._reverseStreams[internalId];\r\n        var internalStream = pc._streams[externalStream.id];\r\n        sdp = sdp.replace(new RegExp(internalStream.id, 'g'),\r\n            externalStream.id);\r\n      });\r\n      return new RTCSessionDescription({\r\n        type: description.type,\r\n        sdp: sdp\r\n      });\r\n    }\r\n    function replaceExternalStreamId(pc, description) {\r\n      var sdp = description.sdp;\r\n      Object.keys(pc._reverseStreams || []).forEach(function(internalId) {\r\n        var externalStream = pc._reverseStreams[internalId];\r\n        var internalStream = pc._streams[externalStream.id];\r\n        sdp = sdp.replace(new RegExp(externalStream.id, 'g'),\r\n            internalStream.id);\r\n      });\r\n      return new RTCSessionDescription({\r\n        type: description.type,\r\n        sdp: sdp\r\n      });\r\n    }\r\n    ['createOffer', 'createAnswer'].forEach(function(method) {\r\n      var nativeMethod = window.RTCPeerConnection.prototype[method];\r\n      window.RTCPeerConnection.prototype[method] = function() {\r\n        var pc = this;\r\n        var args = arguments;\r\n        var isLegacyCall = arguments.length &&\r\n            typeof arguments[0] === 'function';\r\n        if (isLegacyCall) {\r\n          return nativeMethod.apply(pc, [\r\n            function(description) {\r\n              var desc = replaceInternalStreamId(pc, description);\r\n              args[0].apply(null, [desc]);\r\n            },\r\n            function(err) {\r\n              if (args[1]) {\r\n                args[1].apply(null, err);\r\n              }\r\n            }, arguments[2]\r\n          ]);\r\n        }\r\n        return nativeMethod.apply(pc, arguments)\r\n        .then(function(description) {\r\n          return replaceInternalStreamId(pc, description);\r\n        });\r\n      };\r\n    });\r\n\r\n    var origSetLocalDescription =\r\n        window.RTCPeerConnection.prototype.setLocalDescription;\r\n    window.RTCPeerConnection.prototype.setLocalDescription = function() {\r\n      var pc = this;\r\n      if (!arguments.length || !arguments[0].type) {\r\n        return origSetLocalDescription.apply(pc, arguments);\r\n      }\r\n      arguments[0] = replaceExternalStreamId(pc, arguments[0]);\r\n      return origSetLocalDescription.apply(pc, arguments);\r\n    };\r\n\r\n    // TODO: mangle getStats: https://w3c.github.io/webrtc-stats/#dom-rtcmediastreamstats-streamidentifier\r\n\r\n    var origLocalDescription = Object.getOwnPropertyDescriptor(\r\n        window.RTCPeerConnection.prototype, 'localDescription');\r\n    Object.defineProperty(window.RTCPeerConnection.prototype,\r\n        'localDescription', {\r\n          get: function() {\r\n            var pc = this;\r\n            var description = origLocalDescription.get.apply(this);\r\n            if (description.type === '') {\r\n              return description;\r\n            }\r\n            return replaceInternalStreamId(pc, description);\r\n          }\r\n        });\r\n\r\n    window.RTCPeerConnection.prototype.removeTrack = function(sender) {\r\n      var pc = this;\r\n      if (pc.signalingState === 'closed') {\r\n        throw new DOMException(\r\n          'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\r\n          'InvalidStateError');\r\n      }\r\n      // We can not yet check for sender instanceof RTCRtpSender\r\n      // since we shim RTPSender. So we check if sender._pc is set.\r\n      if (!sender._pc) {\r\n        throw new DOMException('Argument 1 of RTCPeerConnection.removeTrack ' +\r\n            'does not implement interface RTCRtpSender.', 'TypeError');\r\n      }\r\n      var isLocal = sender._pc === pc;\r\n      if (!isLocal) {\r\n        throw new DOMException('Sender was not created by this connection.',\r\n            'InvalidAccessError');\r\n      }\r\n\r\n      // Search for the native stream the senders track belongs to.\r\n      pc._streams = pc._streams || {};\r\n      var stream;\r\n      Object.keys(pc._streams).forEach(function(streamid) {\r\n        var hasTrack = pc._streams[streamid].getTracks().find(function(track) {\r\n          return sender.track === track;\r\n        });\r\n        if (hasTrack) {\r\n          stream = pc._streams[streamid];\r\n        }\r\n      });\r\n\r\n      if (stream) {\r\n        if (stream.getTracks().length === 1) {\r\n          // if this is the last track of the stream, remove the stream. This\r\n          // takes care of any shimmed _senders.\r\n          pc.removeStream(pc._reverseStreams[stream.id]);\r\n        } else {\r\n          // relying on the same odd chrome behaviour as above.\r\n          stream.removeTrack(sender.track);\r\n        }\r\n        pc.dispatchEvent(new Event('negotiationneeded'));\r\n      }\r\n    };\r\n  },\r\n\r\n  shimPeerConnection: function(window) {\r\n    var browserDetails = utils.detectBrowser(window);\r\n\r\n    // The RTCPeerConnection object.\r\n    if (!window.RTCPeerConnection) {\r\n      window.RTCPeerConnection = function(pcConfig, pcConstraints) {\r\n        // Translate iceTransportPolicy to iceTransports,\r\n        // see https://code.google.com/p/webrtc/issues/detail?id=4869\r\n        // this was fixed in M56 along with unprefixing RTCPeerConnection.\r\n        logging('PeerConnection');\r\n        if (pcConfig && pcConfig.iceTransportPolicy) {\r\n          pcConfig.iceTransports = pcConfig.iceTransportPolicy;\r\n        }\r\n\r\n        return new window.webkitRTCPeerConnection(pcConfig, pcConstraints);\r\n      };\r\n      window.RTCPeerConnection.prototype =\r\n          window.webkitRTCPeerConnection.prototype;\r\n      // wrap static methods. Currently just generateCertificate.\r\n      if (window.webkitRTCPeerConnection.generateCertificate) {\r\n        Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\r\n          get: function() {\r\n            return window.webkitRTCPeerConnection.generateCertificate;\r\n          }\r\n        });\r\n      }\r\n    } else {\r\n      // migrate from non-spec RTCIceServer.url to RTCIceServer.urls\r\n      var OrigPeerConnection = window.RTCPeerConnection;\r\n      window.RTCPeerConnection = function(pcConfig, pcConstraints) {\r\n        if (pcConfig && pcConfig.iceServers) {\r\n          var newIceServers = [];\r\n          for (var i = 0; i < pcConfig.iceServers.length; i++) {\r\n            var server = pcConfig.iceServers[i];\r\n            if (!server.hasOwnProperty('urls') &&\r\n                server.hasOwnProperty('url')) {\r\n              utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\r\n              server = JSON.parse(JSON.stringify(server));\r\n              server.urls = server.url;\r\n              newIceServers.push(server);\r\n            } else {\r\n              newIceServers.push(pcConfig.iceServers[i]);\r\n            }\r\n          }\r\n          pcConfig.iceServers = newIceServers;\r\n        }\r\n        return new OrigPeerConnection(pcConfig, pcConstraints);\r\n      };\r\n      window.RTCPeerConnection.prototype = OrigPeerConnection.prototype;\r\n      // wrap static methods. Currently just generateCertificate.\r\n      Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\r\n        get: function() {\r\n          return OrigPeerConnection.generateCertificate;\r\n        }\r\n      });\r\n    }\r\n\r\n    var origGetStats = window.RTCPeerConnection.prototype.getStats;\r\n    window.RTCPeerConnection.prototype.getStats = function(selector,\r\n        successCallback, errorCallback) {\r\n      var self = this;\r\n      var args = arguments;\r\n\r\n      // If selector is a function then we are in the old style stats so just\r\n      // pass back the original getStats format to avoid breaking old users.\r\n      if (arguments.length > 0 && typeof selector === 'function') {\r\n        return origGetStats.apply(this, arguments);\r\n      }\r\n\r\n      // When spec-style getStats is supported, return those when called with\r\n      // either no arguments or the selector argument is null.\r\n      if (origGetStats.length === 0 && (arguments.length === 0 ||\r\n          typeof arguments[0] !== 'function')) {\r\n        return origGetStats.apply(this, []);\r\n      }\r\n\r\n      var fixChromeStats_ = function(response) {\r\n        var standardReport = {};\r\n        var reports = response.result();\r\n        reports.forEach(function(report) {\r\n          var standardStats = {\r\n            id: report.id,\r\n            timestamp: report.timestamp,\r\n            type: {\r\n              localcandidate: 'local-candidate',\r\n              remotecandidate: 'remote-candidate'\r\n            }[report.type] || report.type\r\n          };\r\n          report.names().forEach(function(name) {\r\n            standardStats[name] = report.stat(name);\r\n          });\r\n          standardReport[standardStats.id] = standardStats;\r\n        });\r\n\r\n        return standardReport;\r\n      };\r\n\r\n      // shim getStats with maplike support\r\n      var makeMapStats = function(stats) {\r\n        return new Map(Object.keys(stats).map(function(key) {\r\n          return [key, stats[key]];\r\n        }));\r\n      };\r\n\r\n      if (arguments.length >= 2) {\r\n        var successCallbackWrapper_ = function(response) {\r\n          args[1](makeMapStats(fixChromeStats_(response)));\r\n        };\r\n\r\n        return origGetStats.apply(this, [successCallbackWrapper_,\r\n          arguments[0]]);\r\n      }\r\n\r\n      // promise-support\r\n      return new Promise(function(resolve, reject) {\r\n        origGetStats.apply(self, [\r\n          function(response) {\r\n            resolve(makeMapStats(fixChromeStats_(response)));\r\n          }, reject]);\r\n      }).then(successCallback, errorCallback);\r\n    };\r\n\r\n    // add promise support -- natively available in Chrome 51\r\n    if (browserDetails.version < 51) {\r\n      ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\r\n          .forEach(function(method) {\r\n            var nativeMethod = window.RTCPeerConnection.prototype[method];\r\n            window.RTCPeerConnection.prototype[method] = function() {\r\n              var args = arguments;\r\n              var self = this;\r\n              var promise = new Promise(function(resolve, reject) {\r\n                nativeMethod.apply(self, [args[0], resolve, reject]);\r\n              });\r\n              if (args.length < 2) {\r\n                return promise;\r\n              }\r\n              return promise.then(function() {\r\n                args[1].apply(null, []);\r\n              },\r\n              function(err) {\r\n                if (args.length >= 3) {\r\n                  args[2].apply(null, [err]);\r\n                }\r\n              });\r\n            };\r\n          });\r\n    }\r\n\r\n    // promise support for createOffer and createAnswer. Available (without\r\n    // bugs) since M52: crbug/619289\r\n    if (browserDetails.version < 52) {\r\n      ['createOffer', 'createAnswer'].forEach(function(method) {\r\n        var nativeMethod = window.RTCPeerConnection.prototype[method];\r\n        window.RTCPeerConnection.prototype[method] = function() {\r\n          var self = this;\r\n          if (arguments.length < 1 || (arguments.length === 1 &&\r\n              typeof arguments[0] === 'object')) {\r\n            var opts = arguments.length === 1 ? arguments[0] : undefined;\r\n            return new Promise(function(resolve, reject) {\r\n              nativeMethod.apply(self, [resolve, reject, opts]);\r\n            });\r\n          }\r\n          return nativeMethod.apply(this, arguments);\r\n        };\r\n      });\r\n    }\r\n\r\n    // shim implicit creation of RTCSessionDescription/RTCIceCandidate\r\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\r\n        .forEach(function(method) {\r\n          var nativeMethod = window.RTCPeerConnection.prototype[method];\r\n          window.RTCPeerConnection.prototype[method] = function() {\r\n            arguments[0] = new ((method === 'addIceCandidate') ?\r\n                window.RTCIceCandidate :\r\n                window.RTCSessionDescription)(arguments[0]);\r\n            return nativeMethod.apply(this, arguments);\r\n          };\r\n        });\r\n\r\n    // support for addIceCandidate(null or undefined)\r\n    var nativeAddIceCandidate =\r\n        window.RTCPeerConnection.prototype.addIceCandidate;\r\n    window.RTCPeerConnection.prototype.addIceCandidate = function() {\r\n      if (!arguments[0]) {\r\n        if (arguments[1]) {\r\n          arguments[1].apply(null);\r\n        }\r\n        return Promise.resolve();\r\n      }\r\n      return nativeAddIceCandidate.apply(this, arguments);\r\n    };\r\n  }\r\n};\r\n\r\n\r\n// Expose public methods.\r\nmodule.exports = {\r\n  shimMediaStream: chromeShim.shimMediaStream,\r\n  shimOnTrack: chromeShim.shimOnTrack,\r\n  shimAddTrackRemoveTrack: chromeShim.shimAddTrackRemoveTrack,\r\n  shimGetSendersWithDtmf: chromeShim.shimGetSendersWithDtmf,\r\n  shimSourceObject: chromeShim.shimSourceObject,\r\n  shimPeerConnection: chromeShim.shimPeerConnection,\r\n  shimGetUserMedia: require('./getusermedia')\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/webrtc-adapter/src/js/chrome/chrome_shim.js","/*\r\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\r\n *\r\n *  Use of this source code is governed by a BSD-style license\r\n *  that can be found in the LICENSE file in the root of the source\r\n *  tree.\r\n */\r\n /* eslint-env node */\r\n'use strict';\r\nvar utils = require('../utils.js');\r\nvar logging = utils.log;\r\n\r\n// Expose public methods.\r\nmodule.exports = function(window) {\r\n  var browserDetails = utils.detectBrowser(window);\r\n  var navigator = window && window.navigator;\r\n\r\n  var constraintsToChrome_ = function(c) {\r\n    if (typeof c !== 'object' || c.mandatory || c.optional) {\r\n      return c;\r\n    }\r\n    var cc = {};\r\n    Object.keys(c).forEach(function(key) {\r\n      if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\r\n        return;\r\n      }\r\n      var r = (typeof c[key] === 'object') ? c[key] : {ideal: c[key]};\r\n      if (r.exact !== undefined && typeof r.exact === 'number') {\r\n        r.min = r.max = r.exact;\r\n      }\r\n      var oldname_ = function(prefix, name) {\r\n        if (prefix) {\r\n          return prefix + name.charAt(0).toUpperCase() + name.slice(1);\r\n        }\r\n        return (name === 'deviceId') ? 'sourceId' : name;\r\n      };\r\n      if (r.ideal !== undefined) {\r\n        cc.optional = cc.optional || [];\r\n        var oc = {};\r\n        if (typeof r.ideal === 'number') {\r\n          oc[oldname_('min', key)] = r.ideal;\r\n          cc.optional.push(oc);\r\n          oc = {};\r\n          oc[oldname_('max', key)] = r.ideal;\r\n          cc.optional.push(oc);\r\n        } else {\r\n          oc[oldname_('', key)] = r.ideal;\r\n          cc.optional.push(oc);\r\n        }\r\n      }\r\n      if (r.exact !== undefined && typeof r.exact !== 'number') {\r\n        cc.mandatory = cc.mandatory || {};\r\n        cc.mandatory[oldname_('', key)] = r.exact;\r\n      } else {\r\n        ['min', 'max'].forEach(function(mix) {\r\n          if (r[mix] !== undefined) {\r\n            cc.mandatory = cc.mandatory || {};\r\n            cc.mandatory[oldname_(mix, key)] = r[mix];\r\n          }\r\n        });\r\n      }\r\n    });\r\n    if (c.advanced) {\r\n      cc.optional = (cc.optional || []).concat(c.advanced);\r\n    }\r\n    return cc;\r\n  };\r\n\r\n  var shimConstraints_ = function(constraints, func) {\r\n    if (browserDetails.version >= 61) {\r\n      return func(constraints);\r\n    }\r\n    constraints = JSON.parse(JSON.stringify(constraints));\r\n    if (constraints && typeof constraints.audio === 'object') {\r\n      var remap = function(obj, a, b) {\r\n        if (a in obj && !(b in obj)) {\r\n          obj[b] = obj[a];\r\n          delete obj[a];\r\n        }\r\n      };\r\n      constraints = JSON.parse(JSON.stringify(constraints));\r\n      remap(constraints.audio, 'autoGainControl', 'googAutoGainControl');\r\n      remap(constraints.audio, 'noiseSuppression', 'googNoiseSuppression');\r\n      constraints.audio = constraintsToChrome_(constraints.audio);\r\n    }\r\n    if (constraints && typeof constraints.video === 'object') {\r\n      // Shim facingMode for mobile & surface pro.\r\n      var face = constraints.video.facingMode;\r\n      face = face && ((typeof face === 'object') ? face : {ideal: face});\r\n      var getSupportedFacingModeLies = browserDetails.version < 66;\r\n\r\n      if ((face && (face.exact === 'user' || face.exact === 'environment' ||\r\n                    face.ideal === 'user' || face.ideal === 'environment')) &&\r\n          !(navigator.mediaDevices.getSupportedConstraints &&\r\n            navigator.mediaDevices.getSupportedConstraints().facingMode &&\r\n            !getSupportedFacingModeLies)) {\r\n        delete constraints.video.facingMode;\r\n        var matches;\r\n        if (face.exact === 'environment' || face.ideal === 'environment') {\r\n          matches = ['back', 'rear'];\r\n        } else if (face.exact === 'user' || face.ideal === 'user') {\r\n          matches = ['front'];\r\n        }\r\n        if (matches) {\r\n          // Look for matches in label, or use last cam for back (typical).\r\n          return navigator.mediaDevices.enumerateDevices()\r\n          .then(function(devices) {\r\n            devices = devices.filter(function(d) {\r\n              return d.kind === 'videoinput';\r\n            });\r\n            var dev = devices.find(function(d) {\r\n              return matches.some(function(match) {\r\n                return d.label.toLowerCase().indexOf(match) !== -1;\r\n              });\r\n            });\r\n            if (!dev && devices.length && matches.indexOf('back') !== -1) {\r\n              dev = devices[devices.length - 1]; // more likely the back cam\r\n            }\r\n            if (dev) {\r\n              constraints.video.deviceId = face.exact ? {exact: dev.deviceId} :\r\n                                                        {ideal: dev.deviceId};\r\n            }\r\n            constraints.video = constraintsToChrome_(constraints.video);\r\n            logging('chrome: ' + JSON.stringify(constraints));\r\n            return func(constraints);\r\n          });\r\n        }\r\n      }\r\n      constraints.video = constraintsToChrome_(constraints.video);\r\n    }\r\n    logging('chrome: ' + JSON.stringify(constraints));\r\n    return func(constraints);\r\n  };\r\n\r\n  var shimError_ = function(e) {\r\n    return {\r\n      name: {\r\n        PermissionDeniedError: 'NotAllowedError',\r\n        InvalidStateError: 'NotReadableError',\r\n        DevicesNotFoundError: 'NotFoundError',\r\n        ConstraintNotSatisfiedError: 'OverconstrainedError',\r\n        TrackStartError: 'NotReadableError',\r\n        MediaDeviceFailedDueToShutdown: 'NotReadableError',\r\n        MediaDeviceKillSwitchOn: 'NotReadableError'\r\n      }[e.name] || e.name,\r\n      message: e.message,\r\n      constraint: e.constraintName,\r\n      toString: function() {\r\n        return this.name + (this.message && ': ') + this.message;\r\n      }\r\n    };\r\n  };\r\n\r\n  var getUserMedia_ = function(constraints, onSuccess, onError) {\r\n    shimConstraints_(constraints, function(c) {\r\n      navigator.webkitGetUserMedia(c, onSuccess, function(e) {\r\n        if (onError) {\r\n          onError(shimError_(e));\r\n        }\r\n      });\r\n    });\r\n  };\r\n\r\n  navigator.getUserMedia = getUserMedia_;\r\n\r\n  // Returns the result of getUserMedia as a Promise.\r\n  var getUserMediaPromise_ = function(constraints) {\r\n    return new Promise(function(resolve, reject) {\r\n      navigator.getUserMedia(constraints, resolve, reject);\r\n    });\r\n  };\r\n\r\n  if (!navigator.mediaDevices) {\r\n    navigator.mediaDevices = {\r\n      getUserMedia: getUserMediaPromise_,\r\n      enumerateDevices: function() {\r\n        return new Promise(function(resolve) {\r\n          var kinds = {audio: 'audioinput', video: 'videoinput'};\r\n          return window.MediaStreamTrack.getSources(function(devices) {\r\n            resolve(devices.map(function(device) {\r\n              return {label: device.label,\r\n                kind: kinds[device.kind],\r\n                deviceId: device.id,\r\n                groupId: ''};\r\n            }));\r\n          });\r\n        });\r\n      },\r\n      getSupportedConstraints: function() {\r\n        return {\r\n          deviceId: true, echoCancellation: true, facingMode: true,\r\n          frameRate: true, height: true, width: true\r\n        };\r\n      }\r\n    };\r\n  }\r\n\r\n  // A shim for getUserMedia method on the mediaDevices object.\r\n  // TODO(KaptenJansson) remove once implemented in Chrome stable.\r\n  if (!navigator.mediaDevices.getUserMedia) {\r\n    navigator.mediaDevices.getUserMedia = function(constraints) {\r\n      return getUserMediaPromise_(constraints);\r\n    };\r\n  } else {\r\n    // Even though Chrome 45 has navigator.mediaDevices and a getUserMedia\r\n    // function which returns a Promise, it does not accept spec-style\r\n    // constraints.\r\n    var origGetUserMedia = navigator.mediaDevices.getUserMedia.\r\n        bind(navigator.mediaDevices);\r\n    navigator.mediaDevices.getUserMedia = function(cs) {\r\n      return shimConstraints_(cs, function(c) {\r\n        return origGetUserMedia(c).then(function(stream) {\r\n          if (c.audio && !stream.getAudioTracks().length ||\r\n              c.video && !stream.getVideoTracks().length) {\r\n            stream.getTracks().forEach(function(track) {\r\n              track.stop();\r\n            });\r\n            throw new DOMException('', 'NotFoundError');\r\n          }\r\n          return stream;\r\n        }, function(e) {\r\n          return Promise.reject(shimError_(e));\r\n        });\r\n      });\r\n    };\r\n  }\r\n\r\n  // Dummy devicechange event methods.\r\n  // TODO(KaptenJansson) remove once implemented in Chrome stable.\r\n  if (typeof navigator.mediaDevices.addEventListener === 'undefined') {\r\n    navigator.mediaDevices.addEventListener = function() {\r\n      logging('Dummy mediaDevices.addEventListener called.');\r\n    };\r\n  }\r\n  if (typeof navigator.mediaDevices.removeEventListener === 'undefined') {\r\n    navigator.mediaDevices.removeEventListener = function() {\r\n      logging('Dummy mediaDevices.removeEventListener called.');\r\n    };\r\n  }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/webrtc-adapter/src/js/chrome/getusermedia.js","/*\r\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\r\n *\r\n *  Use of this source code is governed by a BSD-style license\r\n *  that can be found in the LICENSE file in the root of the source\r\n *  tree.\r\n */\r\n /* eslint-env node */\r\n'use strict';\r\n\r\nvar utils = require('../utils');\r\nvar shimRTCPeerConnection = require('rtcpeerconnection-shim');\r\n\r\nmodule.exports = {\r\n  shimGetUserMedia: require('./getusermedia'),\r\n  shimPeerConnection: function(window) {\r\n    var browserDetails = utils.detectBrowser(window);\r\n\r\n    if (window.RTCIceGatherer) {\r\n      // ORTC defines an RTCIceCandidate object but no constructor.\r\n      // Not implemented in Edge.\r\n      if (!window.RTCIceCandidate) {\r\n        window.RTCIceCandidate = function(args) {\r\n          return args;\r\n        };\r\n      }\r\n      // ORTC does not have a session description object but\r\n      // other browsers (i.e. Chrome) that will support both PC and ORTC\r\n      // in the future might have this defined already.\r\n      if (!window.RTCSessionDescription) {\r\n        window.RTCSessionDescription = function(args) {\r\n          return args;\r\n        };\r\n      }\r\n      // this adds an additional event listener to MediaStrackTrack that signals\r\n      // when a tracks enabled property was changed. Workaround for a bug in\r\n      // addStream, see below. No longer required in 15025+\r\n      if (browserDetails.version < 15025) {\r\n        var origMSTEnabled = Object.getOwnPropertyDescriptor(\r\n            window.MediaStreamTrack.prototype, 'enabled');\r\n        Object.defineProperty(window.MediaStreamTrack.prototype, 'enabled', {\r\n          set: function(value) {\r\n            origMSTEnabled.set.call(this, value);\r\n            var ev = new Event('enabled');\r\n            ev.enabled = value;\r\n            this.dispatchEvent(ev);\r\n          }\r\n        });\r\n      }\r\n    }\r\n\r\n    // ORTC defines the DTMF sender a bit different.\r\n    // https://github.com/w3c/ortc/issues/714\r\n    if (window.RTCRtpSender && !('dtmf' in window.RTCRtpSender.prototype)) {\r\n      Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\r\n        get: function() {\r\n          if (this._dtmf === undefined) {\r\n            if (this.track.kind === 'audio') {\r\n              this._dtmf = new window.RTCDtmfSender(this);\r\n            } else if (this.track.kind === 'video') {\r\n              this._dtmf = null;\r\n            }\r\n          }\r\n          return this._dtmf;\r\n        }\r\n      });\r\n    }\r\n\r\n    window.RTCPeerConnection =\r\n        shimRTCPeerConnection(window, browserDetails.version);\r\n  },\r\n  shimReplaceTrack: function(window) {\r\n    // ORTC has replaceTrack -- https://github.com/w3c/ortc/issues/614\r\n    if (window.RTCRtpSender &&\r\n        !('replaceTrack' in window.RTCRtpSender.prototype)) {\r\n      window.RTCRtpSender.prototype.replaceTrack =\r\n          window.RTCRtpSender.prototype.setTrack;\r\n    }\r\n  }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/webrtc-adapter/src/js/edge/edge_shim.js","/*\n *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar SDPUtils = require('sdp');\n\nfunction writeMediaSection(transceiver, caps, type, stream, dtlsRole) {\n  var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\n\n  // Map ICE parameters (ufrag, pwd) to SDP.\n  sdp += SDPUtils.writeIceParameters(\n      transceiver.iceGatherer.getLocalParameters());\n\n  // Map DTLS parameters to SDP.\n  sdp += SDPUtils.writeDtlsParameters(\n      transceiver.dtlsTransport.getLocalParameters(),\n      type === 'offer' ? 'actpass' : dtlsRole || 'active');\n\n  sdp += 'a=mid:' + transceiver.mid + '\\r\\n';\n\n  if (transceiver.rtpSender && transceiver.rtpReceiver) {\n    sdp += 'a=sendrecv\\r\\n';\n  } else if (transceiver.rtpSender) {\n    sdp += 'a=sendonly\\r\\n';\n  } else if (transceiver.rtpReceiver) {\n    sdp += 'a=recvonly\\r\\n';\n  } else {\n    sdp += 'a=inactive\\r\\n';\n  }\n\n  if (transceiver.rtpSender) {\n    // spec.\n    var msid = 'msid:' + (stream ? stream.id : '-') + ' ' +\n        transceiver.rtpSender.track.id + '\\r\\n';\n    sdp += 'a=' + msid;\n\n    // for Chrome.\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n        ' ' + msid;\n    if (transceiver.sendEncodingParameters[0].rtx) {\n      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n          ' ' + msid;\n      sdp += 'a=ssrc-group:FID ' +\n          transceiver.sendEncodingParameters[0].ssrc + ' ' +\n          transceiver.sendEncodingParameters[0].rtx.ssrc +\n          '\\r\\n';\n    }\n  }\n  // FIXME: this should be written by writeRtpDescription.\n  sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n      ' cname:' + SDPUtils.localCName + '\\r\\n';\n  if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n        ' cname:' + SDPUtils.localCName + '\\r\\n';\n  }\n  return sdp;\n}\n\n// Edge does not like\n// 1) stun: filtered after 14393 unless ?transport=udp is present\n// 2) turn: that does not have all of turn:host:port?transport=udp\n// 3) turn: with ipv6 addresses\n// 4) turn: occurring muliple times\nfunction filterIceServers(iceServers, edgeVersion) {\n  var hasTurn = false;\n  iceServers = JSON.parse(JSON.stringify(iceServers));\n  return iceServers.filter(function(server) {\n    if (server && (server.urls || server.url)) {\n      var urls = server.urls || server.url;\n      if (server.url && !server.urls) {\n        console.warn('RTCIceServer.url is deprecated! Use urls instead.');\n      }\n      var isString = typeof urls === 'string';\n      if (isString) {\n        urls = [urls];\n      }\n      urls = urls.filter(function(url) {\n        var validTurn = url.indexOf('turn:') === 0 &&\n            url.indexOf('transport=udp') !== -1 &&\n            url.indexOf('turn:[') === -1 &&\n            !hasTurn;\n\n        if (validTurn) {\n          hasTurn = true;\n          return true;\n        }\n        return url.indexOf('stun:') === 0 && edgeVersion >= 14393 &&\n            url.indexOf('?transport=udp') === -1;\n      });\n\n      delete server.url;\n      server.urls = isString ? urls[0] : urls;\n      return !!urls.length;\n    }\n  });\n}\n\n// Determines the intersection of local and remote capabilities.\nfunction getCommonCapabilities(localCapabilities, remoteCapabilities) {\n  var commonCapabilities = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: []\n  };\n\n  var findCodecByPayloadType = function(pt, codecs) {\n    pt = parseInt(pt, 10);\n    for (var i = 0; i < codecs.length; i++) {\n      if (codecs[i].payloadType === pt ||\n          codecs[i].preferredPayloadType === pt) {\n        return codecs[i];\n      }\n    }\n  };\n\n  var rtxCapabilityMatches = function(lRtx, rRtx, lCodecs, rCodecs) {\n    var lCodec = findCodecByPayloadType(lRtx.parameters.apt, lCodecs);\n    var rCodec = findCodecByPayloadType(rRtx.parameters.apt, rCodecs);\n    return lCodec && rCodec &&\n        lCodec.name.toLowerCase() === rCodec.name.toLowerCase();\n  };\n\n  localCapabilities.codecs.forEach(function(lCodec) {\n    for (var i = 0; i < remoteCapabilities.codecs.length; i++) {\n      var rCodec = remoteCapabilities.codecs[i];\n      if (lCodec.name.toLowerCase() === rCodec.name.toLowerCase() &&\n          lCodec.clockRate === rCodec.clockRate) {\n        if (lCodec.name.toLowerCase() === 'rtx' &&\n            lCodec.parameters && rCodec.parameters.apt) {\n          // for RTX we need to find the local rtx that has a apt\n          // which points to the same local codec as the remote one.\n          if (!rtxCapabilityMatches(lCodec, rCodec,\n              localCapabilities.codecs, remoteCapabilities.codecs)) {\n            continue;\n          }\n        }\n        rCodec = JSON.parse(JSON.stringify(rCodec)); // deepcopy\n        // number of channels is the highest common number of channels\n        rCodec.numChannels = Math.min(lCodec.numChannels,\n            rCodec.numChannels);\n        // push rCodec so we reply with offerer payload type\n        commonCapabilities.codecs.push(rCodec);\n\n        // determine common feedback mechanisms\n        rCodec.rtcpFeedback = rCodec.rtcpFeedback.filter(function(fb) {\n          for (var j = 0; j < lCodec.rtcpFeedback.length; j++) {\n            if (lCodec.rtcpFeedback[j].type === fb.type &&\n                lCodec.rtcpFeedback[j].parameter === fb.parameter) {\n              return true;\n            }\n          }\n          return false;\n        });\n        // FIXME: also need to determine .parameters\n        //  see https://github.com/openpeer/ortc/issues/569\n        break;\n      }\n    }\n  });\n\n  localCapabilities.headerExtensions.forEach(function(lHeaderExtension) {\n    for (var i = 0; i < remoteCapabilities.headerExtensions.length;\n         i++) {\n      var rHeaderExtension = remoteCapabilities.headerExtensions[i];\n      if (lHeaderExtension.uri === rHeaderExtension.uri) {\n        commonCapabilities.headerExtensions.push(rHeaderExtension);\n        break;\n      }\n    }\n  });\n\n  // FIXME: fecMechanisms\n  return commonCapabilities;\n}\n\n// is action=setLocalDescription with type allowed in signalingState\nfunction isActionAllowedInSignalingState(action, type, signalingState) {\n  return {\n    offer: {\n      setLocalDescription: ['stable', 'have-local-offer'],\n      setRemoteDescription: ['stable', 'have-remote-offer']\n    },\n    answer: {\n      setLocalDescription: ['have-remote-offer', 'have-local-pranswer'],\n      setRemoteDescription: ['have-local-offer', 'have-remote-pranswer']\n    }\n  }[type][action].indexOf(signalingState) !== -1;\n}\n\nfunction maybeAddCandidate(iceTransport, candidate) {\n  // Edge's internal representation adds some fields therefore\n  // not all field are taken into account.\n  var alreadyAdded = iceTransport.getRemoteCandidates()\n      .find(function(remoteCandidate) {\n        return candidate.foundation === remoteCandidate.foundation &&\n            candidate.ip === remoteCandidate.ip &&\n            candidate.port === remoteCandidate.port &&\n            candidate.priority === remoteCandidate.priority &&\n            candidate.protocol === remoteCandidate.protocol &&\n            candidate.type === remoteCandidate.type;\n      });\n  if (!alreadyAdded) {\n    iceTransport.addRemoteCandidate(candidate);\n  }\n  return !alreadyAdded;\n}\n\n\nfunction makeError(name, description) {\n  var e = new Error(description);\n  e.name = name;\n  return e;\n}\n\nmodule.exports = function(window, edgeVersion) {\n  // https://w3c.github.io/mediacapture-main/#mediastream\n  // Helper function to add the track to the stream and\n  // dispatch the event ourselves.\n  function addTrackToStreamAndFireEvent(track, stream) {\n    stream.addTrack(track);\n    stream.dispatchEvent(new window.MediaStreamTrackEvent('addtrack',\n        {track: track}));\n  }\n\n  function removeTrackFromStreamAndFireEvent(track, stream) {\n    stream.removeTrack(track);\n    stream.dispatchEvent(new window.MediaStreamTrackEvent('removetrack',\n        {track: track}));\n  }\n\n  function fireAddTrack(pc, track, receiver, streams) {\n    var trackEvent = new Event('track');\n    trackEvent.track = track;\n    trackEvent.receiver = receiver;\n    trackEvent.transceiver = {receiver: receiver};\n    trackEvent.streams = streams;\n    window.setTimeout(function() {\n      pc._dispatchEvent('track', trackEvent);\n    });\n  }\n\n  var RTCPeerConnection = function(config) {\n    var pc = this;\n\n    var _eventTarget = document.createDocumentFragment();\n    ['addEventListener', 'removeEventListener', 'dispatchEvent']\n        .forEach(function(method) {\n          pc[method] = _eventTarget[method].bind(_eventTarget);\n        });\n\n    this.canTrickleIceCandidates = null;\n\n    this.needNegotiation = false;\n\n    this.localStreams = [];\n    this.remoteStreams = [];\n\n    this.localDescription = null;\n    this.remoteDescription = null;\n\n    this.signalingState = 'stable';\n    this.iceConnectionState = 'new';\n    this.iceGatheringState = 'new';\n\n    config = JSON.parse(JSON.stringify(config || {}));\n\n    this.usingBundle = config.bundlePolicy === 'max-bundle';\n    if (config.rtcpMuxPolicy === 'negotiate') {\n      throw(makeError('NotSupportedError',\n          'rtcpMuxPolicy \\'negotiate\\' is not supported'));\n    } else if (!config.rtcpMuxPolicy) {\n      config.rtcpMuxPolicy = 'require';\n    }\n\n    switch (config.iceTransportPolicy) {\n      case 'all':\n      case 'relay':\n        break;\n      default:\n        config.iceTransportPolicy = 'all';\n        break;\n    }\n\n    switch (config.bundlePolicy) {\n      case 'balanced':\n      case 'max-compat':\n      case 'max-bundle':\n        break;\n      default:\n        config.bundlePolicy = 'balanced';\n        break;\n    }\n\n    config.iceServers = filterIceServers(config.iceServers || [], edgeVersion);\n\n    this._iceGatherers = [];\n    if (config.iceCandidatePoolSize) {\n      for (var i = config.iceCandidatePoolSize; i > 0; i--) {\n        this._iceGatherers.push(new window.RTCIceGatherer({\n          iceServers: config.iceServers,\n          gatherPolicy: config.iceTransportPolicy\n        }));\n      }\n    } else {\n      config.iceCandidatePoolSize = 0;\n    }\n\n    this._config = config;\n\n    // per-track iceGathers, iceTransports, dtlsTransports, rtpSenders, ...\n    // everything that is needed to describe a SDP m-line.\n    this.transceivers = [];\n\n    this._sdpSessionId = SDPUtils.generateSessionId();\n    this._sdpSessionVersion = 0;\n\n    this._dtlsRole = undefined; // role for a=setup to use in answers.\n\n    this._isClosed = false;\n  };\n\n  // set up event handlers on prototype\n  RTCPeerConnection.prototype.onicecandidate = null;\n  RTCPeerConnection.prototype.onaddstream = null;\n  RTCPeerConnection.prototype.ontrack = null;\n  RTCPeerConnection.prototype.onremovestream = null;\n  RTCPeerConnection.prototype.onsignalingstatechange = null;\n  RTCPeerConnection.prototype.oniceconnectionstatechange = null;\n  RTCPeerConnection.prototype.onicegatheringstatechange = null;\n  RTCPeerConnection.prototype.onnegotiationneeded = null;\n  RTCPeerConnection.prototype.ondatachannel = null;\n\n  RTCPeerConnection.prototype._dispatchEvent = function(name, event) {\n    if (this._isClosed) {\n      return;\n    }\n    this.dispatchEvent(event);\n    if (typeof this['on' + name] === 'function') {\n      this['on' + name](event);\n    }\n  };\n\n  RTCPeerConnection.prototype._emitGatheringStateChange = function() {\n    var event = new Event('icegatheringstatechange');\n    this._dispatchEvent('icegatheringstatechange', event);\n  };\n\n  RTCPeerConnection.prototype.getConfiguration = function() {\n    return this._config;\n  };\n\n  RTCPeerConnection.prototype.getLocalStreams = function() {\n    return this.localStreams;\n  };\n\n  RTCPeerConnection.prototype.getRemoteStreams = function() {\n    return this.remoteStreams;\n  };\n\n  // internal helper to create a transceiver object.\n  // (whih is not yet the same as the WebRTC 1.0 transceiver)\n  RTCPeerConnection.prototype._createTransceiver = function(kind) {\n    var hasBundleTransport = this.transceivers.length > 0;\n    var transceiver = {\n      track: null,\n      iceGatherer: null,\n      iceTransport: null,\n      dtlsTransport: null,\n      localCapabilities: null,\n      remoteCapabilities: null,\n      rtpSender: null,\n      rtpReceiver: null,\n      kind: kind,\n      mid: null,\n      sendEncodingParameters: null,\n      recvEncodingParameters: null,\n      stream: null,\n      associatedRemoteMediaStreams: [],\n      wantReceive: true\n    };\n    if (this.usingBundle && hasBundleTransport) {\n      transceiver.iceTransport = this.transceivers[0].iceTransport;\n      transceiver.dtlsTransport = this.transceivers[0].dtlsTransport;\n    } else {\n      var transports = this._createIceAndDtlsTransports();\n      transceiver.iceTransport = transports.iceTransport;\n      transceiver.dtlsTransport = transports.dtlsTransport;\n    }\n    this.transceivers.push(transceiver);\n    return transceiver;\n  };\n\n  RTCPeerConnection.prototype.addTrack = function(track, stream) {\n    if (this._isClosed) {\n      throw makeError('InvalidStateError',\n          'Attempted to call addTrack on a closed peerconnection.');\n    }\n\n    var alreadyExists = this.transceivers.find(function(s) {\n      return s.track === track;\n    });\n\n    if (alreadyExists) {\n      throw makeError('InvalidAccessError', 'Track already exists.');\n    }\n\n    var transceiver;\n    for (var i = 0; i < this.transceivers.length; i++) {\n      if (!this.transceivers[i].track &&\n          this.transceivers[i].kind === track.kind) {\n        transceiver = this.transceivers[i];\n      }\n    }\n    if (!transceiver) {\n      transceiver = this._createTransceiver(track.kind);\n    }\n\n    this._maybeFireNegotiationNeeded();\n\n    if (this.localStreams.indexOf(stream) === -1) {\n      this.localStreams.push(stream);\n    }\n\n    transceiver.track = track;\n    transceiver.stream = stream;\n    transceiver.rtpSender = new window.RTCRtpSender(track,\n        transceiver.dtlsTransport);\n    return transceiver.rtpSender;\n  };\n\n  RTCPeerConnection.prototype.addStream = function(stream) {\n    var pc = this;\n    if (edgeVersion >= 15025) {\n      stream.getTracks().forEach(function(track) {\n        pc.addTrack(track, stream);\n      });\n    } else {\n      // Clone is necessary for local demos mostly, attaching directly\n      // to two different senders does not work (build 10547).\n      // Fixed in 15025 (or earlier)\n      var clonedStream = stream.clone();\n      stream.getTracks().forEach(function(track, idx) {\n        var clonedTrack = clonedStream.getTracks()[idx];\n        track.addEventListener('enabled', function(event) {\n          clonedTrack.enabled = event.enabled;\n        });\n      });\n      clonedStream.getTracks().forEach(function(track) {\n        pc.addTrack(track, clonedStream);\n      });\n    }\n  };\n\n  RTCPeerConnection.prototype.removeTrack = function(sender) {\n    if (this._isClosed) {\n      throw makeError('InvalidStateError',\n          'Attempted to call removeTrack on a closed peerconnection.');\n    }\n\n    if (!(sender instanceof window.RTCRtpSender)) {\n      throw new TypeError('Argument 1 of RTCPeerConnection.removeTrack ' +\n          'does not implement interface RTCRtpSender.');\n    }\n\n    var transceiver = this.transceivers.find(function(t) {\n      return t.rtpSender === sender;\n    });\n\n    if (!transceiver) {\n      throw makeError('InvalidAccessError',\n          'Sender was not created by this connection.');\n    }\n    var stream = transceiver.stream;\n\n    transceiver.rtpSender.stop();\n    transceiver.rtpSender = null;\n    transceiver.track = null;\n    transceiver.stream = null;\n\n    // remove the stream from the set of local streams\n    var localStreams = this.transceivers.map(function(t) {\n      return t.stream;\n    });\n    if (localStreams.indexOf(stream) === -1 &&\n        this.localStreams.indexOf(stream) > -1) {\n      this.localStreams.splice(this.localStreams.indexOf(stream), 1);\n    }\n\n    this._maybeFireNegotiationNeeded();\n  };\n\n  RTCPeerConnection.prototype.removeStream = function(stream) {\n    var pc = this;\n    stream.getTracks().forEach(function(track) {\n      var sender = pc.getSenders().find(function(s) {\n        return s.track === track;\n      });\n      if (sender) {\n        pc.removeTrack(sender);\n      }\n    });\n  };\n\n  RTCPeerConnection.prototype.getSenders = function() {\n    return this.transceivers.filter(function(transceiver) {\n      return !!transceiver.rtpSender;\n    })\n    .map(function(transceiver) {\n      return transceiver.rtpSender;\n    });\n  };\n\n  RTCPeerConnection.prototype.getReceivers = function() {\n    return this.transceivers.filter(function(transceiver) {\n      return !!transceiver.rtpReceiver;\n    })\n    .map(function(transceiver) {\n      return transceiver.rtpReceiver;\n    });\n  };\n\n\n  RTCPeerConnection.prototype._createIceGatherer = function(sdpMLineIndex,\n      usingBundle) {\n    var pc = this;\n    if (usingBundle && sdpMLineIndex > 0) {\n      return this.transceivers[0].iceGatherer;\n    } else if (this._iceGatherers.length) {\n      return this._iceGatherers.shift();\n    }\n    var iceGatherer = new window.RTCIceGatherer({\n      iceServers: this._config.iceServers,\n      gatherPolicy: this._config.iceTransportPolicy\n    });\n    Object.defineProperty(iceGatherer, 'state',\n        {value: 'new', writable: true}\n    );\n\n    this.transceivers[sdpMLineIndex].bufferedCandidateEvents = [];\n    this.transceivers[sdpMLineIndex].bufferCandidates = function(event) {\n      var end = !event.candidate || Object.keys(event.candidate).length === 0;\n      // polyfill since RTCIceGatherer.state is not implemented in\n      // Edge 10547 yet.\n      iceGatherer.state = end ? 'completed' : 'gathering';\n      if (pc.transceivers[sdpMLineIndex].bufferedCandidateEvents !== null) {\n        pc.transceivers[sdpMLineIndex].bufferedCandidateEvents.push(event);\n      }\n    };\n    iceGatherer.addEventListener('localcandidate',\n      this.transceivers[sdpMLineIndex].bufferCandidates);\n    return iceGatherer;\n  };\n\n  // start gathering from an RTCIceGatherer.\n  RTCPeerConnection.prototype._gather = function(mid, sdpMLineIndex) {\n    var pc = this;\n    var iceGatherer = this.transceivers[sdpMLineIndex].iceGatherer;\n    if (iceGatherer.onlocalcandidate) {\n      return;\n    }\n    var bufferedCandidateEvents =\n      this.transceivers[sdpMLineIndex].bufferedCandidateEvents;\n    this.transceivers[sdpMLineIndex].bufferedCandidateEvents = null;\n    iceGatherer.removeEventListener('localcandidate',\n      this.transceivers[sdpMLineIndex].bufferCandidates);\n    iceGatherer.onlocalcandidate = function(evt) {\n      if (pc.usingBundle && sdpMLineIndex > 0) {\n        // if we know that we use bundle we can drop candidates with\n        // dpMLineIndex > 0. If we don't do this then our state gets\n        // confused since we dispose the extra ice gatherer.\n        return;\n      }\n      var event = new Event('icecandidate');\n      event.candidate = {sdpMid: mid, sdpMLineIndex: sdpMLineIndex};\n\n      var cand = evt.candidate;\n      // Edge emits an empty object for RTCIceCandidateComplete\n      var end = !cand || Object.keys(cand).length === 0;\n      if (end) {\n        // polyfill since RTCIceGatherer.state is not implemented in\n        // Edge 10547 yet.\n        if (iceGatherer.state === 'new' || iceGatherer.state === 'gathering') {\n          iceGatherer.state = 'completed';\n        }\n      } else {\n        if (iceGatherer.state === 'new') {\n          iceGatherer.state = 'gathering';\n        }\n        // RTCIceCandidate doesn't have a component, needs to be added\n        cand.component = 1;\n        var serializedCandidate = SDPUtils.writeCandidate(cand);\n        event.candidate = Object.assign(event.candidate,\n            SDPUtils.parseCandidate(serializedCandidate));\n        event.candidate.candidate = serializedCandidate;\n      }\n\n      // update local description.\n      var sections = SDPUtils.splitSections(pc.localDescription.sdp);\n      if (!end) {\n        sections[event.candidate.sdpMLineIndex + 1] +=\n            'a=' + event.candidate.candidate + '\\r\\n';\n      } else {\n        sections[event.candidate.sdpMLineIndex + 1] +=\n            'a=end-of-candidates\\r\\n';\n      }\n      pc.localDescription.sdp = sections.join('');\n      var complete = pc.transceivers.every(function(transceiver) {\n        return transceiver.iceGatherer &&\n            transceiver.iceGatherer.state === 'completed';\n      });\n\n      if (pc.iceGatheringState !== 'gathering') {\n        pc.iceGatheringState = 'gathering';\n        pc._emitGatheringStateChange();\n      }\n\n      // Emit candidate. Also emit null candidate when all gatherers are\n      // complete.\n      if (!end) {\n        pc._dispatchEvent('icecandidate', event);\n      }\n      if (complete) {\n        pc._dispatchEvent('icecandidate', new Event('icecandidate'));\n        pc.iceGatheringState = 'complete';\n        pc._emitGatheringStateChange();\n      }\n    };\n\n    // emit already gathered candidates.\n    window.setTimeout(function() {\n      bufferedCandidateEvents.forEach(function(e) {\n        iceGatherer.onlocalcandidate(e);\n      });\n    }, 0);\n  };\n\n  // Create ICE transport and DTLS transport.\n  RTCPeerConnection.prototype._createIceAndDtlsTransports = function() {\n    var pc = this;\n    var iceTransport = new window.RTCIceTransport(null);\n    iceTransport.onicestatechange = function() {\n      pc._updateConnectionState();\n    };\n\n    var dtlsTransport = new window.RTCDtlsTransport(iceTransport);\n    dtlsTransport.ondtlsstatechange = function() {\n      pc._updateConnectionState();\n    };\n    dtlsTransport.onerror = function() {\n      // onerror does not set state to failed by itself.\n      Object.defineProperty(dtlsTransport, 'state',\n          {value: 'failed', writable: true});\n      pc._updateConnectionState();\n    };\n\n    return {\n      iceTransport: iceTransport,\n      dtlsTransport: dtlsTransport\n    };\n  };\n\n  // Destroy ICE gatherer, ICE transport and DTLS transport.\n  // Without triggering the callbacks.\n  RTCPeerConnection.prototype._disposeIceAndDtlsTransports = function(\n      sdpMLineIndex) {\n    var iceGatherer = this.transceivers[sdpMLineIndex].iceGatherer;\n    if (iceGatherer) {\n      delete iceGatherer.onlocalcandidate;\n      delete this.transceivers[sdpMLineIndex].iceGatherer;\n    }\n    var iceTransport = this.transceivers[sdpMLineIndex].iceTransport;\n    if (iceTransport) {\n      delete iceTransport.onicestatechange;\n      delete this.transceivers[sdpMLineIndex].iceTransport;\n    }\n    var dtlsTransport = this.transceivers[sdpMLineIndex].dtlsTransport;\n    if (dtlsTransport) {\n      delete dtlsTransport.ondtlsstatechange;\n      delete dtlsTransport.onerror;\n      delete this.transceivers[sdpMLineIndex].dtlsTransport;\n    }\n  };\n\n  // Start the RTP Sender and Receiver for a transceiver.\n  RTCPeerConnection.prototype._transceive = function(transceiver,\n      send, recv) {\n    var params = getCommonCapabilities(transceiver.localCapabilities,\n        transceiver.remoteCapabilities);\n    if (send && transceiver.rtpSender) {\n      params.encodings = transceiver.sendEncodingParameters;\n      params.rtcp = {\n        cname: SDPUtils.localCName,\n        compound: transceiver.rtcpParameters.compound\n      };\n      if (transceiver.recvEncodingParameters.length) {\n        params.rtcp.ssrc = transceiver.recvEncodingParameters[0].ssrc;\n      }\n      transceiver.rtpSender.send(params);\n    }\n    if (recv && transceiver.rtpReceiver && params.codecs.length > 0) {\n      // remove RTX field in Edge 14942\n      if (transceiver.kind === 'video'\n          && transceiver.recvEncodingParameters\n          && edgeVersion < 15019) {\n        transceiver.recvEncodingParameters.forEach(function(p) {\n          delete p.rtx;\n        });\n      }\n      if (transceiver.recvEncodingParameters.length) {\n        params.encodings = transceiver.recvEncodingParameters;\n      }\n      params.rtcp = {\n        compound: transceiver.rtcpParameters.compound\n      };\n      if (transceiver.rtcpParameters.cname) {\n        params.rtcp.cname = transceiver.rtcpParameters.cname;\n      }\n      if (transceiver.sendEncodingParameters.length) {\n        params.rtcp.ssrc = transceiver.sendEncodingParameters[0].ssrc;\n      }\n      transceiver.rtpReceiver.receive(params);\n    }\n  };\n\n  RTCPeerConnection.prototype.setLocalDescription = function(description) {\n    var pc = this;\n\n    // Note: pranswer is not supported.\n    if (['offer', 'answer'].indexOf(description.type) === -1) {\n      return Promise.reject(makeError('TypeError',\n          'Unsupported type \"' + description.type + '\"'));\n    }\n\n    if (!isActionAllowedInSignalingState('setLocalDescription',\n        description.type, pc.signalingState) || pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not set local ' + description.type +\n          ' in state ' + pc.signalingState));\n    }\n\n    var sections;\n    var sessionpart;\n    if (description.type === 'offer') {\n      // VERY limited support for SDP munging. Limited to:\n      // * changing the order of codecs\n      sections = SDPUtils.splitSections(description.sdp);\n      sessionpart = sections.shift();\n      sections.forEach(function(mediaSection, sdpMLineIndex) {\n        var caps = SDPUtils.parseRtpParameters(mediaSection);\n        pc.transceivers[sdpMLineIndex].localCapabilities = caps;\n      });\n\n      pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n        pc._gather(transceiver.mid, sdpMLineIndex);\n      });\n    } else if (description.type === 'answer') {\n      sections = SDPUtils.splitSections(pc.remoteDescription.sdp);\n      sessionpart = sections.shift();\n      var isIceLite = SDPUtils.matchPrefix(sessionpart,\n          'a=ice-lite').length > 0;\n      sections.forEach(function(mediaSection, sdpMLineIndex) {\n        var transceiver = pc.transceivers[sdpMLineIndex];\n        var iceGatherer = transceiver.iceGatherer;\n        var iceTransport = transceiver.iceTransport;\n        var dtlsTransport = transceiver.dtlsTransport;\n        var localCapabilities = transceiver.localCapabilities;\n        var remoteCapabilities = transceiver.remoteCapabilities;\n\n        // treat bundle-only as not-rejected.\n        var rejected = SDPUtils.isRejected(mediaSection) &&\n            SDPUtils.matchPrefix(mediaSection, 'a=bundle-only').length === 0;\n\n        if (!rejected && !transceiver.isDatachannel) {\n          var remoteIceParameters = SDPUtils.getIceParameters(\n              mediaSection, sessionpart);\n          var remoteDtlsParameters = SDPUtils.getDtlsParameters(\n              mediaSection, sessionpart);\n          if (isIceLite) {\n            remoteDtlsParameters.role = 'server';\n          }\n\n          if (!pc.usingBundle || sdpMLineIndex === 0) {\n            pc._gather(transceiver.mid, sdpMLineIndex);\n            if (iceTransport.state === 'new') {\n              iceTransport.start(iceGatherer, remoteIceParameters,\n                  isIceLite ? 'controlling' : 'controlled');\n            }\n            if (dtlsTransport.state === 'new') {\n              dtlsTransport.start(remoteDtlsParameters);\n            }\n          }\n\n          // Calculate intersection of capabilities.\n          var params = getCommonCapabilities(localCapabilities,\n              remoteCapabilities);\n\n          // Start the RTCRtpSender. The RTCRtpReceiver for this\n          // transceiver has already been started in setRemoteDescription.\n          pc._transceive(transceiver,\n              params.codecs.length > 0,\n              false);\n        }\n      });\n    }\n\n    pc.localDescription = {\n      type: description.type,\n      sdp: description.sdp\n    };\n    if (description.type === 'offer') {\n      pc._updateSignalingState('have-local-offer');\n    } else {\n      pc._updateSignalingState('stable');\n    }\n\n    return Promise.resolve();\n  };\n\n  RTCPeerConnection.prototype.setRemoteDescription = function(description) {\n    var pc = this;\n\n    // Note: pranswer is not supported.\n    if (['offer', 'answer'].indexOf(description.type) === -1) {\n      return Promise.reject(makeError('TypeError',\n          'Unsupported type \"' + description.type + '\"'));\n    }\n\n    if (!isActionAllowedInSignalingState('setRemoteDescription',\n        description.type, pc.signalingState) || pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not set remote ' + description.type +\n          ' in state ' + pc.signalingState));\n    }\n\n    var streams = {};\n    pc.remoteStreams.forEach(function(stream) {\n      streams[stream.id] = stream;\n    });\n    var receiverList = [];\n    var sections = SDPUtils.splitSections(description.sdp);\n    var sessionpart = sections.shift();\n    var isIceLite = SDPUtils.matchPrefix(sessionpart,\n        'a=ice-lite').length > 0;\n    var usingBundle = SDPUtils.matchPrefix(sessionpart,\n        'a=group:BUNDLE ').length > 0;\n    pc.usingBundle = usingBundle;\n    var iceOptions = SDPUtils.matchPrefix(sessionpart,\n        'a=ice-options:')[0];\n    if (iceOptions) {\n      pc.canTrickleIceCandidates = iceOptions.substr(14).split(' ')\n          .indexOf('trickle') >= 0;\n    } else {\n      pc.canTrickleIceCandidates = false;\n    }\n\n    sections.forEach(function(mediaSection, sdpMLineIndex) {\n      var lines = SDPUtils.splitLines(mediaSection);\n      var kind = SDPUtils.getKind(mediaSection);\n      // treat bundle-only as not-rejected.\n      var rejected = SDPUtils.isRejected(mediaSection) &&\n          SDPUtils.matchPrefix(mediaSection, 'a=bundle-only').length === 0;\n      var protocol = lines[0].substr(2).split(' ')[2];\n\n      var direction = SDPUtils.getDirection(mediaSection, sessionpart);\n      var remoteMsid = SDPUtils.parseMsid(mediaSection);\n\n      var mid = SDPUtils.getMid(mediaSection) || SDPUtils.generateIdentifier();\n\n      // Reject datachannels which are not implemented yet.\n      if (kind === 'application' && protocol === 'DTLS/SCTP') {\n        pc.transceivers[sdpMLineIndex] = {\n          mid: mid,\n          isDatachannel: true\n        };\n        return;\n      }\n\n      var transceiver;\n      var iceGatherer;\n      var iceTransport;\n      var dtlsTransport;\n      var rtpReceiver;\n      var sendEncodingParameters;\n      var recvEncodingParameters;\n      var localCapabilities;\n\n      var track;\n      // FIXME: ensure the mediaSection has rtcp-mux set.\n      var remoteCapabilities = SDPUtils.parseRtpParameters(mediaSection);\n      var remoteIceParameters;\n      var remoteDtlsParameters;\n      if (!rejected) {\n        remoteIceParameters = SDPUtils.getIceParameters(mediaSection,\n            sessionpart);\n        remoteDtlsParameters = SDPUtils.getDtlsParameters(mediaSection,\n            sessionpart);\n        remoteDtlsParameters.role = 'client';\n      }\n      recvEncodingParameters =\n          SDPUtils.parseRtpEncodingParameters(mediaSection);\n\n      var rtcpParameters = SDPUtils.parseRtcpParameters(mediaSection);\n\n      var isComplete = SDPUtils.matchPrefix(mediaSection,\n          'a=end-of-candidates', sessionpart).length > 0;\n      var cands = SDPUtils.matchPrefix(mediaSection, 'a=candidate:')\n          .map(function(cand) {\n            return SDPUtils.parseCandidate(cand);\n          })\n          .filter(function(cand) {\n            return cand.component === 1;\n          });\n\n      // Check if we can use BUNDLE and dispose transports.\n      if ((description.type === 'offer' || description.type === 'answer') &&\n          !rejected && usingBundle && sdpMLineIndex > 0 &&\n          pc.transceivers[sdpMLineIndex]) {\n        pc._disposeIceAndDtlsTransports(sdpMLineIndex);\n        pc.transceivers[sdpMLineIndex].iceGatherer =\n            pc.transceivers[0].iceGatherer;\n        pc.transceivers[sdpMLineIndex].iceTransport =\n            pc.transceivers[0].iceTransport;\n        pc.transceivers[sdpMLineIndex].dtlsTransport =\n            pc.transceivers[0].dtlsTransport;\n        if (pc.transceivers[sdpMLineIndex].rtpSender) {\n          pc.transceivers[sdpMLineIndex].rtpSender.setTransport(\n              pc.transceivers[0].dtlsTransport);\n        }\n        if (pc.transceivers[sdpMLineIndex].rtpReceiver) {\n          pc.transceivers[sdpMLineIndex].rtpReceiver.setTransport(\n              pc.transceivers[0].dtlsTransport);\n        }\n      }\n      if (description.type === 'offer' && !rejected) {\n        transceiver = pc.transceivers[sdpMLineIndex] ||\n            pc._createTransceiver(kind);\n        transceiver.mid = mid;\n\n        if (!transceiver.iceGatherer) {\n          transceiver.iceGatherer = pc._createIceGatherer(sdpMLineIndex,\n              usingBundle);\n        }\n\n        if (cands.length && transceiver.iceTransport.state === 'new') {\n          if (isComplete && (!usingBundle || sdpMLineIndex === 0)) {\n            transceiver.iceTransport.setRemoteCandidates(cands);\n          } else {\n            cands.forEach(function(candidate) {\n              maybeAddCandidate(transceiver.iceTransport, candidate);\n            });\n          }\n        }\n\n        localCapabilities = window.RTCRtpReceiver.getCapabilities(kind);\n\n        // filter RTX until additional stuff needed for RTX is implemented\n        // in adapter.js\n        if (edgeVersion < 15019) {\n          localCapabilities.codecs = localCapabilities.codecs.filter(\n              function(codec) {\n                return codec.name !== 'rtx';\n              });\n        }\n\n        sendEncodingParameters = transceiver.sendEncodingParameters || [{\n          ssrc: (2 * sdpMLineIndex + 2) * 1001\n        }];\n\n        // TODO: rewrite to use http://w3c.github.io/webrtc-pc/#set-associated-remote-streams\n        var isNewTrack = false;\n        if (direction === 'sendrecv' || direction === 'sendonly') {\n          isNewTrack = !transceiver.rtpReceiver;\n          rtpReceiver = transceiver.rtpReceiver ||\n              new window.RTCRtpReceiver(transceiver.dtlsTransport, kind);\n\n          if (isNewTrack) {\n            var stream;\n            track = rtpReceiver.track;\n            // FIXME: does not work with Plan B.\n            if (remoteMsid && remoteMsid.stream === '-') {\n              // no-op. a stream id of '-' means: no associated stream.\n            } else if (remoteMsid) {\n              if (!streams[remoteMsid.stream]) {\n                streams[remoteMsid.stream] = new window.MediaStream();\n                Object.defineProperty(streams[remoteMsid.stream], 'id', {\n                  get: function() {\n                    return remoteMsid.stream;\n                  }\n                });\n              }\n              Object.defineProperty(track, 'id', {\n                get: function() {\n                  return remoteMsid.track;\n                }\n              });\n              stream = streams[remoteMsid.stream];\n            } else {\n              if (!streams.default) {\n                streams.default = new window.MediaStream();\n              }\n              stream = streams.default;\n            }\n            if (stream) {\n              addTrackToStreamAndFireEvent(track, stream);\n              transceiver.associatedRemoteMediaStreams.push(stream);\n            }\n            receiverList.push([track, rtpReceiver, stream]);\n          }\n        } else if (transceiver.rtpReceiver && transceiver.rtpReceiver.track) {\n          transceiver.associatedRemoteMediaStreams.forEach(function(s) {\n            var nativeTrack = s.getTracks().find(function(t) {\n              return t.id === transceiver.rtpReceiver.track.id;\n            });\n            if (nativeTrack) {\n              removeTrackFromStreamAndFireEvent(nativeTrack, s);\n            }\n          });\n          transceiver.associatedRemoteMediaStreams = [];\n        }\n\n        transceiver.localCapabilities = localCapabilities;\n        transceiver.remoteCapabilities = remoteCapabilities;\n        transceiver.rtpReceiver = rtpReceiver;\n        transceiver.rtcpParameters = rtcpParameters;\n        transceiver.sendEncodingParameters = sendEncodingParameters;\n        transceiver.recvEncodingParameters = recvEncodingParameters;\n\n        // Start the RTCRtpReceiver now. The RTPSender is started in\n        // setLocalDescription.\n        pc._transceive(pc.transceivers[sdpMLineIndex],\n            false,\n            isNewTrack);\n      } else if (description.type === 'answer' && !rejected) {\n        transceiver = pc.transceivers[sdpMLineIndex];\n        iceGatherer = transceiver.iceGatherer;\n        iceTransport = transceiver.iceTransport;\n        dtlsTransport = transceiver.dtlsTransport;\n        rtpReceiver = transceiver.rtpReceiver;\n        sendEncodingParameters = transceiver.sendEncodingParameters;\n        localCapabilities = transceiver.localCapabilities;\n\n        pc.transceivers[sdpMLineIndex].recvEncodingParameters =\n            recvEncodingParameters;\n        pc.transceivers[sdpMLineIndex].remoteCapabilities =\n            remoteCapabilities;\n        pc.transceivers[sdpMLineIndex].rtcpParameters = rtcpParameters;\n\n        if (cands.length && iceTransport.state === 'new') {\n          if ((isIceLite || isComplete) &&\n              (!usingBundle || sdpMLineIndex === 0)) {\n            iceTransport.setRemoteCandidates(cands);\n          } else {\n            cands.forEach(function(candidate) {\n              maybeAddCandidate(transceiver.iceTransport, candidate);\n            });\n          }\n        }\n\n        if (!usingBundle || sdpMLineIndex === 0) {\n          if (iceTransport.state === 'new') {\n            iceTransport.start(iceGatherer, remoteIceParameters,\n                'controlling');\n          }\n          if (dtlsTransport.state === 'new') {\n            dtlsTransport.start(remoteDtlsParameters);\n          }\n        }\n\n        pc._transceive(transceiver,\n            direction === 'sendrecv' || direction === 'recvonly',\n            direction === 'sendrecv' || direction === 'sendonly');\n\n        // TODO: rewrite to use http://w3c.github.io/webrtc-pc/#set-associated-remote-streams\n        if (rtpReceiver &&\n            (direction === 'sendrecv' || direction === 'sendonly')) {\n          track = rtpReceiver.track;\n          if (remoteMsid) {\n            if (!streams[remoteMsid.stream]) {\n              streams[remoteMsid.stream] = new window.MediaStream();\n            }\n            addTrackToStreamAndFireEvent(track, streams[remoteMsid.stream]);\n            receiverList.push([track, rtpReceiver, streams[remoteMsid.stream]]);\n          } else {\n            if (!streams.default) {\n              streams.default = new window.MediaStream();\n            }\n            addTrackToStreamAndFireEvent(track, streams.default);\n            receiverList.push([track, rtpReceiver, streams.default]);\n          }\n        } else {\n          // FIXME: actually the receiver should be created later.\n          delete transceiver.rtpReceiver;\n        }\n      }\n    });\n\n    if (pc._dtlsRole === undefined) {\n      pc._dtlsRole = description.type === 'offer' ? 'active' : 'passive';\n    }\n\n    pc.remoteDescription = {\n      type: description.type,\n      sdp: description.sdp\n    };\n    if (description.type === 'offer') {\n      pc._updateSignalingState('have-remote-offer');\n    } else {\n      pc._updateSignalingState('stable');\n    }\n    Object.keys(streams).forEach(function(sid) {\n      var stream = streams[sid];\n      if (stream.getTracks().length) {\n        if (pc.remoteStreams.indexOf(stream) === -1) {\n          pc.remoteStreams.push(stream);\n          var event = new Event('addstream');\n          event.stream = stream;\n          window.setTimeout(function() {\n            pc._dispatchEvent('addstream', event);\n          });\n        }\n\n        receiverList.forEach(function(item) {\n          var track = item[0];\n          var receiver = item[1];\n          if (stream.id !== item[2].id) {\n            return;\n          }\n          fireAddTrack(pc, track, receiver, [stream]);\n        });\n      }\n    });\n    receiverList.forEach(function(item) {\n      if (item[2]) {\n        return;\n      }\n      fireAddTrack(pc, item[0], item[1], []);\n    });\n\n    // check whether addIceCandidate({}) was called within four seconds after\n    // setRemoteDescription.\n    window.setTimeout(function() {\n      if (!(pc && pc.transceivers)) {\n        return;\n      }\n      pc.transceivers.forEach(function(transceiver) {\n        if (transceiver.iceTransport &&\n            transceiver.iceTransport.state === 'new' &&\n            transceiver.iceTransport.getRemoteCandidates().length > 0) {\n          console.warn('Timeout for addRemoteCandidate. Consider sending ' +\n              'an end-of-candidates notification');\n          transceiver.iceTransport.addRemoteCandidate({});\n        }\n      });\n    }, 4000);\n\n    return Promise.resolve();\n  };\n\n  RTCPeerConnection.prototype.close = function() {\n    this.transceivers.forEach(function(transceiver) {\n      /* not yet\n      if (transceiver.iceGatherer) {\n        transceiver.iceGatherer.close();\n      }\n      */\n      if (transceiver.iceTransport) {\n        transceiver.iceTransport.stop();\n      }\n      if (transceiver.dtlsTransport) {\n        transceiver.dtlsTransport.stop();\n      }\n      if (transceiver.rtpSender) {\n        transceiver.rtpSender.stop();\n      }\n      if (transceiver.rtpReceiver) {\n        transceiver.rtpReceiver.stop();\n      }\n    });\n    // FIXME: clean up tracks, local streams, remote streams, etc\n    this._isClosed = true;\n    this._updateSignalingState('closed');\n  };\n\n  // Update the signaling state.\n  RTCPeerConnection.prototype._updateSignalingState = function(newState) {\n    this.signalingState = newState;\n    var event = new Event('signalingstatechange');\n    this._dispatchEvent('signalingstatechange', event);\n  };\n\n  // Determine whether to fire the negotiationneeded event.\n  RTCPeerConnection.prototype._maybeFireNegotiationNeeded = function() {\n    var pc = this;\n    if (this.signalingState !== 'stable' || this.needNegotiation === true) {\n      return;\n    }\n    this.needNegotiation = true;\n    window.setTimeout(function() {\n      if (pc.needNegotiation) {\n        pc.needNegotiation = false;\n        var event = new Event('negotiationneeded');\n        pc._dispatchEvent('negotiationneeded', event);\n      }\n    }, 0);\n  };\n\n  // Update the connection state.\n  RTCPeerConnection.prototype._updateConnectionState = function() {\n    var newState;\n    var states = {\n      'new': 0,\n      closed: 0,\n      connecting: 0,\n      checking: 0,\n      connected: 0,\n      completed: 0,\n      disconnected: 0,\n      failed: 0\n    };\n    this.transceivers.forEach(function(transceiver) {\n      states[transceiver.iceTransport.state]++;\n      states[transceiver.dtlsTransport.state]++;\n    });\n    // ICETransport.completed and connected are the same for this purpose.\n    states.connected += states.completed;\n\n    newState = 'new';\n    if (states.failed > 0) {\n      newState = 'failed';\n    } else if (states.connecting > 0 || states.checking > 0) {\n      newState = 'connecting';\n    } else if (states.disconnected > 0) {\n      newState = 'disconnected';\n    } else if (states.new > 0) {\n      newState = 'new';\n    } else if (states.connected > 0 || states.completed > 0) {\n      newState = 'connected';\n    }\n\n    if (newState !== this.iceConnectionState) {\n      this.iceConnectionState = newState;\n      var event = new Event('iceconnectionstatechange');\n      this._dispatchEvent('iceconnectionstatechange', event);\n    }\n  };\n\n  RTCPeerConnection.prototype.createOffer = function() {\n    var pc = this;\n\n    if (pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not call createOffer after close'));\n    }\n\n    var numAudioTracks = pc.transceivers.filter(function(t) {\n      return t.kind === 'audio';\n    }).length;\n    var numVideoTracks = pc.transceivers.filter(function(t) {\n      return t.kind === 'video';\n    }).length;\n\n    // Determine number of audio and video tracks we need to send/recv.\n    var offerOptions = arguments[0];\n    if (offerOptions) {\n      // Reject Chrome legacy constraints.\n      if (offerOptions.mandatory || offerOptions.optional) {\n        throw new TypeError(\n            'Legacy mandatory/optional constraints not supported.');\n      }\n      if (offerOptions.offerToReceiveAudio !== undefined) {\n        if (offerOptions.offerToReceiveAudio === true) {\n          numAudioTracks = 1;\n        } else if (offerOptions.offerToReceiveAudio === false) {\n          numAudioTracks = 0;\n        } else {\n          numAudioTracks = offerOptions.offerToReceiveAudio;\n        }\n      }\n      if (offerOptions.offerToReceiveVideo !== undefined) {\n        if (offerOptions.offerToReceiveVideo === true) {\n          numVideoTracks = 1;\n        } else if (offerOptions.offerToReceiveVideo === false) {\n          numVideoTracks = 0;\n        } else {\n          numVideoTracks = offerOptions.offerToReceiveVideo;\n        }\n      }\n    }\n\n    pc.transceivers.forEach(function(transceiver) {\n      if (transceiver.kind === 'audio') {\n        numAudioTracks--;\n        if (numAudioTracks < 0) {\n          transceiver.wantReceive = false;\n        }\n      } else if (transceiver.kind === 'video') {\n        numVideoTracks--;\n        if (numVideoTracks < 0) {\n          transceiver.wantReceive = false;\n        }\n      }\n    });\n\n    // Create M-lines for recvonly streams.\n    while (numAudioTracks > 0 || numVideoTracks > 0) {\n      if (numAudioTracks > 0) {\n        pc._createTransceiver('audio');\n        numAudioTracks--;\n      }\n      if (numVideoTracks > 0) {\n        pc._createTransceiver('video');\n        numVideoTracks--;\n      }\n    }\n\n    var sdp = SDPUtils.writeSessionBoilerplate(pc._sdpSessionId,\n        pc._sdpSessionVersion++);\n    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      // For each track, create an ice gatherer, ice transport,\n      // dtls transport, potentially rtpsender and rtpreceiver.\n      var track = transceiver.track;\n      var kind = transceiver.kind;\n      var mid = transceiver.mid || SDPUtils.generateIdentifier();\n      transceiver.mid = mid;\n\n      if (!transceiver.iceGatherer) {\n        transceiver.iceGatherer = pc._createIceGatherer(sdpMLineIndex,\n            pc.usingBundle);\n      }\n\n      var localCapabilities = window.RTCRtpSender.getCapabilities(kind);\n      // filter RTX until additional stuff needed for RTX is implemented\n      // in adapter.js\n      if (edgeVersion < 15019) {\n        localCapabilities.codecs = localCapabilities.codecs.filter(\n            function(codec) {\n              return codec.name !== 'rtx';\n            });\n      }\n      localCapabilities.codecs.forEach(function(codec) {\n        // work around https://bugs.chromium.org/p/webrtc/issues/detail?id=6552\n        // by adding level-asymmetry-allowed=1\n        if (codec.name === 'H264' &&\n            codec.parameters['level-asymmetry-allowed'] === undefined) {\n          codec.parameters['level-asymmetry-allowed'] = '1';\n        }\n      });\n\n      // generate an ssrc now, to be used later in rtpSender.send\n      var sendEncodingParameters = transceiver.sendEncodingParameters || [{\n        ssrc: (2 * sdpMLineIndex + 1) * 1001\n      }];\n      if (track) {\n        // add RTX\n        if (edgeVersion >= 15019 && kind === 'video' &&\n            !sendEncodingParameters[0].rtx) {\n          sendEncodingParameters[0].rtx = {\n            ssrc: sendEncodingParameters[0].ssrc + 1\n          };\n        }\n      }\n\n      if (transceiver.wantReceive) {\n        transceiver.rtpReceiver = new window.RTCRtpReceiver(\n            transceiver.dtlsTransport, kind);\n      }\n\n      transceiver.localCapabilities = localCapabilities;\n      transceiver.sendEncodingParameters = sendEncodingParameters;\n    });\n\n    // always offer BUNDLE and dispose on return if not supported.\n    if (pc._config.bundlePolicy !== 'max-compat') {\n      sdp += 'a=group:BUNDLE ' + pc.transceivers.map(function(t) {\n        return t.mid;\n      }).join(' ') + '\\r\\n';\n    }\n    sdp += 'a=ice-options:trickle\\r\\n';\n\n    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      sdp += writeMediaSection(transceiver, transceiver.localCapabilities,\n          'offer', transceiver.stream, pc._dtlsRole);\n      sdp += 'a=rtcp-rsize\\r\\n';\n\n      if (transceiver.iceGatherer && pc.iceGatheringState !== 'new' &&\n          (sdpMLineIndex === 0 || !pc.usingBundle)) {\n        transceiver.iceGatherer.getLocalCandidates().forEach(function(cand) {\n          cand.component = 1;\n          sdp += 'a=' + SDPUtils.writeCandidate(cand) + '\\r\\n';\n        });\n\n        if (transceiver.iceGatherer.state === 'completed') {\n          sdp += 'a=end-of-candidates\\r\\n';\n        }\n      }\n    });\n\n    var desc = new window.RTCSessionDescription({\n      type: 'offer',\n      sdp: sdp\n    });\n    return Promise.resolve(desc);\n  };\n\n  RTCPeerConnection.prototype.createAnswer = function() {\n    var pc = this;\n\n    if (pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not call createAnswer after close'));\n    }\n\n    var sdp = SDPUtils.writeSessionBoilerplate(pc._sdpSessionId,\n        pc._sdpSessionVersion++);\n    if (pc.usingBundle) {\n      sdp += 'a=group:BUNDLE ' + pc.transceivers.map(function(t) {\n        return t.mid;\n      }).join(' ') + '\\r\\n';\n    }\n    var mediaSectionsInOffer = SDPUtils.splitSections(\n        pc.remoteDescription.sdp).length - 1;\n    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      if (sdpMLineIndex + 1 > mediaSectionsInOffer) {\n        return;\n      }\n      if (transceiver.isDatachannel) {\n        sdp += 'm=application 0 DTLS/SCTP 5000\\r\\n' +\n            'c=IN IP4 0.0.0.0\\r\\n' +\n            'a=mid:' + transceiver.mid + '\\r\\n';\n        return;\n      }\n\n      // FIXME: look at direction.\n      if (transceiver.stream) {\n        var localTrack;\n        if (transceiver.kind === 'audio') {\n          localTrack = transceiver.stream.getAudioTracks()[0];\n        } else if (transceiver.kind === 'video') {\n          localTrack = transceiver.stream.getVideoTracks()[0];\n        }\n        if (localTrack) {\n          // add RTX\n          if (edgeVersion >= 15019 && transceiver.kind === 'video' &&\n              !transceiver.sendEncodingParameters[0].rtx) {\n            transceiver.sendEncodingParameters[0].rtx = {\n              ssrc: transceiver.sendEncodingParameters[0].ssrc + 1\n            };\n          }\n        }\n      }\n\n      // Calculate intersection of capabilities.\n      var commonCapabilities = getCommonCapabilities(\n          transceiver.localCapabilities,\n          transceiver.remoteCapabilities);\n\n      var hasRtx = commonCapabilities.codecs.filter(function(c) {\n        return c.name.toLowerCase() === 'rtx';\n      }).length;\n      if (!hasRtx && transceiver.sendEncodingParameters[0].rtx) {\n        delete transceiver.sendEncodingParameters[0].rtx;\n      }\n\n      sdp += writeMediaSection(transceiver, commonCapabilities,\n          'answer', transceiver.stream, pc._dtlsRole);\n      if (transceiver.rtcpParameters &&\n          transceiver.rtcpParameters.reducedSize) {\n        sdp += 'a=rtcp-rsize\\r\\n';\n      }\n    });\n\n    var desc = new window.RTCSessionDescription({\n      type: 'answer',\n      sdp: sdp\n    });\n    return Promise.resolve(desc);\n  };\n\n  RTCPeerConnection.prototype.addIceCandidate = function(candidate) {\n    var pc = this;\n    var sections;\n    if (candidate && !(candidate.sdpMLineIndex !== undefined ||\n        candidate.sdpMid)) {\n      return Promise.reject(new TypeError('sdpMLineIndex or sdpMid required'));\n    }\n\n    // TODO: needs to go into ops queue.\n    return new Promise(function(resolve, reject) {\n      if (!pc.remoteDescription) {\n        return reject(makeError('InvalidStateError',\n            'Can not add ICE candidate without a remote description'));\n      } else if (!candidate || candidate.candidate === '') {\n        for (var j = 0; j < pc.transceivers.length; j++) {\n          if (pc.transceivers[j].isDatachannel) {\n            continue;\n          }\n          pc.transceivers[j].iceTransport.addRemoteCandidate({});\n          sections = SDPUtils.splitSections(pc.remoteDescription.sdp);\n          sections[j + 1] += 'a=end-of-candidates\\r\\n';\n          pc.remoteDescription.sdp = sections.join('');\n          if (pc.usingBundle) {\n            break;\n          }\n        }\n      } else {\n        var sdpMLineIndex = candidate.sdpMLineIndex;\n        if (candidate.sdpMid) {\n          for (var i = 0; i < pc.transceivers.length; i++) {\n            if (pc.transceivers[i].mid === candidate.sdpMid) {\n              sdpMLineIndex = i;\n              break;\n            }\n          }\n        }\n        var transceiver = pc.transceivers[sdpMLineIndex];\n        if (transceiver) {\n          if (transceiver.isDatachannel) {\n            return resolve();\n          }\n          var cand = Object.keys(candidate.candidate).length > 0 ?\n              SDPUtils.parseCandidate(candidate.candidate) : {};\n          // Ignore Chrome's invalid candidates since Edge does not like them.\n          if (cand.protocol === 'tcp' && (cand.port === 0 || cand.port === 9)) {\n            return resolve();\n          }\n          // Ignore RTCP candidates, we assume RTCP-MUX.\n          if (cand.component && cand.component !== 1) {\n            return resolve();\n          }\n          // when using bundle, avoid adding candidates to the wrong\n          // ice transport. And avoid adding candidates added in the SDP.\n          if (sdpMLineIndex === 0 || (sdpMLineIndex > 0 &&\n              transceiver.iceTransport !== pc.transceivers[0].iceTransport)) {\n            if (!maybeAddCandidate(transceiver.iceTransport, cand)) {\n              return reject(makeError('OperationError',\n                  'Can not add ICE candidate'));\n            }\n          }\n\n          // update the remoteDescription.\n          var candidateString = candidate.candidate.trim();\n          if (candidateString.indexOf('a=') === 0) {\n            candidateString = candidateString.substr(2);\n          }\n          sections = SDPUtils.splitSections(pc.remoteDescription.sdp);\n          sections[sdpMLineIndex + 1] += 'a=' +\n              (cand.type ? candidateString : 'end-of-candidates')\n              + '\\r\\n';\n          pc.remoteDescription.sdp = sections.join('');\n        } else {\n          return reject(makeError('OperationError',\n              'Can not add ICE candidate'));\n        }\n      }\n      resolve();\n    });\n  };\n\n  RTCPeerConnection.prototype.getStats = function() {\n    var promises = [];\n    this.transceivers.forEach(function(transceiver) {\n      ['rtpSender', 'rtpReceiver', 'iceGatherer', 'iceTransport',\n          'dtlsTransport'].forEach(function(method) {\n            if (transceiver[method]) {\n              promises.push(transceiver[method].getStats());\n            }\n          });\n    });\n    var fixStatsType = function(stat) {\n      return {\n        inboundrtp: 'inbound-rtp',\n        outboundrtp: 'outbound-rtp',\n        candidatepair: 'candidate-pair',\n        localcandidate: 'local-candidate',\n        remotecandidate: 'remote-candidate'\n      }[stat.type] || stat.type;\n    };\n    return new Promise(function(resolve) {\n      // shim getStats with maplike support\n      var results = new Map();\n      Promise.all(promises).then(function(res) {\n        res.forEach(function(result) {\n          Object.keys(result).forEach(function(id) {\n            result[id].type = fixStatsType(result[id]);\n            results.set(id, result[id]);\n          });\n        });\n        resolve(results);\n      });\n    });\n  };\n\n  // legacy callback shims. Should be moved to adapter.js some days.\n  var methods = ['createOffer', 'createAnswer'];\n  methods.forEach(function(method) {\n    var nativeMethod = RTCPeerConnection.prototype[method];\n    RTCPeerConnection.prototype[method] = function() {\n      var args = arguments;\n      if (typeof args[0] === 'function' ||\n          typeof args[1] === 'function') { // legacy\n        return nativeMethod.apply(this, [arguments[2]])\n        .then(function(description) {\n          if (typeof args[0] === 'function') {\n            args[0].apply(null, [description]);\n          }\n        }, function(error) {\n          if (typeof args[1] === 'function') {\n            args[1].apply(null, [error]);\n          }\n        });\n      }\n      return nativeMethod.apply(this, arguments);\n    };\n  });\n\n  methods = ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate'];\n  methods.forEach(function(method) {\n    var nativeMethod = RTCPeerConnection.prototype[method];\n    RTCPeerConnection.prototype[method] = function() {\n      var args = arguments;\n      if (typeof args[1] === 'function' ||\n          typeof args[2] === 'function') { // legacy\n        return nativeMethod.apply(this, arguments)\n        .then(function() {\n          if (typeof args[1] === 'function') {\n            args[1].apply(null);\n          }\n        }, function(error) {\n          if (typeof args[2] === 'function') {\n            args[2].apply(null, [error]);\n          }\n        });\n      }\n      return nativeMethod.apply(this, arguments);\n    };\n  });\n\n  // getStats is special. It doesn't have a spec legacy method yet we support\n  // getStats(something, cb) without error callbacks.\n  ['getStats'].forEach(function(method) {\n    var nativeMethod = RTCPeerConnection.prototype[method];\n    RTCPeerConnection.prototype[method] = function() {\n      var args = arguments;\n      if (typeof args[1] === 'function') {\n        return nativeMethod.apply(this, arguments)\n        .then(function() {\n          if (typeof args[1] === 'function') {\n            args[1].apply(null);\n          }\n        });\n      }\n      return nativeMethod.apply(this, arguments);\n    };\n  });\n\n  return RTCPeerConnection;\n};\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/rtcpeerconnection-shim/rtcpeerconnection.js","module.exports = function(module) {\r\n\tif(!module.webpackPolyfill) {\r\n\t\tmodule.deprecate = function() {};\r\n\t\tmodule.paths = [];\r\n\t\t// module.parent = undefined by default\r\n\t\tif(!module.children) module.children = [];\r\n\t\tObject.defineProperty(module, \"loaded\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.l;\r\n\t\t\t}\r\n\t\t});\r\n\t\tObject.defineProperty(module, \"id\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.i;\r\n\t\t\t}\r\n\t\t});\r\n\t\tmodule.webpackPolyfill = 1;\r\n\t}\r\n\treturn module;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// (webpack)/buildin/module.js","/*\r\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\r\n *\r\n *  Use of this source code is governed by a BSD-style license\r\n *  that can be found in the LICENSE file in the root of the source\r\n *  tree.\r\n */\r\n /* eslint-env node */\r\n'use strict';\r\n\r\n// Expose public methods.\r\nmodule.exports = function(window) {\r\n  var navigator = window && window.navigator;\r\n\r\n  var shimError_ = function(e) {\r\n    return {\r\n      name: {PermissionDeniedError: 'NotAllowedError'}[e.name] || e.name,\r\n      message: e.message,\r\n      constraint: e.constraint,\r\n      toString: function() {\r\n        return this.name;\r\n      }\r\n    };\r\n  };\r\n\r\n  // getUserMedia error shim.\r\n  var origGetUserMedia = navigator.mediaDevices.getUserMedia.\r\n      bind(navigator.mediaDevices);\r\n  navigator.mediaDevices.getUserMedia = function(c) {\r\n    return origGetUserMedia(c).catch(function(e) {\r\n      return Promise.reject(shimError_(e));\r\n    });\r\n  };\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/webrtc-adapter/src/js/edge/getusermedia.js","/*\r\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\r\n *\r\n *  Use of this source code is governed by a BSD-style license\r\n *  that can be found in the LICENSE file in the root of the source\r\n *  tree.\r\n */\r\n /* eslint-env node */\r\n'use strict';\r\n\r\nvar utils = require('../utils');\r\n\r\nvar firefoxShim = {\r\n  shimOnTrack: function(window) {\r\n    if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in\r\n        window.RTCPeerConnection.prototype)) {\r\n      Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\r\n        get: function() {\r\n          return this._ontrack;\r\n        },\r\n        set: function(f) {\r\n          if (this._ontrack) {\r\n            this.removeEventListener('track', this._ontrack);\r\n            this.removeEventListener('addstream', this._ontrackpoly);\r\n          }\r\n          this.addEventListener('track', this._ontrack = f);\r\n          this.addEventListener('addstream', this._ontrackpoly = function(e) {\r\n            e.stream.getTracks().forEach(function(track) {\r\n              var event = new Event('track');\r\n              event.track = track;\r\n              event.receiver = {track: track};\r\n              event.transceiver = {receiver: event.receiver};\r\n              event.streams = [e.stream];\r\n              this.dispatchEvent(event);\r\n            }.bind(this));\r\n          }.bind(this));\r\n        }\r\n      });\r\n    }\r\n    if (typeof window === 'object' && window.RTCTrackEvent &&\r\n        ('receiver' in window.RTCTrackEvent.prototype) &&\r\n        !('transceiver' in window.RTCTrackEvent.prototype)) {\r\n      Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\r\n        get: function() {\r\n          return {receiver: this.receiver};\r\n        }\r\n      });\r\n    }\r\n  },\r\n\r\n  shimSourceObject: function(window) {\r\n    // Firefox has supported mozSrcObject since FF22, unprefixed in 42.\r\n    if (typeof window === 'object') {\r\n      if (window.HTMLMediaElement &&\r\n        !('srcObject' in window.HTMLMediaElement.prototype)) {\r\n        // Shim the srcObject property, once, when HTMLMediaElement is found.\r\n        Object.defineProperty(window.HTMLMediaElement.prototype, 'srcObject', {\r\n          get: function() {\r\n            return this.mozSrcObject;\r\n          },\r\n          set: function(stream) {\r\n            this.mozSrcObject = stream;\r\n          }\r\n        });\r\n      }\r\n    }\r\n  },\r\n\r\n  shimPeerConnection: function(window) {\r\n    var browserDetails = utils.detectBrowser(window);\r\n\r\n    if (typeof window !== 'object' || !(window.RTCPeerConnection ||\r\n        window.mozRTCPeerConnection)) {\r\n      return; // probably media.peerconnection.enabled=false in about:config\r\n    }\r\n    // The RTCPeerConnection object.\r\n    if (!window.RTCPeerConnection) {\r\n      window.RTCPeerConnection = function(pcConfig, pcConstraints) {\r\n        if (browserDetails.version < 38) {\r\n          // .urls is not supported in FF < 38.\r\n          // create RTCIceServers with a single url.\r\n          if (pcConfig && pcConfig.iceServers) {\r\n            var newIceServers = [];\r\n            for (var i = 0; i < pcConfig.iceServers.length; i++) {\r\n              var server = pcConfig.iceServers[i];\r\n              if (server.hasOwnProperty('urls')) {\r\n                for (var j = 0; j < server.urls.length; j++) {\r\n                  var newServer = {\r\n                    url: server.urls[j]\r\n                  };\r\n                  if (server.urls[j].indexOf('turn') === 0) {\r\n                    newServer.username = server.username;\r\n                    newServer.credential = server.credential;\r\n                  }\r\n                  newIceServers.push(newServer);\r\n                }\r\n              } else {\r\n                newIceServers.push(pcConfig.iceServers[i]);\r\n              }\r\n            }\r\n            pcConfig.iceServers = newIceServers;\r\n          }\r\n        }\r\n        return new window.mozRTCPeerConnection(pcConfig, pcConstraints);\r\n      };\r\n      window.RTCPeerConnection.prototype =\r\n          window.mozRTCPeerConnection.prototype;\r\n\r\n      // wrap static methods. Currently just generateCertificate.\r\n      if (window.mozRTCPeerConnection.generateCertificate) {\r\n        Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\r\n          get: function() {\r\n            return window.mozRTCPeerConnection.generateCertificate;\r\n          }\r\n        });\r\n      }\r\n\r\n      window.RTCSessionDescription = window.mozRTCSessionDescription;\r\n      window.RTCIceCandidate = window.mozRTCIceCandidate;\r\n    }\r\n\r\n    // shim away need for obsolete RTCIceCandidate/RTCSessionDescription.\r\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\r\n        .forEach(function(method) {\r\n          var nativeMethod = window.RTCPeerConnection.prototype[method];\r\n          window.RTCPeerConnection.prototype[method] = function() {\r\n            arguments[0] = new ((method === 'addIceCandidate') ?\r\n                window.RTCIceCandidate :\r\n                window.RTCSessionDescription)(arguments[0]);\r\n            return nativeMethod.apply(this, arguments);\r\n          };\r\n        });\r\n\r\n    // support for addIceCandidate(null or undefined)\r\n    var nativeAddIceCandidate =\r\n        window.RTCPeerConnection.prototype.addIceCandidate;\r\n    window.RTCPeerConnection.prototype.addIceCandidate = function() {\r\n      if (!arguments[0]) {\r\n        if (arguments[1]) {\r\n          arguments[1].apply(null);\r\n        }\r\n        return Promise.resolve();\r\n      }\r\n      return nativeAddIceCandidate.apply(this, arguments);\r\n    };\r\n\r\n    // shim getStats with maplike support\r\n    var makeMapStats = function(stats) {\r\n      var map = new Map();\r\n      Object.keys(stats).forEach(function(key) {\r\n        map.set(key, stats[key]);\r\n        map[key] = stats[key];\r\n      });\r\n      return map;\r\n    };\r\n\r\n    var modernStatsTypes = {\r\n      inboundrtp: 'inbound-rtp',\r\n      outboundrtp: 'outbound-rtp',\r\n      candidatepair: 'candidate-pair',\r\n      localcandidate: 'local-candidate',\r\n      remotecandidate: 'remote-candidate'\r\n    };\r\n\r\n    var nativeGetStats = window.RTCPeerConnection.prototype.getStats;\r\n    window.RTCPeerConnection.prototype.getStats = function(\r\n      selector,\r\n      onSucc,\r\n      onErr\r\n    ) {\r\n      return nativeGetStats.apply(this, [selector || null])\r\n        .then(function(stats) {\r\n          if (browserDetails.version < 48) {\r\n            stats = makeMapStats(stats);\r\n          }\r\n          if (browserDetails.version < 53 && !onSucc) {\r\n            // Shim only promise getStats with spec-hyphens in type names\r\n            // Leave callback version alone; misc old uses of forEach before Map\r\n            try {\r\n              stats.forEach(function(stat) {\r\n                stat.type = modernStatsTypes[stat.type] || stat.type;\r\n              });\r\n            } catch (e) {\r\n              if (e.name !== 'TypeError') {\r\n                throw e;\r\n              }\r\n              // Avoid TypeError: \"type\" is read-only, in old versions. 34-43ish\r\n              stats.forEach(function(stat, i) {\r\n                stats.set(i, Object.assign({}, stat, {\r\n                  type: modernStatsTypes[stat.type] || stat.type\r\n                }));\r\n              });\r\n            }\r\n          }\r\n          return stats;\r\n        })\r\n        .then(onSucc, onErr);\r\n    };\r\n  }\r\n};\r\n\r\n// Expose public methods.\r\nmodule.exports = {\r\n  shimOnTrack: firefoxShim.shimOnTrack,\r\n  shimSourceObject: firefoxShim.shimSourceObject,\r\n  shimPeerConnection: firefoxShim.shimPeerConnection,\r\n  shimGetUserMedia: require('./getusermedia')\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/webrtc-adapter/src/js/firefox/firefox_shim.js","/*\r\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\r\n *\r\n *  Use of this source code is governed by a BSD-style license\r\n *  that can be found in the LICENSE file in the root of the source\r\n *  tree.\r\n */\r\n /* eslint-env node */\r\n'use strict';\r\n\r\nvar utils = require('../utils');\r\nvar logging = utils.log;\r\n\r\n// Expose public methods.\r\nmodule.exports = function(window) {\r\n  var browserDetails = utils.detectBrowser(window);\r\n  var navigator = window && window.navigator;\r\n  var MediaStreamTrack = window && window.MediaStreamTrack;\r\n\r\n  var shimError_ = function(e) {\r\n    return {\r\n      name: {\r\n        InternalError: 'NotReadableError',\r\n        NotSupportedError: 'TypeError',\r\n        PermissionDeniedError: 'NotAllowedError',\r\n        SecurityError: 'NotAllowedError'\r\n      }[e.name] || e.name,\r\n      message: {\r\n        'The operation is insecure.': 'The request is not allowed by the ' +\r\n        'user agent or the platform in the current context.'\r\n      }[e.message] || e.message,\r\n      constraint: e.constraint,\r\n      toString: function() {\r\n        return this.name + (this.message && ': ') + this.message;\r\n      }\r\n    };\r\n  };\r\n\r\n  // getUserMedia constraints shim.\r\n  var getUserMedia_ = function(constraints, onSuccess, onError) {\r\n    var constraintsToFF37_ = function(c) {\r\n      if (typeof c !== 'object' || c.require) {\r\n        return c;\r\n      }\r\n      var require = [];\r\n      Object.keys(c).forEach(function(key) {\r\n        if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\r\n          return;\r\n        }\r\n        var r = c[key] = (typeof c[key] === 'object') ?\r\n            c[key] : {ideal: c[key]};\r\n        if (r.min !== undefined ||\r\n            r.max !== undefined || r.exact !== undefined) {\r\n          require.push(key);\r\n        }\r\n        if (r.exact !== undefined) {\r\n          if (typeof r.exact === 'number') {\r\n            r. min = r.max = r.exact;\r\n          } else {\r\n            c[key] = r.exact;\r\n          }\r\n          delete r.exact;\r\n        }\r\n        if (r.ideal !== undefined) {\r\n          c.advanced = c.advanced || [];\r\n          var oc = {};\r\n          if (typeof r.ideal === 'number') {\r\n            oc[key] = {min: r.ideal, max: r.ideal};\r\n          } else {\r\n            oc[key] = r.ideal;\r\n          }\r\n          c.advanced.push(oc);\r\n          delete r.ideal;\r\n          if (!Object.keys(r).length) {\r\n            delete c[key];\r\n          }\r\n        }\r\n      });\r\n      if (require.length) {\r\n        c.require = require;\r\n      }\r\n      return c;\r\n    };\r\n    constraints = JSON.parse(JSON.stringify(constraints));\r\n    if (browserDetails.version < 38) {\r\n      logging('spec: ' + JSON.stringify(constraints));\r\n      if (constraints.audio) {\r\n        constraints.audio = constraintsToFF37_(constraints.audio);\r\n      }\r\n      if (constraints.video) {\r\n        constraints.video = constraintsToFF37_(constraints.video);\r\n      }\r\n      logging('ff37: ' + JSON.stringify(constraints));\r\n    }\r\n    return navigator.mozGetUserMedia(constraints, onSuccess, function(e) {\r\n      onError(shimError_(e));\r\n    });\r\n  };\r\n\r\n  // Returns the result of getUserMedia as a Promise.\r\n  var getUserMediaPromise_ = function(constraints) {\r\n    return new Promise(function(resolve, reject) {\r\n      getUserMedia_(constraints, resolve, reject);\r\n    });\r\n  };\r\n\r\n  // Shim for mediaDevices on older versions.\r\n  if (!navigator.mediaDevices) {\r\n    navigator.mediaDevices = {getUserMedia: getUserMediaPromise_,\r\n      addEventListener: function() { },\r\n      removeEventListener: function() { }\r\n    };\r\n  }\r\n  navigator.mediaDevices.enumerateDevices =\r\n      navigator.mediaDevices.enumerateDevices || function() {\r\n        return new Promise(function(resolve) {\r\n          var infos = [\r\n            {kind: 'audioinput', deviceId: 'default', label: '', groupId: ''},\r\n            {kind: 'videoinput', deviceId: 'default', label: '', groupId: ''}\r\n          ];\r\n          resolve(infos);\r\n        });\r\n      };\r\n\r\n  if (browserDetails.version < 41) {\r\n    // Work around http://bugzil.la/1169665\r\n    var orgEnumerateDevices =\r\n        navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);\r\n    navigator.mediaDevices.enumerateDevices = function() {\r\n      return orgEnumerateDevices().then(undefined, function(e) {\r\n        if (e.name === 'NotFoundError') {\r\n          return [];\r\n        }\r\n        throw e;\r\n      });\r\n    };\r\n  }\r\n  if (browserDetails.version < 49) {\r\n    var origGetUserMedia = navigator.mediaDevices.getUserMedia.\r\n        bind(navigator.mediaDevices);\r\n    navigator.mediaDevices.getUserMedia = function(c) {\r\n      return origGetUserMedia(c).then(function(stream) {\r\n        // Work around https://bugzil.la/802326\r\n        if (c.audio && !stream.getAudioTracks().length ||\r\n            c.video && !stream.getVideoTracks().length) {\r\n          stream.getTracks().forEach(function(track) {\r\n            track.stop();\r\n          });\r\n          throw new DOMException('The object can not be found here.',\r\n                                 'NotFoundError');\r\n        }\r\n        return stream;\r\n      }, function(e) {\r\n        return Promise.reject(shimError_(e));\r\n      });\r\n    };\r\n  }\r\n  if (!(browserDetails.version > 55 &&\r\n      'autoGainControl' in navigator.mediaDevices.getSupportedConstraints())) {\r\n    var remap = function(obj, a, b) {\r\n      if (a in obj && !(b in obj)) {\r\n        obj[b] = obj[a];\r\n        delete obj[a];\r\n      }\r\n    };\r\n\r\n    var nativeGetUserMedia = navigator.mediaDevices.getUserMedia.\r\n        bind(navigator.mediaDevices);\r\n    navigator.mediaDevices.getUserMedia = function(c) {\r\n      if (typeof c === 'object' && typeof c.audio === 'object') {\r\n        c = JSON.parse(JSON.stringify(c));\r\n        remap(c.audio, 'autoGainControl', 'mozAutoGainControl');\r\n        remap(c.audio, 'noiseSuppression', 'mozNoiseSuppression');\r\n      }\r\n      return nativeGetUserMedia(c);\r\n    };\r\n\r\n    if (MediaStreamTrack && MediaStreamTrack.prototype.getSettings) {\r\n      var nativeGetSettings = MediaStreamTrack.prototype.getSettings;\r\n      MediaStreamTrack.prototype.getSettings = function() {\r\n        var obj = nativeGetSettings.apply(this, arguments);\r\n        remap(obj, 'mozAutoGainControl', 'autoGainControl');\r\n        remap(obj, 'mozNoiseSuppression', 'noiseSuppression');\r\n        return obj;\r\n      };\r\n    }\r\n\r\n    if (MediaStreamTrack && MediaStreamTrack.prototype.applyConstraints) {\r\n      var nativeApplyConstraints = MediaStreamTrack.prototype.applyConstraints;\r\n      MediaStreamTrack.prototype.applyConstraints = function(c) {\r\n        if (this.kind === 'audio' && typeof c === 'object') {\r\n          c = JSON.parse(JSON.stringify(c));\r\n          remap(c, 'autoGainControl', 'mozAutoGainControl');\r\n          remap(c, 'noiseSuppression', 'mozNoiseSuppression');\r\n        }\r\n        return nativeApplyConstraints.apply(this, [c]);\r\n      };\r\n    }\r\n  }\r\n  navigator.getUserMedia = function(constraints, onSuccess, onError) {\r\n    if (browserDetails.version < 44) {\r\n      return getUserMedia_(constraints, onSuccess, onError);\r\n    }\r\n    // Replace Firefox 44+'s deprecation warning with unprefixed version.\r\n    utils.deprecated('navigator.getUserMedia',\r\n        'navigator.mediaDevices.getUserMedia');\r\n    navigator.mediaDevices.getUserMedia(constraints).then(onSuccess, onError);\r\n  };\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/webrtc-adapter/src/js/firefox/getusermedia.js","/*\r\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\r\n *\r\n *  Use of this source code is governed by a BSD-style license\r\n *  that can be found in the LICENSE file in the root of the source\r\n *  tree.\r\n */\r\n'use strict';\r\nvar utils = require('../utils');\r\n\r\nvar safariShim = {\r\n  // TODO: DrAlex, should be here, double check against LayoutTests\r\n\r\n  // TODO: once the back-end for the mac port is done, add.\r\n  // TODO: check for webkitGTK+\r\n  // shimPeerConnection: function() { },\r\n\r\n  shimLocalStreamsAPI: function(window) {\r\n    if (typeof window !== 'object' || !window.RTCPeerConnection) {\r\n      return;\r\n    }\r\n    if (!('getLocalStreams' in window.RTCPeerConnection.prototype)) {\r\n      window.RTCPeerConnection.prototype.getLocalStreams = function() {\r\n        if (!this._localStreams) {\r\n          this._localStreams = [];\r\n        }\r\n        return this._localStreams;\r\n      };\r\n    }\r\n    if (!('getStreamById' in window.RTCPeerConnection.prototype)) {\r\n      window.RTCPeerConnection.prototype.getStreamById = function(id) {\r\n        var result = null;\r\n        if (this._localStreams) {\r\n          this._localStreams.forEach(function(stream) {\r\n            if (stream.id === id) {\r\n              result = stream;\r\n            }\r\n          });\r\n        }\r\n        if (this._remoteStreams) {\r\n          this._remoteStreams.forEach(function(stream) {\r\n            if (stream.id === id) {\r\n              result = stream;\r\n            }\r\n          });\r\n        }\r\n        return result;\r\n      };\r\n    }\r\n    if (!('addStream' in window.RTCPeerConnection.prototype)) {\r\n      var _addTrack = window.RTCPeerConnection.prototype.addTrack;\r\n      window.RTCPeerConnection.prototype.addStream = function(stream) {\r\n        if (!this._localStreams) {\r\n          this._localStreams = [];\r\n        }\r\n        if (this._localStreams.indexOf(stream) === -1) {\r\n          this._localStreams.push(stream);\r\n        }\r\n        var self = this;\r\n        stream.getTracks().forEach(function(track) {\r\n          _addTrack.call(self, track, stream);\r\n        });\r\n      };\r\n\r\n      window.RTCPeerConnection.prototype.addTrack = function(track, stream) {\r\n        if (stream) {\r\n          if (!this._localStreams) {\r\n            this._localStreams = [stream];\r\n          } else if (this._localStreams.indexOf(stream) === -1) {\r\n            this._localStreams.push(stream);\r\n          }\r\n        }\r\n        _addTrack.call(this, track, stream);\r\n      };\r\n    }\r\n    if (!('removeStream' in window.RTCPeerConnection.prototype)) {\r\n      window.RTCPeerConnection.prototype.removeStream = function(stream) {\r\n        if (!this._localStreams) {\r\n          this._localStreams = [];\r\n        }\r\n        var index = this._localStreams.indexOf(stream);\r\n        if (index === -1) {\r\n          return;\r\n        }\r\n        this._localStreams.splice(index, 1);\r\n        var self = this;\r\n        var tracks = stream.getTracks();\r\n        this.getSenders().forEach(function(sender) {\r\n          if (tracks.indexOf(sender.track) !== -1) {\r\n            self.removeTrack(sender);\r\n          }\r\n        });\r\n      };\r\n    }\r\n  },\r\n  shimRemoteStreamsAPI: function(window) {\r\n    if (typeof window !== 'object' || !window.RTCPeerConnection) {\r\n      return;\r\n    }\r\n    if (!('getRemoteStreams' in window.RTCPeerConnection.prototype)) {\r\n      window.RTCPeerConnection.prototype.getRemoteStreams = function() {\r\n        return this._remoteStreams ? this._remoteStreams : [];\r\n      };\r\n    }\r\n    if (!('onaddstream' in window.RTCPeerConnection.prototype)) {\r\n      Object.defineProperty(window.RTCPeerConnection.prototype, 'onaddstream', {\r\n        get: function() {\r\n          return this._onaddstream;\r\n        },\r\n        set: function(f) {\r\n          if (this._onaddstream) {\r\n            this.removeEventListener('addstream', this._onaddstream);\r\n            this.removeEventListener('track', this._onaddstreampoly);\r\n          }\r\n          this.addEventListener('addstream', this._onaddstream = f);\r\n          this.addEventListener('track', this._onaddstreampoly = function(e) {\r\n            var stream = e.streams[0];\r\n            if (!this._remoteStreams) {\r\n              this._remoteStreams = [];\r\n            }\r\n            if (this._remoteStreams.indexOf(stream) >= 0) {\r\n              return;\r\n            }\r\n            this._remoteStreams.push(stream);\r\n            var event = new Event('addstream');\r\n            event.stream = e.streams[0];\r\n            this.dispatchEvent(event);\r\n          }.bind(this));\r\n        }\r\n      });\r\n    }\r\n  },\r\n  shimCallbacksAPI: function(window) {\r\n    if (typeof window !== 'object' || !window.RTCPeerConnection) {\r\n      return;\r\n    }\r\n    var prototype = window.RTCPeerConnection.prototype;\r\n    var createOffer = prototype.createOffer;\r\n    var createAnswer = prototype.createAnswer;\r\n    var setLocalDescription = prototype.setLocalDescription;\r\n    var setRemoteDescription = prototype.setRemoteDescription;\r\n    var addIceCandidate = prototype.addIceCandidate;\r\n\r\n    prototype.createOffer = function(successCallback, failureCallback) {\r\n      var options = (arguments.length >= 2) ? arguments[2] : arguments[0];\r\n      var promise = createOffer.apply(this, [options]);\r\n      if (!failureCallback) {\r\n        return promise;\r\n      }\r\n      promise.then(successCallback, failureCallback);\r\n      return Promise.resolve();\r\n    };\r\n\r\n    prototype.createAnswer = function(successCallback, failureCallback) {\r\n      var options = (arguments.length >= 2) ? arguments[2] : arguments[0];\r\n      var promise = createAnswer.apply(this, [options]);\r\n      if (!failureCallback) {\r\n        return promise;\r\n      }\r\n      promise.then(successCallback, failureCallback);\r\n      return Promise.resolve();\r\n    };\r\n\r\n    var withCallback = function(description, successCallback, failureCallback) {\r\n      var promise = setLocalDescription.apply(this, [description]);\r\n      if (!failureCallback) {\r\n        return promise;\r\n      }\r\n      promise.then(successCallback, failureCallback);\r\n      return Promise.resolve();\r\n    };\r\n    prototype.setLocalDescription = withCallback;\r\n\r\n    withCallback = function(description, successCallback, failureCallback) {\r\n      var promise = setRemoteDescription.apply(this, [description]);\r\n      if (!failureCallback) {\r\n        return promise;\r\n      }\r\n      promise.then(successCallback, failureCallback);\r\n      return Promise.resolve();\r\n    };\r\n    prototype.setRemoteDescription = withCallback;\r\n\r\n    withCallback = function(candidate, successCallback, failureCallback) {\r\n      var promise = addIceCandidate.apply(this, [candidate]);\r\n      if (!failureCallback) {\r\n        return promise;\r\n      }\r\n      promise.then(successCallback, failureCallback);\r\n      return Promise.resolve();\r\n    };\r\n    prototype.addIceCandidate = withCallback;\r\n  },\r\n  shimGetUserMedia: function(window) {\r\n    var navigator = window && window.navigator;\r\n\r\n    if (!navigator.getUserMedia) {\r\n      if (navigator.webkitGetUserMedia) {\r\n        navigator.getUserMedia = navigator.webkitGetUserMedia.bind(navigator);\r\n      } else if (navigator.mediaDevices &&\r\n          navigator.mediaDevices.getUserMedia) {\r\n        navigator.getUserMedia = function(constraints, cb, errcb) {\r\n          navigator.mediaDevices.getUserMedia(constraints)\r\n          .then(cb, errcb);\r\n        }.bind(navigator);\r\n      }\r\n    }\r\n  },\r\n  shimRTCIceServerUrls: function(window) {\r\n    // migrate from non-spec RTCIceServer.url to RTCIceServer.urls\r\n    var OrigPeerConnection = window.RTCPeerConnection;\r\n    window.RTCPeerConnection = function(pcConfig, pcConstraints) {\r\n      if (pcConfig && pcConfig.iceServers) {\r\n        var newIceServers = [];\r\n        for (var i = 0; i < pcConfig.iceServers.length; i++) {\r\n          var server = pcConfig.iceServers[i];\r\n          if (!server.hasOwnProperty('urls') &&\r\n              server.hasOwnProperty('url')) {\r\n            utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\r\n            server = JSON.parse(JSON.stringify(server));\r\n            server.urls = server.url;\r\n            delete server.url;\r\n            newIceServers.push(server);\r\n          } else {\r\n            newIceServers.push(pcConfig.iceServers[i]);\r\n          }\r\n        }\r\n        pcConfig.iceServers = newIceServers;\r\n      }\r\n      return new OrigPeerConnection(pcConfig, pcConstraints);\r\n    };\r\n    window.RTCPeerConnection.prototype = OrigPeerConnection.prototype;\r\n    // wrap static methods. Currently just generateCertificate.\r\n    if ('generateCertificate' in window.RTCPeerConnection) {\r\n      Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\r\n        get: function() {\r\n          return OrigPeerConnection.generateCertificate;\r\n        }\r\n      });\r\n    }\r\n  },\r\n  shimTrackEventTransceiver: function(window) {\r\n    // Add event.transceiver member over deprecated event.receiver\r\n    if (typeof window === 'object' && window.RTCPeerConnection &&\r\n        ('receiver' in window.RTCTrackEvent.prototype) &&\r\n        // can't check 'transceiver' in window.RTCTrackEvent.prototype, as it is\r\n        // defined for some reason even when window.RTCTransceiver is not.\r\n        !window.RTCTransceiver) {\r\n      Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\r\n        get: function() {\r\n          return {receiver: this.receiver};\r\n        }\r\n      });\r\n    }\r\n  },\r\n\r\n  shimCreateOfferLegacy: function(window) {\r\n    var origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\r\n    window.RTCPeerConnection.prototype.createOffer = function(offerOptions) {\r\n      var pc = this;\r\n      if (offerOptions) {\r\n        var audioTransceiver = pc.getTransceivers().find(function(transceiver) {\r\n          return transceiver.sender.track &&\r\n              transceiver.sender.track.kind === 'audio';\r\n        });\r\n        if (offerOptions.offerToReceiveAudio === false && audioTransceiver) {\r\n          if (audioTransceiver.direction === 'sendrecv') {\r\n            audioTransceiver.setDirection('sendonly');\r\n          } else if (audioTransceiver.direction === 'recvonly') {\r\n            audioTransceiver.setDirection('inactive');\r\n          }\r\n        } else if (offerOptions.offerToReceiveAudio === true &&\r\n            !audioTransceiver) {\r\n          pc.addTransceiver('audio');\r\n        }\r\n\r\n        var videoTransceiver = pc.getTransceivers().find(function(transceiver) {\r\n          return transceiver.sender.track &&\r\n              transceiver.sender.track.kind === 'video';\r\n        });\r\n        if (offerOptions.offerToReceiveVideo === false && videoTransceiver) {\r\n          if (videoTransceiver.direction === 'sendrecv') {\r\n            videoTransceiver.setDirection('sendonly');\r\n          } else if (videoTransceiver.direction === 'recvonly') {\r\n            videoTransceiver.setDirection('inactive');\r\n          }\r\n        } else if (offerOptions.offerToReceiveVideo === true &&\r\n            !videoTransceiver) {\r\n          pc.addTransceiver('video');\r\n        }\r\n      }\r\n      return origCreateOffer.apply(pc, arguments);\r\n    };\r\n  }\r\n};\r\n\r\n// Expose public methods.\r\nmodule.exports = {\r\n  shimCallbacksAPI: safariShim.shimCallbacksAPI,\r\n  shimLocalStreamsAPI: safariShim.shimLocalStreamsAPI,\r\n  shimRemoteStreamsAPI: safariShim.shimRemoteStreamsAPI,\r\n  shimGetUserMedia: safariShim.shimGetUserMedia,\r\n  shimRTCIceServerUrls: safariShim.shimRTCIceServerUrls,\r\n  shimTrackEventTransceiver: safariShim.shimTrackEventTransceiver,\r\n  shimCreateOfferLegacy: safariShim.shimCreateOfferLegacy\r\n  // TODO\r\n  // shimPeerConnection: safariShim.shimPeerConnection\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/webrtc-adapter/src/js/safari/safari_shim.js","/*\r\n *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\r\n *\r\n *  Use of this source code is governed by a BSD-style license\r\n *  that can be found in the LICENSE file in the root of the source\r\n *  tree.\r\n */\r\n /* eslint-env node */\r\n'use strict';\r\n\r\nvar SDPUtils = require('sdp');\r\nvar utils = require('./utils');\r\n\r\n// Wraps the peerconnection event eventNameToWrap in a function\r\n// which returns the modified event object.\r\nfunction wrapPeerConnectionEvent(window, eventNameToWrap, wrapper) {\r\n  if (!window.RTCPeerConnection) {\r\n    return;\r\n  }\r\n  var proto = window.RTCPeerConnection.prototype;\r\n  var nativeAddEventListener = proto.addEventListener;\r\n  proto.addEventListener = function(nativeEventName, cb) {\r\n    if (nativeEventName !== eventNameToWrap) {\r\n      return nativeAddEventListener.apply(this, arguments);\r\n    }\r\n    var wrappedCallback = function(e) {\r\n      cb(wrapper(e));\r\n    };\r\n    this._eventMap = this._eventMap || {};\r\n    this._eventMap[cb] = wrappedCallback;\r\n    return nativeAddEventListener.apply(this, [nativeEventName,\r\n      wrappedCallback]);\r\n  };\r\n\r\n  var nativeRemoveEventListener = proto.removeEventListener;\r\n  proto.removeEventListener = function(nativeEventName, cb) {\r\n    if (nativeEventName !== eventNameToWrap || !this._eventMap\r\n        || !this._eventMap[cb]) {\r\n      return nativeRemoveEventListener.apply(this, arguments);\r\n    }\r\n    var unwrappedCb = this._eventMap[cb];\r\n    delete this._eventMap[cb];\r\n    return nativeRemoveEventListener.apply(this, [nativeEventName,\r\n      unwrappedCb]);\r\n  };\r\n\r\n  Object.defineProperty(proto, 'on' + eventNameToWrap, {\r\n    get: function() {\r\n      return this['_on' + eventNameToWrap];\r\n    },\r\n    set: function(cb) {\r\n      if (this['_on' + eventNameToWrap]) {\r\n        this.removeEventListener(eventNameToWrap,\r\n            this['_on' + eventNameToWrap]);\r\n        delete this['_on' + eventNameToWrap];\r\n      }\r\n      if (cb) {\r\n        this.addEventListener(eventNameToWrap,\r\n            this['_on' + eventNameToWrap] = cb);\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\nmodule.exports = {\r\n  shimRTCIceCandidate: function(window) {\r\n    // foundation is arbitrarily chosen as an indicator for full support for\r\n    // https://w3c.github.io/webrtc-pc/#rtcicecandidate-interface\r\n    if (window.RTCIceCandidate && 'foundation' in\r\n        window.RTCIceCandidate.prototype) {\r\n      return;\r\n    }\r\n\r\n    var NativeRTCIceCandidate = window.RTCIceCandidate;\r\n    window.RTCIceCandidate = function(args) {\r\n      // Remove the a= which shouldn't be part of the candidate string.\r\n      if (typeof args === 'object' && args.candidate &&\r\n          args.candidate.indexOf('a=') === 0) {\r\n        args = JSON.parse(JSON.stringify(args));\r\n        args.candidate = args.candidate.substr(2);\r\n      }\r\n\r\n      // Augment the native candidate with the parsed fields.\r\n      var nativeCandidate = new NativeRTCIceCandidate(args);\r\n      var parsedCandidate = SDPUtils.parseCandidate(args.candidate);\r\n      var augmentedCandidate = Object.assign(nativeCandidate,\r\n          parsedCandidate);\r\n\r\n      // Add a serializer that does not serialize the extra attributes.\r\n      augmentedCandidate.toJSON = function() {\r\n        return {\r\n          candidate: augmentedCandidate.candidate,\r\n          sdpMid: augmentedCandidate.sdpMid,\r\n          sdpMLineIndex: augmentedCandidate.sdpMLineIndex,\r\n          usernameFragment: augmentedCandidate.usernameFragment,\r\n        };\r\n      };\r\n      return augmentedCandidate;\r\n    };\r\n\r\n    // Hook up the augmented candidate in onicecandidate and\r\n    // addEventListener('icecandidate', ...)\r\n    wrapPeerConnectionEvent(window, 'icecandidate', function(e) {\r\n      if (e.candidate) {\r\n        Object.defineProperty(e, 'candidate', {\r\n          value: new window.RTCIceCandidate(e.candidate),\r\n          writable: 'false'\r\n        });\r\n      }\r\n      return e;\r\n    });\r\n  },\r\n\r\n  // shimCreateObjectURL must be called before shimSourceObject to avoid loop.\r\n\r\n  shimCreateObjectURL: function(window) {\r\n    var URL = window && window.URL;\r\n\r\n    if (!(typeof window === 'object' && window.HTMLMediaElement &&\r\n          'srcObject' in window.HTMLMediaElement.prototype &&\r\n        URL.createObjectURL && URL.revokeObjectURL)) {\r\n      // Only shim CreateObjectURL using srcObject if srcObject exists.\r\n      return undefined;\r\n    }\r\n\r\n    var nativeCreateObjectURL = URL.createObjectURL.bind(URL);\r\n    var nativeRevokeObjectURL = URL.revokeObjectURL.bind(URL);\r\n    var streams = new Map(), newId = 0;\r\n\r\n    URL.createObjectURL = function(stream) {\r\n      if ('getTracks' in stream) {\r\n        var url = 'polyblob:' + (++newId);\r\n        streams.set(url, stream);\r\n        utils.deprecated('URL.createObjectURL(stream)',\r\n            'elem.srcObject = stream');\r\n        return url;\r\n      }\r\n      return nativeCreateObjectURL(stream);\r\n    };\r\n    URL.revokeObjectURL = function(url) {\r\n      nativeRevokeObjectURL(url);\r\n      streams.delete(url);\r\n    };\r\n\r\n    var dsc = Object.getOwnPropertyDescriptor(window.HTMLMediaElement.prototype,\r\n                                              'src');\r\n    Object.defineProperty(window.HTMLMediaElement.prototype, 'src', {\r\n      get: function() {\r\n        return dsc.get.apply(this);\r\n      },\r\n      set: function(url) {\r\n        this.srcObject = streams.get(url) || null;\r\n        return dsc.set.apply(this, [url]);\r\n      }\r\n    });\r\n\r\n    var nativeSetAttribute = window.HTMLMediaElement.prototype.setAttribute;\r\n    window.HTMLMediaElement.prototype.setAttribute = function() {\r\n      if (arguments.length === 2 &&\r\n          ('' + arguments[0]).toLowerCase() === 'src') {\r\n        this.srcObject = streams.get(arguments[1]) || null;\r\n      }\r\n      return nativeSetAttribute.apply(this, arguments);\r\n    };\r\n  }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/webrtc-adapter/src/js/common_shim.js","\r\n\r\n/**\r\n * The method will increase the given number by 1. If the given counter is equal\r\n * or greater to {@link Number.MAX_SAFE_INTEGER} then it will be rolled back to\r\n * 1.\r\n * @param {number} number - An integer counter value to be incremented.\r\n * @return {number} the next counter value increased by 1 (see the description\r\n * above for exception).\r\n */\r\nexport function safeCounterIncrement(number) {\r\n    let nextValue = number;\r\n\r\n    if (number >= Number.MAX_SAFE_INTEGER) {\r\n        nextValue = 0;\r\n    }\r\n\r\n    return nextValue + 1;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/util/MathUtil.js","/* global __filename, RTCSessionDescription */\r\n\r\nimport { getLogger } from 'jitsi-meet-logger';\r\nimport transform from 'sdp-transform';\r\n\r\nimport * as GlobalOnErrorHandler from '../util/GlobalOnErrorHandler';\r\nimport JitsiRemoteTrack from './JitsiRemoteTrack';\r\nimport * as MediaType from '../../service/RTC/MediaType';\r\nimport LocalSdpMunger from './LocalSdpMunger';\r\nimport RTC from './RTC';\r\nimport RTCUtils from './RTCUtils';\r\nimport browser from '../browser';\r\nimport RTCEvents from '../../service/RTC/RTCEvents';\r\nimport RtxModifier from '../xmpp/RtxModifier';\r\n\r\n// FIXME SDP tools should end up in some kind of util module\r\nimport SDP from '../xmpp/SDP';\r\nimport SdpConsistency from '../xmpp/SdpConsistency';\r\nimport { SdpTransformWrap } from '../xmpp/SdpTransformUtil';\r\nimport SDPUtil from '../xmpp/SDPUtil';\r\nimport * as SignalingEvents from '../../service/RTC/SignalingEvents';\r\n\r\nconst logger = getLogger(__filename);\r\nconst SIMULCAST_LAYERS = 3;\r\nconst SIM_LAYER_1_RID = '1';\r\nconst SIM_LAYER_2_RID = '2';\r\nconst SIM_LAYER_3_RID = '3';\r\nconst SIM_LAYER_RIDS = [ SIM_LAYER_1_RID, SIM_LAYER_2_RID, SIM_LAYER_3_RID ];\r\n\r\n/* eslint-disable max-params */\r\n\r\n/**\r\n * Creates new instance of 'TraceablePeerConnection'.\r\n *\r\n * @param {RTC} rtc the instance of <tt>RTC</tt> service\r\n * @param {number} id the peer connection id assigned by the parent RTC module.\r\n * @param {SignalingLayer} signalingLayer the signaling layer instance\r\n * @param {object} iceConfig WebRTC 'PeerConnection' ICE config\r\n * @param {object} constraints WebRTC 'PeerConnection' constraints\r\n * @param {boolean} isP2P indicates whether or not the new instance will be used\r\n * in a peer to peer connection\r\n * @param {object} options <tt>TracablePeerConnection</tt> config options.\r\n * @param {boolean} options.disableSimulcast if set to 'true' will disable\r\n * the simulcast.\r\n * @param {boolean} options.disableRtx if set to 'true' will disable the RTX\r\n * @param {boolean} options.enableFirefoxSimulcast if set to 'true' will enable\r\n * experimental simulcast support on Firefox.\r\n * @param {boolean} options.disableH264 If set to 'true' H264 will be\r\n *      disabled by removing it from the SDP.\r\n * @param {boolean} options.preferH264 if set to 'true' H264 will be preferred\r\n * over other video codecs.\r\n *\r\n * FIXME: initially the purpose of TraceablePeerConnection was to be able to\r\n * debug the peer connection. Since many other responsibilities have been added\r\n * it would make sense to extract a separate class from it and come up with\r\n * a more suitable name.\r\n *\r\n * @constructor\r\n */\r\nexport default function TraceablePeerConnection(\r\n        rtc,\r\n        id,\r\n        signalingLayer,\r\n        iceConfig,\r\n        constraints,\r\n        isP2P,\r\n        options) {\r\n\r\n    /**\r\n     * Indicates whether or not this peer connection instance is actively\r\n     * sending/receiving audio media. When set to <tt>false</tt> the SDP audio\r\n     * media direction will be adjusted to 'inactive' in order to suspend\r\n     * the transmission.\r\n     * @type {boolean}\r\n     * @private\r\n     */\r\n    this.audioTransferActive = true;\r\n\r\n    /**\r\n     * Indicates whether or not this peer connection instance is actively\r\n     * sending/receiving video media. When set to <tt>false</tt> the SDP video\r\n     * media direction will be adjusted to 'inactive' in order to suspend\r\n     * the transmission.\r\n     * @type {boolean}\r\n     * @private\r\n     */\r\n    this.videoTransferActive = true;\r\n\r\n    /**\r\n     * The parent instance of RTC service which created this\r\n     * <tt>TracablePeerConnection</tt>.\r\n     * @type {RTC}\r\n     */\r\n    this.rtc = rtc;\r\n\r\n    /**\r\n     * The peer connection identifier assigned by the RTC module.\r\n     * @type {number}\r\n     */\r\n    this.id = id;\r\n\r\n    /**\r\n     * Indicates whether or not this instance is used in a peer to peer\r\n     * connection.\r\n     * @type {boolean}\r\n     */\r\n    this.isP2P = isP2P;\r\n\r\n    // FIXME: We should support multiple streams per jid.\r\n    /**\r\n     * The map holds remote tracks associated with this peer connection.\r\n     * It maps user's JID to media type and remote track\r\n     * (one track per media type per user's JID).\r\n     * @type {Map<string, Map<MediaType, JitsiRemoteTrack>>}\r\n     */\r\n    this.remoteTracks = new Map();\r\n\r\n    /**\r\n     * A map which stores local tracks mapped by {@link JitsiLocalTrack.rtcId}\r\n     * @type {Map<number, JitsiLocalTrack>}\r\n     */\r\n    this.localTracks = new Map();\r\n\r\n    /**\r\n     * Keeps tracks of the WebRTC <tt>MediaStream</tt>s that have been added to\r\n     * the underlying WebRTC PeerConnection. An Array is used to avoid errors in\r\n     * IE11 with adding temasys MediaStream objects into other data structures.\r\n     * @type {Array}\r\n     * @private\r\n     */\r\n    this._addedStreams = [];\r\n\r\n    /**\r\n     * @typedef {Object} TPCGroupInfo\r\n     * @property {string} semantics the SSRC groups semantics\r\n     * @property {Array<number>} ssrcs group's SSRCs in order where the first\r\n     * one is group's primary SSRC, the second one is secondary (RTX) and so\r\n     * on...\r\n     */\r\n    /**\r\n     * @typedef {Object} TPCSSRCInfo\r\n     * @property {Array<number>} ssrcs an array which holds all track's SSRCs\r\n     * @property {Array<TPCGroupInfo>} groups an array stores all track's SSRC\r\n     * groups\r\n     */\r\n    /**\r\n     * Holds the info about local track's SSRCs mapped per their\r\n     * {@link JitsiLocalTrack.rtcId}\r\n     * @type {Map<number, TPCSSRCInfo>}\r\n     */\r\n    this.localSSRCs = new Map();\r\n\r\n    /**\r\n     * The local ICE username fragment for this session.\r\n     */\r\n    this.localUfrag = null;\r\n\r\n    /**\r\n     * The remote ICE username fragment for this session.\r\n     */\r\n    this.remoteUfrag = null;\r\n\r\n    /**\r\n     * The signaling layer which operates this peer connection.\r\n     * @type {SignalingLayer}\r\n     */\r\n    this.signalingLayer = signalingLayer;\r\n\r\n    // SignalingLayer listeners\r\n    this._peerVideoTypeChanged = this._peerVideoTypeChanged.bind(this);\r\n    this.signalingLayer.on(\r\n        SignalingEvents.PEER_VIDEO_TYPE_CHANGED,\r\n        this._peerVideoTypeChanged);\r\n\r\n    this._peerMutedChanged = this._peerMutedChanged.bind(this);\r\n    this.signalingLayer.on(\r\n        SignalingEvents.PEER_MUTED_CHANGED,\r\n        this._peerMutedChanged);\r\n    this.options = options;\r\n\r\n    this.peerconnection\r\n        = new RTCUtils.RTCPeerConnectionType(iceConfig, constraints);\r\n    this.updateLog = [];\r\n    this.stats = {};\r\n    this.statsinterval = null;\r\n\r\n    /**\r\n     * @type {number}\r\n     */\r\n    this.maxstats = 0;\r\n    const Interop = require('sdp-interop').Interop;\r\n\r\n    this.interop = new Interop();\r\n    const Simulcast = require('sdp-simulcast');\r\n\r\n    this.simulcast = new Simulcast({ numOfLayers: SIMULCAST_LAYERS,\r\n        explodeRemoteSimulcast: false });\r\n    this.sdpConsistency = new SdpConsistency(this.toString());\r\n\r\n    /**\r\n     * Munges local SDP provided to the Jingle Session in order to prevent from\r\n     * sending SSRC updates on attach/detach and mute/unmute (for video).\r\n     * @type {LocalSdpMunger}\r\n     */\r\n    this.localSdpMunger = new LocalSdpMunger(this);\r\n\r\n    /**\r\n     * TracablePeerConnection uses RTC's eventEmitter\r\n     * @type {EventEmitter}\r\n     */\r\n    this.eventEmitter = rtc.eventEmitter;\r\n    this.rtxModifier = new RtxModifier();\r\n\r\n    // override as desired\r\n    this.trace = (what, info) => {\r\n        logger.debug(what, info);\r\n\r\n        /*\r\n        if (info && browser.isIExplorer()) {\r\n            if (info.length > 1024) {\r\n                logger.warn('WTRACE', what, info.substr(1024));\r\n            }\r\n            if (info.length > 2048) {\r\n                logger.warn('WTRACE', what, info.substr(2048));\r\n            }\r\n        }*/\r\n        this.updateLog.push({\r\n            time: new Date(),\r\n            type: what,\r\n            value: info || ''\r\n        });\r\n    };\r\n    this.onicecandidate = null;\r\n    this.peerconnection.onicecandidate = event => {\r\n        // FIXME: this causes stack overflow with Temasys Plugin\r\n        if (!browser.isTemasysPluginUsed()) {\r\n            this.trace(\r\n                'onicecandidate',\r\n                JSON.stringify(event.candidate, null, ' '));\r\n        }\r\n\r\n        if (this.onicecandidate !== null) {\r\n            this.onicecandidate(event);\r\n        }\r\n    };\r\n    this.peerconnection.onaddstream\r\n        = event => this._remoteStreamAdded(event.stream);\r\n    this.peerconnection.onremovestream\r\n        = event => this._remoteStreamRemoved(event.stream);\r\n    this.onsignalingstatechange = null;\r\n    this.peerconnection.onsignalingstatechange = event => {\r\n        this.trace('onsignalingstatechange', this.signalingState);\r\n        if (this.onsignalingstatechange !== null) {\r\n            this.onsignalingstatechange(event);\r\n        }\r\n    };\r\n    this.oniceconnectionstatechange = null;\r\n    this.peerconnection.oniceconnectionstatechange = event => {\r\n        this.trace('oniceconnectionstatechange', this.iceConnectionState);\r\n        if (this.oniceconnectionstatechange !== null) {\r\n            this.oniceconnectionstatechange(event);\r\n        }\r\n    };\r\n    this.onnegotiationneeded = null;\r\n    this.peerconnection.onnegotiationneeded = event => {\r\n        this.trace('onnegotiationneeded');\r\n        if (this.onnegotiationneeded !== null) {\r\n            this.onnegotiationneeded(event);\r\n        }\r\n    };\r\n    this.ondatachannel = null;\r\n    this.peerconnection.ondatachannel = event => {\r\n        this.trace('ondatachannel');\r\n        if (this.ondatachannel !== null) {\r\n            this.ondatachannel(event);\r\n        }\r\n    };\r\n\r\n    // XXX: do all non-firefox browsers which we support also support this?\r\n    if (!browser.isFirefox() && this.maxstats) {\r\n        this.statsinterval = window.setInterval(() => {\r\n            this.peerconnection.getStats(stats => {\r\n                const results = stats.result();\r\n                const now = new Date();\r\n\r\n                for (let i = 0; i < results.length; ++i) {\r\n                    results[i].names().forEach(name => {\r\n                        // eslint-disable-next-line no-shadow\r\n                        const id = `${results[i].id}-${name}`;\r\n                        let s = this.stats[id];\r\n\r\n                        if (!s) {\r\n                            this.stats[id] = s = {\r\n                                startTime: now,\r\n                                endTime: now,\r\n                                values: [],\r\n                                times: []\r\n                            };\r\n                        }\r\n                        s.values.push(results[i].stat(name));\r\n                        s.times.push(now.getTime());\r\n                        if (s.values.length > this.maxstats) {\r\n                            s.values.shift();\r\n                            s.times.shift();\r\n                        }\r\n                        s.endTime = now;\r\n                    });\r\n                }\r\n            });\r\n        }, 1000);\r\n    }\r\n\r\n    logger.info(`Create new ${this}`);\r\n}\r\n\r\n/* eslint-enable max-params */\r\n\r\n/**\r\n * Returns a string representation of a SessionDescription object.\r\n */\r\nconst dumpSDP = function(description) {\r\n    if (typeof description === 'undefined' || description === null) {\r\n        return '';\r\n    }\r\n\r\n    return `type: ${description.type}\\r\\n${description.sdp}`;\r\n};\r\n\r\n\r\n/**\r\n * Forwards the {@link peerconnection.iceConnectionState} state except that it\r\n * will convert \"completed\" into \"connected\" where both mean that the ICE has\r\n * succeeded and is up and running. We never see \"completed\" state for\r\n * the JVB connection, but it started appearing for the P2P one. This method\r\n * allows to adapt old logic to this new situation.\r\n * @return {string}\r\n */\r\nTraceablePeerConnection.prototype.getConnectionState = function() {\r\n    const state = this.peerconnection.iceConnectionState;\r\n\r\n    if (state === 'completed') {\r\n        return 'connected';\r\n    }\r\n\r\n    return state;\r\n};\r\n\r\n/**\r\n * Obtains the media direction for given {@link MediaType}. The method takes\r\n * into account whether or not there are any local tracks for media and\r\n * the {@link audioTransferActive} and {@link videoTransferActive} flags.\r\n * @param {MediaType} mediaType\r\n * @return {string} one of the SDP direction constants ('sendrecv, 'recvonly'\r\n * etc.) which should be used when setting local description on the peer\r\n * connection.\r\n * @private\r\n */\r\nTraceablePeerConnection.prototype._getDesiredMediaDirection = function(\r\n        mediaType) {\r\n    let mediaTransferActive = true;\r\n\r\n    if (mediaType === MediaType.AUDIO) {\r\n        mediaTransferActive = this.audioTransferActive;\r\n    } else if (mediaType === MediaType.VIDEO) {\r\n        mediaTransferActive = this.videoTransferActive;\r\n    }\r\n    if (mediaTransferActive) {\r\n        return this.hasAnyTracksOfType(mediaType) ? 'sendrecv' : 'recvonly';\r\n    }\r\n\r\n    return 'inactive';\r\n};\r\n\r\n/**\r\n * Tells whether or not this TPC instance is using Simulcast.\r\n * @return {boolean} <tt>true</tt> if simulcast is enabled and active or\r\n * <tt>false</tt> if it's turned off.\r\n */\r\nTraceablePeerConnection.prototype.isSimulcastOn = function() {\r\n    return !this.options.disableSimulcast\r\n        && browser.supportsSimulcast()\r\n\r\n        // Firefox has been added as supporting simulcast, but it is\r\n        // experimental so we only want to do it for firefox if the config\r\n        // option is set.  Unfortunately, browser::supportsSimulcast()\r\n        // doesn't have a reference to the config options, so we have\r\n        // to do it here\r\n        && (!browser.isFirefox()\r\n            || this.options.enableFirefoxSimulcast);\r\n};\r\n\r\n/**\r\n * Handles {@link SignalingEvents.PEER_VIDEO_TYPE_CHANGED}\r\n * @param {string} endpointId the video owner's ID (MUC nickname)\r\n * @param {VideoType} videoType the new value\r\n * @private\r\n */\r\nTraceablePeerConnection.prototype._peerVideoTypeChanged = function(\r\n        endpointId,\r\n        videoType) {\r\n    // Check if endpointId has a value to avoid action on random track\r\n    if (!endpointId) {\r\n        logger.error(`No endpointID on peerVideoTypeChanged ${this}`);\r\n\r\n        return;\r\n    }\r\n    const videoTrack = this.getRemoteTracks(endpointId, MediaType.VIDEO);\r\n\r\n    if (videoTrack.length) {\r\n        // NOTE 1 track per media type is assumed\r\n        videoTrack[0]._setVideoType(videoType);\r\n    }\r\n};\r\n\r\n/**\r\n * Handles remote track mute / unmute events.\r\n * @param {string} endpointId the track owner's identifier (MUC nickname)\r\n * @param {MediaType} mediaType \"audio\" or \"video\"\r\n * @param {boolean} isMuted the new mute state\r\n * @private\r\n */\r\nTraceablePeerConnection.prototype._peerMutedChanged = function(\r\n        endpointId,\r\n        mediaType,\r\n        isMuted) {\r\n    // Check if endpointId is a value to avoid doing action on all remote tracks\r\n    if (!endpointId) {\r\n        logger.error('On peerMuteChanged - no endpoint ID');\r\n\r\n        return;\r\n    }\r\n    const track = this.getRemoteTracks(endpointId, mediaType);\r\n\r\n    if (track.length) {\r\n        // NOTE 1 track per media type is assumed\r\n        track[0].setMute(isMuted);\r\n    }\r\n};\r\n\r\n/**\r\n * Obtains local tracks for given {@link MediaType}. If the <tt>mediaType</tt>\r\n * argument is omitted the list of all local tracks will be returned.\r\n * @param {MediaType} [mediaType]\r\n * @return {Array<JitsiLocalTrack>}\r\n */\r\nTraceablePeerConnection.prototype.getLocalTracks = function(mediaType) {\r\n    let tracks = Array.from(this.localTracks.values());\r\n\r\n    if (mediaType !== undefined) {\r\n        tracks = tracks.filter(track => track.getType() === mediaType);\r\n    }\r\n\r\n    return tracks;\r\n};\r\n\r\n/**\r\n * Checks whether or not this {@link TraceablePeerConnection} instance contains\r\n * any local tracks for given <tt>mediaType</tt>.\r\n * @param {MediaType} mediaType\r\n * @return {boolean}\r\n */\r\nTraceablePeerConnection.prototype.hasAnyTracksOfType = function(mediaType) {\r\n    if (!mediaType) {\r\n        throw new Error('\"mediaType\" is required');\r\n    }\r\n\r\n    return this.getLocalTracks(mediaType).length > 0;\r\n};\r\n\r\n/**\r\n * Obtains all remote tracks currently known to this PeerConnection instance.\r\n * @param {string} [endpointId] the track owner's identifier (MUC nickname)\r\n * @param {MediaType} [mediaType] the remote tracks will be filtered\r\n * by their media type if this argument is specified.\r\n * @return {Array<JitsiRemoteTrack>}\r\n */\r\nTraceablePeerConnection.prototype.getRemoteTracks = function(\r\n        endpointId,\r\n        mediaType) {\r\n    const remoteTracks = [];\r\n    const endpoints\r\n        = endpointId ? [ endpointId ] : this.remoteTracks.keys();\r\n\r\n    for (const endpoint of endpoints) {\r\n        const endpointTrackMap = this.remoteTracks.get(endpoint);\r\n\r\n        if (!endpointTrackMap) {\r\n\r\n            // Otherwise an empty Map() would have to be allocated above\r\n            // eslint-disable-next-line no-continue\r\n            continue;\r\n        }\r\n\r\n        for (const trackMediaType of endpointTrackMap.keys()) {\r\n            // per media type filtering\r\n            if (!mediaType || mediaType === trackMediaType) {\r\n                const mediaTrack = endpointTrackMap.get(trackMediaType);\r\n\r\n                if (mediaTrack) {\r\n                    remoteTracks.push(mediaTrack);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    return remoteTracks;\r\n};\r\n\r\n/**\r\n * Tries to find {@link JitsiTrack} for given SSRC number. It will search both\r\n * local and remote tracks bound to this instance.\r\n * @param {number} ssrc\r\n * @return {JitsiTrack|null}\r\n */\r\nTraceablePeerConnection.prototype.getTrackBySSRC = function(ssrc) {\r\n    if (typeof ssrc !== 'number') {\r\n        throw new Error(`SSRC ${ssrc} is not a number`);\r\n    }\r\n    for (const localTrack of this.localTracks.values()) {\r\n        if (this.getLocalSSRC(localTrack) === ssrc) {\r\n            return localTrack;\r\n        }\r\n    }\r\n    for (const remoteTrack of this.getRemoteTracks()) {\r\n        if (remoteTrack.getSSRC() === ssrc) {\r\n            return remoteTrack;\r\n        }\r\n    }\r\n\r\n    return null;\r\n};\r\n\r\n/**\r\n * Called when new remote MediaStream is added to the PeerConnection.\r\n * @param {MediaStream} stream the WebRTC MediaStream for remote participant\r\n */\r\nTraceablePeerConnection.prototype._remoteStreamAdded = function(stream) {\r\n    const streamId = RTC.getStreamID(stream);\r\n\r\n    if (!RTC.isUserStreamById(streamId)) {\r\n        logger.info(\r\n            `${this} ignored remote 'stream added' event for non-user stream`\r\n             + `id: ${streamId}`);\r\n\r\n        return;\r\n    }\r\n\r\n    // Bind 'addtrack'/'removetrack' event handlers\r\n    if (browser.isChrome() || browser.isNWJS()\r\n        || browser.isElectron() || browser.isEdge()) {\r\n        stream.onaddtrack = event => {\r\n            this._remoteTrackAdded(stream, event.track);\r\n        };\r\n        stream.onremovetrack = event => {\r\n            this._remoteTrackRemoved(stream, event.track);\r\n        };\r\n    }\r\n\r\n    // Call remoteTrackAdded for each track in the stream\r\n    const streamAudioTracks = stream.getAudioTracks();\r\n\r\n    for (const audioTrack of streamAudioTracks) {\r\n        this._remoteTrackAdded(stream, audioTrack);\r\n    }\r\n    const streamVideoTracks = stream.getVideoTracks();\r\n\r\n    for (const videoTrack of streamVideoTracks) {\r\n        this._remoteTrackAdded(stream, videoTrack);\r\n    }\r\n};\r\n\r\n\r\n/**\r\n * Called on \"track added\" and \"stream added\" PeerConnection events (because we\r\n * handle streams on per track basis). Finds the owner and the SSRC for\r\n * the track and passes that to ChatRoom for further processing.\r\n * @param {MediaStream} stream the WebRTC MediaStream instance which is\r\n * the parent of the track\r\n * @param {MediaStreamTrack} track the WebRTC MediaStreamTrack added for remote\r\n * participant\r\n */\r\nTraceablePeerConnection.prototype._remoteTrackAdded = function(stream, track) {\r\n    const streamId = RTC.getStreamID(stream);\r\n    const mediaType = track.kind;\r\n\r\n    logger.info(`${this} remote track added:`, streamId, mediaType);\r\n\r\n    // look up an associated JID for a stream id\r\n    if (!mediaType) {\r\n        GlobalOnErrorHandler.callErrorHandler(\r\n            new Error(\r\n                `MediaType undefined for remote track, stream id: ${streamId}`\r\n            ));\r\n\r\n        // Abort\r\n        return;\r\n    }\r\n\r\n    const remoteSDP = new SDP(this.remoteDescription.sdp);\r\n    const mediaLines\r\n        = remoteSDP.media.filter(mls => mls.startsWith(`m=${mediaType}`));\r\n\r\n    if (!mediaLines.length) {\r\n        GlobalOnErrorHandler.callErrorHandler(\r\n            new Error(\r\n                `No media lines for type ${\r\n                    mediaType} found in remote SDP for remote track: ${\r\n                    streamId}`));\r\n\r\n        // Abort\r\n        return;\r\n    }\r\n\r\n    let ssrcLines = SDPUtil.findLines(mediaLines[0], 'a=ssrc:');\r\n\r\n    ssrcLines = ssrcLines.filter(\r\n        line => {\r\n            const msid\r\n                = browser.isTemasysPluginUsed() ? 'mslabel' : 'msid';\r\n\r\n\r\n            return line.indexOf(`${msid}:${streamId}`) !== -1;\r\n        });\r\n    if (!ssrcLines.length) {\r\n        GlobalOnErrorHandler.callErrorHandler(\r\n            new Error(\r\n                `No SSRC lines for streamId ${\r\n                    streamId} for remote track, media type: ${mediaType}`));\r\n\r\n        // Abort\r\n        return;\r\n    }\r\n\r\n    // FIXME the length of ssrcLines[0] not verified, but it will fail\r\n    // with global error handler anyway\r\n    const ssrcStr = ssrcLines[0].substring(7).split(' ')[0];\r\n    const trackSsrc = Number(ssrcStr);\r\n    const ownerEndpointId = this.signalingLayer.getSSRCOwner(trackSsrc);\r\n\r\n    if (isNaN(trackSsrc) || trackSsrc < 0) {\r\n        GlobalOnErrorHandler.callErrorHandler(\r\n            new Error(\r\n                `Invalid SSRC: ${ssrcStr} for remote track, msid: ${\r\n                    streamId} media type: ${mediaType}`));\r\n\r\n        // Abort\r\n        return;\r\n    } else if (!ownerEndpointId) {\r\n        GlobalOnErrorHandler.callErrorHandler(\r\n            new Error(\r\n                `No SSRC owner known for: ${\r\n                    trackSsrc} for remote track, msid: ${\r\n                    streamId} media type: ${mediaType}`));\r\n\r\n        // Abort\r\n        return;\r\n    }\r\n\r\n    logger.log(`${this} associated ssrc`, ownerEndpointId, trackSsrc);\r\n\r\n    const peerMediaInfo\r\n        = this.signalingLayer.getPeerMediaInfo(ownerEndpointId, mediaType);\r\n\r\n    if (!peerMediaInfo) {\r\n        GlobalOnErrorHandler.callErrorHandler(\r\n            new Error(\r\n                `${this}: no peer media info available for ${\r\n                    ownerEndpointId}`));\r\n\r\n        return;\r\n    }\r\n\r\n    const muted = peerMediaInfo.muted;\r\n    const videoType = peerMediaInfo.videoType; // can be undefined\r\n\r\n    this._createRemoteTrack(\r\n        ownerEndpointId, stream, track, mediaType, videoType, trackSsrc, muted);\r\n};\r\n\r\n// FIXME cleanup params\r\n/* eslint-disable max-params */\r\n\r\n/**\r\n * Initializes a new JitsiRemoteTrack instance with the data provided by\r\n * the signaling layer and SDP.\r\n *\r\n * @param {string} ownerEndpointId the owner's endpoint ID (MUC nickname)\r\n * @param {MediaStream} stream the WebRTC stream instance\r\n * @param {MediaStreamTrack} track the WebRTC track instance\r\n * @param {MediaType} mediaType the track's type of the media\r\n * @param {VideoType} [videoType] the track's type of the video (if applicable)\r\n * @param {number} ssrc the track's main SSRC number\r\n * @param {boolean} muted the initial muted status\r\n */\r\nTraceablePeerConnection.prototype._createRemoteTrack = function(\r\n        ownerEndpointId,\r\n        stream,\r\n        track,\r\n        mediaType,\r\n        videoType,\r\n        ssrc,\r\n        muted) {\r\n    const remoteTrack\r\n        = new JitsiRemoteTrack(\r\n            this.rtc, this.rtc.conference,\r\n            ownerEndpointId,\r\n            stream, track, mediaType, videoType, ssrc, muted, this.isP2P);\r\n    let remoteTracksMap = this.remoteTracks.get(ownerEndpointId);\r\n\r\n    if (!remoteTracksMap) {\r\n        remoteTracksMap = new Map();\r\n        this.remoteTracks.set(ownerEndpointId, remoteTracksMap);\r\n    }\r\n\r\n    if (remoteTracksMap.has(mediaType)) {\r\n        logger.error(\r\n            `${this} overwriting remote track! ${remoteTrack}`,\r\n            ownerEndpointId, mediaType);\r\n    }\r\n    remoteTracksMap.set(mediaType, remoteTrack);\r\n\r\n    this.eventEmitter.emit(RTCEvents.REMOTE_TRACK_ADDED, remoteTrack);\r\n};\r\n\r\n/* eslint-enable max-params */\r\n\r\n/**\r\n * Handles remote stream removal.\r\n * @param stream the WebRTC MediaStream object which is being removed from the\r\n * PeerConnection\r\n */\r\nTraceablePeerConnection.prototype._remoteStreamRemoved = function(stream) {\r\n    if (!RTC.isUserStream(stream)) {\r\n        const id = RTC.getStreamID(stream);\r\n\r\n        logger.info(\r\n            `Ignored remote 'stream removed' event for non-user stream ${id}`);\r\n\r\n        return;\r\n    }\r\n\r\n    // Call remoteTrackRemoved for each track in the stream\r\n    const streamVideoTracks = stream.getVideoTracks();\r\n\r\n    for (const videoTrack of streamVideoTracks) {\r\n        this._remoteTrackRemoved(stream, videoTrack);\r\n    }\r\n    const streamAudioTracks = stream.getAudioTracks();\r\n\r\n    for (const audioTrack of streamAudioTracks) {\r\n        this._remoteTrackRemoved(stream, audioTrack);\r\n    }\r\n};\r\n\r\n/**\r\n * Handles remote media track removal.\r\n * @param {MediaStream} stream WebRTC MediaStream instance which is the parent\r\n * of the track.\r\n * @param {MediaStreamTrack} track the WebRTC MediaStreamTrack which has been\r\n * removed from the PeerConnection.\r\n */\r\nTraceablePeerConnection.prototype._remoteTrackRemoved = function(\r\n        stream,\r\n        track) {\r\n    const streamId = RTC.getStreamID(stream);\r\n    const trackId = track && RTC.getTrackID(track);\r\n\r\n    logger.info(`${this} - remote track removed: ${streamId}, ${trackId}`);\r\n\r\n    if (!streamId) {\r\n        GlobalOnErrorHandler.callErrorHandler(\r\n            new Error(`${this} remote track removal failed - no stream ID`));\r\n\r\n        return;\r\n    }\r\n\r\n    if (!trackId) {\r\n        GlobalOnErrorHandler.callErrorHandler(\r\n            new Error(`${this} remote track removal failed - no track ID`));\r\n\r\n        return;\r\n    }\r\n\r\n    if (!this._removeRemoteTrackById(streamId, trackId)) {\r\n        // NOTE this warning is always printed when user leaves the room,\r\n        // because we remove remote tracks manually on MUC member left event,\r\n        // before the SSRCs are removed by Jicofo. In most cases it is fine to\r\n        // ignore this warning, but still it's better to keep it printed for\r\n        // debugging purposes.\r\n        //\r\n        // We could change the behaviour to emit track removed only from here,\r\n        // but the order of the events will change and consuming apps could\r\n        // behave unexpectedly (the \"user left\" event would come before \"track\r\n        // removed\" events).\r\n        logger.warn(\r\n            `${this} Removed track not found for msid: ${streamId},\r\n             track id: ${trackId}`);\r\n    }\r\n};\r\n\r\n/**\r\n * Finds remote track by it's stream and track ids.\r\n * @param {string} streamId the media stream id as defined by the WebRTC\r\n * @param {string} trackId the media track id as defined by the WebRTC\r\n * @return {JitsiRemoteTrack|undefined} the track's instance or\r\n * <tt>undefined</tt> if not found.\r\n * @private\r\n */\r\nTraceablePeerConnection.prototype._getRemoteTrackById = function(\r\n        streamId,\r\n        trackId) {\r\n    // .find will break the loop once the first match is found\r\n    for (const endpointTrackMap of this.remoteTracks.values()) {\r\n        for (const mediaTrack of endpointTrackMap.values()) {\r\n            // FIXME verify and try to use ===\r\n            /* eslint-disable eqeqeq */\r\n            if (mediaTrack.getStreamId() == streamId\r\n                && mediaTrack.getTrackId() == trackId) {\r\n                return mediaTrack;\r\n            }\r\n\r\n            /* eslint-enable eqeqeq */\r\n        }\r\n    }\r\n\r\n    return undefined;\r\n};\r\n\r\n/**\r\n * Removes all JitsiRemoteTracks associated with given MUC nickname\r\n * (resource part of the JID). Returns array of removed tracks.\r\n *\r\n * @param {string} owner - The resource part of the MUC JID.\r\n * @returns {JitsiRemoteTrack[]}\r\n */\r\nTraceablePeerConnection.prototype.removeRemoteTracks = function(owner) {\r\n    const removedTracks = [];\r\n    const remoteTracksMap = this.remoteTracks.get(owner);\r\n\r\n    if (remoteTracksMap) {\r\n        const removedAudioTrack = remoteTracksMap.get(MediaType.AUDIO);\r\n        const removedVideoTrack = remoteTracksMap.get(MediaType.VIDEO);\r\n\r\n        removedAudioTrack && removedTracks.push(removedAudioTrack);\r\n        removedVideoTrack && removedTracks.push(removedVideoTrack);\r\n\r\n        this.remoteTracks.delete(owner);\r\n    }\r\n\r\n    logger.debug(\r\n        `${this} removed remote tracks for ${owner} count: ${\r\n            removedTracks.length}`);\r\n\r\n    return removedTracks;\r\n};\r\n\r\n/**\r\n * Removes and disposes given <tt>JitsiRemoteTrack</tt> instance. Emits\r\n * {@link RTCEvents.REMOTE_TRACK_REMOVED}.\r\n * @param {JitsiRemoteTrack} toBeRemoved\r\n */\r\nTraceablePeerConnection.prototype._removeRemoteTrack = function(toBeRemoved) {\r\n    toBeRemoved.dispose();\r\n    const participantId = toBeRemoved.getParticipantId();\r\n    const remoteTracksMap = this.remoteTracks.get(participantId);\r\n\r\n    if (!remoteTracksMap) {\r\n        logger.error(\r\n            `removeRemoteTrack: no remote tracks map for ${participantId}`);\r\n    } else if (!remoteTracksMap.delete(toBeRemoved.getType())) {\r\n        logger.error(\r\n            `Failed to remove ${toBeRemoved} - type mapping messed up ?`);\r\n    }\r\n    this.eventEmitter.emit(RTCEvents.REMOTE_TRACK_REMOVED, toBeRemoved);\r\n};\r\n\r\n/**\r\n * Removes and disposes <tt>JitsiRemoteTrack</tt> identified by given stream and\r\n * track ids.\r\n *\r\n * @param {string} streamId the media stream id as defined by the WebRTC\r\n * @param {string} trackId the media track id as defined by the WebRTC\r\n * @returns {JitsiRemoteTrack|undefined} the track which has been removed or\r\n * <tt>undefined</tt> if no track matching given stream and track ids was\r\n * found.\r\n */\r\nTraceablePeerConnection.prototype._removeRemoteTrackById = function(\r\n        streamId,\r\n        trackId) {\r\n    const toBeRemoved = this._getRemoteTrackById(streamId, trackId);\r\n\r\n    if (toBeRemoved) {\r\n        this._removeRemoteTrack(toBeRemoved);\r\n    }\r\n\r\n    return toBeRemoved;\r\n};\r\n\r\n/**\r\n * @typedef {Object} SSRCGroupInfo\r\n * @property {Array<number>} ssrcs group's SSRCs\r\n * @property {string} semantics\r\n */\r\n/**\r\n * @typedef {Object} TrackSSRCInfo\r\n * @property {Array<number>} ssrcs track's SSRCs\r\n * @property {Array<SSRCGroupInfo>} groups track's SSRC groups\r\n */\r\n/**\r\n * Returns map with keys msid and <tt>TrackSSRCInfo</tt> values.\r\n * @param {Object} desc the WebRTC SDP instance.\r\n * @return {Map<string,TrackSSRCInfo>}\r\n */\r\nfunction extractSSRCMap(desc) {\r\n    /**\r\n     * Track SSRC infos mapped by stream ID (msid)\r\n     * @type {Map<string,TrackSSRCInfo>}\r\n     */\r\n    const ssrcMap = new Map();\r\n\r\n    /**\r\n     * Groups mapped by primary SSRC number\r\n     * @type {Map<number,Array<SSRCGroupInfo>>}\r\n     */\r\n    const groupsMap = new Map();\r\n\r\n    if (typeof desc !== 'object' || desc === null\r\n        || typeof desc.sdp !== 'string') {\r\n        logger.warn('An empty description was passed as an argument.');\r\n\r\n        return ssrcMap;\r\n    }\r\n\r\n    const session = transform.parse(desc.sdp);\r\n\r\n    if (!Array.isArray(session.media)) {\r\n        return ssrcMap;\r\n    }\r\n\r\n    for (const mLine of session.media) {\r\n        if (!Array.isArray(mLine.ssrcs)) {\r\n            continue; // eslint-disable-line no-continue\r\n        }\r\n\r\n        if (Array.isArray(mLine.ssrcGroups)) {\r\n            for (const group of mLine.ssrcGroups) {\r\n                if (typeof group.semantics !== 'undefined'\r\n                    && typeof group.ssrcs !== 'undefined') {\r\n                    // Parse SSRCs and store as numbers\r\n                    const groupSSRCs\r\n                        = group.ssrcs.split(' ').map(\r\n                            ssrcStr => parseInt(ssrcStr, 10));\r\n                    const primarySSRC = groupSSRCs[0];\r\n\r\n                    // Note that group.semantics is already present\r\n\r\n                    group.ssrcs = groupSSRCs;\r\n\r\n                    // eslint-disable-next-line max-depth\r\n                    if (!groupsMap.has(primarySSRC)) {\r\n                        groupsMap.set(primarySSRC, []);\r\n                    }\r\n                    groupsMap.get(primarySSRC).push(group);\r\n                }\r\n            }\r\n        }\r\n        for (const ssrc of mLine.ssrcs) {\r\n            if (ssrc.attribute !== 'msid') {\r\n                continue; // eslint-disable-line no-continue\r\n            }\r\n\r\n            const msid = ssrc.value;\r\n            let ssrcInfo = ssrcMap.get(msid);\r\n\r\n            if (!ssrcInfo) {\r\n                ssrcInfo = {\r\n                    ssrcs: [],\r\n                    groups: [],\r\n                    msid\r\n                };\r\n                ssrcMap.set(msid, ssrcInfo);\r\n            }\r\n\r\n            const ssrcNumber = ssrc.id;\r\n\r\n            ssrcInfo.ssrcs.push(ssrcNumber);\r\n\r\n            if (groupsMap.has(ssrcNumber)) {\r\n                const ssrcGroups = groupsMap.get(ssrcNumber);\r\n\r\n                for (const group of ssrcGroups) {\r\n                    ssrcInfo.groups.push(group);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    return ssrcMap;\r\n}\r\n\r\n/**\r\n * Takes a SessionDescription object and returns a \"normalized\" version.\r\n * Currently it only takes care of ordering the a=ssrc lines.\r\n */\r\nconst normalizePlanB = function(desc) {\r\n    if (typeof desc !== 'object' || desc === null\r\n        || typeof desc.sdp !== 'string') {\r\n        logger.warn('An empty description was passed as an argument.');\r\n\r\n        return desc;\r\n    }\r\n\r\n    // eslint-disable-next-line no-shadow\r\n    const transform = require('sdp-transform');\r\n    const session = transform.parse(desc.sdp);\r\n\r\n    if (typeof session !== 'undefined'\r\n            && typeof session.media !== 'undefined'\r\n            && Array.isArray(session.media)) {\r\n        session.media.forEach(mLine => {\r\n\r\n            // Chrome appears to be picky about the order in which a=ssrc lines\r\n            // are listed in an m-line when rtx is enabled (and thus there are\r\n            // a=ssrc-group lines with FID semantics). Specifically if we have\r\n            // \"a=ssrc-group:FID S1 S2\" and the \"a=ssrc:S2\" lines appear before\r\n            // the \"a=ssrc:S1\" lines, SRD fails.\r\n            // So, put SSRC which appear as the first SSRC in an FID ssrc-group\r\n            // first.\r\n            const firstSsrcs = [];\r\n            const newSsrcLines = [];\r\n\r\n            if (typeof mLine.ssrcGroups !== 'undefined'\r\n                && Array.isArray(mLine.ssrcGroups)) {\r\n                mLine.ssrcGroups.forEach(group => {\r\n                    if (typeof group.semantics !== 'undefined'\r\n                        && group.semantics === 'FID') {\r\n                        if (typeof group.ssrcs !== 'undefined') {\r\n                            firstSsrcs.push(Number(group.ssrcs.split(' ')[0]));\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n\r\n            if (Array.isArray(mLine.ssrcs)) {\r\n                let i;\r\n\r\n                for (i = 0; i < mLine.ssrcs.length; i++) {\r\n                    if (typeof mLine.ssrcs[i] === 'object'\r\n                        && typeof mLine.ssrcs[i].id !== 'undefined'\r\n                        && firstSsrcs.indexOf(mLine.ssrcs[i].id) >= 0) {\r\n                        newSsrcLines.push(mLine.ssrcs[i]);\r\n                        delete mLine.ssrcs[i];\r\n                    }\r\n                }\r\n\r\n                for (i = 0; i < mLine.ssrcs.length; i++) {\r\n                    if (typeof mLine.ssrcs[i] !== 'undefined') {\r\n                        newSsrcLines.push(mLine.ssrcs[i]);\r\n                    }\r\n                }\r\n\r\n                mLine.ssrcs = newSsrcLines;\r\n            }\r\n        });\r\n    }\r\n\r\n    const resStr = transform.write(session);\r\n\r\n\r\n    return new RTCSessionDescription({\r\n        type: desc.type,\r\n        sdp: resStr\r\n    });\r\n};\r\n\r\n/**\r\n * Makes sure that both audio and video directions are configured as 'sendrecv'.\r\n * @param {Object} localDescription the SDP object as defined by WebRTC.\r\n */\r\nconst enforceSendRecv = function(localDescription) {\r\n    if (!localDescription) {\r\n        throw new Error('No local description passed in.');\r\n    }\r\n\r\n    const transformer = new SdpTransformWrap(localDescription.sdp);\r\n    const audioMedia = transformer.selectMedia('audio');\r\n    let changed = false;\r\n\r\n    if (audioMedia && audioMedia.direction !== 'sendrecv') {\r\n        audioMedia.direction = 'sendrecv';\r\n        changed = true;\r\n    }\r\n\r\n    const videoMedia = transformer.selectMedia('video');\r\n\r\n    if (videoMedia && videoMedia.direction !== 'sendrecv') {\r\n        videoMedia.direction = 'sendrecv';\r\n        changed = true;\r\n    }\r\n\r\n    if (changed) {\r\n        return new RTCSessionDescription({\r\n            type: localDescription.type,\r\n            sdp: transformer.toRawSDP()\r\n        });\r\n    }\r\n\r\n    return localDescription;\r\n};\r\n\r\n/**\r\n *\r\n * @param {JitsiLocalTrack} localTrack\r\n */\r\nTraceablePeerConnection.prototype.getLocalSSRC = function(localTrack) {\r\n    const ssrcInfo = this._getSSRC(localTrack.rtcId);\r\n\r\n    return ssrcInfo && ssrcInfo.ssrcs[0];\r\n};\r\n\r\n/**\r\n * When doing unified plan simulcast, we'll have a set of ssrcs with the\r\n * same msid but no ssrc-group, since unified plan signals the simulcast\r\n * group via the a=simulcast line.  Unfortunately, Jicofo will complain\r\n * if it sees ssrcs with matching msids but no ssrc-group, so we'll inject\r\n * an ssrc-group line to make Jicofo happy.\r\n * NOTE: unlike plan B simulcast, the ssrcs in this inject ssrc-group will\r\n * NOT necessarily be in order of quality (low to high) because:\r\n * a) when translating between unified plan and plan b the order of the ssrcs\r\n * is not preserved and\r\n * b) it isn't guaranteed that firefox will give them to us in order to begin\r\n * with\r\n * @param desc A session description object (with 'type' and 'sdp' fields)\r\n * @return A session description object with its sdp field modified to\r\n * contain an inject ssrc-group for simulcast\r\n */\r\nTraceablePeerConnection.prototype._injectSsrcGroupForUnifiedSimulcast\r\n    = function(desc) {\r\n        const sdp = transform.parse(desc.sdp);\r\n        const video = sdp.media.find(mline => mline.type === 'video');\r\n\r\n        if (video.simulcast_03) {\r\n            const ssrcs = [];\r\n\r\n            video.ssrcs.forEach(ssrc => {\r\n                if (ssrc.attribute === 'msid') {\r\n                    ssrcs.push(ssrc.id);\r\n                }\r\n            });\r\n            video.ssrcGroups = video.ssrcGroups || [];\r\n            if (video.ssrcGroups.find(group => group.semantics === 'SIM')) {\r\n                // Group already exists, no need to do anything\r\n                return desc;\r\n            }\r\n            video.ssrcGroups.push({\r\n                semantics: 'SIM',\r\n                ssrcs: ssrcs.join(' ')\r\n            });\r\n        }\r\n\r\n        return new RTCSessionDescription({\r\n            type: desc.type,\r\n            sdp: transform.write(sdp)\r\n        });\r\n    };\r\n\r\n/* eslint-disable-next-line vars-on-top */\r\nconst getters = {\r\n    signalingState() {\r\n        return this.peerconnection.signalingState;\r\n    },\r\n    iceConnectionState() {\r\n        return this.peerconnection.iceConnectionState;\r\n    },\r\n    localDescription() {\r\n        let desc = this.peerconnection.localDescription;\r\n\r\n        if (!desc) {\r\n            logger.debug('getLocalDescription no localDescription found');\r\n\r\n            return {};\r\n        }\r\n\r\n        this.trace('getLocalDescription::preTransform', dumpSDP(desc));\r\n\r\n        // if we're running on FF, transform to Plan B first.\r\n        if (browser.usesUnifiedPlan()) {\r\n            desc = this.interop.toPlanB(desc);\r\n            this.trace('getLocalDescription::postTransform (Plan B)',\r\n                dumpSDP(desc));\r\n\r\n            desc = this._injectSsrcGroupForUnifiedSimulcast(desc);\r\n            this.trace('getLocalDescription::postTransform (inject ssrc group)',\r\n                dumpSDP(desc));\r\n        }\r\n\r\n        if (browser.doesVideoMuteByStreamRemove()) {\r\n            desc = this.localSdpMunger.maybeAddMutedLocalVideoTracksToSDP(desc);\r\n            logger.debug(\r\n                'getLocalDescription::postTransform (munge local SDP)', desc);\r\n        }\r\n\r\n        // What comes out of this getter will be signalled over Jingle to\r\n        // the other peer, so we need to make sure the media direction is\r\n        // 'sendrecv' because we won't change the direction later and don't want\r\n        // the other peer to think we can't send or receive.\r\n        //\r\n        // Note that the description we set in chrome does have the accurate\r\n        // direction (e.g. 'recvonly'), since that is technically what is\r\n        // happening (check setLocalDescription impl).\r\n        desc = enforceSendRecv(desc);\r\n\r\n        // See the method's doc for more info about this transformation.\r\n        desc = this.localSdpMunger.transformStreamIdentifiers(desc);\r\n\r\n        return desc;\r\n    },\r\n    remoteDescription() {\r\n        let desc = this.peerconnection.remoteDescription;\r\n\r\n        this.trace('getRemoteDescription::preTransform', dumpSDP(desc));\r\n\r\n        // if we're running on FF, transform to Plan B first.\r\n        if (browser.usesUnifiedPlan()) {\r\n            desc = this.interop.toPlanB(desc);\r\n            this.trace(\r\n                'getRemoteDescription::postTransform (Plan B)', dumpSDP(desc));\r\n        }\r\n\r\n        return desc || {};\r\n    }\r\n};\r\n\r\nObject.keys(getters).forEach(prop => {\r\n    Object.defineProperty(\r\n        TraceablePeerConnection.prototype,\r\n        prop, {\r\n            get: getters[prop]\r\n        }\r\n    );\r\n});\r\n\r\nTraceablePeerConnection.prototype._getSSRC = function(rtcId) {\r\n    return this.localSSRCs.get(rtcId);\r\n};\r\n\r\n/**\r\n * Add {@link JitsiLocalTrack} to this TPC.\r\n * @param {JitsiLocalTrack} track\r\n */\r\nTraceablePeerConnection.prototype.addTrack = function(track) {\r\n    const rtcId = track.rtcId;\r\n\r\n    logger.info(`add ${track} to: ${this}`);\r\n\r\n    if (this.localTracks.has(rtcId)) {\r\n        logger.error(`${track} is already in ${this}`);\r\n\r\n        return;\r\n    }\r\n\r\n    this.localTracks.set(rtcId, track);\r\n\r\n    const webrtcStream = track.getOriginalStream();\r\n\r\n    if (webrtcStream) {\r\n        this._addStream(webrtcStream);\r\n\r\n    // It's not ok for a track to not have a WebRTC stream if:\r\n    } else if (!browser.doesVideoMuteByStreamRemove()\r\n                || track.isAudioTrack()\r\n                || (track.isVideoTrack() && !track.isMuted())) {\r\n        logger.error(`${this} no WebRTC stream for: ${track}`);\r\n    }\r\n\r\n    // Muted video tracks do not have WebRTC stream\r\n    if (browser.doesVideoMuteByStreamRemove()\r\n            && track.isVideoTrack() && track.isMuted()) {\r\n        const ssrcInfo = this.generateNewStreamSSRCInfo(track);\r\n\r\n        this.sdpConsistency.setPrimarySsrc(ssrcInfo.ssrcs[0]);\r\n        const simGroup\r\n            = ssrcInfo.groups.find(groupInfo => groupInfo.semantics === 'SIM');\r\n\r\n        if (simGroup) {\r\n            this.simulcast.setSsrcCache(simGroup.ssrcs);\r\n        }\r\n        const fidGroups\r\n            = ssrcInfo.groups.filter(\r\n                groupInfo => groupInfo.semantics === 'FID');\r\n\r\n        if (fidGroups) {\r\n            const rtxSsrcMapping = new Map();\r\n\r\n            fidGroups.forEach(fidGroup => {\r\n                const primarySsrc = fidGroup.ssrcs[0];\r\n                const rtxSsrc = fidGroup.ssrcs[1];\r\n\r\n                rtxSsrcMapping.set(primarySsrc, rtxSsrc);\r\n            });\r\n            this.rtxModifier.setSsrcCache(rtxSsrcMapping);\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * Adds local track as part of the unmute operation.\r\n * @param {JitsiLocalTrack} track the track to be added as part of the unmute\r\n * operation\r\n * @return {boolean} <tt>true</tt> if the state of underlying PC has changed and\r\n * the renegotiation is required or <tt>false</tt> otherwise.\r\n */\r\nTraceablePeerConnection.prototype.addTrackUnmute = function(track) {\r\n    if (!this._assertTrackBelongs('addTrackUnmute', track)) {\r\n        // Abort\r\n        return false;\r\n    }\r\n\r\n    logger.info(`Adding ${track} as unmute to ${this}`);\r\n    const webRtcStream = track.getOriginalStream();\r\n\r\n    if (!webRtcStream) {\r\n        logger.error(\r\n            `Unable to add ${track} as unmute to ${this} - no WebRTC stream`);\r\n\r\n        return false;\r\n    }\r\n    this._addStream(webRtcStream);\r\n\r\n    return true;\r\n};\r\n\r\n/**\r\n * Adds WebRTC media stream to the underlying PeerConnection\r\n * @param {MediaStream} mediaStream\r\n * @private\r\n */\r\nTraceablePeerConnection.prototype._addStream = function(mediaStream) {\r\n    this.peerconnection.addStream(mediaStream);\r\n    this._addedStreams.push(mediaStream);\r\n};\r\n\r\n/**\r\n * Removes WebRTC media stream from the underlying PeerConection\r\n * @param {MediaStream} mediaStream\r\n */\r\nTraceablePeerConnection.prototype._removeStream = function(mediaStream) {\r\n    if (browser.isFirefox()) {\r\n        this._handleFirefoxRemoveStream(mediaStream);\r\n    } else {\r\n        this.peerconnection.removeStream(mediaStream);\r\n    }\r\n    this._addedStreams\r\n        = this._addedStreams.filter(stream => stream !== mediaStream);\r\n};\r\n\r\n/**\r\n * This method when called will check if given <tt>localTrack</tt> belongs to\r\n * this TPC (that it has been previously added using {@link addTrack}). If the\r\n * track does not belong an error message will be logged.\r\n * @param {string} methodName the method name that will be logged in an error\r\n * message\r\n * @param {JitsiLocalTrack} localTrack\r\n * @return {boolean} <tt>true</tt> if given local track belongs to this TPC or\r\n * <tt>false</tt> otherwise.\r\n * @private\r\n */\r\nTraceablePeerConnection.prototype._assertTrackBelongs = function(\r\n        methodName,\r\n        localTrack) {\r\n    const doesBelong = this.localTracks.has(localTrack.rtcId);\r\n\r\n    if (!doesBelong) {\r\n        logger.error(\r\n            `${methodName}: ${localTrack} does not belong to ${this}`);\r\n    }\r\n\r\n    return doesBelong;\r\n};\r\n\r\n/**\r\n * Tells if the given WebRTC <tt>MediaStream</tt> has been added to\r\n * the underlying WebRTC PeerConnection.\r\n * @param {MediaStream} mediaStream\r\n * @returns {boolean}\r\n */\r\nTraceablePeerConnection.prototype.isMediaStreamInPc = function(mediaStream) {\r\n    return this._addedStreams.indexOf(mediaStream) > -1;\r\n};\r\n\r\n/**\r\n * Remove local track from this TPC.\r\n * @param {JitsiLocalTrack} localTrack the track to be removed from this TPC.\r\n *\r\n * FIXME It should probably remove a boolean just like {@link removeTrackMute}\r\n *       The same applies to addTrack.\r\n */\r\nTraceablePeerConnection.prototype.removeTrack = function(localTrack) {\r\n    const webRtcStream = localTrack.getOriginalStream();\r\n\r\n    this.trace(\r\n        'removeStream',\r\n        localTrack.rtcId, webRtcStream ? webRtcStream.id : undefined);\r\n\r\n    if (!this._assertTrackBelongs('removeStream', localTrack)) {\r\n        // Abort - nothing to be done here\r\n        return;\r\n    }\r\n    this.localTracks.delete(localTrack.rtcId);\r\n    this.localSSRCs.delete(localTrack.rtcId);\r\n\r\n    if (webRtcStream) {\r\n        if (browser.isFirefox()) {\r\n            this._handleFirefoxRemoveStream(webRtcStream);\r\n        } else {\r\n            this.peerconnection.removeStream(webRtcStream);\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * Removes local track as part of the mute operation.\r\n * @param {JitsiLocalTrack} localTrack the local track to be remove as part of\r\n * the mute operation.\r\n * @return {boolean} <tt>true</tt> if the underlying PeerConnection's state has\r\n * changed and the renegotiation is required or <tt>false</tt> otherwise.\r\n */\r\nTraceablePeerConnection.prototype.removeTrackMute = function(localTrack) {\r\n    const webRtcStream = localTrack.getOriginalStream();\r\n\r\n    this.trace(\r\n        'removeStreamMute',\r\n        localTrack.rtcId, webRtcStream ? webRtcStream.id : null);\r\n\r\n    if (!this._assertTrackBelongs('removeStreamMute', localTrack)) {\r\n        // Abort - nothing to be done here\r\n        return false;\r\n    }\r\n\r\n    if (webRtcStream) {\r\n        logger.info(\r\n            `Removing ${localTrack} as mute from ${this}`);\r\n        this._removeStream(webRtcStream);\r\n\r\n        return true;\r\n    }\r\n\r\n    logger.error(`removeStreamMute - no WebRTC stream for ${localTrack}`);\r\n\r\n    return false;\r\n};\r\n\r\n/**\r\n * Remove stream handling for firefox\r\n * @param stream: webrtc media stream\r\n */\r\nTraceablePeerConnection.prototype._handleFirefoxRemoveStream = function(\r\n        stream) {\r\n    if (!stream) {\r\n        // There is nothing to be changed\r\n        return;\r\n    }\r\n    let sender = null;\r\n\r\n    // On Firefox we don't replace MediaStreams as this messes up the\r\n    // m-lines (which can't be removed in Plan Unified) and brings a lot\r\n    // of complications. Instead, we use the RTPSender and remove just\r\n    // the track.\r\n    let track = null;\r\n\r\n    if (stream.getAudioTracks() && stream.getAudioTracks().length) {\r\n        track = stream.getAudioTracks()[0];\r\n    } else if (stream.getVideoTracks() && stream.getVideoTracks().length) {\r\n        track = stream.getVideoTracks()[0];\r\n    }\r\n\r\n    if (!track) {\r\n        logger.error('Cannot remove tracks: no tracks.');\r\n\r\n        return;\r\n    }\r\n\r\n    // Find the right sender (for audio or video)\r\n    this.peerconnection.getSenders().some(s => {\r\n        if (s.track === track) {\r\n            sender = s;\r\n\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    });\r\n\r\n    if (sender) {\r\n        this.peerconnection.removeTrack(sender);\r\n    } else {\r\n        logger.log('Cannot remove tracks: no RTPSender.');\r\n    }\r\n};\r\n\r\nTraceablePeerConnection.prototype.createDataChannel = function(label, opts) {\r\n    this.trace('createDataChannel', label, opts);\r\n\r\n    return this.peerconnection.createDataChannel(label, opts);\r\n};\r\n\r\n/**\r\n * Ensures that the simulcast ssrc-group appears after any other ssrc-groups\r\n * in the SDP so that simulcast is properly activated.\r\n *\r\n * @param {Object} localSdp the WebRTC session description instance for\r\n * the local description.\r\n * @private\r\n */\r\nTraceablePeerConnection.prototype._ensureSimulcastGroupIsLast = function(\r\n        localSdp) {\r\n    let sdpStr = localSdp.sdp;\r\n\r\n    const videoStartIndex = sdpStr.indexOf('m=video');\r\n    const simStartIndex = sdpStr.indexOf('a=ssrc-group:SIM', videoStartIndex);\r\n    let otherStartIndex = sdpStr.lastIndexOf('a=ssrc-group');\r\n\r\n    if (simStartIndex === -1\r\n        || otherStartIndex === -1\r\n        || otherStartIndex === simStartIndex) {\r\n        return localSdp;\r\n    }\r\n\r\n    const simEndIndex = sdpStr.indexOf('\\r\\n', simStartIndex);\r\n    const simStr = sdpStr.substring(simStartIndex, simEndIndex + 2);\r\n\r\n    sdpStr = sdpStr.replace(simStr, '');\r\n    otherStartIndex = sdpStr.lastIndexOf('a=ssrc-group');\r\n    const otherEndIndex = sdpStr.indexOf('\\r\\n', otherStartIndex);\r\n    const sdpHead = sdpStr.slice(0, otherEndIndex);\r\n    const simStrTrimmed = simStr.trim();\r\n    const sdpTail = sdpStr.slice(otherEndIndex);\r\n\r\n    sdpStr = `${sdpHead}\\r\\n${simStrTrimmed}${sdpTail}`;\r\n\r\n    return new RTCSessionDescription({\r\n        type: localSdp.type,\r\n        sdp: sdpStr\r\n    });\r\n};\r\n\r\n/**\r\n * Will adjust audio and video media direction in the given SDP object to\r\n * reflect the current status of the {@link audioTransferActive} and\r\n * {@link videoTransferActive} flags.\r\n * @param {Object} localDescription the WebRTC session description instance for\r\n * the local description.\r\n * @private\r\n */\r\nTraceablePeerConnection.prototype._adjustLocalMediaDirection = function(\r\n        localDescription) {\r\n    const transformer = new SdpTransformWrap(localDescription.sdp);\r\n    let modifiedDirection = false;\r\n    const audioMedia = transformer.selectMedia('audio');\r\n\r\n    if (audioMedia) {\r\n        const desiredAudioDirection\r\n            = this._getDesiredMediaDirection(MediaType.AUDIO);\r\n\r\n        if (audioMedia.direction !== desiredAudioDirection) {\r\n            audioMedia.direction = desiredAudioDirection;\r\n            logger.info(\r\n                `Adjusted local audio direction to ${desiredAudioDirection}`);\r\n            modifiedDirection = true;\r\n        }\r\n    } else {\r\n        logger.warn('No \"audio\" media found int the local description');\r\n    }\r\n\r\n    const videoMedia = transformer.selectMedia('video');\r\n\r\n    if (videoMedia) {\r\n        const desiredVideoDirection\r\n            = this._getDesiredMediaDirection(MediaType.VIDEO);\r\n\r\n        if (videoMedia.direction !== desiredVideoDirection) {\r\n            videoMedia.direction = desiredVideoDirection;\r\n            logger.info(\r\n                `Adjusted local video direction to ${desiredVideoDirection}`);\r\n            modifiedDirection = true;\r\n        }\r\n    } else {\r\n        logger.warn('No \"video\" media found in the local description');\r\n    }\r\n\r\n    if (modifiedDirection) {\r\n        return new RTCSessionDescription({\r\n            type: localDescription.type,\r\n            sdp: transformer.toRawSDP()\r\n        });\r\n    }\r\n\r\n    return localDescription;\r\n};\r\n\r\nTraceablePeerConnection.prototype.setLocalDescription = function(\r\n        description,\r\n        successCallback,\r\n        failureCallback) {\r\n    let localSdp = description;\r\n\r\n    this.trace('setLocalDescription::preTransform', dumpSDP(localSdp));\r\n\r\n    if (this.options.disableH264 || this.options.preferH264) {\r\n        const parsedSdp = transform.parse(localSdp.sdp);\r\n        const videoMLine = parsedSdp.media.find(m => m.type === 'video');\r\n\r\n        if (this.options.disableH264) {\r\n            SDPUtil.stripVideoCodec(videoMLine, 'h264');\r\n        } else {\r\n            SDPUtil.preferVideoCodec(videoMLine, 'h264');\r\n        }\r\n\r\n        localSdp = new RTCSessionDescription({\r\n            type: localSdp.type,\r\n            sdp: transform.write(parsedSdp)\r\n        });\r\n\r\n        this.trace('setLocalDescription::postTransform (H264)',\r\n            dumpSDP(localSdp));\r\n    }\r\n\r\n    localSdp = this._adjustLocalMediaDirection(localSdp);\r\n\r\n    localSdp = this._ensureSimulcastGroupIsLast(localSdp);\r\n\r\n    // if we're using unified plan, transform to it first.\r\n    if (browser.usesUnifiedPlan()) {\r\n        localSdp = this.interop.toUnifiedPlan(localSdp);\r\n        this.trace(\r\n            'setLocalDescription::postTransform (Unified Plan)',\r\n            dumpSDP(localSdp));\r\n    }\r\n\r\n    this.peerconnection.setLocalDescription(localSdp,\r\n        () => {\r\n            this.trace('setLocalDescriptionOnSuccess');\r\n            const localUfrag = SDPUtil.getUfrag(localSdp.sdp);\r\n\r\n            if (localUfrag !== this.localUfrag) {\r\n                this.localUfrag = localUfrag;\r\n                this.eventEmitter.emit(\r\n                    RTCEvents.LOCAL_UFRAG_CHANGED, this, localUfrag);\r\n            }\r\n            successCallback();\r\n        },\r\n        err => {\r\n            this.trace('setLocalDescriptionOnFailure', err);\r\n            this.eventEmitter.emit(\r\n                RTCEvents.SET_LOCAL_DESCRIPTION_FAILED,\r\n                err, this);\r\n            failureCallback(err);\r\n        }\r\n    );\r\n};\r\n\r\n/**\r\n * Enables/disables audio media transmission on this peer connection. When\r\n * disabled the SDP audio media direction in the local SDP will be adjusted to\r\n * 'inactive' which means that no data will be sent nor accepted, but\r\n * the connection should be kept alive.\r\n * @param {boolean} active <tt>true</tt> to enable video media transmission or\r\n * <tt>false</tt> to disable. If the value is not a boolean the call will have\r\n * no effect.\r\n * @return {boolean} <tt>true</tt> if the value has changed and sRD/sLD cycle\r\n * needs to be executed in order for the changes to take effect or\r\n * <tt>false</tt> if the given value was the same as the previous one.\r\n * @public\r\n */\r\nTraceablePeerConnection.prototype.setAudioTransferActive = function(active) {\r\n    logger.debug(`${this} audio transfer active: ${active}`);\r\n    const changed = this.audioTransferActive !== active;\r\n\r\n    this.audioTransferActive = active;\r\n\r\n    return changed;\r\n};\r\n\r\n/**\r\n * Takes in a *unified plan* offer and inserts the appropriate\r\n * parameters for adding simulcast receive support.\r\n * @param {Object} desc - A session description object\r\n * @param {String} desc.type - the type (offer/answer)\r\n * @param {String} desc.sdp - the sdp content\r\n *\r\n * @return {Object} A session description (same format as above) object\r\n * with its sdp field modified to advertise simulcast receive support\r\n */\r\nTraceablePeerConnection.prototype._insertUnifiedPlanSimulcastReceive\r\n    = function(desc) {\r\n        const sdp = transform.parse(desc.sdp);\r\n        const video = sdp.media.find(mline => mline.type === 'video');\r\n\r\n        // In order of lowest to highest spatial quality\r\n        video.rids = [\r\n            {\r\n                id: SIM_LAYER_1_RID,\r\n                direction: 'recv'\r\n            },\r\n            {\r\n                id: SIM_LAYER_2_RID,\r\n                direction: 'recv'\r\n            },\r\n            {\r\n                id: SIM_LAYER_3_RID,\r\n                direction: 'recv'\r\n            }\r\n        ];\r\n        // eslint-disable-next-line camelcase\r\n        video.simulcast_03 = {\r\n            value: `recv rid=${SIM_LAYER_RIDS.join(';')}`\r\n        };\r\n\r\n        return new RTCSessionDescription({\r\n            type: desc.type,\r\n            sdp: transform.write(sdp)\r\n        });\r\n    };\r\n\r\nTraceablePeerConnection.prototype.setRemoteDescription = function(\r\n        description,\r\n        successCallback,\r\n        failureCallback) {\r\n    this.trace('setRemoteDescription::preTransform', dumpSDP(description));\r\n\r\n    // TODO the focus should squeze or explode the remote simulcast\r\n    // eslint-disable-next-line no-param-reassign\r\n    description = this.simulcast.mungeRemoteDescription(description);\r\n    this.trace(\r\n        'setRemoteDescription::postTransform (simulcast)',\r\n        dumpSDP(description));\r\n\r\n    if (this.options.preferH264) {\r\n        const parsedSdp = transform.parse(description.sdp);\r\n        const videoMLine = parsedSdp.media.find(m => m.type === 'video');\r\n\r\n        SDPUtil.preferVideoCodec(videoMLine, 'h264');\r\n\r\n        // eslint-disable-next-line no-param-reassign\r\n        description = new RTCSessionDescription({\r\n            type: description.type,\r\n            sdp: transform.write(parsedSdp)\r\n        });\r\n    }\r\n\r\n    // If the browser uses unified plan, transform to it first\r\n    if (browser.usesUnifiedPlan()) {\r\n        // eslint-disable-next-line no-param-reassign\r\n        description = new RTCSessionDescription({\r\n            type: description.type,\r\n            sdp: this.rtxModifier.stripRtx(description.sdp)\r\n        });\r\n\r\n        this.trace(\r\n            'setRemoteDescription::postTransform (stripRtx)',\r\n            dumpSDP(description));\r\n\r\n        // eslint-disable-next-line no-param-reassign\r\n        description = this.interop.toUnifiedPlan(description);\r\n        this.trace(\r\n            'setRemoteDescription::postTransform (Plan A)',\r\n            dumpSDP(description));\r\n\r\n        if (this.isSimulcastOn()) {\r\n            // eslint-disable-next-line no-param-reassign\r\n            description = this._insertUnifiedPlanSimulcastReceive(description);\r\n            this.trace(\r\n                'setRemoteDescription::postTransform (sim receive)',\r\n                dumpSDP(description));\r\n        }\r\n    } else {\r\n        // Plan B\r\n        // eslint-disable-next-line no-param-reassign\r\n        description = normalizePlanB(description);\r\n    }\r\n\r\n    // Safari WebRTC errors when no supported video codec is found in the offer.\r\n    // To prevent the error, inject H264 into the video mLine.\r\n    if (browser.isSafariWithWebrtc()) {\r\n        logger.debug('Maybe injecting H264 into the remote description');\r\n\r\n        // eslint-disable-next-line no-param-reassign\r\n        description = this._injectH264IfNotPresent(description);\r\n    }\r\n\r\n    this.peerconnection.setRemoteDescription(\r\n        description,\r\n        () => {\r\n            this.trace('setRemoteDescriptionOnSuccess');\r\n            const remoteUfrag = SDPUtil.getUfrag(description.sdp);\r\n\r\n            if (remoteUfrag !== this.remoteUfrag) {\r\n                this.remoteUfrag = remoteUfrag;\r\n                this.eventEmitter.emit(\r\n                    RTCEvents.REMOTE_UFRAG_CHANGED, this, remoteUfrag);\r\n            }\r\n            successCallback();\r\n        },\r\n        err => {\r\n            this.trace('setRemoteDescriptionOnFailure', err);\r\n            this.eventEmitter.emit(\r\n                RTCEvents.SET_REMOTE_DESCRIPTION_FAILED,\r\n                err,\r\n                this);\r\n            failureCallback(err);\r\n        });\r\n};\r\n\r\n/**\r\n * Inserts an H264 payload into the description if not already present. This is\r\n * need for Safari WebRTC, which errors when no supported video codec is found\r\n * in the offer. Related bug reports:\r\n * https://bugs.webkit.org/show_bug.cgi?id=173141\r\n * https://bugs.chromium.org/p/webrtc/issues/detail?id=4957\r\n *\r\n * @param {RTCSessionDescription} description - An RTCSessionDescription\r\n * to inject with an H264 payload.\r\n * @private\r\n * @returns {RTCSessionDescription}\r\n */\r\nTraceablePeerConnection.prototype._injectH264IfNotPresent = function(\r\n        description) {\r\n    const parsedSdp = transform.parse(description.sdp);\r\n    const videoMLine = parsedSdp.media.find(m => m.type === 'video');\r\n\r\n    if (!videoMLine) {\r\n        logger.debug('No videoMLine found, no need to inject H264.');\r\n\r\n        return description;\r\n    }\r\n\r\n    if (videoMLine.rtp.some(rtp => rtp.codec.toLowerCase() === 'h264')) {\r\n        logger.debug('H264 codec found in video mLine, no need to inject.');\r\n\r\n        return description;\r\n    }\r\n\r\n    const { fmtp, payloads, rtp } = videoMLine;\r\n    const payloadsArray = payloads.toString().split(' ');\r\n    let dummyPayloadType;\r\n\r\n    for (let i = 127; i >= 96; i--) {\r\n        if (!payloadsArray.includes(i)) {\r\n            dummyPayloadType = i;\r\n            payloadsArray.push(i);\r\n            videoMLine.payloads = payloadsArray.join(' ');\r\n            break;\r\n        }\r\n    }\r\n\r\n    if (typeof dummyPayloadType === 'undefined') {\r\n        logger.error('Could not find valid payload type to inject.');\r\n\r\n        return description;\r\n    }\r\n\r\n    rtp.push({\r\n        codec: 'H264',\r\n        payload: dummyPayloadType,\r\n        rate: 90000\r\n    });\r\n\r\n    fmtp.push({\r\n        config: 'level-asymmetry-allowed=1;'\r\n            + 'packetization-mode=1;'\r\n            + 'profile-level-id=42e01f',\r\n        payload: dummyPayloadType\r\n    });\r\n\r\n    logger.debug(\r\n        `Injecting H264 payload type ${dummyPayloadType} into video mLine.`);\r\n\r\n    return new RTCSessionDescription({\r\n        type: description.type,\r\n        sdp: transform.write(parsedSdp)\r\n    });\r\n};\r\n\r\n/**\r\n * Enables/disables video media transmission on this peer connection. When\r\n * disabled the SDP video media direction in the local SDP will be adjusted to\r\n * 'inactive' which means that no data will be sent nor accepted, but\r\n * the connection should be kept alive.\r\n * @param {boolean} active <tt>true</tt> to enable video media transmission or\r\n * <tt>false</tt> to disable. If the value is not a boolean the call will have\r\n * no effect.\r\n * @return {boolean} <tt>true</tt> if the value has changed and sRD/sLD cycle\r\n * needs to be executed in order for the changes to take effect or\r\n * <tt>false</tt> if the given value was the same as the previous one.\r\n * @public\r\n */\r\nTraceablePeerConnection.prototype.setVideoTransferActive = function(active) {\r\n    logger.debug(`${this} video transfer active: ${active}`);\r\n    const changed = this.videoTransferActive !== active;\r\n\r\n    this.videoTransferActive = active;\r\n\r\n    return changed;\r\n};\r\n\r\n/**\r\n * Makes the underlying TraceablePeerConnection generate new SSRC for\r\n * the recvonly video stream.\r\n */\r\nTraceablePeerConnection.prototype.generateRecvonlySsrc = function() {\r\n    const newSSRC = SDPUtil.generateSsrc();\r\n\r\n    logger.info(`${this} generated new recvonly SSRC: ${newSSRC}`);\r\n    this.sdpConsistency.setPrimarySsrc(newSSRC);\r\n};\r\n\r\n/**\r\n * Makes the underlying TraceablePeerConnection forget the current primary video\r\n * SSRC.\r\n */\r\nTraceablePeerConnection.prototype.clearRecvonlySsrc = function() {\r\n    logger.info('Clearing primary video SSRC!');\r\n    this.sdpConsistency.clearVideoSsrcCache();\r\n};\r\n\r\n/**\r\n * Closes underlying WebRTC PeerConnection instance and removes all remote\r\n * tracks by emitting {@link RTCEvents.REMOTE_TRACK_REMOVED} for each one of\r\n * them.\r\n */\r\nTraceablePeerConnection.prototype.close = function() {\r\n    this.trace('stop');\r\n\r\n    // Off SignalingEvents\r\n    this.signalingLayer.off(\r\n        SignalingEvents.PEER_MUTED_CHANGED, this._peerMutedChanged);\r\n    this.signalingLayer.off(\r\n        SignalingEvents.PEER_VIDEO_TYPE_CHANGED, this._peerVideoTypeChanged);\r\n\r\n    for (const peerTracks of this.remoteTracks.values()) {\r\n        for (const remoteTrack of peerTracks.values()) {\r\n            this._removeRemoteTrack(remoteTrack);\r\n        }\r\n    }\r\n    this.remoteTracks.clear();\r\n\r\n    this._addedStreams = [];\r\n\r\n    if (!this.rtc._removePeerConnection(this)) {\r\n        logger.error('RTC._removePeerConnection returned false');\r\n    }\r\n    if (this.statsinterval !== null) {\r\n        window.clearInterval(this.statsinterval);\r\n        this.statsinterval = null;\r\n    }\r\n    logger.info(`Closing ${this}...`);\r\n    this.peerconnection.close();\r\n};\r\n\r\n/**\r\n * Modifies the values of the setup attributes (defined by\r\n * {@link http://tools.ietf.org/html/rfc4145#section-4}) of a specific SDP\r\n * answer in order to overcome a delay of 1 second in the connection\r\n * establishment between Chrome and Videobridge.\r\n *\r\n * @param {SDP} offer - the SDP offer to which the specified SDP answer is\r\n * being prepared to respond\r\n * @param {SDP} answer - the SDP to modify\r\n * @private\r\n */\r\nconst _fixAnswerRFC4145Setup = function(offer, answer) {\r\n    if (!browser.isChrome()) {\r\n        // It looks like Firefox doesn't agree with the fix (at least in its\r\n        // current implementation) because it effectively remains active even\r\n        // after we tell it to become passive. Apart from Firefox which I tested\r\n        // after the fix was deployed, I tested Chrome only. In order to prevent\r\n        // issues with other browsers, limit the fix to Chrome for the time\r\n        // being.\r\n        return;\r\n    }\r\n\r\n    // XXX Videobridge is the (SDP) offerer and WebRTC (e.g. Chrome) is the\r\n    // answerer (as orchestrated by Jicofo). In accord with\r\n    // http://tools.ietf.org/html/rfc5245#section-5.2 and because both peers\r\n    // are ICE FULL agents, Videobridge will take on the controlling role and\r\n    // WebRTC will take on the controlled role. In accord with\r\n    // https://tools.ietf.org/html/rfc5763#section-5, Videobridge will use the\r\n    // setup attribute value of setup:actpass and WebRTC will be allowed to\r\n    // choose either the setup attribute value of setup:active or\r\n    // setup:passive. Chrome will by default choose setup:active because it is\r\n    // RECOMMENDED by the respective RFC since setup:passive adds additional\r\n    // latency. The case of setup:active allows WebRTC to send a DTLS\r\n    // ClientHello as soon as an ICE connectivity check of its succeeds.\r\n    // Unfortunately, Videobridge will be unable to respond immediately because\r\n    // may not have WebRTC's answer or may have not completed the ICE\r\n    // connectivity establishment. Even more unfortunate is that in the\r\n    // described scenario Chrome's DTLS implementation will insist on\r\n    // retransmitting its ClientHello after a second (the time is in accord\r\n    // with the respective RFC) and will thus cause the whole connection\r\n    // establishment to exceed at least 1 second. To work around Chrome's\r\n    // idiosyncracy, don't allow it to send a ClientHello i.e. change its\r\n    // default choice of setup:active to setup:passive.\r\n    if (offer && answer\r\n            && offer.media && answer.media\r\n            && offer.media.length === answer.media.length) {\r\n        answer.media.forEach((a, i) => {\r\n            if (SDPUtil.findLine(\r\n                    offer.media[i],\r\n                    'a=setup:actpass',\r\n                    offer.session)) {\r\n                answer.media[i]\r\n                    = a.replace(/a=setup:active/g, 'a=setup:passive');\r\n            }\r\n        });\r\n        answer.raw = answer.session + answer.media.join('');\r\n    }\r\n};\r\n\r\nTraceablePeerConnection.prototype.createAnswer = function(\r\n        successCallback,\r\n        failureCallback,\r\n        constraints) {\r\n    if (browser.supportsRtpSender() && this.isSimulcastOn()) {\r\n        const videoSender\r\n            = this.peerconnection.getSenders().find(sender =>\r\n                sender.track.kind === 'video');\r\n        const simParams = {\r\n            encodings: [\r\n                {\r\n                    rid: SIM_LAYER_1_RID,\r\n                    scaleResolutionDownBy: 4\r\n                },\r\n                {\r\n                    rid: SIM_LAYER_2_RID,\r\n                    scaleResolutionDownBy: 2\r\n                },\r\n                {\r\n                    rid: SIM_LAYER_3_RID\r\n                }\r\n            ]\r\n        };\r\n\r\n        videoSender.setParameters(simParams);\r\n    }\r\n    this._createOfferOrAnswer(\r\n        false /* answer */, successCallback, failureCallback, constraints);\r\n};\r\n\r\nTraceablePeerConnection.prototype.createOffer = function(\r\n        successCallback,\r\n        failureCallback,\r\n        constraints) {\r\n    this._createOfferOrAnswer(\r\n        true /* offer */, successCallback, failureCallback, constraints);\r\n};\r\n\r\n/* eslint-disable max-params */\r\n\r\nTraceablePeerConnection.prototype._createOfferOrAnswer = function(\r\n        isOffer,\r\n        successCallback,\r\n        failureCallback,\r\n        constraints) {\r\n    const logName = isOffer ? 'Offer' : 'Answer';\r\n\r\n    this.trace(`create${logName}`, JSON.stringify(constraints, null, ' '));\r\n\r\n    const _successCallback = resultSdp => {\r\n        try {\r\n            this.trace(\r\n                `create${logName}OnSuccess::preTransform`, dumpSDP(resultSdp));\r\n\r\n            // if we're using unified plan, transform to Plan B.\r\n            if (browser.usesUnifiedPlan()) {\r\n                // eslint-disable-next-line no-param-reassign\r\n                resultSdp = this.interop.toPlanB(resultSdp);\r\n                this.trace(\r\n                    `create${logName}OnSuccess::postTransform (Plan B)`,\r\n                    dumpSDP(resultSdp));\r\n                if (this.isSimulcastOn()) {\r\n                    // eslint-disable-next-line no-param-reassign\r\n                    resultSdp\r\n                        = this._injectSsrcGroupForUnifiedSimulcast(resultSdp);\r\n                    this.trace(\r\n                        `create${logName}OnSuccess::postTransform`\r\n                        + '(inject ssrc group)', dumpSDP(resultSdp));\r\n                }\r\n            }\r\n\r\n            /**\r\n             * We don't keep ssrcs consitent for Firefox because rewriting\r\n             *  the ssrcs between createAnswer and setLocalDescription breaks\r\n             *  the caching in sdp-interop (sdp-interop must know about all\r\n             *  ssrcs, and it updates its cache in toPlanB so if we rewrite them\r\n             *  after that, when we try and go back to unified plan it will\r\n             *  complain about unmapped ssrcs)\r\n             */\r\n            if (!browser.isFirefox()) {\r\n                // If there are no local video tracks, then a \"recvonly\"\r\n                // SSRC needs to be generated\r\n                if (!this.hasAnyTracksOfType(MediaType.VIDEO)\r\n                    && !this.sdpConsistency.hasPrimarySsrcCached()) {\r\n                    this.generateRecvonlySsrc();\r\n                }\r\n\r\n                // eslint-disable-next-line no-param-reassign\r\n                resultSdp = new RTCSessionDescription({\r\n                    type: resultSdp.type,\r\n                    sdp: this.sdpConsistency.makeVideoPrimarySsrcsConsistent(\r\n                        resultSdp.sdp)\r\n                });\r\n\r\n                this.trace(\r\n                    `create${logName}OnSuccess::postTransform `\r\n                         + '(make primary audio/video ssrcs consistent)',\r\n                    dumpSDP(resultSdp));\r\n            }\r\n\r\n            // Add simulcast streams if simulcast is enabled\r\n            if (this.isSimulcastOn()) {\r\n\r\n                // eslint-disable-next-line no-param-reassign\r\n                resultSdp = this.simulcast.mungeLocalDescription(resultSdp);\r\n                this.trace(\r\n                    `create${logName}`\r\n                        + 'OnSuccess::postTransform (simulcast)',\r\n                    dumpSDP(resultSdp));\r\n            }\r\n\r\n            if (!this.options.disableRtx && browser.supportsRtx()) {\r\n                // eslint-disable-next-line no-param-reassign\r\n                resultSdp = new RTCSessionDescription({\r\n                    type: resultSdp.type,\r\n                    sdp: this.rtxModifier.modifyRtxSsrcs(resultSdp.sdp)\r\n                });\r\n\r\n                this.trace(\r\n                    `create${logName}`\r\n                         + 'OnSuccess::postTransform (rtx modifier)',\r\n                    dumpSDP(resultSdp));\r\n            }\r\n\r\n            // Fix the setup attribute (see _fixAnswerRFC4145Setup for\r\n            //  details)\r\n            if (!isOffer) {\r\n                const remoteDescription\r\n                    = new SDP(this.remoteDescription.sdp);\r\n                const localDescription = new SDP(resultSdp.sdp);\r\n\r\n                _fixAnswerRFC4145Setup(remoteDescription, localDescription);\r\n\r\n                // eslint-disable-next-line no-param-reassign\r\n                resultSdp = new RTCSessionDescription({\r\n                    type: resultSdp.type,\r\n                    sdp: localDescription.raw\r\n                });\r\n            }\r\n\r\n            const ssrcMap = extractSSRCMap(resultSdp);\r\n\r\n            logger.debug('Got local SSRCs MAP: ', ssrcMap);\r\n            this._processLocalSSRCsMap(ssrcMap);\r\n\r\n            successCallback(resultSdp);\r\n        } catch (e) {\r\n            this.trace(`create${logName}OnError`, e);\r\n            this.trace(`create${logName}OnError`, dumpSDP(resultSdp));\r\n            logger.error(`create${logName}OnError`, e, dumpSDP(resultSdp));\r\n            failureCallback(e);\r\n        }\r\n    };\r\n\r\n    const _errorCallback = err => {\r\n        this.trace(`create${logName}OnFailure`, err);\r\n        const eventType\r\n            = isOffer\r\n                ? RTCEvents.CREATE_OFFER_FAILED\r\n                : RTCEvents.CREATE_ANSWER_FAILED;\r\n\r\n        this.eventEmitter.emit(eventType, err, this);\r\n        failureCallback(err);\r\n    };\r\n\r\n    // NOTE Temasys plugin does not support \"bind\" on peerconnection methods\r\n    if (isOffer) {\r\n        this.peerconnection.createOffer(\r\n            _successCallback, _errorCallback, constraints);\r\n    } else {\r\n        this.peerconnection.createAnswer(\r\n            _successCallback, _errorCallback, constraints);\r\n    }\r\n};\r\n\r\n/* eslint-enable max-params */\r\n\r\n/**\r\n * Extract primary SSRC from given {@link TrackSSRCInfo} object.\r\n * @param {TrackSSRCInfo} ssrcObj\r\n * @return {number|null} the primary SSRC or <tt>null</tt>\r\n */\r\nfunction extractPrimarySSRC(ssrcObj) {\r\n    if (ssrcObj && ssrcObj.groups && ssrcObj.groups.length) {\r\n        return ssrcObj.groups[0].ssrcs[0];\r\n    } else if (ssrcObj && ssrcObj.ssrcs && ssrcObj.ssrcs.length) {\r\n        return ssrcObj.ssrcs[0];\r\n    }\r\n\r\n    return null;\r\n}\r\n\r\n/**\r\n * Goes over the SSRC map extracted from the latest local description and tries\r\n * to match them with the local tracks (by MSID). Will update the values\r\n * currently stored in the {@link TraceablePeerConnection.localSSRCs} map.\r\n * @param {Map<string,TrackSSRCInfo>} ssrcMap\r\n * @private\r\n */\r\nTraceablePeerConnection.prototype._processLocalSSRCsMap = function(ssrcMap) {\r\n    for (const track of this.localTracks.values()) {\r\n        const trackMSID = track.getMSID();\r\n\r\n        if (ssrcMap.has(trackMSID)) {\r\n            const newSSRC = ssrcMap.get(trackMSID);\r\n\r\n            if (!newSSRC) {\r\n                logger.error(`No SSRC found for: ${trackMSID} in ${this}`);\r\n\r\n                return;\r\n            }\r\n            const oldSSRC = this.localSSRCs.get(track.rtcId);\r\n            const newSSRCNum = extractPrimarySSRC(newSSRC);\r\n            const oldSSRCNum = extractPrimarySSRC(oldSSRC);\r\n\r\n            // eslint-disable-next-line no-negated-condition\r\n            if (newSSRCNum !== oldSSRCNum) {\r\n                if (oldSSRCNum === null) {\r\n                    logger.info(\r\n                        `Storing new local SSRC for ${track} in ${this}`,\r\n                        newSSRC);\r\n                } else {\r\n                    logger.error(\r\n                        `Overwriting SSRC for ${track} ${trackMSID} in ${this\r\n                        } with: `, newSSRC);\r\n                }\r\n                this.localSSRCs.set(track.rtcId, newSSRC);\r\n\r\n                this.eventEmitter.emit(\r\n                    RTCEvents.LOCAL_TRACK_SSRC_UPDATED, track, newSSRCNum);\r\n            } else {\r\n                logger.debug(\r\n                    `The local SSRC(${newSSRCNum}) for ${track} ${trackMSID}`\r\n                     + `is still up to date in ${this}`);\r\n            }\r\n        } else {\r\n            logger.warn(`No local track matched with: ${trackMSID} in ${this}`);\r\n        }\r\n    }\r\n};\r\n\r\nTraceablePeerConnection.prototype.addIceCandidate = function(\r\n        candidate,\r\n        successCallback,\r\n        failureCallback) {\r\n    // var self = this;\r\n\r\n    // Calling JSON.stringify with temasys objects causes a stack overflow, so\r\n    // instead pick out values to log.\r\n    this.trace('addIceCandidate', JSON.stringify({\r\n        candidate: candidate.candidate,\r\n        sdpMid: candidate.sdpMid,\r\n        sdpMLineIndex: candidate.sdpMLineIndex,\r\n        usernameFragment: candidate.usernameFragment\r\n    }, null, ' '));\r\n    this.peerconnection.addIceCandidate(\r\n        candidate, successCallback, failureCallback);\r\n\r\n    /* maybe later\r\n     this.peerconnection.addIceCandidate(candidate,\r\n     function () {\r\n     self.trace('addIceCandidateOnSuccess');\r\n     successCallback();\r\n     },\r\n     function (err) {\r\n     self.trace('addIceCandidateOnFailure', err);\r\n     failureCallback(err);\r\n     }\r\n     );\r\n     */\r\n};\r\n\r\n/**\r\n * Obtains call-related stats from the peer connection.\r\n *\r\n * @param {Function} callback - The function to invoke after successfully\r\n * obtaining stats.\r\n * @param {Function} errback - The function to invoke after failing to obtain\r\n * stats.\r\n * @returns {void}\r\n */\r\nTraceablePeerConnection.prototype.getStats = function(callback, errback) {\r\n    // TODO: Is this the correct way to handle Opera, Temasys?\r\n    // TODO (brian): After moving all browsers to adapter, check if adapter is\r\n    // accounting for different getStats apis, making the browser-checking-if\r\n    // unnecessary.\r\n    if (browser.isFirefox()\r\n            || browser.isTemasysPluginUsed()\r\n            || browser.isReactNative()) {\r\n        this.peerconnection.getStats(\r\n            null,\r\n            callback,\r\n            errback || (() => {\r\n\r\n                // Making sure that getStats won't fail if error callback is\r\n                // not passed.\r\n            }));\r\n    } else if (browser.isSafariWithWebrtc()) {\r\n        // FIXME: Safari's native stats implementation is not compatibile with\r\n        // existing stats processing logic. Skip implementing stats for now to\r\n        // at least get native webrtc Safari available for use.\r\n    } else {\r\n        this.peerconnection.getStats(callback);\r\n    }\r\n};\r\n\r\n/**\r\n * Generates and stores new SSRC info object for given local track.\r\n * The method should be called only for a video track being added to this TPC\r\n * in the muted state (given that the current browser uses this strategy).\r\n * @param {JitsiLocalTrack} track\r\n * @return {TPCSSRCInfo}\r\n */\r\nTraceablePeerConnection.prototype.generateNewStreamSSRCInfo = function(track) {\r\n    const rtcId = track.rtcId;\r\n    let ssrcInfo = this._getSSRC(rtcId);\r\n\r\n    if (ssrcInfo) {\r\n        logger.error(`Will overwrite local SSRCs for track ID: ${rtcId}`);\r\n    }\r\n    if (this.isSimulcastOn()) {\r\n        ssrcInfo = {\r\n            ssrcs: [],\r\n            groups: []\r\n        };\r\n        for (let i = 0; i < SIMULCAST_LAYERS; i++) {\r\n            ssrcInfo.ssrcs.push(SDPUtil.generateSsrc());\r\n        }\r\n        ssrcInfo.groups.push({\r\n            ssrcs: ssrcInfo.ssrcs.slice(),\r\n            semantics: 'SIM'\r\n        });\r\n    } else {\r\n        ssrcInfo = {\r\n            ssrcs: [ SDPUtil.generateSsrc() ],\r\n            groups: []\r\n        };\r\n    }\r\n    if (!this.options.disableRtx && browser.supportsRtx()) {\r\n        // Specifically use a for loop here because we'll\r\n        //  be adding to the list we're iterating over, so we\r\n        //  only want to iterate through the items originally\r\n        //  on the list\r\n        const currNumSsrcs = ssrcInfo.ssrcs.length;\r\n\r\n        for (let i = 0; i < currNumSsrcs; ++i) {\r\n            const primarySsrc = ssrcInfo.ssrcs[i];\r\n            const rtxSsrc = SDPUtil.generateSsrc();\r\n\r\n            ssrcInfo.ssrcs.push(rtxSsrc);\r\n            ssrcInfo.groups.push({\r\n                ssrcs: [ primarySsrc, rtxSsrc ],\r\n                semantics: 'FID'\r\n            });\r\n        }\r\n    }\r\n    ssrcInfo.msid = track.storedMSID;\r\n    this.localSSRCs.set(rtcId, ssrcInfo);\r\n\r\n    return ssrcInfo;\r\n};\r\n\r\n/**\r\n * Creates a text representation of this <tt>TraceablePeerConnection</tt>\r\n * instance.\r\n * @return {string}\r\n */\r\nTraceablePeerConnection.prototype.toString = function() {\r\n    return `TPC[${this.id},p2p:${this.isP2P}]`;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/RTC/TraceablePeerConnection.js","import { createTtfmEvent } from '../../service/statistics/AnalyticsEvents';\r\nimport JitsiTrack from './JitsiTrack';\r\nimport * as JitsiTrackEvents from '../../JitsiTrackEvents';\r\nimport browser from '../browser';\r\nimport Statistics from '../statistics/statistics';\r\n\r\nconst logger = require('jitsi-meet-logger').getLogger(__filename);\r\nconst RTCEvents = require('../../service/RTC/RTCEvents');\r\n\r\nlet ttfmTrackerAudioAttached = false;\r\nlet ttfmTrackerVideoAttached = false;\r\n\r\n/* eslint-disable max-params */\r\n\r\n/**\r\n * Represents a single media track (either audio or video).\r\n */\r\nexport default class JitsiRemoteTrack extends JitsiTrack {\r\n    /**\r\n     * Creates new JitsiRemoteTrack instance.\r\n     * @param {RTC} rtc the RTC service instance.\r\n     * @param {JitsiConference} conference the conference to which this track\r\n     *        belongs to\r\n     * @param {string} ownerEndpointId the endpoint ID of the track owner\r\n     * @param {MediaStream} stream WebRTC MediaStream, parent of the track\r\n     * @param {MediaStreamTrack} track underlying WebRTC MediaStreamTrack for\r\n     *        the new JitsiRemoteTrack\r\n     * @param {MediaType} mediaType the type of the media\r\n     * @param {VideoType} videoType the type of the video if applicable\r\n     * @param {number} ssrc the SSRC number of the Media Stream\r\n     * @param {boolean} muted the initial muted state\r\n     * @param {boolean} isP2P indicates whether or not this track belongs to a\r\n     * P2P session\r\n     * @throws {TypeError} if <tt>ssrc</tt> is not a number.\r\n     * @constructor\r\n     */\r\n    constructor(\r\n            rtc,\r\n            conference,\r\n            ownerEndpointId,\r\n            stream,\r\n            track,\r\n            mediaType,\r\n            videoType,\r\n            ssrc,\r\n            muted,\r\n            isP2P) {\r\n        super(\r\n            conference,\r\n            stream,\r\n            track,\r\n            () => {\r\n                // Nothing to do if the track is inactive.\r\n            },\r\n            mediaType,\r\n            videoType);\r\n        this.rtc = rtc;\r\n\r\n        // Prevent from mixing up type of SSRC which should be a number\r\n        if (typeof ssrc !== 'number') {\r\n            throw new TypeError(`SSRC ${ssrc} is not a number`);\r\n        }\r\n        this.ssrc = ssrc;\r\n        this.ownerEndpointId = ownerEndpointId;\r\n        this.muted = muted;\r\n        this.isP2P = isP2P;\r\n\r\n        // we want to mark whether the track has been ever muted\r\n        // to detect ttfm events for startmuted conferences, as it can\r\n        // significantly increase ttfm values\r\n        this.hasBeenMuted = muted;\r\n\r\n        // Bind 'onmute' and 'onunmute' event handlers\r\n        if (this.rtc && this.track) {\r\n            this._bindMuteHandlers();\r\n        }\r\n    }\r\n\r\n    /* eslint-enable max-params */\r\n    /**\r\n     * Attaches the track muted handlers.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _bindMuteHandlers() {\r\n        // Use feature detection for finding what event handling function is\r\n        // supported. On Internet Explorer, which uses uses temasys/firebreath,\r\n        // the track will have attachEvent instead of addEventListener.\r\n        //\r\n        // FIXME it would be better to use recently added '_setHandler' method,\r\n        // but:\r\n        // 1. It does not allow to set more than one handler to the event\r\n        // 2. It does mix MediaStream('inactive') with MediaStreamTrack events\r\n        // 3. Allowing to bind more than one event handler requires too much\r\n        //    refactoring around camera issues detection.\r\n        if (this.track.addEventListener) {\r\n            this.track.addEventListener('mute', () => this._onTrackMute());\r\n            this.track.addEventListener('unmute', () => this._onTrackUnmute());\r\n        } else if (this.track.attachEvent) {\r\n            // FIXME Internet Explorer is not emitting out mute/unmute events.\r\n            this.track.attachEvent('onmute', () => this._onTrackMute());\r\n            this.track.attachEvent('onunmute', () => this._onTrackUnmute());\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Callback invoked when the track is muted. Emits an event notifying\r\n     * listeners of the mute event.\r\n     *\r\n     * @private\r\n     * @returns {void}\r\n     */\r\n    _onTrackMute() {\r\n        logger.debug(\r\n            `\"onmute\" event(${Date.now()}): `,\r\n            this.getParticipantId(), this.getType(), this.getSSRC());\r\n\r\n        this.rtc.eventEmitter.emit(RTCEvents.REMOTE_TRACK_MUTE, this);\r\n    }\r\n\r\n    /**\r\n     * Callback invoked when the track is unmuted. Emits an event notifying\r\n     * listeners of the mute event.\r\n     *\r\n     * @private\r\n     * @returns {void}\r\n     */\r\n    _onTrackUnmute() {\r\n        logger.debug(\r\n            `\"onunmute\" event(${Date.now()}): `,\r\n            this.getParticipantId(), this.getType(), this.getSSRC());\r\n\r\n        this.rtc.eventEmitter.emit(RTCEvents.REMOTE_TRACK_UNMUTE, this);\r\n    }\r\n\r\n    /**\r\n     * Sets current muted status and fires an events for the change.\r\n     * @param value the muted status.\r\n     */\r\n    setMute(value) {\r\n        if (this.muted === value) {\r\n            return;\r\n        }\r\n\r\n        if (value) {\r\n            this.hasBeenMuted = true;\r\n        }\r\n\r\n        // we can have a fake video stream\r\n        if (this.stream) {\r\n            this.stream.muted = value;\r\n        }\r\n\r\n        this.muted = value;\r\n        this.emit(JitsiTrackEvents.TRACK_MUTE_CHANGED, this);\r\n    }\r\n\r\n    /**\r\n     * Returns the current muted status of the track.\r\n     * @returns {boolean|*|JitsiRemoteTrack.muted} <tt>true</tt> if the track is\r\n     * muted and <tt>false</tt> otherwise.\r\n     */\r\n    isMuted() {\r\n        return this.muted;\r\n    }\r\n\r\n    /**\r\n     * Returns the participant id which owns the track.\r\n     *\r\n     * @returns {string} the id of the participants. It corresponds to the\r\n     * Colibri endpoint id/MUC nickname in case of Jitsi-meet.\r\n     */\r\n    getParticipantId() {\r\n        return this.ownerEndpointId;\r\n    }\r\n\r\n    /**\r\n     * Return false;\r\n     */\r\n    isLocal() {\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Returns the synchronization source identifier (SSRC) of this remote\r\n     * track.\r\n     *\r\n     * @returns {number} the SSRC of this remote track.\r\n     */\r\n    getSSRC() {\r\n        return this.ssrc;\r\n    }\r\n\r\n    /**\r\n     * Changes the video type of the track.\r\n     *\r\n     * @param {string} type - The new video type(\"camera\", \"desktop\").\r\n     */\r\n    _setVideoType(type) {\r\n        if (this.videoType === type) {\r\n            return;\r\n        }\r\n        this.videoType = type;\r\n        this.emit(JitsiTrackEvents.TRACK_VIDEOTYPE_CHANGED, type);\r\n    }\r\n\r\n    /**\r\n     * Handles track play events.\r\n     */\r\n    _playCallback() {\r\n        const type = this.isVideoTrack() ? 'video' : 'audio';\r\n\r\n        const now = window.performance.now();\r\n\r\n        console.log(`(TIME) Render ${type}:\\t`, now);\r\n        this.conference.getConnectionTimes()[`${type}.render`] = now;\r\n\r\n        // The conference can be started without calling GUM\r\n        // FIXME if there would be a module for connection times this kind\r\n        // of logic (gumDuration or ttfm) should end up there\r\n        const gumStart = window.connectionTimes['obtainPermissions.start'];\r\n        const gumEnd = window.connectionTimes['obtainPermissions.end'];\r\n        const gumDuration\r\n            = !isNaN(gumEnd) && !isNaN(gumStart) ? gumEnd - gumStart : 0;\r\n\r\n        // Subtract the muc.joined-to-session-initiate duration because jicofo\r\n        // waits until there are 2 participants to start Jingle sessions.\r\n        const ttfm = now\r\n            - (this.conference.getConnectionTimes()['session.initiate']\r\n                - this.conference.getConnectionTimes()['muc.joined'])\r\n            - gumDuration;\r\n\r\n        this.conference.getConnectionTimes()[`${type}.ttfm`] = ttfm;\r\n        console.log(`(TIME) TTFM ${type}:\\t`, ttfm);\r\n\r\n        Statistics.sendAnalytics(createTtfmEvent(\r\n            {\r\n                'media_type': type,\r\n                muted: this.hasBeenMuted,\r\n                value: ttfm\r\n            }));\r\n\r\n    }\r\n\r\n    /**\r\n     * Attach time to first media tracker only if there is conference and only\r\n     * for the first element.\r\n     * @param container the HTML container which can be 'video' or 'audio'\r\n     * element. It can also be 'object' element if Temasys plugin is in use and\r\n     * this method has been called previously on video or audio HTML element.\r\n     * @private\r\n     */\r\n    _attachTTFMTracker(container) {\r\n        if ((ttfmTrackerAudioAttached && this.isAudioTrack())\r\n            || (ttfmTrackerVideoAttached && this.isVideoTrack())) {\r\n            return;\r\n        }\r\n\r\n        if (this.isAudioTrack()) {\r\n            ttfmTrackerAudioAttached = true;\r\n        }\r\n        if (this.isVideoTrack()) {\r\n            ttfmTrackerVideoAttached = true;\r\n        }\r\n\r\n        if (browser.isTemasysPluginUsed()) {\r\n            // XXX Don't require Temasys unless it's to be used because it\r\n            // doesn't run on React Native, for example.\r\n            const AdapterJS = require('./adapter.screenshare');\r\n\r\n            // FIXME: this is not working for IE11\r\n            AdapterJS.addEvent(\r\n                container,\r\n                'play',\r\n                this._playCallback.bind(this));\r\n        } else {\r\n            container.addEventListener(\r\n                'canplay',\r\n                this._playCallback.bind(this));\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Creates a text representation of this remote track instance.\r\n     * @return {string}\r\n     */\r\n    toString() {\r\n        return `RemoteTrack[${\r\n            this.ownerEndpointId}, ${\r\n            this.getType()}, p2p: ${\r\n            this.isP2P}]`;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/RTC/JitsiRemoteTrack.js","/* global __filename */\r\n\r\nimport { getLogger } from 'jitsi-meet-logger';\r\nimport * as MediaType from '../../service/RTC/MediaType';\r\nimport { SdpTransformWrap } from '../xmpp/SdpTransformUtil';\r\n\r\nconst logger = getLogger(__filename);\r\n\r\n/**\r\n * Fakes local SDP exposed to {@link JingleSessionPC} through the local\r\n * description getter. Modifies the SDP, so that it will contain muted local\r\n * video tracks description, even though their underlying {MediaStreamTrack}s\r\n * are no longer in the WebRTC peerconnection. That prevents from SSRC updates\r\n * being sent to Jicofo/remote peer and prevents sRD/sLD cycle on the remote\r\n * side.\r\n */\r\nexport default class LocalSdpMunger {\r\n\r\n    /**\r\n     * Creates new <tt>LocalSdpMunger</tt> instance.\r\n     *\r\n     * @param {TraceablePeerConnection} tpc\r\n     */\r\n    constructor(tpc) {\r\n        this.tpc = tpc;\r\n    }\r\n\r\n    /**\r\n     * Makes sure that muted local video tracks associated with the parent\r\n     * {@link TraceablePeerConnection} are described in the local SDP. It's done\r\n     * in order to prevent from sending 'source-remove'/'source-add' Jingle\r\n     * notifications when local video track is muted (<tt>MediaStream</tt> is\r\n     * removed from the peerconnection).\r\n     *\r\n     * NOTE 1 video track is assumed\r\n     *\r\n     * @param {SdpTransformWrap} transformer the transformer instance which will\r\n     * be used to process the SDP.\r\n     * @return {boolean} <tt>true</tt> if there were any modifications to\r\n     * the SDP wrapped by <tt>transformer</tt>.\r\n     * @private\r\n     */\r\n    _addMutedLocalVideoTracksToSDP(transformer) {\r\n        // Go over each video tracks and check if the SDP has to be changed\r\n        const localVideos = this.tpc.getLocalTracks(MediaType.VIDEO);\r\n\r\n        if (!localVideos.length) {\r\n            return false;\r\n        } else if (localVideos.length !== 1) {\r\n            logger.error(\r\n                `${this.tpc} there is more than 1 video track ! `\r\n                    + 'Strange things may happen !', localVideos);\r\n        }\r\n\r\n        const videoMLine = transformer.selectMedia('video');\r\n\r\n        if (!videoMLine) {\r\n            logger.debug(\r\n                `${this.tpc} unable to hack local video track SDP`\r\n                    + '- no \"video\" media');\r\n\r\n            return false;\r\n        }\r\n\r\n        let modified = false;\r\n\r\n        for (const videoTrack of localVideos) {\r\n            const muted = videoTrack.isMuted();\r\n            const mediaStream = videoTrack.getOriginalStream();\r\n\r\n            // During the mute/unmute operation there are periods of time when\r\n            // the track's underlying MediaStream is not added yet to\r\n            // the PeerConnection. The SDP needs to be munged in such case.\r\n            const isInPeerConnection\r\n                = mediaStream && this.tpc.isMediaStreamInPc(mediaStream);\r\n            const shouldFakeSdp = muted || !isInPeerConnection;\r\n\r\n            logger.debug(\r\n                `${this.tpc} ${videoTrack} muted: ${\r\n                    muted}, is in PeerConnection: ${\r\n                    isInPeerConnection} => should fake sdp ? : ${\r\n                    shouldFakeSdp}`);\r\n\r\n            if (!shouldFakeSdp) {\r\n                continue; // eslint-disable-line no-continue\r\n            }\r\n\r\n            // Inject removed SSRCs\r\n            const requiredSSRCs\r\n                = this.tpc.isSimulcastOn()\r\n                    ? this.tpc.simulcast.ssrcCache\r\n                    : [ this.tpc.sdpConsistency.cachedPrimarySsrc ];\r\n\r\n            if (!requiredSSRCs.length) {\r\n                logger.error(\r\n                    `No SSRCs stored for: ${videoTrack} in ${this.tpc}`);\r\n\r\n                continue; // eslint-disable-line no-continue\r\n            }\r\n\r\n            modified = true;\r\n\r\n            // We need to fake sendrecv.\r\n            // NOTE the SDP produced here goes only to Jicofo and is never set\r\n            // as localDescription. That's why\r\n            // TraceablePeerConnection.mediaTransferActive is ignored here.\r\n            videoMLine.direction = 'sendrecv';\r\n\r\n            // Check if the recvonly has MSID\r\n            const primarySSRC = requiredSSRCs[0];\r\n\r\n            // FIXME The cname could come from the stream, but may turn out to\r\n            // be too complex. It is fine to come up with any value, as long as\r\n            // we only care about the actual SSRC values when deciding whether\r\n            // or not an update should be sent.\r\n            const primaryCname = `injected-${primarySSRC}`;\r\n\r\n            for (const ssrcNum of requiredSSRCs) {\r\n                // Remove old attributes\r\n                videoMLine.removeSSRC(ssrcNum);\r\n\r\n                // Inject\r\n                logger.debug(\r\n                    `${this.tpc} injecting video SSRC: ${ssrcNum} for ${\r\n                        videoTrack}`);\r\n                videoMLine.addSSRCAttribute({\r\n                    id: ssrcNum,\r\n                    attribute: 'cname',\r\n                    value: primaryCname\r\n                });\r\n                videoMLine.addSSRCAttribute({\r\n                    id: ssrcNum,\r\n                    attribute: 'msid',\r\n                    value: videoTrack.storedMSID\r\n                });\r\n            }\r\n            if (requiredSSRCs.length > 1) {\r\n                const group = {\r\n                    ssrcs: requiredSSRCs.join(' '),\r\n                    semantics: 'SIM'\r\n                };\r\n\r\n                if (!videoMLine.findGroup(group.semantics, group.ssrcs)) {\r\n                    // Inject the group\r\n                    logger.debug(\r\n                        `${this.tpc} injecting SIM group for ${videoTrack}`,\r\n                        group);\r\n                    videoMLine.addSSRCGroup(group);\r\n                }\r\n            }\r\n\r\n            // Insert RTX\r\n            // FIXME in P2P RTX is used by Chrome regardless of config option\r\n            // status. Because of that 'source-remove'/'source-add'\r\n            // notifications are still sent to remove/add RTX SSRC and FID group\r\n            if (!this.tpc.options.disableRtx) {\r\n                this.tpc.rtxModifier.modifyRtxSsrcs2(videoMLine);\r\n            }\r\n        }\r\n\r\n        return modified;\r\n    }\r\n\r\n    /**\r\n     * Modifies 'cname', 'msid', 'label' and 'mslabel' by appending\r\n     * the id of {@link LocalSdpMunger#tpc} at the end, preceding by a dash\r\n     * sign.\r\n     *\r\n     * @param {MLineWrap} mediaSection - The media part (audio or video) of the\r\n     * session description which will be modified in place.\r\n     * @returns {void}\r\n     * @private\r\n     */\r\n    _transformMediaIdentifiers(mediaSection) {\r\n        const pcId = this.tpc.id;\r\n\r\n        for (const ssrcLine of mediaSection.ssrcs) {\r\n            switch (ssrcLine.attribute) {\r\n            case 'cname':\r\n            case 'label':\r\n            case 'mslabel':\r\n                ssrcLine.value = ssrcLine.value && `${ssrcLine.value}-${pcId}`;\r\n                break;\r\n            case 'msid': {\r\n                if (ssrcLine.value) {\r\n                    const streamAndTrackIDs = ssrcLine.value.split(' ');\r\n\r\n                    if (streamAndTrackIDs.length === 2) {\r\n                        const streamId = streamAndTrackIDs[0];\r\n                        const trackId = streamAndTrackIDs[1];\r\n\r\n                        ssrcLine.value\r\n                            = `${streamId}-${pcId} ${trackId}-${pcId}`;\r\n                    } else {\r\n                        logger.warn(\r\n                            'Unable to munge local MSID'\r\n                                + `- weird format detected: ${ssrcLine.value}`);\r\n                    }\r\n                }\r\n                break;\r\n            }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Maybe modifies local description to fake local video tracks SDP when\r\n     * those are muted.\r\n     *\r\n     * @param {object} desc the WebRTC SDP object instance for the local\r\n     * description.\r\n     * @returns {RTCSessionDescription}\r\n     */\r\n    maybeAddMutedLocalVideoTracksToSDP(desc) {\r\n        if (!desc) {\r\n            throw new Error('No local description passed in.');\r\n        }\r\n\r\n        const transformer = new SdpTransformWrap(desc.sdp);\r\n\r\n        if (this._addMutedLocalVideoTracksToSDP(transformer)) {\r\n            return new RTCSessionDescription({\r\n                type: desc.type,\r\n                sdp: transformer.toRawSDP()\r\n            });\r\n        }\r\n\r\n        return desc;\r\n    }\r\n\r\n    /**\r\n     * This transformation will make sure that stream identifiers are unique\r\n     * across all of the local PeerConnections even if the same stream is used\r\n     * by multiple instances at the same time.\r\n     * Each PeerConnection assigns different SSRCs to the same local\r\n     * MediaStream, but the MSID remains the same as it's used to identify\r\n     * the stream by the WebRTC backend. The transformation will append\r\n     * {@link TraceablePeerConnection#id} at the end of each stream's identifier\r\n     * (\"cname\", \"msid\", \"label\" and \"mslabel\").\r\n     *\r\n     * @param {RTCSessionDescription} sessionDesc - The local session\r\n     * description (this instance remains unchanged).\r\n     * @return {RTCSessionDescription} - Transformed local session description\r\n     * (a modified copy of the one given as the input).\r\n     */\r\n    transformStreamIdentifiers(sessionDesc) {\r\n        // FIXME similar check is probably duplicated in all other transformers\r\n        if (!sessionDesc || !sessionDesc.sdp || !sessionDesc.type) {\r\n            return sessionDesc;\r\n        }\r\n\r\n        const transformer = new SdpTransformWrap(sessionDesc.sdp);\r\n        const audioMLine = transformer.selectMedia('audio');\r\n\r\n        if (audioMLine) {\r\n            this._transformMediaIdentifiers(audioMLine);\r\n        }\r\n\r\n        const videoMLine = transformer.selectMedia('video');\r\n\r\n        if (videoMLine) {\r\n            this._transformMediaIdentifiers(videoMLine);\r\n        }\r\n\r\n        return new RTCSessionDescription({\r\n            type: sessionDesc.type,\r\n            sdp: transformer.toRawSDP()\r\n        });\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/RTC/LocalSdpMunger.js","/* global __filename */\r\n\r\nimport { getLogger } from 'jitsi-meet-logger';\r\nimport { parseSecondarySSRC, SdpTransformWrap } from './SdpTransformUtil';\r\nimport SDPUtil from './SDPUtil';\r\n\r\nconst logger = getLogger(__filename);\r\n\r\n/**\r\n * Begin helper functions\r\n */\r\n/**\r\n * Updates or inserts the appropriate rtx information for primarySsrc with\r\n *  the given rtxSsrc.  If no rtx ssrc for primarySsrc currently exists, it will\r\n *  add the appropriate ssrc and ssrc group lines.  If primarySsrc already has\r\n *  an rtx ssrc, the appropriate ssrc and group lines will be updated\r\n * @param {MLineWrap} mLine\r\n * @param {object} primarySsrcInfo the info (ssrc, msid & cname) for the\r\n *  primary ssrc\r\n * @param {number} rtxSsrc the rtx ssrc to associate with the primary ssrc\r\n */\r\nfunction updateAssociatedRtxStream(mLine, primarySsrcInfo, rtxSsrc) {\r\n    logger.debug(\r\n        `Updating mline to associate ${rtxSsrc}`\r\n        + `rtx ssrc with primary stream, ${primarySsrcInfo.id}`);\r\n    const primarySsrc = primarySsrcInfo.id;\r\n    const primarySsrcMsid = primarySsrcInfo.msid;\r\n    const primarySsrcCname = primarySsrcInfo.cname;\r\n\r\n    const previousRtxSSRC = mLine.getRtxSSRC(primarySsrc);\r\n\r\n    if (previousRtxSSRC === rtxSsrc) {\r\n        logger.debug(`${rtxSsrc} was already associated with ${primarySsrc}`);\r\n\r\n        return;\r\n    }\r\n    if (previousRtxSSRC) {\r\n        logger.debug(\r\n            `${primarySsrc} was previously associated with rtx`\r\n            + `${previousRtxSSRC}, removing all references to it`);\r\n\r\n        // Stream already had an rtx ssrc that is different than the one given,\r\n        //  remove all trace of the old one\r\n        mLine.removeSSRC(previousRtxSSRC);\r\n\r\n        logger.debug(`groups before filtering for ${previousRtxSSRC}`);\r\n        logger.debug(mLine.dumpSSRCGroups());\r\n\r\n        mLine.removeGroupsWithSSRC(previousRtxSSRC);\r\n    }\r\n    mLine.addSSRCAttribute({\r\n        id: rtxSsrc,\r\n        attribute: 'cname',\r\n        value: primarySsrcCname\r\n    });\r\n    mLine.addSSRCAttribute({\r\n        id: rtxSsrc,\r\n        attribute: 'msid',\r\n        value: primarySsrcMsid\r\n    });\r\n    mLine.addSSRCGroup({\r\n        semantics: 'FID',\r\n        ssrcs: `${primarySsrc} ${rtxSsrc}`\r\n    });\r\n}\r\n\r\n/**\r\n * End helper functions\r\n */\r\n\r\n/**\r\n * Adds any missing RTX streams for video streams\r\n *  and makes sure that they remain consistent\r\n */\r\nexport default class RtxModifier {\r\n    /**\r\n     * Constructor\r\n     */\r\n    constructor() {\r\n        /**\r\n         * Map of video ssrc to corresponding RTX\r\n         *  ssrc\r\n         */\r\n        this.correspondingRtxSsrcs = new Map();\r\n    }\r\n\r\n    /**\r\n     * Clear the cached map of primary video ssrcs to\r\n     *  their corresponding rtx ssrcs so that they will\r\n     *  not be used for the next call to modifyRtxSsrcs\r\n     */\r\n    clearSsrcCache() {\r\n        this.correspondingRtxSsrcs.clear();\r\n    }\r\n\r\n    /**\r\n     * Explicitly set the primary video ssrc -> rtx ssrc\r\n     *  mapping to be used in modifyRtxSsrcs\r\n     * @param {Map} ssrcMapping a mapping of primary video\r\n     *  ssrcs to their corresponding rtx ssrcs\r\n     */\r\n    setSsrcCache(ssrcMapping) {\r\n        logger.debug('Setting ssrc cache to ', ssrcMapping);\r\n        this.correspondingRtxSsrcs = ssrcMapping;\r\n    }\r\n\r\n    /**\r\n     * Adds RTX ssrcs for any video ssrcs that don't\r\n     *  already have them.  If the video ssrc has been\r\n     *  seen before, and already had an RTX ssrc generated,\r\n     *  the same RTX ssrc will be used again.\r\n     * @param {string} sdpStr sdp in raw string format\r\n     */\r\n    modifyRtxSsrcs(sdpStr) {\r\n        const sdpTransformer = new SdpTransformWrap(sdpStr);\r\n        const videoMLine = sdpTransformer.selectMedia('video');\r\n\r\n        if (!videoMLine) {\r\n            logger.debug(`No 'video' media found in the sdp: ${sdpStr}`);\r\n\r\n            return sdpStr;\r\n        }\r\n\r\n        return this.modifyRtxSsrcs2(videoMLine)\r\n            ? sdpTransformer.toRawSDP() : sdpStr;\r\n    }\r\n\r\n    /**\r\n     * Does the same thing as {@link modifyRtxSsrcs}, but takes the\r\n     *  {@link MLineWrap} instance wrapping video media as an argument.\r\n     * @param {MLineWrap} videoMLine\r\n     * @return {boolean} <tt>true</tt> if the SDP wrapped by\r\n     *  {@link SdpTransformWrap} has been modified or <tt>false</tt> otherwise.\r\n     */\r\n    modifyRtxSsrcs2(videoMLine) {\r\n        if (videoMLine.direction === 'recvonly') {\r\n            logger.debug('RtxModifier doing nothing, video m line is recvonly');\r\n\r\n            return false;\r\n        }\r\n        if (videoMLine.getSSRCCount() < 1) {\r\n            logger.debug('RtxModifier doing nothing, no video ssrcs present');\r\n\r\n            return false;\r\n        }\r\n        logger.debug('Current ssrc mapping: ', this.correspondingRtxSsrcs);\r\n        const primaryVideoSsrcs = videoMLine.getPrimaryVideoSSRCs();\r\n\r\n        logger.debug('Parsed primary video ssrcs ', primaryVideoSsrcs,\r\n            ' making sure all have rtx streams');\r\n        for (const ssrc of primaryVideoSsrcs) {\r\n            const msid = videoMLine.getSSRCAttrValue(ssrc, 'msid');\r\n            const cname = videoMLine.getSSRCAttrValue(ssrc, 'cname');\r\n            let correspondingRtxSsrc = this.correspondingRtxSsrcs.get(ssrc);\r\n\r\n            if (correspondingRtxSsrc) {\r\n                logger.debug(\r\n                    'Already have an associated rtx ssrc for'\r\n                    + `video ssrc ${ssrc}: ${correspondingRtxSsrc}`);\r\n            } else {\r\n                logger.debug(\r\n                    `No previously associated rtx ssrc for video ssrc ${ssrc}`);\r\n\r\n                // If there's one in the sdp already for it, we'll just set\r\n                //  that as the corresponding one\r\n                const previousAssociatedRtxStream = videoMLine.getRtxSSRC(ssrc);\r\n\r\n                if (previousAssociatedRtxStream) {\r\n                    logger.debug(\r\n                        `Rtx stream ${previousAssociatedRtxStream} `\r\n                        + 'already existed in the sdp as an rtx stream for '\r\n                        + `${ssrc}`);\r\n                    correspondingRtxSsrc = previousAssociatedRtxStream;\r\n                } else {\r\n                    correspondingRtxSsrc = SDPUtil.generateSsrc();\r\n                    logger.debug(`Generated rtx ssrc ${correspondingRtxSsrc} `\r\n                                 + `for ssrc ${ssrc}`);\r\n                }\r\n                logger.debug(`Caching rtx ssrc ${correspondingRtxSsrc} `\r\n                             + `for video ssrc ${ssrc}`);\r\n                this.correspondingRtxSsrcs.set(ssrc, correspondingRtxSsrc);\r\n            }\r\n            updateAssociatedRtxStream(\r\n                videoMLine,\r\n                {\r\n                    id: ssrc,\r\n                    cname,\r\n                    msid\r\n                },\r\n                correspondingRtxSsrc);\r\n        }\r\n\r\n        // FIXME we're not looking into much details whether the SDP has been\r\n        // modified or not once the precondition requirements are met.\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Strip all rtx streams from the given sdp\r\n     * @param {string} sdpStr sdp in raw string format\r\n     * @returns {string} sdp string with all rtx streams stripped\r\n     */\r\n    stripRtx(sdpStr) {\r\n        const sdpTransformer = new SdpTransformWrap(sdpStr);\r\n        const videoMLine = sdpTransformer.selectMedia('video');\r\n\r\n        if (!videoMLine) {\r\n            logger.debug(`No 'video' media found in the sdp: ${sdpStr}`);\r\n\r\n            return sdpStr;\r\n        }\r\n        if (videoMLine.direction === 'recvonly') {\r\n            logger.debug('RtxModifier doing nothing, video m line is recvonly');\r\n\r\n            return sdpStr;\r\n        }\r\n        if (videoMLine.getSSRCCount() < 1) {\r\n            logger.debug('RtxModifier doing nothing, no video ssrcs present');\r\n\r\n            return sdpStr;\r\n        }\r\n        if (!videoMLine.containsAnySSRCGroups()) {\r\n            logger.debug('RtxModifier doing nothing, '\r\n              + 'no video ssrcGroups present');\r\n\r\n            return sdpStr;\r\n        }\r\n        const fidGroups = videoMLine.findGroups('FID');\r\n\r\n        // Remove the fid groups from the mline\r\n\r\n        videoMLine.removeGroupsBySemantics('FID');\r\n\r\n        // Get the rtx ssrcs and remove them from the mline\r\n        for (const fidGroup of fidGroups) {\r\n            const rtxSsrc = parseSecondarySSRC(fidGroup);\r\n\r\n            videoMLine.removeSSRC(rtxSsrc);\r\n        }\r\n\r\n        return sdpTransformer.toRawSDP();\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/xmpp/RtxModifier.js","/* global __filename */\r\n\r\nimport { getLogger } from 'jitsi-meet-logger';\r\nimport {\r\n    parsePrimarySSRC,\r\n    parseSecondarySSRC,\r\n    SdpTransformWrap\r\n} from './SdpTransformUtil';\r\n\r\nconst logger = getLogger(__filename);\r\n\r\n/**\r\n * Handles the work of keeping video ssrcs consistent across multiple\r\n * o/a cycles, making it such that all stream operations can be\r\n * kept local and do not need to be signaled.\r\n * NOTE: This only keeps the 'primary' video ssrc consistent: meaning\r\n * the primary video stream\r\n */\r\nexport default class SdpConsistency {\r\n    /**\r\n     * Constructor\r\n     * @param {string} logPrefix the log prefix appended to every logged\r\n     * message, currently used to distinguish for which\r\n     * <tt>TraceablePeerConnection</tt> the instance works.\r\n     */\r\n    constructor(logPrefix) {\r\n        this.clearVideoSsrcCache();\r\n        this.logPrefix = logPrefix;\r\n    }\r\n\r\n    /**\r\n     * Clear the cached video primary and primary rtx ssrcs so that\r\n     *  they will not be used for the next call to\r\n     *  makeVideoPrimarySsrcsConsistent\r\n     */\r\n    clearVideoSsrcCache() {\r\n        this.cachedPrimarySsrc = null;\r\n        this.injectRecvOnly = false;\r\n    }\r\n\r\n    /**\r\n     * Explicitly set the primary ssrc to be used in\r\n     *  makeVideoPrimarySsrcsConsistent\r\n     * @param {number} primarySsrc the primarySsrc to be used\r\n     *  in future calls to makeVideoPrimarySsrcsConsistent\r\n     * @throws Error if <tt>primarySsrc</tt> is not a number\r\n     */\r\n    setPrimarySsrc(primarySsrc) {\r\n        if (typeof primarySsrc !== 'number') {\r\n            throw new Error('Primary SSRC must be a number!');\r\n        }\r\n        this.cachedPrimarySsrc = primarySsrc;\r\n    }\r\n\r\n    /**\r\n     * Checks whether or not there is a primary video SSRC cached already.\r\n     * @return {boolean}\r\n     */\r\n    hasPrimarySsrcCached() {\r\n        return Boolean(this.cachedPrimarySsrc);\r\n    }\r\n\r\n    /**\r\n     * Given an sdp string, either:\r\n     *  1) record the primary video and primary rtx ssrcs to be\r\n     *   used in future calls to makeVideoPrimarySsrcsConsistent or\r\n     *  2) change the primary and primary rtx ssrcs in the given sdp\r\n     *   to match the ones previously cached\r\n     * @param {string} sdpStr the sdp string to (potentially)\r\n     *  change to make the video ssrcs consistent\r\n     * @returns {string} a (potentially) modified sdp string\r\n     *  with ssrcs consistent with this class' cache\r\n     */\r\n    makeVideoPrimarySsrcsConsistent(sdpStr) {\r\n        const sdpTransformer = new SdpTransformWrap(sdpStr);\r\n        const videoMLine = sdpTransformer.selectMedia('video');\r\n\r\n        if (!videoMLine) {\r\n            logger.debug(\r\n                `${this.logPrefix} no 'video' media found in the sdp: `\r\n                    + `${sdpStr}`);\r\n\r\n            return sdpStr;\r\n        }\r\n\r\n        if (videoMLine.direction === 'recvonly') {\r\n            // If the mline is recvonly, we'll add the primary\r\n            //  ssrc as a recvonly ssrc\r\n            if (this.cachedPrimarySsrc && this.injectRecvOnly) {\r\n                videoMLine.addSSRCAttribute({\r\n                    id: this.cachedPrimarySsrc,\r\n                    attribute: 'cname',\r\n                    value: `recvonly-${this.cachedPrimarySsrc}`\r\n                });\r\n            } else {\r\n                logger.info(\r\n                    `${this.logPrefix} no SSRC found for the recvonly video`\r\n                        + 'stream!');\r\n            }\r\n        } else {\r\n            const newPrimarySsrc = videoMLine.getPrimaryVideoSsrc();\r\n\r\n            if (!newPrimarySsrc) {\r\n                logger.info(\r\n                    `${this.logPrefix} sdp-consistency couldn't`\r\n                        + ' parse new primary ssrc');\r\n\r\n                return sdpStr;\r\n            }\r\n            if (this.cachedPrimarySsrc) {\r\n                logger.info(\r\n                    `${this.logPrefix} sdp-consistency replacing new ssrc`\r\n                        + `${newPrimarySsrc} with cached `\r\n                        + `${this.cachedPrimarySsrc}`);\r\n                videoMLine.replaceSSRC(newPrimarySsrc, this.cachedPrimarySsrc);\r\n                for (const group of videoMLine.ssrcGroups) {\r\n                    if (group.semantics === 'FID') {\r\n                        const primarySsrc = parsePrimarySSRC(group);\r\n                        const rtxSsrc = parseSecondarySSRC(group);\r\n\r\n                        // eslint-disable-next-line max-depth\r\n                        if (primarySsrc === newPrimarySsrc) {\r\n                            group.ssrcs\r\n                                = `${this.cachedPrimarySsrc} ${rtxSsrc}`;\r\n                        }\r\n                    }\r\n                }\r\n            } else {\r\n                this.cachedPrimarySsrc = newPrimarySsrc;\r\n                logger.info(\r\n                    `${this.logPrefix} sdp-consistency caching primary ssrc`\r\n                        + `${this.cachedPrimarySsrc}`);\r\n            }\r\n\r\n            this.injectRecvOnly = true;\r\n        }\r\n\r\n        return sdpTransformer.toRawSDP();\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/xmpp/SdpConsistency.js","/* Copyright @ 2015 Atlassian Pty Ltd\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexports.Interop = require('./interop');\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/sdp-interop/lib/index.js","/* Copyright @ 2015 Atlassian Pty Ltd\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* global RTCSessionDescription */\n/* global RTCIceCandidate */\n/* jshint -W097 */\n\"use strict\";\n\nvar transform = require('./transform');\nvar arrayEquals = require('./array-equals');\n\nfunction Interop() {\n\n    /**\n     * This map holds the most recent Unified Plan offer/answer SDP that was\n     * converted to Plan B, with the SDP type ('offer' or 'answer') as keys and\n     * the SDP string as values.\n     *\n     * @type {{}}\n     */\n    this.cache = {\n        mlB2UMap : {},\n        mlU2BMap : {}\n    };\n}\n\nmodule.exports = Interop;\n\n/**\n * Changes the candidate args to match with the related Unified Plan\n */\nInterop.prototype.candidateToUnifiedPlan = function(candidate) {\n    var cand = new RTCIceCandidate(candidate);\n\n    cand.sdpMLineIndex = this.cache.mlB2UMap[cand.sdpMLineIndex];\n    /* TODO: change sdpMid to (audio|video)-SSRC */\n\n    return cand;\n};\n\n/**\n * Changes the candidate args to match with the related Plan B\n */\nInterop.prototype.candidateToPlanB = function(candidate) {\n    var cand = new RTCIceCandidate(candidate);\n\n    if (cand.sdpMid.indexOf('audio') === 0) {\n      cand.sdpMid = 'audio';\n    } else if (cand.sdpMid.indexOf('video') === 0) {\n      cand.sdpMid = 'video';\n    } else {\n      throw new Error('candidate with ' + cand.sdpMid + ' not allowed');\n    }\n\n    cand.sdpMLineIndex = this.cache.mlU2BMap[cand.sdpMLineIndex];\n\n    return cand;\n};\n\n/**\n * Returns the index of the first m-line with the given media type and with a\n * direction which allows sending, in the last Unified Plan description with\n * type \"answer\" converted to Plan B. Returns {null} if there is no saved\n * answer, or if none of its m-lines with the given type allow sending.\n * @param type the media type (\"audio\" or \"video\").\n * @returns {*}\n */\nInterop.prototype.getFirstSendingIndexFromAnswer = function(type) {\n    if (!this.cache.answer) {\n        return null;\n    }\n\n    var session = transform.parse(this.cache.answer);\n    if (session && session.media && Array.isArray(session.media)){\n        for (var i = 0; i < session.media.length; i++) {\n            if (session.media[i].type == type &&\n                (!session.media[i].direction /* default to sendrecv */ ||\n                    session.media[i].direction === 'sendrecv' ||\n                    session.media[i].direction === 'sendonly')){\n                return i;\n            }\n        }\n    }\n\n    return null;\n};\n\n/**\n * This method transforms a Unified Plan SDP to an equivalent Plan B SDP. A\n * PeerConnection wrapper transforms the SDP to Plan B before passing it to the\n * application.\n *\n * @param desc\n * @returns {*}\n */\nInterop.prototype.toPlanB = function(desc) {\n    var self = this;\n    //#region Preliminary input validation.\n\n    if (typeof desc !== 'object' || desc === null ||\n        typeof desc.sdp !== 'string') {\n        console.warn('An empty description was passed as an argument.');\n        return desc;\n    }\n\n    // Objectify the SDP for easier manipulation.\n    var session = transform.parse(desc.sdp);\n\n    // If the SDP contains no media, there's nothing to transform.\n    if (typeof session.media === 'undefined' ||\n        !Array.isArray(session.media) || session.media.length === 0) {\n        console.warn('The description has no media.');\n        return desc;\n    }\n\n    // Try some heuristics to \"make sure\" this is a Unified Plan SDP. Plan B\n    // SDP has a video, an audio and a data \"channel\" at most.\n    if (session.media.length <= 3 && session.media.every(function(m) {\n            return ['video', 'audio', 'data'].indexOf(m.mid) !== -1;\n        })) {\n        console.warn('This description does not look like Unified Plan.');\n        return desc;\n    }\n\n    //#endregion\n\n    // HACK https://bugzilla.mozilla.org/show_bug.cgi?id=1113443\n    var sdp = desc.sdp;\n    var rewrite = false;\n    for (var i = 0; i < session.media.length; i++) {\n        var uLine = session.media[i];\n        uLine.rtp.forEach(function(rtp) {\n            if (rtp.codec === 'NULL')\n            {\n                rewrite = true;\n                var offer = transform.parse(self.cache.offer);\n                rtp.codec = offer.media[i].rtp[0].codec;\n            }\n        });\n    }\n    if (rewrite) {\n        sdp = transform.write(session);\n    }\n\n    // Unified Plan SDP is our \"precious\". Cache it for later use in the Plan B\n    // -> Unified Plan transformation.\n    this.cache[desc.type] = sdp;\n\n    //#region Convert from Unified Plan to Plan B.\n\n    // We rebuild the session.media array.\n    var media = session.media;\n    session.media = [];\n\n    // Associative array that maps channel types to channel objects for fast\n    // access to channel objects by their type, e.g. type2bl['audio']->channel\n    // obj.\n    var type2bl = {};\n\n    // Used to build the group:BUNDLE value after the channels construction\n    // loop.\n    var types = [];\n\n    media.forEach(function(uLine) {\n        // rtcp-mux is required in the Plan B SDP.\n        if ((typeof uLine.rtcpMux !== 'string' ||\n            uLine.rtcpMux !== 'rtcp-mux') &&\n            uLine.direction !== 'inactive') {\n            throw new Error('Cannot convert to Plan B because m-lines ' +\n                'without the rtcp-mux attribute were found.');\n        }\n\n        // If we don't have a channel for this uLine.type OR the selected is\n        // inactive, then select this uLine as the channel basis.\n        if (typeof type2bl[uLine.type] === 'undefined' ||\n            type2bl[uLine.type].direction === 'inactive') {\n            type2bl[uLine.type] = uLine;\n        }\n    });\n\n    // Implode the Unified Plan m-lines/tracks into Plan B channels.\n    media.forEach(function(uLine) {\n        if (uLine.type === 'application') {\n            session.media.push(uLine);\n            types.push(uLine.mid);\n            return;\n        }\n\n        // Add sources to the channel and handle a=msid.\n        if (typeof uLine.sources === 'object') {\n            Object.keys(uLine.sources).forEach(function(ssrc) {\n                if (typeof type2bl[uLine.type].sources !== 'object')\n                    type2bl[uLine.type].sources = {};\n\n                // Assign the sources to the channel.\n                type2bl[uLine.type].sources[ssrc] =\n                    uLine.sources[ssrc];\n\n                if (typeof uLine.msid !== 'undefined') {\n                    // In Plan B the msid is an SSRC attribute. Also, we don't\n                    // care about the obsolete label and mslabel attributes.\n                    //\n                    // Note that it is not guaranteed that the uLine will\n                    // have an msid. recvonly channels in particular don't have\n                    // one.\n                    type2bl[uLine.type].sources[ssrc].msid =\n                        uLine.msid;\n                }\n                // NOTE ssrcs in ssrc groups will share msids, as\n                // draft-uberti-rtcweb-plan-00 mandates.\n            });\n        }\n\n        // Add ssrc groups to the channel.\n        if (typeof uLine.ssrcGroups !== 'undefined' &&\n                Array.isArray(uLine.ssrcGroups)) {\n\n            // Create the ssrcGroups array, if it's not defined.\n            if (typeof type2bl[uLine.type].ssrcGroups === 'undefined' ||\n                    !Array.isArray(type2bl[uLine.type].ssrcGroups)) {\n                type2bl[uLine.type].ssrcGroups = [];\n            }\n\n            type2bl[uLine.type].ssrcGroups =\n                type2bl[uLine.type].ssrcGroups.concat(\n                    uLine.ssrcGroups);\n        }\n\n        if (type2bl[uLine.type] === uLine) {\n            // Plan B mids are in ['audio', 'video', 'data']\n            uLine.mid = uLine.type;\n\n            // Plan B doesn't support/need the bundle-only attribute.\n            delete uLine.bundleOnly;\n\n            // In Plan B the msid is an SSRC attribute.\n            delete uLine.msid;\n\n            if (uLine.direction !== 'inactive') {\n              // Used to build the group:BUNDLE value after this loop.\n              types.push(uLine.type);\n            }\n\n            // Add the channel to the new media array.\n            session.media.push(uLine);\n        }\n    });\n\n    // We regenerate the BUNDLE group with the new mids.\n    session.groups.some(function(group) {\n        if (group.type === 'BUNDLE') {\n            group.mids = types.join(' ');\n            return true;\n        }\n    });\n\n    // msid semantic\n    session.msidSemantic = {\n        semantic: 'WMS',\n        token: '*'\n    };\n\n    var resStr = transform.write(session);\n\n    return new RTCSessionDescription({\n        type: desc.type,\n        sdp: resStr\n    });\n\n    //#endregion\n};\n\n/**\n * This method transforms a Plan B SDP to an equivalent Unified Plan SDP. A\n * PeerConnection wrapper transforms the SDP to Unified Plan before passing it\n * to FF.\n *\n * @param desc\n * @returns {*}\n */\nInterop.prototype.toUnifiedPlan = function(desc) {\n    var self = this;\n    //#region Preliminary input validation.\n\n    if (typeof desc !== 'object' || desc === null ||\n        typeof desc.sdp !== 'string') {\n        console.warn('An empty description was passed as an argument.');\n        return desc;\n    }\n\n    var session = transform.parse(desc.sdp);\n\n    // If the SDP contains no media, there's nothing to transform.\n    if (typeof session.media === 'undefined' ||\n        !Array.isArray(session.media) || session.media.length === 0) {\n        console.warn('The description has no media.');\n        return desc;\n    }\n\n    // Try some heuristics to \"make sure\" this is a Plan B SDP. Plan B SDP has\n    // a video, an audio and a data \"channel\" at most.\n    if (session.media.length > 3 || !session.media.every(function(m) {\n            return ['video', 'audio', 'data'].indexOf(m.mid) !== -1;\n        })) {\n        console.warn('This description does not look like Plan B.');\n        return desc;\n    }\n\n    // Make sure this Plan B SDP can be converted to a Unified Plan SDP.\n    var mids = [];\n    session.media.forEach(function(m) {\n        mids.push(m.mid);\n    });\n\n    var hasBundle = false;\n    if (typeof session.groups !== 'undefined' &&\n        Array.isArray(session.groups)) {\n        hasBundle = session.groups.every(function(g) {\n            return g.type !== 'BUNDLE' ||\n                arrayEquals.apply(g.mids.sort(), [mids.sort()]);\n        });\n    }\n\n    if (!hasBundle) {\n        throw new Error(\"Cannot convert to Unified Plan because m-lines that\" +\n            \" are not bundled were found.\");\n    }\n\n    //#endregion\n\n\n    //#region Convert from Plan B to Unified Plan.\n\n    // Unfortunately, a Plan B offer/answer doesn't have enough information to\n    // rebuild an equivalent Unified Plan offer/answer.\n    //\n    // For example, if this is a local answer (in Unified Plan style) that we\n    // convert to Plan B prior to handing it over to the application (the\n    // PeerConnection wrapper called us, for instance, after a successful\n    // createAnswer), we want to remember the m-line at which we've seen the\n    // (local) SSRC. That's because when the application wants to do call the\n    // SLD method, forcing us to do the inverse transformation (from Plan B to\n    // Unified Plan), we need to know to which m-line to assign the (local)\n    // SSRC. We also need to know all the other m-lines that the original\n    // answer had and include them in the transformed answer as well.\n    //\n    // Another example is if this is a remote offer that we convert to Plan B\n    // prior to giving it to the application, we want to remember the mid at\n    // which we've seen the (remote) SSRC.\n    //\n    // In the iteration that follows, we use the cached Unified Plan (if it\n    // exists) to assign mids to ssrcs.\n\n    var cached;\n    if (typeof this.cache[desc.type] !== 'undefined') {\n        cached = transform.parse(this.cache[desc.type]);\n    }\n\n    var recvonlySsrcs = {\n        audio: {},\n        video: {}\n    };\n\n    // A helper map that sends mids to m-line objects. We use it later to\n    // rebuild the Unified Plan style session.media array.\n    var mid2ul = {};\n    var bIdx = 0;\n    var uIdx = 0;\n\n    session.media.forEach(function(bLine) {\n        if ((typeof bLine.rtcpMux !== 'string' ||\n            bLine.rtcpMux !== 'rtcp-mux') &&\n            bLine.direction !== 'inactive') {\n            throw new Error(\"Cannot convert to Unified Plan because m-lines \" +\n                \"without the rtcp-mux attribute were found.\");\n        }\n\n        if (bLine.type === 'application') {\n            mid2ul[bLine.mid] = bLine;\n            return;\n        }\n\n        // With rtcp-mux and bundle all the channels should have the same ICE\n        // stuff.\n        var sources = bLine.sources;\n        var ssrcGroups = bLine.ssrcGroups;\n        var candidates = bLine.candidates;\n        var iceUfrag = bLine.iceUfrag;\n        var icePwd = bLine.icePwd;\n        var fingerprint = bLine.fingerprint;\n        var port = bLine.port;\n\n        // We'll use the \"bLine\" object as a prototype for each new \"mLine\"\n        // that we create, but first we need to clean it up a bit.\n        delete bLine.sources;\n        delete bLine.ssrcGroups;\n        delete bLine.candidates;\n        delete bLine.iceUfrag;\n        delete bLine.icePwd;\n        delete bLine.fingerprint;\n        delete bLine.port;\n        delete bLine.mid;\n\n        // inverted ssrc group map\n        var ssrc2group = {};\n        if (typeof ssrcGroups !== 'undefined' && Array.isArray(ssrcGroups)) {\n            ssrcGroups.forEach(function (ssrcGroup) {\n\n                // TODO(gp) find out how to receive simulcast with FF. For the\n                // time being, hide it.\n                if (ssrcGroup.semantics === 'SIM') {\n                    return;\n                }\n\n                // XXX This might brake if an SSRC is in more than one group\n                // for some reason.\n                if (typeof ssrcGroup.ssrcs !== 'undefined' &&\n                    Array.isArray(ssrcGroup.ssrcs)) {\n                    ssrcGroup.ssrcs.forEach(function (ssrc) {\n                        if (typeof ssrc2group[ssrc] === 'undefined') {\n                            ssrc2group[ssrc] = [];\n                        }\n\n                        ssrc2group[ssrc].push(ssrcGroup);\n                    });\n                }\n            });\n        }\n\n        // ssrc to m-line index.\n        var ssrc2ml = {};\n\n        if (typeof sources === 'object') {\n\n            // Explode the Plan B channel sources with one m-line per source.\n            Object.keys(sources).forEach(function(ssrc) {\n\n                // The (unified) m-line for this SSRC. We either create it from\n                // scratch or, if it's a grouped SSRC, we re-use a related\n                // mline. In other words, if the source is grouped with another\n                // source, put the two together in the same m-line.\n                var uLine;\n\n                // We assume here that we are the answerer in the O/A, so any\n                // offers which we translate come from the remote side, while\n                // answers are local. So the check below is to make that we\n                // handle receive-only SSRCs in a special way only if they come\n                // from the remote side.\n                if (desc.type==='offer') {\n                    // We want to detect SSRCs which are used by a remote peer\n                    // in an m-line with direction=recvonly (i.e. they are\n                    // being used for RTCP only).\n                    // This information would have gotten lost if the remote\n                    // peer used Unified Plan and their local description was\n                    // translated to Plan B. So we use the lack of an MSID\n                    // attribute to deduce a \"receive only\" SSRC.\n                    if (!sources[ssrc].msid) {\n                        recvonlySsrcs[bLine.type][ssrc] = sources[ssrc];\n                        // Receive-only SSRCs must not create new m-lines. We\n                        // will assign them to an existing m-line later.\n                        return;\n                    }\n                }\n\n                if (typeof ssrc2group[ssrc] !== 'undefined' &&\n                    Array.isArray(ssrc2group[ssrc])) {\n                    ssrc2group[ssrc].some(function (ssrcGroup) {\n                        // ssrcGroup.ssrcs *is* an Array, no need to check\n                        // again here.\n                        return ssrcGroup.ssrcs.some(function (related) {\n                            if (typeof ssrc2ml[related] === 'object') {\n                                uLine = ssrc2ml[related];\n                                return true;\n                            }\n                        });\n                    });\n                }\n\n                if (typeof uLine === 'object') {\n                    // the m-line already exists. Just add the source.\n                    uLine.sources[ssrc] = sources[ssrc];\n                    delete sources[ssrc].msid;\n                } else {\n                    // Use the \"bLine\" as a prototype for the \"uLine\".\n                    uLine = Object.create(bLine);\n                    ssrc2ml[ssrc] = uLine;\n\n                    if (typeof sources[ssrc].msid !== 'undefined') {\n                        // Assign the msid of the source to the m-line. Note\n                        // that it is not guaranteed that the source will have\n                        // msid. In particular \"recvonly\" sources don't have an\n                        // msid. Note that \"recvonly\" is a term only defined\n                        // for m-lines.\n                        uLine.msid = sources[ssrc].msid;\n                        delete sources[ssrc].msid;\n                    }\n\n                    // We assign one SSRC per media line.\n                    uLine.sources = {};\n                    uLine.sources[ssrc] = sources[ssrc];\n                    uLine.ssrcGroups = ssrc2group[ssrc];\n\n                    // Use the cached Unified Plan SDP (if it exists) to assign\n                    // SSRCs to mids.\n                    if (typeof cached !== 'undefined' &&\n                        typeof cached.media !== 'undefined' &&\n                        Array.isArray(cached.media)) {\n\n                        cached.media.forEach(function (m) {\n                            if (typeof m.sources === 'object') {\n                                Object.keys(m.sources).forEach(function (s) {\n                                    if (s === ssrc) {\n                                        uLine.mid = m.mid;\n                                    }\n                                });\n                            }\n                        });\n                    }\n\n                    if (typeof uLine.mid === 'undefined') {\n\n                        // If this is an SSRC that we see for the first time\n                        // assign it a new mid. This is typically the case when\n                        // this method is called to transform a remote\n                        // description for the first time or when there is a\n                        // new SSRC in the remote description because a new\n                        // peer has joined the conference. Local SSRCs should\n                        // have already been added to the map in the toPlanB\n                        // method.\n                        //\n                        // Because FF generates answers in Unified Plan style,\n                        // we MUST already have a cached answer with all the\n                        // local SSRCs mapped to some m-line/mid.\n\n                        if (desc.type === 'answer') {\n                            throw new Error(\"An unmapped SSRC was found.\");\n                        }\n\n                        uLine.mid = [bLine.type, '-', ssrc].join('');\n                    }\n\n                    // Include the candidates in the 1st media line.\n                    uLine.candidates = candidates;\n                    uLine.iceUfrag = iceUfrag;\n                    uLine.icePwd = icePwd;\n                    uLine.fingerprint = fingerprint;\n                    uLine.port = port;\n\n                    mid2ul[uLine.mid] = uLine;\n\n                    self.cache.mlU2BMap[uIdx] = bIdx;\n                    if (typeof self.cache.mlB2UMap[bIdx] === 'undefined') {\n                      self.cache.mlB2UMap[bIdx] = uIdx;\n                    }\n                    uIdx++;\n                }\n            });\n        }\n\n        bIdx++;\n    });\n\n    // Rebuild the media array in the right order and add the missing mLines\n    // (missing from the Plan B SDP).\n    session.media = [];\n    mids = []; // reuse\n\n    if (desc.type === 'answer') {\n\n        // The media lines in the answer must match the media lines in the\n        // offer. The order is important too. Here we assume that Firefox is\n        // the answerer, so we merely have to use the reconstructed (unified)\n        // answer to update the cached (unified) answer accordingly.\n        //\n        // In the general case, one would have to use the cached (unified)\n        // offer to find the m-lines that are missing from the reconstructed\n        // answer, potentially grabbing them from the cached (unified) answer.\n        // One has to be careful with this approach because inactive m-lines do\n        // not always have an mid, making it tricky (impossible?) to find where\n        // exactly and which m-lines are missing from the reconstructed answer.\n\n        for (var i = 0; i < cached.media.length; i++) {\n            var uLine = cached.media[i];\n\n            if (typeof mid2ul[uLine.mid] === 'undefined') {\n\n                // The mid isn't in the reconstructed (unified) answer.\n                // This is either a (unified) m-line containing a remote\n                // track only, or a (unified) m-line containing a remote\n                // track and a local track that has been removed.\n                // In either case, it MUST exist in the cached\n                // (unified) answer.\n                //\n                // In case this is a removed local track, clean-up\n                // the (unified) m-line and make sure it's 'recvonly' or\n                // 'inactive'.\n\n                delete uLine.msid;\n                delete uLine.sources;\n                delete uLine.ssrcGroups;\n                if (!uLine.direction\n                    || uLine.direction === 'sendrecv')\n                    uLine.direction = 'recvonly';\n                else if (uLine.direction === 'sendonly')\n                    uLine.direction = 'inactive';\n            } else {\n                // This is an (unified) m-line/channel that contains a local\n                // track (sendrecv or sendonly channel) or it's a unified\n                // recvonly m-line/channel. In either case, since we're\n                // going from PlanB -> Unified Plan this m-line MUST\n                // exist in the cached answer.\n            }\n\n            session.media.push(uLine);\n\n            if (typeof uLine.mid === 'string') {\n                // inactive lines don't/may not have an mid.\n                mids.push(uLine.mid);\n            }\n        }\n    } else {\n\n        // SDP offer/answer (and the JSEP spec) forbids removing an m-section\n        // under any circumstances. If we are no longer interested in sending a\n        // track, we just remove the msid and ssrc attributes and set it to\n        // either a=recvonly (as the reofferer, we must use recvonly if the\n        // other side was previously sending on the m-section, but we can also\n        // leave the possibility open if it wasn't previously in use), or\n        // a=inactive.\n\n        if (typeof cached !== 'undefined' &&\n            typeof cached.media !== 'undefined' &&\n            Array.isArray(cached.media)) {\n            cached.media.forEach(function(uLine) {\n                mids.push(uLine.mid);\n                if (typeof mid2ul[uLine.mid] !== 'undefined') {\n                    session.media.push(mid2ul[uLine.mid]);\n                } else {\n                    delete uLine.msid;\n                    delete uLine.sources;\n                    delete uLine.ssrcGroups;\n                    if (!uLine.direction\n                        || uLine.direction === 'sendrecv')\n                        uLine.direction = 'recvonly';\n                    if (!uLine.direction\n                        || uLine.direction === 'sendonly')\n                        uLine.direction = 'inactive';\n                    session.media.push(uLine);\n                }\n            });\n        }\n\n        // Add all the remaining (new) m-lines of the transformed SDP.\n        Object.keys(mid2ul).forEach(function(mid) {\n            if (mids.indexOf(mid) === -1) {\n                mids.push(mid);\n                if (mid2ul[mid].direction === 'recvonly') {\n                    // This is a remote recvonly channel. Add its SSRC to the\n                    // appropriate sendrecv or sendonly channel.\n                    // TODO(gp) what if we don't have sendrecv/sendonly\n                    // channel?\n\n                    session.media.some(function (uLine) {\n                        if ((uLine.direction === 'sendrecv' ||\n                            uLine.direction === 'sendonly') &&\n                            uLine.type === mid2ul[mid].type) {\n\n                            // mid2ul[mid] shouldn't have any ssrc-groups\n                            Object.keys(mid2ul[mid].sources).forEach(\n                                function (ssrc) {\n                                uLine.sources[ssrc] =\n                                    mid2ul[mid].sources[ssrc];\n                            });\n\n                            return true;\n                        }\n                    });\n                } else {\n                    session.media.push(mid2ul[mid]);\n                }\n            }\n        });\n    }\n\n    // After we have constructed the Plan Unified m-lines we can figure out\n    // where (in which m-line) to place the 'recvonly SSRCs'.\n    // Note: we assume here that we are the answerer in the O/A, so any offers\n    // which we translate come from the remote side, while answers are local\n    // (and so our last local description is cached as an 'answer').\n    [\"audio\", \"video\"].forEach(function (type) {\n        if (!session || !session.media || !Array.isArray(session.media))\n            return;\n\n        var idx = null;\n        if (Object.keys(recvonlySsrcs[type]).length > 0) {\n            idx = self.getFirstSendingIndexFromAnswer(type);\n            if (idx === null){\n                // If this is the first offer we receive, we don't have a\n                // cached answer. Assume that we will be sending media using\n                // the first m-line for each media type.\n\n                for (var i = 0; i < session.media.length; i++) {\n                    if (session.media[i].type === type) {\n                        idx = i;\n                        break;\n                    }\n                }\n            }\n        }\n\n        if (idx && session.media.length > idx) {\n            var mLine = session.media[idx];\n            Object.keys(recvonlySsrcs[type]).forEach(function(ssrc) {\n                if (mLine.sources && mLine.sources[ssrc]) {\n                    console.warn(\"Replacing an existing SSRC.\");\n                }\n                if (!mLine.sources) {\n                    mLine.sources = {};\n                }\n\n                mLine.sources[ssrc] = recvonlySsrcs[type][ssrc];\n            });\n        }\n    });\n\n    // We regenerate the BUNDLE group (since we regenerated the mids)\n    session.groups.some(function(group) {\n        if (group.type === 'BUNDLE') {\n            group.mids = mids.join(' ');\n            return true;\n        }\n    });\n\n    // msid semantic\n    session.msidSemantic = {\n        semantic: 'WMS',\n        token: '*'\n    };\n\n    var resStr = transform.write(session);\n\n    // Cache the transformed SDP (Unified Plan) for later re-use in this\n    // function.\n    this.cache[desc.type] = resStr;\n\n    return new RTCSessionDescription({\n        type: desc.type,\n        sdp: resStr\n    });\n\n    //#endregion\n};\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/sdp-interop/lib/interop.js","/* Copyright @ 2015 Atlassian Pty Ltd\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar transform = require('sdp-transform');\n\nexports.write = function(session, opts) {\n\n  if (typeof session !== 'undefined' &&\n      typeof session.media !== 'undefined' &&\n      Array.isArray(session.media)) {\n\n    session.media.forEach(function (mLine) {\n      // expand sources to ssrcs\n      if (typeof mLine.sources !== 'undefined' &&\n        Object.keys(mLine.sources).length !== 0) {\n          mLine.ssrcs = [];\n          Object.keys(mLine.sources).forEach(function (ssrc) {\n            var source = mLine.sources[ssrc];\n            Object.keys(source).forEach(function (attribute) {\n              mLine.ssrcs.push({\n                id: ssrc,\n                attribute: attribute,\n                value: source[attribute]\n              });\n            });\n          });\n          delete mLine.sources;\n        }\n\n      // join ssrcs in ssrc groups\n      if (typeof mLine.ssrcGroups !== 'undefined' &&\n        Array.isArray(mLine.ssrcGroups)) {\n          mLine.ssrcGroups.forEach(function (ssrcGroup) {\n            if (typeof ssrcGroup.ssrcs !== 'undefined' &&\n                Array.isArray(ssrcGroup.ssrcs)) {\n              ssrcGroup.ssrcs = ssrcGroup.ssrcs.join(' ');\n            }\n          });\n        }\n    });\n  }\n\n  // join group mids\n  if (typeof session !== 'undefined' &&\n      typeof session.groups !== 'undefined' && Array.isArray(session.groups)) {\n\n    session.groups.forEach(function (g) {\n      if (typeof g.mids !== 'undefined' && Array.isArray(g.mids)) {\n        g.mids = g.mids.join(' ');\n      }\n    });\n  }\n\n  return transform.write(session, opts);\n};\n\nexports.parse = function(sdp) {\n  var session = transform.parse(sdp);\n\n  if (typeof session !== 'undefined' && typeof session.media !== 'undefined' &&\n      Array.isArray(session.media)) {\n\n    session.media.forEach(function (mLine) {\n      // group sources attributes by ssrc\n      if (typeof mLine.ssrcs !== 'undefined' && Array.isArray(mLine.ssrcs)) {\n        mLine.sources = {};\n        mLine.ssrcs.forEach(function (ssrc) {\n          if (!mLine.sources[ssrc.id])\n          mLine.sources[ssrc.id] = {};\n        mLine.sources[ssrc.id][ssrc.attribute] = ssrc.value;\n        });\n\n        delete mLine.ssrcs;\n      }\n\n      // split ssrcs in ssrc groups\n      if (typeof mLine.ssrcGroups !== 'undefined' &&\n        Array.isArray(mLine.ssrcGroups)) {\n          mLine.ssrcGroups.forEach(function (ssrcGroup) {\n            if (typeof ssrcGroup.ssrcs === 'string') {\n              ssrcGroup.ssrcs = ssrcGroup.ssrcs.split(' ');\n            }\n          });\n        }\n    });\n  }\n  // split group mids\n  if (typeof session !== 'undefined' &&\n      typeof session.groups !== 'undefined' && Array.isArray(session.groups)) {\n\n    session.groups.forEach(function (g) {\n      if (typeof g.mids === 'string') {\n        g.mids = g.mids.split(' ');\n      }\n    });\n  }\n\n  return session;\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/sdp-interop/lib/transform.js","/* Copyright @ 2015 Atlassian Pty Ltd\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nmodule.exports = function arrayEquals(array) {\n    // if the other array is a falsy value, return\n    if (!array)\n        return false;\n\n    // compare lengths - can save a lot of time\n    if (this.length != array.length)\n        return false;\n\n    for (var i = 0, l = this.length; i < l; i++) {\n        // Check if we have nested arrays\n        if (this[i] instanceof Array && array[i] instanceof Array) {\n            // recurse into the nested arrays\n            if (!arrayEquals.apply(this[i], [array[i]]))\n                return false;\n        } else if (this[i] != array[i]) {\n            // Warning - two different object instances will never be equal:\n            // {x:20} != {x:20}\n            return false;\n        }\n    }\n    return true;\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/sdp-interop/lib/array-equals.js","/* Copyright @ 2016 Atlassian Pty Ltd\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar transform = require('sdp-transform');\nvar transformUtils = require('./transform-utils');\nvar parseSsrcs = transformUtils.parseSsrcs;\nvar writeSsrcs = transformUtils.writeSsrcs;\n\n//region Constants\n\nvar DEFAULT_NUM_OF_LAYERS = 3;\n\n//endregion\n\nfunction getSsrcAttribute (mLine, ssrc, attributeName) {\n    return mLine\n        .ssrcs\n        .filter(function(ssrcInfo) { return ssrcInfo.id === ssrc; })\n        .filter(function(ssrcInfo) { return ssrcInfo.attribute === attributeName; })\n        .map(function(ssrcInfo) { return ssrcInfo.value; })[0];\n}\n\n//region Ctor\n\nfunction Simulcast(options) {\n\n    this.options = options ? options : {};\n\n    if (!this.options.numOfLayers) {\n        this.options.numOfLayers = DEFAULT_NUM_OF_LAYERS;\n    }\n    console.log(\"SdpSimulcast: using \" + this.options.numOfLayers + \" layers\");\n\n    /**\n     * An IN-ORDER list of the simulcast ssrcs\n     * @type {list<number>}\n     */\n    this.ssrcCache = [];\n}\n\n//endregion\n\n//region Stateless private utility functions\n\n/**\n * Returns a random integer between min (included) and max (excluded)\n * Using Math.round() gives a non-uniform distribution!\n * @returns {number}\n */\nfunction generateSSRC() {\n    var min = 0, max = 0xffffffff;\n    return Math.floor(Math.random() * (max - min)) + min;\n};\n\nfunction processVideo(session, action) {\n    if (session == null || !Array.isArray(session.media)) {\n        return;\n    }\n\n    session.media.forEach(function (mLine) {\n        if (mLine.type === 'video') {\n            action(mLine);\n        }\n    });\n};\n\nfunction validateDescription(desc)\n{\n    return desc && desc != null\n        && desc.type && desc.type != ''\n        && desc.sdp && desc.sdp != '';\n}\n\nfunction explodeRemoteSimulcast(mLine) {\n\n    if (!mLine || !Array.isArray(mLine.ssrcGroups)) {\n        return;\n    }\n\n    var sources = parseSsrcs(mLine);\n    var order = [];\n\n    // Find the SIM group and explode its sources.\n    var j = mLine.ssrcGroups.length;\n    while (j--) {\n\n        if (mLine.ssrcGroups[j].semantics !== 'SIM') {\n            continue;\n        }\n\n        var simulcastSsrcs = mLine.ssrcGroups[j].ssrcs.split(' ');\n\n        for (var i = 0; i < simulcastSsrcs.length; i++) {\n\n            var ssrc = simulcastSsrcs[i];\n            order.push(ssrc);\n\n            var parts = sources[ssrc].msid.split(' ');\n            sources[ssrc].msid = [parts[0], '/', i, ' ', parts[1], '/', i].join('');\n            sources[ssrc].cname = [sources[ssrc].cname, '/', i].join('');\n\n            // Remove all the groups that this SSRC participates in.\n            mLine.ssrcGroups.forEach(function (relatedGroup) {\n                if (relatedGroup.semantics === 'SIM') {\n                    return;\n                }\n\n                var relatedSsrcs = relatedGroup.ssrcs.split(' ');\n                if (relatedSsrcs.indexOf(ssrc) === -1) {\n                    return;\n                }\n\n                // Nuke all the related SSRCs.\n                relatedSsrcs.forEach(function (relatedSSRC) {\n                    sources[relatedSSRC].msid = sources[ssrc].msid;\n                    sources[relatedSSRC].cname = sources[ssrc].cname;\n                    if (relatedSSRC !== ssrc) {\n                        order.push(relatedSSRC);\n                    }\n                });\n\n                // Schedule the related group for nuking.\n            })\n        }\n\n        mLine.ssrcs = writeSsrcs(sources, order);\n        mLine.ssrcGroups.splice(j, 1);\n    };\n}\n\nfunction implodeRemoteSimulcast(mLine) {\n\n    if (!mLine || !Array.isArray(mLine.ssrcGroups)) {\n        console.info('Halt: There are no SSRC groups in the remote ' +\n                'description.');\n        return;\n    }\n\n    var sources = parseSsrcs(mLine);\n\n    // Find the SIM group and nuke it.\n    mLine.ssrcGroups.forEach(function (simulcastGroup) {\n        if (simulcastGroup.semantics !== 'SIM') {\n            return;\n        }\n\n        console.info(\"Imploding SIM group: \" + simulcastGroup.ssrcs);\n        // Schedule the SIM group for nuking.\n        simulcastGroup.nuke = true;\n\n        var simulcastSsrcs = simulcastGroup.ssrcs.split(' ');\n\n        // Nuke all the higher layer SSRCs.\n        for (var i = 1; i < simulcastSsrcs.length; i++) {\n\n            var ssrc = simulcastSsrcs[i];\n            delete sources[ssrc];\n\n            // Remove all the groups that this SSRC participates in.\n            mLine.ssrcGroups.forEach(function (relatedGroup) {\n                if (relatedGroup.semantics === 'SIM') {\n                    return;\n                }\n\n                var relatedSsrcs = relatedGroup.ssrcs.split(' ');\n                if (relatedSsrcs.indexOf(ssrc) === -1) {\n                    return;\n                }\n\n                // Nuke all the related SSRCs.\n                relatedSsrcs.forEach(function (relatedSSRC) {\n                    delete sources[relatedSSRC];\n                });\n\n                // Schedule the related group for nuking.\n                relatedGroup.nuke = true;\n            })\n        }\n\n        return;\n    });\n\n    mLine.ssrcs = writeSsrcs(sources);\n\n    // Nuke all the scheduled groups.\n    var i = mLine.ssrcGroups.length;\n    while (i--) {\n        if (mLine.ssrcGroups[i].nuke) {\n            mLine.ssrcGroups.splice(i, 1);\n        }\n    }\n}\n\nfunction removeGoogConference(mLine) {\n    if (!mLine || !Array.isArray(mLine.invalid)) {\n        return;\n    }\n\n    var i = mLine.invalid.length;\n    while (i--) {\n        if (mLine.invalid[i].value == 'x-google-flag:conference') {\n            mLine.invalid.splice(i, 1);\n        }\n    }\n}\n\nfunction assertGoogConference(mLine) {\n    if (!mLine) {\n        return;\n    }\n\n    if (!Array.isArray(mLine.invalid)) {\n        mLine.invalid = [];\n    }\n\n    if (!mLine.invalid.some(\n            function (i) { return i.value === 'x-google-flag:conference' })) {\n        mLine.invalid.push({'value': 'x-google-flag:conference'});\n    }\n}\n\nSimulcast.prototype.clearSsrcCache = function() {\n    this.ssrcCache = [];\n}\n\n/**\n * When we start as video muted, all of the video\n *  ssrcs get generated so we can include them as part\n *  of the original session-accept.  That means we\n *  need this library to restore to those same ssrcs\n *  the first time we unmute, so we need the ability to\n *  force its cache\n */\nSimulcast.prototype.setSsrcCache = function(ssrcs) {\n    this.ssrcCache = ssrcs;\n}\n\n//endregion\n\n//region \"Private\" functions\n\n/**\n * Given a video mLine, return a list of the video ssrcs\n *  in simulcast layer order (returns a list of just\n *  the primary ssrc if there are no simulcast layers)\n */\nSimulcast.prototype._parseSimLayers = function (mLine) {\n    var simGroup = mLine.ssrcGroups &&\n        mLine.ssrcGroups.find(function(group) { return group.semantics === \"SIM\"; });\n    if (simGroup) {\n        return simGroup.ssrcs\n            .split(\" \")\n            .map(function(ssrcStr) { return parseInt(ssrcStr) });\n    } else {\n        return [mLine.ssrcs[0].id];\n    }\n}\n\nSimulcast.prototype._buildNewToOldSsrcMap = function (newSsrcList, oldSsrcList) {\n    var ssrcMap = {};\n    for (var i = 0; i < newSsrcList.length; ++i) {\n        var newSsrc = newSsrcList[i];\n        var oldSsrc = oldSsrcList[i] || null;\n        ssrcMap[newSsrc] = oldSsrc;\n    }\n    return ssrcMap;\n}\n\nSimulcast.prototype._fillInSourceDataFromCache = function(mLine) {\n    console.log(\"SdpSimulcast restoring from cache: \", this.ssrcCache);\n    var newSimSsrcs = this._parseSimLayers(mLine);\n    console.log(\"SdpSimulcast Parsed new sim ssrcs: \", newSimSsrcs);\n    var newMsid = getSsrcAttribute(mLine, newSimSsrcs[0], \"msid\");\n    var newCname = getSsrcAttribute(mLine, newSimSsrcs[0], \"cname\");\n    var ssrcsToReplace = this._buildNewToOldSsrcMap(newSimSsrcs, this.ssrcCache);\n    console.log(\"SdpSimulcast built replacement map: \", ssrcsToReplace);\n    // New sdp might only have 1 layer, so not every cached ssrc will have a new one\n    //  to replace directly\n    var ssrcsToAdd = this.ssrcCache\n        .filter(function(ssrc) { return Object.values(ssrcsToReplace).indexOf(ssrc) === -1; });\n    console.log(\"SdpSimulcast built ssrcs to add: \", ssrcsToAdd);\n\n    // First do the replacements\n    mLine.ssrcs.forEach(function(ssrc) {\n        if (ssrcsToReplace[ssrc.id]) {\n            ssrc.id = ssrcsToReplace[ssrc.id];\n        }\n    });\n    // Now the adds\n    ssrcsToAdd.forEach(function(ssrc) {\n        mLine.ssrcs.push({\n            id: ssrc,\n            attribute: \"msid\",\n            value: newMsid\n        });\n        mLine.ssrcs.push({\n            id: ssrc,\n            attribute: \"cname\",\n            value: newCname\n        });\n    });\n    mLine.ssrcGroups = mLine.ssrcGroups || [];\n    mLine.ssrcGroups.push({\n        semantics: \"SIM\",\n        ssrcs: this.ssrcCache.join(\" \")\n    });\n    return mLine;\n}\n\nSimulcast.prototype._generateSourceData = function(mLine, primarySsrc) {\n    var addAssociatedStream = function(mLine, ssrc) {\n        mLine.ssrcs.push({\n            id: ssrc,\n            attribute: \"cname\",\n            value: primarySsrcCname\n        });\n        mLine.ssrcs.push({\n            id: ssrc,\n            attribute: \"msid\",\n            value: primarySsrcMsid\n        });\n    }\n    var primarySsrcMsid = getSsrcAttribute(mLine, primarySsrc, \"msid\");\n    var primarySsrcCname = getSsrcAttribute(mLine, primarySsrc, \"cname\");\n\n    // Generate sim layers\n    var simSsrcs = [];\n    for (var i = 0; i < this.options.numOfLayers - 1; ++i) {\n        var simSsrc = generateSSRC();\n        addAssociatedStream(mLine, simSsrc);\n        simSsrcs.push(simSsrc);\n    }\n    mLine.ssrcGroups = mLine.ssrcGroups || [];\n    mLine.ssrcGroups.push({\n        semantics: \"SIM\",\n        ssrcs: primarySsrc + \" \" + simSsrcs.join(\" \")\n    });\n    return mLine;\n}\n\n\n\n// Assumptions:\n//  1) 'mLine' contains only a single primary video source\n//   (i.e. it will not already have simulcast streams inserted)\n//  2) 'mLine' MAY already contain an RTX stream for its video source\n//  3) 'mLine' is in sendrecv or sendonly state\n// Guarantees:\n//  1) return mLine will contain 2 additional simulcast layers\n//   generated\n//  2) if the base video ssrc in mLine has been seen before,\n//   then the same generated simulcast streams from before will\n//   be used again\n//  3) if rtx is enabled for the mLine, all generated simulcast\n//   streams will have rtx streams generated as well\n//  4) if rtx has been generated for a src before, we will generate\n//   the same rtx stream again\nSimulcast.prototype._restoreSimulcast = function(mLine) {\n    // First, find the primary video source in the given\n    // mLine and see if we've seen it before.\n    var primarySsrc;\n    var numSsrcs = mLine.ssrcs && mLine.ssrcs\n        .map(function(ssrcInfo) { return ssrcInfo.id; })\n        .filter(function(ssrc, index, array) {\n            return array.indexOf(ssrc) === index;\n        })\n        .length || 0;\n    var numGroups = (mLine.ssrcGroups && mLine.ssrcGroups.length) || 0;\n\n    if (numSsrcs === 0 || numSsrcs > 2) {\n        // Unsupported scenario\n        return mLine;\n    }\n    if (numSsrcs == 2 && numGroups === 0) {\n        // Unsupported scenario\n        return mLine;\n    }\n\n    if (numSsrcs === 1) {\n        primarySsrc = mLine.ssrcs[0].id;\n    } else {\n        // There must be an FID group, so parse\n        //  that and pull the primary ssrc from there\n        var fidGroup = mLine.ssrcGroups.filter(function(group) { return group.semantics === \"FID\"; })[0];\n        if (fidGroup) {\n            primarySsrc = parseInt(fidGroup.ssrcs.split(\" \")[0]);\n        } else {\n            // Unsupported scenario\n            return mLine;\n        }\n    }\n    console.log(\"SdpSimulcast: current ssrc cache: \", this.ssrcCache);\n    console.log(\"SdpSimulcast: parsed primary ssrc \" + primarySsrc);\n\n    var seenPrimarySsrc = this.ssrcCache.indexOf(primarySsrc) !== -1;\n\n    if (seenPrimarySsrc) {\n        console.log(\"SdpSimulcast: Have seen primary ssrc before, \" +\n            \"filling in data from cache\");\n        mLine = this._fillInSourceDataFromCache(mLine);\n    } else {\n        console.log(\"SdpSimulcast: Have not seen primary ssrc before, \" +\n            \"generating source data\");\n        mLine = this._generateSourceData(mLine, primarySsrc);\n    }\n    // Now update the cache to match whatever we've just put into this sdp\n    this.ssrcCache = this._parseSimLayers(mLine);\n    return mLine;\n}\n\n//endregion\n\n//region \"Public\" functions\n\n/**\n *\n * @param desc\n * @returns {RTCSessionDescription}\n */\nSimulcast.prototype.mungeRemoteDescription = function (desc) {\n\n    if (!validateDescription(desc)) {\n        return desc;\n    }\n\n    var session = transform.parse(desc.sdp);\n\n    var self = this;\n    processVideo(session, function (mLine) {\n\n        // Handle simulcast reception.\n        if (self.options.explodeRemoteSimulcast) {\n            explodeRemoteSimulcast(mLine);\n        } else {\n            implodeRemoteSimulcast(mLine);\n        }\n\n        // If native simulcast is enabled, we must append the x-goog-conference\n        // attribute to the SDP.\n        if (self.ssrcCache.length < 1) {\n            removeGoogConference(mLine);\n        } else {\n            assertGoogConference(mLine);\n        }\n    });\n\n    return new RTCSessionDescription({\n        type: desc.type,\n        sdp: transform.write(session)\n    });\n};\n\n/**\n *\n * NOTE this method should be called only if simulcast is supported by\n * the current browser, otherwise local SDP should not be munged.\n * @param desc\n * @returns {RTCSessionDescription}\n */\nSimulcast.prototype.mungeLocalDescription = function (desc) {\n\n    if (!validateDescription(desc)) {\n        return desc;\n    }\n\n    var session = transform.parse(desc.sdp);\n\n    var self = this;\n    processVideo(session, function (mLine) {\n        if (mLine.direction == 'recvonly' || mLine.direction == 'inactive')\n        {\n            return;\n        }\n        self._restoreSimulcast(mLine);\n    });\n\n    return new RTCSessionDescription({\n        type: desc.type,\n        sdp: transform.write(session)\n    });\n};\n\n//endregion\n\nmodule.exports = Simulcast;\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/sdp-simulcast/lib/index.js","/* Copyright @ 2015 Atlassian Pty Ltd\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * FIXME\n * @param sources FIXME\n * @param order An array of SSRCs which will be used to order the entries in\n * the returned array. Sources whose SSRC appears in 'order' will be added first,\n * in the specified order, and all other sources will be added afterwards (in\n * no specific order).\n * @returns {Array} FIXME\n */\nexports.writeSsrcs = function(sources, order) {\n  var ssrcs = [];\n\n  // expand sources to ssrcs\n  if (typeof sources !== 'undefined' &&\n      Object.keys(sources).length !== 0) {\n\n    if (!Array.isArray(order)) {\n      order = []\n    }\n\n    // Add the sources that appear in 'order' first.\n    for (var i = 0; i < order.length; i++) {\n      var ssrc = order[i];\n      var source = sources[ssrc];\n      Object.keys(source).forEach(function (attribute) {\n        ssrcs.push({\n          id: ssrc,\n          attribute: attribute,\n          value: source[attribute]\n        });\n      });\n    }\n\n    // Now add the rest of the sources.\n    Object.keys(sources).forEach(function (ssrc) {\n      ssrc = parseInt(ssrc); // Object.keys() returns string\n      if (order.indexOf(ssrc) >= 0) {\n        // Already added.\n        return;\n      }\n\n      var source = sources[ssrc];\n      Object.keys(source).forEach(function (attribute) {\n        ssrcs.push({\n          id: ssrc,\n          attribute: attribute,\n          value: source[attribute]\n        });\n      });\n    });\n  }\n\n  return ssrcs;\n};\n\nexports.parseSsrcs = function (mLine) {\n  var sources = {};\n  // group sources attributes by ssrc.\n  if (typeof mLine.ssrcs !== 'undefined' && Array.isArray(mLine.ssrcs)) {\n    mLine.ssrcs.forEach(function (ssrc) {\n      if (!sources[ssrc.id])\n        sources[ssrc.id] = {};\n      sources[ssrc.id][ssrc.attribute] = ssrc.value;\n    });\n  }\n  return sources;\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/sdp-simulcast/lib/transform-utils.js","import * as JitsiConferenceEvents from '../JitsiConferenceEvents';\r\n\r\n/**\r\n * The value which we use to say, every sound over this threshold\r\n * is talking on the mic.\r\n * @type {number}\r\n */\r\nconst SPEECH_DETECT_THRESHOLD = 0.6;\r\n\r\n/**\r\n * Detect user trying to speek while is locally muted and fires an event.\r\n */\r\nexport default class TalkMutedDetection {\r\n    /**\r\n     * Creates TalkMutedDetection\r\n     * @param conference the JitsiConference instance that created us.\r\n     * @param callback the callback to call when detected that the local user is\r\n     * talking while her microphone is muted.\r\n     * @constructor\r\n     */\r\n    constructor(conference, callback) {\r\n        /**\r\n         * The callback to call when detected that the local user is talking\r\n         * while her microphone is muted.\r\n         *\r\n         * @private\r\n         */\r\n        this._callback = callback;\r\n\r\n        /**\r\n         * The indicator which determines whether <tt>callback</tt> has been\r\n         * invoked for the current local audio track of <tt>conference</tt> so\r\n         * that it is invoked once only.\r\n         *\r\n         * @private\r\n         */\r\n        this._eventFired = false;\r\n\r\n        // XXX I went back and forth on the subject of where to put the access\r\n        // to statistics. On the one had, (1) statistics is likely intended to\r\n        // be private to conference and (2) there is a desire to keep the\r\n        // dependencies of modules to the minimum (i.e. not have\r\n        // TalkMutedDetection depend on statistics). On the other hand, (1)\r\n        // statistics is technically not private because\r\n        // JitsiConferenceEventManager accesses it and (2) TalkMutedDetection\r\n        // works exactly because it knows that there are no audio levels for\r\n        // JitsiLocalTrack but there are audio levels for the local participant\r\n        // through statistics.\r\n        conference.statistics.addAudioLevelListener(\r\n            this._audioLevel.bind(this));\r\n\r\n        conference.on(\r\n            JitsiConferenceEvents.TRACK_MUTE_CHANGED,\r\n            this._trackMuteChanged.bind(this));\r\n        conference.on(\r\n            JitsiConferenceEvents.TRACK_ADDED,\r\n            this._trackAdded.bind(this));\r\n    }\r\n\r\n    /* eslint-disable max-params */\r\n    /**\r\n     * Receives audio level events for all send and receive streams.\r\n     *\r\n     * @param {TraceablePeerConnection} pc - WebRTC PeerConnection object of the\r\n     * @param {number} ssrc - The synchronization source identifier (SSRC) of\r\n     * the endpoint/participant/stream being reported.\r\n     * @param {number} audioLevel - The audio level of <tt>ssrc</tt>.\r\n     * @param {boolean} isLocal - <tt>true</tt> if <tt>ssrc</tt> represents a\r\n     * local/send stream or <tt>false</tt> for a remote/receive stream.\r\n     */\r\n    _audioLevel(tpc, ssrc, audioLevel, isLocal) {\r\n        // We are interested in the local audio stream only and if event is not\r\n        // sent yet.\r\n        if (!isLocal || !this.audioTrack || this._eventFired) {\r\n            return;\r\n        }\r\n\r\n        if (this.audioTrack.isMuted()\r\n            && audioLevel > SPEECH_DETECT_THRESHOLD) {\r\n            this._eventFired = true;\r\n            this._callback();\r\n        }\r\n    }\r\n    /* eslint-enable max-params */\r\n\r\n    /**\r\n     * Determines whether a specific {@link JitsiTrack} represents a local audio\r\n     * track.\r\n     *\r\n     * @param {JitsiTrack} track - The <tt>JitsiTrack</tt> to be checked whether\r\n     * it represents a local audio track.\r\n     * @private\r\n     * @return {boolean} - <tt>true</tt> if the specified <tt>track</tt>\r\n     * represents a local audio track; otherwise, <tt>false</tt>.\r\n     */\r\n    _isLocalAudioTrack(track) {\r\n        return track.isAudioTrack() && track.isLocal();\r\n    }\r\n\r\n    /**\r\n     * Notifies this <tt>TalkMutedDetection</tt> that a {@link JitsiTrack} was\r\n     * added to the associated {@link JitsiConference}. Looks for the local\r\n     * audio track only.\r\n     *\r\n     * @param {JitsiTrack} track - The added <tt>JitsiTrack</tt>.\r\n     * @private\r\n     */\r\n    _trackAdded(track) {\r\n        if (this._isLocalAudioTrack(track)) {\r\n            this.audioTrack = track;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Notifies this <tt>TalkMutedDetection</tt> that the mute state of a\r\n     * {@link JitsiTrack} has changed. Looks for the local audio track only.\r\n     *\r\n     * @param {JitsiTrack} track - The <tt>JitsiTrack</tt> whose mute state has\r\n     * changed.\r\n     * @private\r\n     */\r\n    _trackMuteChanged(track) {\r\n        if (this._isLocalAudioTrack(track) && track.isMuted()) {\r\n            this._eventFired = false;\r\n        }\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/TalkMutedDetection.js","const AudioRecorder = require('./audioRecorder');\r\nconst SphinxService = require(\r\n    './transcriptionServices/SphinxTranscriptionService');\r\n\r\nconst BEFORE_STATE = 'before';\r\nconst RECORDING_STATE = 'recording';\r\nconst TRANSCRIBING_STATE = 'transcribing';\r\nconst FINISHED_STATE = 'finished';\r\n\r\n// the amount of characters each line in the transcription will have\r\nconst MAXIMUM_SENTENCE_LENGTH = 80;\r\n\r\n/**\r\n * This is the main object for handing the Transcription. It interacts with\r\n * the audioRecorder to record every person in a conference and sends the\r\n * recorder audio to a transcriptionService. The returned speech-to-text result\r\n * will be merged to create a transcript\r\n * @param {AudioRecorder} audioRecorder An audioRecorder recording a conference\r\n */\r\nfunction Transcriber() {\r\n    // the object which can record all audio in the conference\r\n    this.audioRecorder = new AudioRecorder();\r\n\r\n    // this object can send the recorder audio to a speech-to-text service\r\n    this.transcriptionService = new SphinxService();\r\n\r\n    // holds a counter to keep track if merging can start\r\n    this.counter = null;\r\n\r\n    // holds the date when transcription started which makes it possible\r\n    // to calculate the offset between recordings\r\n    this.startTime = null;\r\n\r\n    // will hold the transcription once it is completed\r\n    this.transcription = null;\r\n\r\n    // this will be a method which will be called once the transcription is done\r\n    // with the transcription as parameter\r\n    this.callback = null;\r\n\r\n    // stores all the retrieved speech-to-text results to merge together\r\n    // this value will store an Array<Word> object\r\n    this.results = [];\r\n\r\n    // Stores the current state of the transcription process\r\n    this.state = BEFORE_STATE;\r\n\r\n    // Used in the updateTranscription method to add a new line when the\r\n    // sentence becomes to long\r\n    this.lineLength = 0;\r\n}\r\n\r\n/**\r\n * Method to start the transcription process. It will tell the audioRecorder\r\n * to start storing all audio streams and record the start time for merging\r\n * purposes\r\n */\r\nTranscriber.prototype.start = function start() {\r\n    if (this.state !== BEFORE_STATE) {\r\n        throw new Error(\r\n            `The transcription can only start when it's in the \"${\r\n                BEFORE_STATE}\" state. It's currently in the \"${\r\n                this.state}\" state`);\r\n    }\r\n    this.state = RECORDING_STATE;\r\n    this.audioRecorder.start();\r\n    this.startTime = new Date();\r\n};\r\n\r\n/**\r\n * Method to stop the transcription process. It will tell the audioRecorder to\r\n * stop, and get all the recorded audio to send it to the transcription service\r\n\r\n * @param callback a callback which will receive the transcription\r\n */\r\nTranscriber.prototype.stop = function stop(callback) {\r\n    if (this.state !== RECORDING_STATE) {\r\n        throw new Error(\r\n            `The transcription can only stop when it's in the \"${\r\n                RECORDING_STATE}\" state. It's currently in the \"${\r\n                this.state}\" state`);\r\n    }\r\n\r\n    // stop the recording\r\n    console.log('stopping recording and sending audio files');\r\n    this.audioRecorder.stop();\r\n\r\n    // and send all recorded audio the the transcription service\r\n    const callBack = blobCallBack.bind(null, this);\r\n\r\n    this.audioRecorder.getRecordingResults().forEach(recordingResult => {\r\n        this.transcriptionService.send(recordingResult, callBack);\r\n        this.counter++;\r\n    });\r\n\r\n    // set the state to \"transcribing\" so that maybeMerge() functions correctly\r\n    this.state = TRANSCRIBING_STATE;\r\n\r\n    // and store the callback for later\r\n    this.callback = callback;\r\n};\r\n\r\n/**\r\n * This method gets the answer from the transcription service, calculates the\r\n * offset and adds is to every Word object. It will also start the merging\r\n * when every send request has been received\r\n *\r\n * note: Make sure to bind this as a Transcription object\r\n * @param {Transcriber} transcriber the transcriber instance\r\n * @param {RecordingResult} answer a RecordingResult object with a defined\r\n * WordArray\r\n */\r\nfunction blobCallBack(transcriber, answer) {\r\n    console.log(\r\n        'retrieved an answer from the transcription service. The answer has an'\r\n            + ` array of length: ${answer.wordArray.length}`);\r\n\r\n    // first add the offset between the start of the transcription and\r\n    // the start of the recording to all start and end times\r\n    if (answer.wordArray.length > 0) {\r\n        let offset = answer.startTime.getUTCMilliseconds()\r\n            - transcriber.startTime.getUTCMilliseconds();\r\n\r\n        // transcriber time will always be earlier\r\n\r\n        if (offset < 0) {\r\n            offset = 0; // presume 0 if it somehow not earlier\r\n        }\r\n\r\n        let array = '[';\r\n\r\n        answer.wordArray.forEach(wordObject => {\r\n            wordObject.begin += offset;\r\n            wordObject.end += offset;\r\n            array += `${wordObject.word},`;\r\n        });\r\n        array += ']';\r\n        console.log(array);\r\n\r\n        // give a name value to the Array object so that the merging can access\r\n        // the name value without having to use the whole recordingResult object\r\n        // in the algorithm\r\n        answer.wordArray.name = answer.name;\r\n    }\r\n\r\n    // then store the array and decrease the counter\r\n    transcriber.results.push(answer.wordArray);\r\n    transcriber.counter--;\r\n    console.log(`current counter: ${transcriber.counter}`);\r\n\r\n    // and check if all results have been received.\r\n    transcriber.maybeMerge();\r\n}\r\n\r\n/**\r\n * this method will check if the counter is zero. If it is, it will call\r\n * the merging method\r\n */\r\nTranscriber.prototype.maybeMerge = function() {\r\n    if (this.state === TRANSCRIBING_STATE && this.counter === 0) {\r\n        // make sure to include the events in the result arrays before\r\n        // merging starts\r\n        this.merge();\r\n    }\r\n};\r\n\r\n/**\r\n * This method will merge all speech-to-text arrays together in one\r\n * readable transcription string\r\n */\r\nTranscriber.prototype.merge = function() {\r\n    console.log(\r\n        `starting merge process!\\n The length of the array: ${\r\n            this.results.length}`);\r\n    this.transcription = '';\r\n\r\n    // the merging algorithm will look over all Word objects who are at pos 0 in\r\n    // every array. It will then select the one closest in time to the\r\n    // previously placed word, while removing the selected word from its array\r\n    // note: words can be skipped the skipped word's begin and end time somehow\r\n    // end up between the closest word start and end time\r\n    const arrays = this.results;\r\n\r\n    // arrays of Word objects\r\n    const potentialWords = []; // array of the first Word objects\r\n    // check if any arrays are already empty and remove them\r\n\r\n    hasPopulatedArrays(arrays);\r\n\r\n    // populate all the potential Words for a first time\r\n    arrays.forEach(array => pushWordToSortedArray(potentialWords, array));\r\n\r\n    // keep adding words to transcription until all arrays are exhausted\r\n    while (hasPopulatedArrays(arrays)) {\r\n        // first select the lowest array;\r\n        let lowestWordArray = arrays[0];\r\n\r\n        arrays.forEach(wordArray => {\r\n            if (wordArray[0].begin < lowestWordArray[0].begin) {\r\n                lowestWordArray = wordArray;\r\n            }\r\n        });\r\n\r\n        // put the word in the transcription\r\n        let wordToAdd = lowestWordArray.shift();\r\n\r\n        this.updateTranscription(wordToAdd, lowestWordArray.name);\r\n\r\n        // keep going until a word in another array has a smaller time\r\n        // or the array is empty\r\n        while (lowestWordArray.length > 0) {\r\n            let foundSmaller = false;\r\n            const wordToCompare = lowestWordArray[0].begin;\r\n\r\n            arrays.forEach(wordArray => {\r\n                if (wordArray[0].begin < wordToCompare) {\r\n                    foundSmaller = true;\r\n                }\r\n            });\r\n\r\n            // add next word if no smaller time has been found\r\n            if (foundSmaller) {\r\n                break;\r\n            }\r\n\r\n            wordToAdd = lowestWordArray.shift();\r\n            this.updateTranscription(wordToAdd, null);\r\n        }\r\n\r\n    }\r\n\r\n    // set the state to finished and do the necessary left-over tasks\r\n    this.state = FINISHED_STATE;\r\n    if (this.callback) {\r\n        this.callback(this.transcription);\r\n    }\r\n};\r\n\r\n/**\r\n * Appends a word object to the transcription. It will make a new line with a\r\n * name if a name is specified\r\n * @param {Word} word the Word object holding the word to append\r\n * @param {String|null} name the name of a new speaker. Null if not applicable\r\n */\r\nTranscriber.prototype.updateTranscription = function(word, name) {\r\n    if (name !== undefined && name !== null) {\r\n        this.transcription += `\\n${name}:`;\r\n        this.lineLength = name.length + 1; // +1 for the semi-colon\r\n    }\r\n    if (this.lineLength + word.word.length > MAXIMUM_SENTENCE_LENGTH) {\r\n        this.transcription += '\\n    ';\r\n        this.lineLength = 4; // because of the 4 spaces after the new line\r\n    }\r\n    this.transcription += ` ${word.word}`;\r\n    this.lineLength += word.word.length + 1; // +1 for the space\r\n};\r\n\r\n/**\r\n * Check if the given 2 dimensional array has any non-zero Word-arrays in them.\r\n * All zero-element arrays inside will be removed\r\n * If any non-zero-element arrays are found, the method will return true.\r\n * otherwise it will return false\r\n * @param {Array<Array>} twoDimensionalArray the array to check\r\n * @returns {boolean} true if any non-zero arrays inside, otherwise false\r\n */\r\nfunction hasPopulatedArrays(twoDimensionalArray) {\r\n    for (let i = 0; i < twoDimensionalArray.length; i++) {\r\n        if (twoDimensionalArray[i].length === 0) {\r\n            twoDimensionalArray.splice(i, 1);\r\n        }\r\n    }\r\n\r\n    return twoDimensionalArray.length > 0;\r\n}\r\n\r\n/**\r\n * Push a word to the right location in a sorted array. The array is sorted\r\n * from lowest to highest start time. Every word is stored in an object which\r\n * includes the name of the person saying the word.\r\n *\r\n * @param {Array<Word>} array the sorted array to push to\r\n * @param {Word} word the word to push into the array\r\n */\r\nfunction pushWordToSortedArray(array, word) {\r\n    if (array.length === 0) {\r\n        array.push(word);\r\n    } else {\r\n        if (array[array.length - 1].begin <= word.begin) {\r\n            array.push(word);\r\n\r\n            return;\r\n        }\r\n\r\n        for (let i = 0; i < array.length; i++) {\r\n            if (word.begin < array[i].begin) {\r\n                array.splice(i, 0, word);\r\n\r\n                return;\r\n            }\r\n        }\r\n        array.push(word); // fail safe\r\n    }\r\n}\r\n\r\n/**\r\n * Gives the transcriber a JitsiTrack holding an audioStream to transcribe.\r\n * The JitsiTrack is given to the audioRecorder. If it doesn't hold an\r\n * audiostream, it will not be added by the audioRecorder\r\n * @param {JitsiTrack} track the track to give to the audioRecorder\r\n */\r\nTranscriber.prototype.addTrack = function(track) {\r\n    this.audioRecorder.addTrack(track);\r\n};\r\n\r\n/**\r\n * Remove the given track from the auioRecorder\r\n * @param track\r\n */\r\nTranscriber.prototype.removeTrack = function(track) {\r\n    this.audioRecorder.removeTrack(track);\r\n};\r\n\r\n/**\r\n * Will return the created transcription if it's avialable or throw an error\r\n * when it's not done yet\r\n * @returns {String} the transcription as a String\r\n */\r\nTranscriber.prototype.getTranscription = function() {\r\n    if (this.state !== FINISHED_STATE) {\r\n        throw new Error(\r\n            `The transcription can only be retrieved when it's in the \"${\r\n                FINISHED_STATE}\" state. It's currently in the \"${\r\n                this.state}\" state`);\r\n    }\r\n\r\n    return this.transcription;\r\n};\r\n\r\n/**\r\n * Returns the current state of the transcription process\r\n */\r\nTranscriber.prototype.getState = function() {\r\n    return this.state;\r\n};\r\n\r\n/**\r\n * Resets the state to the \"before\" state, such that it's again possible to\r\n * call the start method\r\n */\r\nTranscriber.prototype.reset = function() {\r\n    this.state = BEFORE_STATE;\r\n    this.counter = null;\r\n    this.transcription = null;\r\n    this.startTime = null;\r\n    this.callback = null;\r\n    this.results = [];\r\n    this.lineLength = 0;\r\n};\r\n\r\nmodule.exports = Transcriber;\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/transcription/transcriber.js","/* eslint-disable max-params */\r\n\r\n/**\r\n * This object stores variables needed around the recording of an audio stream\r\n * and passing this recording along with additional information along to\r\n * different processes\r\n * @param blob the recording audio stream as a single blob\r\n * @param name the name of the person of the audio stream\r\n * @param startTime the time in UTC when recording of the audiostream started\r\n * @param wordArray the recorder audio stream transcribed as an array of Word\r\n *                  objects\r\n */\r\nconst RecordingResult = function(blob, name, startTime, wordArray) {\r\n    this.blob = blob;\r\n    this.name = name;\r\n    this.startTime = startTime;\r\n    this.wordArray = wordArray;\r\n};\r\n\r\n/* eslint-enable max-params */\r\n\r\nmodule.exports = RecordingResult;\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/transcription/recordingResult.js","/* global config */\r\n\r\nconst TranscriptionService = require('./AbstractTranscriptionService');\r\nconst Word = require('../word');\r\nconst audioRecorder = require('./../audioRecorder');\r\n\r\n/**\r\n * Implements a TranscriptionService for a Sphinx4 http server\r\n */\r\nconst SphinxService = function() {\r\n    // set the correct url\r\n    this.url = getURL();\r\n};\r\n\r\n/**\r\n * Subclass of AbstractTranscriptionService\r\n */\r\nSphinxService.prototype = Object.create(TranscriptionService.prototype);\r\n\r\n/**\r\n * Set the right constructor\r\n */\r\nSphinxService.constructor = SphinxService;\r\n\r\n/**\r\n * Overrides the sendRequest method from AbstractTranscriptionService\r\n * it will send the audio stream the a Sphinx4 server to get the transcription\r\n *\r\n * @param audioFileBlob the recorder audio stream an a single Blob\r\n * @param callback the callback function retrieving the server response\r\n */\r\nSphinxService.prototype.sendRequest = function(audioFileBlob, callback) {\r\n    console.log(`sending an audio file  to ${this.url}`);\r\n    console.log(`the audio file being sent: ${audioFileBlob}`);\r\n    const request = new XMLHttpRequest();\r\n\r\n    request.onreadystatechange = function() {\r\n        if (request.readyState === XMLHttpRequest.DONE\r\n            && request.status === 200) {\r\n            callback(request.responseText);\r\n        } else if (request.readyState === XMLHttpRequest.DONE) {\r\n            throw new Error(\r\n                `unable to accept response from sphinx server. status: ${\r\n                    request.status}`);\r\n        }\r\n\r\n        // if not ready no point to throw an error\r\n    };\r\n    request.open('POST', this.url);\r\n    request.setRequestHeader('Content-Type',\r\n        audioRecorder.determineCorrectFileType());\r\n    request.send(audioFileBlob);\r\n    console.log(`send ${audioFileBlob}`);\r\n};\r\n\r\n/**\r\n * Overrides the formatResponse method from AbstractTranscriptionService\r\n * It will parse the answer from the server in the expected format\r\n *\r\n * @param response the JSON body retrieved from the Sphinx4 server\r\n */\r\nSphinxService.prototype.formatResponse = function(response) {\r\n    const result = JSON.parse(response).objects;\r\n\r\n    // make sure to delete the session id object, which is always\r\n    // the first value in the JSON array\r\n\r\n    result.shift();\r\n    const array = [];\r\n\r\n    result.forEach(\r\n        word =>\r\n            word.filler\r\n                || array.push(new Word(word.word, word.start, word.end)));\r\n\r\n    return array;\r\n};\r\n\r\n/**\r\n * checks wether the reply is empty, or doesn't contain a correct JSON object\r\n * @param response the server response\r\n * @return {boolean} whether the response is valid\r\n */\r\nSphinxService.prototype.verify = function(response) {\r\n    console.log(`response from server:${response.toString()}`);\r\n\r\n    // test if server responded with a string object\r\n    if (typeof response !== 'string') {\r\n        return false;\r\n    }\r\n\r\n    // test if the string can be parsed into valid JSON\r\n    let json;\r\n\r\n    try {\r\n        json = JSON.parse(response);\r\n    } catch (error) {\r\n        console.log(error);\r\n\r\n        return false;\r\n    }\r\n\r\n    // check if the JSON has a \"objects\" value\r\n    if (json.objects === undefined) {\r\n        return false;\r\n    }\r\n\r\n    // get the \"objects\" value and check for a session ID\r\n    const array = json.objects;\r\n\r\n    if (!(array[0] && array[0]['session-id'])) {\r\n        return false;\r\n    }\r\n\r\n    // everything seems to be in order\r\n    return true;\r\n};\r\n\r\n/**\r\n * Gets the URL to the Sphinx4 server from the config file. If it's not there,\r\n * it will throw an error\r\n *\r\n * @returns {string} the URL to the sphinx4 server\r\n */\r\nfunction getURL() {\r\n    const message = 'config does not contain an url to a Sphinx4 https server';\r\n\r\n    if (config.sphinxURL === undefined) {\r\n        console.log(message);\r\n    } else {\r\n        const toReturn = config.sphinxURL;\r\n\r\n        if (toReturn.includes !== undefined && toReturn.includes('https://')) {\r\n            return toReturn;\r\n        }\r\n        console.log(message);\r\n\r\n    }\r\n}\r\n\r\nmodule.exports = SphinxService;\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/transcription/transcriptionServices/SphinxTranscriptionService.js","/**\r\n * Abstract class representing an interface to implement a speech-to-text\r\n * service on.\r\n */\r\nconst TranscriptionService = function() {\r\n    throw new Error('TranscriptionService is abstract and cannot be'\r\n        + 'created');\r\n};\r\n\r\n/**\r\n * This method can be used to send the recorder audio stream and\r\n * retrieve the answer from the transcription service from the callback\r\n *\r\n * @param {RecordingResult} recordingResult a recordingResult object which\r\n * includes the recorded audio stream as a blob\r\n * @param {Function} callback  which will retrieve the a RecordingResult with\r\n *        the answer as a WordArray\r\n */\r\nTranscriptionService.prototype.send = function send(recordingResult, callback) {\r\n    this.sendRequest(recordingResult.blob, response => {\r\n        if (this.verify(response)) {\r\n            recordingResult.wordArray = this.formatResponse(response);\r\n        } else {\r\n            console.log('the retrieved response from the server is not valid!');\r\n            recordingResult.wordArray = [];\r\n        }\r\n        callback(recordingResult);\r\n    });\r\n};\r\n\r\n/**\r\n * Abstract method which will rend the recorder audio stream to the implemented\r\n * transcription service and will retrieve an answer, which will be\r\n * called on the given callback method\r\n *\r\n * @param {Blob} audioBlob the recorded audio stream as a single Blob\r\n * @param {function} callback function which will retrieve the answer\r\n *                            from the service\r\n */\r\n// eslint-disable-next-line no-unused-vars\r\nTranscriptionService.prototype.sendRequest = function(audioBlob, callback) {\r\n    throw new Error('TranscriptionService.sendRequest is abstract');\r\n};\r\n\r\n/**\r\n * Abstract method which will parse the output from the implemented\r\n * transcription service to the expected format\r\n *\r\n * The transcriber class expect an array of word objects, where each word\r\n * object is one transcribed word by the service.\r\n *\r\n * The expected output of this method is an array of word objects, in\r\n * the correct order. That is, the first object in the array is the first word\r\n * being said, and the last word in the array is the last word being said\r\n *\r\n * @param response the answer from the speech-to-text server which needs to be\r\n *                 formatted\r\n * @return {Array<Word>} an array of Word objects\r\n */\r\n// eslint-disable-next-line no-unused-vars\r\nTranscriptionService.prototype.formatResponse = function(response) {\r\n    throw new Error('TranscriptionService.format is abstract');\r\n};\r\n\r\n/**\r\n * Abstract method which will verify that the response from the server is valid\r\n *\r\n * @param response the response from the server\r\n * @return {boolean} true if response is valid, false otherwise\r\n */\r\n// eslint-disable-next-line no-unused-vars\r\nTranscriptionService.prototype.verify = function(response) {\r\n    throw new Error('TranscriptionService.verify is abstract');\r\n};\r\n\r\nmodule.exports = TranscriptionService;\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/transcription/transcriptionServices/AbstractTranscriptionService.js","/**\r\n * An object representing a transcribed word, with some additional information\r\n * @param word the word\r\n * @param begin the time the word was started being uttered\r\n * @param end the time the word stopped being uttered\r\n */\r\nconst Word = function(word, begin, end) {\r\n    this.word = word;\r\n    this.begin = begin;\r\n    this.end = end;\r\n};\r\n\r\n/**\r\n * Get the string representation of the word\r\n * @returns {*} the word as a string\r\n */\r\nWord.prototype.getWord = function() {\r\n    return this.word;\r\n};\r\n\r\n/**\r\n * Get the time the word started being uttered\r\n * @returns {*} the start time as an integer\r\n */\r\nWord.prototype.getBeginTime = function() {\r\n    return this.begin;\r\n};\r\n\r\n/**\r\n * Get the time the word stopped being uttered\r\n * @returns {*} the end time as an integer\r\n */\r\nWord.prototype.getEndTime = function() {\r\n    return this.end;\r\n};\r\n\r\nmodule.exports = Word;\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/transcription/word.js","import { getLogger } from 'jitsi-meet-logger';\r\nconst logger = getLogger(__filename);\r\n\r\nimport JitsiVideoSIPGWSession from './JitsiVideoSIPGWSession';\r\nimport * as Constants from './VideoSIPGWConstants';\r\nimport XMPPEvents from '../../service/xmpp/XMPPEvents';\r\n\r\n/**\r\n * Main video SIP GW handler. Stores references of all created sessions.\r\n */\r\nexport default class VideoSIPGW {\r\n\r\n    /**\r\n     * Creates new handler.\r\n     *\r\n     * @param {ChatRoom} chatRoom - Tha chat room to handle.\r\n     */\r\n    constructor(chatRoom) {\r\n        this.chatRoom = chatRoom;\r\n        this.eventEmitter = chatRoom.eventEmitter;\r\n        logger.debug('creating VideoSIPGW');\r\n        this.sessions = {};\r\n\r\n        this.sessionStateChangeListener = this.sessionStateChanged.bind(this);\r\n\r\n        // VideoSIPGW, JitsiConference and ChatRoom are not reusable and no\r\n        // more than one VideoSIPGW can be created per JitsiConference,\r\n        // so we don't bother to cleanup\r\n        chatRoom.addPresenceListener('jibri-sip-status',\r\n            this.handleJibriSIPStatus.bind(this));\r\n        chatRoom.addPresenceListener('jibri-sip-call-state',\r\n            this.handleJibriSIPState.bind(this));\r\n    }\r\n\r\n    /**\r\n     * Handles presence nodes with name: jibri-sip-status.\r\n     *\r\n     * @param {Object} node the presence node Object to handle.\r\n     * Object representing part of the presence received over xmpp.\r\n     */\r\n    handleJibriSIPStatus(node) {\r\n        const attributes = node.attributes;\r\n\r\n        if (!attributes) {\r\n            return;\r\n        }\r\n\r\n        logger.debug('Handle video sip gw status : ', attributes);\r\n        const newStatus = attributes.status;\r\n\r\n        // check for global availability of the service\r\n        if (newStatus !== this.status\r\n            && (newStatus === Constants.STATUS_UNDEFINED\r\n                || newStatus === Constants.STATUS_AVAILABLE\r\n                || newStatus === Constants.STATUS_BUSY)) {\r\n            this.status = newStatus;\r\n            this.eventEmitter.emit(\r\n                XMPPEvents.VIDEO_SIP_GW_AVAILABILITY_CHANGED, this.status);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Handles presence nodes with name: jibri-sip-call-state.\r\n     *\r\n     * @param {Object} node the presence node Object to handle.\r\n     * Object representing part of the presence received over xmpp.\r\n     */\r\n    handleJibriSIPState(node) {\r\n        const attributes = node.attributes;\r\n\r\n        if (!attributes) {\r\n            return;\r\n        }\r\n\r\n        logger.debug('Handle video sip gw state : ', attributes);\r\n\r\n        const newState = attributes.state;\r\n\r\n        if (newState === this.state) {\r\n            return;\r\n        }\r\n\r\n        switch (newState) {\r\n        case Constants.STATE_ON:\r\n        case Constants.STATE_OFF:\r\n        case Constants.STATE_PENDING:\r\n        case Constants.STATE_RETRYING:\r\n        case Constants.STATE_FAILED: {\r\n            const address = attributes.sipaddress;\r\n\r\n            if (!address) {\r\n                return;\r\n            }\r\n\r\n            // find the corresponding session and set its state\r\n            const session = this.sessions[address];\r\n\r\n            if (session) {\r\n                session.setState(newState);\r\n            } else {\r\n                logger.warn('Video SIP GW session not found:', address);\r\n            }\r\n        }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Creates new session and stores its reference if it does not exist or\r\n     * returns an error otherwise.\r\n     *\r\n     * @param {string} sipAddress - The sip address to use.\r\n     * @param {string} displayName - The display name to use.\r\n     * @returns {JitsiVideoSIPGWSession|Error}\r\n     */\r\n    createVideoSIPGWSession(sipAddress, displayName) {\r\n        if (this.sessions[sipAddress]) {\r\n            logger.warn('There was already a Video SIP GW session for address',\r\n                sipAddress);\r\n\r\n            return new Error(Constants.ERROR_SESSION_EXISTS);\r\n        }\r\n\r\n        const session = new JitsiVideoSIPGWSession(\r\n            sipAddress, displayName, this.chatRoom);\r\n\r\n        session.addStateListener(this.sessionStateChangeListener);\r\n\r\n        this.sessions[sipAddress] = session;\r\n\r\n        return session;\r\n    }\r\n\r\n    /**\r\n     * Listener for session state changed. When a session goes to off or failed\r\n     * we delete its reference.\r\n     *\r\n     * @param {options} event - { address, oldState, newState, displayName }\r\n     */\r\n    sessionStateChanged(event) {\r\n        const address = event.address;\r\n\r\n        if (event.newState === Constants.STATE_OFF\r\n            || event.newState === Constants.STATE_FAILED) {\r\n            const session = this.sessions[address];\r\n\r\n            if (!session) {\r\n                logger.error('Missing Video SIP GW session with address:',\r\n                    address);\r\n\r\n                return;\r\n            }\r\n\r\n            session.removeStateListener(this.sessionStateChangeListener);\r\n            delete this.sessions[address];\r\n        }\r\n\r\n        this.eventEmitter.emit(\r\n            XMPPEvents.VIDEO_SIP_GW_SESSION_STATE_CHANGED,\r\n            event);\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/videosipgw/VideoSIPGW.js","import { getLogger } from 'jitsi-meet-logger';\r\nimport { $iq } from 'strophe.js';\r\n\r\nimport Listenable from '../util/Listenable';\r\n\r\nimport * as VideoSIPGWConstants from './VideoSIPGWConstants';\r\n\r\nconst logger = getLogger(__filename);\r\n\r\n/**\r\n * The event name for current sip video session state changed.\r\n * @type {string} event name for sip video session state changed.\r\n */\r\nconst STATE_CHANGED = 'STATE_CHANGED';\r\n\r\n/**\r\n * Jitsi video SIP GW session. Holding its state and able to start/stop it.\r\n * When session is in OFF or FAILED stated it cannot be used anymore.\r\n */\r\nexport default class JitsiVideoSIPGWSession extends Listenable {\r\n\r\n    /**\r\n     * Creates new session with the desired sip address and display name.\r\n     *\r\n     * @param {string} sipAddress - The sip address to use when\r\n     * starting the session.\r\n     * @param {string} displayName - The display name to use for\r\n     * that participant.\r\n     * @param {ChatRoom} chatRoom - The chat room this session is bound to.\r\n     */\r\n    constructor(sipAddress, displayName, chatRoom) {\r\n        super();\r\n\r\n        this.sipAddress = sipAddress;\r\n        this.displayName = displayName;\r\n        this.chatRoom = chatRoom;\r\n\r\n        /*\r\n         * The initial state is undefined. Initial state cannot be STATE_OFF,\r\n         * the session enters this state when it was in STATE_ON and was stopped\r\n         * and such session cannot be used anymore.\r\n         *\r\n         * @type {VideoSIPGWConstants|undefined}\r\n         */\r\n        this.state = undefined;\r\n    }\r\n\r\n    /**\r\n     * Stops the current session.\r\n     */\r\n    stop() {\r\n        if (this.state === VideoSIPGWConstants.STATE_OFF\r\n            || this.state === VideoSIPGWConstants.STATE_FAILED) {\r\n            logger.warn('Video SIP GW session already stopped or failed!');\r\n\r\n            return;\r\n        }\r\n\r\n        this._sendJibriIQ('stop');\r\n    }\r\n\r\n    /**\r\n     * Starts a new session. Sends an iq to the focus.\r\n     */\r\n    start() {\r\n        // if state is off, this session was active for some reason\r\n        // and we should create new one, rather than reusing it\r\n        if (this.state === VideoSIPGWConstants.STATE_ON\r\n            || this.state === VideoSIPGWConstants.STATE_OFF\r\n            || this.state === VideoSIPGWConstants.STATE_PENDING\r\n            || this.state === VideoSIPGWConstants.STATE_RETRYING) {\r\n            logger.warn('Video SIP GW session already started!');\r\n\r\n            return;\r\n        }\r\n\r\n        this._sendJibriIQ('start');\r\n    }\r\n\r\n    /**\r\n     * Changes the state of this session.\r\n     *\r\n     * @param {string} newState - The new {VideoSIPGWConstants} state to set.\r\n     */\r\n    setState(newState) {\r\n        if (newState === this.state) {\r\n            return;\r\n        }\r\n\r\n        const oldState = this.state;\r\n\r\n        this.state = newState;\r\n        this.eventEmitter.emit(STATE_CHANGED,\r\n            {\r\n                address: this.sipAddress,\r\n                oldState,\r\n                newState: this.state,\r\n                displayName: this.displayName\r\n            }\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Subscribes the passed listener to the event for state change of this\r\n     * session.\r\n     *\r\n     * @param {Function} listener - The function that will receive the event.\r\n     */\r\n    addStateListener(listener) {\r\n        this.addListener(STATE_CHANGED, listener);\r\n    }\r\n\r\n    /**\r\n     * Unsubscribes the passed handler.\r\n     *\r\n     * @param {Function} listener - The function to be removed.\r\n     */\r\n    removeStateListener(listener) {\r\n        this.removeListener(STATE_CHANGED, listener);\r\n    }\r\n\r\n    /**\r\n     * Sends a jibri command using an iq.\r\n     *\r\n     * @private\r\n     * @param {string} action - The action to send ('start' or 'stop').\r\n     */\r\n    _sendJibriIQ(action) {\r\n        const attributes = {\r\n            'xmlns': 'http://jitsi.org/protocol/jibri',\r\n            'action': action,\r\n            sipaddress: this.sipAddress\r\n        };\r\n\r\n        attributes.displayname = this.displayName;\r\n\r\n        const iq = $iq({\r\n            to: this.chatRoom.focusMucJid,\r\n            type: 'set' })\r\n            .c('jibri', attributes)\r\n            .up();\r\n\r\n        logger.debug(`${action} video SIP GW session`, iq.nodeTree);\r\n        this.chatRoom.connection.sendIQ(\r\n            iq,\r\n            () => {}, // eslint-disable-line no-empty-function\r\n            error => {\r\n                logger.error(\r\n                    `Failed to ${action} video SIP GW session, error: `, error);\r\n                this.setState(VideoSIPGWConstants.STATE_FAILED);\r\n            });\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/videosipgw/JitsiVideoSIPGWSession.js","import * as JitsiConferenceEvents from '../../JitsiConferenceEvents';\r\nimport SpeakerStats from './SpeakerStats';\r\n\r\n/**\r\n * A collection for tracking speaker stats. Attaches listeners\r\n * to the conference to automatically update on tracked events.\r\n */\r\nexport default class SpeakerStatsCollector {\r\n    /**\r\n     * Initializes a new SpeakerStatsCollector instance.\r\n     *\r\n     * @constructor\r\n     * @param {JitsiConference} conference - The conference to track.\r\n     * @returns {void}\r\n     */\r\n    constructor(conference) {\r\n        this.stats = {\r\n            users: {\r\n\r\n                // userId: SpeakerStats\r\n            },\r\n            dominantSpeakerId: null\r\n        };\r\n\r\n        const userId = conference.myUserId();\r\n\r\n        this.stats.users[userId] = new SpeakerStats(userId, null, true);\r\n\r\n        conference.addEventListener(\r\n            JitsiConferenceEvents.DOMINANT_SPEAKER_CHANGED,\r\n            this._onDominantSpeaker.bind(this));\r\n        conference.addEventListener(\r\n            JitsiConferenceEvents.USER_JOINED,\r\n            this._onUserJoin.bind(this));\r\n        conference.addEventListener(\r\n            JitsiConferenceEvents.USER_LEFT,\r\n            this._onUserLeave.bind(this));\r\n        conference.addEventListener(\r\n            JitsiConferenceEvents.DISPLAY_NAME_CHANGED,\r\n            this._onDisplayNameChange.bind(this));\r\n    }\r\n\r\n    /**\r\n     * Reacts to dominant speaker change events by changing its speaker stats\r\n     * models to reflect the current dominant speaker.\r\n     *\r\n     * @param {string} dominantSpeakerId - The user id of the new\r\n     * dominant speaker.\r\n     * @returns {void}\r\n     * @private\r\n     */\r\n    _onDominantSpeaker(dominantSpeakerId) {\r\n        const oldDominantSpeaker\r\n            = this.stats.users[this.stats.dominantSpeakerId];\r\n        const newDominantSpaker = this.stats.users[dominantSpeakerId];\r\n\r\n        oldDominantSpeaker && oldDominantSpeaker.setIsDominantSpeaker(false);\r\n        newDominantSpaker && newDominantSpaker.setIsDominantSpeaker(true);\r\n        this.stats.dominantSpeakerId = dominantSpeakerId;\r\n    }\r\n\r\n    /**\r\n     * Reacts to user join events by creating a new SpeakerStats model.\r\n     *\r\n     * @param {string} userId - The user id of the new user.\r\n     * @param {JitsiParticipant} - The JitsiParticipant model for the new user.\r\n     * @returns {void}\r\n     * @private\r\n     */\r\n    _onUserJoin(userId, participant) {\r\n        let savedUser = this.stats.users[userId];\r\n\r\n        if (!savedUser) {\r\n            savedUser = this.stats.users[userId]\r\n                = new SpeakerStats(userId, participant.getDisplayName());\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Reacts to user leave events by updating the associated user's\r\n     * SpeakerStats model.\r\n     *\r\n     * @param {string} userId - The user id of the user that left.\r\n     * @returns {void}\r\n     * @private\r\n     */\r\n    _onUserLeave(userId) {\r\n        const savedUser = this.stats.users[userId];\r\n\r\n        if (savedUser) {\r\n            savedUser.markAsHasLeft();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Reacts to user name change events by updating the last known name\r\n     * tracked in the associated SpeakerStats model.\r\n     *\r\n     * @param {string} userId - The user id of the user that left.\r\n     * @returns {void}\r\n     * @private\r\n     */\r\n    _onDisplayNameChange(userId, newName) {\r\n        const savedUser = this.stats.users[userId];\r\n\r\n        if (savedUser) {\r\n            savedUser.setDisplayName(newName);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Return a copy of the tracked SpeakerStats models.\r\n     *\r\n     * @returns {Object} The keys are the user ids and the values are the\r\n     * associated user's SpeakerStats model.\r\n     * @private\r\n     */\r\n    getStats() {\r\n        return this.stats.users;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/statistics/SpeakerStatsCollector.js","/**\r\n * A model for keeping track of each user's total\r\n * time as a dominant speaker. The model also\r\n * keeps track of the user's last known name\r\n * in case the user has left the meeting,\r\n * which is also tracked.\r\n */\r\nclass SpeakerStats {\r\n    /**\r\n     * Initializes a new SpeakerStats instance.\r\n     *\r\n     * @constructor\r\n     * @param {string} userId - The id of the user being tracked.\r\n     * @param {string} displayName - The name of the user being tracked.\r\n     * @param {boolean} isLocalStats - True if the stats model tracks\r\n     * the local user.\r\n     * @returns {void}\r\n     */\r\n    constructor(userId, displayName, isLocalStats) {\r\n        this._userId = userId;\r\n        this.setDisplayName(displayName);\r\n        this._isLocalStats = isLocalStats || false;\r\n        this.setIsDominantSpeaker(false);\r\n        this.totalDominantSpeakerTime = 0;\r\n        this._dominantSpeakerStart = null;\r\n        this._hasLeft = false;\r\n    }\r\n\r\n    /**\r\n     * Get the user id being tracked.\r\n     *\r\n     * @returns {string} The user id.\r\n     */\r\n    getUserId() {\r\n        return this._userId;\r\n    }\r\n\r\n    /**\r\n     * Get the name of the user being tracked.\r\n     *\r\n     * @returns {string} The user name.\r\n     */\r\n    getDisplayName() {\r\n        return this.displayName;\r\n    }\r\n\r\n    /**\r\n     * Updates the last known name of the user being tracked.\r\n     *\r\n     * @param {string} - The user name.\r\n     * @returns {void}\r\n     */\r\n    setDisplayName(newName) {\r\n        this.displayName = newName;\r\n    }\r\n\r\n    /**\r\n     * Returns true if the stats are tracking the local user.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    isLocalStats() {\r\n        return this._isLocalStats;\r\n    }\r\n\r\n    /**\r\n     * Returns true if the tracked user is currently a dominant speaker.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    isDominantSpeaker() {\r\n        return this._isDominantSpeaker;\r\n    }\r\n\r\n    /**\r\n     * Returns true if the tracked user is currently a dominant speaker.\r\n     *\r\n     * @param {boolean} - If true, the user will being accumulating time\r\n     * as dominant speaker. If false, the user will not accumulate time\r\n     * and will record any time accumulated since starting as dominant speaker.\r\n     * @returns {void}\r\n     */\r\n    setIsDominantSpeaker(isNowDominantSpeaker) {\r\n        if (!this._isDominantSpeaker && isNowDominantSpeaker) {\r\n            this._dominantSpeakerStart = Date.now();\r\n        } else if (this._isDominantSpeaker && !isNowDominantSpeaker) {\r\n            const now = Date.now();\r\n            const timeElapsed = now - (this._dominantSpeakerStart || 0);\r\n\r\n            this.totalDominantSpeakerTime += timeElapsed;\r\n            this._dominantSpeakerStart = null;\r\n        }\r\n\r\n        this._isDominantSpeaker = isNowDominantSpeaker;\r\n    }\r\n\r\n    /**\r\n     * Get how long the tracked user has been dominant speaker.\r\n     *\r\n     * @returns {number} - The speaker time in milliseconds.\r\n     */\r\n    getTotalDominantSpeakerTime() {\r\n        let total = this.totalDominantSpeakerTime;\r\n\r\n        if (this._isDominantSpeaker) {\r\n            total += Date.now() - this._dominantSpeakerStart;\r\n        }\r\n\r\n        return total;\r\n    }\r\n\r\n    /**\r\n     * Get whether or not the user is still in the meeting.\r\n     *\r\n     * @returns {boolean} True if the user is no longer in the meeting.\r\n     */\r\n    hasLeft() {\r\n        return this._hasLeft;\r\n    }\r\n\r\n    /**\r\n     * Set the user as having left the meeting.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    markAsHasLeft() {\r\n        this._hasLeft = true;\r\n        this.setIsDominantSpeaker(false);\r\n    }\r\n}\r\n\r\nmodule.exports = SpeakerStats;\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/statistics/SpeakerStats.js","import EventEmitter from 'events';\r\n\r\nimport * as MediaType from './service/RTC/MediaType';\r\nimport browser from './modules/browser';\r\nimport RTC from './modules/RTC/RTC';\r\nimport RTCEvents from './service/RTC/RTCEvents';\r\nimport Statistics from './modules/statistics/statistics';\r\n\r\nimport * as JitsiMediaDevicesEvents from './JitsiMediaDevicesEvents';\r\n\r\nconst eventEmitter = new EventEmitter();\r\n\r\n/**\r\n * Gathers data and sends it to statistics.\r\n * @param deviceID the device id to log\r\n * @param devices list of devices\r\n */\r\nfunction logOutputDevice(deviceID, devices) {\r\n    const device\r\n        = devices.find(\r\n            d => d.kind === 'audiooutput' && d.deviceId === deviceID);\r\n\r\n    if (device) {\r\n        Statistics.sendActiveDeviceListEvent(\r\n            RTC.getEventDataForActiveDevice(device));\r\n    }\r\n}\r\n\r\nconst JitsiMediaDevices = {\r\n    /**\r\n     * Executes callback with list of media devices connected.\r\n     * @param {function} callback\r\n     */\r\n    enumerateDevices(callback) {\r\n        RTC.enumerateDevices(callback);\r\n    },\r\n\r\n    /**\r\n     * Checks if its possible to enumerate available cameras/micropones.\r\n     * @returns {Promise<boolean>} a Promise which will be resolved only once\r\n     * the WebRTC stack is ready, either with true if the device listing is\r\n     * available available or with false otherwise.\r\n     */\r\n    isDeviceListAvailable() {\r\n        return RTC.isDeviceListAvailable();\r\n    },\r\n\r\n    /**\r\n     * Returns true if changing the input (camera / microphone) or output\r\n     * (audio) device is supported and false if not.\r\n     * @param {string} [deviceType] - type of device to change. Default is\r\n     *      undefined or 'input', 'output' - for audio output device change.\r\n     * @returns {boolean} true if available, false otherwise.\r\n     */\r\n    isDeviceChangeAvailable(deviceType) {\r\n        return RTC.isDeviceChangeAvailable(deviceType);\r\n    },\r\n\r\n    /**\r\n     * Returns true if user granted permission to media devices.\r\n     * @param {'audio'|'video'} [type] - type of devices to check,\r\n     *      undefined stands for both 'audio' and 'video' together\r\n     * @returns {boolean}\r\n     */\r\n    isDevicePermissionGranted(type) {\r\n        const permissions = RTC.getDeviceAvailability();\r\n\r\n        switch (type) {\r\n        case MediaType.VIDEO:\r\n            return permissions.video === true;\r\n        case MediaType.AUDIO:\r\n            return permissions.audio === true;\r\n        default:\r\n            return permissions.video === true && permissions.audio === true;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Returns true if it is possible to be simultaneously capturing audio\r\n     * from more than one device.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    isMultipleAudioInputSupported() {\r\n        return !browser.isFirefox();\r\n    },\r\n\r\n    /**\r\n     * Returns currently used audio output device id, 'default' stands\r\n     * for default device\r\n     * @returns {string}\r\n     */\r\n    getAudioOutputDevice() {\r\n        return RTC.getAudioOutputDevice();\r\n    },\r\n\r\n    /**\r\n     * Sets current audio output device.\r\n     * @param {string} deviceId - id of 'audiooutput' device from\r\n     *      navigator.mediaDevices.enumerateDevices(), 'default' is for\r\n     *      default device\r\n     * @returns {Promise} - resolves when audio output is changed, is rejected\r\n     *      otherwise\r\n     */\r\n    setAudioOutputDevice(deviceId) {\r\n\r\n        const availableDevices = RTC.getCurrentlyAvailableMediaDevices();\r\n\r\n        if (availableDevices && availableDevices.length > 0) {\r\n            // if we have devices info report device to stats\r\n            // normally this will not happen on startup as this method is called\r\n            // too early. This will happen only on user selection of new device\r\n            logOutputDevice(deviceId, RTC.getCurrentlyAvailableMediaDevices());\r\n        }\r\n\r\n        return RTC.setAudioOutputDevice(deviceId);\r\n    },\r\n\r\n    /**\r\n     * Adds an event handler.\r\n     * @param {string} event - event name\r\n     * @param {function} handler - event handler\r\n     */\r\n    addEventListener(event, handler) {\r\n        eventEmitter.addListener(event, handler);\r\n    },\r\n\r\n    /**\r\n     * Removes event handler.\r\n     * @param {string} event - event name\r\n     * @param {function} handler - event handler\r\n     */\r\n    removeEventListener(event, handler) {\r\n        eventEmitter.removeListener(event, handler);\r\n    },\r\n\r\n    /**\r\n     * Emits an event.\r\n     * @param {string} event - event name\r\n     */\r\n    emitEvent(event, ...args) {\r\n        eventEmitter.emit(event, ...args);\r\n    },\r\n\r\n    /**\r\n     * Returns whether or not the current browser can support capturing video,\r\n     * be it camera or desktop, and displaying received video.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    supportsVideo() {\r\n        // Defer to the browser capabilities to allow exposure of the api to the\r\n        // consumer but prevent other files from having to import\r\n        // JitsiMediaDevices.\r\n        return browser.supportsVideo();\r\n    }\r\n};\r\n\r\n\r\nRTC.addListener(\r\n    RTCEvents.DEVICE_LIST_CHANGED,\r\n    devices =>\r\n        eventEmitter.emit(\r\n            JitsiMediaDevicesEvents.DEVICE_LIST_CHANGED,\r\n            devices));\r\nRTC.addListener(\r\n    RTCEvents.DEVICE_LIST_AVAILABLE,\r\n    devices =>\r\n        logOutputDevice(\r\n            JitsiMediaDevices.getAudioOutputDevice(),\r\n            devices));\r\n\r\nexport default JitsiMediaDevices;\r\n\n\n\n// WEBPACK FOOTER //\n// ./JitsiMediaDevices.js","/* global $ */\r\n\r\nimport browser from '../browser';\r\n\r\nconst logger = require('jitsi-meet-logger').getLogger(__filename);\r\n\r\nconst RTCUIHelper = {\r\n\r\n    /**\r\n     * Returns the name of 'video' element depending on the browser that we're\r\n     * currently using.\r\n     * @returns {string} 'video' or 'object' string name of WebRTC video element\r\n     */\r\n    getVideoElementName() {\r\n        return browser.isTemasysPluginUsed() ? 'object' : 'video';\r\n    },\r\n\r\n    /**\r\n     * Finds video element inside of the given container.\r\n     * @param containerElement HTML element node instance which is supposed to\r\n     *        contain the video element.\r\n     * @returns {HTMLElement} video HTML element instance if found inside of the\r\n     *          container or undefined otherwise.\r\n     */\r\n    findVideoElement(containerElement) {\r\n        const videoElemName = RTCUIHelper.getVideoElementName();\r\n\r\n        if (!browser.isTemasysPluginUsed()) {\r\n            return $(containerElement).find(videoElemName)[0];\r\n        }\r\n        const matching\r\n            = $(containerElement).find(\r\n                ` ${videoElemName}>param[value=\"video\"]`);\r\n\r\n        if (matching.length) {\r\n            if (matching.length > 1) {\r\n                logger.warn(\r\n                    'Container with more than one video elements: ',\r\n                    containerElement);\r\n            }\r\n\r\n            return matching.parent()[0];\r\n        }\r\n\r\n        return undefined;\r\n    },\r\n\r\n    /**\r\n     * Returns whether or not the video element fires resize events.\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    isResizeEventSupported() {\r\n        return !browser.isTemasysPluginUsed();\r\n    },\r\n\r\n    /**\r\n     * Sets 'volume' property of given HTML element displaying RTC audio or\r\n     * video stream.\r\n     * @param streamElement HTML element to which the RTC stream is attached to.\r\n     * @param volume the volume value to be set.\r\n     */\r\n    setVolume(streamElement, volume) {\r\n        if (!browser.isIExplorer()) {\r\n            streamElement.volume = volume;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Sets 'autoplay' property of given HTML element displaying RTC audio or\r\n     * video stream.\r\n     * @param streamElement HTML element to which the RTC stream is attached to.\r\n     * @param autoPlay 'true' or 'false'\r\n     */\r\n    setAutoPlay(streamElement, autoPlay) {\r\n        if (!browser.isIExplorer()) {\r\n            streamElement.autoplay = autoPlay;\r\n        }\r\n    }\r\n};\r\n\r\nexport default RTCUIHelper;\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/RTC/RTCUIHelper.js"],"sourceRoot":""}